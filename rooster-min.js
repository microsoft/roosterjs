var roosterjs=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=83)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7);t.getBlockElementAtNode=r.default;var i=n(47);t.getFirstLastBlockElement=i.default;var o=n(23);t.ContentTraverser=o.default;var a=n(93);t.PositionContentSearcher=a.default;var s=n(14);t.getInlineElementAtNode=s.default;var l=n(48);t.ImageInlineElement=l.default;var u=n(49);t.LinkInlineElement=u.default;var d=n(24);t.NodeInlineElement=d.default;var c=n(25);t.PartialInlineElement=c.default;var f=n(33);t.arrayPush=f.default;var p=n(29);t.applyTextStyle=p.default;var h=n(26);t.Browser=h.Browser,t.getBrowserInfo=h.getBrowserInfo;var v=n(94);t.applyFormat=v.default;var g=n(27);t.changeElementTag=g.default;var m=n(16);t.collapseNodes=m.default;var y=n(2);t.contains=y.default;var E=n(95);t.extractClipboardEvent=E.default;var b=n(19);t.findClosestElementAncestor=b.default;var C=n(22);t.fromHtml=C.default;var S=n(31);t.getComputedStyles=S.default,t.getComputedStyle=S.getComputedStyle;var w=n(96);t.getPendableFormatState=w.default,t.PendableFormatCommandMap=w.PendableFormatCommandMap;var N=n(1);t.getTagOfNode=N.default;var O=n(18);t.isBlockElement=O.default;var T=n(34);t.isNodeEmpty=T.default;var P=n(46);t.isVoidHtmlElement=P.default;var _=n(97);t.matchLink=_.default;var L=n(15);t.queryElements=L.default;var k=n(17);t.splitParentNode=k.default,t.splitBalancedNodeRange=k.splitBalancedNodeRange;var x=n(35);t.unwrap=x.default;var R=n(13);t.wrap=R.default;var I=n(8);t.getNextLeafSibling=I.getNextLeafSibling,t.getPreviousLeafSibling=I.getPreviousLeafSibling;var A=n(51);t.getFirstLeafNode=A.getFirstLeafNode,t.getLastLeafNode=A.getLastLeafNode;var M=n(98);t.getTextContent=M.default;var D=n(30);t.splitTextNode=D.default;var B=n(36);t.normalizeRect=B.default;var j=n(5);t.toArray=j.default;var F=n(3);t.safeInstanceOf=F.default;var z=n(99);t.readFile=z.default;var H=n(53);t.getInnerHTML=H.default;var U=n(100);t.VTable=U.default;var W=n(37);t.VList=W.default;var V=n(54);t.VListItem=V.default;var q=n(101);t.createVListFromRegion=q.default;var K=n(102);t.VListChain=K.default;var G=n(57);t.getRegionsFromRange=G.default;var Y=n(56);t.getSelectedBlockElementsInRegion=Y.default;var X=n(58);t.collapseNodesInRegion=X.default;var $=n(21);t.isNodeInRegion=$.default;var Q=n(39);t.getSelectionRangeInRegion=Q.default;var Z=n(59);t.mergeBlocksInRegion=Z.default;var J=n(4);t.Position=J.default;var ee=n(10);t.createRange=ee.default;var te=n(104);t.getPositionRect=te.default;var ne=n(105);t.isPositionAtBeginningOf=ne.default;var re=n(61);t.getSelectionPath=re.default;var ie=n(106);t.getHtmlWithSelectionPath=ie.default;var oe=n(107);t.setHtmlWithSelectionPath=oe.default;var ae=n(108);t.addRangeToSelection=ae.default;var se=n(109);t.deleteSelectedContent=se.default;var le=n(110);t.addSnapshot=le.default;var ue=n(42);t.canMoveCurrentSnapshot=ue.default;var de=n(62);t.clearProceedingSnapshots=de.default;var ce=n(111);t.moveCurrentSnapsnot=ce.default;var fe=n(112);t.createSnapshots=fe.default;var pe=n(113);t.canUndoAutoComplete=pe.default;var he=n(114);t.HtmlSanitizer=he.default;var ve=n(63);t.getInheritableStyles=ve.default;var ge=n(116);t.createDefaultHtmlSanitizerOptions=ge.default;var me=n(117);t.chainSanitizerCallback=me.default;var ye=n(118);t.commitEntity=ye.default;var Ee=n(119);t.getEntityFromElement=Ee.default;var be=n(120);t.getEntitySelector=be.default;var Ce=n(121);t.cacheGetEventData=Ce.default;var Se=n(122);t.clearEventDataCache=Se.default;var we=n(65);t.isModifierKey=we.default;var Ne=n(123);t.isCharacterValue=Ne.default;var Oe=n(124);t.isCtrlOrMetaPressed=Oe.default;var Te=n(40);t.getStyles=Te.default;var Pe=n(41);t.setStyles=Pe.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.default=function(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||(r.default(t,"Range")&&(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType&&11!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&function(e,t){if(e.contains)return e.contains(t);for(;t;){if(t==e)return!0;t=t.parentNode}return!1}(e,t)))}},function(e,t,n){"use strict";function r(e){var t=e&&(e.commonAncestorContainer||e),n=t&&(t.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(t)?t:null));return n&&(n.defaultView||window)}Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=r,t.default=function(e,t){var n=r(e),i=n&&n[t],o=window,a=o&&o[t];return a&&e instanceof a||i&&e instanceof i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),i=n(12),o=function(){function e(e,t,n){switch(this.isFromEndOfRange=n,e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=a(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=a(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=s(this.node),this.isAtEnd=!0;break;default:var i=s(this.node);this.offset=Math.max(0,Math.min(t,i)),this.isAtEnd=t>0&&t>=i}this.element=r.default(this.node)}return e.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var t=this.node,n=this.isAtEnd?-1:this.offset;1==t.nodeType||11==t.nodeType;){var r=this.isFromEndOfRange?-1==n?t.lastChild:t.childNodes[n-1]:0==n?t.firstChild:-1==n?t.lastChild:t.childNodes[n];if(!r)break;t=r,n=this.isAtEnd||this.isFromEndOfRange?-1:0}return new e(t,n,this.isFromEndOfRange)},e.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},e.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:i.default(this.node,e.node)},e.prototype.move=function(t){return new e(this.node,Math.max(this.offset+t,0))},e.getStart=function(t){return new e(t.startContainer,t.startOffset)},e.getEnd=function(t){return t.collapsed?e.getStart(t):new e(t.endContainer,t.endOffset,!0)},e}();function a(e){for(var t=0;e=e.previousSibling;)t++;return t}function s(e){return 3==e.nodeType?e.nodeValue.length:1==e.nodeType?e.childNodes.length:1}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return[].slice.call(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88);t.changeFontSize=r.default,t.FONT_SIZES=r.FONT_SIZES;var i=n(125);t.clearBlockFormat=i.default;var o=n(126);t.clearFormat=o.default;var a=n(127);t.createLink=a.default;var s=n(128);t.getFormatState=s.default,t.getElementBasedFormatState=s.getElementBasedFormatState;var l=n(129);t.insertEntity=l.default;var u=n(130);t.insertImage=u.default;var d=n(131);t.insertTable=d.default;var c=n(132);t.editTable=c.default;var f=n(133);t.formatTable=f.default;var p=n(134);t.removeLink=p.default;var h=n(135);t.replaceWithNode=h.default;var v=n(136);t.rotateElement=v.default;var g=n(137);t.setAlignment=g.default;var m=n(67);t.setBackgroundColor=m.default;var y=n(70);t.setTextColor=y.default;var E=n(138);t.setDirection=E.default;var b=n(68);t.setFontName=b.default;var C=n(69);t.setFontSize=C.default;var S=n(140);t.setImageAltText=S.default;var w=n(141);t.setIndentation=w.default;var N=n(142);t.changeCapitalization=N.default;var O=n(71);t.toggleBold=O.default;var T=n(143);t.toggleBullet=T.default;var P=n(72);t.toggleItalic=P.default;var _=n(144);t.toggleNumbering=_.default;var L=n(145);t.toggleBlockQuote=L.default;var k=n(146);t.toggleCodeBlock=k.default;var x=n(147);t.toggleStrikethrough=x.default;var R=n(148);t.toggleSubscript=R.default;var I=n(149);t.toggleSuperscript=I.default;var A=n(73);t.toggleUnderline=A.default;var M=n(150);t.toggleHeader=M.default;var D=n(66);t.experimentCommitListChains=D.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(2),o=n(1),a=n(18),s=n(45),l=n(89);function u(e,t,n){var r=e;if("BR"==o.default(r)&&n)return r;for(;r;){for(var i=e;!(i=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return r;for(;i;){if(a.default(i))return r;if("BR"==o.default(i))return n?i:r;e=i,i=n?e.firstChild:e.lastChild}r=e}return r}t.default=function(e,t){if(!i.default(e,t))return null;var n=l.default.getBlockContext(t);if(n==t)return new s.default(n);var o=u(t,n,!1),d=u(t,n,!0),c=r.default(e,o,d,!1);if(o=c[0],d=c[c.length-1],o.parentNode!=d.parentNode)return new l.default(e,o,d);for(;!o.previousSibling&&!d.nextSibling;){var f=o.parentNode;if(f==n){n!=e&&(o=d=f);break}if(f==e)break;o=d=f}return o==d&&a.default(o)?new s.default(o):new l.default(e,o,d)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(1),o=n(20);function a(e,t,n,a,s){var l=null,u=n?function(e){return e.nextSibling}:function(e){return e.previousSibling},d=n?function(e){return e.firstChild}:function(e){return e.lastChild};if(r.default(e,t))for(var c=t,f=!0;f;){var p=c.parentNode;for(c=u(c);!c&&p!=e;)c=u(p),p=p.parentNode;for(;c&&(!a||a.indexOf(i.default(c))<0)&&d(c);)c=d(c);if(!(f=c&&o.default(c,s))){l=c;break}}return l}t.getLeafSibling=a,t.getNextLeafSibling=function(e,t,n){return a(e,t,!0,n)},t.getPreviousLeafSibling=function(e,t,n){return a(e,t,!1,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=null;t.default=function(e,t){e.focus();var n=function(){return e.getDocument().execCommand(t,!1,null)},o=e.getSelectionRange();o&&o.collapsed?(e.addUndoSnapshot(),n(),function(e){i||(i=Object.keys(r.PendableFormatCommandMap).map((function(e){return r.PendableFormatCommandMap[e]})));return i.indexOf(e)>=0}(t)&&e.triggerPluginEvent(13,{formatState:r.getPendableFormatState(e.getDocument())})):e.addUndoSnapshot(n,"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),i=n(4),o=n(3);function a(e){return 1==e.node.nodeType&&r.default(e.node)?new i.default(e.node,e.isAtEnd?-3:-2):e}function s(e){return e&&e.node}function l(e,t){if(!e||!t)return null;for(var n,r=0;r<t.length&&(n=t[r],r<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);r++)e=e.childNodes[n];return new i.default(e,n)}t.default=function(e,t,n,r){var u,d;if(s(e)?(u=e,d=s(t)?t:null):o.default(e,"Node")&&(Array.isArray(t)?(u=l(e,t),d=Array.isArray(n)?l(e,n):null):"number"==typeof t?(u=new i.default(e,t),d=o.default(n,"Node")?new i.default(n,r):null):!o.default(t,"Node")&&t||(u=new i.default(e,-2),d=new i.default(t||e,-3))),u&&u.node){var c=u.node.ownerDocument.createRange();return u=a(u),d=a(d||u),c.setStart(u.node,u.offset),c.setEnd(d.node,d.offset),c}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){e.focus();var n=e.getSelectionRange();if(n&&n.collapsed){var i=n.startContainer;if("SPAN"==r.getTagOfNode(i)&&(!i.firstChild||"BR"==r.getTagOfNode(i.firstChild)&&!i.firstChild.nextSibling))e.addUndoSnapshot(),t(i);else i&&3==i.nodeType&&"​"==i.nodeValue&&"SPAN"==r.getTagOfNode(i.parentNode)||(e.addUndoSnapshot(),i=e.getDocument().createTextNode("​"),n.insertNode(i)),r.applyTextStyle(i,t),e.select(i,-1)}else e.addUndoSnapshot((function(){for(var n,r,i=e.getSelectionTraverser(),o=i&&i.currentInlineElement;o;){var a=i.getNextInlineElement();o.applyStyle((function(e,i){t(e,i),n=n||e,r=e})),o=a}n&&r&&e.select(n,-2,r,-3)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),i=n(3);t.default=function(e,t){if(0==(e=e?i.default(e,"Node")?[e]:e:[]).length||!e[0])return null;if(!i.default(t,"HTMLElement")){var n=e[0].ownerDocument;t=/^\w+$/.test(t=t||"div")?n.createElement(t):r.default(t,n)[0]}var o=e[0].parentNode;o&&o.insertBefore(t,e[0]);for(var a=0,s=e;a<s.length;a++){var l=s[a];t.appendChild(l)}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=n(1),o=n(48),a=n(49),s=n(24),l=n(3);t.default=function(e,t){var n=l.default(e,"Node")?r.default(e,t):e;return t&&n&&function(e,t){for(var n,r=[e],l=e.parentNode;l&&t.contains(l);l=l.parentNode)r.push(l);for(var u=r.length-1;u>=0&&!n;u--){var d=r[u],c=i.default(d);"A"==c?n=new a.default(d,t):"IMG"==c&&(n=new o.default(d,t))}return n||new s.default(e,t)}(t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5);function i(e,t){return t.some((function(t){return 0==t?0==e:(e&t)==t}))}t.default=function(e,t,n,o,a){if(void 0===o&&(o=0),!e||!t)return[];var s=r.default(e.querySelectorAll(t));if(0!=o&&a){var l=a.startContainer,u=a.startOffset,d=a.endContainer,c=a.endOffset;if(1==l.nodeType&&l.firstChild){var f=l.childNodes[u];l=f||l.lastChild}d=1==d.nodeType&&d.firstChild&&c>0?d.childNodes[c-1]:d,s=s.filter((function(e){return function(e,t,n,r){var o=e.compareDocumentPosition(t),a=e.compareDocumentPosition(n),s=[0,8];r||s.push(16);return i(o,s)||i(a,s)||i(o,[2])&&i(a,[4])&&!i(a,[16])}(e,l,d,2==o)}))}return n&&s.forEach(n),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(17),o=n(5);function a(e,t,n,o,a){for(;t.parentNode!=e&&!r.default(t.parentNode,n);){if(o&&t.previousSibling||!o&&t.nextSibling){if(!a)break;i.default(t,o)}t=t.parentNode}return t}t.default=function(e,t,n,i){if(!r.default(e,t)||!r.default(e,n))return[];if(t=a(e,t,n,!0,i),n=a(e,n,t,!1,i),r.default(t,n,!0))return[t];if(r.default(n,t))return[n];if(t.parentNode==n.parentNode){var s=o.default(t.parentNode.childNodes),l=s.indexOf(t),u=s.indexOf(n);return s.slice(l,u+1)}return[t,n]},t.collapse=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);function i(e,t){if(!e||!e.parentNode)return null;var n=e.parentNode,r=n.cloneNode(!1);if(r.removeAttribute("id"),t)for(;n.firstChild&&n.firstChild!=e;)r.appendChild(n.firstChild);else for(;e.nextSibling;)r.appendChild(e.nextSibling);return r.firstChild&&""!=r.innerHTML?n.parentNode.insertBefore(r,t?n:n.nextSibling):r=null,r}t.default=i,t.splitBalancedNodeRange=function(e){var t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[e.length-1]:e,o=t&&n&&t.parentNode==n.parentNode?t.parentNode:null;if(o){if(r.default(t,n)){var a=n;n=t,t=a}i(t,!0),i(n,!1)}return o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),o=["block","list-item","table-cell"];t.default=function(e){var t=r.default(e);return!(!t||!(o.indexOf(e.style.display)>=0||i.indexOf(t)>=0))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.default=function(e,t,n){var i=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(i&&n)if(i.closest)i=i.closest(n);else for(;i&&i!=t&&!(i.matches||i.msMatchesSelector).call(i,n);)i=i.parentElement;return!t||r.default(t,i)?i:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(31),o=/^[\r\n]+$/gm,a=/[\t\r\n\u0020\u200B]/gm;t.default=function e(t,n){if(3==t.nodeType)return!(t.nodeValue&&""!=t.textContent&&!o.test(t.nodeValue))||!(!n||""!=t.nodeValue.replace(a,""));if(1==t.nodeType){if("none"==i.getComputedStyle(t,"display"))return!0;var s=r.default(t);if("DIV"==s||"SPAN"==s){for(var l=t.firstChild;l;l=l.nextSibling)if(!e(l,n))return!1;return!0}return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.default=function(e,t){return!(!e||!r.default(e.rootNode,t)||e.nodeBefore&&4!=e.nodeBefore.compareDocumentPosition(t)||e.nodeAfter&&2!=e.nodeAfter.compareDocumentPosition(t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5);t.default=function(e,t){var n=t.createElement("DIV");return n.innerHTML=e,r.default(n.childNodes)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(90),i=n(52),o=n(7),a=n(14),s=n(25),l=n(91),u=n(92),d=n(32),c=n(8),f=function(){function e(e,t){this.scoper=e,this.skipTags=t}return e.createBodyTraverser=function(t,n,i){return new e(new r.default(t,n))},e.createSelectionTraverser=function(t,n,r){return new e(new u.default(t,n),r)},e.createBlockTraverser=function(t,n,r,i){return void 0===r&&(r=3),new e(new l.default(t,n,r))},Object.defineProperty(e.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!0,configurable:!0}),e.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},e.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},e.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement;if(!t)return null;var n=c.getLeafSibling(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e,this.skipTags),r=n?o.default(this.scoper.rootNode,n):null;return r&&this.scoper.isBlockInScope(r)&&(e&&r.isAfter(t)||!e&&t.isAfter(r))?(this.currentBlock=r,this.currentBlock):null},Object.defineProperty(e.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof i.default?null:this.currentInline},enumerable:!0,configurable:!0}),e.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},e.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},e.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n?(n instanceof i.default?(t=d.getInlineElementBeforeAfter(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):t=(t=function(e,t,n){if(!t)return null;if(t instanceof s.default){var r=n?t.nextInlineElement:t.previousInlineElement;if(r)return r}var i=t.getContainerNode();return i=c.getLeafSibling(e,i,n),a.default(e,i)}(this.scoper.rootNode,n,e))&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null,t&&(t=this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null):null},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(29),i=n(12),o=n(4),a=function(){function e(e,t){this.containerNode=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return 3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent},e.prototype.getContainerNode=function(){return this.containerNode},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return new o.default(this.containerNode,0).normalize()},e.prototype.getEndPosition=function(){return new o.default(this.containerNode,-1).normalize()},e.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},e.prototype.isAfter=function(e){return e&&i.default(this.containerNode,e.getContainerNode())},e.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},e.prototype.applyStyle=function(e){r.default(this.containerNode,e)},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(29),i=n(10),o=n(4),a=n(8),s=function(){function e(e,t,n){this.inlineElement=e,this.start=t,this.end=n}return e.prototype.getDecoratedInline=function(){return this.inlineElement},e.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},e.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},e.prototype.getTextContent=function(){return i.default(this.getStartPosition(),this.getEndPosition()).toString()},e.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},e.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(e.prototype,"nextInlineElement",{get:function(){return this.end&&new e(this.inlineElement,this.end,null)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousInlineElement",{get:function(){return this.start&&new e(this.inlineElement,null,this.start)},enumerable:!0,configurable:!0}),e.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},e.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},e.prototype.isAfter=function(e){var t=this.getStartPosition(),n=e&&e.getEndPosition();return n&&(t.isAfter(n)||t.equalTo(n))},e.prototype.applyStyle=function(e){var t=this.getStartPosition().normalize(),n=this.getEndPosition().normalize(),i=this.getContainerNode();if(t.isAtEnd){var s=a.getNextLeafSibling(i,t.node);t=s?new o.default(s,0):null}if(0==n.offset){var l=a.getPreviousLeafSibling(i,n.node);n=l?new o.default(l,-1):null}r.default(i,e,t,n)},e}();t.default=s},function(e,t,n){"use strict";function r(e,t){var n=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),r=-1!=e.indexOf("MSIE")||n,i=!1,o=!1,a=!1,s=!1,l=-1!=e.indexOf("WebKit");return r||(i=-1!=e.indexOf("Chrome"),o=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(a=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(s=-1!=e.indexOf("Edge"))&&(l=i=o=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:l,isIE:r,isIE11OrGreater:n,isSafari:a,isChrome:i,isFirefox:o,isEdge:s,isIEOrEdge:r||s}}Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserInfo=r,t.Browser=window?r(window.navigator.userAgent,window.navigator.appVersion):{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(31),i=n(1);t.default=function(e,t){var n;if(!e||!t)return null;for(var o=e.ownerDocument.createElement(t),a=0;a<e.attributes.length;a++){var s=e.attributes[a];o.setAttribute(s.name,s.value)}for(;e.firstChild;)o.appendChild(e.firstChild);return"P"!=i.default(e)&&"P"!=i.default(o)||(n=r.default(e,["margin-top","margin-bottom"]),o.style.marginTop=n[0],o.style.marginBottom=n[1]),e.parentNode&&e.parentNode.replaceChild(o,e),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(66),i=n(0);t.default=function(e,t,n){e.focus(),e.addUndoSnapshot((function(o,a){if(!n||n()){var s=e.getSelectedRegions(),l=i.VListChain.createListChains(s,null==o?void 0:o.node);s.forEach((function(e){return t(e,o,a,l)})),r.default(e,l)}e.select(o,a)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(4),o=n(30),a=n(13),s=n(8),l=n(17),u="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL".split(",");function d(e,t){e&&1==e.nodeType&&t(e,!0)}t.default=function(e,t,n,c){void 0===n&&(n=new i.default(e,0).normalize()),void 0===c&&(c=new i.default(e,-1).normalize());for(var f=[];n&&c&&c.isAfter(n);){var p=n.node,h=r.default(p.parentNode),v=s.getNextLeafSibling(e,p);3==p.nodeType&&["TR","TABLE"].indexOf(h)<0&&(p!=c.node||c.isAtEnd||(p=o.default(p,c.offset,!0)),n.offset>0&&(p=o.default(p,n.offset,!1)),f.push(p)),n=v&&new i.default(v,0)}if(f.length>0){if(f.every((function(e){return e.parentNode==f[0].parentNode}))){var g=f.shift();f.forEach((function(e){g.nodeValue+=e.nodeValue,e.parentNode.removeChild(e)})),f=[g]}f.forEach((function(e){for(;"SPAN"!=r.default(e)&&u.indexOf(r.default(e.parentNode))>=0;)d(e,t),e=l.splitBalancedNodeRange(e);"SPAN"!=r.default(e)&&(d(e,t),e=a.default(e,"SPAN")),t(e)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=e.nodeValue.substr(0,t),i=e.nodeValue.substr(t),o=e.ownerDocument.createTextNode(n?r:i);return e.nodeValue=n?i:r,e.parentNode.insertBefore(o,n?e:e.nextSibling),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19);function i(e,t){void 0===t&&(t=["font-family","font-size","color","background-color"]);var n=r.default(e),i=[];if(t=Array.isArray(t)?t:[t],n){var a=(n.ownerDocument.defaultView||window).getComputedStyle(n);if(a)for(var s=0,l=t;s<l.length;s++){var u=l[s],d=(a.getPropertyValue(u)||"").toLowerCase();d="font-size"==u?o(d):d,i.push(d)}}return i}function o(e){return e&&e.indexOf("px")==e.length-2?Math.round(75*parseFloat(e)+.05)/100+"pt":e}t.default=i,t.getComputedStyle=function(e,t){return i(e,t)[0]||""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),i=n(25),o=n(20),a=n(8);function s(e,t,n){if(!e||!t||!t.node)return null;var s=(t=t.normalize()).node,l=t.offset,u=t.isAtEnd,d=!1;!n&&0==l&&!u||n&&u?s=a.getLeafSibling(e,s,n):3==s.nodeType&&(!n&&!u||n&&l>0)&&(d=!0),s&&o.default(s)&&(s=a.getLeafSibling(e,s,n));var c=r.default(e,s);return c&&(d||c.contains(t))&&(c=n?new i.default(c,t,null):new i.default(c,null,t)),c}t.getInlineElementBefore=function(e,t){return s(e,t,!1)},t.getInlineElementAfter=function(e,t){return s(e,t,!0)},t.getInlineElementBeforeAfter=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){Array.prototype.push.apply(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=["IMG"],o=["TABLE","IMG","LI"].join(","),a=/\u200b/g;function s(e,t){return e=e.replace(a,""),t?e.trim():e}t.default=function(e,t){if(!e)return!1;if(3==e.nodeType)return""==s(e.nodeValue,t);if(1==e.nodeType){var n=e;if(""!=s(n.textContent,t)||i.indexOf(r.default(n))>=0||n.querySelectorAll(o)[0])return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e||{left:0,right:0,top:0,bottom:0},n=t.left,r=t.right,i=t.top,o=t.bottom;return n+r+i+o>0?{left:Math.round(n),right:Math.round(r),top:Math.round(i),bottom:Math.round(o)}:null}},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var i=n(27),o=n(38),a=n(1),s=n(18),l=n(34),u=n(4),d=n(15),c=n(3),f=n(17),p=n(5),h=n(35),v=n(54),g=n(13),m=function(){function e(e){if(this.rootList=e,this.items=[],!e)throw new Error("rootList must not be null");y(this.rootList),d.default(this.rootList,"ol,ul",y),d.default(this.rootList,"li",E),this.populateItems(this.rootList)}return e.prototype.contains=function(e){return this.items.some((function(t){return t.contains(e)}))},e.prototype.getLastItemNumber=function(){var e=b(this.rootList);return void 0===e?e:e-1+this.items.filter((function(e){return 1==e.getListType()&&1==e.getLevel()})).length},e.prototype.writeBack=function(){var e=this;if(!this.rootList)throw new Error("rootList must not be null");var t,n=this.rootList.ownerDocument,r=[n.createDocumentFragment()],i=n.createTextNode(""),o=b(this.rootList)||1;this.rootList.parentNode.replaceChild(i,this.rootList),this.items.forEach((function(n){n.writeBack(r,e.rootList);var i=r[1];c.default(i,"HTMLOListElement")&&(t!=i&&(1==o?i.removeAttribute("start"):i.start=o),1==n.getLevel()&&o++),t=i})),i.parentNode.replaceChild(r[0],i),this.rootList=null},e.prototype.setIndentation=function(e,t,n){this.findListItems(e,t,(function(e){return 1==n?e.outdent():e.indent()}))},e.prototype.changeListType=function(e,t,n){var r=!1;this.findListItems(e,t,(function(e){r=r||e.getListType()!=n})),this.findListItems(e,t,(function(e){return r?e.changeListType(n):e.outdent()}))},e.prototype.appendItem=function(e,t){var n=a.default(e);"DIV"==n?e=i.default(e,"LI"):"LI"!=n&&(e=g.default(e,"LI")),this.items.push(0==t?new v.default(e):new v.default(e,t))},e.prototype.mergeVList=function(e){var t,n=this;if(e&&e!=this){var r=this.items.length;e.items.forEach((function(e){return n.items.push(e)})),e.items.splice(0,e.items.length),this.mergeOrphanNodesAfter(r-1),null===(t=e.rootList.parentNode)||void 0===t||t.removeChild(e.rootList)}},e.prototype.mergeOrphanNodesAfter=function(e){var t=this.items[e];if(t&&!t.isOrphanItem())for(var n=e+1;n<=this.items.length;n++)if(!t||!t.canMerge(this.items[n])){t.mergeItems(this.items.splice(e+1,n-e-1));break}},e.prototype.findListItems=function(e,t,n){if(0==this.items.length)return[];var r=new u.default(this.items[0].getNode(),0),i=new u.default(this.items[this.items.length-1].getNode(),-1),o=r.isAfter(e)?0:-1,a=this.items.length-(t.isAfter(i)?1:0);this.items.forEach((function(n,r){o=n.contains(e.node)?r:o,a=n.contains(t.node)?r:a})),o=a<this.items.length?Math.max(0,o):o,a=o>=0?Math.min(this.items.length-1,a):a;var s=o<=a?this.items.slice(o,a+1):[];return n&&(s.forEach(n),this.mergeOrphanNodesAfter(a)),s},e.prototype.populateItems=function(e,t){void 0===t&&(t=[]);for(var n=o.default(e),i=e.firstChild;i;i=i.nextSibling){var a=r(t,[n]);o.isListElement(i)?this.populateItems(i,a):3==i.nodeType&&""==i.nodeValue.trim()||this.items.push(new(v.default.bind.apply(v.default,r([void 0,i],a))))}},e}();function y(e){var t=null;p.default(e.childNodes).forEach((function(e){"LI"==a.default(e)?t=e:o.isListElement(e)?t=null:t&&!l.default(e,!0)&&t.appendChild(s.default(e)?e:g.default(e))}))}function E(e){for(;!o.isListElement(e.parentNode);){f.default(e,!0);var t=p.default(e.parentNode.childNodes).slice(1);t.length>0&&(s.default(t[0])||(t=[g.default(t)]),t.forEach((function(t){return e.appendChild(t)}))),h.default(e.parentNode)}}function b(e){return c.default(e,"HTMLOListElement")?e.start:void 0}t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);function i(e){switch(r.default(e)){case"OL":return 1;case"UL":return 2;default:return 0}}t.default=i,t.isListElement=function(e){return 0!=i(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=n(4),o=n(8);t.default=function(e){if(!e)return null;var t=e.nodeBefore,n=e.nodeAfter,a=e.rootNode,s=e.skipTags,l=t?o.getNextLeafSibling(e.rootNode,t,e.skipTags):a.firstChild,u=n?o.getPreviousLeafSibling(a,n,s):a.lastChild,d=l&&u&&r.default(l,u);if(!function(e){var t=e;return!!t.fullSelectionEnd&&!!t.fullSelectionStart}(e))return d;if(d){var c=i.default.getStart(d).normalize(),f=i.default.getEnd(d).normalize(),p=e.fullSelectionEnd,h=e.fullSelectionStart;if(h.isAfter(f)||c.isAfter(p))return null;var v=h.isAfter(c)?h:c,g=p.isAfter(f)?f:p;return r.default(v,g)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach((function(e){var n=e.indexOf(":"),r=e.slice(0,n),i=e.slice(n+1);r&&i&&(t[r.trim()]=i.trim())})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e){var n=Object.keys(t||{}).map((function(e){var n=t[e];return e=e?e.trim():null,n=n?n.trim():null,e&&n?e+":"+n:null})).filter((function(e){return e})).join(";");n?e.setAttribute("style",n):e.removeAttribute("style")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.currentIndex+t;return n>=0&&n<e.snapshots.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(85))},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(87),o=n(151),a=n(152),s=n(153),l=n(154),u=n(155),d=n(156),c=n(157),f=n(158),p=r(r(r(r(r(r(r(r(r({},s.ListFeatures),u.QuoteFeatures),f.TableFeatures),c.StructuredNodeFeatures),i.AutoLinkFeatures),d.ShortcutFeatures),o.CursorFeatures),l.MarkdownFeatures),a.EntityFeatures);t.default=function(){return p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(12),o=function(){function e(e){this.element=e}return e.prototype.collapseToSingleElement=function(){return this.element},e.prototype.getStartNode=function(){return this.element},e.prototype.getEndNode=function(){return this.element},e.prototype.equals=function(e){return this.element==e.getStartNode()},e.prototype.isAfter=function(e){return i.default(this.element,e.getEndNode())},e.prototype.contains=function(e){return r.default(this.element,e,!0)},e.prototype.getTextContent=function(){return this.element?this.element.textContent:""},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(",");t.default=function(e){return!!e&&i.indexOf(r.default(e))>=0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7);t.default=function(e,t){var n=e;do{n=n&&(t?n.firstChild:n.lastChild)}while(n&&n.firstChild);return n&&r.default(e,n)}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){return e.call(this,t,n)||this}return i(t,e),t}(n(24).default);t.default=o},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){return e.call(this,t,n)||this}return i(t,e),t}(n(24).default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),i=n(51);t.getFirstInlineElement=function(e){var t=i.getFirstLeafNode(e);return t?r.default(e,t):null},t.getLastInlineElement=function(e){var t=i.getLastLeafNode(e);return t?r.default(e,t):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20),i=n(8);function o(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},o=n(e);o&&n(o);)o=n(o);return o&&r.default(o)&&(o=i.getLeafSibling(e,o,t)),o}t.getFirstLeafNode=function(e){return o(e,!0)},t.getLastLeafNode=function(e){return o(e,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.position=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return""},e.prototype.getContainerNode=function(){return this.position.node},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return this.position},e.prototype.getEndPosition=function(){return this.position},e.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},e.prototype.isTextualInlineElement=function(){return!1},e.prototype.contains=function(e){return!1},e.prototype.applyStyle=function(e){},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.default=function(e){if(r.default(e,"HTMLElement"))return e.innerHTML;if(e){var t=e.ownerDocument.createElement("span");return t.appendChild(e.cloneNode(!0)),t.innerHTML}return""}},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=n(38),a=n(1),s=n(18),l=n(5),u=n(35),d=n(13),c=[null,"lower-alpha","lower-roman"],f=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.node=e,!e)throw new Error("node must not be null");this.listTypes=r([0],t)}return e.prototype.getListType=function(){return this.listTypes[this.listTypes.length-1]},e.prototype.getLevel=function(){return this.listTypes.length-1},e.prototype.getNode=function(){return this.node},e.prototype.contains=function(e){return i.default(this.node,e,!0)},e.prototype.isOrphanItem=function(){return"LI"!=a.default(this.node)},e.prototype.canMerge=function(e){return!(!(null==e?void 0:e.isOrphanItem())||this.listTypes.length!=e.listTypes.length)&&this.listTypes.every((function(t,n){return e.listTypes[n]==t}))},e.prototype.mergeItems=function(e){var t=this;h((null==e?void 0:e.map((function(e){return e.node})))||[],!0,!1).forEach((function(e){return t.node.appendChild(e)}))},e.prototype.indent=function(){var e=this.getListType();0!=e&&this.listTypes.push(e)},e.prototype.outdent=function(){this.listTypes.length>1&&this.listTypes.pop()},e.prototype.changeListType=function(e){0==e?this.listTypes=[e]:(this.outdent(),this.listTypes.push(e))},e.prototype.writeBack=function(e,t){for(var n,r,i=1;i<e.length;i++)if(o.default(e[i])!==this.listTypes[i]){e.splice(i);break}for(;i<this.listTypes.length;i++){var s=p(e[0],this.listTypes[i],i,t);e[e.length-1].appendChild(s),e.push(s)}e[e.length-1].appendChild(this.node),this.listTypes.length<=1&&h("LI"==a.default(this.node)?(n=this.node,r=l.default(n.childNodes),u.default(n),r):[this.node],!0,!0)},e}();function p(e,t,n,r){var a,s=e.ownerDocument;if(1==n&&r&&t==o.default(r))if(i.default(e,r))(a=r.cloneNode(!1)).removeAttribute("id");else{for(;r.firstChild;)r.removeChild(r.firstChild);a=r}else a=s.createElement(1==t?"ol":"ul");return 1==t&&n>1&&(a.style.listStyleType=c[(n-1)%c.length]),a}function h(e,t,n){return!(e.length>0)||t&&s.default(e[0])||n&&s.default(e[e.length])||(e=[d.default(e)]),e}t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19);t.default=function(e,t,n){var i=e&&r.default(n,e.rootNode,t);if(i)for(var o=void 0;o=r.default(i.parentNode,e.rootNode,t);)i=o;return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),i=n(22),o=n(7),a=n(39),s=n(20);t.default=function(e,t){var n=a.default(e),l=[];if(n){for(var u=e.rootNode,d=e.skipTags,c=r.default.createSelectionTraverser(u,n,d),f=null==c?void 0:c.currentBlockElement;f;f=c.getNextBlockElement())l.push(f);l=l.filter((function(e){var t,n=e.getStartNode();return n!=e.getEndNode()||!s.default(n,!0)||(null===(t=n.parentNode)||void 0===t||t.removeChild(n),!1)}))}if(0==l.length&&e&&!e.rootNode.firstChild&&t){var p=i.default("<div><br></div>",e.rootNode.ownerDocument)[0];e.rootNode.appendChild(p),l.push(o.default(e.rootNode,p))}return l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(19),o=n(4),a=n(15),s=n(103),l=n(8);function u(e,t){var n=o.default.getStart(e).normalize(),i=o.default.getEnd(e).normalize();return function(e,o,a){return function(e,t,n,i){if(e){var o=t&&l.getNextLeafSibling(e,t,i),a=n&&l.getPreviousLeafSibling(e,n,i),s=!t||r.default(e,t)&&r.default(e,o),u=!n||r.default(e,n)&&r.default(e,a),d=!(t&&n&&(r.default(t,n,!0)||r.default(t,a,!0)||r.default(n,t,!0)||r.default(n,o,!0)));return s&&u&&d}return!1}(e,o,a,t)?{rootNode:e,nodeBefore:o,nodeAfter:a,skipTags:t,fullSelectionStart:n,fullSelectionEnd:i}:null}}t.default=function(e,t,n){var o=[];if(e&&t){var l=s.default[n],d=l.innerSelector,c=l.skipTags,f=function(e,t,n){var o=[{innerNode:e,children:[]}],l=s.default[n],u=l.outerSelector,d=l.innerSelector,c=a.default(e,u,null,2,t);return a.default(e,d,(function(t){var n=i.default(t,e,u);if(n&&c.indexOf(n)<0){for(var a={innerNode:t,children:[]},s=o.length-1;s>=0;s--){var l=o[s],d=l.innerNode,f=l.children;if(r.default(d,n)){var p=f.filter((function(e){return e.outerNode==n}))[0];p||(p={outerNode:n,boundaries:[]},f.push(p)),p.boundaries.push(a);break}}o.push(a)}}),1,t),o[0]}(e,t,n),p=i.default(t.startContainer,e,d)||e,h=i.default(t.endContainer,e,d)||e;o=function e(t,n,r,i,o){var a;o=o||n.innerNode==r;var s=!1,l=n.children,u=n.innerNode,d=[];if(0==l.length)d.push(t(u));else for(var c=0;c<=l.length&&!s;c++){var f=l[c]||{},p=f.outerNode,h=f.boundaries,v=null===(a=l[c-1])||void 0===a?void 0:a.outerNode;o&&d.push(t(u,v,p)),null==h||h.forEach((function(n){var a,l;l=(a=e(t,n,r,i,o))[0],o=a[1],s=a[2],d=d.concat(l)}))}return[d,o,s||u==i]}(u(t,c),f,p,h)[0]}return o.filter((function(e){return!!e}))},t.getRegionCreator=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(21),o=n(3);t.default=function(e,t){if(!t||0==t.length)return[];var n=o.default(t[0],"Node")?t:[t[0].getStartNode(),t[t.length-1].getEndNode()],a=(n=n&&n.filter((function(t){return i.default(e,t)})))[0],s=n[n.length-1];return i.default(e,a)&&i.default(e,s)?r.default(e.rootNode,a,s,!0):[]}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(27),o=n(2),a=n(7),s=n(60),l=n(40),u=n(21),d=n(41),c=n(16),f=n(0);t.default=function(e,t,n){var p,h,v;if(u.default(e,t)&&u.default(e,n)&&(v=a.default(e.rootNode,n))&&!v.contains(t)){for(var g=v.collapseToSingleElement(),m=c.collapse(e.rootNode,g,t,!1,!0),y=g;o.default(m,y);){var E=y.parentNode;if(f.safeInstanceOf(E,"HTMLElement")){var b=r(r(r({},s.default(E)||{}),l.default(E)),l.default(g));d.default(g,b)}y=E}var C=null,S=1==g.childNodes.length&&0==g.attributes.length?g.firstChild:i.default(g,"SPAN");for(y=S;o.default(m,y)&&1==y.parentNode.childNodes.length;y=y.parentNode)C=y.parentNode;null===(p=t.parentNode)||void 0===p||p.insertBefore(S,t.nextSibling),null===(h=null==C?void 0:C.parentNode)||void 0===h||h.removeChild(C)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i={B:{"font-weight":"bold"},EM:{"font-style":"italic"},I:{"font-style":"italic"},U:{"text-decoration":"underline"},P:{"margin-top":"1em","margin-bottom":"1em"},PRE:{"white-space":"pre"},S:{"text-decoration":"line-through"},STRIKE:{"text-decoration":"line-through"},SUB:{"vertical-align":"sub","font-size":"smaller"},SUP:{"vertical-align":"super","font-size":"smaller"}};t.default=function(e,t){var n=r.default(e);return i[n]||(t||{})[n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(4);function o(e,t){if(!e||!t)return[];var n,i=e.node,o=e.offset,a=[];if(!r.default(t,i,!0))return[];if(3==i.nodeType){for(n=i.parentNode;i.previousSibling&&3==i.previousSibling.nodeType;)o+=i.previousSibling.nodeValue.length,i=i.previousSibling;a.unshift(o)}else n=i,i=i.childNodes[o];do{o=0;for(var s=!1,l=n.firstChild;l&&l!=i;l=l.nextSibling){if(3==l.nodeType){if(0==l.nodeValue.length||s)continue;s=!0}else s=!1;o++}a.unshift(o),i=n,n=n.parentNode}while(i&&i!=t);return a}t.default=function(e,t){return t?{start:o(i.default.getStart(t),e),end:o(i.default.getEnd(t),e)}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42);t.default=function(e){if(r.default(e,1)){for(var t=0,n=e.currentIndex+1;n<e.snapshots.length;n++)t+=e.snapshots[n].length;e.snapshots.splice(e.currentIndex+1),e.totalSize-=t,e.autoCompleteIndex=-1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",");t.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&t.getComputedStyle(e),i={};return r.forEach((function(e){return i[e]=n&&n.getPropertyValue(e)||""})),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneObject=Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n=t||{};if(e)for(var r=0,i=Object.keys(e);r<i.length;r++){var o=i[r];n[o]=e[o]}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=e.ctrlKey||"Control"===e.key,n=e.altKey||"Alt"===e.key,r=e.metaKey||"Meta"===e.key;return t||n||r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){if((null==t?void 0:t.length)>0){var n=e.getSelectionRange(),i=n&&r.Position.getStart(n),o=n&&r.Position.getEnd(n);t.forEach((function(e){return e.commit()})),e.select(i,o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11);t.default=function(e,t){if("string"==typeof t){var n=t.trim();r.default(e,(function(e,t){e.style.backgroundColor=t?"":n}))}else{var i=e.isDarkMode(),o=i?t.darkModeColor:t.lightModeColor;r.default(e,(function(e,n){e.style.backgroundColor=n?"":o,i&&(e.dataset.ogsb=t.lightModeColor)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11);t.default=function(e,t){t=t.trim(),r.default(e,(function(e,n){e.style.fontFamily=n?"":t}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=n(0);t.default=function(e,t){t=t.trim(),r.default(e,(function(e,n){e.style.fontSize=n?"":t,"normal"!=i.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11);t.default=function(e,t){if("string"==typeof t){var n=t.trim();r.default(e,(function(e,t){e.style.color=t?"":n}))}else{var i=e.isDarkMode(),o=i?t.darkModeColor:t.lightModeColor;r.default(e,(function(e,n){e.style.color=n?"":o,i&&(e.dataset.ogsc=t.lightModeColor)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);t.default=function(e){r.default(e,"bold")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);t.default=function(e){r.default(e,"italic")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);t.default=function(e){r.default(e,"underline")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(28),i=n(0);t.default=function(e,t,n){r.default(e,(function(e,r,o,a){var s,l=n>0&&a.filter((function(e){return e.canAppendAtCursor(n)}))[0],u=l&&r.equalTo(o)?l.createVListAtBlock(null===(s=i.getBlockElementAtNode(e.rootNode,r.node))||void 0===s?void 0:s.collapseToSingleElement(),n):i.createVListFromRegion(e,!0);u&&(u.changeListType(r,o,t),u.writeBack())}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(28),i=n(0);t.default=function(e,t,n){r.default(e,(function(e){var n=i.getSelectedBlockElementsInRegion(e,!0),r=i.collapseNodesInRegion(e,n);if(r.length>0){if(1==r.length){var o=i.getTagOfNode(r[0]);"BR"==o?r=[i.wrap(r[0])]:"LI"!=o&&"TD"!=o||(r=i.toArray(r[0].childNodes))}for(;r[0]&&i.isNodeInRegion(e,r[0].parentNode)&&r.some((function(e){return"LI"==i.getTagOfNode(e)}));)r=[i.splitBalancedNodeRange(r)];t(r)}}),n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(159);t.Editor=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.hasFocus=function(e){var t=e.contentDiv.ownerDocument.activeElement;return t&&r.contains(e.contentDiv,t,!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(187))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(189))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){var n=t.getAttribute("NodeId");return n||(n=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute("NodeId",n)),n}t.createCustomData=function(){return{dict:{},nextNodeId:1}},t.setObject=function(e,t,n,i){if(1==t.nodeType){var o=r(e,t);""!=o&&(e.dict[o]||(e.dict[o]={}),e.dict[o][n]=i)}},t.getObject=function(e,t,n){if(1==t.nodeType){var i=r(e,t);if(""!=i)return e.dict[i]&&e.dict[i][n]}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLevelLists=function(){return{listsMetadata:{},currentUniqueListId:-1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WORD_ORDERED_LIST_SELECTOR='div.ListContainerWrapper > ul[class^="BulletListStyle"]',t.WORD_UNORDERED_LIST_SELECTOR='div.ListContainerWrapper > ol[class^="NumberListStyle"]',t.WORD_ONLINE_IDENTIFYING_SELECTOR=t.WORD_ORDERED_LIST_SELECTOR+","+t.WORD_UNORDERED_LIST_SELECTOR,t.LIST_CONTAINER_ELEMENT_CLASS_NAME="ListContainerWrapper",t.UNORDERED_LIST_TAG_NAME="UL",t.ORDERED_LIST_TAG_NAME="OL";t.WAC_IDENTIFING_SELECTOR='ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement'},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var i=n(84);t.createEditor=i.default,r(n(200)),r(n(0)),r(n(76)),r(n(6)),r(n(201))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=n(76),o=n(78),a=n(79);t.default=function(e,t,n){var s=[new o.HyperLink,new a.Paste,new r.ContentEdit];t&&(s=s.concat(t));var l={plugins:s,initialContent:n,defaultFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new i.Editor(e,l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(86);t.ContentEdit=r.default;var i=n(44);t.getAllFeatures=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),i=function(){function e(e,t){this.settingsOverride=e,this.additionalFeatures=t}return e.prototype.getName=function(){return"ContentEdit"},e.prototype.initialize=function(e){var t=this,n=[],i=r.default();Object.keys(i).forEach((function(e){var r=i[e],o=t.settingsOverride&&void 0!==t.settingsOverride[e];(o&&t.settingsOverride[e]||!o&&!r.defaultDisabled)&&n.push(r)})),n.concat(this.additionalFeatures||[]).forEach((function(t){return e.addContentEditFeature(t)}))},e.prototype.dispose=function(){},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(0),o=/[.+=\s:;"',>]+$/i,a={keys:[13,32,257],shouldHandleEvent:l,handleEvent:function(e,t){var n=t.getDocument().createElement("a"),o=l(e,t),a=t.getContentSearcherOfCursor();n.textContent=o.originalUrl,n.href=o.normalizedUrl,t.runAsync((function(t){t.addUndoSnapshot((function(){return r.replaceWithNode(t,o.originalUrl,n,!1,a),i.clearEventDataCache(e),n}),"AutoLink",!0)}))}},s={keys:[8],shouldHandleEvent:function(e,t){return t.getContentSearcherOfCursor(e).getInlineElementBefore()instanceof i.LinkInlineElement},handleEvent:function(e,t){e.rawEvent.preventDefault(),r.removeLink(t)},defaultDisabled:!0};function l(e,t){return 0==e.eventType||7==e.eventType&&"Paste"==e.source?i.cacheGetEventData(e,"LINK_DATA",(function(){var n=7==e.eventType&&"Paste"==e.source&&e.data,r=i.matchLink((n.text||"").trim()),a=t.getContentSearcherOfCursor(e);if(r&&a.getRangeFromText(r.originalUrl,!1))return r;var s=a&&a.getWordBefore();if(s&&s.length>5){var l=(s.match(o)||[])[0]||"",u=s.substring(0,s.length-l.length);return["()","{}","[]"].forEach((function(e){u[u.length-1]==e[1]&&u.indexOf(e[0])<0&&(u=u.substr(0,u.length-1))})),i.matchLink(u)}return null})):null}t.AutoLinkFeatures={autoLink:a,unlinkWhenBackspaceAfterLink:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=n(0);t.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];function o(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,1);else if(e>r||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),1e3);else if(1==t){for(var i=0;i<n.length;i++)if(e<n[i]){e=n[i];break}}else for(i=n.length-1;i>=0;i--)if(e>n[i]){e=n[i];break}return e}t.default=function(e,n,a){void 0===a&&(a=t.FONT_SIZES);var s=0==n?1:-1;r.default(e,(function(e){var t=parseFloat(i.getComputedStyle(e,"font-size"));e.style.fontSize=o(t,s,a)+"pt","normal"!=i.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")}))},t.getNewFontSize=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(2),o=n(10),a=n(1),s=n(18),l=n(12),u=n(13),d=n(17),c=["TD","TH","LI","BLOCKQUOTE"],f=function(){function e(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}return e.getBlockContext=function(e){for(;e&&!s.default(e);)e=e.parentNode;return e},e.prototype.collapseToSingleElement=function(){for(var t=r.default(e.getBlockContext(this.startNode),this.startNode,this.endNode,!0),n=e.getBlockContext(this.startNode);t[0]&&t[0]!=n&&t[0].parentNode!=this.rootNode&&c.indexOf(a.default(t[0].parentNode))<0;)t=[d.splitBalancedNodeRange(t)];return 1==t.length&&s.default(t[0])?t[0]:u.default(t)},e.prototype.getStartNode=function(){return this.startNode},e.prototype.getEndNode=function(){return this.endNode},e.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},e.prototype.isAfter=function(e){return l.default(this.getStartNode(),e.getEndNode())},e.prototype.contains=function(e){return i.default(this.startNode,e,!0)||i.default(this.endNode,e,!0)||l.default(e,this.startNode)&&l.default(this.endNode,e)},e.prototype.getTextContent=function(){var e=o.default(this.getStartNode(),this.getEndNode());return e?e.toString():""},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(7),o=n(47),a=n(14),s=n(50),l=function(){function e(e,t){this.rootNode=e,this.startNode=r.default(e,t)?t:null}return e.prototype.getStartBlockElement=function(){return this.startNode?i.default(this.rootNode,this.startNode):o.default(this.rootNode,!0)},e.prototype.getStartInlineElement=function(){return this.startNode?a.default(this.rootNode,this.startNode):s.getFirstInlineElement(this.rootNode)},e.prototype.isBlockInScope=function(e){return r.default(this.rootNode,e.getStartNode())},e.prototype.trimInlineElement=function(e){return e},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(52),i=n(7),o=n(14),a=n(45),s=n(4),l=n(3),u=n(32),d=n(50),c=function(){function e(e,t,n){this.rootNode=e,this.startFrom=n,t=l.default(t,"Range")?s.default.getStart(t):t,this.position=t.normalize(),this.block=i.default(this.rootNode,this.position.node)}return e.prototype.getStartBlockElement=function(){return this.block},e.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:case 2:return function(e,t){if(e instanceof a.default){var n=e.getStartNode();return t?d.getFirstInlineElement(n):d.getLastInlineElement(n)}return o.default(e,t?e.getStartNode():e.getEndNode())}(this.block,0==this.startFrom);case 3:var e=u.getInlineElementAfter(this.rootNode,this.position);return e&&this.block.contains(e.getContainerNode())?e:new r.default(this.position,this.block)}return null},e.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},e.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=n(25),o=n(4),a=n(32),s=function(){function e(e,t){this.rootNode=e,this.start=o.default.getStart(t).normalize(),this.end=o.default.getEnd(t).normalize()}return e.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=r.default(this.rootNode,this.start.node)),this.startBlock},e.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement(a.getInlineElementAfter(this.rootNode,this.start))),this.startInline},e.prototype.isBlockInScope=function(e){if(!e)return!1;var t=!1,n=this.getStartBlockElement();if(this.start.equalTo(this.end))t=n&&n.equals(e);else{var i=r.default(this.rootNode,this.end.node);t=n&&i&&(e.equals(n)||e.equals(i)||e.isAfter(n)&&i.isAfter(e))}return t},e.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var r=!1,o=!1;return this.start.isAfter(t)&&(t=this.start,r=!0),n.isAfter(this.end)&&(n=this.end,o=!0),t.isAfter(n)||t.equalTo(n)?null:r||o?new i.default(e,r&&t,o&&n):e},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),i=n(10),o=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i,a=function(){function e(e,t){this.rootNode=e,this.position=t,this.text="",this.inlineElements=[]}return e.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse((function(){return e.word})),this.word},e.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},e.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=r.default.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},e.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse((function(){return t.text.length>=e})),this.text.substr(Math.max(0,this.text.length-e))},e.prototype.getRangeFromText=function(e,t){if(!e)return null;var n,r,o=e.length-1;return this.forEachTextInlineElement((function(i){for(var a=i.getTextContent()||"",s=a.length-1;s>=0&&o>=0;s--)if(e.charCodeAt(o)==a.charCodeAt(s))o--,r||(r=i.getStartPosition().move(s+1));else if(t||r)return!0;return-1==o&&(n=i.getStartPosition().move(s+1),!0)})),n&&r&&i.default(n,r)},e.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},e.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse((function(){return e.nearestNonTextInlineElement})),this.nearestNonTextInlineElement},e.prototype.traverse=function(e){if(this.traverser=this.traverser||r.default.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n=t.getTextContent();if(!this.word){var i=o.exec(n);i&&2==i.length&&(this.word=i[1]+this.text)}if(this.text=n+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(t){var r=e.style,i=t.fontFamily,o=t.fontSize,a=t.textColor,s=t.textColors,l=t.backgroundColor,u=t.backgroundColors,d=t.bold,c=t.italic,f=t.underline;i&&(r.fontFamily=i),o&&(r.fontSize=o),(a||s)&&(r.color=(n?null==s?void 0:s.darkModeColor:null==s?void 0:s.lightModeColor)||a,s&&n&&(e.dataset.ogsc=s.lightModeColor)),(l||u)&&(r.backgroundColor=(n?null==u?void 0:u.darkModeColor:null==u?void 0:u.lightModeColor)||l,u&&n&&(e.dataset.ogsb=u.lightModeColor)),d&&(r.fontWeight="bold"),c&&(r.fontStyle="italic"),f&&(r.textDecoration="underline")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=n(26),o=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i;function a(e){for(var t=e.items?e.items.length:0,n=0;n<t;n++){var r=e.items[n];if(r.type&&0==r.type.indexOf("image/"))return r.getAsFile()}t=e.files?e.files.length:0;for(n=0;n<t;n++){var i=e.files.item(n);if(i.type&&0==i.type.indexOf("image/"))return i}return null}function s(e){return new Promise((function(t){e.getAsString((function(e){t(e)}))}))}t.default=function(e,t,n){var l,u=e.clipboardData||e.target.ownerDocument.defaultView.clipboardData,d={types:u.types?r.default(u.types):[],text:u.getData("text"),image:a(u),rawHtml:void 0,customValues:{}},c=[];if(e.clipboardData&&e.clipboardData.items){e.preventDefault(),d.rawHtml=null;for(var f=e.clipboardData.items,p=function(e){var t=f[e];switch(t.type){case"text/html":c.push({promise:s(t),callback:function(e){d.rawHtml=i.Browser.isEdge?function(e){var t=o.exec(e);if(t&&3==t.length){var n=parseInt(t[1]),r=parseInt(t[2]);n>0&&r>n&&(e=e.substring(n,r))}return e}(e):e}});break;case"text/link-preview":(null==n?void 0:n.allowLinkPreview)&&c.push({promise:s(t),callback:function(e){try{d.linkPreview=JSON.parse(e)}catch(e){}}});break;default:if(0==t.type.indexOf("text/")){var r=t.type.substr("text/".length);(null===(l=null==n?void 0:n.allowedCustomPasteType)||void 0===l?void 0:l.indexOf(r))>=0&&c.push({promise:s(t),callback:function(e){return d.customValues[r]=e}})}}},h=0;h<f.length;h++)p(h)}Promise.all(c.map((function(e){return e.promise}))).then((function(e){for(var n=0;n<c.length;n++)c[n].callback(e[n]);t(d)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendableFormatCommandMap={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"},t.default=function(e){return Object.keys(t.PendableFormatCommandMap).reduce((function(n,r){return n[r]=e.queryCommandState(t.PendableFormatCommandMap[r]),n}),{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,i="(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)*[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",o={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+i+"|www\\."+i,"i"),except:r,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+i,"i"),except:r},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+i+"|ftp\\."+i,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+i,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+i,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+i,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+i,"i")}};t.default=function(e){if(e)for(var t=0,n=Object.keys(o);t<n.length;t++){var r=n[t],i=o[r],a=e.match(i.match);if(a&&a[0]==e&&(!i.except||!i.except.test(e)))return{scheme:r,originalUrl:e,normalizedUrl:i.normalizeUrl?i.normalizeUrl(e):e}}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23);t.default=function(e){for(var t=r.default.createBodyTraverser(e),n=t&&t.currentBlockElement,i=[];n;)i.push(n.getTextContent()),n=t.getNextBlockElement();return i.join("\n")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e&&t){var n=new FileReader;n.onload=function(){t(n.result)},n.onerror=function(){t(null)},n.readAsDataURL(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(36),i=n(3),o=n(5),a=function(){function e(e){var t=this;if(this.trs=[],this.table=i.default(e,"HTMLTableElement")?e:function(e){for(var t=e;t&&"TABLE"!=t.tagName;t=t.parentElement);return t}(e),this.table){var n=i.default(e,"HTMLTableElement")?null:e,r=o.default(this.table.rows);this.cells=r.map((function(e){return[]})),r.forEach((function(e,r){t.trs[r%2]=e;for(var i=0,o=0;i<e.cells.length;i++){for(;t.cells[r][o];o++);var a=e.cells[i];a==n&&(t.col=o,t.row=r);for(var s=0;s<a.colSpan;s++,o++)for(var l=0;l<a.rowSpan;l++)t.cells[r+l][o]={td:s+l==0?a:null,spanLeft:s>0,spanAbove:l>0}}}))}}return e.prototype.writeBack=function(){var e=this;this.cells?(d(this.table),this.cells.forEach((function(t,n){var r=u(e.trs[n%2]||e.trs[0]);e.table.appendChild(r),t.forEach((function(t,i){t.td&&(e.recalcSpans(n,i),r.appendChild(t.td))}))}))):this.table&&this.table.parentNode.removeChild(this.table)},e.prototype.applyFormat=function(e){e&&this.table&&(this.table.style.borderCollapse="collapse",this.trs[0].style.backgroundColor=e.bgColorOdd||"transparent",this.trs[1]&&(this.trs[1].style.backgroundColor=e.bgColorEven||"transparent"),this.cells.forEach((function(t){return t.filter((function(e){return e.td})).forEach((function(t){t.td.style.borderTop=s(e.topBorderColor),t.td.style.borderBottom=s(e.bottomBorderColor),t.td.style.borderLeft=s(e.verticalBorderColor),t.td.style.borderRight=s(e.verticalBorderColor)}))})))},e.prototype.edit=function(e){var t=this;if(this.table){var n=this.cells[this.row],r=n[this.col];switch(e){case 0:this.cells.splice(this.row,0,n.map(l));break;case 1:var i=this.row+this.countSpanAbove(this.row,this.col);this.cells.splice(i,0,this.cells[i-1].map((function(e,n){var r=t.getCell(i,n);if(r.spanAbove)return l(r);if(e.spanLeft){var o=l(e);return o.spanAbove=!1,o}return{td:u(t.getTd(t.row,n))}})));break;case 2:this.forEachCellOfCurrentColumn((function(e,n){n.splice(t.col,0,l(e))}));break;case 3:var o=this.col+this.countSpanLeft(this.row,this.col);this.forEachCellOfColumn(o-1,(function(e,n,r){var i,a=t.getCell(r,o);a.spanLeft?i=l(a):e.spanAbove?(i=l(e)).spanLeft=!1:i={td:u(t.getTd(r,t.col))},n.splice(o,0,i)}));break;case 6:this.forEachCellOfCurrentRow((function(e,n){var r=t.getCell(t.row+1,n);e.td&&e.td.rowSpan>1&&r.spanAbove&&(r.td=e.td)})),this.cells.splice(this.row,1);break;case 5:this.forEachCellOfCurrentColumn((function(e,n,r){var i=t.getCell(r,t.col+1);e.td&&e.td.colSpan>1&&i.spanLeft&&(i.td=e.td),n.splice(t.col,1)}));break;case 7:case 8:for(var a=7==e?-1:1,s=this.row+a;s>=0&&s<this.cells.length;s+=a){if((v=this.getCell(s,this.col)).td&&!v.spanAbove){var c=s<this.row?v:r,f=s<this.row?r:v;c.td.colSpan==f.td.colSpan&&(d(f.td,c.td),f.td=null,f.spanAbove=!0);break}}break;case 9:case 10:for(var p=9==e?-1:1,h=this.col+p;h>=0&&h<this.cells[this.row].length;h+=p){var v;if((v=this.getCell(this.row,h)).td&&!v.spanLeft){var g=h<this.col?v:r,m=h<this.col?r:v;g.td.rowSpan==m.td.rowSpan&&(d(m.td,g.td),m.td=null,m.spanLeft=!0);break}}break;case 4:this.cells=null;break;case 12:if(r.td.rowSpan>1)this.getCell(this.row+1,this.col).td=u(r.td);else{var y=n.map((function(e){return{td:e==r?u(e.td):null,spanAbove:e!=r,spanLeft:e.spanLeft}}));this.cells.splice(this.row+1,0,y)}break;case 11:r.td.colSpan>1?this.getCell(this.row,this.col+1).td=u(r.td):this.forEachCellOfCurrentColumn((function(e,r){r.splice(t.col+1,0,{td:r==n?u(e.td):null,spanAbove:e.spanAbove,spanLeft:r!=n})}))}}},e.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},e.prototype.getCellsWithBorder=function(e,t){for(var n=[],i=0,o=t?-1:Number.MAX_SAFE_INTEGER,a=0;a<this.cells.length;a++)for(var s=0;s<this.cells[a].length;s++){var l=this.getCell(a,s);if(l.td){var u=r.default(l.td.getBoundingClientRect()),d=!1;if(t){if(u.right==e)d=!0,u.left>o&&(o=u.left,i=n.length),l.td.setAttribute("originalLeftBorder",u.left.toString()),n.push(l.td);else if(d)break}else if(u.left==e)d=!0,u.right<o&&(o=u.right,i=n.length),l.td.setAttribute("originalRightBorder",u.right.toString()),n.push(l.td);else if(d)break}}if(n.length>0){var c=n[0];n[0]=n[i],n[i]=c}return n},e.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},e.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},e.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},e.prototype.getTd=function(e,t){if(this.cells&&(e=Math.min(this.cells.length-1,e),t=this.cells[e]?Math.min(this.cells[e].length-1,t):t,!isNaN(e)&&!isNaN(t)))for(;e>=0&&t>=0;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},e.prototype.forEachCellOfColumn=function(e,t){for(var n=0;n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},e.prototype.forEachCellOfRow=function(e,t){for(var n=0;n<this.cells[e].length;n++)t(this.getCell(e,n),n)},e.prototype.recalcSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},e.prototype.countSpanLeft=function(e,t){for(var n=1,r=t+1;r<this.cells[e].length;r++){var i=this.getCell(e,r);if(i.td||!i.spanLeft)break;n++}return n},e.prototype.countSpanAbove=function(e,t){for(var n=1,r=e+1;r<this.cells.length;r++){var i=this.getCell(r,t);if(i.td||!i.spanAbove)break;n++}return n},e}();function s(e){return"solid 1px "+(e||"transparent")}function l(e){return{td:u(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function u(e){var t=e?e.cloneNode(!1):null;return i.default(t,"HTMLTableCellElement")&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}function d(e,t){for(;e.firstChild;)t?t.appendChild(e.firstChild):e.removeChild(e.firstChild)}t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),i=n(55),o=n(56),a=n(21),s=n(4),l=n(3),u=n(20),d=n(5),c=n(37),f=n(13),p=n(8),h=n(38);function v(e,t,n){var r=t[n?t.length-1:0];r=p.getLeafSibling(e.rootNode,r,n,e.skipTags,!0),r=i.default(e,"ol,ul",r),a.default(e,r)&&h.isListElement(r)&&(n?l.default(r,"HTMLOListElement")&&1!=r.start||t.push(r):t.unshift(r))}t.default=function(e,t,n){if(!e)return null;var a=[];if(n){var p=i.default(e,"ol,ul",n);p&&a.push(p)}else{if(o.default(e).forEach((function(n){var r=i.default(e,"ol,ul",n.getStartNode());r?(a[a.length-1]!=r&&a.push(r),1==a.length&&l.default(r,"HTMLOListElement")&&r.start>1&&(t=!1)):a.push(n.collapseToSingleElement())})),0==a.length&&!e.rootNode.firstChild){var g=r.default("<div><br></div>",e.rootNode.ownerDocument)[0];e.rootNode.appendChild(g),a.push(g),e.fullSelectionStart=new s.default(g,0),e.fullSelectionEnd=new s.default(g,-1)}t&&(v(e,a,!1),v(e,a,!0)),a=a.filter((function(e){return!u.default(e,!0)}))}var m=null;if(a.length>0){var y=a.shift();m=h.isListElement(y)?new c.default(y):function(e){var t=d.default(e.childNodes),n=1==t.length?t[0]:f.default(t,"SPAN"),r=e.ownerDocument.createElement("ol");e.appendChild(r);var i=new c.default(r);return i.appendItem(n,0),i}(y),a.forEach((function(e){h.isListElement(e)?m.mergeVList(new c.default(e)):m.appendItem(e,0)}))}return m}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(33),i=n(55),o=n(12),a=n(21),s=n(15),l=n(37),u=0,d=function(){function e(e,t){this.region=e,this.name=t,this.lastNumber=0,this.lastNumberBeforeCursor=0}return e.createListChains=function(t,n,a){var l=Array.isArray(t)?t:t?[t]:[],u=[];return l.forEach((function(t){var l,d=[];s.default(t.rootNode,"ol",(function(r){var s=i.default(t,"ol",r);if(l!=s){var u=d.filter((function(e){return e.canAppendToTail(s)}))[0]||new e(t,(a||c)()),f=d.indexOf(u),p=n&&o.default(s,n);p?f<0&&d.push(u):(f>=0&&d.splice(f,1),d.unshift(u)),u.append(s,p),l=s}})),r.default(u,d)})),u},e.prototype.canAppendAtCursor=function(e){return this.lastNumberBeforeCursor+1==e},e.prototype.createVListAtBlock=function(e,t){if(e){var n=e.ownerDocument.createElement("ol");n.start=t,this.applyChainName(n),e.parentNode.insertBefore(n,e);var r=new l.default(n);return r.appendItem(e,0),r}return null},e.prototype.commit=function(){for(var e=this.getLists(),t=0,n=0;n<e.length;n++){var r=e[n];r.start=t+1;var i=new l.default(r);t=i.getLastItemNumber(),delete r.dataset.listchain,delete r.dataset.listchainafter,i.writeBack()}},e.prototype.canAppendToTail=function(e){return this.lastNumber+1==e.start},e.prototype.append=function(e,t){this.applyChainName(e),this.lastNumber=new l.default(e).getLastItemNumber(),t?e.dataset.listchainafter="true":this.lastNumberBeforeCursor=this.lastNumber},e.prototype.applyChainName=function(e){e.dataset.listchain=this.name},e.prototype.getLists=function(){var e=this;return s.default(this.region.rootNode,"ol[data-listchain="+this.name+"]").filter((function(t){return a.default(e.region,t)}))},e}();function c(){return"__List_Chain_"+u++}t.default=d},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var i=((r={})[0]={skipTags:["TABLE"],outerSelector:"table",innerSelector:"td,th"},r);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=n(36);t.default=function(e){if(!e)return null;var t=r.default(e),n=t.getBoundingClientRect&&i.default(t.getBoundingClientRect());if(n)return n;e=e.normalize();var o=t.getClientRects&&t.getClientRects();if(n=o&&1==o.length&&i.default(o[0]))return n;if(3==e.node.nodeType){var a=e.node.ownerDocument.createElement("SPAN");if(a.innerHTML="​",(t=r.default(e)).insertNode(a),n=a.getBoundingClientRect&&i.default(a.getBoundingClientRect()),a.parentNode.removeChild(a),n)return n}var s=e.element;return s&&s.getBoundingClientRect&&(n=i.default(s.getBoundingClientRect()))?n:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(1),o=n(34);function a(e){for(;e.previousSibling;)if(e=e.previousSibling,"BR"==i.default(e)||!o.default(e))return!1;return!0}t.default=function(e,t){if(e){var n=e.normalize(),i=n.node;if(0==n.offset){for(;r.default(t,i)&&a(i);)i=i.parentNode;return i==t}}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(53),i=n(61),o=n(1),a=n(15);t.default=function(e,t){if(!e)return"";var n=t||{},s=n.startContainer,l=n.endContainer,u=n.startOffset,d=n.endOffset,c=!1;if(a.default(e,"table",(function(e){for(var t=null,n=e.firstChild;n;n=n.nextSibling)"TR"==o.default(n)?(t||(t=e.ownerDocument.createElement("tbody"),e.insertBefore(t,n)),t.appendChild(n),n=t,c=!0):t=null})),t&&c)try{t.setStart(s,u),t.setEnd(l,d)}catch(e){}var f=r.default(e),p=t&&i.default(e,t);return p?f+"\x3c!--"+JSON.stringify(p)+"--\x3e":f}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e,t){e.innerHTML=t||"";var n=null,i=e.lastChild;try{(n=i&&8==i.nodeType&&JSON.parse(i.nodeValue))&&n.end&&n.end.length>0&&n.start&&n.start.length>0?e.removeChild(i):n=null}catch(e){}return n&&r.default(e,n.start,n.end)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26);t.default=function(e,t){var n,i,o,a=null===(o=null===(i=null===(n=null==e?void 0:e.commonAncestorContainer)||void 0===n?void 0:n.ownerDocument)||void 0===i?void 0:i.defaultView)||void 0===o?void 0:o.getSelection();if(a){var s=!0;if(a.rangeCount>0)try{var l=void 0;(t||r.Browser.isEdge)&&(l=1==a.rangeCount?a.getRangeAt(0):null)&&l.startContainer==e.startContainer&&l.startOffset==e.startOffset&&l.endContainer==e.endContainer&&l.endOffset==e.endOffset?s=!1:a.removeAllRanges()}catch(e){}s&&a.addRange(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(33),i=n(58),o=n(57),a=n(39),s=n(59),l=n(4),u=n(15),d=n(3),c=n(30);function f(e,t,n){var r;if(d.default(e,"Text")){var i=c.default(e,t,n);return n?[i,e]:[e,i]}var o=e.childNodes[t-1],a=e.childNodes[t];if(o||a||(n?o=(a=e).previousSibling:a=(o=e).nextSibling),(o||a)&&(!o||!a)){var s=e.ownerDocument.createTextNode("");null===(r=(o||a).parentNode)||void 0===r||r.insertBefore(s,a),o?a=s:o=s}return[o,a]}t.default=function(e,t){var n=null,d=u.default(e,"table,tr",null,2,t),c=o.default(e,t,0).map((function(e){var t=a.default(e);if(!t)return null;var o=t.startContainer,s=t.endContainer,l=t.startOffset,u=f(s,t.endOffset,!1),c=u[0],p=u[1],h=f(o,l,!0),v=h[0],g=h[1];n=n||v;var m=i.default(e,[g,c]);return r.default(d,m),{region:e,beforeStart:v,afterEnd:p}})).filter((function(e){return!!e}));return d.forEach((function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)})),c.forEach((function(e){return s.default(e.region,e.beforeStart,e.afterEnd)})),n&&new l.default(n,-1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(62);t.default=function(e,t,n){if(e.currentIndex<0||t!=e.snapshots[e.currentIndex]){r.default(e),e.snapshots.push(t),e.currentIndex++,e.totalSize+=t.length;for(var i=0;i<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=e.snapshots[i].length,i++;i>0&&(e.snapshots.splice(0,i),e.currentIndex-=i,e.autoCompleteIndex-=i),n&&(e.autoCompleteIndex=e.currentIndex)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42);t.default=function(e,t){return r.default(e,t)?(e.currentIndex+=t,e.autoCompleteIndex=-1,e.snapshots[e.currentIndex]):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.autoCompleteIndex>=0&&e.currentIndex-e.autoCompleteIndex==1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(27),i=n(63),o=n(60),a=n(40),s=n(1),l=n(3),u=n(41),d=n(5),c=n(64),f=n(115),p=function(){function e(e){e=e||{},this.elementCallbacks=c.cloneObject(e.elementCallbacks),this.styleCallbacks=f.getStyleCallbacks(e.cssStyleCallbacks),this.attributeCallbacks=c.cloneObject(e.attributeCallbacks),this.tagReplacements=f.getTagReplacement(e.additionalTagReplacements),this.allowedAttributes=f.getAllowedAttributes(e.additionalAllowedAttributes),this.allowedCssClassesRegex=f.getAllowedCssClassesRegex(e.additionalAllowedCssClasses),this.defaultStyleValues=f.getDefaultStyleValues(e.additionalDefaultStyleValues),this.additionalPredefinedCssForElement=e.additionalPredefinedCssForElement,this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.unknownTagReplacement=e.unknownTagReplacement}return e.convertInlineCss=function(t,n){return new e({additionalGlobalStyleNodes:n}).exec(t,!0)},e.sanitizeHtml=function(t,n){var r=new e(n=n||{}),o=l.default(n.currentElementOrStyle,"HTMLElement")?i.default(n.currentElementOrStyle):n.currentElementOrStyle;return r.exec(t,n.convertCssOnly,o)},e.prototype.exec=function(e,t,n){var r=(new DOMParser).parseFromString(e||"","text/html");return r&&r.body&&r.body.firstChild&&(this.convertGlobalCssToInlineCss(r),t||this.sanitize(r.body,n)),r&&r.body&&r.body.innerHTML||""},e.prototype.sanitize=function(e,t){if(!e)return"";t=c.cloneObject(t,i.default(null)),this.processNode(e,t,{})},e.prototype.convertGlobalCssToInlineCss=function(e){for(var t=d.default(e.querySelectorAll("style")),n=0,r=this.additionalGlobalStyleNodes.reverse().map((function(e){return e.sheet})).concat(t.map((function(e){return e.sheet})).reverse()).filter((function(e){return e}));n<r.length;n++)for(var i=r[n],o=function(t){var n=i.cssRules[t],r=n&&n.style?n.style.cssText:null;if(n.type!=CSSRule.STYLE_RULE||!r||!n.selectorText)return"continue";for(var o=0,a=n.selectorText.split(",");o<a.length;o++){var s=a[o];if(s&&s.trim()&&!(s.indexOf(":")>=0))d.default(e.querySelectorAll(s)).forEach((function(e){return e.setAttribute("style",r+(e.getAttribute("style")||""))}))}},a=i.cssRules.length-1;a>=0;a--)o(a);t.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))},e.prototype.processNode=function(e,t,n){var i=e.nodeType,o=1==i,a=3==i,l=11==i,u=!1;if(o){var d=s.default(e),f=this.elementCallbacks[d],p=this.tagReplacements[d.toLowerCase()];void 0===p&&(p=this.unknownTagReplacement),f?u=f(e,n):d.indexOf(":")>0||d==p||"*"==p?u=!0:p&&/^[a-zA-Z][\w\-]*$/.test(p)&&(e=r.default(e,p),u=!0)}else if(a){var h=t["white-space"];u="pre"==h||"pre-line"==h||"pre-wrap"==h||!/^[\r\n]*$/g.test(e.nodeValue)}else u=!!l;if(u)if(!a||"pre"!=t["white-space"]&&"pre-wrap"!=t["white-space"]){if(o||l){var v=c.cloneObject(t),g=e;o&&(this.processAttributes(g,n),this.preprocessCss(g,v),this.processCss(g,v,n));for(var m=g.firstChild,y=void 0;m;m=y)y=m.nextSibling,this.processNode(m,v,n)}}else e.nodeValue=e.nodeValue.replace(/^ /gm," ").replace(/ {2}/g,"  ");else e.parentNode.removeChild(e)},e.prototype.preprocessCss=function(e,t){var n=o.default(e,this.additionalPredefinedCssForElement);n&&Object.keys(n).forEach((function(e){t[e]=n[e]}))},e.prototype.processCss=function(e,t,n){var r=this,i=a.default(e);Object.keys(i).forEach((function(o){var a=i[o],s=r.styleCallbacks[o],l=null!=t[o],u=(!s||s(a,e,t,n))&&"inherit"!=a&&a.indexOf("expression")<0&&"-"!=o.substr(0,1)&&r.defaultStyleValues[o]!=a&&(l&&a!=t[o]||!l&&"initial"!=a&&"normal"!=a);u&&l&&(t[o]=a),u||delete i[o]})),u.default(e,i)},e.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;n>=0;n--){var r=e.attributes[n],i=r.name.toLowerCase().trim(),o=r.value,a=this.attributeCallbacks[i],s=a?a(o,e,t):this.allowedAttributes.indexOf(i)>=0||0==i.indexOf("data-")?o:null;"class"==i&&this.allowedCssClassesRegex&&(s=this.processCssClass(o,s)),null==s||s.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?e.removeAttribute(i):r.value=s}},e.prototype.processCssClass=function(e,t){var n=this,r=e?e.split(" "):[],i=t?t.split(" "):[];return r.forEach((function(e){n.allowedCssClassesRegex.test(e)&&i.indexOf(e)<0&&i.push(e)})),i.length>0?i.join(" "):null},e}();t.default=p},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(64),o={a:"*",abbr:"*",address:"*",area:"*",article:"*",aside:"*",b:"*",bdi:"*",bdo:"*",blockquote:"*",body:"*",br:"*",button:"*",canvas:"*",caption:"*",center:"*",cite:"*",code:"*",col:"*",colgroup:"*",data:"*",datalist:"*",dd:"*",del:"*",details:"*",dfn:"*",dialog:"*",dir:"*",div:"*",dl:"*",dt:"*",em:"*",fieldset:"*",figcaption:"*",figure:"*",font:"*",footer:"*",h1:"*",h2:"*",h3:"*",h4:"*",h5:"*",h6:"*",head:"*",header:"*",hgroup:"*",hr:"*",html:"*",i:"*",img:"*",input:"*",ins:"*",kbd:"*",label:"*",legend:"*",li:"*",main:"*",map:"*",mark:"*",menu:"*",menuitem:"*",meter:"*",nav:"*",ol:"*",optgroup:"*",option:"*",output:"*",p:"*",picture:"*",pre:"*",progress:"*",q:"*",rp:"*",rt:"*",ruby:"*",s:"*",samp:"*",section:"*",select:"*",small:"*",span:"*",strike:"*",strong:"*",sub:"*",summary:"*",sup:"*",table:"*",tbody:"*",td:"*",template:"*",textarea:"*",tfoot:"*",th:"*",thead:"*",time:"*",tr:"*",tt:"*",u:"*",ul:"*",var:"*",wbr:"*",xmp:"*",form:"SPAN",applet:null,audio:null,base:null,basefont:null,embed:null,frame:null,frameset:null,iframe:null,link:null,meta:null,noscript:null,object:null,param:null,script:null,slot:null,source:null,style:null,title:null,track:null,video:null},a="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,value,width,wrap".split(","),s={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","text-decoration":"none","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"},l=[];function u(){return null}function d(e,t){var n=t.tagName;return!("LI"==n||"DIV"==n)}t.getTagReplacement=function(e){var t=r({},o),n=e||{};return Object.keys(n).forEach((function(e){e&&(t[e.toLowerCase()]=n[e])})),t},t.getAllowedAttributes=function(e){return(t=a.concat(e||[]),t.filter((function(e,t,n){return n.indexOf(e)==t}))).map((function(e){return e.toLocaleLowerCase()}));var t},t.getAllowedCssClassesRegex=function(e){var t=l.concat(e||[]);return t.length>0?new RegExp(t.join("|")):null},t.getDefaultStyleValues=function(e){var t=i.cloneObject(s);return e&&Object.keys(e).forEach((function(n){var r=e[n];null!=r?t[n]=r:delete t[n]})),t},t.getStyleCallbacks=function(e){var t=i.cloneObject(e);return t.position=t.position||u,t.width=t.width||d,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{elementCallbacks:{},attributeCallbacks:{},cssStyleCallbacks:{},additionalTagReplacements:{},additionalAllowedAttributes:[],additionalAllowedCssClasses:[],additionalDefaultStyleValues:{},additionalGlobalStyleNodes:[],additionalPredefinedCssForElement:{},unknownTagReplacement:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e[t]){var r=e[t];e[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e),n.apply(void 0,e)}}else e[t]=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n,r){e&&(e.className="_Entity _EType_"+t+" "+(r?"_EId_"+r+" ":"")+"_EReadonly_"+(n?"1":"0"),n?e.contentEditable="false":e.getAttribute("contenteditable")&&e.removeAttribute("contenteditable"))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n,r=!1,i="",o=!1;return null===(t=null==e?void 0:e.className)||void 0===t||t.split(" ").forEach((function(e){"_Entity"==e?r=!0:0==e.indexOf("_EType_")?n=e.substr("_EType_".length):0==e.indexOf("_EId_")?i=e.substr("_EId_".length):0==e.indexOf("_EReadonly_")&&(o="1"==e.substr("_EReadonly_".length))})),r?{wrapper:e,id:i,type:n,isReadonly:o}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return"._Entity"+(e?"._EType_"+e:"")+(t?"._EId_"+t:"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=r),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e&&e.eventDataCache&&(t&&e.eventDataCache.hasOwnProperty(t)?delete e.eventDataCache[t]:t||(e.eventDataCache={}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(65);t.default=function(e){return!r.default(e)&&e.key&&1==e.key.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26).Browser.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(28),i=n(0),o="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),a=["href","src"],s=["TD","TH","TR","TABLE","TBODY","THEAD"];function l(e){var t=i.toArray(e.childNodes).map(l).every((function(e){return e})),n=i.isBlockElement(e),r=i.getTagOfNode(e);return r&&(o.indexOf(r)>=0||t&&!i.isVoidHtmlElement(e)&&s.indexOf(r)<0?(n&&!t&&i.wrap(e),i.unwrap(e)):function(e){for(var t=i.safeInstanceOf(e,"HTMLTableCellElement"),n=0,r=i.toArray(e.attributes);n<r.length;n++){var o=r[n];t&&"style"==o.name?u(e):a.indexOf(o.name.toLowerCase())<0&&0!=o.name.indexOf("data-")&&e.removeAttribute(o.name)}}(e)),n}function u(e){var t=i.getStyles(e),n={};return Object.keys(t).forEach((function(e){e.indexOf("border")<0&&(n[e]=t[e],delete t[e])})),i.setStyles(e,t),n}t.default=function(e){r.default(e,(function(t){var n=i.getSelectedBlockElementsInRegion(t),r=i.collapseNodesInRegion(t,n);if(e.contains(t.rootNode)){var o=u(t.rootNode);if(Object.keys(o).length>0){var a=i.wrap(i.toArray(t.rootNode.childNodes));i.setStyles(a,o)}}for(;r.length>0&&i.isNodeInRegion(t,r[0].parentNode);)r=[i.splitBalancedNodeRange(r)];r.forEach(l)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),i=n(67),o=n(68),a=n(69),s=n(70),l=n(71),u=n(72),d=n(73),c=["font","text-decoration","color","background"];t.default=function(e){e.focus(),e.addUndoSnapshot((function(){r.default(e,"removeFormat"),e.queryElements("[class]",1,(function(e){return e.removeAttribute("class")}));var t=e.getDefaultFormat(),n=0===Object.keys(t).length;e.queryElements("[style]",2,(function(e){c.forEach((function(t){return e.style.removeProperty(t)})),n&&""===e.getAttribute("style")&&e.removeAttribute("style")})),n||(t.fontFamily&&o.default(e,t.fontFamily),t.fontSize&&a.default(e,t.fontSize),t.textColor&&(t.textColors?s.default(e,t.textColors):s.default(e,t.textColor)),t.backgroundColor&&(t.backgroundColors?i.default(e,t.backgroundColors):i.default(e,t.backgroundColor)),t.bold&&l.default(e),t.italic&&u.default(e),t.underline&&d.default(e))}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=/^[a-zA-Z]+:/i,o=/^[\w.%+-]+@/i,a=/^ftp\./i;function s(e){return e.queryElements("a[href]",1)[0]}function l(e,t){t&&e.textContent!=t&&(e.textContent=t)}t.default=function(e,t,n,u){e.focus();var d=(function(e){var t=new r.HtmlSanitizer,n=(new DOMParser).parseFromString("<a></a>","text/html"),i=n.body.firstChild;return i.href=e||"",t.sanitize(n.body),i.getAttribute("href")}(t)||"").trim();if(d){var c=r.matchLink(d),f=c?c.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(i)<0&&(t=0==e.search(o)?"mailto:":0==e.search(a)?"ftp://":"http://"),t+e}(d),p=c?c.originalUrl:d;e.addUndoSnapshot((function(){var t=e.getSelectionRange(),r=null;return t&&t.collapsed?(r=s(e))?(r.href=f,l(r,u)):((r=e.getDocument().createElement("A")).textContent=u||p,r.href=f,e.insertNode(r)):(e.getDocument().execCommand("createLink",!1,f),l(r=s(e),u)),n&&r&&(r.removeAttribute("istemptitle"),r.title=n),r}),"CreateLink")}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);function o(e,t){var n=i.getTagOfNode(e.getElementAtCursor("OL,UL",null,t)),r=i.getTagOfNode(e.getElementAtCursor("H1,H2,H3,H4,H5,H6",null,t));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:r&&parseInt(r[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0]}}t.getElementBasedFormatState=o,t.default=function(e,t){return r(r(r(r({},i.getPendableFormatState(e.getDocument())),o(e,t)),e.getStyleBasedFormatState()),e.getUndoState())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t,n,i,o,a){var s=r.wrap(n,i?"DIV":"SPAN");if(!i&&o&&(s.style.display="inline-block"),r.commitEntity(s,t,o),!e.contains(s)){var l=void 0,u=void 0;if("number"==typeof a)u=a;else if(a){l=e.getSelectionRange();var d=a.normalize().node,c=d&&e.getElementAtCursor(r.getEntitySelector(),d);c&&(a=new r.Position(c,-3)),e.select(a),u=3}else e.focus(),u=3;e.insertNode(s,{updateCursor:!1,insertOnNewLine:i,replaceSelection:!0,position:u}),3==u&&(l?e.select(l):i||e.select(s,-3))}if(i){var f=e.getDocument().createElement("BR");s.parentNode.insertBefore(f,s.nextSibling)}var p=r.getEntityFromElement(s);return e.triggerContentChangedEvent("InsertEntity",p),p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function i(e,t){e.addUndoSnapshot((function(){var n=e.getDocument().createElement("img");n.src=t,n.style.maxWidth="100%",e.insertNode(n)}),"Format")}t.default=function(e,t){"string"==typeof t?i(e,t):r.readFile(t,(function(t){t&&!e.isDisposed()&&i(e,t)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function i(e){return e<=4?"120px":e<=6?"100px":"70px"}t.default=function(e,t,n,o){var a=e.getDocument(),s=a.createDocumentFragment(),l=a.createElement("table");s.appendChild(l),l.cellSpacing="0",l.cellPadding="1";for(var u=0;u<n;u++){var d=a.createElement("tr");l.appendChild(d);for(var c=0;c<t;c++){var f=a.createElement("td");d.appendChild(f),f.appendChild(a.createElement("br")),f.style.width=i(t)}}e.focus(),e.addUndoSnapshot((function(){var t=new r.VTable(l);t.applyFormat(o||{bgColorEven:"#FFF",bgColorOdd:"#FFF",topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB"}),t.writeBack(),e.insertNode(s),e.runAsync((function(e){return e.select(new r.Position(l,0).normalize())}))}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){var n=e.getElementAtCursor("TD,TH");n&&e.addUndoSnapshot((function(i,o){var a=new r.VTable(n);a.edit(t),a.writeBack(),e.focus();var s=function(e,t,n){var r=t,i=n;switch(e){case 0:i=0;break;case 1:r+=1,i=0;break;case 2:r=0;break;case 3:r=0,i+=1}return{newRow:r,newCol:i}}(t,a.row,a.col);e.select(a.getCell(s.newRow,s.newCol).td,0)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t,n){(n=n||e.getElementAtCursor("TABLE"))&&e.addUndoSnapshot((function(i,o){var a=new r.VTable(n);a.applyFormat(t),a.writeBack(),e.focus(),e.select(i,o)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){e.focus(),e.addUndoSnapshot((function(t,n){e.queryElements("a[href]",1,r.unwrap),e.select(t,n)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,i){if(!t||!n)return!1;var o;if(o="string"==typeof t?(i=i||e.getContentSearcherOfCursor())&&i.getRangeFromText(t,r):t){var a=e.getSelectionRange();return a.collapsed&&o.endContainer==a.startContainer&&o.endOffset==a.startOffset&&(r=!0),e.insertNode(n,{position:5,updateCursor:r,replaceSelection:!0,insertOnNewLine:!1,range:o}),!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){t&&e.addUndoSnapshot((function(){t.style.transform="rotate("+n+"deg)"}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);t.default=function(e,t){var n="justifyLeft",i="left";1==t?(n="justifyCenter",i="center"):2==t&&(n="justifyRight",i="right"),e.addUndoSnapshot((function(){r.default(e,n),e.queryElements("[align]",1,(function(e){return e.style.textAlign=i}))}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(139);t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(n,i){r.default(e,(function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"})),e.select(n,i)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function i(e){var t=e.getStartNode();return t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf(r.getTagOfNode(t.parentNode))>=0}t.default=function(e,t){for(var n=e.getSelectionTraverser(),r=n&&n.currentBlockElement,o=[];r;)i(r)||o.push(r),r=n.getNextBlockElement();o.forEach((function(e){var n=e.collapseToSingleElement();t(n)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(){e.queryElements("img",1,(function(e){return e.setAttribute("alt",t)}))}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(28),i=n(0);function o(e,t){var n=i.collapseNodesInRegion(e,t);i.wrap(n,'<blockquote style="margin-top:0;margin-bottom:0"></blockquote>')}function a(e,t){t.forEach((function(t){var n=t.collapseToSingleElement(),r=i.findClosestElementAncestor(n,e.rootNode,"blockquote");if(r){for(n==r&&(n=i.wrap(i.toArray(n.childNodes)));i.isNodeInRegion(e,n)&&"BLOCKQUOTE"!=i.getTagOfNode(n);)n=i.splitBalancedNodeRange(n);i.isNodeInRegion(e,n)&&i.unwrap(n)}}))}t.default=function(e,t){var n=0==t?o:a;r.default(e,(function(e,r,o){for(var a=i.getSelectedBlockElementsInRegion(e,!0),s=[[]],l=0;l<a.length;l++){var u=a[l].getStartNode(),d=i.createVListFromRegion(e,!0,u);if(d){for(s.push([]);a[l+1]&&d.contains(a[l+1].getStartNode());)l++;d.setIndentation(r,o,t),d.writeBack()}else s[s.length-1].push(a[l])}s.forEach((function(t){return n(e,t)}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=n(0);t.default=function(e,t,n){function o(e,n){switch(t){case"lowercase":return e.toLocaleLowerCase(n);case"uppercase":return e.toLocaleUpperCase(n);case"capitalize":for(var r=e.toLocaleLowerCase(n).split(" "),i=0;i<r.length;i++)r[i]=r[i].charAt(0).toLocaleUpperCase(n)+r[i].slice(1);return r.join(" ");case"sentence":var o=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");return e.toLocaleLowerCase(n).replace(o,(function(e){return e.toLocaleUpperCase(n)}))}}r.default(e,(function(e){for(var t=i.getFirstLeafNode(e);t;t=i.getNextLeafSibling(e,t))if(3==t.nodeType)try{t.textContent=o(t.textContent,n)}catch(e){t.textContent=o(t.textContent,void 0)}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(74);t.default=function(e){r.default(e,2)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(74);t.default=function(e,t){r.default(e,1,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(75),i=n(0),o=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};t.default=function(e,t){r.default(e,(function(e){var n=i.wrap(e,"blockquote");(t||o)(n)}),(function(){return 0==e.queryElements("blockquote",1,i.unwrap).length}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(75),i=n(0);t.default=function(e,t){r.default(e,(function(e){var n=i.wrap(e,"code"),r=i.wrap(n,"pre");null==t||t(r)}),(function(){return 0==e.queryElements("pre>code",1,(function(e){if(!e.previousSibling&&!e.nextSibling){var t=e.parentNode;i.unwrap(e),i.unwrap(t)}})).length}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);t.default=function(e){r.default(e,"strikeThrough")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);t.default=function(e){r.default(e,"subscript")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);t.default=function(e){r.default(e,"superscript")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){t=Math.min(Math.max(Math.round(t),0),6),e.addUndoSnapshot((function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",1,(function(t){n||(e.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);for(var r=e.getDocument().createElement("div");t.firstChild;)r.appendChild(t.firstChild);e.replaceNode(t,r)})),t>0){for(var i=e.getSelectionTraverser(),o=i?i.currentBlockElement:null,a=new r.HtmlSanitizer({cssStyleCallbacks:{"font-size":function(){return!1}}});o;){var s=o.collapseToSingleElement();a.sanitize(s),o=i.getNextBlockElement()}e.getDocument().execCommand("formatBlock",!1,"<H"+t+">")}}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i={keys:[37,39],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var i,o;if(!(n&&(i=t.getSelectionRange())&&i.collapsed&&(o=r.Position.getStart(i))&&t.isPositionAtBeginning(o)))return!1;var a="rtl"==r.getComputedStyle(o.element,"direction"),s=e.rawEvent;return!a&&37==s.which||a&&39==s.which},handleEvent:function(e){e.rawEvent.preventDefault()},defaultDisabled:!r.Browser.isChrome};t.CursorFeatures={noCycleCursorMove:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i={keys:[13],shouldHandleEvent:function(e,t){return a(e,t)},handleEvent:function(e,t){a(e,t,1)}},o={keys:[27],shouldHandleEvent:function(e,t){return a(e,t)},handleEvent:function(e,t){a(e,t,3)}};function a(e,t,n){var i=r.cacheGetEventData(e,"READONLY_ENTITY_ELEMENT",(function(){var n=e.rawEvent.target,i=n&&t.getElementAtCursor(r.getEntitySelector(),n);return i&&!i.isContentEditable?i:null}));return i&&void 0!==n&&t.triggerPluginEvent(15,{operation:n,rawEvent:e.rawEvent,entity:r.getEntityFromElement(i)}),i}var s={keys:[13],shouldHandleEvent:function(e,t){return d(e,t,!0,!1)},handleEvent:function(e,t){var n;e.rawEvent.preventDefault();var i=t.getSelectionRange(),o=r.Position.getEnd(i).normalize().node,a=t.getDocument().createElement("BR");o.parentNode.insertBefore(a,o.nextSibling);var s,l=t.getBlockElementAtNode(o);l&&(s=l.collapseToSingleElement(),null===(n=a.parentNode)||void 0===n||n.removeChild(a)),t.getSelectionRange().deleteContents(),s.nextSibling&&t.select(s.nextSibling,0)}},l={keys:[8],shouldHandleEvent:function(e,t){return d(e,t,!1,!0)},handleEvent:function(e,t){d(e,t,!1,!0,5)}},u={keys:[46],shouldHandleEvent:function(e,t){return d(e,t,!0,!0)},handleEvent:function(e,t){d(e,t,!0,!0,4)}};function d(e,t,n,i,o){var a=r.cacheGetEventData(e,"NEIGHBOR_ENTITY_ELEMENT_"+n+"_"+i,(function(){var e=t.getSelectionRange();if(i&&!e.collapsed)return null;var o=r.Position.getEnd(e).normalize(),a=null;if(0==o.offset||o.isAtEnd){var s=t.getBodyTraverser(o.node),l=n?0==o.offset?s.currentInlineElement:s.getNextInlineElement():o.isAtEnd?s.currentInlineElement:s.getPreviousInlineElement(),u=l&&l.getContainerNode();if(!i){var d=t.getBlockElementAtNode(o.node);d&&d.contains(u)||(u=null)}a=u&&t.getElementAtCursor(r.getEntitySelector(),u)}return a}));return a&&void 0!==o&&t.triggerPluginEvent(15,{operation:o,rawEvent:e.rawEvent,entity:r.getEntityFromElement(a)}),a}t.EntityFeatures={clickOnEntity:i,escapeFromEntity:o,enterBeforeReadonlyEntity:s,backspaceAfterEntity:l,deleteBeforeEntity:u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(0),o={keys:[9],shouldHandleEvent:function(e,t){return!e.rawEvent.shiftKey&&v(e,t)},handleEvent:function(e,t){r.setIndentation(t,0),e.rawEvent.preventDefault()}},a={keys:[9],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey&&v(e,t)},handleEvent:function(e,t){r.setIndentation(t,1),e.rawEvent.preventDefault()}},s={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e),r=t.getSelectionRange();return n&&(null==r?void 0:r.collapsed)&&i.isPositionAtBeginningOf(i.Position.getStart(r),n)},handleEvent:function(e,t){if(t.getElementAtCursor("LI",null,e).previousSibling){var n=f(t);t.runAsync((function(e){var t=e.getDocument().createElement("BR");e.insertNode(t),e.select(t,-3),r.experimentCommitListChains(e,n)}))}else h(e,t)},defaultDisabled:!0},l={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e);return n&&i.isNodeEmpty(n)&&!n.previousSibling},handleEvent:h},u={keys:[13],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e);return!e.rawEvent.shiftKey&&n&&i.isNodeEmpty(n)},handleEvent:function(e,t){t.addUndoSnapshot((function(){return h(e,t)}),null,!0)},defaultDisabled:!i.Browser.isIE&&!i.Browser.isChrome},d={keys:[32],shouldHandleEvent:function(e,t){if(!v(e,t)){var n=t.getContentSearcherOfCursor(e),r=n.getSubStringBefore(4);return/^(\*|-|[0-9]{1,2}\.)$/.test(r)&&!n.getNearestNonTextInlineElement()}return!1},handleEvent:function(e,t){t.runAsync((function(e){e.addUndoSnapshot((function(){var t,n=e.getContentSearcherOfCursor(),i=n.getSubStringBefore(4),o=n.getRangeFromText(i,!0);if(o){if(0==i.indexOf("*")||0==i.indexOf("-"))p(e,o),r.toggleBullet(e);else if(0==i.indexOf("1."))p(e,o),r.toggleNumbering(e);else if((t=e.getSelectedRegions())&&1==t.length){var a=parseInt(i);p(e,o),r.toggleNumbering(e,a)}}else;}),null,!0)}))}},c={keys:[13,9,46,8,258],shouldHandleEvent:function(e,t){return t.queryElements("li",1).length>0},handleEvent:function(e,t){var n=f(t);t.runAsync((function(e){return r.experimentCommitListChains(e,n)}))}};function f(e){return i.VListChain.createListChains(e.getSelectedRegions())}function p(e,t){t.deleteContents();var n=t.startContainer;if(3==(null==n?void 0:n.nodeType)&&""==n.nodeValue&&!n.nextSibling){var r=e.getDocument().createElement("BR");e.insertNode(r),e.select(r,-2)}}function h(e,t){var n=v(e,t);if(n){var o=n[0],a=i.getTagOfNode(o);"UL"==a?r.toggleBullet(t):"OL"==a&&r.toggleNumbering(t),t.focus(),e.rawEvent.preventDefault()}}function v(e,t){var n=t.getElementAtCursor("LI,TABLE",null,e),r=n&&"LI"==i.getTagOfNode(n)&&t.getElementAtCursor("UL,OL",n);return r?[r,n]:null}t.ListFeatures={autoBullet:d,indentWhenTab:o,outdentWhenShiftTab:a,outdentWhenBackspaceOnEmptyFirstLine:l,outdentWhenEnterOnEmptyLine:u,mergeInNewLineWhenBackspaceOnFirstChar:s,maintainListChain:c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function i(e,t,n,r){return{keys:[e],shouldHandleEvent:function(e,n){return e.rawEvent.shiftKey===r&&!!o(e,n,t)},handleEvent:function(e,r){r.runAsync((function(r){!function(e,t,n,r){t.addUndoSnapshot((function(){var i=o(e,t,n);if(i){var a=i.cloneRange();a.setStart(a.startContainer,a.startOffset+1),i.setEnd(i.endContainer,i.endOffset+1);var s=t.getDocument().createElement(r);s.appendChild(a.extractContents()),i.deleteContents();var l=t.getDocument().createTextNode("​");i.insertNode(l),i.insertNode(s),t.select(l,-1)}}),"Format",!0)}(e,r,t,n)}))}}}function o(e,t,n){return r.cacheGetEventData(e,"MARKDOWN_RANGE",(function(){var i,o;return t.getContentSearcherOfCursor(e).forEachTextInlineElement((function(e){if(o&&i)return!0;var t=e.getTextContent();if(0==t[t.length-1].trim().length)return!1;if(t[t.length-1]===n)return!1;if(o||(o=e.getStartPosition().move(t.length)),t[0]==n)i=e.getStartPosition();else for(var r=t.length-1;r>0;r--){if(i)return!0;if(t[r]==n&&0==t[r-1].trim().length)return i=e.getStartPosition().move(r),!0}})),!!i&&!!o&&r.createRange(i,o)}))}var a=i(56,"*","b",!0),s=i(189,"_","i",!0),l=i(192,"~","s",!0),u=i(192,"`","code",!1);t.MarkdownFeatures={markdownBold:a,markdownItalic:s,markdownStrikethru:l,markdownInlineCode:u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i="BLOCKQUOTE",o=[i,"LI","TD","TH"].join(","),a={keys:[8],shouldHandleEvent:function(e,t){var n=l(e,t);return n&&r.isNodeEmpty(n)&&!n.previousSibling},handleEvent:u},s={keys:[13],shouldHandleEvent:function(e,t){var n=l(e,t);return!e.rawEvent.shiftKey&&n&&r.isNodeEmpty(n)},handleEvent:function(e,t){return t.addUndoSnapshot((function(){return u(e,t)}),null,!0)}};function l(e,t){return r.cacheGetEventData(e,"QUOTE_CHILD",(function(){var e=t.getElementAtCursor(o);if(e&&r.getTagOfNode(e)==i){var n=t.getFocusedPosition(),a=n&&t.getBlockElementAtNode(n.normalize().node);if(a){var s=a.getStartNode()==e?a.getStartNode():a.collapseToSingleElement();return r.isNodeEmpty(s)?s:null}}return null}))}function u(e,t){t.addUndoSnapshot((function(){var n,o=l(e,t);r.getTagOfNode(o)==i&&(o=r.wrap(r.toArray(o.childNodes))),n=r.splitBalancedNodeRange(o),r.unwrap(n),t.select(o,0)})),e.rawEvent.preventDefault()}t.QuoteFeatures={unquoteWhenBackspaceOnEmptyFirstLine:a,unquoteWhenEnterOnEmptyLine:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(6);function o(e,t,n){return{winKey:e,macKey:t,action:n}}var a=[o(4162,8258,i.toggleBold),o(4169,8265,i.toggleItalic),o(4181,8277,i.toggleUnderline),o(4186,8282,(function(e){return e.undo()})),o(4185,24666,(function(e){return e.redo()})),o(4286,8382,i.toggleBullet),o(4287,8383,i.toggleNumbering),o(20670,24766,(function(e){return i.changeFontSize(e,0)})),o(20668,24764,(function(e){return i.changeFontSize(e,1)}))],s={allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}};function l(e){return r.cacheGetEventData(e,"DEFAULT_SHORT_COMMAND",(function(){var t=e.rawEvent,n=0!=e.eventType||t.altKey?0:t.which|(t.metaKey&&8192)|(t.shiftKey&&16384)|(t.ctrlKey&&4096);return n&&a.filter((function(e){return(r.Browser.isMac?e.macKey:e.winKey)==n}))[0]}))}t.ShortcutFeatures={defaultShortcut:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=r.Browser.isEdge?"<div><span><br></span></div>":"<div><br></div>",o={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},a=Object.keys(o).join(","),s={keys:[13],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e,t),o=r.fromHtml(i,t.getDocument())[0];t.addUndoSnapshot((function(){n.parentNode.insertBefore(o,n),"TABLE"==r.getTagOfNode(n)&&t.select(new r.Position(o,0).normalize())})),e.rawEvent.preventDefault()},defaultDisabled:!0};function l(e,t){return r.cacheGetEventData(e,"FIRST_STRUCTURE",(function(){var n=e.rawEvent.shiftKey?null:t.getElementAtCursor(a);if(n){var i=t.getSelectionRange();if(i&&i.collapsed&&r.isPositionAtBeginningOf(r.Position.getStart(i),n)&&!t.getBodyTraverser(n).getPreviousBlockElement())return t.getElementAtCursor(o[r.getTagOfNode(n)])}return null}))}t.StructuredNodeFeatures={insertLineBeforeStructuredNodeFeature:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(0),o={keys:[9],shouldHandleEvent:s,handleEvent:function(e,t){for(var n=e.rawEvent.shiftKey,o=s(e,t),a=new i.VTable(o),l=n?-1:1,u=a.row,d=a.col+l;;d+=l){if(d<0||d>=a.cells[u].length){if((u+=l)<0){t.select(a.table,-2);break}if(u>=a.cells.length){r.editTable(t,1);break}d=n?a.cells[u].length-1:0}var c=a.getCell(u,d);if(c.td){t.select(c.td,0);break}}e.rawEvent.preventDefault()}},a={keys:[38,40],shouldHandleEvent:s,handleEvent:function(e,t){var n,r=s(e,t),o=new i.VTable(r),a=38==e.rawEvent.which,l=a?-1:1,u=e.rawEvent.shiftKey,d=null===(n=t.getDocument().defaultView)||void 0===n?void 0:n.getSelection(),c=null;if(d){for(var f=d.anchorNode,p=d.anchorOffset,h=o.row;h>=0&&h<o.cells.length;h+=l){var v=o.getCell(h,o.col);if(v.td&&v.td!=r){c=v.td;break}}t.runAsync((function(e){var t,n=e.getElementAtCursor();if(i.contains(o.table,n)&&!i.contains(r,n,!0)){var s=c?new i.Position(c,0):new i.Position(o.table,a?-2:-3);if(u){s=1==s.node.nodeType&&i.isVoidHtmlElement(s.node)?new i.Position(s.node,s.isAtEnd?-3:-2):s;var l=null===(t=e.getDocument().defaultView)||void 0===t?void 0:t.getSelection();null==l||l.setBaseAndExtent(f,p,s.node,s.offset)}else e.select(s)}}))}},defaultDisabled:!i.Browser.isChrome&&!i.Browser.isSafari};function s(e,t){return i.cacheGetEventData(e,"TABLECELL_FOR_TABLE_FEATURES",(function(){var e=t.getFocusedPosition(),n=e&&t.getElementAtCursor("TD,TH,LI",e.node);return n&&("LI"==i.getTagOfNode(n)?null:n)}))}t.TableFeatures={tabInTable:o,upDownInTable:a}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(160),o=n(176),a=n(0),s=function(){function e(e,t){var n=this;if(void 0===t&&(t={}),"DIV"!=a.getTagOfNode(e))throw new Error("contentDiv must be an HTML DIV element");var s=o.default(e,t),l=[];Object.keys(s).forEach((function(e){e==o.PLACEHOLDER_PLUGIN_NAME?a.arrayPush(l,t.plugins):l.push(s[e])})),this.core=r({contentDiv:e,api:r(r({},i.coreApiMap),t.coreApiOverride||{}),plugins:l.filter((function(e){return!!e}))},o.getPluginState(s)),this.core.plugins.forEach((function(e){return e.initialize(n)})),this.ensureTypeInContainer(new a.Position(this.core.contentDiv,0).normalize())}return e.prototype.dispose=function(){this.core.plugins.reverse().forEach((function(e){return e.dispose()})),this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){return!!e&&this.core.api.insertNode(this.core,e,t)},e.prototype.deleteNode=function(e){return!(!e||!this.contains(e))&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t,n){return!(!this.contains(e)||!t)&&(this.core.api.transformColor(this.core,n?t:null,!0,(function(){return e.parentNode.replaceChild(t,e)}),0),!0)},e.prototype.getBlockElementAtNode=function(e){return a.getBlockElementAtNode(this.core.contentDiv,e)},e.prototype.contains=function(e){return a.contains(this.core.contentDiv,e)},e.prototype.queryElements=function(e,t,n){void 0===t&&(t=0);var r=t instanceof Function?0:t;n=t instanceof Function?t:n;var i=0==r?null:this.getSelectionRange();return a.queryElements(this.core.contentDiv,e,n,r,i)},e.prototype.collapseNodes=function(e,t,n){return a.collapseNodes(this.core.contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return a.isNodeEmpty(this.core.contentDiv,e)},e.prototype.getContent=function(e){return void 0===e&&(e=0),this.core.api.getContent(this.core,e)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0),this.core.api.setContent(this.core,e,t)},e.prototype.insertContent=function(e,t){if(e){var n=this.getDocument(),r=a.fromHtml(e,n);t&&t.insertOnNewLine&&r.length>1&&(r=[a.wrap(r)]);var i=n.createDocumentFragment();r.forEach((function(e){return i.appendChild(e)})),this.insertNode(i,t)}},e.prototype.deleteSelectedContent=function(){var e=this.getSelectionRange();return e&&!e.collapsed&&a.deleteSelectedContent(this.core.contentDiv,e)},e.prototype.paste=function(e,t,n){var r=this;if(e){e.snapshotBeforePaste?this.setContent(e.snapshotBeforePaste):e.snapshotBeforePaste=this.getContent(2);var i=this.getSelectionRange(),o=i&&a.Position.getStart(i),s=this.core.api.createPasteFragment(this.core,e,o,t,n);this.addUndoSnapshot((function(){return r.insertNode(s),e}),"Paste")}},e.prototype.getSelectionRange=function(e){return void 0===e&&(e=!0),this.core.api.getSelectionRange(this.core,e)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&a.getSelectionPath(this.core.contentDiv,e)},e.prototype.hasFocus=function(){return this.core.api.hasFocus(this.core)},e.prototype.focus=function(){this.core.api.focus(this.core)},e.prototype.select=function(e,t,n,r){var i=e?a.safeInstanceOf(e,"Range")?e:Array.isArray(e.start)&&Array.isArray(e.end)?a.createRange(this.core.contentDiv,e.start,e.end):a.createRange(e,t,n,r):null;return this.contains(i)&&this.core.api.selectRange(this.core,i)},e.prototype.getFocusedPosition=function(){var e,t=null===(e=this.getDocument().defaultView)||void 0===e?void 0:e.getSelection();if(this.contains(t&&t.focusNode))return new a.Position(t.focusNode,t.focusOffset);var n=this.getSelectionRange();return n?a.Position.getStart(n):null},e.prototype.getElementAtCursor=function(e,t,n){var r=this;return n=t?null:n,a.cacheGetEventData(n,"GET_ELEMENT_AT_CURSOR_"+e,(function(){if(!t){var n=r.getFocusedPosition();t=n&&n.node}return t&&a.findClosestElementAncestor(t,r.core.contentDiv,e)}))},e.prototype.isPositionAtBeginning=function(e){return a.isPositionAtBeginningOf(e,this.core.contentDiv)},e.prototype.getSelectedRegions=function(e){void 0===e&&(e=0);var t=this.getSelectionRange();return t?a.getRegionsFromRange(this.core.contentDiv,t,e):[]},e.prototype.addDomEventHandler=function(e,t){var n,r="string"==typeof e?((n={})[e]=t,n):e;return this.core.api.attachDomEvent(this.core,r)},e.prototype.triggerPluginEvent=function(e,t,n){var i=r({eventType:e},t);return this.core.api.triggerEvent(this.core,i,n),i},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerPluginEvent(7,{source:e,data:t})},e.prototype.undo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,-1)},e.prototype.redo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,1)},e.prototype.addUndoSnapshot=function(e,t,n){this.core.api.addUndoSnapshot(this.core,e,t,n)},e.prototype.getUndoState=function(){var e=this.core.undo,t=e.hasNewContent,n=e.snapshotsService;return{canUndo:t||n.canMove(-1),canRedo:n.canMove(1)}},e.prototype.getDocument=function(){return this.core.contentDiv.ownerDocument},e.prototype.getScrollContainer=function(){return this.core.domEvent.scrollContainer},e.prototype.getCustomData=function(e,t,n){return(this.core.lifecycle.customData[e]=this.core.lifecycle.customData[e]||{value:t?t():void 0,disposer:n}).value},e.prototype.isInIME=function(){return this.core.domEvent.isInIME},e.prototype.getDefaultFormat=function(){return this.core.lifecycle.defaultFormat},e.prototype.getBodyTraverser=function(e){return a.ContentTraverser.createBodyTraverser(this.core.contentDiv,e)},e.prototype.getSelectionTraverser=function(){return this.getSelectionRange()&&a.ContentTraverser.createSelectionTraverser(this.core.contentDiv,this.getSelectionRange())},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t&&a.ContentTraverser.createBlockTraverser(this.core.contentDiv,t,e)},e.prototype.getContentSearcherOfCursor=function(e){var t=this;return a.cacheGetEventData(e,"CONTENTSEARCHER",(function(){var e=t.getSelectionRange();return e&&new a.PositionContentSearcher(t.core.contentDiv,a.Position.getStart(e))}))},e.prototype.runAsync=function(e){var t=this;(this.core.contentDiv.ownerDocument.defaultView||window).requestAnimationFrame((function(){!t.isDisposed()&&e&&e(t)}))},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.core.contentDiv.removeAttribute(e):this.core.contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.core.contentDiv.getAttribute(e)},e.prototype.addContentEditFeature=function(e){var t=this;null==e||e.keys.forEach((function(n){var r=t.core.edit.features[n]||[];r.push(e),t.core.edit.features[n]=r}))},e.prototype.getStyleBasedFormatState=function(e){if(!e){var t=this.getSelectionRange();e=t&&a.Position.getStart(t).normalize().node}return this.core.api.getStyleBasedFormatState(this.core,e)},e.prototype.ensureTypeInContainer=function(e,t){this.core.api.ensureTypeInContainer(this.core,e,t)},e.prototype.setDarkModeState=function(e){if(this.isDarkMode()!=e){var t=this.getContent(0);this.triggerContentChangedEvent(e?"SwitchToDarkMode":"SwitchToLightMode"),this.setContent(t)}},e.prototype.isDarkMode=function(){return this.core.lifecycle.isDarkMode},e.prototype.startShadowEdit=function(){this.core.api.switchShadowEdit(this.core,!0)},e.prototype.stopShadowEdit=function(){this.core.api.switchShadowEdit(this.core,!1)},e.prototype.isInShadowEdit=function(){return!!this.core.lifecycle.shadowEditFragment},e.prototype.isFeatureEnabled=function(e){return this.core.lifecycle.experimentalFeatures.indexOf(e)>=0},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(161),i=n(162),o=n(163),a=n(164),s=n(165),l=n(166),u=n(167),d=n(168),c=n(77),f=n(169),p=n(170),h=n(171),v=n(172),g=n(173),m=n(174),y=n(175);t.coreApiMap={attachDomEvent:i.attachDomEvent,addUndoSnapshot:r.addUndoSnapshot,createPasteFragment:o.createPasteFragment,ensureTypeInContainer:a.ensureTypeInContainer,focus:s.focus,getContent:l.getContent,getSelectionRange:u.getSelectionRange,getStyleBasedFormatState:d.getStyleBasedFormatState,hasFocus:c.hasFocus,insertNode:f.insertNode,restoreUndoSnapshot:p.restoreUndoSnapshot,selectRange:h.selectRange,setContent:v.setContent,switchShadowEdit:g.switchShadowEdit,transformColor:m.transformColor,triggerEvent:y.triggerEvent}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.addUndoSnapshot=function(e,t,n,i){var o,a=e.undo,s=a.isNested,l=!!e.lifecycle.shadowEditFragment;s||(a.isNested=!0,l||(a.snapshotsService.addSnapshot(e.api.getContent(e,2),i),a.hasNewContent=!1));try{var u;if(t)o=t((u=e.api.getSelectionRange(e,!0))&&r.Position.getStart(u).normalize(),u&&r.Position.getEnd(u).normalize()),s||l||(a.snapshotsService.addSnapshot(e.api.getContent(e,2),!1),a.hasNewContent=!1)}finally{s||(a.isNested=!1)}if(t&&n){var d={eventType:7,source:n,data:o};e.api.triggerEvent(e,d,!0)}i&&((u=e.api.getSelectionRange(e,!1))&&(e.undo.hasNewContent=!1,e.undo.autoCompletePosition=r.Position.getStart(u)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachDomEvent=function(e,t){var n=Object.keys(t||{}).map((function(n){var r=function(e){var t={pluginEventType:null,beforeDispatch:null};"number"==typeof e?t.pluginEventType=e:"function"==typeof e?t.beforeDispatch=e:"object"==typeof e&&(t=e);return t}(t[n]),i=r.pluginEventType,o=r.beforeDispatch,a=function(t){o&&o(t),null!=i&&e.api.triggerEvent(e,{eventType:i,rawEvent:t},!1)};return e.contentDiv.addEventListener(n,a),function(){e.contentDiv.removeEventListener(n,a)}}));return function(){return n.forEach((function(e){return e()}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function i(e,t){r.toArray(e.querySelectorAll("style")).forEach(t)}t.createPasteFragment=function(e,t,n,o,a){var s,l;if(!t)return null;var u,d=function(e,t){return{eventType:10,clipboardData:t,fragment:e.contentDiv.ownerDocument.createDocumentFragment(),sanitizingOption:r.createDefaultHtmlSanitizerOptions(),htmlBefore:"",htmlAfter:"",htmlAttributes:{}}}(e,t),c=d.fragment,f=d.sanitizingOption,p=t.rawHtml,h=t.text,v=t.imageDataUri,g=e.contentDiv.ownerDocument;if(o||h||!v)if(!o&&p&&(null===(s=u=(new DOMParser).parseFromString(p,"text/html"))||void 0===s?void 0:s.body)){var m=null===(l=u.querySelector("html"))||void 0===l?void 0:l.attributes;(m?r.toArray(m):[]).reduce((function(e,t){return e[t.name]=t.value,e}),d.htmlAttributes),r.toArray(u.querySelectorAll("meta")).reduce((function(e,t){return e[t.name]=t.content,e}),d.htmlAttributes),i(u,(function(e){u.head.appendChild(e),f.additionalGlobalStyleNodes.push(e)}));var y=p.indexOf("\x3c!--StartFragment--\x3e"),E=p.lastIndexOf("\x3c!--EndFragment--\x3e");for(y>=0&&E>=y+"\x3c!--StartFragment--\x3e".length&&(d.htmlBefore=p.substr(0,y),d.htmlAfter=p.substr(E+"\x3c!--EndFragment--\x3e".length),u.body.innerHTML=t.html=p.substring(y+"\x3c!--StartFragment--\x3e".length,E),i(u.body,(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)})));u.body.firstChild;)c.appendChild(u.body.firstChild);if(a&&n){var b=function(e,t){var n=r.getPendableFormatState(e.contentDiv.ownerDocument),i=e.api.getStyleBasedFormatState(e,t);return{fontFamily:i.fontName,fontSize:i.fontSize,textColor:i.textColor,backgroundColor:i.backgroundColor,textColors:i.textColors,backgroundColors:i.backgroundColors,bold:n.isBold,italic:n.isItalic,underline:n.isUnderline}}(e,n.node);r.applyTextStyle(c,(function(e){return r.applyFormat(e,b)}))}}else h&&h.split("\n").forEach((function(e,t,n){e=e.replace(/^ /g," ").replace(/\r/g,"").replace(/ {2}/g,"  ");var i=g.createTextNode(e);2==n.length&&0==t?(c.appendChild(i),c.appendChild(g.createElement("br"))):t>0&&t<n.length-1?c.appendChild(r.wrap(""==e?g.createElement("br"):i)):c.appendChild(i)}));else{var C=g.createElement("img");C.style.maxWidth="100%",C.src=v,c.appendChild(C)}e.api.triggerEvent(e,d,!0);var S=new r.HtmlSanitizer(d.sanitizingOption);return S.convertGlobalCssToInlineCss(c),S.sanitize(c,n&&r.getInheritableStyles(n.element)),c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.ensureTypeInContainer=function(e,t,n){t=t.normalize();var i,o=r.getBlockElementAtNode(e.contentDiv,t.node);if(o){i=o.collapseToSingleElement();var a=r.isNodeEmpty(i)||n&&function(e,t){return r.safeInstanceOf(e.target,"Node")&&e.target.contains(t)&&e.key===t.innerText}(n,i);i=i&&a?i:null}else i=r.fromHtml(r.Browser.isEdge?"<div><span><br></span></div>":"<div><br></div>",e.contentDiv.ownerDocument)[0],e.api.insertNode(e,i,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t=new r.Position(i.firstChild,0);i&&r.applyFormat(i,e.lifecycle.defaultFormat,e.lifecycle.isDarkMode),n&&e.api.selectRange(e,r.createRange(t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.focus=function(e){if(!e.lifecycle.shadowEditFragment){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.domEvent.selectionRange&&e.api.selectRange(e,e.domEvent.selectionRange,!0))){var t=r.getFirstLeafNode(e.contentDiv)||e.contentDiv;e.api.selectRange(e,r.createRange(t,0),!0)}e.domEvent.selectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.getContent=function(e,t){var n="",i=0==t,o=2==t,a=e.lifecycle.shadowEditFragment||e.contentDiv;if(3==t)n=r.getTextContent(a);else if(i||e.lifecycle.isDarkMode){var s=function(e){var t;r.safeInstanceOf(e,"DocumentFragment")?(t=e.ownerDocument.createElement("div")).appendChild(e.cloneNode(!0)):t=e.cloneNode(!0);return t}(a),l=e.api.getSelectionRange(e,!0),u=o?e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath:l?r.getSelectionPath(e.contentDiv,l):null:null,d=u&&r.createRange(s,u.start,u.end);e.lifecycle.isDarkMode&&e.api.transformColor(e,s,!1,null,1),i?(e.api.triggerEvent(e,{eventType:8,clonedRoot:s},!0),n=s.innerHTML):n=d?r.getHtmlWithSelectionPath(s,d):s.innerHTML}else n=r.getHtmlWithSelectionPath(a,o&&e.api.getSelectionRange(e,!0));return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.getSelectionRange=function(e,t){var n,i=null;if(e.lifecycle.shadowEditFragment)return i=e.lifecycle.shadowEditSelectionPath&&r.createRange(e.contentDiv,e.lifecycle.shadowEditSelectionPath.start,e.lifecycle.shadowEditSelectionPath.end);if(!t||e.api.hasFocus(e)){var o=null===(n=e.contentDiv.ownerDocument.defaultView)||void 0===n?void 0:n.getSelection();if(o&&o.rangeCount>0){var a=o.getRangeAt(0);r.contains(e.contentDiv,a)&&(i=a)}}return!i&&t&&(i=e.domEvent.selectionRange),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.getStyleBasedFormatState=function(e,t){if(!t)return{};var n=t?r.getComputedStyles(t):[],i=e.lifecycle.isDarkMode,o=e.contentDiv,a=i&&r.findClosestElementAncestor(t,o,"[data-ogsc],[data-ogac]"),s=i&&r.findClosestElementAncestor(t,o,"[data-ogsb],[data-ogab]");return{fontName:n[0],fontSize:n[1],textColor:n[2],backgroundColor:n[3],textColors:a?{darkModeColor:n[2],lightModeColor:a.dataset.ogsc||a.dataset.ogac}:void 0,backgroundColors:s?{darkModeColor:n[3],lightModeColor:s.dataset.ogsb||s.dataset.ogab}:void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=[function(e,t,n){var i=r.getBlockElementAtNode(e,n.node);if(i){var a=r.queryElements(e,"a[href]",null,1,r.createRange(n)).filter((function(e){return i.contains(e)}))[0];if(a&&r.isNodeEmpty(a)&&(n=new r.Position(a,-2),o(a),a=null),a&&t.querySelector&&t.querySelector("a[href]")){var s=n.normalize(),l=s.node.parentNode,u=3==s.node.nodeType?r.splitTextNode(s.node,s.offset,!1):s.isAtEnd?s.node.nextSibling:s.node,d=e.ownerDocument.createTextNode("");for(l.insertBefore(d,u);r.contains(a,d);)d=r.splitBalancedNodeRange(d);n=new r.Position(d,-2),o(d)}}return n},function(e,t,n){var i=t;if(11==i.nodeType){var a=r.toArray(i.childNodes).filter((function(e){return"BR"!=r.getTagOfNode(e)}));i=1==a.length?a[0]:null}var s=r.getTagOfNode(i),l=s&&"BR"==r.getTagOfNode(i.nextSibling),u=r.findClosestElementAncestor(n.node,e,"LI"),d=u&&r.findClosestElementAncestor(u,e,"OL,UL"),c=r.findClosestElementAncestor(n.node,e,"TD,TH"),f=c&&r.findClosestElementAncestor(c,e,"TR");"LI"==s&&(s=d?r.getTagOfNode(d):"UL",i=r.wrap(i,s));if("OL"!=s&&"UL"!=s||"LI"!=r.getTagOfNode(i.firstChild)){if("TABLE"==s&&f){var p=new r.VTable(i),h=new r.VTable(c);0==h.col&&c==h.getCell(h.row,0).td&&p.cells[0]&&p.cells[0].length==h.cells[0].length&&r.isPositionAtBeginningOf(n,c)&&("TBODY"!=r.getTagOfNode(i.firstChild)||i.firstChild.nextSibling||r.unwrap(i.firstChild),r.unwrap(i),n=new r.Position(f,-3))}}else{var v=!i.firstChild.nextSibling&&!l;l&&i.parentNode&&o(i.nextSibling),v?(r.unwrap(i.firstChild),r.unwrap(i)):r.getTagOfNode(d)==s&&(r.unwrap(i),n=new r.Position(u,r.isPositionAtBeginningOf(n,u)?-2:-3))}return n},function(e,t,n){if("P"==r.getTagOfNode(n.node)){var i=n.normalize(),o=r.changeElementTag(n.node,"div");i.node!=o&&(n=i)}return n},function(e,t,n){r.isVoidHtmlElement(n.node)&&(n=new r.Position(n.node,n.isAtEnd?-3:-2));return n}];function o(e){var t;null===(t=null==e?void 0:e.parentNode)||void 0===t||t.removeChild(e)}t.insertNode=function(e,t,n){n=n||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0};var o=e.contentDiv;return n.updateCursor&&e.api.focus(e),4==n.position?(o.parentNode.insertBefore(t,o.nextSibling),!0):(e.api.transformColor(e,t,!0,(function(){switch(n.position){case 0:case 1:var a,s=0==n.position,l=r.getFirstLastBlockElement(o,s);if(l){var u=s?l.getStartNode():l.getEndNode();n.insertOnNewLine||3==u.nodeType||r.isVoidHtmlElement(u)?r.safeInstanceOf(t,"DocumentFragment")?(a=r.toArray(t.childNodes),u.parentNode.insertBefore(t,s?u:u.nextSibling)):a=u.parentNode.insertBefore(t,s?u:u.nextSibling):a=u.insertBefore(t,s?u.firstChild:null)}else a=o.appendChild(t);if(a&&n.insertOnNewLine){var d=Array.isArray(a)?a:[a];r.isBlockElement(d[0])&&r.isBlockElement(d[d.length-1])||r.wrap(d)}break;case 2:var c=o.appendChild(t);c&&n.insertOnNewLine&&!r.isBlockElement(c)&&r.wrap(c);break;case 5:case 3:var f=function(e,t){var n=e.api.getSelectionRange(e,!0),r=null;return 5==t.position?(r=n,n=t.range):n&&(r=n.cloneRange()),{range:n,rangeToRestore:r}}(e,n),p=f.range,h=f.rangeToRestore;if(!p)return;n.replaceSelection&&!p.collapsed&&p.deleteContents();var v=r.Position.getStart(p),g=void 0;n.insertOnNewLine&&(g=r.getBlockElementAtNode(o,v.normalize().node))?v=new r.Position(g.getEndNode(),-3):i.forEach((function(e){v=e(o,t,v)}));var m=11==t.nodeType?t.lastChild:t;(p=r.createRange(v)).insertNode(t),n.updateCursor&&m&&(h=r.createRange(new r.Position(m,-3).normalize())),e.api.selectRange(e,h)}}),0),!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreUndoSnapshot=function(e,t){e.undo.hasNewContent&&t<0&&e.api.addUndoSnapshot(e,null,null,!1);var n=e.undo.snapshotsService.move(t);if(null!=n)try{e.undo.isRestoring=!0,e.api.setContent(e,n,!0)}finally{e.undo.isRestoring=!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(77),i=n(0);t.selectRange=function(e,t,n){return!(e.lifecycle.shadowEditSelectionPath||!i.contains(e.contentDiv,t))&&(i.addRangeToSelection(t,n),r.hasFocus(e)||(e.domEvent.selectionRange=t),t.collapsed&&function(e){var t=e.contentDiv,n=e.pendingFormatState,r=e.api.getSelectionRange;if(n.pendableFormatState){var o=t.ownerDocument,a=i.getPendableFormatState(o);Object.keys(i.PendableFormatCommandMap).forEach((function(e){!!n.pendableFormatState[e]!=a[e]&&o.execCommand(i.PendableFormatCommandMap[e],!1,null)}));var s=r(e,!0);n.pendableFormatPosition=s&&i.Position.getStart(s)}}(e),!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.setContent=function(e,t,n){var i=!1;if(e.contentDiv.innerHTML!=t){var o=r.setHtmlWithSelectionPath(e.contentDiv,t);e.api.selectRange(e,o),i=!0}e.api.transformColor(e,e.contentDiv,!1,null,0),n&&(i||e.lifecycle.isDarkMode)&&e.api.triggerEvent(e,{eventType:7,source:"SetContent"},!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.switchShadowEdit=function(e,t){var n=e.lifecycle,i=e.contentDiv,o=n.shadowEditFragment,a=n.shadowEditSelectionPath,s=!!o;if(t){if(!s){var l=e.api.getSelectionRange(e,!0);for(a=l&&r.getSelectionPath(i,l),o=e.contentDiv.ownerDocument.createDocumentFragment();i.firstChild;)o.appendChild(i.firstChild);e.api.triggerEvent(e,{eventType:17,fragment:o,selectionPath:a},!1),n.shadowEditFragment=o,n.shadowEditSelectionPath=a}i.innerHTML="",i.appendChild(n.shadowEditFragment.cloneNode(!0))}else n.shadowEditFragment=null,n.shadowEditSelectionPath=null,s&&(e.api.triggerEvent(e,{eventType:18},!1),i.innerHTML="",i.appendChild(o),e.api.focus(e),a&&e.api.selectRange(e,r.createRange(i,a.start,a.end)))}},function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=((r={}).ogsc=function(e,t){return e.style.color=t},r.ogsb=function(e,t){return e.style.backgroundColor=t},r),s=((i={}).ogac="color",i.ogab="bgcolor",i);function l(e,t){return e&&"undefined"!=e&&"null"!=e?e:t}t.transformColor=function(e,t,n,r,i){var u=e.lifecycle.isDarkMode?function(e,t){var n=[];if(o.safeInstanceOf(e,"HTMLElement")){t&&n.push(e);var r=e.getElementsByTagName("*");o.arrayPush(n,o.toArray(r))}else if(o.safeInstanceOf(e,"DocumentFragment")){r=e.querySelectorAll("*");o.arrayPush(n,o.toArray(r))}return n}(t,n):[];null==r||r(),u.forEach((function(t){1==i&&(null==t?void 0:t.dataset)?(Object.keys(a).forEach((function(e){a[e](t,l(t.dataset[e],"")),delete t.dataset[e]})),Object.keys(s).forEach((function(e){var n=t.dataset[e];l(n,null)?t.setAttribute(s[e],n):t.removeAttribute(s[e]),delete t.dataset[e]}))):0==i&&t&&(e.lifecycle.onExternalContentTransform?e.lifecycle.onExternalContentTransform(t):(t.style.color=null,t.style.backgroundColor=null))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=function(e,t,n){e.lifecycle.shadowEditFragment||!n&&e.plugins.some((function(e){return function(e,t){var n;if(t.onPluginEvent&&(null===(n=t.willHandleEventExclusively)||void 0===n?void 0:n.call(t,e)))return t.onPluginEvent(e),!0;return!1}(t,e)}))||e.plugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(177),i=n(178),o=n(179),a=n(180),s=n(181),l=n(182),u=n(183),d=n(184),c=n(185),f=n(186);t.PLACEHOLDER_PLUGIN_NAME="_placeholder",t.default=function(e,t){var n=t.corePluginOverride||{};return{typeInContainer:n.typeInContainer||new c.default,edit:n.edit||new o.default,_placeholder:null,typeAfterLink:n.typeAfterLink||new d.default,undo:n.undo||new f.default(t),domEvent:n.domEvent||new i.default(t,e),pendingFormatState:n.pendingFormatState||new u.default,mouseUp:n.mouseUp||new l.default,copyPaste:n.copyPaste||new r.default(t),entity:n.entity||new a.default,lifecycle:n.lifecycle||new s.default(t,e)}},t.getPluginState=function(e){return{domEvent:e.domEvent.getState(),pendingFormatState:e.pendingFormatState.getState(),edit:e.edit.getState(),lifecycle:e.lifecycle.getState(),undo:e.undo.getState(),entity:e.entity.getState(),copyPaste:e.copyPaste.getState()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e){var t=this;this.onPaste=function(e){r.extractClipboardEvent(e,(function(e){if(void 0===e.rawHtml){var n=t.editor.getSelectionRange(),r=t.getTempDiv();t.editor.runAsync((function(){e.rawHtml=r.innerHTML,t.cleanUpAndRestoreSelection(r,n),t.paste(e)}))}else t.paste(e)}),{allowLinkPreview:t.editor.isFeatureEnabled("PasteWithLinkPreview"),allowedCustomPasteType:t.state.allowedCustomPasteType})},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[]}}return e.prototype.getName=function(){return"CopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:this.onPaste,copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onCutCopy=function(e,t){var n=this,i=this.editor.getSelectionRange();if(i&&!i.collapsed){var o=this.editor.getContent(2),a=this.getTempDiv(!0),s=r.setHtmlWithSelectionPath(a,o);s&&r.addRangeToSelection(s),this.editor.triggerPluginEvent(9,{clonedRoot:a,range:s,rawEvent:e,isCut:t}),this.editor.runAsync((function(e){n.cleanUpAndRestoreSelection(a,i),t&&e.addUndoSnapshot((function(){var t=n.editor.deleteSelectedContent();e.focus(),e.select(t)}),"Cut")}))}},e.prototype.paste=function(e){var t=this;e.image?r.readFile(e.image,(function(n){e.imageDataUri=n,t.editor.paste(e)})):this.editor.paste(e)},e.prototype.getTempDiv=function(e){var t=this,n=this.editor.getCustomData("CopyPasteTempDiv",(function(){var e=r.fromHtml('<div contenteditable style="width: 1px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text"></div>',t.editor.getDocument())[0];return t.editor.insertNode(e,{position:4}),e}),(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}));return e&&(n.style.backgroundColor="white",n.style.color="black"),n.style.display="",n.focus(),n},e.prototype.cleanUpAndRestoreSelection=function(e,t){this.editor.select(t),e.style.backgroundColor="",e.style.color="",e.style.display="none",e.innerHTML=""},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e,t){var n,i=this;this.onDrop=function(e){i.editor.runAsync((function(e){e.addUndoSnapshot((function(){}),"Drop")}))},this.onFocus=function(){i.editor.select(i.state.selectionRange),i.state.selectionRange=null},this.onBlur=function(){i.state.selectionRange=i.editor.getSelectionRange(!1)},this.onScroll=function(e){i.editor.triggerPluginEvent(14,{rawEvent:e,scrollContainer:i.state.scrollContainer})},this.onKeybaordEvent=function(e){r.isCharacterValue(e)&&e.stopPropagation()},this.onInputEvent=function(e){e.stopPropagation()},this.onContextMenuEvent=function(e){var t=[],n=i.editor.getContentSearcherOfCursor(),o=null==n?void 0:n.getInlineElementBefore(),a=e.target;2!=e.button&&(a=null==o?void 0:o.getContainerNode()),i.state.contextMenuProviders.forEach((function(e){var n=e.getContextMenuItems(a);(null==n?void 0:n.length)>0&&(t.length>0&&t.push(null),r.arrayPush(t,n))})),i.editor.triggerPluginEvent(16,{rawEvent:e,items:t})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,selectionRange:null,stopPrintableKeyboardEventPropagation:!e.allowKeyboardEventPropagation,contextMenuProviders:(null===(n=e.plugins)||void 0===n?void 0:n.filter(o))||[]}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n=this;this.editor=e,this.disposer=e.addDomEventHandler(((t={keypress:this.getEventHandler(1),keydown:this.getEventHandler(0),keyup:this.getEventHandler(2),mousedown:5,contextmenu:this.onContextMenuEvent,compositionstart:function(){return n.state.isInIME=!0},compositionend:function(t){n.state.isInIME=!1,e.triggerPluginEvent(4,{rawEvent:t})},drop:this.onDrop,focus:this.onFocus})[r.Browser.isIEOrEdge?"beforedeactivate":"blur"]=this.onBlur,t[r.Browser.isIE?"textinput":"input"]=this.getEventHandler(3),t)),this.state.scrollContainer.addEventListener("scroll",this.onScroll)},e.prototype.dispose=function(){this.state.scrollContainer.removeEventListener("scroll",this.onScroll),this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.getEventHandler=function(e){return this.state.stopPrintableKeyboardEventPropagation?{pluginEventType:e,beforeDispatch:3==e?this.onInputEvent:this.onKeybaordEvent}:e},e}();function o(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.getContextMenuItems)}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){this.state={features:{}}}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){var t,n=!1,i=!1;if(0==e.eventType){var o=e.rawEvent,a=this.editor.getSelectionRange();n=(i=r.isCtrlOrMetaPressed(o))||o.altKey,t=this.state.features[o.which]||a&&!a.collapsed&&this.state.features[258]}else 7==e.eventType&&(t=this.state.features[257]);for(var s=0;s<(null==t?void 0:t.length);s++){var l=t[s];if((l.allowFunctionKeys||!n)&&l.shouldHandleEvent(e,this.editor,i)){l.handleEvent(e,this.editor);break}}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=/_\d{1,8}$/,o=["^_Entity$","^_EId_","^_EType_","^_EReadonly_"],a=function(){function e(){var e=this;this.handleCutEvent=function(t){var n=e.editor.getSelectionRange();n&&!n.collapsed&&e.checkRemoveEntityForRange(t)},this.state={clickingPoint:null,knownEntityElements:[]}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.state.knownEntityElements=[],this.state.clickingPoint=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 5:this.handleMouseDownEvent(e.rawEvent);break;case 6:this.handleMouseUpEvent(e.rawEvent);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:e.isCut&&this.handleCutEvent(e.rawEvent);break;case 10:this.handleBeforePasteEvent(e.fragment,e.sanitizingOption);break;case 7:this.handleContentChangedEvent("SetContent"==e.source);break;case 11:this.handleContentChangedEvent(!0);break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot);break;case 16:this.handleContextMenuEvent(e.rawEvent)}},e.prototype.handleContextMenuEvent=function(e){var t=e.target,n=t&&this.editor.getElementAtCursor(r.getEntitySelector(),t);n&&(e.preventDefault(),this.triggerEvent(n,2,e))},e.prototype.handleMouseDownEvent=function(e){var t=e.target,n=e.pageX,i=e.pageY,o=t,a=o&&this.editor.getElementAtCursor(r.getEntitySelector(),o);a&&!a.isContentEditable&&(e.preventDefault(),this.state.clickingPoint={pageX:n,pageY:i})},e.prototype.handleMouseUpEvent=function(e){var t,n=e.target,i=e.pageX,o=e.pageY,a=n;this.state.clickingPoint&&this.state.clickingPoint.pageX==i&&this.state.clickingPoint.pageY==o&&a&&(t=this.editor.getElementAtCursor(r.getEntitySelector(),a))&&(e.preventDefault(),this.triggerEvent(t,1,e),s(this.editor)),this.state.clickingPoint=null},e.prototype.handleKeyDownEvent=function(e){(r.isCharacterValue(e)||8==e.which||46==e.which)&&(this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(e))},e.prototype.handleBeforePasteEvent=function(e,t){this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(null),r.arrayPush(t.additionalAllowedCssClasses,o)},e.prototype.handleContentChangedEvent=function(e){var t=this;this.state.knownEntityElements=e?[]:this.state.knownEntityElements.filter((function(e){return t.editor.contains(e)}));var n=this.state.knownEntityElements.map((function(e){var t;return null===(t=r.getEntityFromElement(e))||void 0===t?void 0:t.id})).filter((function(e){return!!e}));this.editor.queryElements(r.getEntitySelector(),(function(e){if(t.state.knownEntityElements.indexOf(e)<0){t.state.knownEntityElements.push(e);var i=r.getEntityFromElement(e);t.hydrateEntity(i,n)}}))},e.prototype.handleExtractContentWithDomEvent=function(e){var t=this;r.toArray(e.querySelectorAll(r.getEntitySelector())).forEach((function(e){e.removeAttribute("contentEditable"),t.triggerEvent(e,8)}))},e.prototype.checkRemoveEntityForRange=function(e){var t=this,n=[],i=r.getEntitySelector();if(this.editor.queryElements(i,1,(function(r){r.isContentEditable?n.push(r):t.triggerEvent(r,6,e)})),n.length>0){var o=this.editor.queryElements(i,2);n.forEach((function(n){var r=o.indexOf(n)>=0;t.triggerEvent(n,r?6:7,e)}))}},e.prototype.hydrateEntity=function(e,t){for(var n=e.id,o=e.type,a=e.wrapper,s=e.isReadonly,l=i.exec(n),u=(l?n.substr(0,n.length-l[0].length):n)||o,d="",c=l&&parseInt(l[1])||0;;c++)if(d=c>0?u+"_"+c:u,t.indexOf(d)<0){t.push(d);break}r.commitEntity(a,o,s,d),this.triggerEvent(a,0)},e.prototype.triggerEvent=function(e,t,n){var i=e&&r.getEntityFromElement(e);i&&this.editor.triggerPluginEvent(15,{operation:t,rawEvent:n,entity:i})},e}();t.default=a;var s=r.Browser.isIE?function(e){e.runAsync((function(e){var t=e.getCustomData("ENTITY_IE_FOCUS_BUTTON",(function(){var t=e.getDocument().createElement("button");return t.style.overflow="hidden",t.style.position="fixed",t.style.width="0",t.style.height="0",t.style.left="0",t.style.top="-1000px",t.onblur=function(){t.style.display="none"},e.insertNode(t,{position:4}),t}));t.style.display="";var n=e.getDocument().createRange();n.setStart(t,0);try{window.getSelection().removeAllRanges(),window.getSelection().addRange(n)}catch(e){}}))}:function(){}},function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=o.Browser.isFirefox?((r={}).enableObjectResizing=!1,r.enableInlineTableEditing=!1,r):o.Browser.isIE?((i={}).defaultParagraphSeparator="div",i.AutoUrlDetect=!1,i):{},s={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},l={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"},u=function(){function e(e,t){var n=this;this.initialContent=e.initialContent||t.innerHTML||"",this.contentDivFormat=o.getComputedStyles(t),null===t.getAttribute("contenteditable")&&(this.initializer=function(){t.contentEditable="true",n.setSelectStyle(t,"text")},this.disposer=function(){n.setSelectStyle(t,""),t.removeAttribute("contenteditable")}),this.state={customData:{},defaultFormat:e.defaultFormat||null,isDarkMode:!!e.inDarkMode,onExternalContentTransform:e.onExternalContentTransform,experimentalFeatures:e.experimentalFeatures||[],shadowEditFragment:null,shadowEditSelectionPath:null}}return e.prototype.getName=function(){return"Lifecycle"},e.prototype.initialize=function(e){var t;this.editor=e,this.recalculateDefaultFormat(),this.editor.setContent(this.initialContent,!1),null===(t=this.initializer)||void 0===t||t.call(this),this.adjustBrowserBehavior(),this.editor.triggerPluginEvent(11,{},!0)},e.prototype.dispose=function(){var e=this;this.editor.triggerPluginEvent(12,{},!0),Object.keys(this.state.customData).forEach((function(t){var n=e.state.customData[t];n&&n.disposer&&n.disposer(n.value),delete e.state.customData[t]})),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){7!=e.eventType||"SwitchToDarkMode"!=e.source&&"SwitchToLightMode"!=e.source||(this.state.isDarkMode="SwitchToDarkMode"==e.source,this.recalculateDefaultFormat())},e.prototype.adjustBrowserBehavior=function(){var e=this;Object.keys(a).forEach((function(t){try{e.editor.getDocument().execCommand(t,!1,a[t])}catch(e){}}))},e.prototype.setSelectStyle=function(e,t){e.style.userSelect=t,e.style.msUserSelect=t,e.style.webkitUserSelect=t},e.prototype.recalculateDefaultFormat=function(){var e=this.state,t=e.defaultFormat,n=e.isDarkMode;if(n&&t&&(t.backgroundColors||(t.backgroundColors=s),t.textColors||(t.textColors=l)),!t||0!==Object.keys(t).length){var r=t||{},i=r.fontFamily,o=r.fontSize,a=r.textColor,u=r.textColors,d=r.backgroundColor,c=r.backgroundColors,f=r.bold,p=r.italic,h=r.underline,v=this.contentDivFormat;this.state.defaultFormat={fontFamily:i||v[0],fontSize:o||v[1],get textColor(){return u?n?u.darkModeColor:u.lightModeColor:a||v[2]},textColors:u,get backgroundColor(){return c?n?c.darkModeColor:c.lightModeColor:d||""},backgroundColors:c,bold:f,italic:p,underline:h}}},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerPluginEvent(6,{rawEvent:t}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){5!=e.eventType||this.mouseUpEventListerAdded||(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0)},e.prototype.removeMouseUpEventListener=function(){this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){this.state={pendableFormatPosition:null,pendableFormatState:null}}return e.prototype.getName=function(){return"PendingFormatState"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.clear()},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 13:this.state.pendableFormatPosition=this.getCurrentPosition(),this.state.pendableFormatState=e.formatState;break;case 0:case 5:case 7:this.state.pendableFormatPosition&&!this.state.pendableFormatPosition.equalTo(this.getCurrentPosition())&&this.clear()}},e.prototype.clear=function(){this.state.pendableFormatPosition=null,this.state.pendableFormatState=null},e.prototype.getCurrentPosition=function(){var e=this.editor.getSelectionRange();return e&&r.Position.getStart(e).normalize()},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){}return e.prototype.getName=function(){return"TypeAfterLink"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(r.Browser.isFirefox&&1==e.eventType||10==e.eventType){var t=this.editor.getSelectionRange();if(t&&t.collapsed&&this.editor.getElementAtCursor("A[href]")){var n=this.editor.getContentSearcherOfCursor(e),i=n.getInlineElementBefore(),o=n.getInlineElementAfter();i instanceof r.LinkInlineElement?this.editor.select(i.getContainerNode(),-3):o instanceof r.LinkInlineElement&&this.editor.select(o.getContainerNode(),-2)}}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(1==e.eventType){var t=this.editor.getSelectionRange();if(!t||this.editor.contains(r.findClosestElementAncestor(t.startContainer)))return;t.collapsed?this.editor.ensureTypeInContainer(r.Position.getStart(t),e.rawEvent):this.editor.runAsync((function(t){t.ensureTypeInContainer(t.getFocusedPosition(),e.rawEvent)}))}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e){var t;this.state={snapshotsService:e.undoSnapshotService||(t=r.createSnapshots(1e7),{canMove:function(e){return r.canMoveCurrentSnapshot(t,e)},move:function(e){return r.moveCurrentSnapsnot(t,e)},addSnapshot:function(e,n){return r.addSnapshot(t,e,n)},clearRedo:function(){return r.clearProceedingSnapshots(t)},canUndoAutoComplete:function(){return r.canUndoAutoComplete(t)}}),isRestoring:!1,hasNewContent:!1,isNested:!1,autoCompletePosition:null}}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.willHandleEventExclusively=function(e){return 0==e.eventType&&8==e.rawEvent.which&&this.canUndoAutoComplete()},e.prototype.onPluginEvent=function(e){if(this.editor&&!this.editor.isInIME())switch(e.eventType){case 11:var t=this.editor.getUndoState();t.canUndo||t.canRedo||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 4:this.clearRedoForInput(),this.addUndoSnapshot();break;case 7:this.state.isRestoring||this.clearRedoForInput()}},e.prototype.onKeyDown=function(e){if(8==e.which||46==e.which)if(8==e.which&&this.canUndoAutoComplete())e.preventDefault(),this.editor.undo(),this.state.autoCompletePosition=null,this.lastKeyPress=e.which;else{var t=this.editor.getSelectionRange();!t||t.collapsed&&this.lastKeyPress==e.which&&!r.isCtrlOrMetaPressed(e)||this.addUndoSnapshot(),this.state.hasNewContent=!0,this.lastKeyPress=e.which}else e.which>=33&&e.which<=40&&(this.state.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},e.prototype.onKeyPress=function(e){if(!e.metaKey){var t=this.editor.getSelectionRange();t&&!t.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.state.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.clearRedoForInput=function(){this.state.snapshotsService.clearRedo(),this.lastKeyPress=0,this.state.hasNewContent=!0},e.prototype.canUndoAutoComplete=function(){var e;return this.state.snapshotsService.canUndoAutoComplete()&&(null===(e=this.state.autoCompletePosition)||void 0===e?void 0:e.equalTo(this.editor.getFocusedPosition()))},e.prototype.addUndoSnapshot=function(){this.editor.addUndoSnapshot(),this.state.autoCompletePosition=null},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(188);t.HyperLink=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e,t,n){var r=this;void 0===e&&(e=function(e){return e}),this.getTooltipCallback=e,this.target=t,this.onLinkClick=n,this.trackedLink=null,this.onMouse=function(e){var t=r.editor.getElementAtCursor("a[href]",e.target),n=r.tryGetHref(t);n&&r.editor.setEditorDomAttribute("title","mouseover"==e.type?r.getTooltipCallback(n,t):null)},this.onBlur=function(e){r.trackedLink&&r.updateLinkHrefIfShouldUpdate(),r.resetLinkTracking()}}return e.prototype.getName=function(){return"Hyperlink"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.getTooltipCallback&&e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse,blur:this.onBlur})},e.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},e.prototype.onPluginEvent=function(e){if(6==e.eventType||2==e.eventType&&(!this.isContentEditValue(e.rawEvent)||32==e.rawEvent.which)||7==e.eventType){var t=(n=this.editor.getElementAtCursor("A[href]",null,e))!==this.trackedLink||2==e.eventType||7==e.eventType;this.trackedLink&&(t||this.tryGetHref(this.trackedLink)!==this.originalHref)&&(t&&this.updateLinkHrefIfShouldUpdate(),this.resetLinkTracking()),!this.trackedLink&&this.doesLinkDisplayMatchHref(n)&&(this.trackedLink=n,this.originalHref=this.tryGetHref(n))}var n;if(6==e.eventType&&(n=this.editor.getElementAtCursor("A",e.rawEvent.srcElement))){if(this.onLinkClick&&!1!==this.onLinkClick(n,e.rawEvent))return;var i=void 0;if(!r.Browser.isFirefox&&(i=this.tryGetHref(n))&&r.isCtrlOrMetaPressed(e.rawEvent)&&0===e.rawEvent.button)try{var o=this.target||"_blank";this.editor.getDocument().defaultView.open(i,o)}catch(e){}}},e.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(e){}},e.prototype.isContentEditValue=function(e){return r.isCharacterValue(e)||8==e.which||46==e.which},e.prototype.updateLinkHrefIfShouldUpdate=function(){this.doesLinkDisplayMatchHref(this.trackedLink)||this.updateLinkHref()},e.prototype.resetLinkTracking=function(){this.trackedLink=null,this.originalHref=""},e.prototype.doesLinkDisplayMatchHref=function(e){if(e){var t=e.innerText.trim().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp("^(?:https?:\\/\\/)?"+t+"\\/?","i"),r=this.tryGetHref(e);if(null!==r)return n.test(r)}return!1},e.prototype.updateLinkHref=function(){var e=this;if(this.trackedLink){var t=r.matchLink(this.trackedLink.innerText.trim());null!==t&&this.editor.addUndoSnapshot((function(){e.trackedLink.href=t.normalizedUrl}))}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(190);t.Paste=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(191),i=n(192),o=n(193),a=n(197),s=n(0),l=n(82),u=n(198),d=function(){function e(e){void 0===e&&(e="SPAN"),this.unknownTagReplacement=e}return e.prototype.getName=function(){return"Paste"},e.prototype.initialize=function(){},e.prototype.dispose=function(){},e.prototype.onPluginEvent=function(e){if(10==e.eventType){var t=e.htmlAttributes,n=e.fragment,d=e.sanitizingOption,c=void 0;"urn:schemas-microsoft-com:office:word"==t["xmlns:w"]?o.default(e):"urn:schemas-microsoft-com:office:excel"==t["xmlns:x"]||"Excel.Sheet"==t.ProgId?r.default(e):(c=s.toArray(n.querySelectorAll(l.WAC_IDENTIFING_SELECTOR)))&&c.length>0?(c.forEach((function(e){e.style.display=null,e.style.margin=null})),u.isWordOnlineWithList(n)&&u.default(n)):n.querySelector("google-sheets-html-origin")?d.additionalTagReplacements["google-sheets-html-origin"]="*":(i.default(n),a.default(n)),d.unknownTagReplacement=this.unknownTagReplacement}},e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,o=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,a=/<tr[^>]*>[^<]*/i,s=/<table[^>]*>[^<]*/i;function l(e,t){if(e.match(i)){var n=t.match(a);e=(n?n[0]:"<TR>")+e+"</TR>"}if(e.match(o)){var r=t.match(s);e=(r?r[0]:"<TABLE>")+e+"</TABLE>"}return e}t.default=function(e){var t,n=e.fragment,i=e.sanitizingOption,o=e.htmlBefore,a=e.clipboardData,s=l(a.html,o);if(a.html!=s){for(var u=(new DOMParser).parseFromString(s,"text/html");n.firstChild;)n.removeChild(n.firstChild);for(;null===(t=null==u?void 0:u.body)||void 0===t?void 0:t.firstChild;)n.appendChild(u.body.firstChild)}r.chainSanitizerCallback(i.elementCallbacks,"TD",(function(e){return"none"==e.style.borderStyle&&(e.style.border="solid 1px #d4d4d4"),!0}))},t.excelHandler=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){var t=e.firstChild;!t||t.nextSibling||"DIV"!=r.getTagOfNode(t)||r.toArray(t.childNodes).some((function(e){return"LI"!=r.getTagOfNode(e)}))||r.changeElementTag(t,"UL")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(194),o=n(195),a=n(196);t.default=function(e){var t=e.sanitizingOption,n=e.fragment;r.chainSanitizerCallback(t.elementCallbacks,"O:P",(function(e){return e.innerHTML="&nbsp;",!0}));var s=i.createWordConverter(),l=n.querySelectorAll("p");l.length>0&&(s.wordConverterArgs=o.createWordConverterArguments(l),a.processNodesDiscovery(s)&&a.processNodeConvert(s))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(80);t.createWordConverter=function(){return{nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,wordCustomData:r.createCustomData()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(81);t.createWordConverterArguments=function(e){return{nodes:e,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[r.createLevelLists()],lastProcessedItem:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(81),i=n(80),o=n(0),a=/[\n|\r]/gi;function s(e,t,n,r){var a=function e(t,n,r){var i,a=null;1==n?i=p(t):(a=e(t,n-1,null),i=a.lastChild);if(i&&1==i.nodeType){var s=o.getTagOfNode(i);if("UL"==s||"OL"==s)return i}var l=t.ownerDocument.createElement(r?r.tagName:"UL");1==n?t.parentNode.insertBefore(l,t):a.appendChild(l);return l}(t,n.level,r),s=i.getObject(e.wordCustomData,a,"UniqueListId");if(s&&s!=n.uniqueListId||!s&&a.firstChild){var l=t.ownerDocument.createElement(r.tagName);a.parentNode.insertBefore(l,a.nextSibling),a=l}return i.setObject(e.wordCustomData,a,"UniqueListId",n.uniqueListId),function(e,t,n){if(n.tagName!=o.getTagOfNode(t)){var r=t.ownerDocument.createElement(n.tagName);for(i.setObject(e.wordCustomData,r,"UniqueListId",i.getObject(e.wordCustomData,t,"UniqueListId"));t.firstChild;)r.appendChild(t.firstChild);t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t),t=r}return t}(e,a,r)}function l(e,t){for(var n=[],r=e.firstChild;r;r=r.nextSibling)1==r.nodeType&&t>1&&l(r,t-1),(g(r=f(r,!0))||v(r))&&n.push(r);n.forEach((function(t){return e.removeChild(t)}))}function u(e){if(1==e.nodeType){var t=m(e,"mso-list");if(t&&t.length>0)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr("level".length)),wordListId:t,originalNode:e,uniqueListId:0}}catch(e){}}return null}function d(e){return["o","·","§","-"].indexOf(e)>=0}function c(e,t){for(var n=null,r=e.firstChild;!n&&r;)v(r=f(r,!0))?0==(n=r.textContent.trim()).length&&(n="o"):1==r.nodeType&&t>1&&(n=c(r,t-1)),r=r.nextSibling;return n}function f(e,t){if(8==e.nodeType){var n=e.data;if(n&&"[if !supportlists]"==n.trim().toLowerCase()){for(var r=e,i=null,o=0;o<4&&(r=h(r));o++)if(8==r.nodeType&&(n=r.data)&&"[endif]"==n.trim().toLowerCase()){i=r;break}if(i){var a=e.ownerDocument.createElement("span");for(a.setAttribute("style","mso-list: ignore"),r=h(e);r!=i;)r=r.nextSibling,a.appendChild(r.previousSibling);i.parentNode.insertBefore(a,i),t&&(e.parentNode.removeChild(e),i.parentNode.removeChild(i)),e=a}}}return e}function p(e){var t=e;do{t=t.previousSibling}while(t&&y(t));return t}function h(e){var t=e;do{t=t.nextSibling}while(t&&y(t));return t}function v(e){if(1==e.nodeType){var t=m(e,"mso-list");if(t&&t.length>0&&"ignore"==t.trim().toLowerCase())return!0}return!1}function g(e){return"SPAN"==o.getTagOfNode(e)&&!e.firstChild}function m(e,t){return o.getStyles(e)[t]||null}function y(e){if(!e)return!0;if(3==e.nodeType){var t=e.nodeValue;return 0==(t=t.replace(a,"")).trim().length}var n=o.getTagOfNode(e);return e.firstChild==e.lastChild&&("SPAN"==n||"FONT"==n)&&y(e.firstChild)}function E(e){for(var t=0;t<e.currentListIdsByLevels.length;t++){var n=e.currentListIdsByLevels[t];n&&(n.currentUniqueListId=-1)}}t.processNodesDiscovery=function(e){for(var t,n=e.wordConverterArgs;n.currentIndex<n.nodes.length;){var i=n.nodes.item(n.currentIndex),o=u(i);if(o){var a=n.currentListIdsByLevels[o.level-1]||r.createLevelLists();n.currentListIdsByLevels[o.level-1]=a,n.lastProcessedItem&&p(i)!=n.lastProcessedItem&&E(n);var s=a.listsMetadata[o.wordListId];if(s){if(!s.ignore&&1==s.numberOfItems){var l=c(i,5);s.tagName=s.firstFakeBullet==l?"UL":"OL"}}else{var f=c(i,5);s={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:f,ignore:!f||0==f.length,tagName:(t=f,d(t)?"UL":"OL")},a.listsMetadata[o.wordListId]=s,n.lists[s.uniqueListId.toString()]=s}o.uniqueListId=s.uniqueListId,s.ignore||"OL"==s.tagName&&s.numberOfItems>0&&a.currentUniqueListId!=o.uniqueListId?(s.ignore=!0,n.currentListIdsByLevels[0].currentUniqueListId=-1,n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,1)):(n.currentListIdsByLevels.length>o.level&&(n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,o.level)),a.currentUniqueListId=o.uniqueListId,n.listItems.push(o),s.numberOfItems++),n.lastProcessedItem=i}else{var h=n.lastProcessedItem;if(h&&p(i)==h&&i.tagName==h.tagName&&i.className==h.className){for(h.appendChild(h.ownerDocument.createElement("br")),h.appendChild(h.ownerDocument.createElement("br"));null!=i.firstChild;)h.appendChild(i.firstChild);i.parentNode.removeChild(i)}}n.currentIndex++}return n.listItems.length>0},t.processNodeConvert=function(e){var t=e.wordConverterArgs;for(t.currentIndex=0;t.currentIndex<t.listItems.length;){var n=t.listItems[t.currentIndex],r=n.originalNode,i=t.lists[n.uniqueListId.toString()];if(!i.ignore){var o=s(e,r,n,i);if(o){l(r,5);for(var a=r.ownerDocument.createElement("LI");r.firstChild;)a.appendChild(r.firstChild);o.appendChild(a),r.parentNode.removeChild(r),"UL"==i.tagName?e.numBulletsConverted++:e.numNumberedConverted++}}t.currentIndex++}return e.numBulletsConverted>0||e.numNumberedConverted>0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function i(e){var t,n,i=e.start,o=e.end;if(i==o&&"DIV"==r.getTagOfNode(i)){var a=r.changeElementTag(i,"SPAN");e.start=a,e.end=a,"BR"==r.getTagOfNode(a.lastChild)&&a.removeChild(a.lastChild)}else if("BR"==r.getTagOfNode(o)){a=o.ownerDocument.createTextNode("");null===(t=o.parentNode)||void 0===t||t.insertBefore(a,o),e.end=a,null===(n=o.parentNode)||void 0===n||n.removeChild(o)}}function o(e,t,n){var i,o=r.getBlockElementAtNode(e,t.start),a=n?r.getNextLeafSibling(e,t.end):r.getPreviousLeafSibling(e,t.start);(null==o?void 0:o.contains(a))&&(null===(i=(n?t.end:t.start).parentNode)||void 0===i||i.insertBefore(t.start.ownerDocument.createElement("br"),n?t.end.nextSibling:t.start))}t.default=function(e){for(var t=r.ContentTraverser.createBodyTraverser(e),n=[],a=null==t?void 0:t.currentBlockElement;a;a=t.getNextBlockElement())n.push({start:a.getStartNode(),end:a.getEndNode()});n.length>0&&(i(n[0]),i(n[n.length-1]),o(e,n[0],!0),o(e,n[n.length-1],!1))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),i=n(82),o=n(0);function a(e,t,n){if(e){var r,i=n.insertPositionNode;if(i)(r=i.parentNode)&&r.insertBefore(e,i);else(r=n.startElement.parentNode)?r.appendChild(e):t.appendChild(e)}}t.isWordOnlineWithList=function(e){return!(!e||!e.querySelector(i.WORD_ONLINE_IDENTIFYING_SELECTOR))},t.default=function(e){!function(e){o.toArray(e.querySelectorAll(i.WORD_ORDERED_LIST_SELECTOR+", "+i.WORD_UNORDERED_LIST_SELECTOR)).forEach((function(e){var t=new RegExp("\\b"+i.LIST_CONTAINER_ELEMENT_CLASS_NAME+"\\b","g");if(e.previousSibling){var n=o.splitParentNode(e,!0);n.className=n.className.replace(t,"")}if(e.nextSibling){var r=o.splitParentNode(e,!1);r.className=r.className.replace(t,"")}}))}(e),function(e){for(var t,n=e.querySelectorAll("."+i.LIST_CONTAINER_ELEMENT_CLASS_NAME),a=[],s=0;s<n.length;s++){var l=n[s];if(t){var u=t.listItemContainers,d=u[u.length-1];l==d.nextSibling||o.getFirstLeafNode(l)==o.getNextLeafSibling(d.parentNode,d)?(u.push(l),t.endElement=l):(t.endElement=d,a.push(t),t=r.createListItemBlock(l))}else t=r.createListItemBlock(l)}(null==t?void 0:t.listItemContainers.length)>0&&a.push(t);return a}(e).forEach((function(t){var n;!function(e,t){o.collapseNodes(e,t.startElement,t.endElement,!0).forEach((function(e){"DIV"==o.getTagOfNode(e.firstChild)&&o.unwrap(e)}))}(e,t),t.insertPositionNode=t.endElement.nextSibling;var r=e.ownerDocument;t.listItemContainers.forEach((function(s){var l=function(e){var t=o.getTagOfNode(e.firstChild);return t==i.UNORDERED_LIST_TAG_NAME||t==i.ORDERED_LIST_TAG_NAME?t:null}(s);n||(n=r.createElement(l)),o.toArray(s.querySelectorAll("li")).forEach((function(s){var u=parseInt(s.getAttribute("data-aria-level"));o.getTagOfNode(n)!=l&&1==u&&(a(n,e,t),n=r.createElement(l)),function(e,t,n,r){if(!n)return;var a=parseInt(t.getAttribute("data-aria-level")),s=e;for(;a>1;){if(s.firstChild){var l=s.lastElementChild,u=o.getTagOfNode(l);u==i.UNORDERED_LIST_TAG_NAME||u==i.ORDERED_LIST_TAG_NAME?s=l:(s.appendChild(r.createElement(n)),s=s.lastElementChild)}else s.appendChild(r.createElement(n)),s=s.firstElementChild;a--}s.appendChild(t)}(n,s,l,r)}))})),a(n,e,t);var s=t.startElement.parentNode;s&&t.listItemContainers.forEach((function(e){s.removeChild(e)}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListItemBlock=function(e){return void 0===e&&(e=null),{startElement:e,endElement:e,insertPositionNode:null,listItemContainers:e?[e]:[]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(43)),r(n(202)),r(n(205)),r(n(208)),r(n(78)),r(n(211)),r(n(79)),r(n(214)),r(n(217)),r(n(220))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(203))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(204);t.ContextMenu=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e){var t=this;this.options=e,this.onDismiss=function(){var e,n;t.container&&t.isMenuShowing&&(null===(n=(e=t.options).dismiss)||void 0===n||n.call(e,t.container),t.isMenuShowing=!1)}}return e.prototype.getName=function(){return"ContextMenu"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.onDismiss(),this.container&&(this.container.parentNode.removeChild(this.container),this.container=null),this.editor=null},e.prototype.onPluginEvent=function(e){if(16==e.eventType&&e.items.length>0){var t=e.rawEvent,n=e.items;this.onDismiss(),this.options.allowDefaultMenu||t.preventDefault(),this.initContainer(t.pageX,t.pageY),this.options.render(this.container,n,this.onDismiss),this.isMenuShowing=!0}},e.prototype.initContainer=function(e,t){this.container||(this.container=r.fromHtml('<div style="position: fixed; width: 0; height: 0"></div>',this.editor.getDocument())[0],this.editor.insertNode(this.container,{position:4})),this.container.style.left=e+"px",this.container.style.top=t+"px"},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(206))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(207);t.CustomReplace=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:n}},i=[r(":)","🙂",!0),r(";)","😉",!0),r(":O","😲",!0),r(":o","😯",!0),r("<3","❤️",!0)],o=function(){function e(e){void 0===e&&(e=i),this.updateReplacements(e)}return e.prototype.updateReplacements=function(e){var t;this.replacements=e,this.longestReplacementLength=(t=this.replacements,Math.max.apply(null,t.map((function(e){return e.sourceString.length})))),this.replacementEndCharacters=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var i=r[n],o=i.sourceString;if(0!=o.length){var a=o[o.length-1];i.matchSourceCaseSensitive?t.add(a):(t.add(a.toLocaleLowerCase()),t.add(a.toLocaleUpperCase()))}}return t}(this.replacements)},e.prototype.getName=function(){return"CustomReplace"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=this;if(!this.editor.isInIME()&&3==e.eventType&&(e.rawEvent.data&&this.replacementEndCharacters.has(e.rawEvent.data)&&null!=this.editor.getSelectionRange())){var n=this.editor.getContentSearcherOfCursor(e),r=n.getSubStringBefore(this.longestReplacementLength),i=this.getMatchingReplacement(r);if(null!=i){var o=n.getSubStringBefore(i.sourceString.length),a=n.getRangeFromText(o,!0),s=this.editor.getDocument().createElement("span");s.innerHTML=i.replacementHTML;var l=1==s.childNodes.length?s.childNodes[0]:s;this.editor.addUndoSnapshot((function(){a.deleteContents(),a.insertNode(l),t.editor.select(l,-1)}),null,!0)}}},e.prototype.getMatchingReplacement=function(e){if(0==e.length)return null;for(var t=e.toLocaleLowerCase(),n=0,r=this.replacements;n<r.length;n++){var i=r[n],o=i.matchSourceCaseSensitive?[e,i.sourceString]:[t,i.sourceString.toLocaleLowerCase()],a=o[0],s=o[1];if(a.substring(a.length-s.length)==s)return i}return null},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(209))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(210);t.CutPasteListChain=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(0),o=function(){function e(){var e=this;this.onDrop=function(){e.cacheListChains("Drop")}}return e.prototype.getName=function(){return"CutPasteListChain"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler("drop",this.onDrop)},e.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 9:e.isCut&&this.cacheListChains("Cut");break;case 10:this.cacheListChains("Paste");break;case 7:(null===(t=this.chains)||void 0===t?void 0:t.length)>0&&this.expectedChangeSource==e.source&&(r.experimentCommitListChains(this.editor,this.chains),this.chains=null,this.expectedChangeSource=null)}},e.prototype.cacheListChains=function(e){this.chains=i.VListChain.createListChains(this.editor.getSelectedRegions()),this.expectedChangeSource=e},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(212))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(213);t.ImageResize=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(6),o="IMAGE_RESIZE_WRAPPER",a=["nw","ne","se","sw"],s=a.concat(["n","e","s","w"]),l=function(){function e(e,t,n,r,i){var o=this;void 0===e&&(e=10),void 0===t&&(t=10),void 0===n&&(n="#DB626C"),void 0===r&&(r=!1),void 0===i&&(i="img"),this.minWidth=e,this.minHeight=t,this.selectionBorderColor=n,this.forcePreserveRatio=r,this.resizableImageSelector=i,this.startResize=function(e){var t=o.getSelectedImage();if(o.editor&&t){o.startPageX=e.pageX,o.startPageY=e.pageY,o.startWidth=t.clientWidth,o.startHeight=t.clientHeight,o.editor.addUndoSnapshot();var n=o.editor.getDocument();n.addEventListener("mousemove",o.doResize,!0),n.addEventListener("mouseup",o.finishResize,!0),o.direction=(e.srcElement||e.target).dataset.direction}o.stopEvent(e)},this.doResize=function(e){var t=o.getSelectedImage();if(o.editor&&t){var n=e.pageX-o.startPageX,r=e.pageY-o.startPageY,i=o.calculateNewWidth(n),a=o.calculateNewHeight(r),s=!(o.isSingleDirectionNS(o.direction)||o.isSingleDirectionWE(o.direction))&&(o.forcePreserveRatio||e.shiftKey);if(s)a=Math.min(a,i*o.startHeight/o.startWidth),i=Math.min(i,a*o.startWidth/o.startHeight),(l=o.startWidth>0&&o.startHeight>0?1*o.startWidth/o.startHeight:0)>0&&(i<a*l?i=a*l:a=i/l);if(t.style.width=i+"px",t.style.height=a+"px",s){var l=o.startWidth>0&&o.startHeight>0?1*o.startWidth/o.startHeight:0,u=Math.floor(t.clientWidth),d=Math.floor(t.clientHeight);i=Math.floor(i),d===(a=Math.floor(a))&&u===i||(d<a?i=d*l:a=u/l,t.style.width=i+"px",t.style.height=a+"px")}}o.stopEvent(e)},this.finishResize=function(e){var t=o.getSelectedImage();if(o.editor&&t){var n=o.editor.getDocument();n.removeEventListener("mousemove",o.doResize,!0),n.removeEventListener("mouseup",o.finishResize,!0);var r=t.clientWidth,i=t.clientHeight;t.style.width=r+"px",t.style.height=i+"px",t.width=r,t.height=i,o.resizeDiv.style.width="",o.resizeDiv.style.height=""}o.direction=null,o.editor.addUndoSnapshot(),o.editor.triggerContentChangedEvent("ImageResize",t),o.stopEvent(e)},this.stopEvent=function(e){e.stopPropagation(),e.preventDefault()},this.removeResizeDiv=function(e){if(null==e?void 0:e.parentNode){var t=e.querySelector("img");return t&&e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e),t}return null},this.onBlur=function(e){o.hideResizeHandle()},this.onDragStart=function(e){(e.srcElement||e.target)==o.getSelectedImage()&&o.hideResizeHandle(!0)}}return e.prototype.getName=function(){return"ImageResize"},e.prototype.initialize=function(e){this.editor=e,this.disposer=e.addDomEventHandler({dragstart:this.onDragStart,blur:this.onBlur})},e.prototype.dispose=function(){this.hideResizeHandle(),this.disposer(),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t,n=this;if(5==e.eventType)this.resizeDiv&&this.hideResizeHandle();else if(6==e.eventType){var i=e.rawEvent,a=i.srcElement||i.target;if("IMG"==r.getTagOfNode(a)&&a.isContentEditable){var s=a.parentNode;if((s?r.toArray(s.querySelectorAll(this.resizableImageSelector)):[]).indexOf(a)<0)return;var l=this.getSelectedImage();l&&l!=a&&this.hideResizeHandle(),this.resizeDiv||this.showResizeHandle(a)}}else if(0==e.eventType&&this.resizeDiv){var u=e.rawEvent;46==u.which||8==u.which?(this.editor.addUndoSnapshot((function(){n.editor.deleteNode(n.resizeDiv)})),this.resizeDiv=null,u.preventDefault()):16!=u.which&&17!=u.which&&18!=u.which&&this.hideResizeHandle(!0)}else 7!=e.eventType||"ImageResize"==e.source||"InsertEntity"==e.source&&(null===(t=e.data)||void 0===t?void 0:t.type)==o?15==e.eventType&&e.entity.type==o&&(8==e.operation?this.removeResizeDiv(e.entity.wrapper):1==e.operation&&this.stopEvent(e.rawEvent)):(this.editor.queryElements(r.getEntitySelector(o),this.removeResizeDiv),this.resizeDiv=null)},e.prototype.showResizeHandle=function(e){this.resizeDiv=this.createResizeDiv(e),this.editor.select(this.resizeDiv,-3)},e.prototype.hideResizeHandle=function(e){if(this.resizeDiv){var t=this.resizeDiv.style.transform,n=this.removeResizeDiv(this.resizeDiv);n&&(n.style.transform=t,e&&this.editor.select(n)),this.resizeDiv=null}},e.prototype.calculateNewWidth=function(e){var t=this.startWidth;return this.isSingleDirectionNS(this.direction)||(t=Math.max(this.startWidth+(this.isWest(this.direction)?-e:e),this.minWidth)),t},e.prototype.calculateNewHeight=function(e){var t=this.startHeight;return this.isSingleDirectionWE(this.direction)||(t=Math.max(this.startHeight+(this.isNorth(this.direction)?-e:e),this.minHeight)),t},e.prototype.createResizeDiv=function(e){var t=this,n=i.insertEntity(this.editor,o,e,!1,!0).wrapper;n.style.position="relative",n.style.display=r.Browser.isSafari?"inline-block":"inline-flex";var l=(this.editor.isFeatureEnabled("SingleDirectionResize")?s:a).map((function(e){return'<div style="position:absolute;'+(t.isWest(e)?"left":"right")+":"+(t.isSingleDirectionNS(e)?"50%":"0px")+";"+(t.isNorth(e)?"top":"bottom")+":"+(t.isSingleDirectionWE(e)?"50%":"0px")+'">\n                            <div id='+e+'-handle data-direction="'+e+'" style="position:relative;width:7px;height:7px;background-color: '+t.selectionBorderColor+";cursor: "+e+"-resize;"+(t.isNorth(e)?"top":"bottom")+":-3px;"+(t.isWest(e)?"left":"right")+':-3px"></div></div>'})).join("")+'<div style="position:absolute;left:0;right:0;top:0;bottom:0;border:solid 1px '+this.selectionBorderColor+';pointer-events:none;">';r.fromHtml(l,this.editor.getDocument()).forEach((function(e){n.appendChild(e),e.addEventListener("mousedown",t.startResize)}));var u=this.getSelectedImage(n);return u&&u.style&&u.style.transform&&(n.style.transform=u.style.transform,u.style.transform=""),n},e.prototype.getSelectedImage=function(e){var t=e||this.resizeDiv;return t?t.getElementsByTagName("IMG")[0]:null},e.prototype.isNorth=function(e){return e&&"n"==e.substr(0,1)},e.prototype.isWest=function(e){return e&&("w"==e.substr(1,1)||"w"==e)},e.prototype.isSingleDirectionNS=function(e){return e&&("n"==e||"s"==e)},e.prototype.isSingleDirectionWE=function(e){return e&&("w"==e||"e"==e)},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(215))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(216);t.PickerPlugin=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(0),o=i.Browser.isIE?"Esc":"Escape",a=i.Browser.isIE?"Left":"ArrowLeft",s=i.Browser.isIE?"Up":"ArrowUp",l=i.Browser.isIE?"Right":"ArrowRight",u=i.Browser.isIE?"Down":"ArrowDown",d=i.Browser.isIE?"Del":"Delete",c=[0,229],f=function(){function e(e,t){this.dataProvider=e,this.pickerOptions=t,this.isPendingInputEventHandling=!1}return e.prototype.getName=function(){return"Picker"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.dataProvider.onInitalize((function(e){t.editor.focus();var n=t.getWord(null);n&&0!=n.length||!t.lastKnownRange||(t.editor.select(t.lastKnownRange),n=t.getWord(null));t.editor.addUndoSnapshot((function(){n?r.replaceWithNode(t.editor,n,e,!0):t.editor.insertNode(e),t.setIsSuggesting(!1)}),t.pickerOptions.changeSource,t.pickerOptions.handleAutoComplete)}),(function(e){t.setIsSuggesting(e)}),e)},e.prototype.dispose=function(){this.editor=null,this.dataProvider.onDispose()},e.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||3==e.eventType)},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 7:if("SetContent"==e.source&&this.dataProvider.onContentChanged){this.isSuggesting&&this.setIsSuggesting(!1);var t=[];this.editor.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",(function(e){e.id&&t.push(e.id)})),this.dataProvider.onContentChanged(t)}break;case 0:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 3:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 6:this.isSuggesting&&this.setIsSuggesting(!1);break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},e.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},e.prototype.setIsSuggesting=function(e){this.isSuggesting=e,e||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},e.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},e.prototype.getIdValue=function(e){var t=e;return t.attributes&&t.attributes.getNamedItem("id")?t.attributes.getNamedItem("id").value:null},e.prototype.getWordBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e);return t?t.getWordBefore():null},e.prototype.replaceNode=function(e,t){e&&this.editor.deleteNode(e),t&&this.editor.insertNode(t)},e.prototype.getRangeUntilAt=function(e){var t,n,r=this;return this.editor.getContentSearcherOfCursor(e).forEachTextInlineElement((function(e){for(var i=!1,o=e.getTextContent(),a=o?o.length:-1;a>=0;){if(o[a]==r.pickerOptions.triggerCharacter){t=e.getStartPosition().move(a),i=!0;break}a--}return i&&(n=e.getEndPosition()),i})),i.createRange(t,n)||this.editor.getDocument().createRange()},e.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||i.isCharacterValue(e.rawEvent)||this.isSuggesting&&!i.isModifierKey(e.rawEvent)},e.prototype.onKeyUpDomEvent=function(e){if(this.isSuggesting){var t=(r=(n=this.getWord(e)).substring(1)).trim();n==this.pickerOptions.triggerCharacter||t&&t.length>0&&t.split(" ").length<=4?(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange())):this.setIsSuggesting(!1)}else{var n=this.getWordBeforeCursor(e);if(this.blockSuggestions)null!=n&&n[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1);else if(null!=n&&n.split(" ").length<=4&&n[0]==this.pickerOptions.triggerCharacter){this.setIsSuggesting(!0);var r;t=(r=n.substring(1)).trim();if(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange()),this.dataProvider.setCursorPoint){var i=this.editor.getContentSearcherOfCursor(e),o=this.editor.getDocument().createRange(),a=i.getInlineElementBefore().getContainerNode();if(!this.setRangeStart(o,a,n)){var s=a.previousSibling;this.setRangeStart(o,s,this.pickerOptions.triggerCharacter)}var l=o.getBoundingClientRect();if(0==l.left&&0==l.bottom&&0==l.top&&(l=o.getClientRects()[0]),l){o.detach();var u={x:l.left,y:(l.bottom+l.top)/2},d=(l.bottom-l.top)/2;this.dataProvider.setCursorPoint(u,d)}}}}},e.prototype.onKeyDownEvent=function(e){var t=e.rawEvent;if(this.isSuggesting)if(t.key==o)this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e);else if("Backspace"==t.key){this.getWord(e)==this.pickerOptions.triggerCharacter&&this.setIsSuggesting(!1)}else this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?t.key==a||t.key==l:t.key==s||t.key==u)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?t.key==l:t.key==u),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=t.key&&"Tab"!=t.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e));else if("Backspace"==t.key)this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e);else if(t.key==d){var n=this.editor.getContentSearcherOfCursor(e),r=n.getInlineElementAfter()?n.getInlineElementAfter().getContainerNode():null,i=r?this.getIdValue(r):null;if(i&&0==i.indexOf(this.pickerOptions.elementIdPrefix)){var c=this.dataProvider.onRemove(r,!1);this.replaceNode(r,c),this.cancelDefaultKeyDownEvent(e)}}},e.prototype.onAndroidInputEvent=function(e){(this.newInputLength=this.calcInputLength(e),this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&(this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0))},e.prototype.calcInputLength=function(e){var t=this.getInlineElementBeforeCursor(e);return t?t.length:0},e.prototype.tryRemoveNode=function(e){var t=this.editor.getContentSearcherOfCursor(e),n=t.getInlineElementBefore(),r=n?n.getContainerNode():null,o=r?this.getIdValue(r):null,a=t.getInlineElementAfter();if(o&&0==o.indexOf(this.pickerOptions.elementIdPrefix)&&(null==a||!(a instanceof i.PartialInlineElement))){var s=this.dataProvider.onRemove(r,!0);return s?(this.replaceNode(r,s),this.isPendingInputEventHandling?this.editor.runAsync((function(e){e.select(s,-3)})):this.editor.select(s,-3)):this.editor.deleteNode(r),!0}return!1},e.prototype.getWord=function(e){var t=this.getRangeUntilAt(e).toString(),n=this.getWordBeforeCursor(e);return t==this.pickerOptions.triggerCharacter&&t!=n?n:t},e.prototype.setRangeStart=function(e,t,n){var r=t?t.textContent.lastIndexOf(n):-1;return r>-1&&(e.setStart(t,r),!0)},e.prototype.setAriaOwns=function(e){this.editor.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},e.prototype.setAriaActiveDescendant=function(e){this.editor.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},e.prototype.getInlineElementBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e),n=t?t.getInlineElementBefore():null;return n?n.getTextContent():null},e.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||null==e.rawEvent.key&&c.indexOf(e.rawEvent.charCode)>-1},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(218))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(219);t.TableResize=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){var e=this;this.tableRectMap=null,this.currentCellsToResize=[],this.nextCellsToResize=[],this.resizingState=0,this.insertingState=0,this.onMouseMove=function(t){var n;if(0==e.resizingState&&(e.tableRectMap||e.cacheRects(),e.tableRectMap)){for(var i=e.tableRectMap.length-1;i>=0;i--){var o=e.tableRectMap[i],a=o.table,s=o.rect;if(t.pageX<=s.right+(e.isRTL?12:0)&&t.pageX>=s.left-(e.isRTL?0:12)&&t.pageY>=s.top-12&&t.pageY<=s.bottom){e.setCurrentTable(a,s);break}}if(i<0&&e.setCurrentTable(null),e.currentTable)for(var l=e.tableRectMap.filter((function(t){return t.table==e.currentTable}))[0],u=0;u<e.currentTable.rows.length;u++){for(var d=e.currentTable.rows[u],c=0;c<d.cells.length;c++){var f=d.cells[c],p=r.normalizeRect(f.getBoundingClientRect());if(p&&(e.isRTL?t.pageX>=p.left:t.pageX<=p.right)&&t.pageY<=p.bottom)if(0==u&&t.pageY<=p.top+5){var h=null;if(e.isRTL?t.pageX<=p.left+(p.right-p.left)/2:t.pageX>=p.left+(p.right-p.left)/2)h=f;else if(e.isRTL?t.pageX<=p.right:t.pageX>=p.left){(g=f.previousElementSibling)&&(h=g)}if(h){e.setCurrentTd(null),e.setCurrentInsertTd(2,h,l.rect);break}}else{if(0!=c||!(e.isRTL?t.pageX>=p.right-5:t.pageX<=p.left+5)){e.setCurrentTd(f,l.rect,e.isRTL?p.left:p.right,p.bottom),e.setCurrentInsertTd(0);break}var v=null;if(t.pageY>=p.top+(p.bottom-p.top)/2)v=f;else if(t.pageY>=p.top){var g;(g=null===(n=e.currentTable.rows[u-1])||void 0===n?void 0:n.cells[0])&&(v=g)}if(v){e.setCurrentTd(null),e.setCurrentInsertTd(1,v,l.rect);break}}}if(c<d.cells.length)break}}},this.insertTd=function(){e.editor.addUndoSnapshot((function(t,n){var i=new r.VTable(e.currentInsertTd);i.edit(1==e.insertingState?1:3),i.writeBack(),e.editor.select(t,n),e.setCurrentInsertTd(0)}),"Format")},this.startHorizontalResizeTable=function(t){e.resizingState=1,e.startResizeTable(t)},this.startVerticalResizeTable=function(t){e.resizingState=2;var n=new r.VTable(e.currentTd);if(n){var i=r.normalizeRect(e.currentTd.getBoundingClientRect());e.currentCellsToResize=n.getCellsWithBorder(e.isRTL?i.left:i.right,!e.isRTL),e.nextCellsToResize=n.getCellsWithBorder(e.isRTL?i.left:i.right,e.isRTL)}e.startResizeTable(t)},this.frameAnimateResizeTable=function(t){e.editor.runAsync((function(){return e.resizeTable(t)}))},this.getTdOffsetWidth=function(t){return 2*parseInt(e.currentTable.cellPadding)+parseInt(t.style.borderWidth.slice(0,-2))},this.resizeTable=function(t){if(e.currentTd&&0!==e.resizingState){var n=r.normalizeRect(e.currentTd.getBoundingClientRect());if(n){var i=1==e.resizingState?t.pageY:t.pageX,o=new r.VTable(e.currentTd);if(1==e.resizingState)o.table.style.height=null,o.forEachCellOfCurrentRow((function(t){t.td&&(t.td.style.height=t.td==e.currentTd?i-n.top+"px":null)}));else{var a=void 0,s=void 0;if(e.isRTL?(a=e.nextCellsToResize.length>0?parseInt(e.nextCellsToResize[0].getAttribute("originalLeftBorder")):0,s=parseInt(e.currentCellsToResize[0].getAttribute("originalRightBorder"))):(a=parseInt(e.currentCellsToResize[0].getAttribute("originalLeftBorder")),s=e.nextCellsToResize.length>0?parseInt(e.nextCellsToResize[0].getAttribute("originalRightBorder")):Number.MAX_SAFE_INTEGER),i<=a+20||i>=s-20)return;e.currentCellsToResize.forEach((function(t){var n=r.normalizeRect(t.getBoundingClientRect());t.style.wordBreak="break-word";var o=e.getTdOffsetWidth(t);t.style.width=e.isRTL?n.right-i-o+"px":i-n.left-o+"px"})),e.nextCellsToResize.forEach((function(t){t.style.wordBreak="break-word";var n=e.getTdOffsetWidth(t),r=e.isRTL?i-parseInt(t.getAttribute("originalLeftBorder")):parseInt(t.getAttribute("originalRightBorder"))-i;t.style.width=r-n+"px"}))}o.writeBack()}}},this.endResizeTable=function(t){var n=e.editor.getDocument();n.removeEventListener("mousemove",e.frameAnimateResizeTable,!0),n.removeEventListener("mouseup",e.endResizeTable,!0),e.currentCellsToResize=[],e.nextCellsToResize=[],e.editor.addUndoSnapshot((function(n,r){e.frameAnimateResizeTable(t),e.editor.select(n,r)}),"Format"),e.setCurrentTd(null),e.resizingState=0}}return e.prototype.getName=function(){return"TableResize"},e.prototype.initialize=function(e){this.editor=e,this.setupResizerContainer(),this.onMouseMoveDisposer=this.editor.addDomEventHandler("mousemove",this.onMouseMove)},e.prototype.dispose=function(){this.onMouseMoveDisposer(),this.destoryRectMap(),this.removeResizerContainer(),this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 3:case 7:case 14:this.destoryRectMap()}},e.prototype.setupResizerContainer=function(){this.resizerContainer=this.editor.getDocument().createElement("div"),this.editor.insertNode(this.resizerContainer,{updateCursor:!1,insertOnNewLine:!1,replaceSelection:!1,position:4})},e.prototype.removeResizerContainer=function(){this.resizerContainer.parentNode.removeChild(this.resizerContainer),this.resizerContainer=null},e.prototype.setCurrentInsertTd=function(e,t,n){t==this.currentInsertTd&&e==this.insertingState||(this.currentInsertTd&&(this.resizerContainer.removeChild(this.inserter),this.inserter=null),this.insertingState=e,this.currentInsertTd=t,this.currentInsertTd&&(this.inserter=this.createInserter(n),this.resizerContainer.appendChild(this.inserter)))},e.prototype.createInserter=function(e){if(0!=this.insertingState){var t=r.normalizeRect(this.currentInsertTd.getBoundingClientRect()),n=this.editor.getDefaultFormat().backgroundColor||"white",i=this.editor.isDarkMode()?"white":"#4A4A4A",o='<div style="position: fixed; width: 12px; height: 12px; font-size: 16px; color: '+i+"; line-height: 10px; vertical-align: middle; text-align: center; cursor: pointer; border: solid 1px "+i+"; border-radius: 50%; background-color: "+n+'"><div style="position: absolute; '+(this.isRTL?"right":"left")+": 12px; top: 5px; height: 3px; border-top: 1px solid "+i+"; border-bottom: 1px solid "+i+"; border-right: 1px solid "+i+"; border-left: 0px; box-sizing: border-box; background-color: "+n+';"></div>+</div>',a='<div style="position: fixed; width: 12px; height: 12px; font-size: 16px; color: '+i+"; line-height: 10px; vertical-align: middle; text-align: center; cursor: pointer; border: solid 1px "+i+"; border-radius: 50%; background-color: "+n+'"><div style="position: absolute; left: 5px; top: 12px; width: 3px; border-left: 1px solid '+i+"; border-right: 1px solid "+i+"; border-bottom: 1px solid "+i+"; border-top: 0px; box-sizing: border-box; background-color: "+n+';"></div>+</div>',s=r.fromHtml(1==this.insertingState?o:a,this.editor.getDocument())[0];return t&&(1==this.insertingState?(this.isRTL?s.style.left=t.right+"px":s.style.left=t.left-13+"px",s.style.top=t.bottom-8+"px",s.firstChild.style.width=e.right-e.left+"px"):(this.isRTL?s.style.left=t.left-8+"px":s.style.left=t.right-8+"px",s.style.top=t.top-13+"px",s.firstChild.style.height=e.bottom-e.top+"px")),s.addEventListener("click",this.insertTd),s}},e.prototype.setCurrentTable=function(e,t){this.currentTable!=e&&(this.setCurrentTd(null),this.setCurrentInsertTd(0),this.currentTable=e)},e.prototype.setCurrentTd=function(e,t,n,r){this.currentTd!=e&&(this.currentTd&&(this.resizerContainer.removeChild(this.horizontalResizer),this.resizerContainer.removeChild(this.verticalResizer),this.horizontalResizer=null,this.verticalResizer=null),this.currentTd=e,this.currentTd&&(this.horizontalResizer=this.createResizer(!0,t.left,r-4+1,t.right-t.left,4),this.verticalResizer=this.createResizer(!1,n-4+1,t.top,4,t.bottom-t.top),this.resizerContainer.appendChild(this.horizontalResizer),this.resizerContainer.appendChild(this.verticalResizer)))},e.prototype.createResizer=function(e,t,n,i,o){var a=r.fromHtml(e?'<div style="position: fixed; cursor: row-resize; user-select: none"></div>':'<div style="position: fixed; cursor: col-resize; user-select: none"></div>',this.editor.getDocument())[0];return a.style.top=n+"px",a.style.left=t+"px",a.style.width=i+"px",a.style.height=o+"px",a.addEventListener("mousedown",e?this.startHorizontalResizeTable:this.startVerticalResizeTable),a},e.prototype.startResizeTable=function(e){var t=this.editor.getDocument();t.addEventListener("mousemove",this.frameAnimateResizeTable,!0),t.addEventListener("mouseup",this.endResizeTable,!0)},e.prototype.destoryRectMap=function(){this.setCurrentTable(null),this.tableRectMap=null},e.prototype.cacheRects=function(){var e=this;this.destoryRectMap(),this.tableRectMap=[],this.editor.queryElements("table",(function(t){if(t.isContentEditable){var n=r.normalizeRect(t.getBoundingClientRect());n&&e.tableRectMap.push({table:t,rect:n})}})),this.isRTL="rtl"==r.getComputedStyle(this.editor.getDocument().body,"direction")},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(221))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(222);t.Watermark=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(6),o=function(){function e(e,t){var n=this;this.watermark=e,this.format=t,this.showHideWatermark=function(){var e=n.editor.hasFocus(),t=n.editor.queryElements(r.getEntitySelector("WATERMARK_WRAPPER")),o=t.length>0;e&&o?(t.forEach(n.removeWatermark),n.editor.focus()):e||o||!n.editor.isEmpty()||i.insertEntity(n.editor,"WATERMARK_WRAPPER",n.editor.getDocument().createTextNode(n.watermark),!1,!1,0)},this.removeWatermark=function(e){var t=e.parentNode;null==t||t.removeChild(e),n.editor.contains(t)&&"DIV"==r.getTagOfNode(t)&&!t.firstChild&&t.appendChild(n.editor.getDocument().createElement("BR"))},this.format=this.format||{fontSize:"14px",textColor:"#aaa"}}return e.prototype.getName=function(){return"Watermark"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler({focus:this.showHideWatermark,blur:this.showHideWatermark})},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;if(11==e.eventType||7==e.eventType&&"WATERMARK_WRAPPER"!=(null===(t=e.data)||void 0===t?void 0:t.type))this.showHideWatermark();else if(15==e.eventType&&"WATERMARK_WRAPPER"==e.entity.type){var n=e.operation,i=e.entity.wrapper;8==n?this.removeWatermark(i):0==e.operation&&(r.applyFormat(i,this.format,this.editor.isDarkMode()),i.spellcheck=!1)}},e}();t.default=o}]);
//# sourceMappingURL=rooster-min.js.map