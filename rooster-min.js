var roosterjs=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=125)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.matchesSelector=t.setColor=t.getInnerHTML=t.readFile=t.safeInstanceOf=t.normalizeRect=t.splitTextNode=t.getLastLeafNode=t.getFirstLeafNode=t.getPreviousLeafSibling=t.getNextLeafSibling=t.wrap=t.unwrap=t.splitBalancedNodeRange=t.splitParentNode=t.queryElements=t.matchLink=t.isVoidHtmlElement=t.isNodeEmpty=t.isBlockElement=t.getTagOfNode=t.PendableFormatCommandMap=t.getPendableFormatState=t.getComputedStyle=t.getComputedStyles=t.fromHtml=t.findClosestElementAncestor=t.contains=t.collapseNodes=t.changeElementTag=t.applyFormat=t.getBrowserInfo=t.Browser=t.extractClipboardItemsForIE=t.extractClipboardItems=t.extractClipboardEvent=t.applyTextStyle=t.PartialInlineElement=t.NodeInlineElement=t.LinkInlineElement=t.ImageInlineElement=t.getInlineElementAtNode=t.getDelimiterFromElement=t.addDelimiterBefore=t.addDelimiterAfter=t.addDelimiters=t.PositionContentSearcher=t.ContentTraverser=t.getFirstLastBlockElement=t.getBlockElementAtNode=void 0,t.cacheGetEventData=t.restoreContentWithEntityPlaceholder=t.moveContentWithEntityPlaceholders=t.createEntityPlaceholder=t.getEntitySelector=t.getEntityFromElement=t.commitEntity=t.chainSanitizerCallback=t.createDefaultHtmlSanitizerOptions=t.getInheritableStyles=t.HtmlSanitizer=t.canUndoAutoComplete=t.createSnapshots=t.moveCurrentSnapsnot=t.moveCurrentSnapshot=t.clearProceedingSnapshotsV2=t.clearProceedingSnapshots=t.canMoveCurrentSnapshot=t.addSnapshotV2=t.addSnapshot=t.addRangeToSelection=t.setHtmlWithMetadata=t.setHtmlWithSelectionPath=t.getHtmlWithSelectionPath=t.getSelectionPath=t.isPositionAtBeginningOf=t.getPositionRect=t.createRange=t.Position=t.mergeBlocksInRegion=t.getSelectionRangeInRegion=t.isNodeInRegion=t.collapseNodesInRegion=t.getSelectedBlockElementsInRegion=t.getRegionsFromRange=t.saveTableCellMetadata=t.getTableFormatInfo=t.setListItemStyle=t.VListChain=t.createVListFromRegion=t.VListItem=t.VList=t.isWholeTableSelected=t.VTable=t.parseColor=t.isNodeAfter=t.getIntersectedRect=t.moveChildNodes=t.KnownCreateElementData=t.createElement=void 0,t.toArray=t.getObjectKeys=t.arrayPush=t.removeMetadata=t.setMetadata=t.getMetadata=t.createObjectDefinition=t.createArrayDefinition=t.createStringDefinition=t.createBooleanDefinition=t.createNumberDefinition=t.validate=t.getTextContent=t.deleteSelectedContent=t.adjustInsertPosition=t.removeGlobalCssStyle=t.setGlobalCssStyles=t.removeImportantStyleRule=t.setStyles=t.getStyles=t.isCtrlOrMetaPressed=t.isCharacterValue=t.isModifierKey=t.clearEventDataCache=void 0;var r=n(7);Object.defineProperty(t,"getBlockElementAtNode",{enumerable:!0,get:function(){return r.default}});var i=n(66);Object.defineProperty(t,"getFirstLastBlockElement",{enumerable:!0,get:function(){return i.default}});var o=n(20);Object.defineProperty(t,"ContentTraverser",{enumerable:!0,get:function(){return o.default}});var a=n(71);Object.defineProperty(t,"PositionContentSearcher",{enumerable:!0,get:function(){return a.default}});var l=n(136);Object.defineProperty(t,"addDelimiters",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"addDelimiterAfter",{enumerable:!0,get:function(){return l.addDelimiterAfter}}),Object.defineProperty(t,"addDelimiterBefore",{enumerable:!0,get:function(){return l.addDelimiterBefore}});var s=n(72);Object.defineProperty(t,"getDelimiterFromElement",{enumerable:!0,get:function(){return s.default}});var u=n(21);Object.defineProperty(t,"getInlineElementAtNode",{enumerable:!0,get:function(){return u.default}});var d=n(67);Object.defineProperty(t,"ImageInlineElement",{enumerable:!0,get:function(){return d.default}});var c=n(47);Object.defineProperty(t,"LinkInlineElement",{enumerable:!0,get:function(){return c.default}});var f=n(35);Object.defineProperty(t,"NodeInlineElement",{enumerable:!0,get:function(){return f.default}});var h=n(37);Object.defineProperty(t,"PartialInlineElement",{enumerable:!0,get:function(){return h.default}});var p=n(45);Object.defineProperty(t,"applyTextStyle",{enumerable:!0,get:function(){return p.default}});var v=n(137);Object.defineProperty(t,"extractClipboardEvent",{enumerable:!0,get:function(){return v.default}});var g=n(73);Object.defineProperty(t,"extractClipboardItems",{enumerable:!0,get:function(){return g.default}});var m=n(74);Object.defineProperty(t,"extractClipboardItemsForIE",{enumerable:!0,get:function(){return m.default}});var y=n(19);Object.defineProperty(t,"Browser",{enumerable:!0,get:function(){return y.Browser}}),Object.defineProperty(t,"getBrowserInfo",{enumerable:!0,get:function(){return y.getBrowserInfo}});var b=n(138);Object.defineProperty(t,"applyFormat",{enumerable:!0,get:function(){return b.default}});var C=n(22);Object.defineProperty(t,"changeElementTag",{enumerable:!0,get:function(){return C.default}});var E=n(27);Object.defineProperty(t,"collapseNodes",{enumerable:!0,get:function(){return E.default}});var S=n(4);Object.defineProperty(t,"contains",{enumerable:!0,get:function(){return S.default}});var w=n(15);Object.defineProperty(t,"findClosestElementAncestor",{enumerable:!0,get:function(){return w.default}});var T=n(65);Object.defineProperty(t,"fromHtml",{enumerable:!0,get:function(){return T.default}});var P=n(46);Object.defineProperty(t,"getComputedStyles",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(t,"getComputedStyle",{enumerable:!0,get:function(){return P.getComputedStyle}});var O=n(139);Object.defineProperty(t,"getPendableFormatState",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(t,"PendableFormatCommandMap",{enumerable:!0,get:function(){return O.PendableFormatCommandMap}});var M=n(2);Object.defineProperty(t,"getTagOfNode",{enumerable:!0,get:function(){return M.default}});var _=n(28);Object.defineProperty(t,"isBlockElement",{enumerable:!0,get:function(){return _.default}});var D=n(38);Object.defineProperty(t,"isNodeEmpty",{enumerable:!0,get:function(){return D.default}});var N=n(44);Object.defineProperty(t,"isVoidHtmlElement",{enumerable:!0,get:function(){return N.default}});var x=n(140);Object.defineProperty(t,"matchLink",{enumerable:!0,get:function(){return x.default}});var k=n(24);Object.defineProperty(t,"queryElements",{enumerable:!0,get:function(){return k.default}});var I=n(17);Object.defineProperty(t,"splitParentNode",{enumerable:!0,get:function(){return I.default}}),Object.defineProperty(t,"splitBalancedNodeRange",{enumerable:!0,get:function(){return I.splitBalancedNodeRange}});var R=n(39);Object.defineProperty(t,"unwrap",{enumerable:!0,get:function(){return R.default}});var A=n(16);Object.defineProperty(t,"wrap",{enumerable:!0,get:function(){return A.default}});var L=n(10);Object.defineProperty(t,"getNextLeafSibling",{enumerable:!0,get:function(){return L.getNextLeafSibling}}),Object.defineProperty(t,"getPreviousLeafSibling",{enumerable:!0,get:function(){return L.getPreviousLeafSibling}});var j=n(69);Object.defineProperty(t,"getFirstLeafNode",{enumerable:!0,get:function(){return j.getFirstLeafNode}}),Object.defineProperty(t,"getLastLeafNode",{enumerable:!0,get:function(){return j.getLastLeafNode}});var B=n(36);Object.defineProperty(t,"splitTextNode",{enumerable:!0,get:function(){return B.default}});var F=n(40);Object.defineProperty(t,"normalizeRect",{enumerable:!0,get:function(){return F.default}});var H=n(1);Object.defineProperty(t,"safeInstanceOf",{enumerable:!0,get:function(){return H.default}});var z=n(49);Object.defineProperty(t,"readFile",{enumerable:!0,get:function(){return z.default}});var U=n(76);Object.defineProperty(t,"getInnerHTML",{enumerable:!0,get:function(){return U.default}});var V=n(50);Object.defineProperty(t,"setColor",{enumerable:!0,get:function(){return V.default}});var K=n(64);Object.defineProperty(t,"matchesSelector",{enumerable:!0,get:function(){return K.default}});var W=n(18);Object.defineProperty(t,"createElement",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(t,"KnownCreateElementData",{enumerable:!0,get:function(){return W.KnownCreateElementData}});var q=n(23);Object.defineProperty(t,"moveChildNodes",{enumerable:!0,get:function(){return q.default}});var G=n(141);Object.defineProperty(t,"getIntersectedRect",{enumerable:!0,get:function(){return G.default}});var Y=n(14);Object.defineProperty(t,"isNodeAfter",{enumerable:!0,get:function(){return Y.default}});var X=n(75);Object.defineProperty(t,"parseColor",{enumerable:!0,get:function(){return X.default}});var $=n(77);Object.defineProperty(t,"VTable",{enumerable:!0,get:function(){return $.default}});var Z=n(143);Object.defineProperty(t,"isWholeTableSelected",{enumerable:!0,get:function(){return Z.default}});var Q=n(53);Object.defineProperty(t,"VList",{enumerable:!0,get:function(){return Q.default}});var J=n(79);Object.defineProperty(t,"VListItem",{enumerable:!0,get:function(){return J.default}});var ee=n(148);Object.defineProperty(t,"createVListFromRegion",{enumerable:!0,get:function(){return ee.default}});var te=n(149);Object.defineProperty(t,"VListChain",{enumerable:!0,get:function(){return te.default}});var ne=n(80);Object.defineProperty(t,"setListItemStyle",{enumerable:!0,get:function(){return ne.default}});var re=n(78);Object.defineProperty(t,"getTableFormatInfo",{enumerable:!0,get:function(){return re.getTableFormatInfo}});var ie=n(51);Object.defineProperty(t,"saveTableCellMetadata",{enumerable:!0,get:function(){return ie.saveTableCellMetadata}});var oe=n(83);Object.defineProperty(t,"getRegionsFromRange",{enumerable:!0,get:function(){return oe.default}});var ae=n(82);Object.defineProperty(t,"getSelectedBlockElementsInRegion",{enumerable:!0,get:function(){return ae.default}});var le=n(84);Object.defineProperty(t,"collapseNodesInRegion",{enumerable:!0,get:function(){return le.default}});var se=n(33);Object.defineProperty(t,"isNodeInRegion",{enumerable:!0,get:function(){return se.default}});var ue=n(55);Object.defineProperty(t,"getSelectionRangeInRegion",{enumerable:!0,get:function(){return ue.default}});var de=n(85);Object.defineProperty(t,"mergeBlocksInRegion",{enumerable:!0,get:function(){return de.default}});var ce=n(5);Object.defineProperty(t,"Position",{enumerable:!0,get:function(){return ce.default}});var fe=n(11);Object.defineProperty(t,"createRange",{enumerable:!0,get:function(){return fe.default}});var he=n(150);Object.defineProperty(t,"getPositionRect",{enumerable:!0,get:function(){return he.default}});var pe=n(87);Object.defineProperty(t,"isPositionAtBeginningOf",{enumerable:!0,get:function(){return pe.default}});var ve=n(88);Object.defineProperty(t,"getSelectionPath",{enumerable:!0,get:function(){return ve.default}});var ge=n(151);Object.defineProperty(t,"getHtmlWithSelectionPath",{enumerable:!0,get:function(){return ge.default}});var me=n(152);Object.defineProperty(t,"setHtmlWithSelectionPath",{enumerable:!0,get:function(){return me.default}}),Object.defineProperty(t,"setHtmlWithMetadata",{enumerable:!0,get:function(){return me.setHtmlWithMetadata}});var ye=n(153);Object.defineProperty(t,"addRangeToSelection",{enumerable:!0,get:function(){return ye.default}});var be=n(154);Object.defineProperty(t,"addSnapshot",{enumerable:!0,get:function(){return be.default}}),Object.defineProperty(t,"addSnapshotV2",{enumerable:!0,get:function(){return be.addSnapshotV2}});var Ce=n(57);Object.defineProperty(t,"canMoveCurrentSnapshot",{enumerable:!0,get:function(){return Ce.default}});var Ee=n(89);Object.defineProperty(t,"clearProceedingSnapshots",{enumerable:!0,get:function(){return Ee.default}}),Object.defineProperty(t,"clearProceedingSnapshotsV2",{enumerable:!0,get:function(){return Ee.clearProceedingSnapshotsV2}});var Se=n(155);Object.defineProperty(t,"moveCurrentSnapshot",{enumerable:!0,get:function(){return Se.default}}),Object.defineProperty(t,"moveCurrentSnapsnot",{enumerable:!0,get:function(){return Se.moveCurrentSnapsnot}});var we=n(156);Object.defineProperty(t,"createSnapshots",{enumerable:!0,get:function(){return we.default}});var Te=n(157);Object.defineProperty(t,"canUndoAutoComplete",{enumerable:!0,get:function(){return Te.default}});var Pe=n(158);Object.defineProperty(t,"HtmlSanitizer",{enumerable:!0,get:function(){return Pe.default}});var Oe=n(90);Object.defineProperty(t,"getInheritableStyles",{enumerable:!0,get:function(){return Oe.default}});var Me=n(161);Object.defineProperty(t,"createDefaultHtmlSanitizerOptions",{enumerable:!0,get:function(){return Me.default}});var _e=n(162);Object.defineProperty(t,"chainSanitizerCallback",{enumerable:!0,get:function(){return _e.default}});var De=n(163);Object.defineProperty(t,"commitEntity",{enumerable:!0,get:function(){return De.default}});var Ne=n(92);Object.defineProperty(t,"getEntityFromElement",{enumerable:!0,get:function(){return Ne.default}});var xe=n(93);Object.defineProperty(t,"getEntitySelector",{enumerable:!0,get:function(){return xe.default}});var ke=n(164);Object.defineProperty(t,"createEntityPlaceholder",{enumerable:!0,get:function(){return ke.createEntityPlaceholder}}),Object.defineProperty(t,"moveContentWithEntityPlaceholders",{enumerable:!0,get:function(){return ke.moveContentWithEntityPlaceholders}}),Object.defineProperty(t,"restoreContentWithEntityPlaceholder",{enumerable:!0,get:function(){return ke.restoreContentWithEntityPlaceholder}});var Ie=n(165);Object.defineProperty(t,"cacheGetEventData",{enumerable:!0,get:function(){return Ie.default}});var Re=n(166);Object.defineProperty(t,"clearEventDataCache",{enumerable:!0,get:function(){return Re.default}});var Ae=n(94);Object.defineProperty(t,"isModifierKey",{enumerable:!0,get:function(){return Ae.default}});var Le=n(167);Object.defineProperty(t,"isCharacterValue",{enumerable:!0,get:function(){return Le.default}});var je=n(168);Object.defineProperty(t,"isCtrlOrMetaPressed",{enumerable:!0,get:function(){return je.default}});var Be=n(31);Object.defineProperty(t,"getStyles",{enumerable:!0,get:function(){return Be.default}});var Fe=n(32);Object.defineProperty(t,"setStyles",{enumerable:!0,get:function(){return Fe.default}});var He=n(169);Object.defineProperty(t,"removeImportantStyleRule",{enumerable:!0,get:function(){return He.default}});var ze=n(170);Object.defineProperty(t,"setGlobalCssStyles",{enumerable:!0,get:function(){return ze.default}});var Ue=n(171);Object.defineProperty(t,"removeGlobalCssStyle",{enumerable:!0,get:function(){return Ue.default}});var Ve=n(172);Object.defineProperty(t,"adjustInsertPosition",{enumerable:!0,get:function(){return Ve.default}});var Ke=n(175);Object.defineProperty(t,"deleteSelectedContent",{enumerable:!0,get:function(){return Ke.default}});var We=n(176);Object.defineProperty(t,"getTextContent",{enumerable:!0,get:function(){return We.default}});var qe=n(52);Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return qe.default}});var Ge=n(30);Object.defineProperty(t,"createNumberDefinition",{enumerable:!0,get:function(){return Ge.createNumberDefinition}}),Object.defineProperty(t,"createBooleanDefinition",{enumerable:!0,get:function(){return Ge.createBooleanDefinition}}),Object.defineProperty(t,"createStringDefinition",{enumerable:!0,get:function(){return Ge.createStringDefinition}}),Object.defineProperty(t,"createArrayDefinition",{enumerable:!0,get:function(){return Ge.createArrayDefinition}}),Object.defineProperty(t,"createObjectDefinition",{enumerable:!0,get:function(){return Ge.createObjectDefinition}});var Ye=n(25);Object.defineProperty(t,"getMetadata",{enumerable:!0,get:function(){return Ye.getMetadata}}),Object.defineProperty(t,"setMetadata",{enumerable:!0,get:function(){return Ye.setMetadata}}),Object.defineProperty(t,"removeMetadata",{enumerable:!0,get:function(){return Ye.removeMetadata}});var Xe=n(56);Object.defineProperty(t,"arrayPush",{enumerable:!0,get:function(){return Xe.default}});var $e=n(8);Object.defineProperty(t,"getObjectKeys",{enumerable:!0,get:function(){return $e.default}});var Ze=n(6);Object.defineProperty(t,"toArray",{enumerable:!0,get:function(){return Ze.default}})},function(e,t,n){"use strict";function r(e){var t=e&&(e.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(e)?e:null));return t&&(t.defaultView||window)}Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=void 0,t.getTargetWindow=r,t.default=function(e,t){var n;if("Range"==t)return"[object Range]"==Object.prototype.toString.apply(e)&&!!(null===(n=e)||void 0===n?void 0:n.commonAncestorContainer);var i=r(e),o=i&&i[t],a=window,l=a&&a[t];return l&&e instanceof l||o&&e instanceof o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){e.addUndoSnapshot(t,"Format",void 0,n&&""!=n?{formatApiName:n}:void 0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.default=function(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||((0,r.default)(t,"Range")&&(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType&&11!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&function(e,t){if(e.contains)return e.contains(t);for(;t;){if(t==e)return!0;t=t.parentNode}return!1}(e,t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15),i=n(14),o=function(){function e(e,t,n){switch(void 0===t&&(t=0),this.isFromEndOfRange=n,e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=a(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=a(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=l(this.node),this.isAtEnd=!0;break;default:var i=l(this.node);this.offset=Math.max(0,Math.min(t,i)),this.isAtEnd=t>0&&t>=i}this.element=(0,r.default)(this.node)}return e.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var t=this.node,n=this.isAtEnd?-1:this.offset;1==t.nodeType||11==t.nodeType;){var r=this.isFromEndOfRange?-1==n?t.lastChild:t.childNodes[n-1]:0==n?t.firstChild:-1==n?t.lastChild:t.childNodes[n];if(!r)break;t=r,n=this.isAtEnd||this.isFromEndOfRange?-1:0}return new e(t,n,this.isFromEndOfRange)},e.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},e.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:(0,i.default)(this.node,e.node)},e.prototype.move=function(t){return new e(this.node,Math.max(this.offset+t,0))},e.getStart=function(t){return new e(t.startContainer,t.startOffset)},e.getEnd=function(t){return t.collapsed?e.getStart(t):new e(t.endContainer,t.endOffset,!0)},e}();function a(e){for(var t=0;e=(null==e?void 0:e.previousSibling)||null;)t++;return t}function l(e){var t;return 3==e.nodeType?(null===(t=e.nodeValue)||void 0===t?void 0:t.length)||0:1==e.nodeType||11==e.nodeType?e.childNodes.length:1}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return[].slice.call(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(27),i=n(4),o=n(2),a=n(28),l=n(63),s=n(132);function u(e,t,n){var r=e;if("BR"==(0,o.default)(r)&&n)return r;for(;r;){for(var i=e;e.parentNode&&!(i=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return r;for(;i;){if((0,a.default)(i))return r;if("BR"==(0,o.default)(i))return n?i:r;e=i,i=n?e.firstChild:e.lastChild}r=e}return r}t.default=function(e,t){if(!(0,i.default)(e,t))return null;var n=s.default.getBlockContext(t);if(!n)return null;if(n==t)return new l.default(n);var o=u(t,n,!1),d=u(t,n,!0),c=(0,r.default)(e,o,d,!1);if(o=c[0],d=c[c.length-1],o.parentNode!=d.parentNode)return new s.default(e,o,d);for(;!o.previousSibling&&!d.nextSibling;){var f=o.parentNode;if(f==n){n!=e&&(o=d=f);break}if(!f||f==e)break;o=d=f}return o==d&&(0,a.default)(o)?new l.default(o):new s.default(e,o,d)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Object.keys(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.experimentCommitListChains=t.commitListChains=t.blockFormat=t.toggleListType=t.applyCellShading=t.toggleHeader=t.toggleUnderline=t.toggleSuperscript=t.toggleSubscript=t.toggleStrikethrough=t.toggleCodeBlock=t.toggleBlockQuote=t.setOrderedListNumbering=t.toggleNumbering=t.toggleItalic=t.toggleBullet=t.toggleBold=t.changeCapitalization=t.setIndentation=t.setImageAltText=t.setFontSize=t.setFontName=t.setDirection=t.setTextColor=t.setBackgroundColor=t.setAlignment=t.rotateElement=t.replaceWithNode=t.removeLink=t.formatTable=t.editTable=t.insertTable=t.insertImage=t.insertEntity=t.getElementBasedFormatState=t.getFormatState=t.createLink=t.clearFormat=t.clearBlockFormat=t.FONT_SIZES=t.changeFontSize=void 0;var r=n(220);Object.defineProperty(t,"changeFontSize",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"FONT_SIZES",{enumerable:!0,get:function(){return r.FONT_SIZES}});var i=n(221);Object.defineProperty(t,"clearBlockFormat",{enumerable:!0,get:function(){return i.default}});var o=n(102);Object.defineProperty(t,"clearFormat",{enumerable:!0,get:function(){return o.default}});var a=n(222);Object.defineProperty(t,"createLink",{enumerable:!0,get:function(){return a.default}});var l=n(223);Object.defineProperty(t,"getFormatState",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"getElementBasedFormatState",{enumerable:!0,get:function(){return l.getElementBasedFormatState}});var s=n(224);Object.defineProperty(t,"insertEntity",{enumerable:!0,get:function(){return s.default}});var u=n(225);Object.defineProperty(t,"insertImage",{enumerable:!0,get:function(){return u.default}});var d=n(226);Object.defineProperty(t,"insertTable",{enumerable:!0,get:function(){return d.default}});var c=n(227);Object.defineProperty(t,"editTable",{enumerable:!0,get:function(){return c.default}});var f=n(228);Object.defineProperty(t,"formatTable",{enumerable:!0,get:function(){return f.default}});var h=n(229);Object.defineProperty(t,"removeLink",{enumerable:!0,get:function(){return h.default}});var p=n(230);Object.defineProperty(t,"replaceWithNode",{enumerable:!0,get:function(){return p.default}});var v=n(231);Object.defineProperty(t,"rotateElement",{enumerable:!0,get:function(){return v.default}});var g=n(232);Object.defineProperty(t,"setAlignment",{enumerable:!0,get:function(){return g.default}});var m=n(59);Object.defineProperty(t,"setBackgroundColor",{enumerable:!0,get:function(){return m.default}});var y=n(105);Object.defineProperty(t,"setTextColor",{enumerable:!0,get:function(){return y.default}});var b=n(233);Object.defineProperty(t,"setDirection",{enumerable:!0,get:function(){return b.default}});var C=n(103);Object.defineProperty(t,"setFontName",{enumerable:!0,get:function(){return C.default}});var E=n(104);Object.defineProperty(t,"setFontSize",{enumerable:!0,get:function(){return E.default}});var S=n(235);Object.defineProperty(t,"setImageAltText",{enumerable:!0,get:function(){return S.default}});var w=n(236);Object.defineProperty(t,"setIndentation",{enumerable:!0,get:function(){return w.default}});var T=n(237);Object.defineProperty(t,"changeCapitalization",{enumerable:!0,get:function(){return T.default}});var P=n(106);Object.defineProperty(t,"toggleBold",{enumerable:!0,get:function(){return P.default}});var O=n(238);Object.defineProperty(t,"toggleBullet",{enumerable:!0,get:function(){return O.default}});var M=n(107);Object.defineProperty(t,"toggleItalic",{enumerable:!0,get:function(){return M.default}});var _=n(239);Object.defineProperty(t,"toggleNumbering",{enumerable:!0,get:function(){return _.default}});var D=n(240);Object.defineProperty(t,"setOrderedListNumbering",{enumerable:!0,get:function(){return D.default}});var N=n(241);Object.defineProperty(t,"toggleBlockQuote",{enumerable:!0,get:function(){return N.default}});var x=n(242);Object.defineProperty(t,"toggleCodeBlock",{enumerable:!0,get:function(){return x.default}});var k=n(243);Object.defineProperty(t,"toggleStrikethrough",{enumerable:!0,get:function(){return k.default}});var I=n(244);Object.defineProperty(t,"toggleSubscript",{enumerable:!0,get:function(){return I.default}});var R=n(245);Object.defineProperty(t,"toggleSuperscript",{enumerable:!0,get:function(){return R.default}});var A=n(108);Object.defineProperty(t,"toggleUnderline",{enumerable:!0,get:function(){return A.default}});var L=n(246);Object.defineProperty(t,"toggleHeader",{enumerable:!0,get:function(){return L.default}});var j=n(247);Object.defineProperty(t,"applyCellShading",{enumerable:!0,get:function(){return j.default}});var B=n(60);Object.defineProperty(t,"toggleListType",{enumerable:!0,get:function(){return B.default}});var F=n(26);Object.defineProperty(t,"blockFormat",{enumerable:!0,get:function(){return F.default}});var H=n(58);Object.defineProperty(t,"commitListChains",{enumerable:!0,get:function(){return H.default}}),Object.defineProperty(t,"experimentCommitListChains",{enumerable:!0,get:function(){return H.experimentCommitListChains}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPreviousLeafSibling=t.getNextLeafSibling=t.getLeafSibling=void 0;var r=n(4),i=n(2),o=n(29);function a(e,t,n,a,l){var s=null,u=n?function(e){return(null==e?void 0:e.nextSibling)||null}:function(e){return(null==e?void 0:e.previousSibling)||null},d=n?function(e){return e.firstChild}:function(e){return e.lastChild};if((0,r.default)(e,t))for(var c=t,f=!0;f;){var h=(null==c?void 0:c.parentNode)||null;for(c=u(c);!c&&h!=e;)c=u(h),h=(null==h?void 0:h.parentNode)||null;for(;c&&(!a||a.indexOf((0,i.default)(c))<0)&&d(c);)c=d(c);if(!(f=!!c&&(0,o.default)(c,l))){s=c;break}}return s}t.getLeafSibling=a,t.getNextLeafSibling=function(e,t,n){return a(e,t,!0,n)},t.getPreviousLeafSibling=function(e,t,n){return a(e,t,!1,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),i=n(5),o=n(1);function a(e){return 1==e.node.nodeType&&(0,r.default)(e.node)?new i.default(e.node,e.isAtEnd?-3:-2):e}function l(e){return e&&e.node}function s(e,t){if(!e||!t)return null;for(var n=0,r=0;r<t.length&&(n=t[r],r<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);r++)e=e.childNodes[n];return new i.default(e,n)}t.default=function(e,t,n,r){var u,d=null,c=null;if(l(e)?(d=e,c=l(t)?t:null):(0,o.default)(e,"Node")&&(Array.isArray(t)?(d=s(e,t),c=Array.isArray(n)?s(e,n):null):"number"==typeof t?(d=new i.default(e,t),c=(0,o.default)(n,"Node")?new i.default(n,r):null):!(0,o.default)(t,"Node")&&t||(d=new i.default(e,-2),c=new i.default(t||e,-3))),null===(u=null==d?void 0:d.node)||void 0===u?void 0:u.ownerDocument){var f=d.node.ownerDocument.createRange();return d=a(d),c=a(c||d),f.setStart(d.node,d.offset),f.setEnd(c.node,c.offset),f}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(0);t.default=function(e,t,n){e.focus();var o=function(){return e.getDocument().execCommand(t,!1,void 0)},a=e.getSelectionRangeEx();if(a&&a.areAllCollapsed){e.addUndoSnapshot();var l=e.getPendableFormatState(!1);o();var s=(0,i.getObjectKeys)(i.PendableFormatCommandMap).filter((function(e){return i.PendableFormatCommandMap[e]==t}))[0];s&&(l[s]=!l[s],e.triggerPluginEvent(13,{formatState:l}))}else(0,r.default)(e,(function(){var t=0!=a.type;a.ranges.forEach((function(n){t&&e.select(n),o()})),t&&e.select(a)}),n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EXCEL_DESKTOP_ATTRIBUTE_NAME=t.WAC_IDENTIFY_SELECTOR=t.PROG_ID_NAME=t.GOOGLE_SHEET_NODE_NAME=void 0,t.GOOGLE_SHEET_NODE_NAME="google-sheets-html-origin",t.PROG_ID_NAME="ProgId",t.WAC_IDENTIFY_SELECTOR='ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer',t.EXCEL_DESKTOP_ATTRIBUTE_NAME="xmlns:x"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(64);t.default=function(e,t,n){var o=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(o&&n)if(o.closest)o=o.closest(n);else for(;o&&o!=t&&!(0,i.default)(o,n);)o=o.parentElement;return!t||(0,r.default)(t,o)?o:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),i=n(65),o=n(1);t.default=function(e,t){if(0==(e=e?(0,o.default)(e,"Node")?[e]:e:[]).length||!e[0]||!e[0].ownerDocument)return null;if(t||(t="div"),!(0,o.default)(t,"HTMLElement")){var n=e[0].ownerDocument;t="string"==typeof t?/^\w+$/.test(t)?n.createElement(t):(0,i.default)(t,n)[0]:(0,r.default)(t,n)}var a=e[0].parentNode;a&&a.insertBefore(t,e[0]);for(var l=0,s=e;l<s.length;l++){var u=s[l];t.appendChild(u)}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitBalancedNodeRange=void 0;var r=n(14);function i(e,t){var n;if(!e||!e.parentNode)return null;var r=e.parentNode,i=r.cloneNode(!1);if(i.removeAttribute("id"),t)for(;r.firstChild&&r.firstChild!=e;)i.appendChild(r.firstChild);else for(;e.nextSibling;)i.appendChild(e.nextSibling);return i.firstChild&&""!=i.innerHTML?null===(n=r.parentNode)||void 0===n||n.insertBefore(i,t?r:r.nextSibling):i=null,i}t.default=i,t.splitBalancedNodeRange=function(e){var t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[e.length-1]:e,o=t&&n&&t.parentNode==n.parentNode?t.parentNode:null;if(o){if((0,r.default)(t,n)){var a=n;n=t,t=a}i(t,!0),i(n,!1)}return o}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.KnownCreateElementData=void 0;var i=n(8),o=n(1),a=n(19);t.KnownCreateElementData=((r={})[0]={tag:""},r[1]=a.Browser.isEdge?{tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]}:{tag:"div",children:[{tag:"br"}]},r[2]={tag:"blockquote",style:"margin-top:0;margin-bottom:0"},r[3]={tag:"div",style:"width: 1px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text",attributes:{contenteditable:"true"}},r[4]={tag:"li",style:"display:block"},r[5]={tag:"div",style:"position: fixed; width: 0; height: 0"},r[6]={tag:"span",style:"max-width:100%;vertical-align:bottom",children:[{tag:"div",style:"width:100%;height:100%;position:relative;overflow:hidden"}]},r[7]={tag:"div",style:"position: fixed; cursor: row-resize; user-select: none"},r[8]={tag:"div",style:"position: fixed; cursor: col-resize; user-select: none"},r[9]={tag:"div",style:"position: fixed; cursor: nw-resize; user-select: none; border: 1px solid #808080"},r[10]={tag:"div",style:"position: fixed; cursor: ne-resize; user-select: none; border: 1px solid #808080"},r[11]={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"},r[12]={tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]},r),t.default=function e(n,r){if("number"==typeof n&&(n=t.KnownCreateElementData[n]),!n||!n.tag)return null;var a=n.tag,l=n.namespace,s=n.className,u=n.style,d=n.dataset,c=n.attributes,f=n.children,h=l?r.createElementNS(l,a):r.createElement(a);return u&&h.setAttribute("style",u),s&&(h.className=s),d&&(0,o.default)(h,"HTMLElement")&&(0,i.default)(d).forEach((function(e){h.dataset[e]=d[e]})),c&&(0,i.default)(c).forEach((function(e){h.setAttribute(e,c[e])})),f&&f.forEach((function(t){if("string"==typeof t)h.appendChild(r.createTextNode(t));else if(t){var n=e(t,r);n&&h.appendChild(n)}})),h}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Browser=t.getBrowserInfo=void 0;var r=/android/i;function i(e,t,n){var i,o=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),a=-1!=e.indexOf("MSIE")||o,l=!1,s=!1,u=!1,d=!1,c=-1!=e.indexOf("WebKit"),f=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(i=e||n||"")||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4)))&&(f=!0),a||(l=-1!=e.indexOf("Chrome"),s=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(u=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(d=-1!=e.indexOf("Edge"))&&(c=l=s=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:c,isIE:a,isIE11OrGreater:o,isSafari:u,isChrome:l,isFirefox:s,isEdge:d,isIEOrEdge:a||d,isAndroid:r.test(e),isMobileOrTablet:f}}t.getBrowserInfo=i,t.Browser="undefined"!=typeof window&&window?i(window.navigator.userAgent,window.navigator.appVersion,window.navigator.vendor):{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(133),i=n(70),o=n(7),a=n(21),l=n(37),s=n(134),u=n(135),d=n(48),c=n(10),f=function(){function e(e,t){this.scoper=e,this.skipTags=t,this.currentInline=null,this.currentBlock=null}return e.createBodyTraverser=function(t,n,i){return new e(new r.default(t,n))},e.createSelectionTraverser=function(t,n,r){return new e(new u.default(t,n),r)},e.createBlockTraverser=function(t,n,r,i){return void 0===r&&(r=3),new e(new s.default(t,n,r))},Object.defineProperty(e.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!1,configurable:!0}),e.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},e.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},e.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement;if(!t)return null;var n=(0,c.getLeafSibling)(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e,this.skipTags),r=n?(0,o.default)(this.scoper.rootNode,n):null;return r&&this.scoper.isBlockInScope(r)&&(e&&r.isAfter(t)||!e&&t.isAfter(r))?(this.currentBlock=r,this.currentBlock):null},Object.defineProperty(e.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof i.default?null:this.currentInline},enumerable:!1,configurable:!0}),e.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},e.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},e.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n?(n instanceof i.default?(t=(0,d.getInlineElementBeforeAfter)(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):t=(t=function(e,t,n){if(!t)return null;if(t instanceof l.default){var r=n?t.nextInlineElement:t.previousInlineElement;if(r)return r}var i=t.getContainerNode();return i=(0,c.getLeafSibling)(e,i,n),(0,a.default)(e,i)}(this.scoper.rootNode,n,e))&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null,t&&(t=this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null):null},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=n(2),o=n(67),a=n(47),l=n(35),s=n(1);t.default=function(e,t){var n=(0,s.default)(e,"Node")?(0,r.default)(e,t):e;return t&&n&&function(e,t){for(var n,r=[e],s=e.parentNode;s&&t.contains(s);s=s.parentNode)r.push(s);for(var u=r.length-1;u>=0&&!n;u--){var d=r[u],c=(0,i.default)(d);"A"==c?n=new a.default(d,t):"IMG"==c&&(n=new o.default(d,t))}return n||new l.default(e,t)}(t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),i=n(2),o=n(23);t.default=function(e,t){var n;if(!e||!t)return null;var a=(0,i.default)(e);if(a==t.toUpperCase())return e;for(var l=e.ownerDocument.createElement(t),s=0;s<e.attributes.length;s++){var u=e.attributes[s];l.setAttribute(u.name,u.value)}return(0,o.default)(l,e),"P"!=a&&"P"!=(0,i.default)(l)||(n=(0,r.default)(e,["margin-top","margin-bottom"]),l.style.marginTop=n[0],l.style.marginBottom=n[1]),e.parentNode&&e.parentNode.replaceChild(l,e),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e){for(;!n&&e.firstChild;)e.removeChild(e.firstChild);for(;null==t?void 0:t.firstChild;)e.appendChild(t.firstChild)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);function i(e,t){return t.some((function(t){return 0==t?0==e:(e&t)==t}))}t.default=function(e,t,n,o,a){if(void 0===o&&(o=0),!e||!t)return[];var l=(0,r.default)(e.querySelectorAll(t));if(0!=o&&a){var s=a.startContainer,u=a.startOffset,d=a.endContainer,c=a.endOffset;if(1==s.nodeType&&s.firstChild){var f=s.childNodes[u];s=f||s.lastChild}d=1==d.nodeType&&d.firstChild&&c>0?d.childNodes[c-1]:d,l=l.filter((function(e){return function(e,t,n,r){var o=e.compareDocumentPosition(t),a=e.compareDocumentPosition(n),l=[0,8];r||l.push(16);return i(o,l)||i(a,l)||i(o,[2])&&i(a,[4])&&!i(a,[16])}(e,s,d,2==o)}))}return n&&l.forEach(n),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeMetadata=t.setMetadata=t.getMetadata=void 0;var r=n(52);t.getMetadata=function(e,t,n){var i,o=e.dataset.editingInfo;try{i=o?JSON.parse(o):null}catch(e){}if(void 0!==i){if(!t)return i;if((0,r.default)(i,t))return i}return n||null},t.setMetadata=function(e,t,n){return!(n&&!(0,r.default)(t,n))&&(e.dataset.editingInfo=JSON.stringify(t),!0)},t.removeMetadata=function(e){delete e.dataset.editingInfo}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(58),i=n(3),o=n(0);t.default=function(e,t,n,a){e.focus();var l=e.getSelectionRangeEx();(0,i.default)(e,(function(i,a){if(!n||n()){var s=e.getSelectedRegions();if(s.length>0){var u=o.VListChain.createListChains(s,null==i?void 0:i.node);s.forEach((function(e){return t(e,i,a,u)})),(0,r.default)(e,u)}}0==l.type&&i&&a?e.select(i,a):e.select(l)}),a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collapse=void 0;var r=n(4),i=n(17),o=n(6);function a(e,t,n,o,a){for(;t.parentNode!=e&&!(0,r.default)(t.parentNode,n);){if(o&&t.previousSibling||!o&&t.nextSibling){if(!a)break;(0,i.default)(t,o)}if(!t.parentNode)break;t=t.parentNode}return t}t.default=function(e,t,n,i){var l;if(!(0,r.default)(e,t)||!(0,r.default)(e,n))return[];if(t=a(e,t,n,!0,i),n=a(e,n,t,!1,i),(0,r.default)(t,n,!0))return[t];if((0,r.default)(n,t))return[n];if(t.parentNode==n.parentNode){var s=t.parentNode?(0,o.default)(null===(l=t.parentNode)||void 0===l?void 0:l.childNodes):[],u=s.indexOf(t),d=s.indexOf(n);return s.slice(u,d+1)}return[t,n]},t.collapse=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),o=["block","list-item","table-cell"];t.default=function(e){var t=(0,r.default)(e);return!(!t||!(o.indexOf(e.style.display)>=0||i.indexOf(t)>=0))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(46),o=/^[\r\n]+$/g,a=/[\t\r\n\u0020\u200B]/gm;t.default=function e(t,n){if(3==t.nodeType)return!(t.nodeValue&&""!=t.textContent&&!o.test(t.nodeValue))||!(!n||""!=t.nodeValue.replace(a,""));if(1==t.nodeType){if("none"==(0,i.getComputedStyle)(t,"display"))return!0;var l=(0,r.default)(t);if("DIV"==l||"SPAN"==l){for(var s=t.firstChild;s;s=s.nextSibling)if(!e(s,n))return!1;return!0}return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createObjectDefinition=t.createArrayDefinition=t.createStringDefinition=t.createBooleanDefinition=t.createNumberDefinition=void 0,t.createNumberDefinition=function(e,t,n,r,i){return{type:1,isOptional:e,value:t,maxValue:r,minValue:n,allowNull:i}},t.createBooleanDefinition=function(e,t,n){return{type:0,isOptional:e,value:t,allowNull:n}},t.createStringDefinition=function(e,t,n){return{type:2,isOptional:e,value:t,allowNull:n}},t.createArrayDefinition=function(e,t,n,r,i){return{type:3,isOptional:t,itemDef:e,minLength:n,maxLength:r,allowNull:i}},t.createObjectDefinition=function(e,t,n){return{type:4,isOptional:t,propertyDef:e,allowNull:n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach((function(e){var n=e.indexOf(":"),r=e.slice(0,n),i=e.slice(n+1);r&&i&&(t[r.trim()]=i.trim())})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);t.default=function(e,t){if(e){var n=(0,r.default)(t||{}).map((function(e){var n=t[e],r=e?e.trim():null,i=n?n.trim():null;return r&&i?r+":"+i:null})).filter((function(e){return e})).join(";");n?e.setAttribute("style",n):e.removeAttribute("style")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);t.default=function(e,t){return!(!e||!(0,r.default)(e.rootNode,t)||e.nodeBefore&&4!=e.nodeBefore.compareDocumentPosition(t)||e.nodeAfter&&2!=e.nodeAfter.compareDocumentPosition(t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEditInfoFromImage=t.deleteEditInfo=t.saveEditInfo=void 0;var r=n(113),i=n(0);t.saveEditInfo=function(e,t){e&&(0,i.setMetadata)(e,t)},t.deleteEditInfo=function(e){e&&(0,i.removeMetadata)(e)},t.getEditInfoFromImage=function(e){var t=(0,i.getMetadata)(e);return t&&0!=(0,r.default)(t)?t:function(e){return{src:e.getAttribute("src")||"",widthPx:e.clientWidth,heightPx:e.clientHeight,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,leftPercent:0,rightPercent:0,topPercent:0,bottomPercent:0,angleRad:0}}(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),i=n(14),o=n(5),a=function(){function e(e,t){this.containerNode=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return(3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent)||""},e.prototype.getContainerNode=function(){return this.containerNode},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return new o.default(this.containerNode,0).normalize()},e.prototype.getEndPosition=function(){return new o.default(this.containerNode,-1).normalize()},e.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},e.prototype.isAfter=function(e){return e&&(0,i.default)(this.containerNode,e.getContainerNode())},e.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},e.prototype.applyStyle=function(e){(0,r.default)(this.containerNode,e)},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r,i,o,a=(null===(r=e.nodeValue)||void 0===r?void 0:r.substring(0,t))||"",l=(null===(i=e.nodeValue)||void 0===i?void 0:i.substring(t))||"",s=e.ownerDocument.createTextNode(n?a:l);return e.nodeValue=n?l:a,null===(o=e.parentNode)||void 0===o||o.insertBefore(s,n?e:e.nextSibling),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),i=n(11),o=n(5),a=n(10),l=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.inlineElement=e,this.start=t,this.end=n}return e.prototype.getDecoratedInline=function(){return this.inlineElement},e.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},e.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},e.prototype.getTextContent=function(){return(0,i.default)(this.getStartPosition(),this.getEndPosition()).toString()},e.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},e.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(e.prototype,"nextInlineElement",{get:function(){return this.end?new e(this.inlineElement,this.end):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousInlineElement",{get:function(){return this.start?new e(this.inlineElement,void 0,this.start):null},enumerable:!1,configurable:!0}),e.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},e.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},e.prototype.isAfter=function(e){var t=this.getStartPosition(),n=e&&e.getEndPosition();return n&&(t.isAfter(n)||t.equalTo(n))},e.prototype.applyStyle=function(e){var t=this.getStartPosition().normalize(),n=this.getEndPosition().normalize(),i=this.getContainerNode();if(t.isAtEnd){var l=(0,a.getNextLeafSibling)(i,t.node);t=l?new o.default(l,0):null}if(0==n.offset){var s=(0,a.getPreviousLeafSibling)(i,n.node);n=s?new o.default(s,-1):null}(0,r.default)(i,e,t||void 0,n||void 0)},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=["IMG"],o=["TABLE","IMG","LI"].join(","),a=/\u200b/g;function l(e,t){return e=e.replace(a,""),t?e.trim():e}t.default=function(e,t,n){if(!e)return!1;if(3==e.nodeType)return""==l(e.nodeValue||"",t);if(1==e.nodeType){var a=e,s=l(a.textContent||"",t),u=n?o+",BR":o;if(""!=s||i.indexOf((0,r.default)(a))>=0||a.querySelectorAll(u)[0])return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e||{left:0,right:0,top:0,bottom:0},n=t.left,r=t.right,i=t.top,o=t.bottom;return 0===n&&0===r&&0===i&&0===o?null:{left:Math.round(n),right:Math.round(r),top:Math.round(i),bottom:Math.round(o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(0);t.default=function(e,t,n){e.focus();var o=e.getSelectionRangeEx(),a=function(e,n){return e.isContentEditable&&t(e,n)};if(o&&o.areAllCollapsed){var l=o.ranges[0].startContainer;"SPAN"==(0,i.getTagOfNode)(l)&&(!l.firstChild||"BR"==(0,i.getTagOfNode)(l.firstChild)&&!l.firstChild.nextSibling)?(e.addUndoSnapshot(),a(l)):(e.triggerPluginEvent(13,{formatState:{},formatCallback:t}),e.triggerContentChangedEvent("Format"))}else(0,r.default)(e,(function(){var t,n;o.ranges.forEach((function(r){var i=e.getSelectionTraverser(r);if(i)for(var o=i&&i.currentInlineElement;o;){var l=i.getNextInlineElement();o.applyStyle((function(e,r){a(e,r),t=t||e,n=e})),o=l}})),t&&n&&0==o.type&&e.select(t,-2,n,-3)}),n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41),i=n(0);t.default=function(e,t,n,o){var a=[];(0,r.default)(e,(function(t,r){n(t,r);var i=e.getElementAtCursor("LI",t);i&&-1===a.indexOf(i)&&a.push(i)}),o),function(e,t){e.forEach((function(e){(0,i.safeInstanceOf)(e,"HTMLLIElement")&&(0,i.setListItemStyle)(e,t)}))}(a,[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i={MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEUP:"mouseup",getPageXY:a},o={MOUSEDOWN:"touchstart",MOUSEMOVE:"touchmove",MOUSEUP:"touchend",getPageXY:l};function a(e){return[e.pageX,e.pageY]}function l(e){var t=0,n=0;if(e.targetTouches&&e.targetTouches.length>0){var r=e.targetTouches[0];t=r.pageX,n=r.pageY}return[t,n]}var s=function(){function e(e,t,n,a,l,s){var u=this;this.trigger=e,this.context=t,this.onSubmit=n,this.handler=a,this.zoomScale=l,this.initX=0,this.initY=0,this.initValue=void 0,this.onMouseDown=function(e){var t,n,r;e.preventDefault(),e.stopPropagation(),u.addDocumentEvents(),t=u.dndMouse.getPageXY(e),u.initX=t[0],u.initY=t[1],u.initValue=null===(r=(n=u.handler).onDragStart)||void 0===r?void 0:r.call(n,u.context,e)},this.onMouseMove=function(e){var t,n,r;e.preventDefault();var i=u.dndMouse.getPageXY(e),o=i[0],a=i[1],l=(o-u.initX)/u.zoomScale,s=(a-u.initY)/u.zoomScale;u.initValue&&(null===(n=(t=u.handler).onDragging)||void 0===n?void 0:n.call(t,u.context,e,u.initValue,l,s))&&(null===(r=u.onSubmit)||void 0===r||r.call(u,u.context,u.trigger))},this.onMouseUp=function(e){var t,n,r;e.preventDefault(),u.removeDocumentEvents(),(null===(n=(t=u.handler).onDragEnd)||void 0===n?void 0:n.call(t,u.context,e,u.initValue))&&(null===(r=u.onSubmit)||void 0===r||r.call(u,u.context,u.trigger))},this.dndMouse=s||r.Browser.isMobileOrTablet?o:i,e.addEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown)}return e.prototype.dispose=function(){this.trigger.removeEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown),this.removeDocumentEvents()},Object.defineProperty(e.prototype,"mouseType",{get:function(){return this.dndMouse==o?"touch":"mouse"},enumerable:!1,configurable:!0}),e.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.addEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},e.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.removeEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(",");t.default=function(e){return!!e&&i.indexOf((0,r.default)(e))>=0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(5),o=n(36),a=n(16),l=n(10),s=n(17),u=n(1),d="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL,SUP,SUB".split(",");function c(e,t){e&&1==e.nodeType&&t(e,!0)}t.default=function(e,t,n,f){void 0===n&&(n=new i.default(e,0).normalize()),void 0===f&&(f=new i.default(e,-1).normalize());for(var h=[],p=n,v=f;p&&v&&v.isAfter(p);){var g=p.node,m=(0,r.default)(g.parentNode),y=(0,l.getNextLeafSibling)(e,g);3==g.nodeType&&["TR","TABLE"].indexOf(m)<0&&(g!=v.node||v.isAtEnd||(g=(0,o.default)(g,v.offset,!0)),p.offset>0&&(g=(0,o.default)(g,p.offset,!1)),h.push(g)),p=y&&new i.default(y,0)}if(h.length>0){if(h.every((function(e){return e.parentNode==h[0].parentNode}))){var b=h.shift();h.forEach((function(e){var t,n=(b.nodeValue||"")+(e.nodeValue||"");b.nodeValue=n,null===(t=e.parentNode)||void 0===t||t.removeChild(e)})),h=[b]}h.forEach((function(e){for(var n=e;n&&"SPAN"!=(0,r.default)(n)&&d.indexOf((0,r.default)(n.parentNode))>=0;)c(n,t),n=(0,s.splitBalancedNodeRange)(n);n&&"SPAN"!=(0,r.default)(n)&&(c(n,t),n=(0,a.default)(n,"SPAN")),(0,u.default)(n,"HTMLElement")&&t(n)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getComputedStyle=void 0;var r=n(15);function i(e,t){void 0===t&&(t=["font-family","font-size","color","background-color"]);var n=(0,r.default)(e),i=[];if(t=Array.isArray(t)?t:[t],n){var a=(n.ownerDocument.defaultView||window).getComputedStyle(n);if(a)for(var l=0,s=t;l<s.length;l++){var u=s[l],d=a.getPropertyValue(u)||"";d="font-family"!=u?d.toLowerCase():d,d="font-size"==u?o(d):d,i.push(d)}}return i}function o(e){return e&&e.indexOf("px")==e.length-2?Math.round(75*parseFloat(e)+.05)/100+"pt":e}t.default=i,t.getComputedStyle=function(e,t){return i(e,t)[0]||""}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){return e.call(this,t,n)||this}return i(t,e),t}(n(35).default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInlineElementBeforeAfter=t.getInlineElementAfter=t.getInlineElementBefore=void 0;var r=n(21),i=n(37),o=n(29),a=n(10);function l(e,t,n){if(!e||!t||!t.node)return null;var l=(t=t.normalize()).offset,s=t.isAtEnd,u=t.node,d=!1;!n&&0==l&&!s||n&&s?u=(0,a.getLeafSibling)(e,u,n):3==u.nodeType&&(!n&&!s||n&&l>0)&&(d=!0),u&&(0,o.default)(u)&&(u=(0,a.getLeafSibling)(e,u,n));var c=(0,r.default)(e,u);return c&&(d||c.contains(t))&&(c=n?new i.default(c,t,void 0):new i.default(c,void 0,t)),c}t.getInlineElementBefore=function(e,t){return l(e,t,!1)},t.getInlineElementAfter=function(e,t){return l(e,t,!0)},t.getInlineElementBeforeAfter=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e){var n=new FileReader;n.onload=function(){t(n.result)},n.onerror=function(){t(null)},n.readAsDataURL(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(75);function i(e,t,n,o,a,l){var s="string"==typeof t?t.trim():"",u="string"==typeof t?null:t,d=n?"background-color":"color";if(s||u){if(l){var c=l.registerColor((null==u?void 0:u.lightModeColor)||s,!!o,null==u?void 0:u.darkModeColor);e.style.setProperty(d,c)}else if(e.style.setProperty(d,(o?null==u?void 0:u.darkModeColor:null==u?void 0:u.lightModeColor)||s),e.dataset){var f=n?"ogsb":"ogsc";o&&"transparent"!=t?u&&(e.dataset[f]=u.lightModeColor):delete e.dataset[f]}n&&a&&function(e,t,n,o){if(!t||"transparent"===t)return;switch(function(e){var t=function(e){var t=(0,r.default)(e);if(t){var n=t[0]/255,i=t[1]/255,o=t[2]/255;return 50*(Math.max(n,i,o)+Math.min(n,i,o))}return 255}(e);if(t<20)return 1;if(t>80)return 0;return 2}(t)){case 1:i(e,{lightModeColor:"#ffffff",darkModeColor:"#333333"},!1,n,!1,o);break;case 0:i(e,{lightModeColor:"#000000",darkModeColor:"#ffffff"},!1,n,!1,o)}}(e,(null==u?void 0:u.lightModeColor)||s,o,l)}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.saveTableCellMetadata=t.getTableCellMetadata=void 0;var r=n(30),i=n(25),o=(0,r.createBooleanDefinition)(!1,void 0,!0),a=(0,r.createObjectDefinition)({bgColorOverride:o},!1,!0);t.getTableCellMetadata=function(e){return(0,i.getMetadata)(e,a)},t.saveTableCellMetadata=function(e,t){e&&t&&(0,i.setMetadata)(e,t,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);t.default=function e(t,n){var i,o,a=!1;if(n.isOptional&&void 0===t||n.allowNull&&null===t)a=!0;else{if(!n.isOptional&&void 0===t||!n.allowNull&&null===t)return!1;switch(n.type){case 2:a="string"==typeof t&&(void 0===n.value||t===n.value);break;case 1:a="number"==typeof t&&(void 0===n.value||(i=n.value,o=t,Math.abs(i-o)<.001))&&(void 0===n.minValue||t>=n.minValue)&&(void 0===n.maxValue||t<=n.maxValue);break;case 0:a="boolean"==typeof t&&(void 0===n.value||t===n.value);break;case 3:a=Array.isArray(t)&&(void 0===n.minLength||t.length>=n.minLength)&&(void 0===n.maxLength||t.length<=n.maxLength)&&t.every((function(t){return e(t,n.itemDef)}));break;case 4:a="object"==typeof t&&(0,r.default)(n.propertyDef).every((function(r){return e(t[r],n.propertyDef[r])}));break;case 5:a=n.validator(t)}}return a}},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(22),o=n(54),a=n(2),l=n(28),s=n(38),u=n(5),d=n(24),c=n(1),f=n(17),h=n(6),p=n(39),v=n(79),g=n(16),m=n(25),y=function(){function e(e){if(this.rootList=e,this.items=[],!e)throw new Error("rootList must not be null");b(this.rootList),(0,d.default)(this.rootList,"ol,ul",b),(0,d.default)(this.rootList,"li",C),this.populateItems(this.rootList)}return e.prototype.contains=function(e){return this.items.some((function(t){return t.contains(e)}))},e.prototype.getLastItemNumber=function(){var e=this.getStart();return void 0===e?e:e-1+this.items.filter((function(e){return 1==e.getListType()&&1==e.getLevel()&&!e.isDummy()})).length},e.prototype.writeBack=function(e){var t=this;if(!this.rootList)throw new Error("rootList must not be null");var n,r=this.rootList.ownerDocument,i=[r.createDocumentFragment()],o=r.createTextNode(""),a=this.getStart()||1;this.rootList.parentNode.replaceChild(o,this.rootList),this.items.forEach((function(r){var o=r.getNewListStart();o&&o!=a&&(i.splice(1,i.length-1),a=o),r.writeBack(i,t.rootList,e);var l=i[1];(0,c.default)(l,"HTMLOListElement")&&(n!=l&&(1==a?l.removeAttribute("start"):l.start=a),1==r.getLevel()&&a++);var s=t.getListItemIndex(r.getNode());r.applyListStyle(t.rootList,s),n=l})),o.parentNode.replaceChild(i[0],o)},e.prototype.split=function(e,t){if(!this.rootList)throw new Error("rootList must not be null");for(var n=0;n<this.items.length;n++)if(this.items[n].getNode()==e)return void this.items[n].setNewListStart(t)},e.prototype.setIndentation=function(e,t,n,r,i){var o=this;void 0===i&&(i=!1);var a=!1;if(this.findListItems(e,t,(function(e){a=a||0==o.items.indexOf(e),1==n?r&&!e.isDummy()?e.setIsDummy(!0):e.outdent(i):e.indent()})),a&&i)for(var l=0;l<this.items.length;l++)this.items[l].addNegativeMargins()},e.prototype.setAlignment=function(e,t,n){this.rootList.style.display="flex",this.rootList.style.flexDirection="column",this.findListItems(e,t,(function(e){var t="start";1==n?t="center":2==n&&(t="end"),e.getNode().style.alignSelf=t}))},e.prototype.changeListType=function(e,t,n){var r=!1;this.findListItems(e,t,(function(e){r=r||e.getListType()!=n})),this.findListItems(e,t,(function(e){return r?e.changeListType(n):e.outdent()}))},e.prototype.setListStyleType=function(e,t){var n=function(e,t,n){return{orderedStyleType:E(t,null==e?void 0:e.orderedStyleType,1),unorderedStyleType:E(n,null==e?void 0:e.unorderedStyleType,1)}}((0,m.getMetadata)(this.rootList,v.ListStyleDefinitionMetadata),e,t);(0,m.setMetadata)(this.rootList,n,v.ListStyleDefinitionMetadata)},e.prototype.appendItem=function(e,t){var n=(0,a.default)(e);"DIV"==n?e=(0,i.default)(e,"LI"):"LI"!=n&&(e=(0,g.default)(e,"LI")),this.items.push(0==t?new v.default(e):new v.default(e,t))},e.prototype.mergeVList=function(e){var t,n=this;e&&e!=this&&(e.items.forEach((function(e){return n.items.push(e)})),e.items.splice(0,e.items.length),null===(t=e.rootList.parentNode)||void 0===t||t.removeChild(e.rootList))},e.prototype.getListItemIndex=function(e){if(this.items)for(var t=(this.getStart()||1)-1,n=0;n<this.items.length;n++){var r=this.items[n];if(1!=r.getLevel()||r.isDummy()||t++,r.getNode()==e)return t}return-1},e.prototype.getStart=function(){return(0,c.default)(this.rootList,"HTMLOListElement")?this.rootList.start:void 0},e.prototype.findListItems=function(e,t,n){if(0==this.items.length)return[];var r=new u.default(this.items[0].getNode(),0),i=new u.default(this.items[this.items.length-1].getNode(),-1),o=r.isAfter(e)?0:-1,a=this.items.length-(t.isAfter(i)?1:0);this.items.forEach((function(n,r){o=n.contains(e.node)?r:o,a=n.contains(t.node)?r:a})),o=a<this.items.length?Math.max(0,o):o,a=o>=0?Math.min(this.items.length-1,a):a;var l=o<=a?this.items.slice(o,a+1):[];return n&&l.forEach(n),l},e.prototype.populateItems=function(e,t){var n=this;void 0===t&&(t=[]);var i=(0,o.default)(e);(0,h.default)(e.childNodes).forEach((function(e){var a=r(r([],t,!0),[i],!1);(0,o.isListElement)(e)?n.populateItems(e,a):3==e.nodeType&&""==(e.nodeValue||"").trim()||n.items.push(new(v.default.bind.apply(v.default,r([void 0,e],a,!1))))}))},e}();function b(e){var t=null;(0,h.default)(e.childNodes).forEach((function(e){"LI"==(0,a.default)(e)?t=e:(0,o.isListElement)(e)?t=null:t&&!(0,s.default)(e,!0)&&t.appendChild((0,l.default)(e)?e:(0,g.default)(e))}))}function C(e){for(;!(0,o.isListElement)(e.parentNode);){(0,f.default)(e,!0);var t=(0,h.default)(e.parentNode.childNodes).slice(1);t.length>0&&((0,l.default)(t[0])||(t=[(0,g.default)(t)]),t.forEach((function(t){return e.appendChild(t)}))),(0,p.default)(e.parentNode)}}function E(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter((function(e){return void 0!==e}))[0]}t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isListElement=void 0;var r=n(2);function i(e){switch((0,r.default)(e)){case"OL":return 1;case"UL":return 2;default:return 0}}t.default=i,t.isListElement=function(e){return 0!=i(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=n(5),o=n(10);t.default=function(e){if(!e)return null;var t=e.nodeBefore,n=e.nodeAfter,a=e.rootNode,l=e.skipTags,s=t?(0,o.getNextLeafSibling)(e.rootNode,t,e.skipTags):a.firstChild,u=n?(0,o.getPreviousLeafSibling)(a,n,l):a.lastChild,d=s&&u&&(0,r.default)(s,u);if(!function(e){var t=e;return!!t.fullSelectionEnd&&!!t.fullSelectionStart}(e))return d;if(d){var c=i.default.getStart(d).normalize(),f=i.default.getEnd(d).normalize(),h=e.fullSelectionEnd,p=e.fullSelectionStart;if(!p.isAfter(f)&&!c.isAfter(h)){var v=p.isAfter(c)?p:c,g=h.isAfter(f)?f:h;return(0,r.default)(v,g)}}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){Array.prototype.push.apply(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.currentIndex+t;return n>=0&&n<e.snapshots.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.experimentCommitListChains=void 0;var r=n(0);function i(e,t){if((null==t?void 0:t.length)>0){var n=e.getSelectionRange(),i=n&&r.Position.getStart(n),o=n&&r.Position.getEnd(n),a=e.isFeatureEnabled("ReuseAllAncestorListElements");t.forEach((function(e){return e.commit(a)})),i&&o&&e.select(i,o)}}t.default=i,t.experimentCommitListChains=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41),i=n(0);t.default=function(e,t){(0,r.default)(e,(function(n,r){(0,i.setColor)(n,r?"":t,!0,e.isDarkMode(),!1,e.getDarkColorHandler())}),"setBackgroundColor")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26),i=n(0);t.default=function(e,t,n,o,a,l,s){void 0===n&&(n=0),void 0===o&&(o=!0),(0,r.default)(e,(function(r,s,u,d){var c,f,h=n>0&&d.filter((function(e){return e.canAppendAtCursor(n)}))[0],p=null===(f=(0,i.getBlockElementAtNode)(r.rootNode,null!==(c=null==s?void 0:s.node)&&void 0!==c?c:null))||void 0===f?void 0:f.collapseToSingleElement();if(p){var v=h&&u&&(null==s?void 0:s.equalTo(u))?h.createVListAtBlock(p,n):(0,i.createVListFromRegion)(r,1!==n&&o);v&&s&&u&&(v.changeListType(s,u,t),e.isFeatureEnabled("AutoFormatList")&&v.setListStyleType(a,l),v.writeBack(e.isFeatureEnabled("ReuseAllAncestorListElements")))}}),void 0,s||"toggleListType")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.widthPx,r=e.heightPx,i=e.angleRad,o=n/(1-e.leftPercent-e.rightPercent),a=r/(1-e.topPercent-e.bottomPercent),l=t?o:n,s=t?a:r;return{targetWidth:Math.abs(l*Math.cos(i))+Math.abs(s*Math.sin(i)),targetHeight:Math.abs(l*Math.sin(i))+Math.abs(s*Math.cos(i)),originalWidth:o,originalHeight:a,visibleWidth:l,visibleHeight:s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Editor=void 0;var r=n(127);Object.defineProperty(t,"Editor",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(14),o=function(){function e(e){this.element=e}return e.prototype.collapseToSingleElement=function(){return this.element},e.prototype.getStartNode=function(){return this.element},e.prototype.getEndNode=function(){return this.element},e.prototype.equals=function(e){return this.element==e.getStartNode()},e.prototype.isAfter=function(e){return(0,i.default)(this.element,e.getEndNode())},e.prototype.contains=function(e){return(0,r.default)(this.element,e,!0)},e.prototype.getTextContent=function(){var e;return(null===(e=this.element)||void 0===e?void 0:e.textContent)||""},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.default=function(e,t){return(0,r.default)(e,"HTMLElement")&&(e.matches||e.msMatchesSelector).call(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function(e,t){var n=t.createElement("DIV");return n.innerHTML=e,(0,r.default)(n.childNodes)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7);t.default=function(e,t){var n=e;do{n=n&&(t?n.firstChild:n.lastChild)}while(n&&n.firstChild);return n&&(0,r.default)(e,n)||null}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){return e.call(this,t,n)||this}return i(t,e),t}(n(35).default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLastInlineElement=t.getFirstInlineElement=void 0;var r=n(21),i=n(69);t.getFirstInlineElement=function(e){var t=(0,i.getFirstLeafNode)(e);return t?(0,r.default)(e,t):null},t.getLastInlineElement=function(e){var t=(0,i.getLastLeafNode)(e);return t?(0,r.default)(e,t):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLastLeafNode=t.getFirstLeafNode=void 0;var r=n(29),i=n(10);function o(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},o=n(e);o&&n(o);)o=n(o);return o&&(0,r.default)(o)&&(o=(0,i.getLeafSibling)(e,o,t)),o}t.getFirstLeafNode=function(e){return o(e,!0)},t.getLastLeafNode=function(e){return o(e,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.position=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return""},e.prototype.getContainerNode=function(){return this.position.node},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return this.position},e.prototype.getEndPosition=function(){return this.position},e.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},e.prototype.isTextualInlineElement=function(){return!1},e.prototype.contains=function(e){return!1},e.prototype.applyStyle=function(e){},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20),i=n(11),o=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i,a=function(){function e(e,t){this.rootNode=e,this.position=t,this.text="",this.word="",this.inlineBefore=null,this.inlineAfter=null,this.traverser=null,this.traversingComplete=!1,this.inlineElements=[],this.nearestNonTextInlineElement=null}return e.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse((function(){return e.word})),this.word||""},e.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},e.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=r.default.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},e.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse((function(){return t.text.length>=e})),this.text.substr(Math.max(0,this.text.length-e))},e.prototype.getRangeFromText=function(e,t){if(!e)return null;var n=null,r=null,o=e.length-1;return this.forEachTextInlineElement((function(i){for(var a=i.getTextContent()||"",l=a.length-1;l>=0&&o>=0;l--)if(e.charCodeAt(o)==a.charCodeAt(l))o--,r||(r=i.getStartPosition().move(l+1));else if(t||r)return!0;return-1==o&&(n=i.getStartPosition().move(l+1),!0)})),n&&r&&(0,i.default)(n,r)},e.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},e.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse((function(){return e.nearestNonTextInlineElement})),this.nearestNonTextInlineElement},e.prototype.traverse=function(e){if(this.traverser=this.traverser||r.default.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n=t.getTextContent();if(!this.word){var i=o.exec(n);i&&2==i.length&&(this.word=i[1]+this.text)}if(this.text=n+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.default=function(e){return e&&(0,r.default)(e,"HTMLSpanElement")&&(e.classList.contains("entityDelimiterAfter")||e.classList.contains("entityDelimiterBefore"))&&""===e.textContent?e:null}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var i=n(49),o=n(19),a=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i,l=((r={})["text/html"]=function(e,t){return e.rawHtml=o.Browser.isEdge?function(e){var t=a.exec(e);if(3==(null==t?void 0:t.length)){var n=parseInt(t[1]),r=parseInt(t[2]);n>0&&r>n&&(e=e.substring(n,r))}return e}(t):t},r["text/plain"]=function(e,t){return e.text=t},r["text/*"]=function(e,t,n){return!!n&&(e.customValues[n]=t)},r["text/link-preview"]=function(e,t){try{e.customValues["link-preview"]=t,e.linkPreview=JSON.parse(t)}catch(e){}},r);t.default=function(e,t){var n={types:[],text:"",image:null,files:[],rawHtml:null,customValues:{}};return Promise.all((e||[]).map((function(e){var r=e.type;if(0!=r.indexOf("image/")||n.image||"file"!=e.kind){if("file"==e.kind)return new Promise((function(t){var i=e.getAsFile();i&&(n.types.push(r),n.files.push(i)),t()}));var o=function(e,t){var n=0==e.indexOf("text/")?e.substring("text/".length):null,r=t&&n?t.indexOf(n):-1;return n&&r>=0?n:void 0}(r,null==t?void 0:t.allowedCustomPasteType),a=l[r]||(o?l["text/*"]:null);return new Promise((function(t){return a?e.getAsString((function(e){n.types.push(r),a(n,e,o),t()})):t()}))}return n.types.push(r),n.image=e.getAsFile(),new Promise((function(e){n.image?(0,i.default)(n.image,(function(t){n.imageDataUri=t,e()})):e()}))}))).then((function(){return n}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),i=n(6);t.default=function(e,t,n){for(var o,a,l,s={types:e.types?(0,i.default)(e.types):[],text:e.getData("text"),image:null,files:[],rawHtml:null,customValues:{}},u=0;u<(e.files?e.files.length:0);u++){var d=e.files.item(u);if(0==(null===(o=null==d?void 0:d.type)||void 0===o?void 0:o.indexOf("image/"))){s.image=d;break}}var c=function(){s.image?(0,r.default)(s.image,(function(e){s.imageDataUri=e,t(s)})):t(s)};if((null==n?void 0:n.getTempDiv)&&(null==n?void 0:n.removeTempDiv)){var f=n.getTempDiv();f.contentEditable="true",f.innerHTML="",f.focus(),null===(l=null===(a=f.ownerDocument)||void 0===a?void 0:a.defaultView)||void 0===l||l.setTimeout((function(){var e;s.rawHtml=f.innerHTML,null===(e=n.removeTempDiv)||void 0===e||e.call(n,f),c()}),0)}else s.rawHtml=void 0,c()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,i=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,o=/^rgb\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,a=/^rgba\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/;t.default=function(e){var t;return(t=(e=(e||"").trim()).match(r))?[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]:(t=e.match(i))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:(t=e.match(o)||e.match(a))?[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.default=function(e){if((0,r.default)(e,"HTMLElement"))return e.innerHTML;if(e){var t=e.ownerDocument.createElement("span");return t.appendChild(e.cloneNode(!0)),t.innerHTML}return""}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(142),o=n(2),a=n(23),l=n(40),s=n(1),u=n(6),d=n(78),c=n(25),f={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:0,keepCellShade:!1},h=function(){function e(e,t,n){var r=this;if(this.cells=null,this.formatInfo=null,this.trs=[],this.tableSelection=null,this.table=(0,s.default)(e,"HTMLTableElement")?e:function(e){for(var t=e;t&&"TABLE"!=t.tagName;t=t.parentElement);return t}(e),this.table){var i=(0,s.default)(e,"HTMLTableElement")?null:e,o=(0,u.default)(this.table.rows);this.cells=o.map((function(e){return[]})),o.forEach((function(e,t){var n;r.trs[t%2]=e;for(var o=0,a=0;o<e.cells.length;o++){for(;r.cells[t][a];a++);var l=e.cells[o];l==i&&(r.col=a,r.row=t);for(var s=0;s<l.colSpan;s++,a++)for(var u=0;u<l.rowSpan;u++){var d=s+u==0,c=l.getBoundingClientRect();(null===(n=r.cells)||void 0===n?void 0:n[t+u])&&(r.cells[t+u][a]={td:d?l:null,spanLeft:s>0,spanAbove:u>0,width:d?c.width:void 0,height:d?c.height:void 0})}}})),this.formatInfo=(0,d.getTableFormatInfo)(this.table),t&&this.normalizeSize("number"==typeof n?function(e){return e/n}:n)}}return Object.defineProperty(e.prototype,"selection",{get:function(){return this.tableSelection||null},set:function(e){if(e){var t=e.firstCell;this.row=null==t?void 0:t.y,this.col=null==t?void 0:t.x}this.tableSelection=e},enumerable:!1,configurable:!0}),e.prototype.writeBack=function(e){var t,n=this;this.cells?((0,a.default)(this.table),this.cells.forEach((function(e,t){var r=g(n.trs[t%2]||n.trs[0]);r&&(n.table.appendChild(r),e.forEach((function(e,i){e.td&&(n.recalculateSpans(t,i),n.recalculateCellHeight(e.td),r.appendChild(e.td))})))})),this.formatInfo&&!e&&((0,d.saveTableInfo)(this.table,this.formatInfo),(0,i.default)(this.table,this.cells,this.formatInfo))):this.table&&(null===(t=this.table.parentNode)||void 0===t||t.removeChild(this.table))},e.prototype.recalculateCellHeight=function(e){if(this.isEmptyCell(e)&&e.rowSpan>1)for(var t=1;t<e.rowSpan;t++){var n=document.createElement("br");e.appendChild(n)}},e.prototype.applyFormat=function(e){this.table&&(this.formatInfo=r(r(r({},f),this.formatInfo||{}),e||{}),this.formatInfo.keepCellShade||this.deleteCellShadeDataset(this.cells))},e.prototype.deleteCellShadeDataset=function(e){null==e||e.forEach((function(e){e.forEach((function(e){e.td&&(0,c.removeMetadata)(e.td)}))}))},e.prototype.edit=function(e){var t,n,r=this;if(this.table&&this.cells&&void 0!==this.row&&null!=this.col){var i=this.cells[this.row],o=i[this.col],a=this.selection?this.selection.firstCell.y:this.row,l=this.selection?this.selection.lastCell.y:this.row,s=this.selection?this.selection.firstCell.x:this.col,u=this.selection?this.selection.lastCell.x:this.col;switch(e){case 0:for(var d=a;d<=l;d++)this.cells.splice(a,0,i.map(v));break;case 1:var c=function(e){var t=l+f.countSpanAbove(l,f.col);f.cells.splice(t,0,f.cells[t-1].map((function(e,n){var i=r.getCell(t,n);if(i.spanAbove)return v(i);if(e.spanLeft){var o=v(e);return o.spanAbove=!1,o}return{td:g(r.getTd(r.row,n))}})))},f=this;for(d=a;d<=l;d++)c();break;case 2:var h=function(e){p.forEachCellOfCurrentColumn((function(t,n){n.splice(e,0,v(t))}))},p=this;for(d=s;d<=u;d++)h(d);break;case 3:var m=function(e){var t=u+y.countSpanLeft(y.row,u);y.forEachCellOfColumn(t-1,(function(e,n,i){var o,a=r.getCell(i,t);a.spanLeft?o=v(a):e.spanAbove?(o=v(e)).spanLeft=!1:o={td:g(r.getTd(i,r.col))},n.splice(t,0,o)}))},y=this;for(d=s;d<=u;d++)m();break;case 6:for(var b=function(e){C.forEachCellOfRow(e,(function(t,n){var i=r.getCell(e+1,n);t.td&&t.td.rowSpan>1&&i.spanAbove&&(i.td=t.td)}))},C=this,E=a;E<=l;E++)b(E);var S=this.selection?this.selection.lastCell.y-this.selection.firstCell.y:0;this.cells.splice(a,S+1),0===this.cells.length&&(this.cells=null);break;case 5:for(var w=0,T=function(e){P.forEachCellOfColumn(e,(function(t,n,i){var o=r.getCell(i,e+1);t.td&&t.td.colSpan>1&&o.spanLeft&&(o.td=t.td);var a=r.selection?e-w:r.col;n.splice(a,1)})),w++},P=this,O=s;O<=u;O++)T(O);(0===(null===(t=this.cells)||void 0===t?void 0:t.length)||(null===(n=this.cells)||void 0===n?void 0:n.every((function(e){return 0===e.length}))))&&(this.cells=null);break;case 7:case 8:var M=7==e?-1:1;for(E=this.row+M;E>=0&&E<this.cells.length;E+=M){if((I=this.getCell(E,this.col)).td&&!I.spanAbove){var _=E<this.row?I:o,D=E<this.row?o:I;this.mergeCells(_,D);break}}break;case 9:case 10:var N=9==e?-1:1;for(O=this.col+N;O>=0&&O<this.cells[this.row].length;O+=N){if((I=this.getCell(this.row,O)).td&&!I.spanLeft){var x=O<this.col?I:o,k=O<this.col?o:I;this.mergeCells(x,k,!0);break}}break;case 11:for(O=s;O<=u;O++)for(E=a+1;E<=l;E++){var I=this.getCell(a,O),R=this.getCell(E,O);this.mergeCells(I,R)}for(O=s+1;O<=u;O++){I=this.getCell(a,s);var A=this.getCell(a,O);this.mergeCells(I,A,!0)}break;case 4:this.cells=null;break;case 13:if(o.td&&o.td.rowSpan>1)this.getCell(this.row+1,this.col).td=g(o.td);else{var L=i.map((function(e){return{td:e==o?g(e.td):null,spanAbove:e!=o,spanLeft:e.spanLeft}}));this.cells.splice(this.row+1,0,L)}break;case 12:o.td&&o.td.colSpan>1?this.getCell(this.row,this.col+1).td=g(o.td):this.forEachCellOfCurrentColumn((function(e,t){t.splice(r.col+1,0,{td:t==i?g(e.td):null,spanAbove:e.spanAbove,spanLeft:t!=i})}));break;case 14:this.table.style.marginLeft="auto",this.table.style.marginRight="auto";break;case 15:this.table.style.marginLeft="",this.table.style.marginRight="auto";break;case 16:this.table.style.marginLeft="auto",this.table.style.marginRight="";break;case 18:this.setAlignmentToSelectedCells(a,l,s,u,"center");break;case 17:this.setAlignmentToSelectedCells(a,l,s,u,"left");break;case 19:this.setAlignmentToSelectedCells(a,l,s,u,"right");break;case 20:this.setAlignmentToSelectedCells(a,l,s,u,"top",!0);break;case 21:this.setAlignmentToSelectedCells(a,l,s,u,"middle",!0);break;case 22:this.setAlignmentToSelectedCells(a,l,s,u,"bottom",!0)}}},e.prototype.setAlignmentToSelectedCells=function(e,t,n,r,i,o){for(var a,l,s=e;s<=t;s++)for(var u=n;u<=r;u++)if(this.cells){var d=this.cells[s][u].td;o&&d?null===(a=d.style)||void 0===a||a.setProperty("vertical-align",i):d&&(null===(l=d.style)||void 0===l||l.setProperty("text-align",i))}},e.prototype.mergeCells=function(e,t,n){var r,i,o,a,l=n?(null===(r=e.td)||void 0===r?void 0:r.rowSpan)===(null===(i=t.td)||void 0===i?void 0:i.rowSpan)&&!e.spanLeft:(null===(o=e.td)||void 0===o?void 0:o.colSpan)===(null===(a=t.td)||void 0===a?void 0:a.colSpan)&&!e.spanAbove;e.td&&t.td&&l&&(this.mergeCellContents(e.td,t.td),t.td=null,n?t.spanLeft=!0:t.spanAbove=!0)},e.prototype.isEmptyCell=function(e){return 1===e.childElementCount&&"BR"===(0,o.default)(e.firstChild)},e.prototype.mergeCellContents=function(e,t){if(this.isEmptyCell(t))(0,a.default)(e,t,!1);else{var n=document.createElement("br");e.appendChild(n),(0,a.default)(e,t,!0)}},e.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},e.prototype.getCellsWithBorder=function(e,t){for(var n=[],r=0;this.cells&&r<this.cells.length;r++)for(var i=0;i<this.cells[r].length;i++){var o=this.getCell(r,i);if(o.td){var a=(0,l.default)(o.td.getBoundingClientRect());if(a){var s=!1;if(t){if(a.right==e)s=!0,n.push(o.td);else if(s)break}else if(a.left==e)s=!0,n.push(o.td);else if(s)break}}}return n},e.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},e.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},e.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},e.prototype.getTd=function(e,t){if(this.cells&&void 0!==e&&void 0!==t&&(e=Math.min(this.cells.length-1,e),t=this.cells[e]?Math.min(this.cells[e].length-1,t):t,!isNaN(e)&&!isNaN(t)))for(;e>=0&&t>=0;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},e.prototype.forEachCellOfColumn=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},e.prototype.forEachCellOfRow=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells[e].length;n++)t(this.getCell(e,n),n)},e.prototype.recalculateSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},e.prototype.countSpanLeft=function(e,t){for(var n=1,r=t+1;this.cells&&r<this.cells[e].length;r++){var i=this.getCell(e,r);if(i.td||!i.spanLeft)break;n++}return n},e.prototype.countSpanAbove=function(e,t){for(var n=1,r=e+1;this.cells&&r<this.cells.length;r++){var i=this.getCell(r,t);if(i.td||!i.spanAbove)break;n++}return n},e.prototype.normalizeEmptyTableCells=function(){for(var e=0,t=void 0;t=this.table.rows[e];e++)for(var n=0,r=void 0;r=t.cells[n];n++)r&&(r.innerHTML&&r.innerHTML.trim()||r.appendChild(document.createElement("br")))},e.prototype.normalizeTableCellSize=function(e){for(var t=0,n=void 0;n=this.table.rows[t];t++)n.removeAttribute("width"),n.style.setProperty("width",null),n.removeAttribute("height"),n.style.setProperty("height",null);for(t=0;this.cells&&t<this.cells.length;t++)for(var r=0;r<this.cells[t].length;r++){var i=this.cells[t][r];if(i){var o="number"==typeof e?function(t){return t/e}:e,a=i.width||0,l=i.height||0;p(i.td,(null==o?void 0:o(a))||a,(null==o?void 0:o(l))||l)}}},e.prototype.normalizeSize=function(e){this.normalizeEmptyTableCells(),this.normalizeTableCellSize(e);var t=this.table.getBoundingClientRect();p(this.table,(null==e?void 0:e(t.width))||t.width,(null==e?void 0:e(t.height))||t.height)},e}();function p(e,t,n){e&&(e.removeAttribute("width"),e.removeAttribute("height"),e.style.boxSizing="border-box",e.style.width=t+"px",e.style.height=n+"px")}function v(e){return{td:g(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function g(e){var t=e?e.cloneNode(!1):null;return(0,s.default)(t,"HTMLTableCellElement")&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.saveTableInfo=t.getTableFormatInfo=void 0;var r=n(25),i=n(30),o=(0,i.createStringDefinition)(!1,void 0,!0),a=(0,i.createBooleanDefinition)(!1),l=(0,i.createObjectDefinition)({topBorderColor:o,bottomBorderColor:o,verticalBorderColor:o,hasHeaderRow:a,headerRowColor:o,hasFirstColumn:a,hasBandedColumns:a,hasBandedRows:a,bgColorEven:o,bgColorOdd:o,tableBorderFormat:(0,i.createNumberDefinition)(!1,void 0,0,8),keepCellShade:(0,i.createBooleanDefinition)(!0)},!1,!0);t.getTableFormatInfo=function(e){return(0,r.getMetadata)(e,l)},t.saveTableInfo=function(e,t){e&&t&&(0,r.setMetadata)(e,t,l)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.ListStyleDefinitionMetadata=void 0;var o=n(4),a=n(54),l=n(31),s=n(2),u=n(28),d=n(23),c=n(1),f=n(144),h=n(80),p=n(145),v=n(32),g=n(6),m=n(39),y=n(16),b=n(30),C=n(25),E=[null,"lower-alpha","lower-roman"],S=["disc","circle","square"],w=["font-size","font-family","color"],T=["data-ogsc","data-ogsb","data-ogac","data-ogab"];t.ListStyleDefinitionMetadata=(0,b.createObjectDefinition)({orderedStyleType:(0,b.createNumberDefinition)(!0,void 0,1,20),unorderedStyleType:(0,b.createNumberDefinition)(!0,void 0,1,9)},!0,!0);var P=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.newListStart=void 0,!e)throw new Error("node must not be null");this.node=(0,c.default)(e,"HTMLLIElement")?e:(0,y.default)(e,4);var r=this.node.style.display;this.dummy="list-item"!=r&&""!=r,this.listTypes=i([0],t,!0)}return e.prototype.getListType=function(){return this.listTypes[this.listTypes.length-1]},e.prototype.getLevel=function(){return this.listTypes.length-1},e.prototype.getNode=function(){return this.node},e.prototype.getNewListStart=function(){return this.newListStart},e.prototype.contains=function(e){return(0,o.default)(this.node,e,!0)},e.prototype.isDummy=function(){return this.dummy},e.prototype.isOrphanItem=function(){return!1},e.prototype.canMerge=function(e){return!(!(null==e?void 0:e.isOrphanItem())||this.listTypes.length!=e.listTypes.length)&&this.listTypes.every((function(t,n){return e.listTypes[n]==t}))},e.prototype.mergeItems=function(e){var t=this;M((null==e?void 0:e.map((function(e){return e.node})))||[],!0,!1).forEach((function(e){return t.node.appendChild(e)}))},e.prototype.indent=function(){if("-.25in"==this.node.style.marginLeft)return this.node.style.margin="",void(this.node.style.marginLeft="");var e=this.getListType();0!=e&&this.listTypes.push(e)},e.prototype.outdent=function(e){void 0===e&&(e=!1);var t=e?2:1;this.listTypes.length>t&&this.listTypes.pop()},e.prototype.addNegativeMargins=function(){this.node.style.margin="0in 0in 0in 0.5in",this.node.style.marginLeft="-.25in"},e.prototype.changeListType=function(e){0==e?this.listTypes=[e]:(this.outdent(),this.listTypes.push(e))},e.prototype.setIsDummy=function(e){this.dummy=e},e.prototype.setNewListStart=function(e){this.newListStart=e},e.prototype.applyListStyle=function(e,n){var r=(0,C.getMetadata)(e,t.ListStyleDefinitionMetadata),i=this.listTypes.length<3;r&&(i&&2===this.listTypes[1]&&r.unorderedStyleType?(0,f.default)(this.node,r.unorderedStyleType):i&&1===this.listTypes[1]&&r.orderedStyleType?(0,p.default)(this.node,r.orderedStyleType,n):this.node.style.removeProperty("list-style-type"))},e.prototype.writeBack=function(e,t,n){var i,o=this;void 0===n&&(n=!1);var u,d,f=1;if(n){e.length>this.listTypes.length&&e.splice(this.listTypes.length);var p=e.length-1;p===this.listTypes.length-1&&(0,a.default)(e[p])!==this.listTypes[p]&&e.splice(p),f=e.length}else for(;f<e.length;f++)if((0,a.default)(e[f])!==this.listTypes[f]){e.splice(f);break}for(;f<this.listTypes.length;f++){var b=e.length-1,C=O(e[0],this.listTypes[f],f,t);if(e[b].appendChild(C),e.push(C),this.getDeepChildIndex(t)==b){var E=null===(i=this.node.parentElement)||void 0===i?void 0:i.style.listStyleType;E&&(0,s.default)(this.node.parentElement)===(0,s.default)(C)&&(C.style.listStyleType=E)}}if(e[e.length-1].appendChild(this.node),this.node.style.setProperty("display",this.dummy?"block":null),this.listTypes.length>1&&((0,h.default)(this.node,w,!0),(0,h.default)(this.node,T,!1)),this.listTypes.length<=1){var S="LI"==(0,s.default)(this.node),P=S?{"font-family":this.node.style.fontFamily,"font-size":this.node.style.fontSize,color:this.node.style.color}:void 0,_=S?(u=this.node,d=(0,g.default)(u.childNodes),(0,m.default)(u),d):[this.node];if(P)for(var D=function(e){(0,c.default)(_[e],"Text")&&(_[e]=(0,y.default)(_[e],"span"));var t=_[e];if((0,c.default)(t,"HTMLElement")){var n=r(r({},P),(0,l.default)(t));(0,v.default)(t,n),T.forEach((function(e){var n=o.node.getAttribute(e);n&&t.setAttribute(e,n)}))}},N=0;N<_.length;N++)D(N);M(_,!0,!0)}},e.prototype.getDeepChildIndex=function(e){var t=this.node.parentElement;if(e&&t){for(var n=0;t&&t!=e;)n++,t=(null==t?void 0:t.parentElement)||null;return n}return-1},e}();function O(e,n,r,i){var l,s=e.ownerDocument;if(1==r&&i&&n==(0,a.default)(i)?(0,o.default)(e,i)?(l=i.cloneNode(!1)).removeAttribute("id"):((0,d.default)(i),l=i):l=s.createElement(1==n?"ol":"ul"),i&&1==r&&n!=(0,a.default)(i)){var u=(0,C.getMetadata)(i,t.ListStyleDefinitionMetadata);u&&(0,C.setMetadata)(l,u,t.ListStyleDefinitionMetadata)}return 1==n&&r>1&&l.style.setProperty("list-style-type",E[(r-1)%E.length]),2==n&&r>1&&l.style.setProperty("list-style-type",S[(r-1)%S.length]),l}function M(e,t,n){return!(e.length>0)||t&&(0,u.default)(e[0])||n&&(0,u.default)(e[e.length])||(e=[(0,y.default)(e)]),e}t.default=P},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20),i=n(15),o=n(1);t.default=function(e,t,n){void 0===n&&(n=!0);var a=function(e,t,n){var a,l,s=[],u=r.default.createBodyTraverser(e),d=null,c=function(){var r=(null==(d=u.currentInlineElement)?void 0:d.getContainerNode())||null,c=null;r=r?(0,i.default)(r):null;for(var f=function(){var e=r;t.forEach((function(t){var r=n?e.style.getPropertyValue(t):e.getAttribute(t);c||(c={}),r&&!c[t]&&(c[t]=r)})),r=1===(null===(l=null==r?void 0:r.parentNode)||void 0===l?void 0:l.childNodes.length)?r.parentNode:null};r&&r!==e&&(0,o.default)(r,"HTMLElement")&&(0==s.length||((null===(a=r.textContent)||void 0===a?void 0:a.trim().length)||0)>0);)f();c&&s.push(c),u.getNextInlineElement()};for(;u.currentInlineElement!=d;)c();return s}(e,t,n);t.forEach((function(t){var r=a.map((function(e){return void 0!==e[t]?e[t]:""}));r&&(1==r.length||1==new Set(r).size)&&r[0]&&(n?e.style.setProperty(t,r[0]):e.setAttribute(t,r[0]))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15);t.default=function(e,t,n){var i=e&&(0,r.default)(n,e.rootNode,t);if(i)for(var o=void 0;o=(0,r.default)(i.parentNode,e.rootNode,t);)i=o;return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20),i=n(18),o=n(7),a=n(55),l=n(29);t.default=function(e,t,n){var s=(0,a.default)(e),u=[];if(s){for(var d=e.rootNode,c=e.skipTags,f=r.default.createSelectionTraverser(d,s,c),h=null==f?void 0:f.currentBlockElement;h;h=f.getNextBlockElement())u.push(h);u=u.filter((function(e){var t,n=e.getStartNode();return n!=e.getEndNode()||!(0,l.default)(n,!0)||(null===(t=n.parentNode)||void 0===t||t.removeChild(n),!1)}))}if(0==u.length&&e&&!e.rootNode.firstChild&&t){var p=(0,i.default)(n?12:1,e.rootNode.ownerDocument);e.rootNode.appendChild(p),(h=(0,o.default)(e.rootNode,p))&&u.push(h)}return u}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.getRegionCreator=void 0;var i=n(4),o=n(15),a=n(5),l=n(24),s=n(10),u=((r={})[0]={skipTags:["TABLE"],outerSelector:"table",innerSelector:"td,th"},r);function d(e,t){var n=a.default.getStart(e).normalize(),r=a.default.getEnd(e).normalize();return function(e,o,a){return function(e,t,n,r){if(e){var o=t&&(0,s.getNextLeafSibling)(e,t,r),a=n&&(0,s.getPreviousLeafSibling)(e,n,r),l=!t||(0,i.default)(e,t)&&(0,i.default)(e,o),u=!n||(0,i.default)(e,n)&&(0,i.default)(e,a),d=!(t&&n&&((0,i.default)(t,n,!0)||(0,i.default)(t,a,!0)||(0,i.default)(n,t,!0)||(0,i.default)(n,o,!0)));return l&&u&&d}return!1}(e,o,a,t)?{rootNode:e,nodeBefore:o,nodeAfter:a,skipTags:t,fullSelectionStart:n,fullSelectionEnd:r}:null}}t.default=function(e,t,n){var r=[];if(e&&t){var a=u[n],s=a.innerSelector,c=a.skipTags,f=function(e,t,n){var r=[{innerNode:e,children:[]}],a=u[n],s=a.outerSelector,d=a.innerSelector,c=(0,l.default)(e,s,null,2,t);return(0,l.default)(e,d,(function(t){var n=(0,o.default)(t,e,s);if(n&&c.indexOf(n)<0){for(var a={innerNode:t,children:[]},l=r.length-1;l>=0;l--){var u=r[l],d=u.innerNode,f=u.children;if((0,i.default)(d,n)){var h=f.filter((function(e){return e.outerNode==n}))[0];h||(h={outerNode:n,boundaries:[]},f.push(h)),h.boundaries.push(a);break}}r.push(a)}}),1,t),r[0]}(e,t,n),h=(0,o.default)(t.startContainer,e,s)||e,p=(0,o.default)(t.endContainer,e,s)||e;r=function e(t,n,r,i,o){var a;o=o||n.innerNode==r;var l=!1,s=n.children,u=n.innerNode,d=[];if(0==s.length){(f=t(u))&&d.push(f)}else for(var c=0;c<=s.length&&!l;c++){var f,h=s[c]||{},p=h.outerNode,v=h.boundaries,g=null===(a=s[c-1])||void 0===a?void 0:a.outerNode;if(o)(f=t(u,g,p))&&d.push(f);null==v||v.forEach((function(n){var a,s;s=(a=e(t,n,r,i,o))[0],o=a[1],l=a[2],d=d.concat(s)}))}return[d,o,l||u==i]}(d(t,c),f,h,p)[0]}return r.filter((function(e){return!!e}))},t.getRegionCreator=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(27),i=n(33),o=n(1);t.default=function(e,t){if(!t||0==t.length)return[];var n=(0,o.default)(t[0],"Node")?t:[t[0].getStartNode(),t[t.length-1].getEndNode()],a=(n=n&&n.filter((function(t){return(0,i.default)(e,t)})))[0],l=n[n.length-1];return(0,i.default)(e,a)&&(0,i.default)(e,l)?(0,r.default)(e.rootNode,a,l,!0):[]}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(22),o=n(4),a=n(7),l=n(86),s=n(31),u=n(33),d=n(1),c=n(32),f=n(27);t.default=function(e,t,n){var h,p,v,g;if((0,u.default)(e,t)&&(0,u.default)(e,n)&&(g=(0,a.default)(e.rootNode,n))&&!g.contains(t)){for(var m=g.collapseToSingleElement(),y=(0,f.collapse)(e.rootNode,m,t,!1,!0),b=m;(0,o.default)(y,b);){var C=b.parentNode;if((0,d.default)(C,"HTMLElement")){var E=r(r(r({},(0,l.default)(C)||{}),(0,s.default)(C)),(0,s.default)(m));(0,c.default)(m,E)}b=C}var S=null,w=1==m.childNodes.length&&0==m.attributes.length?m.firstChild:(0,i.default)(m,"SPAN");for(b=w;(0,o.default)(y,b)&&1==(null===(h=b.parentNode)||void 0===h?void 0:h.childNodes.length);b=b.parentNode)S=b.parentNode;null===(p=t.parentNode)||void 0===p||p.insertBefore(w,t.nextSibling),null===(v=null==S?void 0:S.parentNode)||void 0===v||v.removeChild(S)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i={B:{"font-weight":"bold"},EM:{"font-style":"italic"},I:{"font-style":"italic"},U:{"text-decoration":"underline"},P:{"margin-top":"1em","margin-bottom":"1em"},PRE:{"white-space":"pre"},S:{"text-decoration":"line-through"},STRIKE:{"text-decoration":"line-through"},SUB:{"vertical-align":"sub","font-size":"smaller"},SUP:{"vertical-align":"super","font-size":"smaller"}};t.default=function(e,t){var n=(0,r.default)(e);return i[n]||(t||{})[n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(2),o=n(38);function a(e){for(;e.previousSibling;)if(e=e.previousSibling,"BR"==(0,i.default)(e)||!(0,o.default)(e))return!1;return!0}t.default=function(e,t){if(e){var n=(e=e.normalize()).node;if(0==e.offset){for(;n&&(0,r.default)(t,n)&&a(n);)n=(null==n?void 0:n.parentNode)||null;return n==t}}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(5);function o(e,t){var n,i;if(!e||!t)return[];var o,a=e.node,l=e.offset,s=[];if(!(0,r.default)(t,a,!0))return[];if(3==a.nodeType){for(o=a.parentNode;a.previousSibling&&3==a.previousSibling.nodeType;)l+=(null===(n=a.previousSibling.nodeValue)||void 0===n?void 0:n.length)||0,a=a.previousSibling;s.unshift(l)}else o=a,a=a.childNodes[l];do{l=0;for(var u=!1,d=(null==o?void 0:o.firstChild)||null;d&&d!=a;d=d.nextSibling){if(3==d.nodeType){if(0===(null===(i=d.nodeValue)||void 0===i?void 0:i.length)||u)continue;u=!0}else u=!1;l++}s.unshift(l),a=o,o=(null==o?void 0:o.parentNode)||null}while(a&&a!=t);return s}t.default=function(e,t){return t?{start:o(i.default.getStart(t),e),end:o(i.default.getEnd(t),e)}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearProceedingSnapshotsV2=void 0;var r=n(57);function i(e,t){if(t=t||function(e){var t;return(null===(t=e)||void 0===t?void 0:t.length)||0},(0,r.default)(e,1)){for(var n=0,i=e.currentIndex+1;i<e.snapshots.length;i++)n+=t(e.snapshots[i]);e.snapshots.splice(e.currentIndex+1),e.totalSize-=n,e.autoCompleteIndex=-1}}t.default=i,t.clearProceedingSnapshotsV2=function(e){i(e,(function(e){var t;return(null===(t=e.html)||void 0===t?void 0:t.length)||0}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",");t.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&e&&t.getComputedStyle(e),i={};return r.forEach((function(e){return i[e]=n&&n.getPropertyValue(e)||""})),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneObject=void 0;var r=n(8);var i=Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n=t||{};if(e)for(var i=0,o=(0,r.default)(e);i<o.length;i++){var a=o[i];n[a]=e[a]}return n};t.cloneObject=function(e,t){return i(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n=!1,r="",i="",o=!1;return null===(t=null==e?void 0:e.className)||void 0===t||t.split(" ").forEach((function(e){"_Entity"==e?n=!0:0==e.indexOf("_EType_")?r=e.substr("_EType_".length):0==e.indexOf("_EId_")?i=e.substr("_EId_".length):0==e.indexOf("_EReadonly_")&&(o="1"==e.substr("_EReadonly_".length))})),n?{wrapper:e,id:i,type:r,isReadonly:o}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return"._Entity"+(e?"._EType_"+e:"")+(t?"._EId_"+t:"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=e.ctrlKey||"Control"===e.key,n=e.altKey||"Alt"===e.key,r=e.metaKey||"Meta"===e.key;return t||n||r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasFocus=void 0;var r=n(0);t.hasFocus=function(e){var t=e.contentDiv.ownerDocument.activeElement;return!(!t||!(0,r.contains)(e.contentDiv,t,!0))}},function(e,t,n){"use strict";function r(e,t,n){for(var r=0,i=function(){return n.getElementById(t+r)},o=i();o;)r++,o=i();e.id=t+r}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.ownerDocument;e.id?n.querySelectorAll("#"+e.id).length>1&&(e.removeAttribute("id"),r(e,t,n)):r(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkColor=void 0;var r=n(209);Object.defineProperty(t,"getDarkColor",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(e,t,n){var r=n(98),i={};for(var o in r)r.hasOwnProperty(o)&&(i[r[o]]=o);var a=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var l in a)if(a.hasOwnProperty(l)){if(!("channels"in a[l]))throw new Error("missing channels property: "+l);if(!("labels"in a[l]))throw new Error("missing channel labels property: "+l);if(a[l].labels.length!==a[l].channels)throw new Error("channel and label counts mismatch: "+l);var s=a[l].channels,u=a[l].labels;delete a[l].channels,delete a[l].labels,Object.defineProperty(a[l],"channels",{value:s}),Object.defineProperty(a[l],"labels",{value:u})}a.rgb.hsl=function(e){var t,n,r=e[0]/255,i=e[1]/255,o=e[2]/255,a=Math.min(r,i,o),l=Math.max(r,i,o),s=l-a;return l===a?t=0:r===l?t=(i-o)/s:i===l?t=2+(o-r)/s:o===l&&(t=4+(r-i)/s),(t=Math.min(60*t,360))<0&&(t+=360),n=(a+l)/2,[t,100*(l===a?0:n<=.5?s/(l+a):s/(2-l-a)),100*n]},a.rgb.hsv=function(e){var t,n,r,i,o,a=e[0]/255,l=e[1]/255,s=e[2]/255,u=Math.max(a,l,s),d=u-Math.min(a,l,s),c=function(e){return(u-e)/6/d+.5};return 0===d?i=o=0:(o=d/u,t=c(a),n=c(l),r=c(s),a===u?i=r-n:l===u?i=1/3+t-r:s===u&&(i=2/3+n-t),i<0?i+=1:i>1&&(i-=1)),[360*i,100*o,100*u]},a.rgb.hwb=function(e){var t=e[0],n=e[1],r=e[2];return[a.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(n,r))),100*(r=1-1/255*Math.max(t,Math.max(n,r)))]},a.rgb.cmyk=function(e){var t,n=e[0]/255,r=e[1]/255,i=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-r,1-i)))/(1-t)||0),100*((1-r-t)/(1-t)||0),100*((1-i-t)/(1-t)||0),100*t]},a.rgb.keyword=function(e){var t=i[e];if(t)return t;var n,o,a,l=1/0;for(var s in r)if(r.hasOwnProperty(s)){var u=r[s],d=(o=e,a=u,Math.pow(o[0]-a[0],2)+Math.pow(o[1]-a[1],2)+Math.pow(o[2]-a[2],2));d<l&&(l=d,n=s)}return n},a.keyword.rgb=function(e){return r[e]},a.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]},a.rgb.lab=function(e){var t=a.rgb.xyz(e),n=t[0],r=t[1],i=t[2];return r/=100,i/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(n-r),200*(r-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]},a.hsl.rgb=function(e){var t,n,r,i,o,a=e[0]/360,l=e[1]/100,s=e[2]/100;if(0===l)return[o=255*s,o,o];t=2*s-(n=s<.5?s*(1+l):s+l-s*l),i=[0,0,0];for(var u=0;u<3;u++)(r=a+1/3*-(u-1))<0&&r++,r>1&&r--,o=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t,i[u]=255*o;return i},a.hsl.hsv=function(e){var t=e[0],n=e[1]/100,r=e[2]/100,i=n,o=Math.max(r,.01);return n*=(r*=2)<=1?r:2-r,i*=o<=1?o:2-o,[t,100*(0===r?2*i/(o+i):2*n/(r+n)),100*((r+n)/2)]},a.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,i=Math.floor(t)%6,o=t-Math.floor(t),a=255*r*(1-n),l=255*r*(1-n*o),s=255*r*(1-n*(1-o));switch(r*=255,i){case 0:return[r,s,a];case 1:return[l,r,a];case 2:return[a,r,s];case 3:return[a,l,r];case 4:return[s,a,r];case 5:return[r,a,l]}},a.hsv.hsl=function(e){var t,n,r,i=e[0],o=e[1]/100,a=e[2]/100,l=Math.max(a,.01);return r=(2-o)*a,n=o*l,[i,100*(n=(n/=(t=(2-o)*l)<=1?t:2-t)||0),100*(r/=2)]},a.hwb.rgb=function(e){var t,n,r,i,o,a,l,s=e[0]/360,u=e[1]/100,d=e[2]/100,c=u+d;switch(c>1&&(u/=c,d/=c),r=6*s-(t=Math.floor(6*s)),0!=(1&t)&&(r=1-r),i=u+r*((n=1-d)-u),t){default:case 6:case 0:o=n,a=i,l=u;break;case 1:o=i,a=n,l=u;break;case 2:o=u,a=n,l=i;break;case 3:o=u,a=i,l=n;break;case 4:o=i,a=u,l=n;break;case 5:o=n,a=u,l=i}return[255*o,255*a,255*l]},a.cmyk.rgb=function(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i)),255*(1-Math.min(1,r*(1-i)+i))]},a.xyz.rgb=function(e){var t,n,r,i=e[0]/100,o=e[1]/100,a=e[2]/100;return n=-.9689*i+1.8758*o+.0415*a,r=.0557*i+-.204*o+1.057*a,t=(t=3.2406*i+-1.5372*o+-.4986*a)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1))]},a.xyz.lab=function(e){var t=e[0],n=e[1],r=e[2];return n/=100,r/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},a.lab.xyz=function(e){var t,n,r,i=e[0];t=e[1]/500+(n=(i+16)/116),r=n-e[2]/200;var o=Math.pow(n,3),a=Math.pow(t,3),l=Math.pow(r,3);return n=o>.008856?o:(n-16/116)/7.787,t=a>.008856?a:(t-16/116)/7.787,r=l>.008856?l:(r-16/116)/7.787,[t*=95.047,n*=100,r*=108.883]},a.lab.lch=function(e){var t,n=e[0],r=e[1],i=e[2];return(t=360*Math.atan2(i,r)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(r*r+i*i),t]},a.lch.lab=function(e){var t,n=e[0],r=e[1];return t=e[2]/360*2*Math.PI,[n,r*Math.cos(t),r*Math.sin(t)]},a.rgb.ansi16=function(e){var t=e[0],n=e[1],r=e[2],i=1 in arguments?arguments[1]:a.rgb.hsv(e)[2];if(0===(i=Math.round(i/50)))return 30;var o=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===i&&(o+=60),o},a.hsv.ansi16=function(e){return a.rgb.ansi16(a.hsv.rgb(e),e[2])},a.rgb.ansi256=function(e){var t=e[0],n=e[1],r=e[2];return t===n&&n===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)},a.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},a.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var n;return e-=16,[Math.floor(e/36)/5*255,Math.floor((n=e%36)/6)/5*255,n%6/5*255]},a.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},a.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var n=t[0];3===t[0].length&&(n=n.split("").map((function(e){return e+e})).join(""));var r=parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},a.rgb.hcg=function(e){var t,n=e[0]/255,r=e[1]/255,i=e[2]/255,o=Math.max(Math.max(n,r),i),a=Math.min(Math.min(n,r),i),l=o-a;return t=l<=0?0:o===n?(r-i)/l%6:o===r?2+(i-n)/l:4+(n-r)/l+4,t/=6,[360*(t%=1),100*l,100*(l<1?a/(1-l):0)]},a.hsl.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=1,i=0;return(r=n<.5?2*t*n:2*t*(1-n))<1&&(i=(n-.5*r)/(1-r)),[e[0],100*r,100*i]},a.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=t*n,i=0;return r<1&&(i=(n-r)/(1-r)),[e[0],100*r,100*i]},a.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0===n)return[255*r,255*r,255*r];var i,o=[0,0,0],a=t%1*6,l=a%1,s=1-l;switch(Math.floor(a)){case 0:o[0]=1,o[1]=l,o[2]=0;break;case 1:o[0]=s,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=l;break;case 3:o[0]=0,o[1]=s,o[2]=1;break;case 4:o[0]=l,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=s}return i=(1-n)*r,[255*(n*o[0]+i),255*(n*o[1]+i),255*(n*o[2]+i)]},a.hcg.hsv=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t),r=0;return n>0&&(r=t/n),[e[0],100*r,100*n]},a.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100*(1-t)+.5*t,r=0;return n>0&&n<.5?r=t/(2*n):n>=.5&&n<1&&(r=t/(2*(1-n))),[e[0],100*r,100*n]},a.hcg.hwb=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},a.hwb.hcg=function(e){var t=e[1]/100,n=1-e[2]/100,r=n-t,i=0;return r<1&&(i=(n-r)/(1-r)),[e[0],100*r,100*i]},a.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},a.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},a.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},a.gray.hsl=a.gray.hsv=function(e){return[0,0,e[0]]},a.gray.hwb=function(e){return[0,100,e[0]]},a.gray.cmyk=function(e){return[0,0,0,e[0]]},a.gray.lab=function(e){return[e[0],0,0]},a.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},a.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(216),t),i(n(260),t),i(n(263),t),i(n(266),t),i(n(269),t),i(n(272),t),i(n(279),t),i(n(282),t),i(n(309),t),i(n(312),t),i(n(321),t),i(n(324),t),i(n(330),t)},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(219),o=n(248),a=n(249),l=n(250),s=n(254),u=n(255),d=n(256),c=n(257),f=n(258),h=n(259),p=r(r(r(r(r(r(r(r(r(r({},l.ListFeatures),u.QuoteFeatures),f.TableFeatures),c.StructuredNodeFeatures),i.AutoLinkFeatures),d.ShortcutFeatures),o.CursorFeatures),s.MarkdownFeatures),a.EntityFeatures),h.TextFeatures);t.default=function(){return p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42),i=n(26),o=n(12),a=n(3),l=n(59),s=n(103),u=n(104),d=n(105),c=n(106),f=n(107),h=n(108),p=n(0),v=["font","text-decoration","color","background"],g="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),m=["href","src","cellpadding","cellspacing"],y=["TD","TH","TR","TABLE","TBODY","THEAD"];function b(e){var t=(0,p.toArray)(e.childNodes).map(b).every((function(e){return e})),n=(0,p.isBlockElement)(e),r=(0,p.getTagOfNode)(e);return r&&(g.indexOf(r)>=0||t&&!(0,p.isVoidHtmlElement)(e)&&y.indexOf(r)<0?(n&&!t&&(0,p.wrap)(e),(0,p.unwrap)(e)):function(e){for(var t=(0,p.safeInstanceOf)(e,"HTMLTableCellElement"),n=(0,p.safeInstanceOf)(e,"HTMLTableElement"),r=0,i=(0,p.toArray)(e.attributes);r<i.length;r++){var o=i[r];t&&"style"==o.name?E(e):n&&"style"==o.name?S(e):m.indexOf(o.name.toLowerCase())<0&&0!=o.name.indexOf("data-")&&e.removeAttribute(o.name)}}(e)),n}function C(e,t){var n=(0,p.getStyles)(e),r={};return(0,p.getObjectKeys)(n).forEach((function(e){return t(e,n,r)})),(0,p.setStyles)(e,n),r}function E(e){return C(e,(function(e,t,n){e.indexOf("border")<0&&(n[e]=t[e],delete t[e])}))}function S(e){return C(e,(function(e,t,n){"border-collapse"!=e&&(n[e]=t[e],delete t[e])}))}function w(e){if(!function(e){var t=e.getSelectionTraverser();return!!(null==t?void 0:t.currentBlockElement)&&!!(null==t?void 0:t.getNextBlockElement())}(e)){var t=e.getSelectionTraverser(),n=null==t?void 0:t.currentInlineElement;if(n instanceof p.PartialInlineElement||n instanceof p.NodeInlineElement&&!function(e,t){for(var n,r=e,i=function(){if(r.nextSibling||r.previousSibling){if((0,p.safeInstanceOf)(r,"HTMLLIElement"))return{value:!0};var e=!0;return null===(n=r.parentNode)||void 0===n||n.childNodes.forEach((function(t){var n;t!=r&&(null===(n=t.textContent)||void 0===n?void 0:n.length)&&(e=!1)})),{value:e}}r=r.parentNode};r&&t.contains(r.parentNode);){var o=i();if("object"==typeof o)return o.value}return!0}(n.getContainerNode(),e))return void M(e)}T(e)}function T(e){(0,a.default)(e,(function(){(0,i.default)(e,(function(t){var n=(0,p.getSelectedBlockElementsInRegion)(t,void 0,e.isFeatureEnabled("DefaultFormatInSpan")),r=(0,p.collapseNodesInRegion)(t,n);if(e.contains(t.rootNode)){var i=E(t.rootNode);if((0,p.getObjectKeys)(i).length>0){var o=(0,p.wrap)((0,p.toArray)(t.rootNode.childNodes));(0,p.setStyles)(o,i)}}for(;r.length>0&&r[0].parentNode&&(0,p.isNodeInRegion)(t,r[0].parentNode);){var a=(0,p.splitBalancedNodeRange)(r);r=a?[a]:[]}r.forEach(b)})),P(e)}),"clearBlockFormat")}function P(e){var t=e.getDefaultFormat(),n=0===(0,p.getObjectKeys)(t).length;if(e.queryElements("[style]",2,(function(e){var t=(0,p.getTagOfNode)(e);-1==y.indexOf(t)?O(t,e,n):e.childNodes.forEach((function(e){e.childNodes.forEach((function(e){var t=(0,p.getTagOfNode)(e);(0,p.safeInstanceOf)(e,"HTMLElement")&&O(t,e,n)}))}))})),!n){if(t.fontFamily&&(0,s.default)(e,t.fontFamily),t.fontSize&&(0,u.default)(e,t.fontSize),t.textColor){var i=e.queryElements("a *, a",1),o=i.length>0?function(e){return-1==i.indexOf(e)}:void 0;t.textColors?(0,d.default)(e,t.textColors,o):(0,d.default)(e,t.textColor,o)}t.backgroundColor&&(t.backgroundColors?(0,l.default)(e,t.backgroundColors):(0,l.default)(e,t.backgroundColor)),t.bold?(0,c.default)(e):function(e,t){void 0===t&&(t="400"),(0,r.default)(e,"font-weight",(function(e){return e.style.fontWeight=t}),"setDefaultFontWeight")}(e),t.italic&&(0,f.default)(e),t.underline&&(0,h.default)(e)}}function O(e,t,n){-1==y.indexOf(e)&&(v.forEach((function(e){return t.style.removeProperty(e)})),n&&""===t.getAttribute("style")&&t.removeAttribute("style"))}function M(e,t){switch(void 0===t&&(t=0),t){case 0:!function(e){e.focus(),e.addUndoSnapshot((function(){return(0,o.default)(e,"removeFormat"),e.queryElements("[class]",1,(function(e){return e.removeAttribute("class")})),P(e),"clearInlineFormat"}),"Format")}(e);break;case 1:T(e);break;default:w(e)}}t.default=M},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42);t.default=function(e,t){(0,r.default)(e,"font-family",(function(e,n){e.style.fontFamily=n?"":t}),"setFontName")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42),i=n(0);t.default=function(e,t){(0,r.default)(e,"font-size",(function(e,n){e.style.fontSize=n?"":t;var r=(0,i.getComputedStyle)(e,"line-height");r&&"normal"!=r&&(e.style.lineHeight="normal")}),"setFontSize")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42),i=n(0);t.default=function(e,t,n){(0,r.default)(e,"color",(function(r,o){n&&!n(r)||(0,i.setColor)(r,o?"":t,!1,e.isDarkMode(),!1,e.getDarkColorHandler())}),"setTextColor")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);t.default=function(e){(0,r.default)(e,"bold","toggleBold")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);t.default=function(e){(0,r.default)(e,"italic","toggleItalic")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);t.default=function(e){(0,r.default)(e,"underline","toggleUnderline")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){if((0,r.safeInstanceOf)(e,"HTMLElement")){var n=e.style.textAlign,i=(0,r.findClosestElementAncestor)(e,void 0,"blockquote");if(!i)return;var o=(a=e,"rtl"==(0,r.getComputedStyle)(a,"direction")||"rtl"==a.getAttribute("dir"));if(t){if(t.indexOf(i)>-1)return;t.push(i)}for(;i;)"center"==n?o?(i.style.removeProperty("marginInlineEnd"),i.style.marginInlineStart="auto"):(i.style.removeProperty("marginInlineStart"),i.style.marginInlineEnd="auto"):(i.style.removeProperty("marginInlineEnd"),i.style.removeProperty("marginInlineStart")),i=(0,r.findClosestElementAncestor)(i.parentElement,void 0,"blockquote")}var a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26),i=n(0);t.default=function(e,t,n,o){(0,r.default)(e,(function(n){var r=(0,i.getSelectedBlockElementsInRegion)(n,!0,e.isFeatureEnabled("DefaultFormatInSpan")),o=(0,i.collapseNodesInRegion)(n,r);if(o.length>0){if(1==o.length){var a=(0,i.getTagOfNode)(o[0]);"BR"==a?o=[(0,i.wrap)(o[0])]:"LI"!=a&&"TD"!=a||(o=(0,i.toArray)(o[0].childNodes))}for(;o[0]&&o[0].parentNode&&(0,i.isNodeInRegion)(n,o[0].parentNode)&&o.some((function(e){return"LI"==(0,i.getTagOfNode)(e)}));){var l=(0,i.splitBalancedNodeRange)(o);o=l?[l]:[]}t(o)}}),n,o)}},function(e,t,n){"use strict";var r,i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var a=n(112),l=n(114),s=n(43),u=n(61),d=n(275),c=n(34),f=n(276),h=n(0),p=n(115),v=Math.PI,g=2*v/8,m=["nw","n","ne","e","se","s","sw","w"],y={borderColor:"#DB626C",minWidth:10,minHeight:10,preserveRatio:!1,minRotateDeg:5,imageSelector:"img",rotateIconHTML:"",disableCrop:!1,disableRotate:!1,disableSideResize:!1,onSelectState:7},b=((r={})[1]=p.getCornerResizeHTML,r[2]=p.getSideResizeHTML,r[4]=f.getRotateHTML,r[8]=d.getCropHTML,r),C=function(){function e(e,t){var n=this;this.onShowResizeHandle=t,this.editor=null,this.disposer=null,this.image=null,this.clonedImage=null,this.wrapper=null,this.editInfo=null,this.lastSrc=null,this.dndHelpers=[],this.wasResized=!1,this.shadowSpan=null,this.isCropping=!1,this.onBlur=function(){n.setEditingImage(null,!0)},this.removeWrapper=function(){n.shadowSpan&&(0,h.unwrap)(n.shadowSpan),n.wrapper=null,n.shadowSpan=null},this.updateWrapper=function(e){var t,r,i,o=n.wrapper;if(o&&n.editInfo&&n.image&&n.clonedImage&&n.options&&(null===(t=n.shadowSpan)||void 0===t?void 0:t.parentElement)){var a=w(o,"r_cropC"),l=w(o,"r_cropO"),s=w(o,"r_resizeH"),d=w(o,"r_rotateC")[0],c=w(o,"r_rotateH")[0],v=w(o,"r_cropH");n.isCropping=1==a.length&&4==l.length;var g=n.editInfo,m=g.angleRad,y=g.bottomPercent,b=g.leftPercent,C=g.rightPercent,T=g.topPercent,O=(0,u.default)(n.editInfo,n.isCropping),M=O.targetWidth,_=O.targetHeight,D=O.originalWidth,N=O.originalHeight,x=O.visibleWidth,k=O.visibleHeight,I=(M-x)/2,R=(_-k)/2,A=D*b,L=D*C,j=N*T,B=N*y;if(o.style.margin=R+"px "+I+"px",o.style.transform="rotate("+m+"rad)",function(e,t,n,r){if(t.style.borderStyle){var i=t.style.borderWidth?2*parseInt(t.style.borderWidth):2;return e.style.width=S(n+i),void(e.style.height=S(r+i))}e.style.width=S(n),e.style.height=S(r)}(o,n.image,x,k),o.style.textAlign=(i=n.shadowSpan.parentElement,(0,h.safeInstanceOf)(i,"HTMLElement")&&"rtl"==(0,h.getComputedStyle)(i,"direction")?"right":"left"),n.clonedImage.style.width=S(D),n.clonedImage.style.height=S(N),n.isCropping)E(a[0],A,j,L,B,void 0,void 0),E(l[0],0,0,L,void 0,void 0,j),E(l[1],void 0,0,0,B,L,void 0),E(l[2],A,void 0,0,0,void 0,B),E(l[3],0,j,void 0,0,A,void 0),P(v,m);else{if(n.clonedImage.style.margin=-j+"px 0 0 "+-A+"px","r_resizeH"==(null==e?void 0:e.elementClass)){var F=o.clientWidth,H=o.clientHeight;n.wasResized=!0,(0,p.doubleCheckResize)(n.editInfo,n.options.preserveRatio||!1,F,H),n.updateWrapper()}var z=null===(r=n.editor)||void 0===r?void 0:r.getVisibleViewport();c&&d&&z&&(0,f.updateRotateHandlePosition)(z,d,c),P(s,m)}}},this.options=i(i({},y),e||{}),this.allowedOperations=1|(this.options.disableCrop?0:8)|(this.options.disableRotate?0:4)|(this.options.disableSideResize?0:2)}return e.prototype.getName=function(){return"ImageEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=e.addDomEventHandler({blur:function(){return t.onBlur()},dragstart:function(e){t.image&&e.preventDefault()}})},e.prototype.dispose=function(){var e;this.clearDndHelpers(),null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 22:e.selectionRangeEx&&2===e.selectionRangeEx.type&&this.options&&void 0!==this.options.onSelectState&&this.setEditingImage(e.selectionRangeEx.image,this.options.onSelectState);break;case 5:var n=e.rawEvent.target,r=e.rawEvent.button;(this.shadowSpan!==n||this.shadowSpan===n&&0!==r||this.isCropping)&&this.setEditingImage(null);break;case 0:this.setEditingImage(null);break;case 7:this.removeWrapper();break;case 8:(null===(t=this.options)||void 0===t?void 0:t.imageSelector)&&(0,h.toArray)(e.clonedRoot.querySelectorAll(this.options.imageSelector)).forEach((function(e){(0,c.deleteEditInfo)(e)}));break;case 12:this.removeWrapper()}},e.prototype.isOperationAllowed=function(e){return!!(this.allowedOperations&e)},e.prototype.setEditingImage=function(e,t){var n=this,r="number"==typeof t?t:0,i="number"!=typeof t&&!!t;!e&&this.image&&this.editor&&this.editInfo&&this.lastSrc&&this.clonedImage&&(this.clearDndHelpers(),(0,a.default)(this.editor,this.image,this.editInfo,this.lastSrc,this.wasResized,this.clonedImage),this.removeWrapper(),this.editor.addUndoSnapshot((function(){return n.image}),"ImageResize"),i&&this.editor.select(this.image),this.image=null,this.editInfo=null,this.lastSrc=null,this.clonedImage=null,this.isCropping=!1),!this.image&&(null==e?void 0:e.isContentEditable)&&this.editor&&(this.editor.addUndoSnapshot(),this.image=e,this.editInfo=(0,c.getEditInfoFromImage)(e),this.wasResized=function(e){var t=e.width,n=e.height,r=e.style;return!(""!==r.maxWidth&&"initial"!==r.maxWidth&&"auto"!==r.maxWidth||!(O(r.height)||O(r.width)||O(t)||O(n)))}(this.image),r=((0,l.default)(e)?r:3)&this.allowedOperations,this.createWrapper(r),this.updateWrapper(),this.dndHelpers=o(o(o(o([],this.createDndHelpers("r_resizeH",p.Resizer),!0),this.createDndHelpers("r_rotateH",f.Rotator),!0),this.createDndHelpers("r_cropH",d.Cropper),!0),this.createDndHelpers("r_cropC",d.Cropper),!0),this.editor.select(this.image))},e.prototype.flipImage=function(e,t){var n;this.image=e,this.editInfo=(0,c.getEditInfoFromImage)(e);var r=this.editInfo.angleRad;r>=Math.PI/2&&r<3*Math.PI/4||r<=-Math.PI/2&&r>-3*Math.PI/4?"horizontal"===t?this.editInfo.flippedVertical=!this.editInfo.flippedVertical:this.editInfo.flippedHorizontal=!this.editInfo.flippedHorizontal:"vertical"===t?this.editInfo.flippedVertical=!this.editInfo.flippedVertical:this.editInfo.flippedHorizontal=!this.editInfo.flippedHorizontal,this.createWrapper(4),this.updateWrapper(),this.setEditingImage(null),null===(n=this.editor)||void 0===n||n.select(e)},e.prototype.rotateImage=function(e,t){var n;this.image=e,this.editInfo=(0,c.getEditInfoFromImage)(e),this.editInfo.angleRad=this.editInfo.angleRad+t,this.createWrapper(4),this.updateWrapper(),this.setEditingImage(null),null===(n=this.editor)||void 0===n||n.select(e)},e.prototype.createWrapper=function(e){var t,n,r,i,o,a,l,s,u=this;if(this.image&&this.editor&&this.options&&this.editInfo){this.clonedImage=this.image.cloneNode(!0),this.clonedImage.removeAttribute("id"),this.wrapper=(0,h.createElement)(6,this.image.ownerDocument),null===(n=null===(t=this.wrapper)||void 0===t?void 0:t.firstChild)||void 0===n||n.appendChild(this.clonedImage),this.wrapper.style.display=h.Browser.isSafari?"inline-block":"inline-flex",this.lastSrc=this.image.getAttribute("src"),this.clonedImage&&(this.clonedImage.src=this.editInfo.src,a=this.clonedImage,l=this.editInfo.flippedHorizontal,s=this.editInfo.flippedVertical,a.style.transform="scale("+(l?"-1":"1")+", "+(s?"-1":"1")+")",this.clonedImage.style.position="absolute");var d={borderColor:M(this.options.borderColor,this.editor.isDarkMode()),rotateIconHTML:this.options.rotateIconHTML,rotateHandleBackColor:this.editor.isDarkMode()?"#333":"white",isSmallImage:(r=this.editInfo,i=r.widthPx,o=r.heightPx,!!(i&&o&&i*i<1e4))},c=[(0,p.getResizeBordersHTML)(d)];(0,h.getObjectKeys)(b).forEach((function(t){var n=b[t](d,u.onShowResizeHandle);(e&t)==t&&n&&(0,h.arrayPush)(c,n)})),c.forEach((function(e){var t=(0,h.createElement)(e,u.image.ownerDocument);t&&u.wrapper&&u.wrapper.appendChild(t)})),this.insertImageWrapper(this.wrapper)}},e.prototype.insertImageWrapper=function(e){if(this.image){this.shadowSpan=(0,h.wrap)(this.image,"span");var t=this.shadowSpan.attachShadow({mode:"open"});this.shadowSpan.style.verticalAlign="bottom",t.appendChild(e)}},e.prototype.createDndHelpers=function(e,t){var n=this,r=this.wrapper;return r&&this.editInfo?w(r,e).map((function(r){return new s.default(r,{editInfo:n.editInfo,options:n.options,elementClass:e,x:r.dataset.x,y:r.dataset.y},n.updateWrapper,t,n.editor?n.editor.getZoomScale():1)})):[]},e.prototype.clearDndHelpers=function(){var e;null===(e=this.dndHelpers)||void 0===e||e.forEach((function(e){return e.dispose()})),this.dndHelpers=[]},e}();function E(e,t,n,r,i,o,a){e.style.left=void 0!==t?S(t):e.style.left,e.style.top=void 0!==n?S(n):e.style.top,e.style.right=void 0!==r?S(r):e.style.right,e.style.bottom=void 0!==i?S(i):e.style.bottom,e.style.width=void 0!==o?S(o):e.style.width,e.style.height=void 0!==a?S(a):e.style.height}function S(e){return e+"px"}function w(e,t){return(0,h.toArray)(e.querySelectorAll("."+t))}function T(e,t,n){var r=function(e){var t=Math.round(e/g)%8;return t<0?t+8:t}(n),i=e+t,o=m.indexOf(i),a=o>=0&&o+r;return a?m[a%8]:""}function P(e,t){e.map((function(e){var n=e.dataset.y,r=e.dataset.x;n&&r&&(e.style.cursor=T(n,r,t)+"-resize")}))}function O(e){var t="string"==typeof e?parseInt(e):e;return!isNaN(t)}function M(e,t){return"string"==typeof e?e.trim():t?e.darkModeColor.trim():e.lightModeColor.trim()}t.default=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(113),i=n(274),o=n(61),a=n(34);t.default=function(e,t,n,l,s,u){var d="",c=(0,a.getEditInfoFromImage)(null!=u?u:t),f=(0,r.default)(n,c);switch(f){case 1:d=n.src;break;case 2:d=l;break;case 3:d=(0,i.default)(null!=u?u:t,n)}d!=l&&(d=e.triggerPluginEvent(19,{image:t,originalSrc:n.src,previousSrc:l,newSrc:d}).newSrc),d==n.src?(0,a.deleteEditInfo)(t):(0,a.saveEditInfo)(t,n);var h=(0,o.default)(n),p=h.targetWidth,v=h.targetHeight;t.src=d,(s||3==f)&&(t.width=p,t.height=v,t.style.width=p+"px",t.style.height=v+"px")}},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var i=["angleRad"],o=["leftPercent","rightPercent","topPercent","bottomPercent"],a=r(r([],i,!0),o,!0),l=r(r([],a,!0),["widthPx","heightPx"],!0);function s(e,t){return Math.abs(e-t)<.001}t.default=function(e,t){return e&&e.src&&!l.some((function(t){return!("number"==typeof e[t])}))?!a.every((function(t){return s(e[t],0)}))||e.flippedHorizontal||e.flippedVertical||t&&(!t||e.angleRad!==t.angleRad)?t&&i.every((function(t){return s(e[t],0)}))&&i.every((function(e){return s(t[e],0)}))&&o.every((function(n){return s(e[n],t[n])}))&&t.flippedHorizontal===e.flippedHorizontal&&t.flippedVertical===e.flippedVertical?2:3:1:0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)return!1;try{var t=e.ownerDocument.createElement("canvas");t.width=10,t.height=10;var n=t.getContext("2d");return!!n&&(n.drawImage(e,0,0),n.getImageData(0,0,1,1),!0)}catch(e){return!1}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getResizeBordersHTML=t.getSideResizeHTML=t.getCornerResizeHTML=t.doubleCheckResize=t.rotateCoordinate=t.Resizer=void 0;var i=["w","","e"],o=["s","","n"];function a(e,t,n){if(0==e&&0==t)return[0,0];var r=Math.sqrt(e*e+t*t);return n=Math.atan2(t,e)-n,[r*Math.cos(n),r*Math.sin(n)]}function l(e,t,n,r){var i="w"==e?"left":"right",o="n"==t?"top":"bottom",a=t+e;return""==e&&""==t?null:{tag:"div",style:"position:absolute;"+i+":"+(""==e?"50%":"0px")+";"+o+":"+(""==t?"50%":"0px"),children:[{tag:"div",style:s[r](a,o,i,n),className:"r_resizeH",dataset:{x:e,y:t}}]}}t.Resizer={onDragStart:function(e){var t=e.editInfo;return r({},t)},onDragging:function(e,t,n,r,i){var o,l=e.x,s=e.y,u=e.editInfo,d=e.options,c=n.widthPx>0&&n.heightPx>0?1*n.widthPx/n.heightPx:0;if(r=(o=a(r,i,u.angleRad))[0],i=o[1],void 0!==d.minWidth&&void 0!==d.minHeight){var f=""==l,h=""==s,p=!(f||h)&&(d.preserveRatio||t.shiftKey),v=f?n.widthPx:Math.max(n.widthPx+r*("w"==l?-1:1),d.minWidth),g=h?n.heightPx:Math.max(n.heightPx+i*("n"==s?-1:1),d.minHeight);return p&&c>0&&(c>1?(v=g*c)<d.minWidth&&(g=(v=d.minWidth)/c):(g=v/c)<d.minHeight&&(v=(g=d.minHeight)*c)),u.widthPx=v,u.heightPx=g,!0}return!1}},t.rotateCoordinate=a,t.doubleCheckResize=function(e,t,n,r){var i=e.widthPx,o=e.heightPx,a=o>0?i/o:0;n=Math.floor(n),r=Math.floor(r),i=Math.floor(i),o=Math.floor(o),e.widthPx=n,e.heightPx=r,t&&a>0&&(i!==n||o!==r)&&(n<i?e.heightPx=n/a:e.widthPx=r*a)},t.getCornerResizeHTML=function(e,t){var n=e.borderColor,r=[];return i.forEach((function(e){return o.forEach((function(i){var o=""==e==(""==i)?l(e,i,n,1):null;t&&o&&t(o,e,i),o&&r.push(o)}))})),r},t.getSideResizeHTML=function(e,t){var n=e.borderColor;if(e.isSmallImage)return null;var r=[];return i.forEach((function(e){return o.forEach((function(i){var o=""==e!=(""==i)?l(e,i,n,1):null;t&&o&&t(o,e,i),o&&r.push(o)}))})),r},t.getResizeBordersHTML=function(e){return{tag:"div",style:"position:absolute;left:0;right:0;top:0;bottom:0;border:solid 2px "+e.borderColor+";pointer-events:none;"}};var s={0:function(e,t,n,r){return"position:relative;width:10px;height:10px;background-color: "+r+";cursor:"+e+"-resize;"+n+":-3px;"+t+":-3px;"},1:function(e,t,n){return"position:relative;width:10px;height:10px;background-color: #FFFFFF;cursor:"+e+"-resize;"+n+":-3px;"+t+":-3px;border-radius:100%;border: 2px solid #bfbfbf;box-shadow: 0px 0.36316px 1.36185px rgba(100, 100, 100, 0.25);"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.naturalWidth,r=e.naturalHeight,i=e.leftPercent,o=e.topPercent;return{width:n*(1-i-e.rightPercent)*t,height:r*(1-o-e.bottomPercent)*t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(116),i=n(34);t.default=function(e,t){var n=(0,i.getEditInfoFromImage)(e);if(n){var o=(0,r.default)(n,t),a=o.width,l=o.height;return Math.round(a)==Math.round(n.widthPx)&&Math.round(l)==Math.round(n.heightPx)}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getObject=t.setObject=t.createCustomData=void 0;function r(e,t){var n=t.getAttribute("NodeId");return n||(n=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute("NodeId",n)),n}t.createCustomData=function(){return{dict:{},nextNodeId:1}},t.setObject=function(e,t,n,i){if(1==t.nodeType){var o=r(e,t);""!=o&&(e.dict[o]||(e.dict[o]={}),e.dict[o][n]=i)}},t.getObject=function(e,t,n){if(1==t.nodeType){var i=r(e,t);if(""!=i)return e.dict[i]&&e.dict[i][n]}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLevelLists=void 0,t.createLevelLists=function(){return{listsMetadata:{},currentUniqueListId:-1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createEditor=void 0;var o=n(126);Object.defineProperty(t,"createEditor",{enumerable:!0,get:function(){return o.default}}),i(n(333),t),i(n(335),t),i(n(0),t),i(n(62),t),i(n(9),t),i(n(100),t),i(n(97),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(62),i=n(97),o=n(100);t.default=function(e,t,n){var a=[new o.HyperLink,new o.Paste,new o.ContentEdit];t&&(a=a.concat(t));var l={plugins:a,initialContent:n,getDarkColor:i.getDarkColor,defaultFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new r.Editor(e,l)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(128),o=n(188),a=n(189),l=n(0),s=function(){function e(e,t){var n,s=this;if(void 0===t&&(t={}),this.core=null,"DIV"!=(0,l.getTagOfNode)(e))throw new Error("contentDiv must be an HTML DIV element");var u=(0,i.default)(e,t),d=[];(0,l.getObjectKeys)(u).forEach((function(e){"_placeholder"==e?t.plugins&&(0,l.arrayPush)(d,t.plugins):d.push(u[e])}));var c=(null!==(n=t.zoomScale)&&void 0!==n?n:-1)>0?t.zoomScale:1;this.core=r(r({contentDiv:e,api:r(r({},a.coreApiMap),t.coreApiOverride||{}),originalApi:a.coreApiMap,plugins:d.filter((function(e){return!!e}))},(0,i.getPluginState)(u)),{trustedHTMLHandler:t.trustedHTMLHandler||function(e){return e},zoomScale:c,sizeTransformer:t.sizeTransformer||function(e){return e/c},getVisibleViewport:t.getVisibleViewport||function(){var t=s.getScrollContainer();return(0,l.getIntersectedRect)(t==e?[t]:[t,e])},imageSelectionBorderColor:t.imageSelectionBorderColor}),this.isFeatureEnabled("VariableBasedDarkColor")&&(this.core.darkColorHandler=new o.default(e,this.core.lifecycle.getDarkColor)),this.core.plugins.forEach((function(e){return e.initialize(s)})),this.ensureTypeInContainer(new l.Position(this.core.contentDiv,0).normalize())}return e.prototype.dispose=function(){for(var e,t=this.getCore(),n=t.plugins.length-1;n>=0;n--)t.plugins[n].dispose();null===(e=t.darkColorHandler)||void 0===e||e.reset(),this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){var n=this.getCore();return!!e&&n.api.insertNode(n,e,null!=t?t:null)},e.prototype.deleteNode=function(e){return!!(e&&this.contains(e)&&e.parentNode)&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t,n){var r=this.getCore();return!(!this.contains(e)||!t)&&(r.api.transformColor(r,n?t:null,!0,(function(){var n;return null===(n=e.parentNode)||void 0===n?void 0:n.replaceChild(t,e)}),0),!0)},e.prototype.getBlockElementAtNode=function(e){return(0,l.getBlockElementAtNode)(this.getCore().contentDiv,e)},e.prototype.contains=function(e){return!!e&&(0,l.contains)(this.getCore().contentDiv,e)},e.prototype.queryElements=function(e,t,n){void 0===t&&(t=0);var r=this.getCore(),i=[],o=t instanceof Function?0:t;n=t instanceof Function?t:n;var a=0==o?null:this.getSelectionRangeEx();return a?(a.ranges.forEach((function(t){i.push.apply(i,(0,l.queryElements)(r.contentDiv,e,n,o,t))})),i):(0,l.queryElements)(r.contentDiv,e,n,o,void 0)},e.prototype.collapseNodes=function(e,t,n){return(0,l.collapseNodes)(this.getCore().contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return(0,l.isNodeEmpty)(this.getCore().contentDiv,e)},e.prototype.getContent=function(e){void 0===e&&(e=0);var t=this.getCore();return t.api.getContent(t,e)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0);var n=this.getCore();n.api.setContent(n,e,t)},e.prototype.insertContent=function(e,t){var n;if(e){var r=this.getDocument(),i=null===(n=(new DOMParser).parseFromString(this.getCore().trustedHTMLHandler(e),"text/html"))||void 0===n?void 0:n.body,o=(null==i?void 0:i.childNodes)?(0,l.toArray)(i.childNodes):[];t&&t.insertOnNewLine&&o.length>1&&(o=[(0,l.wrap)(o)]);var a=r.createDocumentFragment();o.forEach((function(e){return a.appendChild(e)})),this.insertNode(a,t)}},e.prototype.deleteSelectedContent=function(){var e=this.getSelectionRange();return e&&!e.collapsed?(0,l.deleteSelectedContent)(this.getCore().contentDiv,e):null},e.prototype.paste=function(e,t,n){var r=this;void 0===t&&(t=!1),void 0===n&&(n=!1);var i=this.getCore();if(e){e.snapshotBeforePaste?this.setContent(e.snapshotBeforePaste):e.snapshotBeforePaste=this.getContent(2);var o=this.getSelectionRange(),a=o&&l.Position.getStart(o),s=i.api.createPasteFragment(i,e,a,t,n);s&&this.addUndoSnapshot((function(){return r.insertNode(s),e}),"Paste")}},e.prototype.getSelectionRange=function(e){void 0===e&&(e=!0);var t=this.getCore();return t.api.getSelectionRange(t,e)},e.prototype.getSelectionRangeEx=function(){var e=this.getCore();return e.api.getSelectionRangeEx(e)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&(0,l.getSelectionPath)(this.getCore().contentDiv,e)},e.prototype.hasFocus=function(){var e=this.getCore();return e.api.hasFocus(e)},e.prototype.focus=function(){var e=this.getCore();e.api.focus(e)},e.prototype.select=function(e,t,n,r){var i,o=this.getCore(),a=null;if(function(e){var t=e;return t&&"object"==typeof t&&"number"==typeof t.type&&Array.isArray(t.ranges)}(e))a=e;else if((0,l.safeInstanceOf)(e,"HTMLTableElement")&&((i=t)&&"object"==typeof i&&"object"==typeof i.firstCell&&"object"==typeof i.lastCell))a={type:1,ranges:[],areAllCollapsed:!1,table:e,coordinates:t};else if((0,l.safeInstanceOf)(e,"HTMLImageElement")&&void 0===t)a={type:2,ranges:[],areAllCollapsed:!1,image:e};else{var s=e?(0,l.safeInstanceOf)(e,"Range")?e:function(e){var t=e;return t&&"object"==typeof t&&Array.isArray(t.start)&&Array.isArray(t.end)}(e)?(0,l.createRange)(o.contentDiv,e.start,e.end):function(e){var t=e;return t&&"object"==typeof t&&"object"==typeof t.node&&"number"==typeof t.offset}(e)||(0,l.safeInstanceOf)(e,"Node")?(0,l.createRange)(e,t,n,r):null:null;a=s?{type:0,ranges:[s],areAllCollapsed:s.collapsed}:null}if(a){switch(a.type){case 1:this.contains(a.table)&&(o.domEvent.imageSelectionRange=o.api.selectImage(o,null),o.domEvent.tableSelectionRange=o.api.selectTable(o,a.table,a.coordinates),a=o.domEvent.tableSelectionRange);break;case 2:this.contains(a.image)&&(o.domEvent.tableSelectionRange=o.api.selectTable(o,null),o.domEvent.imageSelectionRange=o.api.selectImage(o,a.image),a=o.domEvent.imageSelectionRange);break;case 0:o.domEvent.tableSelectionRange=o.api.selectTable(o,null),o.domEvent.imageSelectionRange=o.api.selectImage(o,null),this.contains(a.ranges[0])?o.api.selectRange(o,a.ranges[0]):a=null}this.triggerPluginEvent(22,{selectionRangeEx:a},!0)}else o.domEvent.tableSelectionRange=o.api.selectTable(o,null),o.domEvent.imageSelectionRange=o.api.selectImage(o,null);return!!a},e.prototype.getFocusedPosition=function(){var e,t=null===(e=this.getDocument().defaultView)||void 0===e?void 0:e.getSelection();if((null==t?void 0:t.focusNode)&&this.contains(t.focusNode))return new l.Position(t.focusNode,t.focusOffset);var n=this.getSelectionRange();return n?l.Position.getStart(n):null},e.prototype.getElementAtCursor=function(e,t,n){var r,i=this;return n=t?void 0:n,null!==(r=(0,l.cacheGetEventData)(null!=n?n:null,"GET_ELEMENT_AT_CURSOR_"+e,(function(){if(!t){var n=i.getFocusedPosition();t=null==n?void 0:n.node}return t&&(0,l.findClosestElementAncestor)(t,i.getCore().contentDiv,e)})))&&void 0!==r?r:null},e.prototype.isPositionAtBeginning=function(e){return(0,l.isPositionAtBeginningOf)(e,this.getCore().contentDiv)},e.prototype.getSelectedRegions=function(e){void 0===e&&(e=0);var t=this.getSelectionRangeEx(),n=[],r=this.getCore().contentDiv;return t.ranges.forEach((function(t){n.push.apply(n,t?(0,l.getRegionsFromRange)(r,t,e):[])})),n.filter((function(e,t,n){return n.indexOf(e)===t}))},e.prototype.addDomEventHandler=function(e,t){var n,r="string"==typeof e?((n={})[e]=t,n):e,i=this.getCore();return i.api.attachDomEvent(i,r)},e.prototype.triggerPluginEvent=function(e,t,n){void 0===n&&(n=!1);var i=this.getCore(),o=r({eventType:e},t);return i.api.triggerEvent(i,o,n),o},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerPluginEvent(7,{source:e,data:t})},e.prototype.undo=function(){this.focus();var e=this.getCore();e.api.restoreUndoSnapshot(e,-1)},e.prototype.redo=function(){this.focus();var e=this.getCore();e.api.restoreUndoSnapshot(e,1)},e.prototype.addUndoSnapshot=function(e,t,n,r){var i=this.getCore();i.api.addUndoSnapshot(i,null!=e?e:null,null!=t?t:null,null!=n&&n,r)},e.prototype.getUndoState=function(){var e=this.getCore().undo,t=e.hasNewContent,n=e.snapshotsService;return{canUndo:t||n.canMove(-1),canRedo:n.canMove(1)}},e.prototype.getDocument=function(){return this.getCore().contentDiv.ownerDocument},e.prototype.getScrollContainer=function(){return this.getCore().domEvent.scrollContainer},e.prototype.getCustomData=function(e,t,n){var r=this.getCore();return(r.lifecycle.customData[e]=r.lifecycle.customData[e]||{value:t?t():void 0,disposer:n}).value},e.prototype.isInIME=function(){return this.getCore().domEvent.isInIME},e.prototype.getDefaultFormat=function(){var e;return null!==(e=this.getCore().lifecycle.defaultFormat)&&void 0!==e?e:{}},e.prototype.getBodyTraverser=function(e){return l.ContentTraverser.createBodyTraverser(this.getCore().contentDiv,e)},e.prototype.getSelectionTraverser=function(e){var t;return(e=null!==(t=null!=e?e:this.getSelectionRange())&&void 0!==t?t:void 0)?l.ContentTraverser.createSelectionTraverser(this.getCore().contentDiv,e):null},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t?l.ContentTraverser.createBlockTraverser(this.getCore().contentDiv,t,e):null},e.prototype.getContentSearcherOfCursor=function(e){var t=this;return(0,l.cacheGetEventData)(null!=e?e:null,"ContentSearcher",(function(){var e=t.getSelectionRange();return e&&new l.PositionContentSearcher(t.getCore().contentDiv,l.Position.getStart(e))}))},e.prototype.runAsync=function(e){var t=this,n=this.getCore().contentDiv.ownerDocument.defaultView||window,r=n.requestAnimationFrame((function(){!t.isDisposed()&&e&&e(t)}));return function(){n.cancelAnimationFrame(r)}},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.getCore().contentDiv.removeAttribute(e):this.getCore().contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.getCore().contentDiv.getAttribute(e)},e.prototype.getRelativeDistanceToEditor=function(e,t){if(this.contains(e)){var n=this.getCore().contentDiv,r=n.getBoundingClientRect(),i=e.getBoundingClientRect();if(r&&i){var o=i.left-(null==r?void 0:r.left),a=i.top-(null==r?void 0:r.top);return t&&(o+=n.scrollLeft,a+=n.scrollTop),[o,a]}}return null},e.prototype.addContentEditFeature=function(e){var t=this.getCore();null==e||e.keys.forEach((function(n){var r=t.edit.features[n]||[];r.push(e),t.edit.features[n]=r}))},e.prototype.removeContentEditFeature=function(e){var t=this.getCore();null==e||e.keys.forEach((function(n){var r,i=t.edit.features[n],o=null!==(r=null==i?void 0:i.indexOf(e))&&void 0!==r?r:-1;o>=0&&(t.edit.features[n].splice(o,1),t.edit.features[n].length<1&&delete t.edit.features[n])}))},e.prototype.getStyleBasedFormatState=function(e){var t;if(!e){var n=this.getSelectionRange();e=null!==(t=n&&l.Position.getStart(n).normalize().node)&&void 0!==t?t:void 0}var r=this.getCore();return r.api.getStyleBasedFormatState(r,null!=e?e:null)},e.prototype.getPendableFormatState=function(e){void 0===e&&(e=!1);var t=this.getCore();return t.api.getPendableFormatState(t,e)},e.prototype.ensureTypeInContainer=function(e,t){var n=this.getCore();n.api.ensureTypeInContainer(n,e,t,this.isFeatureEnabled("DefaultFormatInSpan"))},e.prototype.setDarkModeState=function(e){var t=this.isDarkMode();if(t!=!!e){var n=this.getCore();n.api.transformColor(n,n.contentDiv,!1,null,e?0:1,!0,t),this.triggerContentChangedEvent(e?"SwitchToDarkMode":"SwitchToLightMode")}},e.prototype.isDarkMode=function(){return this.getCore().lifecycle.isDarkMode},e.prototype.transformToDarkColor=function(e){var t=this.getCore();t.api.transformColor(t,e,!0,null,0)},e.prototype.getDarkColorHandler=function(){return this.getCore().darkColorHandler||null},e.prototype.startShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!0)},e.prototype.stopShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!1)},e.prototype.isInShadowEdit=function(){return!!this.getCore().lifecycle.shadowEditFragment},e.prototype.isFeatureEnabled=function(e){return this.getCore().lifecycle.experimentalFeatures.indexOf(e)>=0},e.prototype.getTrustedHTMLHandler=function(){return this.getCore().trustedHTMLHandler},e.prototype.getSizeTransformer=function(){return this.getCore().sizeTransformer},e.prototype.getZoomScale=function(){return this.getCore().zoomScale},e.prototype.setZoomScale=function(e){var t=this.getCore();if(e>0&&e<=10){var n=t.zoomScale;t.zoomScale=e,n!=e&&this.triggerPluginEvent(21,{oldZoomScale:n,newZoomScale:e},!0)}},e.prototype.getVisibleViewport=function(){return this.getCore().getVisibleViewport()},e.prototype.getCore=function(){if(!this.core)throw new Error("Editor is already disposed");return this.core},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPluginState=void 0;var r=n(129),i=n(177),o=n(178),a=n(179),l=n(181),s=n(182),u=n(183),d=n(184),c=n(185),f=n(186),h=n(187);t.default=function(e,t){var n=t.corePluginOverride||{};return{typeInContainer:n.typeInContainer||new f.default,edit:n.edit||new o.default,pendingFormatState:n.pendingFormatState||new c.default,_placeholder:null,typeAfterLink:null,undo:n.undo||new h.default(t),domEvent:n.domEvent||new i.default(t,e),mouseUp:n.mouseUp||new u.default,copyPaste:n.copyPaste||new r.default(t),entity:n.entity||new a.default,imageSelection:n.imageSelection||new l.default,normalizeTable:n.normalizeTable||new d.default,lifecycle:n.lifecycle||new s.default(t,e)}},t.getPluginState=function(e){return{domEvent:e.domEvent.getState(),pendingFormatState:e.pendingFormatState.getState(),edit:e.edit.getState(),lifecycle:e.lifecycle.getState(),undo:e.undo.getState(),entity:e.entity.getState(),copyPaste:e.copyPaste.getState()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(130),i=n(131),o=n(0),a=function(){function e(e){var t=this;this.editor=null,this.disposer=null,this.onPaste=function(e){var n,r=null;if(t.editor){var i=t.editor;(0,o.extractClipboardEvent)(e,(function(e){i&&!i.isDisposed()&&i.paste(e)}),{allowedCustomPasteType:t.state.allowedCustomPasteType,getTempDiv:function(){var e;return r=null!==(e=i.getSelectionRange())&&void 0!==e?e:null,t.getTempDiv(i)},removeTempDiv:function(e){r&&t.cleanUpAndRestoreSelection(e,r,!1)}},null!==(n=t.editor.getSelectionRange())&&void 0!==n?n:void 0)}},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[]}}return e.prototype.getName=function(){return"CopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:function(e){return t.onPaste(e)},copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},e.prototype.dispose=function(){this.disposer&&this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onCutCopy=function(e,t){var n=this;if(this.editor){var r=this.editor.getSelectionRangeEx();if(r&&!r.areAllCollapsed){var i=this.editor.getContent(2),a=this.getTempDiv(this.editor,!0),l=(0,o.setHtmlWithMetadata)(a,i,this.editor.getTrustedHTMLHandler()),s=null;if(1===r.type&&r.coordinates){var u=a.querySelector("#"+r.table.id);s=this.createTableRange(u,r.coordinates),t&&this.deleteTableContent(this.editor,r.table,r.coordinates)}else if(2===r.type){var d=a.querySelector("#"+r.image.id);d&&(s=(0,o.createRange)(d),t&&this.deleteImage(this.editor,r.image.id))}else s=0===(null==l?void 0:l.type)?(0,o.createRange)(a,l.start,l.end):null;if(s)this.editor.triggerPluginEvent(9,{clonedRoot:a,range:s,rawEvent:e,isCut:t}).range&&(0,o.addRangeToSelection)(s),this.editor.runAsync((function(e){n.cleanUpAndRestoreSelection(a,r,!t),t&&e.addUndoSnapshot((function(){var t=e.deleteSelectedContent();e.focus(),e.select(t)}),"Cut")}))}}},e.prototype.getTempDiv=function(e,t){var n=e.getCustomData("CopyPasteTempDiv",(function(){var t=(0,o.createElement)(3,e.getDocument());return e.getDocument().body.appendChild(t),t}),(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}));return t&&(n.style.backgroundColor="white",n.style.color="black"),n.style.display="",n.focus(),n},e.prototype.cleanUpAndRestoreSelection=function(e,t,n){var r,i,a;if((null===(r=t)||void 0===r?void 0:r.type)||0==t.type){var l=t;switch(l.type){case 1:case 2:null===(i=this.editor)||void 0===i||i.select(l);break;case 0:var s=null===(a=l.ranges)||void 0===a?void 0:a[0];this.restoreRange(s,n)}}else this.restoreRange(t,n);e.style.backgroundColor="",e.style.color="",e.style.display="none",(0,o.moveChildNodes)(e)},e.prototype.restoreRange=function(e,t){e&&this.editor&&(t&&o.Browser.isAndroid&&e.collapse(),this.editor.select(e))},e.prototype.createTableRange=function(e,t){var n=new o.VTable(e);return n.selection=t,(0,i.removeCellsOutsideSelection)(n),n.writeBack(),(0,o.createRange)(n.table)},e.prototype.deleteTableContent=function(e,t,n){var i=new o.VTable(t);i.selection=n,(0,r.forEachSelectedCell)(i,(function(t){(null==t?void 0:t.td)&&(t.td.innerHTML=e.getTrustedHTMLHandler()("<br>"))}));var a=(0,o.isWholeTableSelected)(i,n),l=t.rows.length-1===n.lastCell.y&&0===n.firstCell.y;a?(i.edit(4),i.writeBack()):l&&(i.edit(5),i.writeBack()),(a||l)&&(t.style.removeProperty("width"),t.style.removeProperty("height"))},e.prototype.deleteImage=function(e,t){e.queryElements("#"+t,(function(t){e.deleteNode(t)}))},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachSelectedCell=void 0;t.forEachSelectedCell=function(e,t){var n;if(e.selection)for(var r=e.selection,i=r.lastCell,o=r.firstCell,a=o.y;a<=i.y;a++)for(var l=o.x;l<=i.x;l++)e.cells&&(null===(n=e.cells[a][l])||void 0===n?void 0:n.td)&&t(e.cells[a][l])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeCellsOutsideSelection=void 0;var r=n(0);t.removeCellsOutsideSelection=function(e){if(e.selection){if((0,r.isWholeTableSelected)(e,e.selection))return;e.table.style.removeProperty("width"),e.table.style.removeProperty("height");var t=e.selection,n=t.firstCell,i=t.lastCell,o=[],a=n.x,l=n.y,s=i.x,u=i.y;e.cells&&(e.cells.forEach((function(e,t){(e=e.filter((function(e,n){return t>=l&&t<=u&&n>=a&&n<=s}))).length>0&&o.push(e)})),e.cells=o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(27),i=n(4),o=n(11),a=n(2),l=n(28),s=n(14),u=n(16),d=n(17),c=["TD","TH","LI","BLOCKQUOTE"],f=function(){function e(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}return e.getBlockContext=function(e){for(var t=e;t&&!(0,l.default)(t);)t=t.parentNode;return t},e.prototype.collapseToSingleElement=function(){for(var t=e.getBlockContext(this.startNode),n=t?(0,r.default)(t,this.startNode,this.endNode,!0):[],i=e.getBlockContext(this.startNode);n[0]&&n[0]!=i&&n[0].parentNode!=this.rootNode&&c.indexOf((0,a.default)(n[0].parentNode))<0;){var o=(0,d.splitBalancedNodeRange)(n);if(!o)break;n=[o]}return 1==n.length&&(0,l.default)(n[0])?n[0]:(0,u.default)(n)},e.prototype.getStartNode=function(){return this.startNode},e.prototype.getEndNode=function(){return this.endNode},e.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},e.prototype.isAfter=function(e){return(0,s.default)(this.getStartNode(),e.getEndNode())},e.prototype.contains=function(e){return(0,i.default)(this.startNode,e,!0)||(0,i.default)(this.endNode,e,!0)||(0,s.default)(e,this.startNode)&&(0,s.default)(this.endNode,e)},e.prototype.getTextContent=function(){var e=(0,o.default)(this.getStartNode(),this.getEndNode());return e?e.toString():""},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(7),o=n(66),a=n(21),l=n(68),s=function(){function e(e,t){this.rootNode=e,this.startNode=(0,r.default)(e,t)?t:null}return e.prototype.getStartBlockElement=function(){return this.startNode?(0,i.default)(this.rootNode,this.startNode):(0,o.default)(this.rootNode,!0)},e.prototype.getStartInlineElement=function(){return this.startNode?(0,a.default)(this.rootNode,this.startNode):(0,l.getFirstInlineElement)(this.rootNode)},e.prototype.isBlockInScope=function(e){return(0,r.default)(this.rootNode,e.getStartNode())},e.prototype.trimInlineElement=function(e){return e},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(70),i=n(7),o=n(21),a=n(63),l=n(5),s=n(1),u=n(48),d=n(68),c=function(){function e(e,t,n){this.rootNode=e,this.startFrom=n,(0,s.default)(t,"Range")&&(t=l.default.getStart(t)),this.position=t.normalize(),this.block=(0,i.default)(this.rootNode,this.position.node)}return e.prototype.getStartBlockElement=function(){return this.block},e.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:case 2:return function(e,t){if(e instanceof a.default){var n=e.getStartNode();return t?(0,d.getFirstInlineElement)(n):(0,d.getLastInlineElement)(n)}return(0,o.default)(e,t?e.getStartNode():e.getEndNode())}(this.block,0==this.startFrom);case 3:var e=(0,u.getInlineElementAfter)(this.rootNode,this.position);return e&&this.block.contains(e.getContainerNode())?e:new r.default(this.position,this.block)}return null},e.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},e.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=n(37),o=n(5),a=n(48),l=function(){function e(e,t){this.rootNode=e,this.startBlock=null,this.startInline=null,this.start=o.default.getStart(t).normalize(),this.end=o.default.getEnd(t).normalize()}return e.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=(0,r.default)(this.rootNode,this.start.node)),this.startBlock},e.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement((0,a.getInlineElementAfter)(this.rootNode,this.start))),this.startInline},e.prototype.isBlockInScope=function(e){if(!e)return!1;var t=!1,n=this.getStartBlockElement();if(this.start.equalTo(this.end))t=!!n&&n.equals(e);else{var i=(0,r.default)(this.rootNode,this.end.node);t=!!n&&!!i&&(e.equals(n)||e.equals(i)||e.isAfter(n)&&i.isAfter(e))}return t},e.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var r=!1,o=!1;return this.start.isAfter(t)&&(t=this.start,r=!0),n.isAfter(this.end)&&(n=this.end,o=!0),t.isAfter(n)||t.equalTo(n)?null:r||o?new i.default(e,r?t:void 0,o?n:void 0):e},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addDelimiterBefore=t.addDelimiterAfter=void 0;var r=n(18),i=n(72);function o(e){return s(e,"entityDelimiterAfter")}function a(e){return s(e,"entityDelimiterBefore")}function l(e,t){return e&&(0,i.default)(e)&&e.classList.contains(t)?e:void 0}function s(e,t){var n=(0,r.default)({tag:"span",className:t,children:[""]},e.ownerDocument);if(n){var i="entityDelimiterAfter"==t?"afterend":"beforebegin";e.insertAdjacentElement(i,n)}return n}t.default=function(e){var t,n,r,i,s=(n=[],r=(t=e).nextElementSibling,i=t.previousElementSibling,n.push(l(r,"entityDelimiterAfter"),l(i,"entityDelimiterBefore")),n),u=s[0],d=s[1];return u||(u=o(e)),d||(d=a(e)),[u,d]},t.addDelimiterAfter=o,t.addDelimiterBefore=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(73),i=n(74),o=n(6),a=n(19);t.default=function(e,t,n,l){var s,u=e.clipboardData||(null===(s=e.target.ownerDocument)||void 0===s?void 0:s.defaultView).clipboardData;u.items?(e.preventDefault(),(0,r.default)((0,o.default)(u.items),n).then((function(e){var n;n=l,a.Browser.isAndroid&&n&&n.deleteContents(),t(e)}))):(0,i.default)(u,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(50);t.default=function(e,t,n,i){if(t){var o=e.style,a=t.fontFamily,l=t.fontSize,s=t.textColor,u=t.textColors,d=t.backgroundColor,c=t.backgroundColors,f=t.bold,h=t.italic,p=t.underline;a&&(o.fontFamily=a),l&&(o.fontSize=l),u?(0,r.default)(e,u,!1,n,!1,i):s&&(0,r.default)(e,s,!1,n,!1,i),c?(0,r.default)(e,c,!0,n,!1,i):d&&(0,r.default)(e,d,!0,n,!1,i),f&&(o.fontWeight="bold"),h&&(o.fontStyle="italic"),p&&(o.textDecoration="underline")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendableFormatCommandMap=void 0;var r=n(8);t.PendableFormatCommandMap={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"},t.default=function(e){return(0,r.default)(t.PendableFormatCommandMap).reduce((function(n,r){return n[r]=e.queryCommandState(t.PendableFormatCommandMap[r]),n}),{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,o="(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)*[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",a={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+o+"|www\\."+o,"i"),except:i,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+o,"i"),except:i},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+o+"|ftp\\."+o,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+o,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+o,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+o,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+o,"i")}};t.default=function(e){if(e)for(var t=0,n=(0,r.default)(a);t<n.length;t++){var i=n[t],o=a[i],l=e.match(o.match);if(l&&l[0]==e&&(!o.except||!o.except.test(e)))return{scheme:i,originalUrl:e,normalizedUrl:o.normalizeUrl?o.normalizeUrl(e):e}}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(40);t.default=function(e,t){void 0===t&&(t=[]);var n=e.map((function(e){return(0,r.default)(e.getBoundingClientRect())})).concat(t).filter((function(e){return!!e})),i={top:Math.max.apply(Math,n.map((function(e){return e.top}))),bottom:Math.min.apply(Math,n.map((function(e){return e.bottom}))),left:Math.max.apply(Math,n.map((function(e){return e.left}))),right:Math.min.apply(Math,n.map((function(e){return e.right})))};return i.top<i.bottom&&i.left<i.right?i:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),i=n(50),o=n(51),a="transparent";function l(e){var t;return!!e.td&&!!(null===(t=(0,o.getTableCellMetadata)(e.td))||void 0===t?void 0:t.bgColorOverride)}function s(e){return"solid 1px "+(e||"transparent")}t.default=function(e,t,n){n&&(e.style.borderCollapse="collapse",function(e,t){e.forEach((function(n,r){n.forEach((function(i,o){i.td&&function(e,t,n,r,i,o){switch(function(e,t){e.style.borderTop=s(t.topBorderColor),e.style.borderLeft=s(t.verticalBorderColor),e.style.borderRight=s(t.verticalBorderColor),e.style.borderBottom=s(t.bottomBorderColor)}(t,e),e.tableBorderFormat){case 0:return;case 1:i||(t.style.borderLeftColor=a),o||(t.style.borderRightColor=a);break;case 4:n||(t.style.borderTopColor=a),r||n||(t.style.borderBottomColor=a),i||(t.style.borderLeftColor=a),o||i||(t.style.borderRightColor=a),i&&n&&(t.style.borderRightColor=a);break;case 2:n&&(t.style.borderTopColor=a,t.style.borderRightColor=a,t.style.borderLeftColor=a),i&&(t.style.borderLeftColor=a),o&&(t.style.borderRightColor=a);break;case 3:i&&(t.style.borderLeftColor=a),o&&(t.style.borderRightColor=a);break;case 5:n&&(t.style.borderRightColor=a,t.style.borderLeftColor=a),i&&(t.style.borderBottomColor=a,t.style.borderTopColor=a),n&&i&&(t.style.borderLeftColor=e.verticalBorderColor||a,t.style.borderBottomColor=e.bottomBorderColor||a,t.style.borderTopColor=e.topBorderColor||a);break;case 6:n&&(t.style.borderRightColor=a,t.style.borderLeftColor=a),i&&(t.style.borderBottomColor=a,t.style.borderTopColor=a),n&&i&&(t.style.borderLeftColor=e.verticalBorderColor||a,t.style.borderBottomColor=e.bottomBorderColor||a,t.style.borderTopColor=e.topBorderColor||a),n||i||(t.style.borderLeftColor=a,t.style.borderBottomColor=a,t.style.borderTopColor=a,t.style.borderRightColor=a);break;case 7:n&&(t.style.borderLeftColor=a,t.style.borderTopColor=a,t.style.borderRightColor=a),i&&(t.style.borderLeftColor=a,t.style.borderTopColor=a,t.style.borderBottomColor=a),n||i||(t.style.borderLeftColor=a,t.style.borderBottomColor=a,t.style.borderTopColor=a,t.style.borderRightColor=a),n&&i&&(t.style.borderBottomColor=e.bottomBorderColor||a)}}(t,i.td,0===r,r===e.length-1,0===o,o===n.length-1)}))}))}(t,n),function(e,t){var n=function(e){return e%2==0?t.bgColorEven:t.bgColorOdd},r=t.hasBandedRows,o=t.hasBandedColumns,s=t.bgColorOdd,u=t.bgColorEven,d=!r&&s===u;e.forEach((function(e,o){e.forEach((function(e){if(e.td&&!l(e))if(r){var s=n(o);(0,i.default)(e.td,s||a,!0,void 0,!0)}else d?(0,i.default)(e.td,t.bgColorOdd||a,!0,void 0,!0):(0,i.default)(e.td,a,!0,void 0,!0)}))})),o&&e.forEach((function(e){e.forEach((function(e,t){var r=n(t);e.td&&r&&!l(e)&&(0,i.default)(e.td,r,!0,void 0,!0)}))}))}(t,n),function(e,t){if(!t.hasFirstColumn)return void e.forEach((function(e){e.forEach((function(e,t){e.td&&0===t&&(e.td=(0,r.default)(e.td,"TD"),e.td.scope="")}))}));e.forEach((function(t,n){t.forEach((function(t,o){t.td&&0===o&&(0===n||l(t)||(t.td.style.borderTopColor=a,(0,i.default)(t.td,a,!0,void 0,!0)),n!==e.length-1&&0!==n&&(t.td.style.borderBottomColor=a),t.td=(0,r.default)(t.td,"TH"),t.td.scope="col")}))}))}(t,n),function(e,t){var n,o;if(!t.hasHeaderRow)return void(null===(n=e[0])||void 0===n||n.forEach((function(e){e.td&&(e.td=(0,r.default)(e.td,"TD"),e.td.scope="")})));null===(o=e[0])||void 0===o||o.forEach((function(e){e.td&&t.headerRowColor&&(l(e)||(0,i.default)(e.td,t.headerRowColor,!0,void 0,!0),e.td.style.borderRightColor=t.headerRowColor,e.td.style.borderLeftColor=t.headerRowColor,e.td.style.borderTopColor=t.headerRowColor,e.td=(0,r.default)(e.td,"TH"),e.td.scope="row")}))}(t,n))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!t||!e.cells)return!1;var n=t.firstCell,r=t.lastCell,i=e.cells.length-1,o=e.cells[i].length-1,a=n.x,l=n.y,s=r.x,u=r.y;return 0==a&&0==l&&s==o&&u==i}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=i[t],r=1===t;e.style.listStyleType=r?n:'"'+n+'"'};var i=((r={})[1]="disc",r[3]=" ",r[2]="- ",r[5]=" ",r[8]=" ",r[4]=" ",r[6]=" ",r[7]=" ",r)},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(146),a=n(147);!function(e){e[e.Decimal=0]="Decimal",e[e.Roman=1]="Roman",e[e.Alpha=2]="Alpha"}(i||(i={})),t.default=function(e,t,n){var r=l[t],s=r.markerSeparator,u=r.markerSecondSeparator,d=r.markerType,c=r.lowerCase,f=n.toString();d===i.Roman?f=(0,a.default)(n,c):d===i.Alpha&&(f=(0,o.default)(n-1,c));var h=u?u+f+s:f+s;e.style.listStyleType='"'+h+'"'};var l=((r={})[1]={markerType:i.Decimal,markerSeparator:". "},r[2]={markerType:i.Decimal,markerSeparator:"- "},r[3]={markerType:i.Decimal,markerSeparator:") "},r[4]={markerType:i.Decimal,markerSeparator:") ",markerSecondSeparator:"("},r[5]={markerType:i.Alpha,markerSeparator:". ",lowerCase:!0},r[8]={markerType:i.Alpha,markerSeparator:"- ",lowerCase:!0},r[6]={markerType:i.Alpha,markerSeparator:") ",lowerCase:!0},r[7]={markerType:i.Alpha,markerSeparator:") ",markerSecondSeparator:"(",lowerCase:!0},r[9]={markerType:i.Alpha,markerSeparator:". "},r[12]={markerType:i.Alpha,markerSeparator:"- "},r[10]={markerType:i.Alpha,markerSeparator:") "},r[11]={markerType:i.Alpha,markerSeparator:") ",markerSecondSeparator:"("},r[13]={markerType:i.Roman,markerSeparator:". ",lowerCase:!0},r[16]={markerType:i.Roman,markerSeparator:"- ",lowerCase:!0},r[14]={markerType:i.Roman,markerSeparator:") ",lowerCase:!0},r[15]={markerType:i.Roman,markerSeparator:") ",markerSecondSeparator:"(",lowerCase:!0},r[17]={markerType:i.Roman,markerSeparator:". "},r[20]={markerType:i.Roman,markerSeparator:"- "},r[18]={markerType:i.Roman,markerSeparator:") "},r[19]={markerType:i.Roman,markerSeparator:") ",markerSecondSeparator:"("},r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={0:"A",1:"B",2:"C",3:"D",4:"E",5:"F",6:"G",7:"H",8:"I",9:"J",10:"K",11:"L",12:"M",13:"N",14:"O",15:"P",16:"Q",17:"R",18:"S",19:"T",20:"U",21:"V",22:"W",23:"X",24:"Y",25:"Z"};t.default=function(e,t){for(var n="";e>=0;)n=r[e%26]+n,e=Math.floor(e/26)-1;return t?n.toLowerCase():n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};t.default=function(e,t){for(var n="",o=0,a=(0,r.default)(i);o<a.length;o++){var l=a[o],s=Math.floor(e/i[l]);e-=s*i[l],n+=l.repeat(s)}return t?n.toLocaleLowerCase():n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),i=n(81),o=n(82),a=n(33),l=n(5),s=n(1),u=n(29),d=n(6),c=n(53),f=n(16),h=n(10),p=n(54);function v(e,t,n){var r=t[n?t.length-1:0];r=(0,h.getLeafSibling)(e.rootNode,r,n,e.skipTags,!0),r=(0,i.default)(e,"ol,ul",r),(0,a.default)(e,r)&&(0,p.isListElement)(r)&&(n?(0,s.default)(r,"HTMLOListElement")&&1!=r.start||t.push(r):t.unshift(r))}t.default=function(e,t,n){if(!e)return null;var a=[];if(n){var h=(0,i.default)(e,"ol,ul",n);h&&a.push(h)}else{if((0,o.default)(e,void 0,!0).forEach((function(n){var r=(0,i.default)(e,"ol,ul",n.getStartNode());r?(a[a.length-1]!=r&&a.push(r),1==a.length&&(0,s.default)(r,"HTMLOListElement")&&r.start>1&&(t=!1)):a.push(n.collapseToSingleElement())})),0==a.length&&!e.rootNode.firstChild){var g=(0,r.default)(12,e.rootNode.ownerDocument);e.rootNode.appendChild(g),a.push(g),e.fullSelectionStart=new l.default(g,0),e.fullSelectionEnd=new l.default(g,-1)}t&&(v(e,a,!1),v(e,a,!0)),a=a.filter((function(e){return!(0,u.default)(e,!0)}))}var m=null;if(a.length>0){var y=a.shift()||null;(m=(0,p.isListElement)(y)?new c.default(y):y?function(e){var t=(0,d.default)(e.childNodes),n=1==t.length?t[0]:(0,f.default)(t,"SPAN"),r=e.ownerDocument.createElement("ol");e.appendChild(r);var i=new c.default(r);return i.appendItem(n,0),i}(y):null)&&a.forEach((function(e){(0,p.isListElement)(e)?m.mergeVList(new c.default(e)):m.appendItem(e,0)}))}return m}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),i=n(81),o=n(14),a=n(33),l=n(24),s=n(53),u=0,d=function(){function e(e,t){this.region=e,this.name=t,this.lastNumber=0,this.lastNumberBeforeCursor=0}return e.createListChains=function(t,n,a){var s=Array.isArray(t)?t:t?[t]:[],u=[];return s.forEach((function(t){var s,d=[];(0,l.default)(t.rootNode,"ol",(function(r){var l=(0,i.default)(t,"ol",r);if(s!=l){var u=d.filter((function(e){return e.canAppendToTail(l)}))[0]||new e(t,(a||c)()),f=d.indexOf(u),h=!!n&&(0,o.default)(l,n);h?f<0&&d.push(u):(f>=0&&d.splice(f,1),d.unshift(u)),u.append(l,h),s=l}})),(0,r.default)(u,d)})),u},e.prototype.canAppendAtCursor=function(e){return e>1&&this.lastNumberBeforeCursor+1==e},e.prototype.createVListAtBlock=function(e,t){if(e&&e.parentNode){var n=e.ownerDocument.createElement("ol");n.start=t,this.applyChainName(n),e.parentNode.insertBefore(n,e);var r=new s.default(n);return r.appendItem(e,0),r}return null},e.prototype.commit=function(e){for(var t=this.getLists(),n=0,r=0;r<t.length;r++){var i=t[r];i.start=i.start>1?i.start:n+1;var o=new s.default(i);n=o.getLastItemNumber()||0,delete i.dataset.listchain,delete i.dataset.listchainafter,o.writeBack(e)}},e.prototype.canAppendToTail=function(e){return this.lastNumber+1==e.start},e.prototype.append=function(e,t){this.applyChainName(e),this.lastNumber=new s.default(e).getLastItemNumber()||0,t?e.dataset.listchainafter="true":this.lastNumberBeforeCursor=this.lastNumber},e.prototype.applyChainName=function(e){e.dataset.listchain=this.name},e.prototype.getLists=function(){var e=this;return(0,l.default)(this.region.rootNode,"ol[data-listchain="+this.name+"]").filter((function(t){return(0,a.default)(e.region,t)}))},e}();function c(){return"__List_Chain_"+u++}t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),i=n(11),o=n(40);t.default=function(e){var t;if(!e)return null;var n=(0,i.default)(e),a=n.getBoundingClientRect&&(0,o.default)(n.getBoundingClientRect());if(a)return a;e=e.normalize();var l=n.getClientRects&&n.getClientRects();if(a=l&&1==l.length?(0,o.default)(l[0]):null)return a;if(3==e.node.nodeType&&e.node.ownerDocument){var s=(0,r.default)({tag:"span",children:[""]},e.node.ownerDocument);if((n=(0,i.default)(e)).insertNode(s),a=s.getBoundingClientRect&&(0,o.default)(s.getBoundingClientRect()),null===(t=s.parentNode)||void 0===t||t.removeChild(s),a)return a}var u=e.element;return u&&u.getBoundingClientRect&&(a=(0,o.default)(u.getBoundingClientRect()))?a:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(76),i=n(88);t.default=function(e,t){if(!e)return"";var n=(0,r.default)(e),o=t&&(0,i.default)(e,t);return o?n+"\x3c!--"+JSON.stringify(o)+"--\x3e":n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setHtmlWithMetadata=void 0;var r=n(11),i=n(1),o=n(52),a=n(30),l=(0,a.createArrayDefinition)((0,a.createNumberDefinition)()),s=(0,a.createObjectDefinition)({x:(0,a.createNumberDefinition)(),y:(0,a.createNumberDefinition)()}),u=(0,a.createBooleanDefinition)(!0),d=(0,a.createObjectDefinition)({type:(0,a.createNumberDefinition)(!0,0),isDarkMode:u,start:l,end:l}),c=(0,a.createObjectDefinition)({type:(0,a.createNumberDefinition)(!1,1),isDarkMode:u,tableId:(0,a.createStringDefinition)(),firstCell:s,lastCell:s}),f=(0,a.createObjectDefinition)({type:(0,a.createNumberDefinition)(!1,2),isDarkMode:u,imageId:(0,a.createStringDefinition)()});function h(e,t,n){if(e){t=t||"",e.innerHTML=(null==n?void 0:n(t))||t;var r=e.lastChild;if((0,i.default)(r,"Comment"))try{var a=JSON.parse(r.nodeValue||"");if((0,o.default)(a,d)||(0,o.default)(a,c)||(0,o.default)(a,f))return e.removeChild(r),a.type=void 0===a.type?0:a.type,a.isDarkMode=a.isDarkMode||!1,a}catch(e){}}}t.default=function(e,t,n){var i=h(e,t,n);return 0==(null==i?void 0:i.type)?(0,r.default)(e,i.start,i.end):null},t.setHtmlWithMetadata=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19);t.default=function(e,t){var n,i,o,a=null===(o=null===(i=null===(n=null==e?void 0:e.commonAncestorContainer)||void 0===n?void 0:n.ownerDocument)||void 0===i?void 0:i.defaultView)||void 0===o?void 0:o.getSelection();if(a){var l=!0;if(a.rangeCount>0)try{var s=null;(t||r.Browser.isEdge)&&(s=1==a.rangeCount?a.getRangeAt(0):null)&&s.startContainer==e.startContainer&&s.startOffset==e.startOffset&&s.endContainer==e.endContainer&&s.endOffset==e.endOffset?l=!1:a.removeAllRanges()}catch(e){}l&&a.addRange(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSnapshotV2=void 0;var r=n(89);function i(e,t,n,i,o){i=i||function(e){var t;return(null===(t=e)||void 0===t?void 0:t.length)||0},o=o||a;var l=e.snapshots[e.currentIndex];if(e.currentIndex<0||!l||!o(t,l)){(0,r.default)(e,i),e.snapshots.push(t),e.currentIndex++,e.totalSize+=i(t);for(var s=0;s<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=i(e.snapshots[s]),s++;s>0&&(e.snapshots.splice(0,s),e.currentIndex-=s,e.autoCompleteIndex-=s),n&&(e.autoCompleteIndex=e.currentIndex)}else l&&o(t,l)&&e.snapshots.splice(e.currentIndex,1,t)}function o(e,t){return e.html==t.html}function a(e,t){return e==t}t.default=i,t.addSnapshotV2=function(e,t,n){i(e,t,n,(function(e){var t;return(null===(t=e.html)||void 0===t?void 0:t.length)||0}),o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.moveCurrentSnapsnot=void 0;var r=n(57);function i(e,t){return(0,r.default)(e,t)?(e.currentIndex+=t,e.autoCompleteIndex=-1,e.snapshots[e.currentIndex]):null}t.default=i,t.moveCurrentSnapsnot=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.autoCompleteIndex>=0&&e.currentIndex-e.autoCompleteIndex==1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),i=n(90),o=n(8),a=n(86),l=n(31),s=n(2),u=n(1),d=n(32),c=n(6),f=n(91),h=n(159),p=n(160),v=function(){function e(e){e=e||{},this.elementCallbacks=(0,f.cloneObject)(e.elementCallbacks),this.styleCallbacks=(0,p.getStyleCallbacks)(e.cssStyleCallbacks),this.attributeCallbacks=(0,f.cloneObject)(e.attributeCallbacks),this.tagReplacements=(0,p.getTagReplacement)(e.additionalTagReplacements),this.allowedAttributes=(0,p.getAllowedAttributes)(e.additionalAllowedAttributes),this.allowedCssClassesRegex=(0,p.getAllowedCssClassesRegex)(e.additionalAllowedCssClasses),this.defaultStyleValues=(0,p.getDefaultStyleValues)(e.additionalDefaultStyleValues),this.additionalPredefinedCssForElement=e.additionalPredefinedCssForElement||null,this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.preserveHtmlComments=e.preserveHtmlComments||!1,this.unknownTagReplacement=e.unknownTagReplacement||null}return e.convertInlineCss=function(t,n){return new e({additionalGlobalStyleNodes:n}).exec(t,!0)},e.sanitizeHtml=function(t,n){var r=new e(n=n||{}),o=(0,u.default)(n.currentElementOrStyle,"HTMLElement")?(0,i.default)(n.currentElementOrStyle):n.currentElementOrStyle;return r.exec(t,n.convertCssOnly,o)},e.prototype.exec=function(e,t,n){var r=(new DOMParser).parseFromString(e||"","text/html");return r&&r.body&&r.body.firstChild&&(this.convertGlobalCssToInlineCss(r),t||this.sanitize(r.body,n)),r&&r.body&&r.body.innerHTML||""},e.prototype.sanitize=function(e,t){if(!e)return"";t=(0,f.cloneObject)(t,(0,i.default)(null)),this.processNode(e,t,{})},e.prototype.convertGlobalCssToInlineCss=function(e){for(var t=(0,c.default)(e.querySelectorAll("style")),n=0,r=this.additionalGlobalStyleNodes.reverse().map((function(e){return e.sheet})).concat(t.map((function(e){return e.sheet})).reverse()).filter((function(e){return e}));n<r.length;n++)for(var i=r[n],o=function(t){var n=i.cssRules[t],r=n&&n.style?n.style.cssText:null;if(n.type!=CSSRule.STYLE_RULE||!r||!n.selectorText)return"continue";for(var o=0,a=n.selectorText.split(",");o<a.length;o++){var l=a[o];if(l&&l.trim()&&!(l.indexOf(":")>=0))(0,c.default)(e.querySelectorAll(l)).forEach((function(e){return e.setAttribute("style",r+(e.getAttribute("style")||""))}))}},a=i.cssRules.length-1;a>=0;a--)o(a);t.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))},e.prototype.processNode=function(e,t,n){var i,o=e.nodeType,a=1==o,l=3==o,u=11==o,d=8==o,c=!1;if(a){var h=(0,s.default)(e),p=this.elementCallbacks[h],v=this.tagReplacements[h.toLowerCase()];void 0===v&&(v=this.unknownTagReplacement),p?c=p(e,n):h.indexOf(":")>0||h==v||"*"==v?c=!0:v&&/^[a-zA-Z][\w\-]*$/.test(v)&&(e=(0,r.default)(e,v),c=!0)}else if(l){var g=t["white-space"];c="pre"==g||"pre-line"==g||"pre-wrap"==g||!/^[\r\n]*$/g.test(e.nodeValue||"")}else c=!!u||!!d&&this.preserveHtmlComments;if(c)if(!l||"pre"!=t["white-space"]&&"pre-wrap"!=t["white-space"]){if(a||u){var m=(0,f.cloneObject)(t),y=e;a&&(this.processAttributes(y,n),this.preprocessCss(y,m),this.processCss(y,m,n));for(var b=y.firstChild,C=void 0;b;b=C)C=b.nextSibling,this.processNode(b,m,n)}}else e.nodeValue=(e.nodeValue||"").replace(/^ /gm,"").replace(/ {2}/g," ");else null===(i=e.parentNode)||void 0===i||i.removeChild(e)},e.prototype.preprocessCss=function(e,t){var n=(0,a.default)(e,this.additionalPredefinedCssForElement);n&&(0,o.default)(n).forEach((function(e){t[e]=n[e]}))},e.prototype.processCss=function(e,t,n){var r=this,i=(0,l.default)(e);(0,o.default)(i).forEach((function(o){var a=i[o],l=r.styleCallbacks[o],s=null!=t[o],u=!0;u&&l&&(u=l(a,e,t,n)),u&&(0,h.isCssVariable)(a)&&(u=!!(a=(0,h.processCssVariable)(a))),(u=u&&"inherit"!=a&&a.indexOf("expression")<0&&"-"!=o.substr(0,1)&&r.defaultStyleValues[o]!=a&&(s&&a!=t[o]||!s&&"initial"!=a&&"normal"!=a))&&s&&(t[o]=a),u?i[o]=a:delete i[o]})),(0,d.default)(e,i)},e.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;n>=0;n--){var r=e.attributes[n],i=r.name.toLowerCase().trim(),o=r.value,a=this.attributeCallbacks[i],l=a?a(o,e,t):this.allowedAttributes.indexOf(i)>=0||0==i.indexOf("data-")?o:null;"class"==i&&this.allowedCssClassesRegex&&(l=this.processCssClass(o,l)),null==l||l.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?e.removeAttribute(i):r.value=l}},e.prototype.processCssClass=function(e,t){var n=this,r=e?e.split(" "):[],i=t?t.split(" "):[];return r.forEach((function(e){var t;(null===(t=n.allowedCssClassesRegex)||void 0===t?void 0:t.test(e))&&i.indexOf(e)<0&&i.push(e)})),(null==i?void 0:i.length)>0?i.join(" "):null},e}();t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCssVariable=t.processCssVariable=void 0;var r=/^\s*var\(\s*[a-zA-Z0-9-_]+\s*(,\s*(.*))?\)\s*$/;t.processCssVariable=function(e){var t=r.exec(e);return(null==t?void 0:t[2])||""},t.isCssVariable=function(e){return 0==e.indexOf("var(")}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getStyleCallbacks=t.getDefaultStyleValues=t.getAllowedCssClassesRegex=t.getAllowedAttributes=t.getTagReplacement=void 0;var i=n(8),o=n(91),a={a:"*",abbr:"*",address:"*",area:"*",article:"*",aside:"*",b:"*",bdi:"*",bdo:"*",blockquote:"*",body:"*",br:"*",button:"*",canvas:"*",caption:"*",center:"*",cite:"*",code:"*",col:"*",colgroup:"*",data:"*",datalist:"*",dd:"*",del:"*",details:"*",dfn:"*",dialog:"*",dir:"*",div:"*",dl:"*",dt:"*",em:"*",fieldset:"*",figcaption:"*",figure:"*",font:"*",footer:"*",h1:"*",h2:"*",h3:"*",h4:"*",h5:"*",h6:"*",head:"*",header:"*",hgroup:"*",hr:"*",html:"*",i:"*",img:"*",input:"*",ins:"*",kbd:"*",label:"*",legend:"*",li:"*",main:"*",map:"*",mark:"*",menu:"*",menuitem:"*",meter:"*",nav:"*",ol:"*",optgroup:"*",option:"*",output:"*",p:"*",picture:"*",pre:"*",progress:"*",q:"*",rp:"*",rt:"*",ruby:"*",s:"*",samp:"*",section:"*",select:"*",small:"*",span:"*",strike:"*",strong:"*",sub:"*",summary:"*",sup:"*",table:"*",tbody:"*",td:"*",textarea:"*",tfoot:"*",th:"*",thead:"*",time:"*",tr:"*",tt:"*",u:"*",ul:"*",var:"*",wbr:"*",xmp:"*",form:"SPAN",applet:null,audio:null,base:null,basefont:null,embed:null,frame:null,frameset:null,iframe:null,link:null,meta:null,noscript:null,object:null,param:null,script:null,slot:null,source:null,style:null,template:null,title:null,track:null,video:null},l="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,valign,value,width,wrap".split(","),s={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"},u=[];function d(){return null}function c(e,t){var n=t.tagName;return!("LI"==n||"DIV"==n)}t.getTagReplacement=function(e){var t=r({},a),n=e||{};return(0,i.default)(n).forEach((function(e){e&&(t[e.toLowerCase()]=n[e])})),t},t.getAllowedAttributes=function(e){return(t=l.concat(e||[]),t.filter((function(e,t,n){return n.indexOf(e)==t}))).map((function(e){return e.toLocaleLowerCase()}));var t},t.getAllowedCssClassesRegex=function(e){var t=u.concat(e||[]);return t.length>0?new RegExp(t.join("|")):null},t.getDefaultStyleValues=function(e){var t=(0,o.cloneObject)(s);return e&&Object.keys(e).forEach((function(n){var r=e[n];null!=r?t[n]=r:delete t[n]})),t},t.getStyleCallbacks=function(e){var t=(0,o.cloneObject)(e);return t.position=t.position||d,t.width=t.width||c,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{elementCallbacks:{},attributeCallbacks:{},cssStyleCallbacks:{},additionalTagReplacements:{},additionalAllowedAttributes:[],additionalAllowedCssClasses:[],additionalDefaultStyleValues:{},additionalGlobalStyleNodes:[],additionalPredefinedCssForElement:{},preserveHtmlComments:!1,unknownTagReplacement:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e[t]){var r=e[t];e[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e),n.apply(void 0,e)}}else e[t]=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n,r){e&&(e.className="_Entity _EType_"+t+" "+(r?"_EId_"+r+" ":"")+"_EReadonly_"+(n?"1":"0"),n?e.contentEditable="false":e.getAttribute("contenteditable")&&e.removeAttribute("contenteditable"))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreContentWithEntityPlaceholder=t.moveContentWithEntityPlaceholders=t.createEntityPlaceholder=void 0;var r=n(92),i=n(93),o=n(2),a=n(1);function l(e){var t=e.wrapper.ownerDocument.createElement("ENTITY-PLACEHOLDER");return t.id=e.id,t}function s(e,t){for(var n;e&&(!t||e!=t);){var r=e;e=e.nextSibling,null===(n=r.parentNode)||void 0===n||n.removeChild(r)}return e}function u(e,t){var n=l(e);return t[e.id]=e.wrapper,n}t.createEntityPlaceholder=l,t.moveContentWithEntityPlaceholders=function(e,t){for(var n=(0,i.default)(),o=e.ownerDocument.createDocumentFragment(),l=null,s=function(e){var i,s=e;l=e.nextSibling,(0,a.default)(e,"HTMLElement")&&((i=(0,r.default)(e))?s=u(i,t):e.querySelectorAll(n).forEach((function(e){var n;if(i=(0,r.default)(e)){var o=u(i,t);null===(n=e.parentNode)||void 0===n||n.replaceChild(o,e)}}))),o.appendChild(s)},d=e.firstChild;d;d=l)s(d);return o.normalize(),o},t.restoreContentWithEntityPlaceholder=function(e,t,n,r){var i=t.firstChild;n=n||{};for(var l,u=function(e){var u,d=null,c=e.nextSibling;if((u=e,"ENTITY-PLACEHOLDER"==(0,o.default)(u)?u.id:null)&&(d=n[e.id]))(i=s(i,d))?i=i.nextSibling:t.appendChild(d);else{var f=r?e.cloneNode(!0):e;t.insertBefore(f,i),(0,a.default)(f,"HTMLElement")&&f.querySelectorAll("ENTITY-PLACEHOLDER").forEach((function(e){var t;(d=n[e.id])&&(null===(t=e.parentNode)||void 0===t||t.replaceChild(d,e))}))}l=e=c},d=e.firstChild;d;)u(d),d=l;s(i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=r),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e&&e.eventDataCache&&(t&&e.eventDataCache.hasOwnProperty(t)?delete e.eventDataCache[t]:t||(e.eventDataCache={}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(94);t.default=function(e){return!(0,r.default)(e)&&!!e.key&&1==e.key.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19).Browser.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey};t.default=function(e){return r(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(31),i=n(32);t.default=function(e,t){var n=(0,r.default)(e),o=0;t.forEach((function(e){var t;if((null===(t=n[e])||void 0===t?void 0:t.indexOf("!important"))>-1){var r=n[e].indexOf("!");n[e]=n[e].substring(0,r),o++}})),o>0&&(0,i.default)(e,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r,i=e.getElementById(n);i||((i=e.createElement("style")).id=n,e.head.appendChild(i)),null===(r=i.sheet)||void 0===r||r.insertRule(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n,r=e.getElementById(t);r&&(null===(n=r.parentNode)||void 0===n||n.removeChild(r))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),i=n(4),o=n(20),a=n(11),l=n(15),s=n(7),u=n(2),d=n(38),c=n(87),f=n(44),h=n(47),p=n(23),v=n(173),g=n(5),m=n(71),y=n(24),b=n(36),C=n(6),E=n(39),S=n(16),w=n(17),T=[function(e,t,n,r){var o,l,u=(0,s.default)(e,n.node);if(u){var c=(0,y.default)(e,"a[href]",null,1,(0,a.default)(n)).filter((function(e){return u.contains(e)}))[0];if(c&&(0,d.default)(c)&&(n=new g.default(c,-2),P(c),c=null),c&&(null===(o=t)||void 0===o?void 0:o.querySelector)&&(null===(l=t)||void 0===l?void 0:l.querySelector("a[href]"))){var f=n.normalize(),h=f.node.parentNode,p=3==f.node.nodeType?(0,b.default)(f.node,f.offset,!1):f.isAtEnd?f.node.nextSibling:f.node,v=e.ownerDocument.createTextNode("");for(h.insertBefore(v,p);v&&(0,i.default)(c,v);)v=(0,w.splitBalancedNodeRange)(v);v&&(n=new g.default(v,-2),P(v))}}return n},function(e,t,n,r){var i=t,o=!1;if(11==i.nodeType){o=!0;var a=(0,C.default)(i.childNodes).filter((function(e){return"BR"!=(0,u.default)(e)}));i=1==a.length?a[0]:null}var s=(0,u.default)(i),d=s&&i&&"BR"==(0,u.default)(i.nextSibling),f=(0,l.default)(n.node,e,"LI"),h=f&&(0,l.default)(f,e,"OL,UL"),m=(0,l.default)(n.node,e,"TD,TH");"LI"==s&&(s=h?(0,u.default)(h):"UL",i=(0,S.default)(i,s));if(("OL"==s||"UL"==s)&&i&&"LI"==(0,u.default)(i.firstChild)){var y=!i.firstChild.nextSibling&&!d;d&&i.parentNode&&P(i.nextSibling),y?((0,E.default)(i.firstChild),(0,E.default)(i)):(0,u.default)(h)==s&&((0,E.default)(i),n=new g.default(f,(0,c.default)(n,f)?-2:-3))}o&&"TABLE"==s&&m&&((0,v.default)(m,i,n,r),n=new g.default(i,0),(0,p.default)(t));return n},function(e,t,n,i){if("P"==(0,u.default)(n.node)){var o=n.normalize(),a=(0,r.default)(n.node,"div");o.node!=a&&(n=o)}return n},function(e,t,n,r){(0,f.default)(n.node)&&(n=new g.default(n.node,n.isAtEnd?-3:-2));return n},function(e,t,n,r){if(r&&r.collapsed){var i=new m.default(e,g.default.getStart(r)),o=i.getInlineElementBefore(),a=i.getInlineElementAfter();o instanceof h.default?n=new g.default(o.getContainerNode(),-3):a instanceof h.default&&(n=new g.default(a.getContainerNode(),-2))}return n},function e(t,n,r,i){var o;if(!(null===(o=r.element)||void 0===o?void 0:o.isContentEditable)){for(var a=void 0,s=(0,l.default)(r.node,t,"[contenteditable=false]");s;)s=(null==(a=s)?void 0:a.parentElement)?(0,l.default)(a.parentElement,t,"[contenteditable=false]"):null;if(a)return r=new g.default(a,-3),e(t,n,r,i)}return r},function(e,t,n,r){if(1==t.childNodes.length&&"TABLE"==(0,u.default)(t.childNodes[0])||"TABLE"==(0,u.default)(t)){var i=n.element,s=new g.default(i,-2),d=(0,a.default)(s,n),c=o.default.createSelectionTraverser(e,d),f=c&&c.currentBlockElement;if(f){for(var h=f;!h;)(h=c.getNextBlockElement())&&(f=h);var p=null==f?void 0:f.getEndNode();if(p&&(0,l.default)(p,e,"TABLE")){var v=(0,a.default)(n);v.collapse(!1);var m=e.ownerDocument.createElement("br");v.insertNode(m),v=(0,a.default)(m),n=g.default.getEnd(v)}}}return n}];function P(e){var t;null===(t=null==e?void 0:e.parentNode)||void 0===t||t.removeChild(e)}t.default=function(e,t,n,r){return T.forEach((function(i){n=i(e,t,n,r)})),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(174),i=n(23),o=n(77);t.default=function(e,t,n,a){var l,s,u,d,c=new o.default(t),f=new o.default(e),h=f.row,p=f.col,v=null!==(s=h+(null===(l=c.cells)||void 0===l?void 0:l.length))&&void 0!==s?s:0,g=null!==(d=p+(null===(u=c.cells)||void 0===u?void 0:u[0].length))&&void 0!==d?d:0;for(f.row=f.cells.length-1;f.cells.length<v;)f.edit(1);for(f.col=f.cells[0].length-1;f.cells[0].length<g;)f.edit(3);for(var m=h;m<v;m++)for(var y=p;y<g;y++){var b=f.getCell(m,y),C=c.getTd(m-h,y-p);b.td&&C?((0,i.default)(b.td,C),(0,r.default)(b.td,C)):b.td=document.createElement("td")}f.writeBack()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51);t.default=function(e,t){var n=t.getAttribute("style");n&&(e.setAttribute("style",n),(0,r.saveTableCellMetadata)(e,{bgColorOverride:!0}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),i=n(84),o=n(83),a=n(55),l=n(85),s=n(5),u=n(24),d=n(1),c=n(36);function f(e,t,n){var r,i;if((0,d.default)(e,"Text")){var o=(0,c.default)(e,t,n);return n?[o,e]:[e,o]}var a=e.childNodes[t-1],l=e.childNodes[t];if(a||l||(n?a=(l=e).previousSibling:l=(a=e).nextSibling),(a||l)&&(!a||!l)){var s=e.ownerDocument.createTextNode("");null===(i=null===(r=a||l)||void 0===r?void 0:r.parentNode)||void 0===i||i.insertBefore(s,l),a?l=s:a=s}return[a,l]}t.default=function(e,t){var n=null,c=(0,u.default)(e,"table,tr",null,2,t),h=(0,o.default)(e,t,0).map((function(e){var t=(0,a.default)(e);if(!t)return null;var o=t.startContainer,l=t.endContainer,s=t.startOffset,u=t.endOffset,h=t.commonAncestorContainer;if((0,d.default)(h,"HTMLElement")&&!h.isContentEditable)return null;var p=f(l,u,!1),v=p[0],g=p[1],m=f(o,s,!0),y=m[0],b=m[1];n=n||y;var C=(0,i.default)(e,[b,v]);return(0,r.default)(c,C),{region:e,beforeStart:y,afterEnd:g}})).filter((function(e){return!!e}));return c.forEach((function(e){var t;return(null===(t=e.parentElement)||void 0===t?void 0:t.isContentEditable)&&e.parentElement.removeChild(e)})),h.forEach((function(e){e&&(0,l.default)(e.region,e.beforeStart,e.afterEnd)})),n&&new s.default(n,-1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20);t.default=function(e){for(var t=r.default.createBodyTraverser(e),n=t&&t.currentBlockElement,i=[];n;)i.push(n.getTextContent()),n=t.getNextBlockElement();return i.join("\n")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e,t){var n,i=this;this.editor=null,this.disposer=null,this.onDrop=function(){var e;null===(e=i.editor)||void 0===e||e.runAsync((function(e){e.addUndoSnapshot((function(){}),"Drop")}))},this.onFocus=function(){var e,t,n,r=i.state.tableSelectionRange||{},o=r.table,a=r.coordinates,l=(i.state.imageSelectionRange||{}).image;o&&a?null===(e=i.editor)||void 0===e||e.select(o,a):l?null===(t=i.editor)||void 0===t||t.select(l):i.state.selectionRange&&(null===(n=i.editor)||void 0===n||n.select(i.state.selectionRange)),i.state.selectionRange=null},this.onKeyDownDocument=function(e){9!=e.which||e.defaultPrevented||i.cacheSelection()},this.onMouseDownDocument=function(e){!i.editor||i.state.selectionRange||i.editor.contains(e.target)||i.cacheSelection()},this.cacheSelection=function(){!i.state.selectionRange&&i.editor&&(i.state.selectionRange=i.editor.getSelectionRange(!1))},this.onScroll=function(e){var t;null===(t=i.editor)||void 0===t||t.triggerPluginEvent(14,{rawEvent:e,scrollContainer:i.state.scrollContainer})},this.onKeyboardEvent=function(e){((0,r.isCharacterValue)(e)||e.which>=33&&e.which<=40)&&e.stopPropagation()},this.onInputEvent=function(e){e.stopPropagation()},this.onContextMenuEvent=function(e){var t,n,o=[],a=null===(t=i.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(),l=null==a?void 0:a.getInlineElementBefore(),s=e.target;2!=e.button&&l&&(s=l.getContainerNode()),i.state.contextMenuProviders.forEach((function(e){var t,n=null!==(t=e.getContextMenuItems(s))&&void 0!==t?t:[];(null==n?void 0:n.length)>0&&(o.length>0&&o.push(null),(0,r.arrayPush)(o,n))})),null===(n=i.editor)||void 0===n||n.triggerPluginEvent(16,{rawEvent:e,items:o})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,selectionRange:null,stopPrintableKeyboardEventPropagation:!e.allowKeyboardEventPropagation,contextMenuProviders:(null===(n=e.plugins)||void 0===n?void 0:n.filter(o))||[],tableSelectionRange:null,imageSelectionRange:null}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n,i,o,a=this;this.editor=e;var l=this.editor.getDocument(),s=((t={keypress:this.getEventHandler(1),keydown:this.getEventHandler(0),keyup:this.getEventHandler(2),mousedown:5,contextmenu:this.onContextMenuEvent,compositionstart:function(){return a.state.isInIME=!0},compositionend:function(t){a.state.isInIME=!1,e.triggerPluginEvent(4,{rawEvent:t})},drop:this.onDrop,focus:this.onFocus})[r.Browser.isIE?"textinput":"input"]=this.getEventHandler(3),t);r.Browser.isSafari?(l.addEventListener("mousedown",this.onMouseDownDocument,!0),l.addEventListener("keydown",this.onKeyDownDocument),null===(n=l.defaultView)||void 0===n||n.addEventListener("blur",this.cacheSelection)):r.Browser.isIEOrEdge?s.beforedeactivate=this.cacheSelection:s.blur=this.cacheSelection,this.disposer=e.addDomEventHandler(s),this.state.scrollContainer.addEventListener("scroll",this.onScroll),null===(i=l.defaultView)||void 0===i||i.addEventListener("scroll",this.onScroll),null===(o=l.defaultView)||void 0===o||o.addEventListener("resize",this.onScroll)},e.prototype.dispose=function(){var e,t,n,i,o,a=null===(e=this.editor)||void 0===e?void 0:e.getDocument();a&&r.Browser.isSafari&&(a.removeEventListener("mousedown",this.onMouseDownDocument,!0),a.removeEventListener("keydown",this.onKeyDownDocument),null===(t=a.defaultView)||void 0===t||t.removeEventListener("blur",this.cacheSelection)),null===(n=null==a?void 0:a.defaultView)||void 0===n||n.removeEventListener("resize",this.onScroll),null===(i=null==a?void 0:a.defaultView)||void 0===i||i.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),null===(o=this.disposer)||void 0===o||o.call(this),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.getEventHandler=function(e){var t=this;return this.state.stopPrintableKeyboardEventPropagation?{pluginEventType:e,beforeDispatch:function(n){return 3==e?t.onInputEvent(n):t.onKeyboardEvent(n)}}:e},e}();function o(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.getContextMenuItems)}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){this.editor=null,this.state={features:{}}}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){var t,n=!1,i=null,o=!1;if(0==e.eventType){var a=e.rawEvent,l=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n=(o=(0,r.isCtrlOrMetaPressed)(a))||a.altKey,i=this.state.features[a.which]||l&&!l.collapsed&&this.state.features[258]}else 7==e.eventType&&(i=this.state.features[257]);for(var s=0;i&&s<(null==i?void 0:i.length);s++){var u=i[s];if((u.allowFunctionKeys||!n)&&this.editor&&u.shouldHandleEvent(e,this.editor,o)){u.handleEvent(e,this.editor);break}}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(180),i=n(0),o=/_(\d{1,8})$/,a=["^_Entity$","^_EId_","^_EType_","^_EReadonly_"],l=[6,7,4,5],s=function(){function e(){var e=this;this.editor=null,this.cancelAsyncRun=null,this.handleCutEvent=function(t){var n,r=null===(n=e.editor)||void 0===n?void 0:n.getSelectionRange();r&&!r.collapsed&&e.checkRemoveEntityForRange(t)},this.state={knownEntityElements:[],shadowEntityCache:{}}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){this.editor=e},e.prototype.willHandleEventExclusively=function(e){var t;return 1==e.eventType&&!!(null===(t=e.rawEvent.target)||void 0===t?void 0:t.shadowRoot)},e.prototype.dispose=function(){this.editor=null,this.state.knownEntityElements=[]},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 6:this.handleMouseUpEvent(e);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:e.isCut&&this.handleCutEvent(e.rawEvent);break;case 10:this.handleBeforePasteEvent(e.sanitizingOption);break;case 7:this.handleContentChangedEvent(e);break;case 11:this.handleContentChangedEvent();break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot);break;case 16:this.handleContextMenuEvent(e.rawEvent);break;case 20:this.handleBeforeSetContentEvent();break;case 15:this.handleEntityOperationEvent(e)}(null===(t=this.editor)||void 0===t?void 0:t.isFeatureEnabled("InlineEntityReadOnlyDelimiters"))&&(0,r.inlineEntityOnPluginEvent)(e,this.editor)},e.prototype.handleContextMenuEvent=function(e){var t,n=e.target,r=n&&(null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor((0,i.getEntitySelector)(),n));r&&(e.preventDefault(),this.triggerEvent(r,2,e))},e.prototype.handleMouseUpEvent=function(e){var t,n=e.rawEvent,r=e.isClicking,o=n.target;this.editor&&r&&o&&(t=this.editor.getElementAtCursor((0,i.getEntitySelector)(),o))&&(this.triggerEvent(t,1,n),u(this.editor))},e.prototype.handleKeyDownEvent=function(e){var t;if((0,i.isCharacterValue)(e)||8==e.which||46==e.which||13==e.which){var n=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n&&!n.collapsed&&this.checkRemoveEntityForRange(e)}},e.prototype.handleBeforePasteEvent=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n&&!n.collapsed&&this.checkRemoveEntityForRange(null),e.additionalAllowedCssClasses&&(0,i.arrayPush)(e.additionalAllowedCssClasses,a)},e.prototype.handleBeforeSetContentEvent=function(){this.cacheShadowEntities(this.state.shadowEntityCache)},e.prototype.handleContentChangedEvent=function(e){for(var t,n=this,o=!1,a=this.state.knownEntityElements.length-1;a>=0;a--){var l=this.state.knownEntityElements[a];this.editor&&!this.editor.contains(l)&&(this.setIsEntityKnown(l,!1),l.shadowRoot&&this.triggerEvent(l,10),o||l.isContentEditable||(0,i.isBlockElement)(l)||(o=!0))}var s=this.state.knownEntityElements.map((function(e){var t;return null===(t=(0,i.getEntityFromElement)(e))||void 0===t?void 0:t.id})).filter((function(e){return!!e}));("InsertEntity"==(null==e?void 0:e.source)&&e.data?[e.data]:this.getExistingEntities().filter((function(e){var t=e.wrapper;return!n.isEntityKnown(t)}))).forEach((function(e){var t=e.wrapper,r=e.type,o=e.id,a=e.isReadonly;e.id=n.ensureUniqueId(r,o,s),(0,i.commitEntity)(t,r,a,e.id),n.handleNewEntity(e)})),(0,i.getObjectKeys)(this.state.shadowEntityCache).forEach((function(e){n.triggerEvent(n.state.shadowEntityCache[e],6),delete n.state.shadowEntityCache[e]})),o&&(null===(t=this.editor)||void 0===t?void 0:t.isFeatureEnabled("InlineEntityReadOnlyDelimiters"))&&(0,r.normalizeDelimitersInEditor)(this.editor)},e.prototype.handleEntityOperationEvent=function(e){var t,n=this;this.editor&&l.indexOf(e.operation)>=0&&(null===(t=this.cancelAsyncRun)||void 0===t||t.call(this),this.cancelAsyncRun=this.editor.runAsync((function(){n.cancelAsyncRun=null,n.handleContentChangedEvent()})))},e.prototype.handleExtractContentWithDomEvent=function(e){var t=this;(0,i.toArray)(e.querySelectorAll((0,i.getEntitySelector)())).forEach((function(e){e.removeAttribute("contentEditable"),t.triggerEvent(e,8)}))},e.prototype.checkRemoveEntityForRange=function(e){var t,n=this,r=[],o=(0,i.getEntitySelector)();if(null===(t=this.editor)||void 0===t||t.queryElements(o,1,(function(t){t.isContentEditable?r.push(t):n.triggerEvent(t,6,e)})),this.editor&&r.length>0){var a=this.editor.queryElements(o,2);r.forEach((function(t){var r=a.indexOf(t)>=0;n.triggerEvent(t,r?6:7,e)}))}},e.prototype.triggerEvent=function(e,t,n,r){var o,a=e&&(0,i.getEntityFromElement)(e);a&&(null===(o=this.editor)||void 0===o||o.triggerPluginEvent(15,{operation:t,rawEvent:n,entity:a,contentForShadowEntity:r}))},e.prototype.handleNewEntity=function(e){var t,n,r=e.wrapper,o=null===(t=this.editor)||void 0===t?void 0:t.getDocument().createDocumentFragment(),a=this.state.shadowEntityCache[e.id];if(delete this.state.shadowEntityCache[e.id],o&&(null==a?void 0:a.shadowRoot)&&(0,i.moveChildNodes)(o,a.shadowRoot),this.triggerEvent(r,0,void 0,o),null==o?void 0:o.firstChild)r.shadowRoot?(0,i.moveChildNodes)(r.shadowRoot,o):this.createShadowRoot(r,o);else if(r.shadowRoot){this.triggerEvent(r,10);var l=r.cloneNode();(0,i.moveChildNodes)(l,r),null===(n=this.editor)||void 0===n||n.replaceNode(r,l),e.wrapper=l}this.setIsEntityKnown(e.wrapper,!0)},e.prototype.getExistingEntities=function(e){var t,n;return null!==(n=null===(t=this.editor)||void 0===t?void 0:t.queryElements((0,i.getEntitySelector)()).map(i.getEntityFromElement).filter((function(t){return!(!t||e&&!t.wrapper.shadowRoot)})))&&void 0!==n?n:[]},e.prototype.createShadowRoot=function(e,t){if(e.attachShadow){var n=e.attachShadow({mode:"open",delegatesFocus:!0});return e.contentEditable="false",this.triggerEvent(e,9),(0,i.moveChildNodes)(n,t),n}},e.prototype.cacheShadowEntities=function(e){this.getExistingEntities(!0).forEach((function(t){var n=t.wrapper,r=t.id;e[r]=n}))},e.prototype.ensureUniqueId=function(e,t,n){for(var r=o.exec(t),i=(r?t.substr(0,t.length-r[0].length):t)||e,a="",l=r&&parseInt(r[1])||0;;l++)if(a=l>0?i+"_"+l:i,n.indexOf(a)<0){n.push(a);break}return a},e.prototype.setIsEntityKnown=function(e,t){var n=this.state.knownEntityElements.indexOf(e);t&&n<0?this.state.knownEntityElements.push(e):!t&&n>=0&&this.state.knownEntityElements.splice(n,1)},e.prototype.isEntityKnown=function(e){return this.state.knownEntityElements.indexOf(e)>=0},e}();t.default=s;var u=i.Browser.isIE?function(e){e.runAsync((function(e){var t=e.getCustomData("ENTITY_IE_FOCUS_BUTTON",(function(){var t=(0,i.createElement)({tag:"button",style:"overflow:hidden;position:fixed;width:0;height:0;top:-1000px"},e.getDocument());return t.onblur=function(){t.style.display="none"},e.insertNode(t,{position:4}),t}));t.style.display="",(0,i.addRangeToSelection)((0,i.createRange)(t,0))}))}:function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeDelimitersInEditor=t.inlineEntityOnPluginEvent=void 0;var r=n(0),i=".entityDelimiterAfter,.entityDelimiterBefore",o="span"+(0,r.getEntitySelector)();function a(e){var t,n,i,o;e.normalize();var a,l=e.firstChild,s=null!==(n=null===(t=l.nodeValue)||void 0===t?void 0:t.indexOf(""))&&void 0!==n?n:-1;if(s>=0&&((0,r.splitTextNode)(l,0==s?1:s,!1),e.childNodes.forEach((function(e){""!==e.nodeValue&&(a=e)})),a)){null===(i=e.parentElement)||void 0===i||i.insertBefore(a,"entityDelimiterBefore"==e.className?e:e.nextSibling);var u=null===(o=a.ownerDocument)||void 0===o?void 0:o.getSelection();u&&u.setPosition(a,new r.Position(a,-1).offset)}}function l(e){e.queryElements(i).forEach((function(e){if((0,r.getDelimiterFromElement)(e)){var t=e.classList.contains("entityDelimiterBefore")?e.nextElementSibling:e.previousElementSibling;(0,r.safeInstanceOf)(t,"HTMLElement")&&(0,r.getEntityFromElement)(t)||d(e)}else c(e)})),s(e.queryElements(o))}function s(e){e.forEach((function(e){u(e)&&(0,r.addDelimiters)(e)}))}function u(e){return!!(e&&(0,r.safeInstanceOf)(e,"HTMLElement")&&(t=(0,r.getEntityFromElement)(e),(null==t?void 0:t.isReadonly)&&!(0,r.isBlockElement)(t.wrapper)&&(0,r.safeInstanceOf)(t.wrapper,"HTMLElement")));var t}function d(e){var t;null===(t=null==e?void 0:e.parentElement)||void 0===t||t.removeChild(e)}function c(e,t){if(void 0===t&&(t=!0),e){var n=e.classList.contains("entityDelimiterAfter")?e.previousElementSibling:e.nextElementSibling;t&&n&&u(n)||(e.classList.remove("entityDelimiterAfter","entityDelimiterBefore"),e.normalize(),e.childNodes.forEach((function(e){var t,n,i,o=null!==(n=null===(t=e.textContent)||void 0===t?void 0:t.indexOf(""))&&void 0!==n?n:-1;o>=0&&(null===(i=(0,r.createRange)(e,o,e,o+1))||void 0===i||i.deleteContents())})))}}t.inlineEntityOnPluginEvent=function(e,t){switch(e.eventType){case 7:"SetContent"===e.source&&l(t);break;case 11:l(t);break;case 10:var n=e.fragment,h=e.sanitizingOption;s(n.querySelectorAll(o)),h.additionalAllowedCssClasses&&(0,r.arrayPush)(h.additionalAllowedCssClasses,["entityDelimiterAfter","entityDelimiterBefore"]);break;case 8:case 9:e.clonedRoot.querySelectorAll(i).forEach(d);break;case 0:!function(e,t){var n,o,l=e.getSelectionRangeEx(),s=t.rawEvent;if(0!=l.type)return;if(l.areAllCollapsed&&((0,r.isCharacterValue)(s)||13===s.which)){var d=null===(n=e.getFocusedPosition())||void 0===n?void 0:n.normalize();if(!d)return;var h=d.element,p=d.node,v=h==p?h.childNodes.item(d.offset):h,g=e.getElementAtCursor(i,v);if(!g)return;13===s.which?function(e,t){var n,o=t.classList.contains("entityDelimiterAfter"),a=o?t.previousSibling:t.nextSibling,l=null===(n=e.getBlockElementAtNode(t))||void 0===n?void 0:n.getStartNode();e.runAsync((function(){if(l){var e=o?l.nextSibling:l.previousSibling;if(e&&(0,r.safeInstanceOf)(e,"HTMLElement")){var t=e.querySelectorAll(i);c(t.item(o?0:t.length-1))}if(u(a))[a.nextElementSibling,a.previousElementSibling].forEach((function(e){e&&(0,r.matchesSelector)(e,i)&&!(0,r.getDelimiterFromElement)(e)&&c(e,!1)})),(0,r.addDelimiters)(a)}}))}(e,g):3==(null===(o=g.firstChild)||void 0===o?void 0:o.nodeType)&&e.runAsync((function(){return a(g)}))}else if(!l.areAllCollapsed&&!s.shiftKey&&16!=s.which){var m=l.ranges[0];if(!m)return;!function(e,t,n){var o=t.startContainer,l=t.endContainer,s=t.startOffset,u=t.endOffset,d=e.getElementAtCursor(i,o),h=e.getElementAtCursor(i,l),p=f(d),v=f(h);(p||v)&&e.select(null!=p?p:new r.Position(o,s),null!=v?v:new r.Position(l,u));e.runAsync((function(e){var t=e.getElementAtCursor(i);t&&(a(t),13===n.which&&c(t))}))}(e,m,s)}}(t,e)}},t.normalizeDelimitersInEditor=l;var f=function(e){if(e&&(0,r.getDelimiterFromElement)(e)){var t=e.classList.contains("entityDelimiterAfter");return new r.Position(e,t?-3:-2)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"ImageSelection"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e;null===(e=this.editor)||void 0===e||e.select(null),this.editor=null},e.prototype.onPluginEvent=function(e){var t;if(this.editor)switch(e.eventType){case 17:case 18:var n=this.editor.getSelectionRangeEx();2==n.type&&this.editor.select(n.image);break;case 6:var i=e.rawEvent.target;if((0,r.safeInstanceOf)(i,"HTMLImageElement"))if(2===e.rawEvent.button){var o=(0,r.createRange)(i);this.editor.select(o)}else 0===e.rawEvent.button&&this.editor.select(i);break;case 5:var a=e.rawEvent.target,l=this.editor.getSelectionRangeEx();l&&2===l.type&&l.image!==a&&this.editor.select(null);break;case 2:var s=e.rawEvent.key,u=this.editor.getSelectionRangeEx();2===u.type&&("Escape"===s?(this.editor.select(u.image,-2),null===(t=this.editor.getSelectionRange())||void 0===t||t.collapse(),e.rawEvent.stopPropagation()):"Delete"===s?(this.editor.deleteNode(u.image),e.rawEvent.preventDefault()):this.editor.select(u.ranges[0]))}},e}();t.default=i},function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=o.Browser.isFirefox?((r={}).enableObjectResizing=!1,r.enableInlineTableEditing=!1,r):o.Browser.isIE?((i={}).defaultParagraphSeparator="div",i.AutoUrlDetect=!1,i):{},l={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},s={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"},u=function(){function e(e,t){var n,r,i,a=this;this.editor=null,this.initializer=null,this.disposer=null,this.initialContent=e.initialContent||t.innerHTML||"",this.contentDivFormat=(0,o.getComputedStyles)(t),null===t.getAttribute("contenteditable")&&(this.initializer=function(){t.contentEditable="true",t.style.userSelect="text",t.style.webkitUserSelect="text"},this.disposer=function(){t.style.userSelect="",t.style.webkitUserSelect="",t.removeAttribute("contenteditable")}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){var e,n=s,r=l,i=a.state.isDarkMode,u=null===(e=a.editor)||void 0===e?void 0:e.getDarkColorHandler();(0,o.setColor)(t,n,!1,i,!1,u),(0,o.setColor)(t,r,!0,i,!1,u)},this.state={customData:{},defaultFormat:null!==(n=e.defaultFormat)&&void 0!==n?n:null,isDarkMode:!!e.inDarkMode,getDarkColor:null!==(r=e.getDarkColor)&&void 0!==r?r:function(e){return e},onExternalContentTransform:null!==(i=e.onExternalContentTransform)&&void 0!==i?i:null,experimentalFeatures:e.experimentalFeatures||[],shadowEditFragment:null,shadowEditEntities:null,shadowEditSelectionPath:null,shadowEditTableSelectionPath:null,shadowEditImageSelectionPath:null}}return e.prototype.getName=function(){return"Lifecycle"},e.prototype.initialize=function(e){var t;this.editor=e,this.recalculateDefaultFormat(),this.editor.setContent(this.initialContent,!1),null===(t=this.initializer)||void 0===t||t.call(this),this.adjustColor(),this.adjustBrowserBehavior(),this.editor.triggerPluginEvent(11,{},!0)},e.prototype.dispose=function(){var e,t=this;null===(e=this.editor)||void 0===e||e.triggerPluginEvent(12,{},!0),(0,o.getObjectKeys)(this.state.customData).forEach((function(e){var n=t.state.customData[e];n&&n.disposer&&n.disposer(n.value),delete t.state.customData[e]})),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){7!=e.eventType||"SwitchToDarkMode"!=e.source&&"SwitchToLightMode"!=e.source||(this.state.isDarkMode="SwitchToDarkMode"==e.source,this.recalculateDefaultFormat(),this.adjustColor())},e.prototype.adjustBrowserBehavior=function(){var e=this;(0,o.getObjectKeys)(a).forEach((function(t){var n;try{null===(n=e.editor)||void 0===n||n.getDocument().execCommand(t,!1,a[t])}catch(e){}}))},e.prototype.recalculateDefaultFormat=function(){var e=this.state,t=e.defaultFormat,n=e.isDarkMode;if(n&&t&&(t.backgroundColors||(t.backgroundColors=l),t.textColors||(t.textColors=s)),!t||0!==(0,o.getObjectKeys)(t).length){var r=t||{},i=r.fontFamily,a=r.fontSize,u=r.textColor,d=r.textColors,c=r.backgroundColor,f=r.backgroundColors,h=r.bold,p=r.italic,v=r.underline,g=this.contentDivFormat;this.state.defaultFormat={fontFamily:i||g[0],fontSize:a||g[1],get textColor(){return d?n?d.darkModeColor:d.lightModeColor:u||g[2]},textColors:d,get backgroundColor(){return f?n?f.darkModeColor:f.lightModeColor:c||""},backgroundColors:f,bold:h,italic:p,underline:v}}},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.editor=null,this.mouseUpEventListerAdded=!1,this.mouseDownX=null,this.mouseDownY=null,this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerPluginEvent(6,{rawEvent:t,isClicking:e.mouseDownX==t.pageX&&e.mouseDownY==t.pageY}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){this.editor&&5==e.eventType&&!this.mouseUpEventListerAdded&&(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0,this.mouseDownX=e.rawEvent.pageX,this.mouseDownY=e.rawEvent.pageY)},e.prototype.removeMouseUpEventListener=function(){this.editor&&this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"NormalizeTable"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 11:case 7:this.editor&&this.normalizeTables(this.editor.queryElements("table"));break;case 10:this.normalizeTables((0,r.toArray)(e.fragment.querySelectorAll("table")));break;case 5:this.normalizeTableFromEvent(e.rawEvent);break;case 0:e.rawEvent.shiftKey&&this.normalizeTableFromEvent(e.rawEvent);break;case 8:t=e.clonedRoot,(0,r.toArray)(t.querySelectorAll("li")).forEach((function(e){var t=e.previousSibling;"block"==e.style.display&&(0,r.safeInstanceOf)(t,"HTMLLIElement")&&(e.style.removeProperty("display"),t.appendChild((0,r.changeElementTag)(e,"div")))}))}var t},e.prototype.normalizeTableFromEvent=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor("table",e.target);n&&this.normalizeTables([n])},e.prototype.normalizeTables=function(e){if(this.editor&&e.length>0){var t=this.editor.getSelectionRangeEx(),n=0==(null==t?void 0:t.type)&&t.ranges[0]||{},i=n.startContainer,o=n.endContainer,a=n.startOffset,l=n.endOffset;(function(e){var t=!1;return e.forEach((function(e){for(var n,i=null,o=e.firstChild;o;o=o.nextSibling){switch((0,r.getTagOfNode)(o)){case"TR":i||(i=e.ownerDocument.createElement("tbody"),e.insertBefore(i,o)),i.appendChild(o),o=i,t=!0;break;case"TBODY":i?((0,r.moveChildNodes)(i,o,!0),null===(n=o.parentNode)||void 0===n||n.removeChild(o),o=i,t=!0):i=o;break;default:i=null}}var a=e.querySelectorAll("colgroup"),l=e.querySelector("thead");l&&a.forEach((function(e){l.contains(e)||l.appendChild(e)}))})),t})(e)&&(i&&o&&"number"==typeof a&&"number"==typeof l?this.editor.select(i,a,o,l):1==(null==t?void 0:t.type)&&t.coordinates&&this.editor.select(t.table,t.coordinates))}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){this.editor=null,this.state={pendableFormatPosition:null,pendableFormatState:null,pendableFormatSpan:null}}return e.prototype.getName=function(){return"PendingFormatState"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.clear()},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 13:e.formatState?(this.state.pendableFormatPosition=this.getCurrentPosition(),this.state.pendableFormatState=e.formatState,this.state.pendableFormatSpan=e.formatCallback?this.createPendingFormatSpan(e.formatCallback):null):this.clear();break;case 0:case 5:case 7:var t=null;this.editor&&0==e.eventType&&(0,r.isCharacterValue)(e.rawEvent)&&this.state.pendableFormatSpan?(this.state.pendableFormatSpan.removeAttribute("contentEditable"),this.editor.insertNode(this.state.pendableFormatSpan),this.editor.select(this.state.pendableFormatSpan,0,this.state.pendableFormatSpan,-1),this.clear()):(0==e.eventType&&e.rawEvent.which>=33&&e.rawEvent.which<=40||this.state.pendableFormatPosition&&(t=this.getCurrentPosition())&&!this.state.pendableFormatPosition.equalTo(t)||7==e.eventType&&("SwitchToDarkMode"==e.source||"SwitchToLightMode"==e.source))&&this.clear()}},e.prototype.clear=function(){this.state.pendableFormatPosition=null,this.state.pendableFormatState=null,this.state.pendableFormatSpan=null},e.prototype.getCurrentPosition=function(){var e,t,n=null===(e=this.editor)||void 0===e?void 0:e.getSelectionRange();return null!==(t=n&&r.Position.getStart(n).normalize())&&void 0!==t?t:null},e.prototype.createPendingFormatSpan=function(e){var t,n,i=this.state.pendableFormatSpan;if(!i&&this.editor){var o=this.editor.getStyleBasedFormatState(),a=this.editor.getDocument(),l=this.editor.isDarkMode();(i=a.createElement("span")).contentEditable="true",i.appendChild(a.createTextNode("")),i.style.setProperty("font-family",null!==(t=o.fontName)&&void 0!==t?t:null),i.style.setProperty("font-size",null!==(n=o.fontSize)&&void 0!==n?n:null);var s=this.editor.getDarkColorHandler();(o.textColors||o.textColor)&&(0,r.setColor)(i,o.textColors||o.textColor,!1,l,!1,s),(o.backgroundColors||o.backgroundColor)&&(0,r.setColor)(i,o.backgroundColors||o.backgroundColor,!0,l,!1,s)}return i&&e(i),i},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.isRangeEmpty=function(e){return!(!e.collapsed||e.startContainer.nodeType!==Node.ELEMENT_NODE||"DIV"!=(0,r.getTagOfNode)(e.startContainer)||e.startContainer.firstChild)},e.prototype.onPluginEvent=function(e){var t,n,i,o,a,l,s=this;if(1==e.eventType&&this.editor&&(!e.rawEvent||!(0,r.isCtrlOrMetaPressed)(e.rawEvent))){var u=this.editor.getSelectionRange(),d=u&&(0,r.findClosestElementAncestor)(u.startContainer,void 0,"[style]");if(!u||!this.isRangeEmpty(u)&&this.editor.contains(d))return;if(u.collapsed)this.editor.ensureTypeInContainer(r.Position.getStart(u),e.rawEvent);else{var c=function(){var t,n,r=null===(t=s.editor)||void 0===t?void 0:t.getFocusedPosition();r&&(null===(n=s.editor)||void 0===n||n.ensureTypeInContainer(r,e.rawEvent))};r.Browser.isMobileOrTablet?null===(t=this.editor.getDocument().defaultView)||void 0===t||t.setTimeout(c,100):this.editor.runAsync(c)}}if(0==e.eventType&&8==e.rawEvent.which&&(null===(n=this.editor)||void 0===n?void 0:n.isFeatureEnabled("DefaultFormatInSpan"))){var f=null===(i=this.editor)||void 0===i?void 0:i.getElementAtCursor(),h=f&&(null===(a=null===(o=this.editor)||void 0===o?void 0:o.getBlockElementAtNode(f))||void 0===a?void 0:a.getStartNode().previousSibling);h&&(null===(l=this.editor)||void 0===l||l.runAsync((function(t){var n=t.getFocusedPosition();n&&h==n.element&&t.ensureTypeInContainer(n,e.rawEvent)})))}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e){var t,n,i;this.editor=null,this.lastKeyPress=null,this.state={snapshotsService:e.undoMetadataSnapshotService||(n=e.undoSnapshotService,n?{canMove:function(e){return n.canMove(e)},move:function(e){return(i=n.move(e))?{html:i,metadata:null,knownColors:[]}:null},addSnapshot:function(e,t){return n.addSnapshot(e.html+(e.metadata?"\x3c!--"+JSON.stringify(e.metadata)+"--\x3e":""),t)},clearRedo:function(){return n.clearRedo()},canUndoAutoComplete:function(){return n.canUndoAutoComplete()}}:void 0)||(t=(0,r.createSnapshots)(1e7),{canMove:function(e){return(0,r.canMoveCurrentSnapshot)(t,e)},move:function(e){return(0,r.moveCurrentSnapshot)(t,e)},addSnapshot:function(e,n){return(0,r.addSnapshotV2)(t,e,n)},clearRedo:function(){return(0,r.clearProceedingSnapshotsV2)(t)},canUndoAutoComplete:function(){return(0,r.canUndoAutoComplete)(t)}}),isRestoring:!1,hasNewContent:!1,isNested:!1,autoCompletePosition:null}}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.willHandleEventExclusively=function(e){return 0==e.eventType&&8==e.rawEvent.which&&this.canUndoAutoComplete()},e.prototype.onPluginEvent=function(e){if(this.editor&&!this.editor.isInIME())switch(e.eventType){case 11:var t=this.editor.getUndoState();t.canUndo||t.canRedo||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 4:this.clearRedoForInput(),this.addUndoSnapshot();break;case 7:this.state.isRestoring||"SwitchToDarkMode"==e.source||"SwitchToLightMode"==e.source||this.clearRedoForInput()}},e.prototype.onKeyDown=function(e){var t,n;if(8==e.which&&!e.altKey||46==e.which)if(8==e.which&&this.canUndoAutoComplete())e.preventDefault(),null===(t=this.editor)||void 0===t||t.undo(),this.state.autoCompletePosition=null,this.lastKeyPress=e.which;else{var i=null===(n=this.editor)||void 0===n?void 0:n.getSelectionRange();!i||i.collapsed&&this.lastKeyPress==e.which&&!(0,r.isCtrlOrMetaPressed)(e)||this.addUndoSnapshot(),this.state.hasNewContent=!0,this.lastKeyPress=e.which}else e.which>=33&&e.which<=40&&(this.state.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},e.prototype.onKeyPress=function(e){var t;if(!e.metaKey){var n=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n&&!n.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.state.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.clearRedoForInput=function(){this.state.snapshotsService.clearRedo(),this.lastKeyPress=0,this.state.hasNewContent=!0},e.prototype.canUndoAutoComplete=function(){var e,t,n=null===(e=this.editor)||void 0===e?void 0:e.getFocusedPosition();return this.state.snapshotsService.canUndoAutoComplete()&&!!n&&!!(null===(t=this.state.autoCompletePosition)||void 0===t?void 0:t.equalTo(n))},e.prototype.addUndoSnapshot=function(){var e;null===(e=this.editor)||void 0===e||e.addUndoSnapshot(),this.state.autoCompletePosition=null},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=/^\s*var\(\s*(\-\-[a-zA-Z0-9\-_]+)\s*(?:,\s*(.*))?\)\s*$/,o=function(){function e(e,t){this.contentDiv=e,this.getDarkColor=t,this.knownColors={}}return e.prototype.getKnownColorsCopy=function(){return Object.values(this.knownColors)},e.prototype.registerColor=function(e,t,n){var r,i=this.parseColorValue(e);return i&&(e=i.lightModeColor,n=i.darkModeColor||n,r=i.key),t&&e?(r=r||"--darkColor_"+e.replace(/[^\d\w]/g,"_"),this.knownColors[r]||(n=n||this.getDarkColor(e),this.knownColors[r]={lightModeColor:e,darkModeColor:n},this.contentDiv.style.setProperty(r,n)),"var("+r+", "+e+")"):e},e.prototype.reset=function(){var e=this;(0,r.getObjectKeys)(this.knownColors).forEach((function(t){return e.contentDiv.style.removeProperty(t)})),this.knownColors={}},e.prototype.parseColorValue=function(e,t){var n,r,o,a="";if(e){var l=e.startsWith("var(")?i.exec(e):null;l?l[2]?(r=l[1],a=l[2],o=null===(n=this.knownColors[r])||void 0===n?void 0:n.darkModeColor):a="":t?(a=this.findLightColorFromDarkColor(e)||"")&&(o=e):a=e}return{key:r,lightModeColor:a,darkModeColor:o}},e.prototype.findLightColorFromDarkColor=function(e){var t=this,n=(0,r.parseColor)(e);if(n){var i=(0,r.getObjectKeys)(this.knownColors).find((function(e){var i=(0,r.parseColor)(t.knownColors[e].darkModeColor);return i&&i[0]==n[0]&&i[1]==n[1]&&i[2]==n[2]}));if(i)return this.knownColors[i].lightModeColor}return null},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coreApiMap=void 0;var r=n(190),i=n(191),o=n(192),a=n(193),l=n(194),s=n(195),u=n(196),d=n(197),c=n(198),f=n(199),h=n(95),p=n(200),v=n(201),g=n(202),m=n(203),y=n(204),b=n(205),C=n(206),E=n(207),S=n(208);t.coreApiMap={attachDomEvent:i.attachDomEvent,addUndoSnapshot:r.addUndoSnapshot,createPasteFragment:o.createPasteFragment,ensureTypeInContainer:a.ensureTypeInContainer,focus:l.focus,getContent:s.getContent,getSelectionRange:d.getSelectionRange,getSelectionRangeEx:c.getSelectionRangeEx,getStyleBasedFormatState:f.getStyleBasedFormatState,getPendableFormatState:u.getPendableFormatState,hasFocus:h.hasFocus,insertNode:p.insertNode,restoreUndoSnapshot:v.restoreUndoSnapshot,selectRange:m.selectRange,setContent:b.setContent,switchShadowEdit:C.switchShadowEdit,transformColor:E.transformColor,triggerEvent:S.triggerEvent,selectTable:y.selectTable,selectImage:g.selectImage}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.addUndoSnapshot=void 0;var i=n(0);function o(e,t){var n;if(!e.lifecycle.shadowEditFragment){var o=e.api.getSelectionRangeEx(e),a=e.lifecycle.isDarkMode,l=function(e,t,n){switch(null==t?void 0:t.type){case 1:return r({type:1,tableId:t.table.id,isDarkMode:!!n},t.coordinates);case 2:return{type:2,imageId:t.image.id,isDarkMode:!!n};case 0:return r({type:0,isDarkMode:!!n,start:[],end:[]},(0,i.getSelectionPath)(e,t.ranges[0])||{})}}(e.contentDiv,o,a)||null;e.undo.snapshotsService.addSnapshot({html:e.contentDiv.innerHTML,metadata:l,knownColors:(null===(n=e.darkColorHandler)||void 0===n?void 0:n.getKnownColorsCopy())||[]},t),e.undo.hasNewContent=!1}}t.addUndoSnapshot=function(e,t,n,r,a){var l,s=e.undo,u=s.isNested;u||(s.isNested=!0,o(e,r));try{var d;if(t)l=t((d=e.api.getSelectionRange(e,!0))&&i.Position.getStart(d).normalize(),d&&i.Position.getEnd(d).normalize()),u||o(e,!1)}finally{u||(s.isNested=!1)}if(t&&n){var c={eventType:7,source:n,data:l,additionalData:a};e.api.triggerEvent(e,c,!0)}r&&((d=e.api.getSelectionRange(e,!1))&&(e.undo.hasNewContent=!1,e.undo.autoCompletePosition=i.Position.getStart(d)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachDomEvent=void 0;var r=n(0);t.attachDomEvent=function(e,t){var n=(0,r.getObjectKeys)(t||{}).map((function(n){var r=function(e){var t={pluginEventType:null,beforeDispatch:null};"number"==typeof e?t.pluginEventType=e:"function"==typeof e?t.beforeDispatch=e:"object"==typeof e&&(t=e);return t}(t[n]),i=r.pluginEventType,o=r.beforeDispatch,a=n,l=function(t){o&&o(t),null!=i&&e.api.triggerEvent(e,{eventType:i,rawEvent:t},!1)};return e.contentDiv.addEventListener(a,l),function(){e.contentDiv.removeEventListener(a,l)}}));return function(){return n.forEach((function(e){return e()}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformTabCharacters=t.createPasteFragment=void 0;var r=n(0);function i(e,t){void 0===t&&(t=0);for(var n,r=e;-1!=(n=r.indexOf("\t"));){var i=r.slice(0,n),o=r.slice(n+1),a=6-(i.length+t)%6;r=i+Array(a).fill("").join("")+o}return r}function o(e,t){(0,r.toArray)(e.querySelectorAll("style")).forEach(t)}t.createPasteFragment=function(e,t,n,a,l){var s,u;if(!t)return null;var d=function(e,t){var n=(0,r.createDefaultHtmlSanitizerOptions)();return n.cssStyleCallbacks["caret-color"]=function(){return!1},{eventType:10,clipboardData:t,fragment:e.contentDiv.ownerDocument.createDocumentFragment(),sanitizingOption:n,htmlBefore:"",htmlAfter:"",htmlAttributes:{}}}(e,t),c=d.fragment,f=d.sanitizingOption,h=t.rawHtml,p=t.text,v=t.imageDataUri,g=e.contentDiv.ownerDocument,m=h?(new DOMParser).parseFromString(e.trustedHTMLHandler(h),"text/html"):void 0;if(h&&(null==m?void 0:m.body)){var y=null===(s=m.querySelector("html"))||void 0===s?void 0:s.attributes;(y?(0,r.toArray)(y):[]).reduce((function(e,t){return e[t.name]=t.value,e}),d.htmlAttributes),(0,r.toArray)(m.querySelectorAll("meta")).reduce((function(e,t){return e[t.name]=t.content,e}),d.htmlAttributes),t.htmlFirstLevelChildTags=[],null==m||m.body.normalize();for(var b=0;b<(null==m?void 0:m.body.childNodes.length);b++){var C=null==m?void 0:m.body.childNodes.item(b);if(C.nodeType==Node.TEXT_NODE)if(!(null===(u=C.nodeValue)||void 0===u?void 0:u.replace(/(\r\n|\r|\n)/gm,"").trim()))continue;var E=(0,r.getTagOfNode)(C);C.nodeType!=Node.COMMENT_NODE&&t.htmlFirstLevelChildTags.push(E)}o(m,(function(e){null==m||m.head.appendChild(e),f.additionalGlobalStyleNodes.push(e)}));var S=h.indexOf("\x3c!--StartFragment--\x3e"),w=h.lastIndexOf("\x3c!--EndFragment--\x3e");S>=0&&w>=S+"\x3c!--StartFragment--\x3e".length&&(d.htmlBefore=h.substr(0,S),d.htmlAfter=h.substr(w+"\x3c!--EndFragment--\x3e".length),t.html=h.substring(S+"\x3c!--StartFragment--\x3e".length,w),m.body.innerHTML=e.trustedHTMLHandler(t.html),o(m.body,(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)})))}if(a||p||!v)if(!a&&h&&m&&m.body){if((0,r.moveChildNodes)(c,null==m?void 0:m.body),l&&n){var T=function(e,t){var n=e.api.getPendableFormatState(e,!0),r=e.api.getStyleBasedFormatState(e,t);return{fontFamily:r.fontName,fontSize:r.fontSize,textColor:r.textColor,backgroundColor:r.backgroundColor,textColors:r.textColors,backgroundColors:r.backgroundColors,bold:n.isBold,italic:n.isItalic,underline:n.isUnderline}}(e,n.node);(0,r.applyTextStyle)(c,(function(e){return(0,r.applyFormat)(e,T)}))}}else p&&p.split("\n").forEach((function(e,t,o){(e=e.replace(/^ /g,"").replace(/\r/g,"").replace(/ {2}/g," ")).includes("\t")&&(e=i(e,0===t?null==n?void 0:n.offset:0));var a=g.createTextNode(e);2==o.length&&0==t?(c.appendChild(a),c.appendChild(g.createElement("br"))):t>0&&t<o.length-1?c.appendChild((0,r.wrap)(""==e?g.createElement("br"):a)):c.appendChild(a)}));else{var P=g.createElement("img");P.style.maxWidth="100%",P.src=v,c.appendChild(P)}e.api.triggerEvent(e,d,!0);var O=new r.HtmlSanitizer(d.sanitizingOption);return O.convertGlobalCssToInlineCss(c),O.sanitize(c,n?(0,r.getInheritableStyles)(n.element):void 0),c},t.transformTabCharacters=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureTypeInContainer=void 0;var r=n(0);t.ensureTypeInContainer=function(e,t,n,i){var o,a=(0,r.findClosestElementAncestor)(t.node,e.contentDiv,"table");a&&(o=a.querySelector("td,th"))&&(t=new r.Position(o,0)),t=t.normalize();var l,s=(0,r.getBlockElementAtNode)(e.contentDiv,t.node);if(s){if(l=s.collapseToSingleElement(),(0,r.isNodeEmpty)(l,!1,!0)){var u=l.ownerDocument.createElement("br");l.append(u)}var d=(0,r.isNodeEmpty)(l)||n&&function(e,t){return(0,r.safeInstanceOf)(e.target,"Node")&&e.target.contains(t)&&e.key===t.innerText}(n,l);if((l=l&&d?l:null)&&e.lifecycle.defaultFormat&&i){var c=l.firstChild;l=(0,r.safeInstanceOf)(c,"HTMLSpanElement")?c:(0,r.wrap)((0,r.toArray)(l.childNodes),"span")}}else l=(0,r.createElement)(i?12:1,e.contentDiv.ownerDocument),e.api.insertNode(e,l,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),l=i?l.firstChild:l,t=new r.Position(l,0);l&&e.lifecycle.defaultFormat&&(0,r.applyFormat)(l,e.lifecycle.defaultFormat,e.lifecycle.isDarkMode,e.darkColorHandler),n&&e.api.selectRange(e,(0,r.createRange)(new r.Position(t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.focus=void 0;var r=n(0);t.focus=function(e){if(!e.lifecycle.shadowEditFragment){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.domEvent.selectionRange&&e.api.selectRange(e,e.domEvent.selectionRange,!0))){var t=(0,r.getFirstLeafNode)(e.contentDiv)||e.contentDiv;e.api.selectRange(e,(0,r.createRange)(t,0),!0)}e.domEvent.selectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getContent=void 0;var r=n(0);t.getContent=function(e,t){var n="",i=0==t,o=2==t,a=e.lifecycle.shadowEditFragment||e.contentDiv;if(4==t)n=a.textContent;else if(3==t)n=(0,r.getTextContent)(a);else if(i||e.lifecycle.isDarkMode||e.darkColorHandler){var l=function(e){var t;(0,r.safeInstanceOf)(e,"DocumentFragment")?(t=e.ownerDocument.createElement("div")).appendChild(e.cloneNode(!0)):t=e.cloneNode(!0);return t}(a);l.normalize();var s=e.api.getSelectionRange(e,!0),u=o?e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath:s?(0,r.getSelectionPath)(e.contentDiv,s):null:null,d=u&&(0,r.createRange)(l,u.start,u.end);(e.lifecycle.isDarkMode||e.darkColorHandler)&&e.api.transformColor(e,l,!1,null,1,!!e.darkColorHandler,e.lifecycle.isDarkMode),i?(e.api.triggerEvent(e,{eventType:8,clonedRoot:l},!0),n=l.innerHTML):n=d?(0,r.getHtmlWithSelectionPath)(l,d):l.innerHTML}else n=(0,r.getHtmlWithSelectionPath)(a,o?e.api.getSelectionRange(e,!0):null);return null!=n?n:""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPendableFormatState=void 0;var r=n(0);t.getPendableFormatState=function(e,t){var n,a=e.api.getSelectionRange(e,!0),l=e.pendingFormatState.pendableFormatState,s=null===(n=e.pendingFormatState.pendableFormatPosition)||void 0===n?void 0:n.normalize(),u=a&&r.Position.getStart(a).normalize(),d=u&&s&&a.collapsed&&u.equalTo(s);return a&&l&&d&&!t?l:u?function(e,t){var n=t.node,a={},l=[],s=function(){var e=(0,r.getTagOfNode)(n),t=1==n.nodeType&&n.style;e&&t&&(0,r.getObjectKeys)(i).forEach((function(n){l.indexOf(n)>=0||(a[n]=a[n]||i[n](e,t),o[n](t)&&l.push(n))})),n=n.parentNode};for(;n&&(0,r.contains)(e.contentDiv,n);)s();return a}(e,u):{}};var i={isBold:function(e,t){return"B"==e||"STRONG"==e||"H1"==e||"H2"==e||"H3"==e||"H4"==e||"H5"==e||"H6"==e||parseInt(t.fontWeight)>=700||["bold","bolder"].indexOf(t.fontWeight)>=0},isUnderline:function(e,t){return"U"==e||t.textDecoration.indexOf("underline")>=0},isItalic:function(e,t){return"I"==e||"EM"==e||"italic"===t.fontStyle},isSubscript:function(e,t){return"SUB"==e||"sub"===t.verticalAlign},isSuperscript:function(e,t){return"SUP"==e||"super"===t.verticalAlign},isStrikeThrough:function(e,t){return"S"==e||"STRIKE"==e||t.textDecoration.indexOf("line-through")>=0}},o={isBold:function(e){return""!==e.fontWeight&&parseInt(e.fontWeight)<700||"normal"===e.fontWeight},isUnderline:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("underline")<0},isItalic:function(e){return""!==e.fontStyle&&"italic"!==e.fontStyle},isSubscript:function(e){return""!==e.verticalAlign&&"sub"!==e.verticalAlign},isSuperscript:function(e){return""!==e.verticalAlign&&"super"!==e.verticalAlign},isStrikeThrough:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("line-through")<0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionRange=void 0;var r=n(0);t.getSelectionRange=function(e,t){var n,i=null;if(e.lifecycle.shadowEditFragment)return i=e.lifecycle.shadowEditSelectionPath&&(0,r.createRange)(e.contentDiv,e.lifecycle.shadowEditSelectionPath.start,e.lifecycle.shadowEditSelectionPath.end);if(!t||e.api.hasFocus(e)){var o=null===(n=e.contentDiv.ownerDocument.defaultView)||void 0===n?void 0:n.getSelection();if(o&&o.rangeCount>0){var a=o.getRangeAt(0);(0,r.contains)(e.contentDiv,a)&&(i=a)}}return!i&&t&&(i=e.domEvent.selectionRange),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionRangeEx=void 0;var r=n(0);function i(e){return{type:0,ranges:e,areAllCollapsed:o(e)}}function o(e){return e.filter((function(e){return null==e?void 0:e.collapsed})).length==e.length}t.getSelectionRangeEx=function(e){var t,n,a;if(e.lifecycle.shadowEditFragment){var l,s=e.lifecycle,u=s.shadowEditTableSelectionPath,d=s.shadowEditSelectionPath,c=s.shadowEditImageSelectionPath;if(((null==u?void 0:u.length)||0)>0)return{type:1,ranges:l=e.lifecycle.shadowEditTableSelectionPath.map((function(t){return(0,r.createRange)(e.contentDiv,t.start,t.end)})),areAllCollapsed:o(l),table:(0,r.findClosestElementAncestor)(l[0].startContainer,e.contentDiv,"table"),coordinates:void 0};if(((null==c?void 0:c.length)||0)>0)return{type:2,ranges:l=e.lifecycle.shadowEditImageSelectionPath.map((function(t){return(0,r.createRange)(e.contentDiv,t.start,t.end)})),areAllCollapsed:o(l),image:(0,r.findClosestElementAncestor)(l[0].startContainer,e.contentDiv,"img"),imageId:void 0};var f=d&&(0,r.createRange)(e.contentDiv,d.start,d.end);return i(f?[f]:[])}if(e.api.hasFocus(e)){if(e.domEvent.tableSelectionRange)return e.domEvent.tableSelectionRange;if(e.domEvent.imageSelectionRange)return e.domEvent.imageSelectionRange;var h=null===(t=e.contentDiv.ownerDocument.defaultView)||void 0===t?void 0:t.getSelection();if(h&&h.rangeCount>0){var p=h.getRangeAt(0);if((0,r.contains)(e.contentDiv,p))return i([p])}}return null!==(a=null!==(n=e.domEvent.tableSelectionRange)&&void 0!==n?n:e.domEvent.imageSelectionRange)&&void 0!==a?a:i(e.domEvent.selectionRange?[e.domEvent.selectionRange]:[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStyleBasedFormatState=void 0;var r=n(0);t.getStyleBasedFormatState=function(e,t){if(!t)return{};var n=[],i=e.pendingFormatState.pendableFormatSpan;i&&(n=[i.style.fontFamily,i.style.fontSize,i.style.color,i.style.backgroundColor]);var o=t?(0,r.getComputedStyles)(t,["font-family","font-size","color","background-color","line-height","margin-top","margin-bottom","text-align","direction"]):[],a=e.contentDiv,l=e.darkColorHandler,s=e.lifecycle.isDarkMode;if(l){for(var u=void 0,d=void 0;t&&(0,r.contains)(a,t,!0)&&(!u||!d);){if(1==t.nodeType){var c=t;u=u||c.style.getPropertyValue("color"),d=d||c.style.getPropertyValue("background-color")}t=t.parentNode}e.lifecycle.isDarkMode||t!=e.contentDiv||(u=u||o[2],d=d||o[3]);var f=l.parseColorValue(n[2]||u),h=l.parseColorValue(n[3]||d);return{fontName:n[0]||o[0],fontSize:n[1]||o[1],textColor:f.lightModeColor,backgroundColor:h.lightModeColor,textColors:f.darkModeColor?{lightModeColor:f.lightModeColor,darkModeColor:f.darkModeColor}:void 0,backgroundColors:h.darkModeColor?{lightModeColor:h.lightModeColor,darkModeColor:h.darkModeColor}:void 0,lineHeight:o[4],marginTop:o[5],marginBottom:o[6],textAlign:o[7],direction:o[8]}}var p=s&&(n[2]?i:(0,r.findClosestElementAncestor)(t,a,"[data-ogsc],[data-ogac]")),v=s&&(n[3]?i:(0,r.findClosestElementAncestor)(t,a,"[data-ogsb],[data-ogab]"));return{fontName:n[0]||o[0],fontSize:n[1]||o[1],textColor:n[2]||o[2],backgroundColor:n[3]||o[3],textColors:p?{darkModeColor:n[2]||o[2],lightModeColor:p.dataset.ogsc||p.dataset.ogac||o[2]}:void 0,backgroundColors:v?{darkModeColor:n[3]||o[3],lightModeColor:v.dataset.ogsb||v.dataset.ogab||o[3]}:void 0,lineHeight:o[4],textAlign:o[7],direction:o[8]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertNode=void 0;var r=n(0);t.insertNode=function(e,t,n){var i;n=n||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0,insertToRegionRoot:!1};var o=e.contentDiv;return n.updateCursor&&e.api.focus(e),4==n.position?(null===(i=o.parentNode)||void 0===i||i.insertBefore(t,o.nextSibling),!0):(e.api.transformColor(e,t,!0,(function(){var i,a;if(n)switch(n.position){case 0:case 1:var l,s=0==n.position,u=(0,r.getFirstLastBlockElement)(o,s);if(u){var d=s?u.getStartNode():u.getEndNode();n.insertOnNewLine||3==d.nodeType||(0,r.isVoidHtmlElement)(d)?(0,r.safeInstanceOf)(t,"DocumentFragment")?(l=(0,r.toArray)(t.childNodes),null===(i=d.parentNode)||void 0===i||i.insertBefore(t,s?d:d.nextSibling)):l=null===(a=d.parentNode)||void 0===a?void 0:a.insertBefore(t,s?d:d.nextSibling):l=d.insertBefore(t,s?d.firstChild:null)}else l=o.appendChild(t);if(l&&n.insertOnNewLine){var c=Array.isArray(l)?l:[l];(0,r.isBlockElement)(c[0])&&(0,r.isBlockElement)(c[c.length-1])||(0,r.wrap)(c)}break;case 2:var f=o.appendChild(t);f&&n.insertOnNewLine&&!(0,r.isBlockElement)(f)&&(0,r.wrap)(f);break;case 5:case 3:var h=function(e,t){var n=e.api.getSelectionRange(e,!0),r=null;return 5==t.position?(r=n,n=t.range):n&&(r=n.cloneRange()),{range:n,rangeToRestore:r}}(e,n),p=h.range,v=h.rangeToRestore;if(!p)return;n.replaceSelection&&!p.collapsed&&p.deleteContents();var g=r.Position.getStart(p),m=void 0;g=n.insertOnNewLine&&n.insertToRegionRoot?function(e,t,n){var i=(0,r.getRegionsFromRange)(e.contentDiv,t,0)[0],o=n.node;if(i){if(3!=o.nodeType||n.isAtEnd||(o=(0,r.splitTextNode)(o,n.offset,!0)),o!=i.rootNode)for(;o&&o.parentNode!=i.rootNode;)(0,r.splitParentNode)(o,!1),o=o.parentNode;o&&(n=new r.Position(o,-3))}return n}(e,p,g):n.insertOnNewLine&&(m=(0,r.getBlockElementAtNode)(o,g.normalize().node))?function(e,t,n){var i=new r.Position(e.getEndNode(),-3);if((0,r.safeInstanceOf)(i.node,"HTMLTableRowElement")){var o=t.contentDiv.ownerDocument.createElement("div");(0,r.createRange)(n).insertNode(o),i=new r.Position(o,0)}return i}(m,e,g):(0,r.adjustInsertPosition)(o,t,g,p);var y=11==t.nodeType?t.lastChild:t;(p=(0,r.createRange)(g)).insertNode(t),n.updateCursor&&y&&(v=(0,r.createRange)(new r.Position(y,-3).normalize())),v&&e.api.selectRange(e,v)}}),0),!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreUndoSnapshot=void 0;t.restoreUndoSnapshot=function(e,t){var n;e.undo.hasNewContent&&t<0&&e.api.addUndoSnapshot(e,null,null,!1);var r=e.undo.snapshotsService.move(t);if(r&&null!=r.html)try{e.undo.isRestoring=!0,e.api.setContent(e,r.html,!0,null!==(n=r.metadata)&&void 0!==n?n:void 0);var i=e.darkColorHandler,o=e.lifecycle.isDarkMode;i&&r.knownColors.forEach((function(e){i.registerColor(e.lightModeColor,o,e.darkModeColor)}))}finally{e.undo.isRestoring=!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectImage=void 0;var r=n(96),i=n(0);t.selectImage=function(e,t){l(e);var n=null;if(t){var a=(0,i.createRange)(t);(0,r.default)(t,"imageSelected"),(0,r.default)(e.contentDiv,"contentDiv_"),e.api.selectRange(e,(0,i.createRange)(new i.Position(t,-3))),o(e,t),n={type:2,ranges:[a],image:t,areAllCollapsed:a.collapsed}}return n};var o=function(e,t){(0,i.removeImportantStyleRule)(t,["border","margin"]);var n=a(e,t.id);(0,i.setGlobalCssStyles)(e.contentDiv.ownerDocument,n,"imageStyle"+e.contentDiv.id)},a=function(e,t){return"#"+e.contentDiv.id+" #"+t+" {outline-style: auto!important;outline-color: "+(e.imageSelectionBorderColor||"#DB626C")+"!important;caret-color: transparent!important;}"},l=function(e){var t=e.contentDiv.ownerDocument;(0,i.removeGlobalCssStyle)(t,"imageStyle"+e.contentDiv.id)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectRange=void 0;var r=n(95),i=n(0);t.selectRange=function(e,t,n){return!(e.lifecycle.shadowEditSelectionPath||!(0,i.contains)(e.contentDiv,t))&&((0,i.addRangeToSelection)(t,n),(0,r.hasFocus)(e)||(e.domEvent.selectionRange=t),t.collapsed&&function(e){var t=e.contentDiv,n=e.pendingFormatState,r=e.api.getSelectionRange;if(n.pendableFormatState){var o=t.ownerDocument,a=(0,i.getPendableFormatState)(o);(0,i.getObjectKeys)(i.PendableFormatCommandMap).forEach((function(e){var t;!!(null===(t=n.pendableFormatState)||void 0===t?void 0:t[e])!=a[e]&&o.execCommand(i.PendableFormatCommandMap[e],!1,void 0)}));var l=r(e,!0),s=l&&i.Position.getStart(l);s&&(n.pendableFormatPosition=s)}}(e),!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectTable=void 0;var r=n(96),i=n(0);t.selectTable=function(e,t,n){var u;if(o(e),function(e){if(e){var t=e||{},n=t.firstCell,r=t.lastCell;if(n&&r){var i=function(e){return s(e.x)&&s(e.y)};return i(n)&&i(r)}}return!1}(n)&&t){(0,r.default)(t,"tableSelected"),(0,r.default)(e.contentDiv,"contentDiv_");var d=function(e,t,n){var r="#"+e.contentDiv.id,o=function(e,t,n){var r,o=t.firstCell.y,s=t.firstCell.x,u=t.lastCell.y,d=t.lastCell.x,c=[],f=null,h=null,p=[],v=new i.VTable(e),g=(0,i.toArray)(e.childNodes).filter((function(e){return["THEAD","TBODY","TFOOT"].indexOf((0,i.getTagOfNode)(e))>-1})),m=0,y=g.map((function(e){var t={el:(0,i.getTagOfNode)(e),start:m,end:e.childNodes.length+m};return m=t.end,t}));return null===(r=v.cells)||void 0===r||r.forEach((function(t,r){var v=0;f=null,h=null;for(var g=y.filter((function(e){return e.start<=r&&e.end>r}))[0],m=g?">"+g.el+">":">",b=g&&r+1>=g.start?r+1-g.start:r+1,C=0;C<t.length;C++){var E=t[C].td;if(E){var S=(0,i.getTagOfNode)(E);if(v++,r>=o&&r<=u&&C>=s&&C<=d){l(E);var w=a(n,e.id,m,b,S,v),T=w+" *";p.push(w),p.push(T),f=f||e.querySelector(w),h=e.querySelector(w)}}}if(f&&h){var P=new Range;P.setStartBefore(f),P.setEndAfter(h),c.push(P)}})),{css:p.join(",")+" {background-color: rgb(198,198,198) !important; caret-color: transparent}",ranges:c}}(t,n,r),s=o.css,u=o.ranges;return(0,i.setGlobalCssStyles)(e.contentDiv.ownerDocument,s,"tableStyle"+e.contentDiv.id),u}(e,t,n);if(!function(e,t){var n,r=t.firstCell;return!(e.rows.item(r.y)&&(null===(n=e.rows.item(r.y))||void 0===n?void 0:n.cells.item(r.x)))}(t,n)){var c=null===(u=t.rows.item(n.firstCell.y))||void 0===u?void 0:u.cells.item(n.firstCell.x);c&&e.api.selectRange(e,(0,i.createRange)(new i.Position(c,0)))}return{type:1,ranges:d,table:t,areAllCollapsed:d.filter((function(e){return null==e?void 0:e.collapsed})).length==d.length,coordinates:n}}return null};var o=function(e){var t=e.contentDiv.ownerDocument;(0,i.removeGlobalCssStyle)(t,"tableStyle"+e.contentDiv.id)};function a(e,t,n,r,i,o){return e+" #"+t+n+" tr:nth-child("+r+")>"+i+":nth-child("+o+")"}function l(e){e&&(0,i.removeImportantStyleRule)(e,["background-color","background"])}function s(e){return(!!e||0==e)&&e>-1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setContent=void 0;var r=n(0),i=n(0);t.setContent=function(e,t,n,o){var a=!1;if(e.contentDiv.innerHTML!=t){e.api.triggerEvent(e,{eventType:20,newContent:t},!0);var l=(0,i.setHtmlWithMetadata)(e.contentDiv,t,e.trustedHTMLHandler);(function(e,t){if(!e.lifecycle.shadowEditSelectionPath&&t)switch(e.domEvent.tableSelectionRange=null,e.domEvent.imageSelectionRange=null,e.domEvent.selectionRange=null,t.type){case 0:e.api.selectTable(e,null),e.api.selectImage(e,null);var n=(0,r.createRange)(e.contentDiv,t.start,t.end);e.api.selectRange(e,n);break;case 1:var i=(0,r.queryElements)(e.contentDiv,"#"+t.tableId)[0];i&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,i,t));break;case 2:var o=(0,r.queryElements)(e.contentDiv,"#"+t.imageId)[0];o&&(e.domEvent.imageSelectionRange=e.api.selectImage(e,o))}})(e,o=o||l),a=!0}var s=e.lifecycle.isDarkMode;(!o&&s||o&&!!o.isDarkMode!=!!s)&&(e.api.transformColor(e,e.contentDiv,!1,null,s?0:1,!0,null==o?void 0:o.isDarkMode),a=!0),n&&a&&e.api.triggerEvent(e,{eventType:7,source:"SetContent"},!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchShadowEdit=void 0;var r=n(0);t.switchShadowEdit=function(e,t){var n=e.lifecycle,i=e.contentDiv,o=n.shadowEditEntities,a=n.shadowEditFragment,l=n.shadowEditSelectionPath,s=n.shadowEditTableSelectionPath,u=n.shadowEditImageSelectionPath,d=!!a,c=function(e,t){return(null==t?void 0:t.type)==e&&t.ranges.map((function(e){return(0,r.getSelectionPath)(i,e)})).map((function(e){return e}))||null};if(t){if(!d){var f=e.api.getSelectionRangeEx(e),h=e.api.getSelectionRange(e,!0);l=h&&(0,r.getSelectionPath)(i,h),s=c(1,f),u=c(2,f),o={},a=(0,r.moveContentWithEntityPlaceholders)(i,o),e.api.triggerEvent(e,{eventType:17,fragment:a,selectionPath:l},!1),n.shadowEditFragment=a,n.shadowEditSelectionPath=l,n.shadowEditTableSelectionPath=s,n.shadowEditImageSelectionPath=u,n.shadowEditEntities=o}n.shadowEditFragment&&(0,r.restoreContentWithEntityPlaceholder)(n.shadowEditFragment,i,n.shadowEditEntities,!0)}else if(n.shadowEditFragment=null,n.shadowEditSelectionPath=null,n.shadowEditEntities=null,d){if(e.api.triggerEvent(e,{eventType:18},!1),a&&(0,r.restoreContentWithEntityPlaceholder)(a,i,o),e.api.focus(e),l&&e.api.selectRange(e,(0,r.createRange)(i,l.start,l.end)),e.domEvent.imageSelectionRange){var p=e.domEvent.imageSelectionRange.image;e.contentDiv.querySelector("#"+p.id)&&e.api.selectImage(e,p)}if(e.domEvent.tableSelectionRange){var v=e.domEvent.tableSelectionRange,g=v.table,m=v.coordinates,y=g.id,b=e.contentDiv.querySelector("#"+y);g&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,b,m))}}}},function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.transformColor=void 0;var o=n(0),a=[(r={},r[0]="color",r[1]="color",r[2]="ogsc",r[3]="ogac",r),(i={},i[0]="background-color",i[1]="bgcolor",i[2]="ogsb",i[3]="ogab",i)];function l(e,t){return e&&"undefined"!=e&&"null"!=e?e:t}function s(e){var t=e;return!!t.style&&!!t.dataset}t.transformColor=function(e,t,n,r,i,u,d){var c=e.darkColorHandler,f=t&&(u||e.lifecycle.isDarkMode)?function(e,t){var n=[];if((0,o.safeInstanceOf)(e,"HTMLElement")){t&&n.push(e);var r=e.getElementsByTagName("*");(0,o.arrayPush)(n,(0,o.toArray)(r))}else if((0,o.safeInstanceOf)(e,"DocumentFragment")){r=e.querySelectorAll("*");(0,o.arrayPush)(n,(0,o.toArray)(r))}return n.filter(s)}(t,n):[];null==r||r(),c?function(e,t,n,r){e.forEach((function(e){a.forEach((function(i,a){var l=t.parseColorValue(e.style.getPropertyValue(i[0])||e.getAttribute(i[1]),n).lightModeColor;e.style.setProperty(i[0],null),e.removeAttribute(i[1]),l&&"inherit"!=l&&(0,o.setColor)(e,l,0!=a,r,!1,t)}))}))}(f,c,!!d,0==i):1==i?function(e){e.forEach((function(e){a.forEach((function(t){e.style.setProperty(t[0],l(e.dataset[t[2]],"")),delete e.dataset[t[2]];var n=l(e.dataset[t[3]],null);n?e.setAttribute(t[1],n):e.removeAttribute(t[1]),delete e.dataset[t[3]]}))}))}(f):e.lifecycle.onExternalContentTransform?f.forEach((function(t){return e.lifecycle.onExternalContentTransform(t)})):function(e,t){a.forEach((function(n){e.map((function(e){var r=e.style.getPropertyValue(n[0]),i=e.getAttribute(n[1]),o=e.dataset[n[2]],a=e.dataset[n[3]];return(!o||o==r)&&(!a||a==i)&&(r||i)&&"inherit"!=r?{element:e,styleColor:r,attrColor:i,newColor:r||i?t(r||i):null}:null})).filter((function(e){return!!e})).forEach((function(e){if(e){var t=e.element,r=e.styleColor,i=e.attrColor,o=e.newColor;t.style.setProperty(n[0],o,"important"),t.dataset[n[2]]=r||"",i&&o&&(t.setAttribute(n[1],o),t.dataset[n[3]]=i)}}))}))}(f,e.lifecycle.getDarkColor)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=void 0;var r=[11,12,8,21];t.triggerEvent=function(e,t,n){e.lifecycle.shadowEditFragment&&!(r.indexOf(t.eventType)>=0)||!n&&e.plugins.some((function(e){return function(e,t){var n;if(t.onPluginEvent&&(null===(n=t.willHandleEventExclusively)||void 0===n?void 0:n.call(t,e)))return t.onPluginEvent(e),!0;return!1}(t,e)}))||e.plugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(210);t.default=function(e,t){void 0===t&&(t=21.247);try{var n=r(e||void 0),i=n.lab().array(),o=(100-i[0])*((100-t)/100)+t;e=r.lab(o,i[1],i[2]).rgb().alpha(n.alpha()).toString()}catch(e){}return e}},function(e,t,n){"use strict";var r=n(211),i=n(214),o=[].slice,a=["keyword","gray","hex"],l={};Object.keys(i).forEach((function(e){l[o.call(i[e].labels).sort().join("")]=e}));var s={};function u(e,t){if(!(this instanceof u))return new u(e,t);if(t&&t in a&&(t=null),t&&!(t in i))throw new Error("Unknown model: "+t);var n,d;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof u)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var c=r.get(e);if(null===c)throw new Error("Unable to parse color from string: "+e);this.model=c.model,d=i[this.model].channels,this.color=c.value.slice(0,d),this.valpha="number"==typeof c.value[d]?c.value[d]:1}else if(e.length){this.model=t||"rgb",d=i[this.model].channels;var f=o.call(e,0,d);this.color=h(f,d),this.valpha="number"==typeof e[d]?e[d]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var p=Object.keys(e);"alpha"in e&&(p.splice(p.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var v=p.sort().join("");if(!(v in l))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=l[v];var g=i[this.model].labels,m=[];for(n=0;n<g.length;n++)m.push(e[g[n]]);this.color=h(m)}if(s[this.model])for(d=i[this.model].channels,n=0;n<d;n++){var y=s[this.model][n];y&&(this.color[n]=y(this.color[n]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function d(e,t,n){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(s[e]||(s[e]=[]))[t]=n})),e=e[0],function(r){var i;return arguments.length?(n&&(r=n(r)),(i=this[e]()).color[t]=r,i):(i=this[e]().color[t],n&&(i=n(i)),i)}}function c(e){return function(t){return Math.max(0,Math.min(e,t))}}function f(e){return Array.isArray(e)?e:[e]}function h(e,t){for(var n=0;n<t;n++)"number"!=typeof e[n]&&(e[n]=0);return e}u.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in r.to?this:this.rgb(),n=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return r.to[t.model](n)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),n=1===t.valpha?t.color:t.color.concat(this.valpha);return r.to.rgb.percent(n)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=i[this.model].channels,n=i[this.model].labels,r=0;r<t;r++)e[n[r]]=this.color[r];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new u(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new u(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:d("rgb",0,c(255)),green:d("rgb",1,c(255)),blue:d("rgb",2,c(255)),hue:d(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:d("hsl",1,c(100)),lightness:d("hsl",2,c(100)),saturationv:d("hsv",1,c(100)),value:d("hsv",2,c(100)),chroma:d("hcg",1,c(100)),gray:d("hcg",2,c(100)),white:d("hwb",1,c(100)),wblack:d("hwb",2,c(100)),cyan:d("cmyk",0,c(100)),magenta:d("cmyk",1,c(100)),yellow:d("cmyk",2,c(100)),black:d("cmyk",3,c(100)),x:d("xyz",0,c(100)),y:d("xyz",1,c(100)),z:d("xyz",2,c(100)),l:d("lab",0,c(100)),a:d("lab",1),b:d("lab",2),keyword:function(e){return arguments.length?new u(e):i[this.model].keyword(this.color)},hex:function(e){return arguments.length?new u(e):r.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],n=0;n<e.length;n++){var r=e[n]/255;t[n]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return u.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),n=t.color[0];return n=(n=(n+e)%360)<0?360+n:n,t.color[0]=n,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var n=e.rgb(),r=this.rgb(),i=void 0===t?.5:t,o=2*i-1,a=n.alpha()-r.alpha(),l=((o*a==-1?o:(o+a)/(1+o*a))+1)/2,s=1-l;return u.rgb(l*n.red()+s*r.red(),l*n.green()+s*r.green(),l*n.blue()+s*r.blue(),n.alpha()*i+r.alpha()*(1-i))}},Object.keys(i).forEach((function(e){if(-1===a.indexOf(e)){var t=i[e].channels;u.prototype[e]=function(){if(this.model===e)return new u(this);if(arguments.length)return new u(arguments,e);var n="number"==typeof arguments[t]?t:this.valpha;return new u(f(i[this.model][e].raw(this.color)).concat(n),e)},u[e]=function(n){return"number"==typeof n&&(n=h(o.call(arguments),t)),new u(n,e)}}})),e.exports=u},function(e,t,n){var r=n(98),i=n(212),o={};for(var a in r)r.hasOwnProperty(a)&&(o[r[a]]=a);var l=e.exports={to:{},get:{}};function s(e,t,n){return Math.min(Math.max(t,e),n)}function u(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}l.get=function(e){var t,n;switch(e.substring(0,3).toLowerCase()){case"hsl":t=l.get.hsl(e),n="hsl";break;case"hwb":t=l.get.hwb(e),n="hwb";break;default:t=l.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},l.get.rgb=function(e){if(!e)return null;var t,n,i,o=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(i=t[2],t=t[1],n=0;n<3;n++){var a=2*n;o[n]=parseInt(t.slice(a,a+2),16)}i&&(o[3]=parseInt(i,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(i=(t=t[1])[3],n=0;n<3;n++)o[n]=parseInt(t[n]+t[n],16);i&&(o[3]=parseInt(i+i,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(n=0;n<3;n++)o[n]=parseInt(t[n+1],0);t[4]&&(o[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(o=r[t[1]])?(o[3]=1,o):null:null;for(n=0;n<3;n++)o[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(o[3]=parseFloat(t[4]))}for(n=0;n<3;n++)o[n]=s(o[n],0,255);return o[3]=s(o[3],0,1),o},l.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,s(parseFloat(t[2]),0,100),s(parseFloat(t[3]),0,100),s(isNaN(n)?1:n,0,1)]}return null},l.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,s(parseFloat(t[2]),0,100),s(parseFloat(t[3]),0,100),s(isNaN(n)?1:n,0,1)]}return null},l.to.hex=function(){var e=i(arguments);return"#"+u(e[0])+u(e[1])+u(e[2])+(e[3]<1?u(Math.round(255*e[3])):"")},l.to.rgb=function(){var e=i(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},l.to.rgb.percent=function(){var e=i(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+r+"%)":"rgba("+t+"%, "+n+"%, "+r+"%, "+e[3]+")"},l.to.hsl=function(){var e=i(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},l.to.hwb=function(){var e=i(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},l.to.keyword=function(e){return o[e.slice(0,3)]}},function(e,t,n){"use strict";var r=n(213),i=Array.prototype.concat,o=Array.prototype.slice,a=e.exports=function(e){for(var t=[],n=0,a=e.length;n<a;n++){var l=e[n];r(l)?t=i.call(t,o.call(l)):t.push(l)}return t};a.wrap=function(e){return function(){return e(a(arguments))}}},function(e,t){e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},function(e,t,n){var r=n(99),i=n(215),o={};Object.keys(r).forEach((function(e){o[e]={},Object.defineProperty(o[e],"channels",{value:r[e].channels}),Object.defineProperty(o[e],"labels",{value:r[e].labels});var t=i(e);Object.keys(t).forEach((function(n){var r=t[n];o[e][n]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var n=e(t);if("object"==typeof n)for(var r=n.length,i=0;i<r;i++)n[i]=Math.round(n[i]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}(r),o[e][n].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(r)}))})),e.exports=o},function(e,t,n){var r=n(99);function i(e){var t=function(){for(var e={},t=Object.keys(r),n=t.length,i=0;i<n;i++)e[t[i]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;)for(var i=n.pop(),o=Object.keys(r[i]),a=o.length,l=0;l<a;l++){var s=o[l],u=t[s];-1===u.distance&&(u.distance=t[i].distance+1,u.parent=i,n.unshift(s))}return t}function o(e,t){return function(n){return t(e(n))}}function a(e,t){for(var n=[t[e].parent,e],i=r[t[e].parent][e],a=t[e].parent;t[a].parent;)n.unshift(t[a].parent),i=o(r[t[a].parent][a],i),a=t[a].parent;return i.conversion=n,i}e.exports=function(e){for(var t=i(e),n={},r=Object.keys(t),o=r.length,l=0;l<o;l++){var s=r[l];null!==t[s].parent&&(n[s]=a(s,t))}return n}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(217),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllFeatures=t.ContentEdit=void 0;var r=n(218);Object.defineProperty(t,"ContentEdit",{enumerable:!0,get:function(){return r.default}});var i=n(101);Object.defineProperty(t,"getAllFeatures",{enumerable:!0,get:function(){return i.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(101),i=n(0),o=function(){function e(e,t){this.settingsOverride=e,this.additionalFeatures=t,this.editor=void 0,this.features=[]}return e.prototype.getName=function(){return"ContentEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e;var n=(0,r.default)();(0,i.getObjectKeys)(n).forEach((function(e){var r,i=n[e],o=t.settingsOverride&&void 0!==t.settingsOverride[e];(o&&(null===(r=t.settingsOverride)||void 0===r?void 0:r[e])||!o&&!i.defaultDisabled)&&t.features.push(i)})),this.features=this.features.concat(this.additionalFeatures||[]),this.features.forEach((function(e){var n;return null===(n=t.editor)||void 0===n?void 0:n.addContentEditFeature(e)}))},e.prototype.disposeFeatures=function(){var e=this;this.editor&&this.features.forEach((function(t){return e.editor.removeContentEditFeature(t)})),this.features=[]},e.prototype.dispose=function(){this.disposeFeatures(),this.editor=void 0},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoLinkFeatures=void 0;var r=n(9),i=n(0),o=/[.+=\s:;"',>]+$/i,a={keys:[13,32,257],shouldHandleEvent:s,handleEvent:function(e,t){var n=s(e,t);if(!n)return;var o=t.getDocument().createElement("a"),a=t.getContentSearcherOfCursor();o.textContent=n.originalUrl,o.href=n.normalizedUrl,t.runAsync((function(t){t.addUndoSnapshot((function(){return(0,r.replaceWithNode)(t,n.originalUrl,o,!1,null!=a?a:void 0),(0,i.clearEventDataCache)(e),o}),"AutoLink",!0)}))}},l={keys:[8],shouldHandleEvent:function(e,t){var n=t.getContentSearcherOfCursor(e);return(null==n?void 0:n.getInlineElementBefore())instanceof i.LinkInlineElement},handleEvent:function(e,t){e.rawEvent.preventDefault(),(0,r.removeLink)(t)},defaultDisabled:!0};function s(e,t){return 0==e.eventType||7==e.eventType&&"Paste"==e.source?(0,i.cacheGetEventData)(e,"LINK_DATA",(function(){var n=7==e.eventType&&"Paste"==e.source&&e.data||null,r=(0,i.matchLink)(((null==n?void 0:n.text)||"").trim()),a=t.getContentSearcherOfCursor(e);if(r&&(null==a?void 0:a.getRangeFromText(r.originalUrl,!1)))return r;var l=a&&a.getWordBefore();if(l&&l.length>5){var s=(l.match(o)||[])[0]||"",u=l.substring(0,l.length-s.length);return["()","{}","[]"].forEach((function(e){u[u.length-1]==e[1]&&u.indexOf(e[0])<0&&(u=u.substr(0,u.length-1))})),(0,i.matchLink)(u)}return null})):null}t.AutoLinkFeatures={autoLink:a,unlinkWhenBackspaceAfterLink:l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewFontSize=t.FONT_SIZES=void 0;var r=n(41),i=n(0);t.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];function o(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,1);else if(e>r||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),1e3);else if(1==t){for(var i=0;i<n.length;i++)if(e<n[i]){e=n[i];break}}else for(i=n.length-1;i>=0;i--)if(e>n[i]){e=n[i];break}return e}t.default=function(e,n,a){void 0===a&&(a=t.FONT_SIZES);var l=0==n?1:-1;(0,r.default)(e,(function(e){var t=parseFloat((0,i.getComputedStyle)(e,"font-size")||e.style.fontSize);e.style.fontSize=o(t,l,a)+"pt";var n=(0,i.getComputedStyle)(e,"line-height");n&&"normal"!=n&&(e.style.lineHeight="normal")}),"changeFontSize")},t.getNewFontSize=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(102);t.default=function(e){(0,r.default)(e,1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=/^[a-zA-Z]+:/i,o=/^[\w.%+-]+@/i,a=/^ftp\./i;function l(e){return e.queryElements("a[href]",1)[0]}function s(e,t){t&&e.textContent!=t&&(e.textContent=t)}t.default=function(e,t,n,u,d){e.focus();var c=(function(e){var t=new r.HtmlSanitizer,n=document.createElement("a");return n.href=e||"",t.sanitize(n),n.getAttribute("href")}(t)||"").trim();if(c){var f=(0,r.matchLink)(c),h=f?f.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(i)<0&&(t=0==e.search(o)?"mailto:":0==e.search(a)?"ftp://":"http://"),t+e}(c),p=f?f.originalUrl:c;e.addUndoSnapshot((function(){var t=e.getSelectionRangeEx(),i=null;if(0===t.type){var o=t.ranges[0];if(o&&o.collapsed)(i=l(e))?(i.href=h,s(i,u)):((i=e.getDocument().createElement("A")).textContent=u||p,i.href=h,e.insertNode(i));else{e.getDocument().execCommand("createLink",!1,h);for(var a=e.getSelectionTraverser(),c=null==a?void 0:a.getNextInlineElement(),f=[];c;)f.push(c.getContainerNode()),c=null==a?void 0:a.getNextInlineElement();f.forEach((function(t){return e.deleteNode(t)})),s(i=l(e),u)}}else 2===t.type&&((i=(0,r.wrap)(t.image,"A")).href=h);return n&&i&&(i.title=n),i&&function(e,t){t?e.target=t:!t&&e.getAttribute("target")&&e.removeAttribute("target")}(i,d),i}),"CreateLink")}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getElementBasedFormatState=void 0;var i=n(0);function o(e,t){var n=(0,i.getTagOfNode)(e.getElementAtCursor("OL,UL",void 0,t)),r=e.getSelectionRange(),o=!1;if(r&&!r.collapsed){var l=e.getBlockElementAtNode(r.startContainer),s=e.getBlockElementAtNode(r.endContainer);o=!(!s||!l)&&!s.equals(l)}var u=(0,i.getTagOfNode)(e.getElementAtCursor("H1,H2,H3,H4,H5,H6",void 0,t)),d=e.queryElements("table",1)[0],c=d?(0,i.getTableFormatInfo)(d):void 0,f=(null==d?void 0:d.rows[0])?(0,i.toArray)(d.rows[0].cells).every((function(e){return"TH"==(0,i.getTagOfNode)(e)})):void 0;return{isBullet:"UL"==n,isNumbering:"OL"==n,isMultilineSelection:o,headerLevel:u&&parseInt(u[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0],isCodeInline:!!e.queryElements("code",1)[0],isCodeBlock:!!e.queryElements("pre>code",1)[0],isInTable:!!d,tableFormat:c||{},tableHasHeader:f,canMergeTableCell:a(e)}}t.getElementBasedFormatState=o,t.default=function(e,t){return r(r(r(r(r({},e.getPendableFormatState(!1)),o(e,t)),e.getStyleBasedFormatState()),e.getUndoState()),{isDarkMode:e.isDarkMode(),zoomScale:e.getZoomScale()})};var a=function(e){var t=e.getSelectionRangeEx();if(t&&1===t.type&&t.coordinates){var n=t.coordinates,r=n.firstCell,i=n.lastCell;return r.x!==i.x||r.y!==i.y}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(58),i=n(0);t.default=function(e,t,n,o,a,l,s){var u,d=(0,i.wrap)(n,o?"DIV":"SPAN");if(!o&&a&&(d.style.display="inline-block"),(0,i.commitEntity)(d,t,a),!e.contains(d)){var c=null,f=void 0;if("number"==typeof l)f=l;else if(l){c=e.getSelectionRange();var h=l.normalize().node,p=h&&e.getElementAtCursor((0,i.getEntitySelector)(),h);p&&(l=new i.Position(p,-3)),e.select(l),f=3}else e.focus(),f=3;var v=s&&e.getSelectedRegions(),g=v&&i.VListChain.createListChains(v);e.insertNode(d,{updateCursor:!1,insertOnNewLine:o,replaceSelection:!0,position:f,insertToRegionRoot:s}),g&&(0,r.default)(e,g),3==f&&(c?e.select(c):o||e.select(d,-3))}if(o){var m=e.getDocument().createElement("BR");null===(u=d.parentNode)||void 0===u||u.insertBefore(m,d.nextSibling)}var y=(0,i.getEntityFromElement)(d);return!o&&a&&e.isFeatureEnabled("InlineEntityReadOnlyDelimiters")&&((0,i.addDelimiters)(y.wrapper),y.wrapper.nextElementSibling&&e.select(new i.Position(y.wrapper.nextElementSibling,-3))),e.triggerContentChangedEvent("InsertEntity",y),y}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(0);function o(e,t,n){(0,r.default)(e,(function(){var r=e.getDocument().createElement("img");r.src=t,n&&(0,i.getObjectKeys)(n).forEach((function(e){return r.setAttribute(e,n[e])})),e.insertNode(r)}),"insertImage")}t.default=function(e,t,n){"string"==typeof t?o(e,t,n):(0,i.readFile)(t,(function(t){t&&!e.isDisposed()&&o(e,t,n)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(59),o=n(0);function a(e){return e<=4?"120px":e<=6?"100px":"70px"}t.default=function(e,t,n,l){var s=e.getDocument(),u=s.createElement("table");u.cellSpacing="0",u.cellPadding="1";for(var d=0;d<n;d++){var c=s.createElement("tr");u.appendChild(c);for(var f=0;f<t;f++){var h=s.createElement("td");c.appendChild(h),h.appendChild(s.createElement("br")),h.style.width=a(t)}}e.focus(),(0,r.default)(e,(function(){var t=e.getElementAtCursor();(null==t?void 0:t.style.backgroundColor)&&(0,i.default)(e,"transparent");var n=new o.VTable(u);n.applyFormat(l||{}),n.writeBack(),e.insertNode(u),e.runAsync((function(e){return e.select(new o.Position(u,0).normalize())}))}),"insertTable")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(0);function o(e){return null==e}t.default=function(e,t){var n=e.getElementAtCursor("TD,TH");n&&(0,r.default)(e,(function(){var r=new i.VTable(n);if(function(e,t){var n,r=e.getSelectionRangeEx();r&&1===r.type&&(t.selection=null!==(n=r.coordinates)&&void 0!==n?n:null)}(e,r),r.edit(t),r.writeBack(),e.transformToDarkColor(r.table),e.focus(),!o(r.row)&&!o(r.col)){var a=function(e,t,n){var r=t,i=n;switch(e){case 0:i=0;break;case 1:r+=1,i=0;break;case 2:r=0;break;case 3:r=0,i+=1}return{newRow:r,newCol:i}}(t,r.row,r.col),l=a.newCol,s=a.newRow,u=r.getCell(s,l).td;u&&e.select(u,0)}}),"editTable")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(0);t.default=function(e,t,n){(n=n||e.getElementAtCursor("TABLE"))&&(0,r.default)(e,(function(r,o){if(n){var a=new i.VTable(n);a.applyFormat(t),a.writeBack(),e.transformToDarkColor(a.table),e.focus(),r&&o&&e.select(r,o)}}),"formatTable")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(0);t.default=function(e){e.focus(),(0,r.default)(e,(function(t,n){e.queryElements("a[href]",1,i.unwrap),t&&n&&e.select(t,n)}),"removeLink")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,i){var o,a,l;if(!t||!n)return!1;if(l="string"==typeof t?null!==(a=null==(i=null!==(o=i||e.getContentSearcherOfCursor())&&void 0!==o?o:void 0)?void 0:i.getRangeFromText(t,r))&&void 0!==a?a:null:t){var s=e.getSelectionRange();return(null==s?void 0:s.collapsed)&&l.endContainer==s.startContainer&&l.endOffset==s.startOffset&&(r=!0),e.insertNode(n,{position:5,updateCursor:r,replaceSelection:!0,insertOnNewLine:!1,range:l}),!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.default=function(e,t,n){t&&(0,r.default)(e,(function(){t.style.transform="rotate("+n+"deg)"}),"rotateElement")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26),i=n(12),o=n(3),a=n(109),l=n(0);t.default=function(e,t){(0,o.default)(e,(function(){var n,o=e.getSelectionRangeEx(),s=o&&1===o.type,u=e.getElementAtCursor();s&&o.coordinates&&(0,l.isWholeTableSelected)(new l.VTable(o.table),o.coordinates)?function(e,t){var n=e.table;1==t?(n.style.marginLeft="auto",n.style.marginRight="auto"):2==t?(n.style.marginLeft="auto",n.style.marginRight=""):(n.style.marginLeft="",n.style.marginRight="auto")}(o,t):u&&(n=u,(0,l.findClosestElementAncestor)(n,void 0,"LI"))&&e.isFeatureEnabled("ListItemAlignment")?function(e,t){(0,r.default)(e,(function(n,r,i){var o=(0,l.getSelectedBlockElementsInRegion)(n,void 0,e.isFeatureEnabled("DefaultFormatInSpan"))[0].getStartNode(),a=(0,l.createVListFromRegion)(n,!0,o);r&&i&&(null==a||a.setAlignment(r,i,t))}),void 0,"alignList")}(e,t):function(e,t){var n="left",r="justifyLeft";1==t?(r="justifyCenter",n="center"):2==t&&(r="justifyRight",n="right");if((0,i.default)(e,r),0==e.queryElements("[align]",1,(function(e){e.style.textAlign=n,(0,a.default)(e)})).length){var o=e.getElementAtCursor();o&&(0,a.default)(o)}}(e,t)}),"setAlignment")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(234),i=n(3);t.default=function(e,t){e.focus(),(0,i.default)(e,(function(n,i){(0,r.default)(e,(function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"})),n&&i&&e.select(n,i)}),"setDirection")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function i(e){var t=e.getStartNode();return t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf((0,r.getTagOfNode)(t.parentNode))>=0}t.default=function(e,t){var n=e.getSelectionTraverser();if(n){for(var r=n.currentBlockElement,o=[];r;)i(r)||o.push(r),r=n.getNextBlockElement();o.forEach((function(e){var n=e.collapseToSingleElement();t(n)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.default=function(e,t){e.focus(),(0,r.default)(e,(function(){e.queryElements("img",1,(function(e){return e.setAttribute("alt",t)}))}),"setImageAltText")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26),i=n(109),o=n(0);function a(e,t){t.forEach((function(t){var n=t.collapseToSingleElement(),r=(0,o.findClosestElementAncestor)(n,e.rootNode,"blockquote");if(r){for(n==r&&(n=(0,o.wrap)((0,o.toArray)(n.childNodes)));n&&(0,o.isNodeInRegion)(e,n)&&"BLOCKQUOTE"!=(0,o.getTagOfNode)(n);)n=(0,o.splitBalancedNodeRange)(n);n&&(0,o.isNodeInRegion)(e,n)&&(0,o.unwrap)(n)}}))}function l(e,t){var n;return(null===(n=e.items[0])||void 0===n?void 0:n.getNode())==t&&e.getListItemIndex(t)==(e.getStart()||1)}function s(e,t,n){return 0==e||t.getElementAtCursor("blockquote",n)}t.default=function(e,t){var n=0==t?function(e,t){var n=(0,o.collapseNodesInRegion)(e,t);(0,o.wrap)(n,2);var r=[];n.forEach((function(e){return(0,i.default)(e,r)}))}:a;(0,r.default)(e,(function(r,i,a){for(var u=(0,o.getSelectedBlockElementsInRegion)(r,!0,e.isFeatureEnabled("DefaultFormatInSpan")),d=[[]],c=0;c<u.length;c++){var f=u[c].getStartNode(),h=(0,o.createVListFromRegion)(r,!0,f);if(h){for(;u[c+1]&&h.contains(u[c+1].getStartNode());)c++;var p=e.isFeatureEnabled("TabKeyTextFeatures");if(p&&l(h,f)&&s(t,e,f)){var v=e.getBlockElementAtNode(h.rootList);v&&d.push([v])}else i&&a&&(1==t?h.setIndentation(i,a,t,!1,p):h.setIndentation(i,a,t),h.writeBack(e.isFeatureEnabled("ReuseAllAncestorListElements")),d.push([]))}else d[d.length-1].push(u[c])}d.forEach((function(e){return n(r,e)}))}),(function(){var n=e.getSelectionRangeEx();if(1==n.type&&n.coordinates&&(0,o.isWholeTableSelected)(new o.VTable(n.table),n.coordinates)){if(1==t){var r=e.getElementAtCursor("blockquote",n.table);r&&(0,o.unwrap)(r)}else 0==t&&(0,o.wrap)(n.table,2);return!1}return!0}),"setIndentation")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41),i=n(0);t.default=function(e,t,n){function o(e,n){if(null===e)return e;switch(t){case"lowercase":return e.toLocaleLowerCase(n);case"uppercase":return e.toLocaleUpperCase(n);case"capitalize":for(var r=e.toLocaleLowerCase(n).split(" "),i=0;i<r.length;i++)r[i]=r[i].charAt(0).toLocaleUpperCase(n)+r[i].slice(1);return r.join(" ");case"sentence":var o=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");return e.toLocaleLowerCase(n).replace(o,(function(e){return e.toLocaleUpperCase(n)}));default:return e}}(0,r.default)(e,(function(e){for(var t=(0,i.getFirstLeafNode)(e);t;t=(0,i.getNextLeafSibling)(e,t))if(3==t.nodeType)try{t.textContent=o(t.textContent,n)}catch(e){t.textContent=o(t.textContent,void 0)}}),"changeCapitalization")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(60);t.default=function(e,t,n){(0,r.default)(e,2,void 0,!1,void 0,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(60);t.default=function(e,t,n,i){(0,r.default)(e,1,t,void 0,n,void 0,i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(0);t.default=function(e,t,n){void 0===n&&(n=1),(0,r.default)(e,(function(){e.focus();var r=e.getSelectedRegions();if(r[0]){var o=(0,i.createVListFromRegion)(r[0],!1,t);o&&(o.split(t,n),o.writeBack(e.isFeatureEnabled("ReuseAllAncestorListElements")))}}),"setOrderedListNumbering")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(110),i=n(0),o=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};t.default=function(e,t){(0,r.default)(e,(function(e){var n=(0,i.wrap)(e,"blockquote");(t||o)(n)}),(function(){return 0==e.queryElements("blockquote",1,i.unwrap).length}),"toggleBlockQuote")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(110),i=n(0);t.default=function(e,t){(0,r.default)(e,(function(e){var n=(0,i.wrap)(e,"code"),r=(0,i.wrap)(n,"pre");null==t||t(r)}),(function(){return 0==e.queryElements("pre>code",1,(function(e){if(!e.previousSibling&&!e.nextSibling){var t=e.parentNode;(0,i.unwrap)(e),t&&(0,i.unwrap)(t)}})).length}),"toggleCodeBlock")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);t.default=function(e){(0,r.default)(e,"strikeThrough","toggleStrikethrough")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);t.default=function(e){(0,r.default)(e,"subscript","toggleSubscript")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);t.default=function(e){(0,r.default)(e,"superscript","toggleSuperscript")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(0);t.default=function(e,t){t=Math.min(Math.max(Math.round(t),0),6),(0,r.default)(e,(function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",1,(function(t){n||(e.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);var r=e.getDocument().createElement("div");(0,i.moveChildNodes)(r,t),e.replaceNode(t,r)})),t>0){for(var r=e.getSelectionTraverser(),o=null==r?void 0:r.currentBlockElement,a=new i.HtmlSanitizer({cssStyleCallbacks:{"font-size":function(){return!1}}});o;){var l=o.collapseToSingleElement();a.sanitize(l),o=null==r?void 0:r.getNextBlockElement()}e.getDocument().execCommand("formatBlock",!1,"<H"+t+">")}}),"toggleHeader")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(0);t.default=function(e,t){e.focus(),(0,r.default)(e,(function(){e.getSelectedRegions().forEach((function(n){(0,i.safeInstanceOf)(n.rootNode,"HTMLTableCellElement")&&((0,i.setColor)(n.rootNode,t,!0,e.isDarkMode(),!0,e.getDarkColorHandler()),(0,i.saveTableCellMetadata)(n.rootNode,{bgColorOverride:!0}))}))}),"applyCellShading")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CursorFeatures=void 0;var r=n(0),i={keys:[37,39],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var i,o=null;if(!(n&&(o=t.getSelectionRange())&&o.collapsed&&(i=r.Position.getStart(o))&&t.isPositionAtBeginning(i)))return!1;var a="rtl"==(0,r.getComputedStyle)(i.element,"direction"),l=e.rawEvent;return!a&&37==l.which||a&&39==l.which},handleEvent:function(e){e.rawEvent.preventDefault()},defaultDisabled:!r.Browser.isChrome};t.CursorFeatures={noCycleCursorMove:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityFeatures=void 0;var r=n(0),i=n(0),o={keys:[13],shouldHandleEvent:function(e,t){return l(e,t)},handleEvent:function(e,t){l(e,t,1)}},a={keys:[27],shouldHandleEvent:function(e,t){return l(e,t)},handleEvent:function(e,t){l(e,t,3)}};function l(e,t,n){var r=(0,i.cacheGetEventData)(e,"READONLY_ENTITY_ELEMENT",(function(){var n=e.rawEvent.target,r=n&&t.getElementAtCursor((0,i.getEntitySelector)(),n);return r&&!r.isContentEditable?r:null}));if(r&&void 0!==n){var o=(0,i.getEntityFromElement)(r);o&&t.triggerPluginEvent(15,{operation:n,rawEvent:e.rawEvent,entity:o})}return r}var s={keys:[13],shouldHandleEvent:function(e,t){return c(e,t,!0,!1)},handleEvent:function(e,t){var n,r,o;e.rawEvent.preventDefault();var a=t.getSelectionRange();if(a){var l=i.Position.getEnd(a).normalize().node,s=t.getDocument().createElement("BR");null===(n=l.parentNode)||void 0===n||n.insertBefore(s,l.nextSibling);var u,d=t.getBlockElementAtNode(l);d&&(u=d.collapseToSingleElement(),null===(r=s.parentNode)||void 0===r||r.removeChild(s)),null===(o=t.getSelectionRange())||void 0===o||o.deleteContents(),(null==u?void 0:u.nextSibling)&&t.select(u.nextSibling,0)}}},u={keys:[8],shouldHandleEvent:function(e,t){return c(e,t,!1,!0)},handleEvent:function(e,t){c(e,t,!1,!0,5)}},d={keys:[46],shouldHandleEvent:function(e,t){return c(e,t,!0,!0)},handleEvent:function(e,t){c(e,t,!0,!0,4)}};function c(e,t,n,r,o){var a=(0,i.cacheGetEventData)(e,"NEIGHBOR_ENTITY_ELEMENT_"+n+"_"+r,(function(){var e=t.getSelectionRange();if(!e||r&&!e.collapsed)return null;e.commonAncestorContainer.normalize();var o=i.Position.getEnd(e).normalize(),a=null;if(0==o.offset||o.isAtEnd){var l=t.getBodyTraverser(o.node),s=n?0==o.offset?l.currentInlineElement:l.getNextInlineElement():o.isAtEnd?l.currentInlineElement:l.getPreviousInlineElement(),u=s&&s.getContainerNode();if(!r){var d=t.getBlockElementAtNode(o.node);(!d||u&&!d.contains(u))&&(u=null)}a=u&&t.getElementAtCursor((0,i.getEntitySelector)(),u)}return a}));if(a&&void 0!==o){var l=(0,i.getEntityFromElement)(a);l&&y(l,t,o,e)}return a}var f={keys:[39,37],allowFunctionKeys:!0,shouldHandleEvent:function(e,t){if(e.rawEvent.altKey||!t.isFeatureEnabled("InlineEntityReadOnlyDelimiters"))return!1;var n=t.getElementAtCursor();return!!n&&p(e,t,"rtl"===(0,i.getComputedStyle)(n,"direction")==(37===e.rawEvent.which))},handleEvent:function(e,t){var n=b(e),r=g(e,n);if(r){var o=C(r,n,t),a=o.delimiterPair,l=o.entity;a&&l&&(0,i.matchesSelector)(l,(0,i.getEntitySelector)())&&(e.rawEvent.preventDefault(),t.runAsync((function(){var r=n?e.rawEvent.shiftKey?-3:-1:-2,o=new i.Position(a,r);if(e.rawEvent.shiftKey){var l=a.ownerDocument.getSelection();null==l||l.extend(o.node,o.offset)}else t.select(o)})))}}},h={keys:[8,46],shouldHandleEvent:function(e,t){if(!t.isFeatureEnabled("InlineEntityReadOnlyDelimiters"))return!1;var n=t.getSelectionRange();if(!(null==n?void 0:n.collapsed))return!1;var r=46===e.rawEvent.which;if(p(e,t,r)){var i=g(e,r);return!!m(e,t,r,r?null==i?void 0:i.nextElementSibling:null==i?void 0:i.previousElementSibling)}return!1},handleEvent:function(e,t){var n=46===e.rawEvent.which;m(e,t,n,null,n?4:5)}};function p(e,t,n){var r,i=null===(r=t.getFocusedPosition())||void 0===r?void 0:r.normalize();if(b(e,n),!i)return!1;var o=3==i.node.nodeType?i.node:i.node==i.element?i.element.childNodes.item(i.offset):i.element,a=n?{class:"entityDelimiterBefore",pairClass:"entityDelimiterAfter",isAtEndOrBeginning:i.isAtEnd}:{class:"entityDelimiterAfter",pairClass:"entityDelimiterBefore",isAtEndOrBeginning:0==i.offset},l=function(e,t,n){var r=v(e,t);if(!r)return;var i=r.currentInlineElement;for(;i&&i.getContainerNode()===t;)o=r,i=n?o.getNextInlineElement():o.getPreviousInlineElement();var o;return null==i?void 0:i.getContainerNode()}(t,o,n);if(a.isAtEndOrBeginning&&l){var s=t.getElementAtCursor("."+a.class,l);if(s&&u(s))return!0}return!!u(o&&t.getElementAtCursor("."+a.class,o));function u(r){if(!r)return!1;var i=C(r,n,t).delimiterPair;return i&&(i.className||"").indexOf(a.pairClass)>-1&&g(e,n,r)}}function v(e,t){var n;if(t){var i=null===(n=e.getBlockElementAtNode(t))||void 0===n?void 0:n.getStartNode();return i?r.ContentTraverser.createBodyTraverser(i,t):void 0}}function g(e,t,n){return(0,i.cacheGetEventData)(e,"delimiter_cache_key_"+t,(function(){return n}))}function m(e,t,n,r,o){var a=(0,i.cacheGetEventData)(e,"entity_delimiter_cache_key_"+n,(function(){return r&&t.getElementAtCursor((0,i.getEntitySelector)(),r)}));if(a&&void 0!==o){var l=(0,i.getEntityFromElement)(a);l&&y(l,t,o,e)}return a}function y(e,t,n,r){var o=e.wrapper,a=o.nextElementSibling,l=o.previousElementSibling;t.triggerPluginEvent(15,{operation:n,rawEvent:r.rawEvent,entity:e}),e.isReadonly&&!(0,i.isBlockElement)(e.wrapper)&&t.isFeatureEnabled("InlineEntityReadOnlyDelimiters")&&(r.rawEvent.defaultPrevented?t.runAsync((function(){if(t.contains(e.wrapper)){var n=(0,i.addDelimiters)(e.wrapper)[0];n&&t.select(n,-3)}else!function(e,t){[e,t].forEach((function(e){var t;(0,i.getDelimiterFromElement)(e)&&(null===(t=null==e?void 0:e.parentElement)||void 0===t||t.removeChild(e))}))}(a,l)})):(0,i.getDelimiterFromElement)(a)&&(0,i.getDelimiterFromElement)(l)&&t.select((0,i.createRange)(l,a)))}function b(e,t){return!!(0,i.cacheGetEventData)(e,"Check_Before",(function(){return t}))}function C(e,t,n){var r=null,o=null,a=v(n,e);if(!a)return{delimiterPair:o,entity:r};for(var l,s="."+(t?"entityDelimiterAfter":"entityDelimiterBefore"),u=function(e,t){var r,i=null==e?void 0:e.getContainerNode();return null!==(r=i&&n.getElementAtCursor(t,i))&&void 0!==r?r:null},d=(0,i.getEntitySelector)(),c=a.currentInlineElement;c&&(!r||!o);){if(r=r||u(c,d),o=o||u(c,s),r&&!o&&!u(c,d)){o=null;break}l=a,c=t?l.getNextInlineElement():l.getPreviousInlineElement()}return{entity:r,delimiterPair:o}}t.EntityFeatures={clickOnEntity:o,escapeFromEntity:a,enterBeforeReadonlyEntity:s,backspaceAfterEntity:u,deleteBeforeEntity:d,moveBetweenDelimitersFeature:f,removeEntityBetweenDelimiters:h}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListFeatures=void 0;var r=n(251),i=n(252),o=n(9),a=n(0),l=(0,a.createObjectDefinition)({orderedStyleType:(0,a.createNumberDefinition)(!0,void 0,1,20),unorderedStyleType:(0,a.createNumberDefinition)(!0,void 0,1,9)},!0,!0),s=function(e){return function(t,n){var r=t.rawEvent,i=r.keyCode,o=r.altKey,a=r.shiftKey,l=r.ctrlKey,s=r.metaKey;return!l&&!s&&(9===i?!o&&a===!e:a&&o&&i===(e?39:37))&&O(t,n)}},u=function(e){return function(t,n){var r=null,i=9!==t.rawEvent.keyCode&&(r=n.getElementAtCursor())&&"rtl"==(0,a.getComputedStyle)(r,"direction");(0,o.setIndentation)(n,i==e?1:0),t.rawEvent.preventDefault()}},d={keys:a.Browser.isMac?[9]:[9,39],shouldHandleEvent:s(!0),handleEvent:u(!0),allowFunctionKeys:!0},c={keys:a.Browser.isMac?[9]:[9,37],shouldHandleEvent:s(!1),handleEvent:u(!1),allowFunctionKeys:!0},f={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e),r=t.getSelectionRange();return n&&(null==r?void 0:r.collapsed)&&(0,a.isPositionAtBeginningOf)(a.Position.getStart(r),n)},handleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e);(null==n?void 0:n.previousSibling)?(0,o.blockFormat)(t,(function(r,i,o){var l=(0,a.createVListFromRegion)(r,!1,null!=n?n:void 0);l&&i&&o&&(l.setIndentation(i,o,1,!0),l.writeBack(t.isFeatureEnabled("ReuseAllAncestorListElements")),e.rawEvent.preventDefault())})):P(e,t)},defaultDisabled:!0},h={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e);return n&&(0,a.isNodeEmpty)(n)&&!n.previousSibling&&!n.getElementsByTagName("blockquote").length},handleEvent:P},p={keys:[46],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e),r=t.getSelectionRange();if(n||!r)return!1;var i=a.Position.getEnd(r).isAtEnd?function(e,t){return(0,a.cacheGetEventData)(e,"nextSibling",(function(){var e,n=t.getSelectionRange(),r=n&&a.Position.getEnd(n).normalize(),i=r&&t.getBodyTraverser(r.node);return null===(e=null==i?void 0:i.getNextBlockElement())||void 0===e?void 0:e.getStartNode()}))}(e,t):void 0;return t.getElementAtCursor("LI",i,e)},handleEvent:function(e,t){var n=w(t);t.runAsync((function(e){return(0,o.commitListChains)(e,n)}))}},v={keys:[13],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e);return!e.rawEvent.shiftKey&&n&&(0,a.isNodeEmpty)(n)},handleEvent:function(e,t){t.addUndoSnapshot((function(){return P(e,t,!1)}),void 0,!0)},defaultDisabled:!a.Browser.isIE&&!a.Browser.isChrome};function g(e){return/^(\*|-|[0-9]{1,2}\.|[0-9]{1,2}\>|[0-9]{1,2}\)|[0-9]{1,2}\-|\([0-9]{1,2}\))$/.test(e)}var m={keys:[32],shouldHandleEvent:function(e,t){var n;return!(O(e,t)||t.isFeatureEnabled("AutoFormatList")||!(n=t.getContentSearcherOfCursor(e)))&&(g(n.getSubStringBefore(4))&&!n.getNearestNonTextInlineElement())},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n,r=t.getContentSearcherOfCursor();if(r){var i=r.getSubStringBefore(4),a=r.getRangeFromText(i,!0);if(a){if(0==i.indexOf("*")||0==i.indexOf("-"))T(t,a),(0,o.toggleBullet)(t);else if(g(i))T(t,a),(0,o.toggleNumbering)(t);else if((n=t.getSelectedRegions())&&1==n.length){var l=parseInt(i);T(t,a),(0,o.toggleNumbering)(t,l)}}else;null===(e=r.getRangeFromText(i,!0))||void 0===e||e.deleteContents()}}),void 0,!0)}},y={keys:[32],shouldHandleEvent:function(e,t){return!(O(e,t)||!t.isFeatureEnabled("AutoFormatList"))&&M(e,t,r.default,2)},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n=t.getContentSearcherOfCursor();if(n){var i=n.getSubStringBefore(5),a=n.getRangeFromText(i,!0),l=(0,r.default)(i);a&&(T(t,a),(0,o.toggleBullet)(t,null!=l?l:void 0,"autoToggleList")),null===(e=n.getRangeFromText(i,!0))||void 0===e||e.deleteContents()}}),void 0,!0)}},b={keys:[32],shouldHandleEvent:function(e,t){return!(O(e,t)||!t.isFeatureEnabled("AutoFormatList"))&&M(e,t,i.default,1)},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n,r=t.getContentSearcherOfCursor();if(r){var a=r.getSubStringBefore(5),l=r.getRangeFromText(a,!0);if(l){var s=E(a)?1:parseInt(a),u=C(t,l),d=null!==(e=(0,i.default)(a))&&void 0!==e?e:void 0;T(t,l),(0,o.toggleNumbering)(t,u&&1!==s?void 0:s,d,"autoToggleList")}null===(n=r.getRangeFromText(a,!0))||void 0===n||n.deleteContents()}}),void 0,!0)}},C=function(e,t){var n,r=e.getBodyTraverser(null==t?void 0:t.startContainer).getPreviousBlockElement(),i=null!==(n=null==r?void 0:r.getEndNode())&&void 0!==n?n:null;return"LI"===(0,a.getTagOfNode)(i)?i:void 0},E=function(e){var t=parseInt(e);if(t&&1===t)return 1;var n=e.replace(/\(|\)|\-|\./g,"").trim();return 1===n.length&&["i","a","I","A"].indexOf(n)>-1?1:void 0},S={keys:[13,9,46,8,258],shouldHandleEvent:function(e,t){return t.queryElements("li",1).filter((function(e){return!e.getElementsByTagName("blockquote").length})).length>0},handleEvent:function(e,t){var n=w(t);t.runAsync((function(e){return(0,o.commitListChains)(e,n)}))}};function w(e){return a.VListChain.createListChains(e.getSelectedRegions())}function T(e,t){var n,r=e.getBlockElementAtNode(t.startContainer),i=null==r?void 0:r.getEndNode();if(i&&"BR"!=(0,a.getTagOfNode)(i)){var o=e.getDocument().createElement("BR");(0,a.isBlockElement)(i)?i.appendChild(o):null===(n=i.parentNode)||void 0===n||n.insertBefore(o,i.nextSibling),e.select(t.startContainer,t.startOffset)}}function P(e,t,n){void 0===n&&(n=!0);var r=O(e,t);if(r){var i=r[0],l=(0,a.getTagOfNode)(i);"UL"!=l&&"OL"!=l||(0,o.toggleListType)(t,"UL"==l?2:1,void 0,n),t.focus(),e.rawEvent.preventDefault()}}function O(e,t){var n=t.getElementAtCursor("LI,TABLE",void 0,e),r=n&&"LI"==(0,a.getTagOfNode)(n)&&t.getElementAtCursor("UL,OL",n);return r?[r,n]:null}function M(e,t,n,r){var i=t.getContentSearcherOfCursor(e);if(!i)return!1;var o=i.getSubStringBefore(4),s=t.getBlockTraverser(),u=s&&s.currentBlockElement?s.currentBlockElement.getTextContent().slice(0,o.length):null,d=u&&u===o,c=w(t),f=i.getRangeFromText(o,!0),h=f&&function(e,t,n){var r=1===n?"orderedStyleType":"unorderedStyleType",i=C(e,t),o=i?(0,a.findClosestElementAncestor)(i,void 0,1===n?"ol":"ul"):null,s=o?(0,a.getMetadata)(o,l):null;return s?s[r]:null}(t,f,r),p=E(o),v=n(o,c,null!=h?h:void 0),g=p||!h||h===v||2===r;return d&&!i.getNearestNonTextInlineElement()&&v&&g}var _={keys:[8],shouldHandleEvent:function(e,t){var n,r,i=t.getElementAtCursor();if(i){var o=null===(n=t.getBlockElementAtNode(i))||void 0===n?void 0:n.getStartNode(),l=null!==(r=null==o?void 0:o.previousElementSibling)&&void 0!==r?r:null;if(D(l)){var s=t.getSelectionRange(),u=t.getContentSearcherOfCursor(e),d=null==u?void 0:u.getSubStringBefore(4),c=null==u?void 0:u.getNearestNonTextInlineElement();if(s&&s.collapsed&&""===d&&!c){var f=null==o?void 0:o.nextElementSibling,h=D(f)?f:null==f?void 0:f.firstChild;if(D(h)&&(0,a.getTagOfNode)(l)==(0,a.getTagOfNode)(h)){var p=(0,a.cacheGetEventData)(e,"previousBlock",(function(){return l})),v=(0,a.cacheGetEventData)(e,"nextBlock",(function(){return h}));return!!p&&!!v}}}}return!1},handleEvent:function(e,t){t.runAsync((function(t){var n=(0,a.cacheGetEventData)(e,"previousBlock",(function(){return null})),r=(0,a.cacheGetEventData)(e,"nextBlock",(function(){return null})),i=t.getSelectionRange();if(n&&r&&i){var o=new a.VList(n);o.mergeVList(new a.VList(r));var l=t.getDocument().createElement("span");l.id="restoreRange",i.insertNode(l),o.writeBack(),(l=t.queryElements("#restoreRange")[0]).parentElement&&(t.select(new a.Position(l,-3)),l.parentElement.removeChild(l))}}))}};function D(e){return!!e&&((0,a.safeInstanceOf)(e,"HTMLOListElement")||(0,a.safeInstanceOf)(e,"HTMLUListElement"))}t.ListFeatures={autoBullet:m,indentWhenTab:d,outdentWhenShiftTab:c,outdentWhenBackspaceOnEmptyFirstLine:h,outdentWhenEnterOnEmptyLine:v,mergeInNewLineWhenBackspaceOnFirstChar:f,maintainListChain:S,maintainListChainWhenDelete:p,autoNumberingList:b,autoBulletList:y,mergeListOnBackspaceAfterList:_}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={"*":1,"-":2,"--":3,"->":5,"--\x3e":8,"=>":6,">":4,"":7};t.default=function(e){var t=e.trim();return r[t]||null}},function(e,t,n){"use strict";var r,i,o,a,l,s;Object.defineProperty(t,"__esModule",{value:!0});var u=n(253),d={".":1,"-":2,")":3},c=[13,16,15,14],f=[17,20,19,18],h=["1","a","A","I","i"],p=["i","v","x","l","c","d","m"],v=["I","V","X","L","C","D","M"],g=((r={})[1]=function(e){return E[e]||null},r[2]=function(e){return C[e]||null},r[3]=function(e){return b[e]||null},r[4]=function(e){return y[e]||null},r[5]=function(e){return m[e]||null},r),m=((i={})[1]=17,i[2]=20,i[3]=18,i[4]=19,i),y=((o={})[1]=13,o[2]=16,o[3]=14,o[4]=15,o),b=((a={})[1]=9,a[2]=12,a[3]=10,a[4]=11,a),C=((l={})[1]=5,l[2]=8,l[3]=6,l[4]=7,l),E=((s={})[1]=1,s[2]=2,s[3]=3,s[4]=4,s),S=function(e,t,n){var r=t?4:d[e[e.length-1]];if(r){var i=function(e,t){if(!isNaN(parseInt(e)))return 1;if(/[a-z]+/g.test(e)){if(null!=t&&c.indexOf(t)>-1&&p.indexOf(e[0])>-1||!t&&"i"===e)return 4;if(t||!t&&"a"===e)return 2}else if(/[A-Z]+/g.test(e)){if(null!=t&&f.indexOf(t)>-1&&v.indexOf(e[0])>-1||!t&&"I"===e)return 5;if(t||!t&&"A"===e)return 3}}(t?e.slice(1,-1):e.slice(0,-1),n);return i?g[i](r):null}return null};t.default=function(e,t,n){var r,i=e.trim(),o="("===i[0]&&")"===i[i.length-1],a=o?i.slice(1,-1):i.slice(0,-1),l=parseInt(a),s=isNaN(l)?(0,u.default)(a):l;return!s||s<1||t&&s>1&&(t.length<1&&h.indexOf(a)<0||(null==t?void 0:t.length)>0&&!(null===(r=t[t.length-1])||void 0===r?void 0:r.canAppendAtCursor(s)))?null:function(e){return Number(e)||/^[A-Za-z\s]*$/.test(e)}(a)?S(i,o,n):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.toLocaleLowerCase();if(t){var n=t.length-1;return 26*n+t.charCodeAt(n)-96}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarkdownFeatures=void 0;var r=n(0);function i(e,t,n,i){return{keys:[e],shouldHandleEvent:function(e,n){return e.rawEvent.shiftKey===i&&!!o(e,n,t)},handleEvent:function(e,i){i.runAsync((function(i){!function(e,t,n,i){t.addUndoSnapshot((function(){var a=o(e,t,n);if(a){var l=new r.Position(a.endContainer,-1),s=a.endOffset+1<=l.offset;if(a&&s){var u=a.cloneRange();u.setStart(u.startContainer,u.startOffset+1);var d=u.extractContents().textContent,c=t.getDocument().createTextNode(null!=d?d:""),f=(0,r.wrap)(c,i);a.setEnd(a.endContainer,a.endOffset+1),a.deleteContents();var h=t.getDocument().createTextNode("");a.insertNode(h),a.insertNode(f),t.select(h,-1)}}}),"Format",!0)}(e,i,t,n)}))}}}function o(e,t,n){return(0,r.cacheGetEventData)(e,"MARKDOWN_RANGE",(function(){var i=t.getContentSearcherOfCursor(e),o=null,a=null;return null==i||i.forEachTextInlineElement((function(e){if(a&&o)return!0;var t=e.getTextContent();if(0==t[t.length-1].trim().length)return!1;var r=e.getParentBlock().getTextContent();if(r[r.length-1].trim()===n)return!1;if(a||(a=e.getStartPosition().move(t.length)),t[0]==n)o=e.getStartPosition();else for(var i=t.length-1;i>0;i--){if(o)return!0;if(t[i]==n&&0==t[i-1].trim().length)return o=e.getStartPosition().move(i),!0}})),o&&a&&(0,r.createRange)(o,a)}))}var a=i(56,"*","b",!0),l=i(189,"_","i",!0),s=i(192,"~","s",!0),u=i(192,"`","code",!1);t.MarkdownFeatures={markdownBold:a,markdownItalic:l,markdownStrikethru:s,markdownInlineCode:u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuoteFeatures=void 0;var r=n(9),i=n(0),o="BLOCKQUOTE",a=[o,"LI","TD","TH"].join(","),l={keys:[8],shouldHandleEvent:function(e,t){var n=u(e,t);return n&&(0,i.isNodeEmpty)(n)&&!n.previousSibling},handleEvent:d},s={keys:[13],shouldHandleEvent:function(e,t){var n=u(e,t);return!e.rawEvent.shiftKey&&n&&(0,i.isNodeEmpty)(n)},handleEvent:function(e,t){return t.addUndoSnapshot((function(){return d(e,t)}),void 0,!0)}};function u(e,t){return(0,i.cacheGetEventData)(e,"QUOTE_CHILD",(function(){var e=t.getElementAtCursor(a);if(e&&(0,i.getTagOfNode)(e)==o){var n=t.getFocusedPosition(),r=n&&t.getBlockElementAtNode(n.normalize().node);if(r){var l=r.getStartNode()==e?r.getStartNode():r.collapseToSingleElement();return(0,i.isNodeEmpty)(l)?l:null}}return null}))}function d(e,t){t.addUndoSnapshot((function(){var n=u(e,t);if(n){(0,i.getTagOfNode)(n)==o&&(n=(0,i.wrap)((0,i.toArray)(n.childNodes)));var a=(0,i.splitBalancedNodeRange)(n),l=!!a&&c(a),s=a&&(0,i.unwrap)(a);t.select(n,0),l&&((0,i.safeInstanceOf)(s,"HTMLLIElement")&&s.style.removeProperty("color"),(0,r.clearFormat)(t))}})),e.rawEvent.preventDefault()}var c=function(e){return!!(e&&(0,i.safeInstanceOf)(e,"HTMLQuoteElement")&&e.style.borderLeft&&e.style.borderColor&&e.style.paddingLeft&&e.style.color)};t.QuoteFeatures={unquoteWhenBackspaceOnEmptyFirstLine:l,unquoteWhenEnterOnEmptyLine:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShortcutFeatures=void 0;var r=n(0),i=n(9);function o(e,t,n,r){return void 0===r&&(r=!1),r?null:{winKey:e,macKey:t,action:n}}var a=[o(4162,8258,i.toggleBold),o(4169,8265,i.toggleItalic),o(4181,8277,i.toggleUnderline),o(4128,8224,i.clearFormat),o(4186,8282,(function(e){return e.undo()})),o(26,26,(function(e){return e.undo()}),r.Browser.isMac),o(4185,24666,(function(e){return e.redo()})),o(4286,8382,i.toggleBullet),o(4287,8383,i.toggleNumbering),o(20670,24766,(function(e){return(0,i.changeFontSize)(e,0)})),o(20668,24764,(function(e){return(0,i.changeFontSize)(e,1)}))].filter((function(e){return!!e})),l={allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191,32,8],shouldHandleEvent:s,handleEvent:function(e,t){var n=s(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}};function s(e){return(0,r.cacheGetEventData)(e,"DEFAULT_SHORT_COMMAND",(function(){var t=e.rawEvent,n=0!=e.eventType||t.getModifierState("AltGraph")?0:t.which|(t.metaKey&&8192)|(t.shiftKey&&16384)|(t.ctrlKey&&4096)|(t.altKey&&18);return n&&a.filter((function(e){return(r.Browser.isMac?e.macKey:e.winKey)==n}))[0]}))}t.ShortcutFeatures={defaultShortcut:l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StructuredNodeFeatures=void 0;var r=n(0),i={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},o=(0,r.getObjectKeys)(i).join(","),a={keys:[13],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e,t),i=(0,r.createElement)(1,t.getDocument());t.addUndoSnapshot((function(){var e;null===(e=null==n?void 0:n.parentNode)||void 0===e||e.insertBefore(i,n),"TABLE"==(0,r.getTagOfNode)(n)&&t.select(new r.Position(i,0).normalize())})),e.rawEvent.preventDefault()},defaultDisabled:!0};function l(e,t){return(0,r.cacheGetEventData)(e,"FIRST_STRUCTURE",(function(){var n=e.rawEvent.shiftKey?null:t.getElementAtCursor(o);if(n){var a=t.getSelectionRange();if(a&&a.collapsed&&(0,r.isPositionAtBeginningOf)(r.Position.getStart(a),n)&&!t.getBodyTraverser(n).getPreviousBlockElement())return t.getElementAtCursor(i[(0,r.getTagOfNode)(n)])}return null}))}t.StructuredNodeFeatures={insertLineBeforeStructuredNodeFeature:a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableFeatures=void 0;var r=n(9),i=n(0),o={keys:[9],shouldHandleEvent:function(e,t){return u(e,t)&&!d(e,t)},handleEvent:function(e,t){var n,o,a,l=e.rawEvent.shiftKey,s=u(e,t);if(s){for(var d=c(e,s),f=l?-1:1,h=null!==(n=d.row)&&void 0!==n?n:0,p=(null!==(o=d.col)&&void 0!==o?o:0)+f;;p+=f){var v=null!==(a=d.cells)&&void 0!==a?a:[];if(p<0||p>=v[h].length){if((h+=f)<0){t.select(d.table,-2);break}if(h>=v.length){(0,r.editTable)(t,1);break}p=l?v[h].length-1:0}var g=d.getCell(h,p);if(g.td){var m=new i.Position(g.td,0).normalize();t.select(m);break}}e.rawEvent.preventDefault()}}},a={keys:[9],shouldHandleEvent:function(e,t){return u(e,t)&&d(e,t)},handleEvent:function(e,t){e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var n=e.rawEvent.shiftKey,i=t.getSelectionRangeEx(),o=u(e,t);if(o){var a=c(e,o);n&&t.getElementAtCursor("blockquote",a.table,e)?(0,r.setIndentation)(t,1):n||(0,r.setIndentation)(t,0),i.coordinates&&t.select(i.table,i.coordinates)}}))}},l={keys:[38,40],shouldHandleEvent:function(e,t){return u(e,t)&&!d(e,t)},handleEvent:function(e,t){var n,r,o,a=u(e,t);if(a){var l=new i.VTable(a),s=38==e.rawEvent.which,d=s?-1:1,c=e.rawEvent.shiftKey,f=null===(n=t.getDocument().defaultView)||void 0===n?void 0:n.getSelection(),h=null;if(f){for(var p=f.anchorNode,v=f.anchorOffset,g=null!==(r=l.row)&&void 0!==r?r:0;g>=0&&l.cells&&g<l.cells.length;g+=d){var m=l.getCell(g,null!==(o=l.col)&&void 0!==o?o:0);if(m.td&&m.td!=a){h=m.td;break}}t.runAsync((function(e){var t,n=e.getElementAtCursor();if((0,i.contains)(l.table,n)&&!(0,i.contains)(a,n,!0)){var r=h?new i.Position(h,0):new i.Position(l.table,s?-2:-3);if(c){r=1==r.node.nodeType&&(0,i.isVoidHtmlElement)(r.node)?new i.Position(r.node,r.isAtEnd?-3:-2):r;var o=null===(t=e.getDocument().defaultView)||void 0===t?void 0:t.getSelection();p&&(null==o||o.setBaseAndExtent(p,v,r.node,r.offset))}else e.select(r.normalize())}}))}}},defaultDisabled:!i.Browser.isChrome&&!i.Browser.isSafari},s={keys:[8],shouldHandleEvent:function(e,t){return t.isFeatureEnabled("DeleteTableWithBackspace")&&d(e,t)},handleEvent:function(e,t){var n=u(e,t);if(n){var r=new i.VTable(n);r.edit(4),r.writeBack()}}};function u(e,t){return(0,i.cacheGetEventData)(e,"TABLE_CELL_FOR_TABLE_FEATURES",(function(){var e=t.getFocusedPosition(),n=e&&t.getElementAtCursor("TD,TH,LI",e.node);return n&&("LI"==(0,i.getTagOfNode)(n)?null:n)}))}function d(e,t){return(0,i.cacheGetEventData)(e,"WHOLE_TABLE_SELECTED_FOR_FEATURES",(function(){var n=u(e,t);if(!n)return!1;var r=c(e,n),o=t.getSelectionRangeEx();return 1==o.type&&o.coordinates&&(0,i.isWholeTableSelected)(r,o.coordinates)}))}function c(e,t){return(0,i.cacheGetEventData)(e,"VTABLE_FOR_TABLE_FEATURES",(function(){return new i.VTable(t)}))}t.TableFeatures={tabInTable:o,upDownInTable:l,indentTableOnTab:a,deleteTableWithBackspace:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextFeatures=void 0;var r=n(9),i=n(0),o={keys:[9],shouldHandleEvent:function(e,t){if(t.isFeatureEnabled("TabKeyTextFeatures")&&!e.rawEvent.shiftKey){var n=t.getDocument().activeElement,r=t.getElementAtCursor("LI,TABLE",void 0,e),o=t.getElementAtCursor((0,i.getEntitySelector)(),void 0,e);return!r&&(o?o.isContentEditable:n.isContentEditable)}return!1},handleEvent:function(e,t){var n=t.getSelectionRangeEx();0==n.type&&(t.addUndoSnapshot((function(){if(n.areAllCollapsed)u(t,e);else{var o=n.ranges,a=o[0];if(l(t,a))(0,r.setIndentation)(t,0);else{var s=(0,i.createRange)(a.startContainer,a.startOffset);o.forEach((function(e){return e.deleteContents()})),t.select(s),u(t,e)}}})),e.rawEvent.preventDefault())}},a={keys:[9],shouldHandleEvent:function(e,t){if(e.rawEvent.shiftKey&&t.isFeatureEnabled("TabKeyTextFeatures")){var n=t.getSelectionRangeEx();return 0==n.type&&!n.areAllCollapsed&&t.getElementAtCursor("blockquote",void 0,e)&&!t.getElementAtCursor("LI,TABLE",void 0,e)&&l(t,n.ranges[0])}return!1},handleEvent:function(e,t){t.addUndoSnapshot((function(){return(0,r.setIndentation)(t,1)})),e.rawEvent.preventDefault()}};function l(e,t){var n=!1,r=i.Position.getStart(t),o=i.Position.getEnd(t),a=e.getBlockElementAtNode(r.node),l=e.getBlockElementAtNode(o.node);if(!a||!l)return!1;if(a.equals(l)){var u=new i.Position(a.getStartNode(),0),d=new i.Position(a.getEndNode(),-1),c=(0,i.createRange)(u,i.Position.getStart(t)),f=(0,i.createRange)(i.Position.getEnd(t),d);return!n&&s(c)&&s(f)&&(n=!0),n}return!0}function s(e){return""==e.toString()&&0==(0,i.queryElements)(e.commonAncestorContainer,"img,table,ul,ol",null,2,e).length}function u(e,t){var n=e.getDocument().createElement("span"),r=e.getContentSearcherOfCursor(t);if(r){for(var o=6-r.getSubStringBefore(Number.MAX_SAFE_INTEGER).length%6,a=null,l="",s=0;s<o;s++)l+="&ensp;";e.insertNode(n),n.nextElementSibling&&"A"==(0,i.getTagOfNode)(n.nextElementSibling)&&((a=e.getDocument().createElement("span")).textContent=" ",e.insertNode(a),e.select((0,i.createRange)(a,-2))),e.insertContent(l,{position:5,range:(0,i.createRange)(n,0),updateCursor:!1}),e.select((0,i.createRange)(n,-3)),a&&e.deleteNode(a)}}t.TextFeatures={indentWhenTabText:o,outdentWhenTabText:a,autoHyphen:{keys:[],shouldHandleEvent:function(e,t){return!1},handleEvent:function(e,t){return!1},defaultDisabled:!0}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(261),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMenu=void 0;var r=n(262);Object.defineProperty(t,"ContextMenu",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e){var t=this;this.options=e,this.container=null,this.editor=null,this.isMenuShowing=!1,this.onDismiss=function(){var e,n;t.container&&t.isMenuShowing&&(null===(n=(e=t.options).dismiss)||void 0===n||n.call(e,t.container),t.isMenuShowing=!1)}}return e.prototype.getName=function(){return"ContextMenu"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e;this.onDismiss(),(null===(e=this.container)||void 0===e?void 0:e.parentNode)&&(this.container.parentNode.removeChild(this.container),this.container=null),this.editor=null},e.prototype.onPluginEvent=function(e){if(16==e.eventType&&e.items.length>0){var t=e.rawEvent,n=e.items;this.onDismiss(),this.options.allowDefaultMenu||t.preventDefault(),this.initContainer(t.pageX,t.pageY)&&(this.options.render(this.container,n,this.onDismiss),this.isMenuShowing=!0)}},e.prototype.initContainer=function(e,t){var n,i;return!this.container&&this.editor&&(this.container=(0,r.createElement)(5,this.editor.getDocument()),this.editor.getDocument().body.appendChild(this.container)),null===(n=this.container)||void 0===n||n.style.setProperty("left",e+"px"),null===(i=this.container)||void 0===i||i.style.setProperty("top",t+"px"),!!this.container},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(264),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomReplace=void 0;var r=n(265);Object.defineProperty(t,"CustomReplace",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n,r){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:n,shouldReplace:r}},i=[r(":)","",!0),r(";)","",!0),r(":O","",!0),r(":o","",!0),r("<3","",!0)],o=function(){function e(e){void 0===e&&(e=i),this.longestReplacementLength=null,this.editor=null,this.replacements=null,this.replacementEndCharacters=null,this.updateReplacements(e)}return e.prototype.updateReplacements=function(e){var t;this.replacements=e,this.longestReplacementLength=(t=this.replacements,Math.max.apply(null,t.map((function(e){return e.sourceString.length})))),this.replacementEndCharacters=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var i=r[n],o=i.sourceString;if(0!=o.length){var a=o[o.length-1];i.matchSourceCaseSensitive?t.add(a):(t.add(a.toLocaleLowerCase()),t.add(a.toLocaleUpperCase()))}}return t}(this.replacements)},e.prototype.getName=function(){return"CustomReplace"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t,n=this;if(3==e.eventType&&this.editor&&!this.editor.isInIME()&&e.rawEvent.data&&(null===(t=this.replacementEndCharacters)||void 0===t?void 0:t.has(e.rawEvent.data))){var r=this.editor.getContentSearcherOfCursor(e);if(r&&null!=this.longestReplacementLength){var i=r.getSubStringBefore(this.longestReplacementLength),o=this.getMatchingReplacement(i);if(o&&(!o.shouldReplace||!r||o.shouldReplace(o,r.getWordBefore(),this.editor))){var a=r.getSubStringBefore(o.sourceString.length),l=r.getRangeFromText(a,!0),s=this.editor.getDocument().createElement("span");s.innerHTML=this.editor.getTrustedHTMLHandler()(o.replacementHTML);var u=1==s.childNodes.length?s.childNodes[0]:s;l&&this.editor.addUndoSnapshot((function(){var e;l.deleteContents(),l.insertNode(u),null===(e=n.editor)||void 0===e||e.select(u,-1)}),void 0,!0)}}}},e.prototype.getMatchingReplacement=function(e){if(0==e.length||!this.replacements)return null;for(var t=e.replace(/\s/g," "),n=t.toLocaleLowerCase(),r=0,i=this.replacements;r<i.length;r++){var o=i[r],a=o.matchSourceCaseSensitive?[t,o.sourceString]:[n,o.sourceString.toLocaleLowerCase()],l=a[0],s=a[1];if(l.substring(l.length-s.length)==s)return o}return null},e}();t.default=o},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(267),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CutPasteListChain=void 0;var r=n(268);Object.defineProperty(t,"CutPasteListChain",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),i=n(0),o=function(){function e(){var e=this;this.chains=null,this.expectedChangeSource=null,this.editor=null,this.disposer=null,this.onDrop=function(){e.cacheListChains("Drop")}}return e.prototype.getName=function(){return"CutPasteListChain"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler("drop",this.onDrop)},e.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 9:e.isCut&&this.cacheListChains("Cut");break;case 10:this.cacheListChains("Paste");break;case 7:this.chains&&this.chains.length>0&&this.expectedChangeSource==e.source&&this.editor&&((0,r.commitListChains)(this.editor,this.chains),this.chains=null,this.expectedChangeSource=null)}},e.prototype.cacheListChains=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getSelectedRegions();n&&(this.chains=i.VListChain.createListChains(n),this.expectedChangeSource=e)},e}();t.default=o},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(270),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HyperLink=void 0;var r=n(271);Object.defineProperty(t,"HyperLink",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e,t,n){var r=this;void 0===e&&(e=function(e){return e}),this.getTooltipCallback=e,this.target=t,this.onLinkClick=n,this.originalHref=null,this.trackedLink=null,this.editor=null,this.disposer=null,this.onMouse=function(e){var t,n,i=null===(t=r.editor)||void 0===t?void 0:t.getElementAtCursor("a[href]",e.target),o=i&&r.tryGetHref(i);o&&(null===(n=r.editor)||void 0===n||n.setEditorDomAttribute("title","mouseover"==e.type?r.getTooltipCallback(o,i):null))},this.onBlur=function(e){r.trackedLink&&r.updateLinkHrefIfShouldUpdate(),r.resetLinkTracking()}}return e.prototype.getName=function(){return"Hyperlink"},e.prototype.initialize=function(e){this.editor=e,this.disposer=e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse,blur:this.onBlur})},e.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},e.prototype.onPluginEvent=function(e){var t,n,i;if(6==e.eventType||2==e.eventType&&(!this.isContentEditValue(e.rawEvent)||32==e.rawEvent.which)||7==e.eventType){var o,a=(o=null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor("A[href]",void 0,e))&&o!==this.trackedLink||2==e.eventType||7==e.eventType;this.trackedLink&&(a||this.tryGetHref(this.trackedLink)!==this.originalHref)&&(a&&this.updateLinkHrefIfShouldUpdate(),this.resetLinkTracking()),!this.trackedLink&&o&&this.doesLinkDisplayMatchHref(o)&&(this.trackedLink=o,this.originalHref=this.tryGetHref(o))}if(6==e.eventType&&(o=null===(n=this.editor)||void 0===n?void 0:n.getElementAtCursor("A",e.rawEvent.srcElement))){if(this.onLinkClick&&!1!==this.onLinkClick(o,e.rawEvent))return;var l;if((l=this.tryGetHref(o))&&(0,r.isCtrlOrMetaPressed)(e.rawEvent)&&0===e.rawEvent.button){e.rawEvent.preventDefault();try{var s=this.target||"_blank",u=null===(i=this.editor)||void 0===i?void 0:i.getDocument().defaultView;null==u||u.open(l,s)}catch(e){}}}},e.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(e){return null}},e.prototype.isContentEditValue=function(e){return(0,r.isCharacterValue)(e)||8==e.which||46==e.which},e.prototype.updateLinkHrefIfShouldUpdate=function(){this.trackedLink&&!this.doesLinkDisplayMatchHref(this.trackedLink)&&this.updateLinkHref()},e.prototype.resetLinkTracking=function(){this.trackedLink=null,this.originalHref=""},e.prototype.doesLinkDisplayMatchHref=function(e){if(e){var t=e.innerText.trim().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp("^(?:https?:\\/\\/)?"+t+"\\/?","i"),r=this.tryGetHref(e);if(null!==r)return n.test(r)}return!1},e.prototype.updateLinkHref=function(){var e,t=this;if(this.trackedLink){var n=(0,r.matchLink)(this.trackedLink.innerText.trim());null!==n&&(null===(e=this.editor)||void 0===e||e.addUndoSnapshot((function(){t.trackedLink.href=n.normalizedUrl})))}},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(273),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetImage=t.isResizedTo=t.resizeByPercentage=t.canRegenerateImage=t.ImageEdit=void 0;var r=n(111);Object.defineProperty(t,"ImageEdit",{enumerable:!0,get:function(){return r.default}});var i=n(114);Object.defineProperty(t,"canRegenerateImage",{enumerable:!0,get:function(){return i.default}});var o=n(277);Object.defineProperty(t,"resizeByPercentage",{enumerable:!0,get:function(){return o.default}});var a=n(117);Object.defineProperty(t,"isResizedTo",{enumerable:!0,get:function(){return a.default}});var l=n(278);Object.defineProperty(t,"resetImage",{enumerable:!0,get:function(){return l.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(61);t.default=function(e,t){var n=t.angleRad,i=t.widthPx,o=t.heightPx,a=t.bottomPercent,l=t.leftPercent,s=t.rightPercent,u=t.topPercent,d=t.naturalWidth,c=t.naturalHeight,f=d*(1-l-s),h=c*(1-u-a),p=document.createElement("canvas"),v=(0,r.default)(t),g=v.targetWidth,m=v.targetHeight;p.width=g,p.height=m;var y=p.getContext("2d");return y&&(y.translate(g/2,m/2),y.rotate(n),y.scale(t.flippedHorizontal?-1:1,t.flippedVertical?-1:1),y.drawImage(e,d*l,c*u,f,h,-i/2,-o/2,i,o)),p.toDataURL("image/png",1)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getCropHTML=t.Cropper=void 0;var i=n(115),o=["w","e"],a=["s","n"],l={sw:0,nw:90,ne:180,se:270};function s(e,t,n,r,i){var o=n*(1-r)-i,a=n*e+t;return Math.max(Math.min(a,o),0)/n}function u(){var e=[];return[0,1].forEach((function(t){return[0,1].forEach((function(n){e.push(function(e,t){return{tag:"div",style:"position:absolute;left:"+e+"px;bottom:"+e+"px;"+(0==t?"right:"+e+"px;height:"+(7-2*e)+"px;":"top:"+e+"px;width:"+(7-2*e)+"px;")+";background-color:"+(0==e?"white":"black")}}(t,n))}))})),e}t.Cropper={onDragStart:function(e){var t=e.editInfo;return r({},t)},onDragging:function(e,t,n,r,o){var a,l=e.editInfo,u=e.x,d=e.y,c=e.options;r=(a=(0,i.rotateCoordinate)(r,o,l.angleRad))[0],o=a[1];var f=l.widthPx,h=l.heightPx,p=l.leftPercent,v=l.rightPercent,g=l.topPercent,m=l.bottomPercent,y=c.minWidth,b=c.minHeight,C=1-p-v,E=1-g-m;if(C>0&&E>0&&void 0!==y&&void 0!==b){var S=f/C,w=h/E,T="e"!=u?s(n.leftPercent,r,S,v,y):p,P="w"!=u?s(n.rightPercent,-r,S,p,y):v,O="s"!=d?s(n.topPercent,o,w,m,b):g,M="n"!=d?s(n.bottomPercent,-o,w,g,b):m;return l.leftPercent=T,l.rightPercent=P,l.topPercent=O,l.bottomPercent=M,l.widthPx=S*(1-T-P),l.heightPx=w*(1-O-M),!0}return!1}},t.getCropHTML=function(){var e={tag:"div",style:"position:absolute;background-color:rgb(0,0,0,0.5);pointer-events:none",className:"r_cropO"},t={tag:"div",style:"position:absolute;overflow:hidden",className:"r_cropC",children:[]};return t&&o.forEach((function(e){return a.forEach((function(n){var r;return null===(r=t.children)||void 0===r?void 0:r.push(function(e,t){return{tag:"div",className:"r_cropH",style:"position:absolute;pointer-events:auto;cursor:"+t+e+"-resize;"+("w"==e?"left":"right")+":0;"+("n"==t?"top":"bottom")+":0;width:22px;height:22px;transform:rotate("+l[t+e]+"deg)",dataset:{x:e,y:t},children:u()}}(e,n))}))})),[t,e,e,e,e]}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getRotateHTML=t.updateRotateHandlePosition=t.Rotator=void 0;var i=180/Math.PI;function o(e){var t;return{tag:"svg",namespace:"http://www.w3.org/2000/svg",style:"width:16px;height:16px;margin: 8px 8px",children:[{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:(t={d:"M 10.5,10.0 A 3.8,3.8 0 1 1 6.7,6.3",transform:"matrix(1.1 1.1 -1.1 1.1 11.6 -10.8)"},t["fill-opacity"]="0",t.stroke=e,t)},{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:{d:"M12.0 3.648l.884-.884.53 2.298-2.298-.53z",stroke:e}}]}}t.Rotator={onDragStart:function(e){var t=e.editInfo;return r({},t)},onDragging:function(e,t,n,r,o){var a=e.editInfo,l=e.options,s=a.heightPx/2+31,u=s*Math.sin(n.angleRad)+r,d=s*Math.cos(n.angleRad)-o,c=Math.atan2(u,d);if(!t.altKey&&l&&void 0!==l.minRotateDeg){var f=c*i;c=Math.round(f/l.minRotateDeg)*l.minRotateDeg/i}return a.angleRad!=c&&(a.angleRad=c,!0)}},t.updateRotateHandlePosition=function(e,t,n){var r=n.getBoundingClientRect();if(r){var i=r.top-e.top,o=r.left-e.left,a=r.right-e.right,l=r.bottom-e.bottom,s=Number.MAX_SAFE_INTEGER;i<=0?s=i:o<=0?s=o:a>=0?s=a:l>=0&&(s=l);var u=Math.max(Math.min(15,s),0),d=Math.max(Math.min(32,s-u),0);t.style.top=-u+"px",t.style.height=u+"px",n.style.top=-d+"px"}},t.getRotateHTML=function(e){var t=e.borderColor;return[{tag:"div",className:"r_rotateC",style:"position:absolute;left:50%;width:1px;background-color:"+t+";top:"+"-15px;height:15px;",children:[{tag:"div",className:"r_rotateH",style:"position:absolute;background-color:"+e.rotateHandleBackColor+";border:solid 1px "+t+";border-radius:50%;width:32px;height:32px;left:-16px;cursor:move;top:"+"-32px;",children:[o(t)]}]}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(112),i=n(116),o=n(117),a=n(34);t.default=function(e,t,n,l,s){var u,d,c,f=(0,a.getEditInfoFromImage)(t);(0,o.default)(t,n)||(u=t,d=t.src,c=function(){if(!e.isDisposed()&&e.contains(t)&&f){var o=t.getAttribute("src"),a=(0,i.default)(f,n),u=a.width,d=a.height;f.widthPx=Math.max(u,l),f.heightPx=Math.max(d,s),e.addUndoSnapshot((function(){(0,r.default)(e,t,f,o||"",!0)}),"ImageResize")}},u.onload=function(){u.onload=null,u.onerror=null,c()},u.onerror=function(){u.onload=null,u.onerror=null,c()},u.src=d)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(34);t.default=function(e,t){e.addUndoSnapshot((function(){t.style.width="",t.style.height="",t.style.maxWidth="100%",t.removeAttribute("width"),t.removeAttribute("height"),(0,r.deleteEditInfo)(t)}),"ImageResize")}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(280),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageResize=void 0;var r=n(281);Object.defineProperty(t,"ImageResize",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n,r,i,o){return void 0===t&&(t=10),void 0===n&&(n=10),void 0===r&&(r="#DB626C"),void 0===i&&(i=!1),void 0===o&&(o="img"),e.call(this,{minHeight:n,minWidth:t,borderColor:r,preserveRatio:i,imageSelector:o})||this}return i(t,e),t.prototype.showResizeHandle=function(e){this.setEditingImage(e,3)},t.prototype.hideResizeHandle=function(e){this.setEditingImage(null,e)},t}(n(111).default);t.default=o},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(283),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Paste=void 0;var r=n(284);Object.defineProperty(t,"Paste",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(285),i=n(286),o=n(287),a=n(288),l=n(291),s=n(292),u=n(297),d=n(305),c=n(306),f=n(308),h=n(13),p=function(){function e(e,t){void 0===e&&(e="SPAN"),void 0===t&&(t=!1),this.unknownTagReplacement=e,this.convertSingleImageBody=t}return e.prototype.getName=function(){return"Paste"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(10==e.eventType){var t=e.fragment,n=e.sanitizingOption,p=this.editor.getTrustedHTMLHandler();switch((0,u.default)(e,this.convertSingleImageBody)){case 0:(0,s.default)(e);break;case 1:case 2:(0,o.default)(e,p);break;case 3:(0,l.default)(e,p);break;case 5:(0,a.default)(t);break;case 4:n.additionalTagReplacements[h.GOOGLE_SHEET_NODE_NAME]="*";break;case 7:(0,r.default)(e,p);break;case 6:(0,i.default)(t),(0,d.default)(t)}(0,f.default)(n),(0,c.default)(n),n.unknownTagReplacement=this.unknownTagReplacement}},e}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){var n=e.fragment,i=e.clipboardData,o=i.html,a=i.image;if(o&&a){var l=(new DOMParser).parseFromString(t(o),"text/html");(0,r.moveChildNodes)(n,null==l?void 0:l.body)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function i(e){if(e&&!e.nextSibling&&["OL","UL","MENU"].indexOf((0,r.getTagOfNode)(e))<0){var t=!1;if((0,r.toArray)(e.childNodes).every((function(e){var n;return!(!(0,r.safeInstanceOf)(e,"Text")||(null===(n=e.nodeValue)||void 0===n?void 0:n.trim()))||"LI"==(0,r.getTagOfNode)(e)&&(t=!0,!0)}))&&t)return!0}return!1}t.default=function(e){i(e)?(0,r.wrap)((0,r.toArray)(e.childNodes),"UL"):(0,r.safeInstanceOf)(e.firstChild,"HTMLElement")&&i(e.firstChild)&&(0,r.changeElementTag)(e.firstChild,"UL")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.excelHandler=void 0;var r=n(0),i=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,o=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,a=/<tr[^>]*>[^<]*/i,l=/<table[^>]*>[^<]*/i;function s(e,t){if(e.match(i)){var n=t.match(a);e=(n?n[0]:"<TR>")+e+"</TR>"}if(e.match(o)){var r=t.match(l);e=(r?r[0]:"<TABLE>")+e+"</TABLE>"}return e}t.default=function(e,t){var n=e.fragment,i=e.sanitizingOption,o=e.htmlBefore,a=e.clipboardData,l=s(a.html,o);if(a.html!=l){var u=(new DOMParser).parseFromString(t(l),"text/html");(0,r.moveChildNodes)(n,null==u?void 0:u.body)}n.childNodes.length>0&&"DIV"==(0,r.getTagOfNode)(n.firstChild)&&Array.from(n.firstChild.childNodes).every((function(e){return"META"==(0,r.getTagOfNode)(e)||"TABLE"==(0,r.getTagOfNode)(e)&&e==n.firstChild.lastChild}))&&e.fragment.replaceChildren(n.firstChild.lastChild),(0,r.chainSanitizerCallback)(i.elementCallbacks,"TD",(function(e){return"none"==e.style.borderStyle&&(e.style.border="solid 1px #d4d4d4"),!0}))},t.excelHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13),i=n(289);t.default=function(e){e.querySelectorAll(r.WAC_IDENTIFY_SELECTOR).forEach((function(e){e.style.display=null,e.style.margin=null})),(0,i.isWordOnlineWithList)(e)&&(0,i.default)(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWordOnlineWithList=void 0;var r=n(290),i=n(0),o='div.ListContainerWrapper>ul[class^="BulletListStyle"],div.ListContainerWrapper>ol[class^="NumberListStyle"],span.WACImageContainer > img',a=["111","9643","9830"];function l(e,t,n){var r,i=t.createElement(n),o=null===(r=e.firstElementChild)||void 0===r?void 0:r.getAttribute("start");return o&&i.setAttribute("start",o),i}function s(e,t,n){if(e){var r,i=n.insertPositionNode;if(i)(r=i.parentNode)&&r.insertBefore(e,i);else(r=n.startElement.parentNode)?r.appendChild(e):t.appendChild(e)}}t.isWordOnlineWithList=function(e){return!(!e||!e.querySelector(o))},t.default=function(e){!function(e){(0,i.toArray)(e.querySelectorAll(o)).forEach((function(e){var t=new RegExp("\\bListContainerWrapper\\b","g");if(e.previousSibling){var n=(0,i.splitParentNode)(e,!0);n.className=n.className.replace(t,"")}if(e.nextSibling){var r=(0,i.splitParentNode)(e,!1);r.className=r.className.replace(t,"")}}))}(e),function(e){for(var t,n=e.querySelectorAll(".ListContainerWrapper"),o=[],a=0;a<n.length;a++){var l=n[a];if(t){var s=t.listItemContainers,u=s[s.length-1];l==u.nextSibling||(0,i.getFirstLeafNode)(l)==(0,i.getNextLeafSibling)(u.parentNode,u)?(s.push(l),t.endElement=l):(t.endElement=u,o.push(t),t=(0,r.createListItemBlock)(l))}else t=(0,r.createListItemBlock)(l)}(null==t?void 0:t.listItemContainers.length)>0&&o.push(t);return o}(e).forEach((function(t){var n;!function(e,t){(0,i.collapseNodes)(e,t.startElement,t.endElement,!0).forEach((function(e){"DIV"==(0,i.getTagOfNode)(e.firstChild)&&(0,i.unwrap)(e)}))}(e,t),t.insertPositionNode=t.endElement.nextSibling;var r=e.ownerDocument;t.listItemContainers.forEach((function(o){var u=function(e){var t=(0,i.getTagOfNode)(e.firstChild);return"UL"==t||"OL"==t?t:null}(o);n||(n=l(o,r,u)),(0,i.toArray)(o.querySelectorAll("li")).forEach((function(d){var c=parseInt(d.getAttribute("data-aria-level"));(0,i.getTagOfNode)(n)!=u&&1==c&&(s(n,e,t),n=l(o,r,u)),function(e,t,n,r){var o;if(!n)return;var l=parseInt(null!==(o=t.getAttribute("data-aria-level"))&&void 0!==o?o:""),s=t.getAttribute("data-leveltext");"UL"==n&&s&&a.indexOf(s.charCodeAt(0).toString())>-1&&(t.style.listStyleType='"'+s+'  "');var u=e;for(;l>1;){if(u.firstChild){var d=u.lastElementChild,c=(0,i.getTagOfNode)(d);"UL"==c||"OL"==c?u=d:(u.appendChild(r.createElement(n)),u=u.lastElementChild)}else u.appendChild(r.createElement(n)),u=u.firstElementChild;l--}u.appendChild(t)}(n,d,u,r)}))})),s(n,e,t);var o=t.startElement.parentNode;o&&t.listItemContainers.forEach((function(e){o.removeChild(e)}))})),function(e){return e.querySelectorAll(".WACImageContainer")}(e).forEach((function(e){(0,i.safeInstanceOf)(e,"HTMLSpanElement")&&e.childNodes.forEach((function(e){"IMG"!=(0,i.getTagOfNode)(e)&&e.parentElement.removeChild(e)}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListItemBlock=void 0,t.createListItemBlock=function(e){return void 0===e&&(e=null),{startElement:e,endElement:e,insertPositionNode:null,listItemContainers:e?[e]:[]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){var n=e.fragment,i=e.clipboardData;if(i.html&&!i.text&&i.image){var o=(new DOMParser).parseFromString(t(i.html),"text/html");(0,r.moveChildNodes)(n,null==o?void 0:o.body)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(293),i=n(0),o=n(294),a=n(295),l=n(296),s=/%/;t.default=function(e){var t=e.sanitizingOption,n=e.fragment;(0,i.chainSanitizerCallback)(t.elementCallbacks,"O:P",(function(e){return(0,i.moveChildNodes)(e),e.appendChild(e.ownerDocument.createTextNode("")),!0}));var u=(0,o.createWordConverter)(),d=n.querySelectorAll("p,h1,h2,h3,h4,h5,h6");d.length>0&&(u.wordConverterArgs=(0,a.createWordConverterArguments)(d),(0,l.processNodesDiscovery)(u)&&(0,l.processNodeConvert)(u)),["OL","UL"].forEach((function(e){(0,i.chainSanitizerCallback)(t.elementCallbacks,e,(function(e){return"0in"==e.style.marginBottom&&(e.style.marginBottom=""),!0}))})),(0,i.chainSanitizerCallback)(t.cssStyleCallbacks,"line-height",(function(e){var t;return!(s.test(e)&&!isNaN(t=parseInt(e))&&t<120)})),(0,r.default)(t.elementCallbacks,t.cssStyleCallbacks)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i="mso-comment-parent",o="mso-comment-reference",a="mso-comment-date",l=/#_msocom_/,s="mso-comment-continuation",u="mso-comment-done";t.default=function(e,t){(0,r.chainSanitizerCallback)(e,"SPAN",(function(e){var t;return"comment"==(0,r.getStyles)(e)["mso-special-character"]&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e)),!0})),(0,r.chainSanitizerCallback)(e,"A",(function(e){var t;return(0,r.safeInstanceOf)(e,"HTMLAnchorElement")&&l.test(e.href)&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e)),!0})),(0,r.chainSanitizerCallback)(e,"DIV",(function(e){return"comment-list"==(0,r.getStyles)(e)["mso-element"]&&(0,r.moveChildNodes)(e),!0})),[o,a,i,s,u].forEach((function(e){return(0,r.chainSanitizerCallback)(t,e,(function(){return!1}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createWordConverter=void 0;var r=n(118);t.createWordConverter=function(){return{nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,wordCustomData:(0,r.createCustomData)()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createWordConverterArguments=void 0;var r=n(119);t.createWordConverterArguments=function(e){return{nodes:e,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[(0,r.createLevelLists)()],lastProcessedItem:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processNodeConvert=t.processNodesDiscovery=void 0;var r=n(119),i=n(118),o=n(0),a=/[\n|\r]/gi;function l(e,t,n,r){var a=function e(t,n,r){var i,a=null;1==n?i=h(t):(a=e(t,n-1,null),i=a.lastChild);if(i&&1==i.nodeType){var l=(0,o.getTagOfNode)(i);if("UL"==l||"OL"==l)return i}var s=t.ownerDocument.createElement(r?r.tagName:"UL");1==n?t.parentNode.insertBefore(s,t):a.appendChild(s);return s}(t,n.level,r),l=(0,i.getObject)(e.wordCustomData,a,"UniqueListId");if(l&&l!=n.uniqueListId||!l&&a.firstChild){var s=t.ownerDocument.createElement(r.tagName);a.parentNode.insertBefore(s,a.nextSibling),a=s}return(0,i.setObject)(e.wordCustomData,a,"UniqueListId",n.uniqueListId),function(e,t,n){if(n.tagName!=(0,o.getTagOfNode)(t)){var r=t.ownerDocument.createElement(n.tagName);(0,i.setObject)(e.wordCustomData,r,"UniqueListId",(0,i.getObject)(e.wordCustomData,t,"UniqueListId")),(0,o.moveChildNodes)(r,t),t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t),t=r}return t}(e,a,r)}function s(e,t){for(var n=[],r=e.firstChild;r;r=r.nextSibling)1==r.nodeType&&t>1&&s(r,t-1),(g(r=f(r,!0))||v(r))&&n.push(r);n.forEach((function(t){return e.removeChild(t)}))}function u(e){if(1==e.nodeType){var t=m(e,"mso-list");if(t&&t.length>0)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr("level".length)),wordListId:t,originalNode:e,uniqueListId:0}}catch(e){}}return null}function d(e){return["o","","","-"].indexOf(e)>=0}function c(e,t){for(var n=null,r=e.firstChild;!n&&r;)v(r=f(r,!0))?0==(n=r.textContent.trim()).length&&(n="o"):1==r.nodeType&&t>1&&(n=c(r,t-1)),r=r.nextSibling;return n}function f(e,t){if(8==e.nodeType){var n=e.data;if(n&&"[if !supportlists]"==n.trim().toLowerCase()){for(var r=e,i=null,o=0;o<4&&(r=p(r));o++)if(8==r.nodeType&&(n=r.data)&&"[endif]"==n.trim().toLowerCase()){i=r;break}if(i){var a=e.ownerDocument.createElement("span");for(a.setAttribute("style","mso-list: ignore"),r=p(e);r!=i;)r=r.nextSibling,a.appendChild(r.previousSibling);i.parentNode.insertBefore(a,i),t&&(e.parentNode.removeChild(e),i.parentNode.removeChild(i)),e=a}}}return e}function h(e){var t=e;do{t=t.previousSibling}while(t&&y(t));return t}function p(e){var t=e;do{t=t.nextSibling}while(t&&y(t));return t}function v(e){if(1==e.nodeType){var t=m(e,"mso-list");if(t&&t.length>0&&"ignore"==t.trim().toLowerCase())return!0}return!1}function g(e){return"SPAN"==(0,o.getTagOfNode)(e)&&!e.firstChild}function m(e,t){return(0,o.getStyles)(e)[t]||null}function y(e){if(!e)return!0;if(3==e.nodeType){var t=e.nodeValue;return 0==(t=t.replace(a,"")).trim().length}var n=(0,o.getTagOfNode)(e);return e.firstChild==e.lastChild&&("SPAN"==n||"FONT"==n)&&y(e.firstChild)}function b(e){for(var t=0;t<e.currentListIdsByLevels.length;t++){var n=e.currentListIdsByLevels[t];n&&(n.currentUniqueListId=-1)}}t.processNodesDiscovery=function(e){for(var t,n=e.wordConverterArgs;n.currentIndex<n.nodes.length;){var i=n.nodes.item(n.currentIndex),a=u(i);if(a){var l=n.currentListIdsByLevels[a.level-1]||(0,r.createLevelLists)();n.currentListIdsByLevels[a.level-1]=l,n.lastProcessedItem&&h(i)!=n.lastProcessedItem&&b(n);var s=l.listsMetadata[a.wordListId];if(s){if(!s.ignore&&1==s.numberOfItems){var f=c(i,5);s.tagName=s.firstFakeBullet==f?"UL":"OL"}}else{var p=c(i,5);s={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:p,ignore:!p||0==p.length,tagName:(t=p,d(t)?"UL":"OL")},l.listsMetadata[a.wordListId]=s,n.lists[s.uniqueListId.toString()]=s}a.uniqueListId=s.uniqueListId,s.ignore||"OL"==s.tagName&&s.numberOfItems>0&&l.currentUniqueListId!=a.uniqueListId?(s.ignore=!0,n.currentListIdsByLevels[0].currentUniqueListId=-1,n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,1)):(n.currentListIdsByLevels.length>a.level&&(n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,a.level)),l.currentUniqueListId=a.uniqueListId,n.listItems.push(a),s.numberOfItems++),n.lastProcessedItem=i}else{var v=n.lastProcessedItem;v&&h(i)==v&&i.tagName==v.tagName&&i.className==v.className&&(v.appendChild(v.ownerDocument.createElement("br")),v.appendChild(v.ownerDocument.createElement("br")),(0,o.moveChildNodes)(v,i,!0),i.parentNode.removeChild(i))}n.currentIndex++}return n.listItems.length>0},t.processNodeConvert=function(e){var t=e.wordConverterArgs;for(t.currentIndex=0;t.currentIndex<t.listItems.length;){var n=t.listItems[t.currentIndex],r=n.originalNode,i=t.lists[n.uniqueListId.toString()];if(!i.ignore){var a=l(e,r,n,i);if(a){s(r,5);var u=r.ownerDocument.createElement("LI");if((0,o.getTagOfNode)(r).startsWith("H")){var d=r.cloneNode(!0);d.style.textIndent="",d.style.marginLeft="",d.style.marginRight="",u.appendChild(d)}else(0,o.moveChildNodes)(u,r);a.appendChild(u),r.parentNode.removeChild(r),"UL"==i.tagName?e.numBulletsConverted++:e.numNumberedConverted++}}t.currentIndex++}return e.numBulletsConverted>0||e.numNumberedConverted>0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(298),i=n(299),o=n(300),a=n(301),l=n(302),s=n(303),u=n(304),d=new Map([[0,s.default],[1,i.default],[2,o.default],[3,l.default],[5,r.default],[4,a.default],[7,u.default]]);t.default=function(e,t){var n=e.htmlAttributes,r=e.clipboardData,i=e.fragment,o=null,a={htmlAttributes:n,fragment:i,shouldConvertSingleImage:t,clipboardData:r};return d.forEach((function(e,t){!o&&e(a)&&(o=t)})),null!=o?o:6}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13);t.default=function(e){return!!e.fragment.querySelector(r.WAC_IDENTIFY_SELECTOR)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13);t.default=function(e){return"urn:schemas-microsoft-com:office:excel"==e.htmlAttributes[r.EXCEL_DESKTOP_ATTRIBUTE_NAME]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13);t.default=function(e){var t=e.htmlAttributes;return"Excel.Sheet"==t[r.PROG_ID_NAME]&&null==t[r.EXCEL_DESKTOP_ATTRIBUTE_NAME]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13);t.default=function(e){return!!e.fragment.querySelector(r.GOOGLE_SHEET_NODE_NAME)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13);t.default=function(e){return"PowerPoint.Slide"==e.htmlAttributes[r.PROG_ID_NAME]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13);t.default=function(e){var t=e.htmlAttributes;return"urn:schemas-microsoft-com:office:word"==t["xmlns:w"]||"Word.Document"==t[r.PROG_ID_NAME]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t,n=e.shouldConvertSingleImage,r=e.clipboardData;return n&&1==(null===(t=r.htmlFirstLevelChildTags)||void 0===t?void 0:t.length)&&"IMG"==r.htmlFirstLevelChildTags[0]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function i(e){var t,n,i=e.start,o=e.end;if(i==o&&"DIV"==(0,r.getTagOfNode)(i)){var a=(0,r.changeElementTag)(i,"SPAN");e.start=a,e.end=a,"BR"==(0,r.getTagOfNode)(a.lastChild)&&a.removeChild(a.lastChild)}else if("BR"==(0,r.getTagOfNode)(o)){a=o.ownerDocument.createTextNode("");null===(t=o.parentNode)||void 0===t||t.insertBefore(a,o),e.end=a,null===(n=o.parentNode)||void 0===n||n.removeChild(o)}}function o(e,t,n,i){var o,a,l,s,u=(0,r.getBlockElementAtNode)(e,t.start),d=n?(0,r.getNextLeafSibling)(e,t.end):(0,r.getPreviousLeafSibling)(e,t.start);if(d)if(null==u?void 0:u.contains(d))(c=null===(o=t.start.ownerDocument)||void 0===o?void 0:o.createElement("br"))&&(null===(a=(n?t.end:t.start).parentNode)||void 0===a||a.insertBefore(c,n?t.end.nextSibling:t.start));else if(i&&i.end==i.start&&"SPAN"==(0,r.getTagOfNode)(i.end)){var c,f=(0,r.getPreviousLeafSibling)(e,t.start);if(i.end.contains(f)&&!(0,r.findClosestElementAncestor)(t.start,e,"li"))(c=null===(l=t.start.ownerDocument)||void 0===l?void 0:l.createElement("br"))&&(null===(s=t.start.parentNode)||void 0===s||s.insertBefore(c,t.start))}}t.default=function(e){for(var t=r.ContentTraverser.createBodyTraverser(e),n=[],a=null==t?void 0:t.currentBlockElement;a;a=t.getNextBlockElement())n.push({start:a.getStartNode(),end:a.getEndNode()});if(n.length>0){var l=n.length-1;i(n[0]),i(n[l]),o(e,n[0],!0),o(e,n[l],!1,n[0])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(307);t.default=function(e){["color","background-color"].forEach((function(t){(0,r.chainSanitizerCallback)(e.cssStyleCallbacks,t,(function(e){return i.DeprecatedColorList.indexOf(e)<0}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeprecatedColorList=void 0,t.DeprecatedColorList=["activeborder","activecaption","appworkspace","background","buttonhighlight","buttonshadow","captiontext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedfhadow","window","windowframe","windowtext"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){(0,r.chainSanitizerCallback)(e.attributeCallbacks,"href",(function(e,t){return function(e,t){var n;try{n=new URL(e)}catch(e){n=void 0}if(n&&("http:"===n.protocol||"https:"===n.protocol||"notes:"===n.protocol))return e;return t.removeAttribute("href"),""}(e,t)}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(310),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PickerPlugin=void 0;var r=n(311);Object.defineProperty(t,"PickerPlugin",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),i=n(0),o=i.Browser.isIE?"Esc":"Escape",a=i.Browser.isIE?"Left":"ArrowLeft",l=i.Browser.isIE?"Up":"ArrowUp",s=i.Browser.isIE?"Right":"ArrowRight",u=i.Browser.isIE?"Down":"ArrowDown",d=i.Browser.isIE?"Del":"Delete",c=[0,229],f=function(){function e(e,t){this.dataProvider=e,this.pickerOptions=t,this.isPendingInputEventHandling=!1}return e.prototype.getName=function(){return"Picker"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.dataProvider.onInitalize((function(e){t.editor.focus();var n=t.getWord(null);n&&0!=n.length||!t.lastKnownRange||(t.editor.select(t.lastKnownRange),n=t.getWord(null));t.editor.addUndoSnapshot((function(){n?(0,r.replaceWithNode)(t.editor,n,e,!0):t.editor.insertNode(e),t.setIsSuggesting(!1)}),t.pickerOptions.changeSource,t.pickerOptions.handleAutoComplete)}),(function(e){t.setIsSuggesting(e)}),e)},e.prototype.dispose=function(){this.editor=null,this.isSuggesting=null,this.blockSuggestions=null,this.eventHandledOnKeyDown=null,this.lastKnownRange=null,this.isPendingInputEventHandling=null,this.currentInputLength=null,this.newInputLength=null,this.dataProvider.onDispose()},e.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||3==e.eventType)},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 7:if("SetContent"==e.source&&this.dataProvider.onContentChanged){this.isSuggesting&&this.setIsSuggesting(!1);var t=[];this.editor.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",(function(e){e.id&&t.push(e.id)})),this.dataProvider.onContentChanged(t)}break;case 0:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 3:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 6:this.isSuggesting&&this.setIsSuggesting(!1);break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},e.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},e.prototype.setIsSuggesting=function(e){this.isSuggesting=e,e||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},e.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},e.prototype.getIdValue=function(e){var t=e;return t.attributes&&t.attributes.getNamedItem("id")?t.attributes.getNamedItem("id").value:null},e.prototype.getWordBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e);return t?t.getWordBefore():null},e.prototype.replaceNode=function(e,t){e&&this.editor.deleteNode(e),t&&this.editor.insertNode(t)},e.prototype.getRangeUntilAt=function(e){var t,n,r=this;return this.editor.getContentSearcherOfCursor(e).forEachTextInlineElement((function(e){for(var i=!1,o=e.getTextContent(),a=o?o.length:-1;a>=0;){if(o[a]==r.pickerOptions.triggerCharacter){t=e.getStartPosition().move(a),i=!0;break}a--}return i&&(n=e.getEndPosition()),i})),(0,i.createRange)(t,n)||this.editor.getDocument().createRange()},e.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||(0,i.isCharacterValue)(e.rawEvent)||this.isSuggesting&&!(0,i.isModifierKey)(e.rawEvent)},e.prototype.onKeyUpDomEvent=function(e){if(this.isSuggesting){var t=(r=(n=this.getWord(e)).substring(1)).trim();n==this.pickerOptions.triggerCharacter||t&&t.length>0&&t.split(" ").length<=4?(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange())):this.setIsSuggesting(!1)}else{var n=this.getWordBeforeCursor(e);if(this.blockSuggestions)null!=n&&n[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1);else if(null!=n&&n.split(" ").length<=4&&n[0]==this.pickerOptions.triggerCharacter){this.setIsSuggesting(!0);var r;t=(r=n.substring(1)).trim();if(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange()),this.dataProvider.setCursorPoint){var i=this.editor.getContentSearcherOfCursor(e),o=this.editor.getDocument().createRange(),a=i.getInlineElementBefore().getContainerNode();if(!this.setRangeStart(o,a,n)){var l=a.previousSibling;this.setRangeStart(o,l,this.pickerOptions.triggerCharacter)}var s=o.getBoundingClientRect();if(0==s.left&&0==s.bottom&&0==s.top&&(s=o.getClientRects()[0]),s){o.detach();var u={x:s.left,y:(s.bottom+s.top)/2},d=(s.bottom-s.top)/2;this.dataProvider.setCursorPoint(u,d)}}}}},e.prototype.onKeyDownEvent=function(e){var t=e.rawEvent;if(this.isSuggesting)if(t.key==o)this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e);else if("Backspace"==t.key){this.getWord(e)==this.pickerOptions.triggerCharacter&&this.setIsSuggesting(!1)}else this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?t.key==a||t.key==s:t.key==l||t.key==u)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?t.key==s:t.key==u),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=t.key&&"Tab"!=t.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e));else if("Backspace"==t.key)this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e);else if(t.key==d){var n=this.editor.getContentSearcherOfCursor(e),r=n.getInlineElementAfter()?n.getInlineElementAfter().getContainerNode():null,i=r?this.getIdValue(r):null;if(i&&0==i.indexOf(this.pickerOptions.elementIdPrefix)){var c=this.dataProvider.onRemove(r,!1);this.replaceNode(r,c),this.cancelDefaultKeyDownEvent(e)}}},e.prototype.onAndroidInputEvent=function(e){(this.newInputLength=this.calcInputLength(e),this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&(this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0))},e.prototype.calcInputLength=function(e){var t=this.getInlineElementBeforeCursor(e);return t?t.length:0},e.prototype.tryRemoveNode=function(e){var t=this.editor.getContentSearcherOfCursor(e),n=t.getInlineElementBefore(),r=n?n.getContainerNode():null,o=r?this.getIdValue(r):null,a=t.getInlineElementAfter();if(o&&0==o.indexOf(this.pickerOptions.elementIdPrefix)&&(null==a||!(a instanceof i.PartialInlineElement))){var l=this.dataProvider.onRemove(r,!0);return l?(this.replaceNode(r,l),this.isPendingInputEventHandling?this.editor.runAsync((function(e){e.select(l,-3)})):this.editor.select(l,-3)):this.editor.deleteNode(r),!0}return!1},e.prototype.getWord=function(e){var t=this.getRangeUntilAt(e).toString(),n=this.getWordBeforeCursor(e);return t==this.pickerOptions.triggerCharacter&&t!=n?n:t},e.prototype.setRangeStart=function(e,t,n){var r=t?t.textContent.lastIndexOf(n):-1;return r>-1&&(e.setStart(t,r),!0)},e.prototype.setAriaOwns=function(e){this.editor.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},e.prototype.setAriaActiveDescendant=function(e){this.editor.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},e.prototype.getInlineElementBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e),n=t?t.getInlineElementBefore():null;return n?n.getTextContent():null},e.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||null==e.rawEvent.key&&c.indexOf(e.rawEvent.charCode)>-1},e}();t.default=f},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(313),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableResize=void 0;var r=n(314);Object.defineProperty(t,"TableResize",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(315),i=n(0),o=function(){function e(e){var t=this;this.onShowHelperElement=e,this.tableRectMap=null,this.onMouseMove=function(e){var n;if(!(e.buttons>0)){t.ensureTableRects();for(var r=t.editor.getDocument().defaultView,i=e.pageX-r.scrollX,o=e.pageY-r.scrollY,a=null,l=t.tableRectMap.length-1;l>=0;l--){var s=t.tableRectMap[l],u=s.table,d=s.rect;if(i>=d.left-12&&i<=d.right+12&&o>=d.top-12&&o<=d.bottom+12){a=u;break}}t.setTableEditor(a,e),null===(n=t.tableEditor)||void 0===n||n.onMouseMove(i,o)}},this.invalidateTableRects=function(){t.tableRectMap=null}}return e.prototype.getName=function(){return"TableResize"},e.prototype.initialize=function(e){this.editor=e,this.onMouseMoveDisposer=this.editor.addDomEventHandler({mousemove:this.onMouseMove})},e.prototype.dispose=function(){this.onMouseMoveDisposer(),this.invalidateTableRects(),this.disposeTableEditor(),this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 3:case 7:case 14:case 21:this.setTableEditor(null),this.invalidateTableRects()}},e.prototype.setTableEditor=function(e,t){this.tableEditor&&!this.tableEditor.isEditing()&&e!=this.tableEditor.table&&this.disposeTableEditor(),!this.tableEditor&&e&&(this.tableEditor=new r.default(this.editor,e,this.invalidateTableRects,this.onShowHelperElement,t.currentTarget))},e.prototype.disposeTableEditor=function(){var e;null===(e=this.tableEditor)||void 0===e||e.dispose(),this.tableEditor=null},e.prototype.ensureTableRects=function(){var e=this;this.tableRectMap||(this.tableRectMap=[],this.editor.queryElements("table",(function(t){if(t.isContentEditable){var n=(0,i.normalizeRect)(t.getBoundingClientRect());n&&e.tableRectMap.push({table:t,rect:n})}})))},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(316),i=n(317),o=n(318),a=n(319),l=n(320),s=n(0),u=function(){function e(e,t,n,r,i){var l=this;this.editor=e,this.table=t,this.onChanged=n,this.onShowHelperElement=r,this.horizontalInserter=null,this.verticalInserter=null,this.horizontalResizer=null,this.verticalResizer=null,this.onFinishEditing=function(){return l.editor.focus(),l.editor.select(l.start,l.end),l.editor.addUndoSnapshot(null,"Format"),l.onChanged(),l.isCurrentlyEditing=!1,!1},this.onStartTableResize=function(){l.isCurrentlyEditing=!0,l.onStartResize()},this.onStartCellResize=function(){l.isCurrentlyEditing=!0,l.disposeTableResizer(),l.onStartResize()},this.onInserted=function(e){l.editor.transformToDarkColor(e),l.disposeTableResizer(),l.onFinishEditing()},this.onSelect=function(e){if(l.editor.focus(),e){var t=new s.VTable(e);if(t.cells){var n=t.cells.length-1,r=0;t.cells[n].forEach((function(e,t){r=t}));var i={firstCell:{x:0,y:0},lastCell:{y:n,x:r}};l.editor.select(e,i)}}},this.isRTL="rtl"==(0,s.getComputedStyle)(t,"direction");var u=e.getZoomScale();this.tableResizer=(0,o.default)(t,u,this.isRTL,this.onStartTableResize,this.onFinishEditing,this.onShowHelperElement),this.tableSelector=(0,a.default)(t,u,e,this.onSelect,this.onShowHelperElement,i),this.isCurrentlyEditing=!1}return e.prototype.dispose=function(){this.disposeTableResizer(),this.disposeCellResizers(),this.disposeTableInserter(),this.disposeTableSelector()},e.prototype.isEditing=function(){return this.isCurrentlyEditing},e.prototype.onMouseMove=function(e,t){for(var n,r=0;r<this.table.rows.length;r++){for(var i=this.table.rows[r],o=0;o<i.cells.length;o++){var a=i.cells[o],l=(0,s.normalizeRect)(this.table.getBoundingClientRect()),u=(0,s.normalizeRect)(a.getBoundingClientRect());if(u&&l){var d=t<=u.bottom;if((this.isRTL?e>=u.right:e<=u.right)&&d){var c=this.isRTL?u.right<=l.right&&u.right>=l.right-1:u.left>=l.left&&u.left<=l.left+1;if(0===r&&t<=u.top+5){var f=(u.left+u.right)/2,h=this.isRTL?e<f:e>f;this.setInserterTd(h?a:i.cells[o-1],!1)}else if(0==o&&(this.isRTL?e>=u.right-5:e<=u.left+5)&&c){var p=null===(n=this.table.rows[r-1])||void 0===n?void 0:n.cells[0],v=p?(0,s.normalizeRect)(p.getBoundingClientRect()):null,g=v?this.isRTL?v.right===u.right:v.left===u.left:null;this.setInserterTd(t<(u.top+u.bottom)/2&&g?p:a,!0)}else this.setInserterTd(null);this.setResizingTd(a);break}}}if(o<i.cells.length)break}},e.prototype.setResizingTd=function(e){if(this.horizontalResizer&&this.horizontalResizer.node!=e&&this.disposeCellResizers(),!this.horizontalResizer&&e){var t=this.editor.getZoomScale();this.horizontalResizer=(0,r.default)(e,t,this.isRTL,!0,this.onStartCellResize,this.onFinishEditing,this.onShowHelperElement),this.verticalResizer=(0,r.default)(e,t,this.isRTL,!1,this.onStartCellResize,this.onFinishEditing,this.onShowHelperElement)}},e.prototype.setInserterTd=function(e,t){var n=t?this.horizontalInserter:this.verticalInserter;if((null===e||n&&n.node!=e)&&this.disposeTableInserter(),!this.horizontalInserter&&!this.verticalInserter&&e){var r=(0,i.default)(this.editor,e,this.isRTL,!!t,this.onInserted,this.onShowHelperElement);t?this.horizontalInserter=r:this.verticalInserter=r}},e.prototype.disposeTableResizer=function(){this.tableResizer&&((0,l.disposeTableEditFeature)(this.tableResizer),this.tableResizer=null)},e.prototype.disposeTableInserter=function(){this.horizontalInserter&&((0,l.disposeTableEditFeature)(this.horizontalInserter),this.horizontalInserter=null),this.verticalInserter&&((0,l.disposeTableEditFeature)(this.verticalInserter),this.verticalInserter=null)},e.prototype.disposeCellResizers=function(){this.horizontalResizer&&((0,l.disposeTableEditFeature)(this.horizontalResizer),this.horizontalResizer=null),this.verticalResizer&&((0,l.disposeTableEditFeature)(this.verticalResizer),this.verticalResizer=null)},e.prototype.disposeTableSelector=function(){this.tableSelector&&((0,l.disposeTableEditFeature)(this.tableSelector),this.tableSelector=null)},e.prototype.onStartResize=function(){this.isCurrentlyEditing=!0;var e=this.editor.getSelectionRange();e&&(this.start=s.Position.getStart(e),this.end=s.Position.getEnd(e)),this.editor.addUndoSnapshot()},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=n(0);function o(e,t){var n=e.td,r=e.isRTL,o=e.zoomScale,a=e.onStart,l=new i.VTable(n,!0,o),s=(0,i.normalizeRect)(n.getBoundingClientRect());if(s){a();var u=l.getCellsWithBorder(r?s.left:s.right,!r),d=l.getCellsWithBorder(r?s.left:s.right,r);return{vTable:l,currentCells:u,nextCells:d,initialX:t.pageX}}return{vTable:l,currentCells:[],nextCells:[],initialX:0}}function a(e,t,n,r,i){var o=e.td,a=e.zoomScale,l=n.vTable;return l.table.removeAttribute("height"),l.table.style.height=null,l.forEachCellOfCurrentRow((function(e){e.td&&(e.td.style.height=e.td==o?e.height/a+i+"px":null)})),l.writeBack(!0),!0}function l(e,t,n,r){var o=e.isRTL,a=e.zoomScale,l=n.vTable,u=n.nextCells,d=n.currentCells,c=n.initialX;if(!function(e,t,n,r,o){for(var a=0;a<t.length;a++){var l=t[a];if(u=(0,i.normalizeRect)(l.getBoundingClientRect()))if((d=s(u,e,!r)/o)<30)return!1}for(a=0;a<n.length;a++){l=n[a];var u,d=Number.MAX_SAFE_INTEGER;if(l)(u=(0,i.normalizeRect)(l.getBoundingClientRect()))&&(d=s(u,e,r)/o);if(d<30)return!1}return!0}(t.pageX,d,u,o,a))return!1;var f=0==u.length,h=t.shiftKey;(f||h)&&(l.table.style.width=null);var p=new Map;return d.forEach((function(e){var n=(0,i.normalizeRect)(e.getBoundingClientRect());if(n){e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box";var r=s(n,t.pageX,!o)/a;p.set(e,r)}})),p.forEach((function(e,t){t.style.width=e+"px"})),h||u.forEach((function(e){var t=e.rowSpan>1?0:e.getBoundingClientRect().right-c;e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box",e.style.width=e.rowSpan>1?"":t/a-r+"px"})),l.writeBack(!0),!0}function s(e,t,n){return n?t-e.left:e.right-t}function u(e,t){var n=e.td,r=(0,i.normalizeRect)(n.getBoundingClientRect());r&&(t.style.top=r.bottom-4+"px",t.style.left=r.left+"px",t.style.width=r.right-r.left+"px",t.style.height="4px")}function d(e,t){var n=e.td,r=e.isRTL,o=(0,i.normalizeRect)(n.getBoundingClientRect());o&&(t.style.top=o.top+"px",t.style.left=(r?o.left:o.right)-4+1+"px",t.style.width="4px",t.style.height=o.bottom-o.top+"px")}t.default=function(e,t,n,s,c,f,h){var p=e.ownerDocument,v={tag:"div",style:"position: fixed; cursor: "+(s?"row":"col")+"-resize; user-select: none"};null==h||h(v,"CellResizer");var g=(0,i.createElement)(v,p);p.body.appendChild(g);var m={td:e,isRTL:n,zoomScale:t,onStart:c},y=s?u:d;y(m,g);var b={onDragStart:o,onDragging:s?a:l,onDragEnd:f};return{node:e,div:g,featureHandler:new r.default(g,m,y,b,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t,n,o,a,l){var s=e.getElementAtCursor("table",t),u=(0,r.normalizeRect)(t.getBoundingClientRect()),d=s?(0,r.getIntersectedRect)([s],[e.getVisibleViewport()]):null;if(u&&d){var c=t.ownerDocument,f=function(e,t,n,r){var i=t?"white":"#4A4A4A",o=n?"right":"left";return{tag:"div",style:"position: fixed; width: 12px; height: 12px; font-size: 16px; color: "+i+"; line-height: 8px; vertical-align: middle; text-align: center; cursor: pointer; border: solid 1px "+i+"; border-radius: 50%; background-color: "+r,children:[{tag:"div",style:"position: absolute; box-sizing: border-box; background-color: "+r+";"+(e?o+": 12px; top: 5px; height: 3px; border-top: 1px solid "+i+"; border-bottom: 1px solid "+i+"; border-right: 1px solid "+i+"; border-left: 0px;":"left: 5px; top: 12px; width: 3px; border-left: 1px solid "+i+"; border-right: 1px solid "+i+"; border-bottom: 1px solid "+i+"; border-top: 0px;")},"+"]}}(o,e.isDarkMode(),n,e.getDefaultFormat().backgroundColor||"white");null==l||l(f,"TableInserter");var h=(0,r.createElement)(f,c);return o?(h.style.left=(n?u.right:u.left-13)+"px",h.style.top=u.bottom-8+"px",h.firstChild.style.width=d.right-d.left+"px"):(h.style.left=(n?u.left-8:u.right-8)+"px",h.style.top=u.top-13+"px",h.firstChild.style.height=d.bottom-d.top+"px"),c.body.appendChild(h),{div:h,featureHandler:new i(h,t,o,e,a),node:t}}return null};var i=function(){function e(e,t,n,i,o){var a=this;this.div=e,this.td=t,this.isHorizontal=n,this.editor=i,this.onInsert=o,this.insertTd=function(){var e=new r.VTable(a.td);a.isHorizontal||(e.normalizeTableCellSize(a.editor.getZoomScale()),e.table.removeAttribute("width"),e.table.style.width=null),e.edit(a.isHorizontal?1:3),e.writeBack(),a.onInsert(e.table)},this.div.addEventListener("click",this.insertTd)}return e.prototype.dispose=function(){this.div.removeEventListener("click",this.insertTd),this.div=null,this.editor=null},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=n(0);function o(e){return e.onStart(),{originalRect:e.table.getBoundingClientRect(),vTable:new i.VTable(e.table,!0,e.zoomScale)}}function a(e,t,n,r,i){var o=e.isRTL,a=e.zoomScale,l=n.originalRect,s=n.vTable,u=1+r/l.width*a*(o?-1:1),d=1+i/l.height*a,c=Math.abs(u-1)>.001,f=Math.abs(d-1)>.001;if(c||f){for(var h=0;h<s.cells.length;h++)for(var p=0;p<s.cells[h].length;p++){var v=s.cells[h][p];if(v.td){if(c){s.table.style.width=null;var g=v.width*u/a;v.td.style.boxSizing="border-box",g>=30&&(v.td.style.wordBreak="break-word",v.td.style.whiteSpace="normal",v.td.style.width=g+"px")}if(f)if(s.table.style.height=null,0==p){var m=v.height*d/a;m>=20&&(v.td.style.height=m+"px")}else v.td.style.height=null}}return s.writeBack(!0),!0}return!1}function l(e,t){var n=e.table,r=e.isRTL,o=(0,i.normalizeRect)(n.getBoundingClientRect());o&&(t.style.top=o.bottom+"px",t.style.left=r?o.left-12-2+"px":o.right+"px")}t.default=function(e,t,n,s,u,d){var c=e.ownerDocument,f={tag:"div",style:"position: fixed; cursor: "+(n?"ne":"nw")+"-resize; user-select: none; border: 1px solid #808080"};null==d||d(f,"TableResizer");var h=(0,i.createElement)(f,c);h.style.width="12px",h.style.height="12px",c.body.appendChild(h);var p={isRTL:n,table:e,zoomScale:t,onStart:s};return l(p,h),{node:e,div:h,featureHandler:new r.default(h,p,l,{onDragStart:o,onDragging:a,onDragEnd:u},t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=n(0);function o(e,t){var n=e.rect;n&&(t.style.top=n.top-12+"px",t.style.left=n.left-12-2+"px")}t.default=function(e,t,n,a,l,s){var u=(0,i.normalizeRect)(e.getBoundingClientRect());if(!function(e,t,n){var r=e.getVisibleViewport();if(n&&(0,i.safeInstanceOf)(n,"HTMLElement")&&r&&t){return(0,i.normalizeRect)(n.getBoundingClientRect()).top<=t.top&&r.top<=t.top}return!0}(n,u,s))return null;var d=e.ownerDocument,c={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"};null==l||l(c,"TableSelector");var f=(0,i.createElement)(c,d);f.id="_Table_Selector",f.style.width="12px",f.style.height="12px",d.body.appendChild(f);var h={table:e,zoomScale:t,rect:u};o(h,f);var p=new r.default(f,h,o,{onDragEnd:function(e,t){return t.target==f&&a(e.table),!1}},t);return{div:f,featureHandler:p,node:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disposeTableEditFeature=void 0,t.disposeTableEditFeature=function(e){var t,n,r;e&&(null===(n=null===(t=e.div)||void 0===t?void 0:t.parentNode)||void 0===n||n.removeChild(e.div),e.div=null,null===(r=e.featureHandler)||void 0===r||r.dispose(),e.featureHandler=null)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(322),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Watermark=void 0;var r=n(323);Object.defineProperty(t,"Watermark",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(9),o=function(){function e(e,t,n){var o=this;this.watermark=e,this.customClass=n,this.editor=null,this.disposer=null,this.showHideWatermark=function(){if(o.editor){var e=o.editor.hasFocus(),t=o.editor.queryElements((0,r.getEntitySelector)("WATERMARK_WRAPPER")),n=t.length>0;if(e&&n)t.forEach(o.removeWatermark),o.editor.focus();else if(!e&&!n&&o.editor.isEmpty()){var a=(0,i.insertEntity)(o.editor,"WATERMARK_WRAPPER",o.editor.getDocument().createTextNode(o.watermark),!1,!1,0);o.customClass&&a.wrapper.classList.add(o.customClass)}}},this.removeWatermark=function(e){var t,n=e.parentNode;null==n||n.removeChild(e),n&&(null===(t=o.editor)||void 0===t?void 0:t.contains(n))&&"DIV"==(0,r.getTagOfNode)(n)&&!n.firstChild&&n.appendChild(o.editor.getDocument().createElement("BR"))},this.format=t||{fontSize:"14px",textColors:{lightModeColor:"#AAAAAA",darkModeColor:"#6B6B6B"}}}return e.prototype.getName=function(){return"Watermark"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler({focus:this.showHideWatermark,blur:this.showHideWatermark})},e.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;if(11==e.eventType||7==e.eventType&&"WATERMARK_WRAPPER"!=(null===(t=e.data)||void 0===t?void 0:t.type))this.showHideWatermark();else if(15==e.eventType&&"WATERMARK_WRAPPER"==e.entity.type&&this.editor){var n=e.operation,i=e.entity.wrapper;8==n?this.removeWatermark(i):0==e.operation&&((0,r.applyFormat)(i,this.format,this.editor.isDarkMode(),this.editor.getDarkColorHandler()),i.spellcheck=!1)}},e}();t.default=o},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(325),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableCellSelection=void 0;var r=n(326);Object.defineProperty(t,"TableCellSelection",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(327),i=n(328),o=n(329),a=n(0),l=[16,18,91,17,44],s=function(){function e(){var e=this;this.onMouseMove=function(t){if(e.editor.contains(t.target)){if(e.tableSelection&&(0,a.contains)(e.lastTarget,t.target,!0))return u(e.editor,e.firstTarget,0),void t.preventDefault();if("TABLE"!=(0,a.getTagOfNode)(t.target)){if(e.setData(t.target),!e.firstTarget||e.firstTable)if(e.lastTarget.lastChild==e.lastTarget.firstChild&&"TABLE"==(0,a.getTagOfNode)(e.lastTarget.lastChild)&&"DIV"==(0,a.getTagOfNode)(e.lastTarget)||!e.editor.contains(e.lastTarget))t.preventDefault();else{e.prepareSelection();var n=!!(0,a.safeInstanceOf)(e.lastTarget,"HTMLTableCellElement")&&(0,a.contains)(e.lastTarget,e.firstTable);e.firstTable&&e.firstTable==e.targetTable||n?e.selectionInsideTableMouseMove(t):e.tableSelection&&e.restoreSelection(),e.tableSelection&&(u(e.editor,e.firstTarget,0),t.preventDefault())}}else t.preventDefault()}},this.onMouseUp=function(){e.editor&&e.removeMouseUpEventListener()},this.lastTarget=null,this.firstTarget=null,this.tableSelection=!1,this.tableRange={firstCell:null,lastCell:null},this.startedSelection=!1}return e.prototype.getName=function(){return"TableCellSelection"},e.prototype.initialize=function(e){this.editor=e,this.editor.addContentEditFeature(i.DeleteTableContents)},e.prototype.dispose=function(){this.editor.select(null),this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case 17:var t=this.editor.getSelectionRangeEx();1==t.type&&(this.tableRange=t.coordinates,this.firstTable=t.table,this.tableSelection=!0,this.editor.select(t.table,null));break;case 18:if(this.firstTable&&this.tableSelection&&this.tableRange){var n=this.editor.queryElements("#"+this.firstTable.id);1==n.length&&(this.firstTable=n[0],this.editor.select(this.firstTable,this.tableRange))}break;case 5:this.startedSelection||this.handleMouseDownEvent(e);break;case 0:this.startedSelection?e.rawEvent.preventDefault():this.handleKeyDownEvent(e);break;case 2:this.startedSelection?e.rawEvent.preventDefault():this.handleKeyUpEvent(e);break;case 14:this.startedSelection&&this.handleScrollEvent();break;case 20:this.tableRange&&(this.tableRange=null,this.firstTable=null,this.tableSelection=!1,this.editor.select(null))}},e.prototype.handleScrollEvent=function(){this.setData(this.editor.getElementAtCursor()),this.firstTable==this.targetTable?this.tableSelection&&(this.vTable.selection.lastCell=(0,o.getCellCoordinates)(this.vTable,this.lastTarget),this.selectTable(),this.tableRange.lastCell=this.vTable.selection.lastCell,u(this.editor,this.firstTarget,0)):this.tableSelection&&this.restoreSelection()},e.prototype.handleKeyDownEvent=function(e){var t,n=this,r=e.rawEvent,i=r.shiftKey,o=r.ctrlKey,l=r.metaKey,s=r.which,u=r.defaultPrevented;if(i&&(o||l)||16==s||u)this.preventKeyUp=u;else if(i){if(!this.firstTarget){var c=this.editor.getFocusedPosition(),f=c&&d(this.editor,c.node);this.firstTarget=this.firstTarget||f}if(!(0,a.safeInstanceOf)(this.firstTarget,"HTMLTableCellElement"))return;this.editor.runAsync((function(t){var r=t.getFocusedPosition(),i=n.tableSelection?n.lastTarget:null==r?void 0:r.node;if(i&&n.setData(i),n.firstTable==n.targetTable){if(!n.shouldConvertToTableSelection()&&!n.tableSelection)return;n.handleKeySelectionInsideTable(e)}else n.tableSelection&&(n.firstTable&&n.editor.select(n.firstTable,null),n.tableSelection=!1)}))}else 1!=(null===(t=this.editor.getSelectionRangeEx())||void 0===t?void 0:t.type)||(0,a.isCtrlOrMetaPressed)(e.rawEvent)&&36!=s&&35!=s||this.editor.select(null)},e.prototype.handleKeyUpEvent=function(e){var t=e.rawEvent,n=t.shiftKey,r=t.which,i=t.ctrlKey;n||i||!this.firstTarget||this.preventKeyUp||-1!=l.indexOf(r)||this.clearState(),this.preventKeyUp=!1},e.prototype.handleKeySelectionInsideTable=function(e){if(this.firstTarget=d(this.editor,this.firstTarget),this.lastTarget=d(this.editor,this.lastTarget),u(this.editor,this.firstTarget,0),this.vTable=this.vTable||new a.VTable(this.firstTable),this.tableRange={firstCell:(0,o.getCellCoordinates)(this.vTable,this.firstTarget),lastCell:this.getNextTD(e)},!this.tableRange.lastCell||this.tableRange.lastCell.y>this.vTable.cells.length-1||-1==this.tableRange.lastCell.y){if(this.lastTarget=this.editor.getElementAtCursor("td,th,div",this.firstTable),!(0,a.safeInstanceOf)(this.lastTarget,"HTMLTableCellElement")){var t=new a.Position(this.targetTable,null==this.tableRange.lastCell.y||-1==this.tableRange.lastCell.y?-2:-3),n=this.editor.getDocument().defaultView.getSelection(),r=n.anchorNode,i=n.anchorOffset;return this.editor.select(n.getRangeAt(0)),n.setBaseAndExtent(r,i,t.node,t.offset),this.lastTarget=t.node,void e.rawEvent.preventDefault()}this.prepareSelection()}this.vTable.selection=this.tableRange,this.selectTable();var l=this.isAfter(this.firstTarget,this.lastTarget),s=new a.Position(this.lastTarget,l?0:-1);u(this.editor,s.node,s.offset),this.tableSelection=!0,e.rawEvent.preventDefault()},e.prototype.handleMouseDownEvent=function(e){var t=this,n=e.rawEvent,i=n.which,l=n.shiftKey;if(3==i&&this.tableSelection){var s=this.editor.getElementAtCursor("td,th"),f=(0,o.getCellCoordinates)(this.vTable,s);if(f){var h=(0,r.default)(this.vTable),p=h.firstCell,v=h.lastCell;if(f.y>=p.y&&f.y<=v.y&&f.x>=p.x&&f.x<=v.x){if(this.firstTarget=this.vTable.getCell(p.y,p.x).td,this.lastTarget=this.vTable.getCell(v.y,v.x).td,this.firstTarget&&this.lastTarget)this.editor.getDocument().defaultView.getSelection().setBaseAndExtent(this.firstTarget,0,this.lastTarget,0),this.selectTable();return}}}1!=i||l||(this.clearState(),c(this.editor,e.rawEvent.target)&&(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.editor.getDocument().addEventListener("mousemove",this.onMouseMove,!0),this.startedSelection=!0)),1==i&&l&&this.editor.runAsync((function(e){var n=e.getDocument().defaultView.getSelection(),r=d(e,n.anchorNode),i=d(e,n.focusNode),l=c(e,r),s=c(e,r);if(l==s&&(0,a.safeInstanceOf)(r,"HTMLTableCellElement")&&(0,a.safeInstanceOf)(i,"HTMLTableCellElement")){t.vTable=new a.VTable(r);var f=(0,o.getCellCoordinates)(t.vTable,r),h=(0,o.getCellCoordinates)(t.vTable,i);t.vTable.selection={firstCell:f,lastCell:h},t.firstTarget=r,t.lastTarget=i,t.selectTable(),t.tableRange=t.vTable.selection,t.tableSelection=!0,t.firstTable=l,t.targetTable=s,u(e,r,0)}}))},e.prototype.restoreSelection=function(){this.firstTable&&this.editor.select(this.firstTable,null),this.tableSelection=!1;var e=this.isAfter(this.firstTarget,this.lastTarget),t=new a.Position(this.lastTarget,e?-1:0),n=new Range;this.firstTarget&&n.selectNodeContents(this.firstTarget),u(this.editor,this.firstTarget,e?a.Position.getEnd(n).offset:a.Position.getStart(n).offset,t.element,t.offset)},e.prototype.selectionInsideTableMouseMove=function(e){var t;if(this.lastTarget!=this.firstTarget)u(this.editor,this.firstTarget,0),this.firstTable!=this.targetTable&&(null===(t=this.targetTable)||void 0===t?void 0:t.contains(this.firstTable))&&(this.firstTarget=this.editor.getElementAtCursor("td,th",this.lastTarget)),this.firstTable&&(this.tableSelection=!0,this.vTable=this.vTable||new a.VTable(this.firstTable),this.tableRange={firstCell:(0,o.getCellCoordinates)(this.vTable,this.firstTarget),lastCell:(0,o.getCellCoordinates)(this.vTable,this.lastTarget)},this.vTable.selection=this.tableRange,this.selectTable()),e.preventDefault();else if(this.lastTarget==this.firstTarget&&this.tableSelection){this.vTable=new a.VTable(this.firstTable);var n=(0,o.getCellCoordinates)(this.vTable,this.firstTarget);this.tableRange={firstCell:n,lastCell:n},this.vTable.selection=this.tableRange,this.selectTable()}},e.prototype.removeMouseUpEventListener=function(){this.startedSelection&&(this.startedSelection=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0),this.editor.getDocument().removeEventListener("mousemove",this.onMouseMove,!0))},e.prototype.clearState=function(){this.editor.select(null),this.vTable=null,this.firstTarget=null,this.lastTarget=null,this.tableRange={firstCell:null,lastCell:null},this.tableSelection=!1,this.firstTable=null,this.targetTable=null},e.prototype.getNextTD=function(e){if(this.lastTarget=this.editor.getElementAtCursor("td,th",this.lastTarget),(0,a.safeInstanceOf)(this.lastTarget,"HTMLTableCellElement")){var t=(0,o.getCellCoordinates)(this.vTable,this.lastTarget);if(this.tableSelection)switch(e.rawEvent.which){case 39:t.x+=this.lastTarget.colSpan,null==this.vTable.cells[t.y][t.x]&&(t.x=this.vTable.cells[t.y].length-1,t.y++);break;case 37:0==t.x?t.y--:t.x--;break;case 38:t.y--;break;case 40:t.y++}return t.y>=0&&t.x>=0&&(this.lastTarget=this.vTable.getTd(t.y,t.x)),t}return null},e.prototype.prepareSelection=function(){var e,t,n,r,i=this.lastTarget!=this.firstTarget&&(null===(e=this.firstTable)||void 0===e?void 0:e.contains((0,a.findClosestElementAncestor)(this.targetTable,this.firstTable,"td,th")));if(i&&this.tableSelection)for(;i;)this.lastTarget=(0,a.findClosestElementAncestor)(this.targetTable,this.firstTable,"td,th"),this.targetTable=c(this.editor,this.lastTarget),i=this.lastTarget!=this.firstTarget&&(null===(t=this.firstTable)||void 0===t?void 0:t.contains((0,a.findClosestElementAncestor)(this.targetTable,this.firstTable,"td,th")));var o=this.lastTarget!=this.firstTarget&&(null===(n=this.targetTable)||void 0===n?void 0:n.contains((0,a.findClosestElementAncestor)(this.firstTable,this.targetTable,"td,th")));if(o&&this.tableSelection)for(;o;)this.firstTarget=(0,a.findClosestElementAncestor)(this.firstTable,this.targetTable,"td,th"),this.firstTable=this.editor.getElementAtCursor("table",this.firstTarget),o=this.lastTarget!=this.firstTarget&&(null===(r=this.targetTable)||void 0===r?void 0:r.contains((0,a.findClosestElementAncestor)(this.firstTable,this.targetTable,"td,th")))},e.prototype.setData=function(e){var t=this.editor.getFocusedPosition();t&&(this.firstTarget=this.firstTarget||d(this.editor,t.node),this.firstTarget.nodeType==Node.TEXT_NODE&&(this.firstTarget=this.editor.getElementAtCursor("td,th",this.firstTarget)),!this.editor.contains(this.firstTarget)&&this.lastTarget&&(this.firstTarget=this.lastTarget)),this.firstTable=c(this.editor,this.firstTarget),this.lastTarget=d(this.editor,e),this.targetTable=c(this.editor,this.lastTarget)},e.prototype.isAfter=function(e,t){var n,r,i,o;if(e&&t){if(t.contains(e)){var l=null===(r=(n=e).getBoundingClientRect)||void 0===r?void 0:r.call(n),s=null===(o=(i=t).getBoundingClientRect)||void 0===o?void 0:o.call(i);if(l&&s)return l.top>s.top&&l.bottom<s.bottom}return new a.Position(e,-1).isAfter(new a.Position(t,-1))}return!1},e.prototype.shouldConvertToTableSelection=function(){var e=this;if(!this.firstTable||!this.editor)return!1;var t=this.editor.getSelectedRegions();if(1==t.length)return!1;var n=!0;return t.forEach((function(t){(0,a.contains)(e.firstTable,t.rootNode)||(n=!1)})),n},e.prototype.selectTable=function(){var e;this.editor&&this.vTable&&(null===(e=this.editor)||void 0===e||e.select(this.vTable.table,(0,r.default)(this.vTable)))},e}();function u(e,t,n,r,i){r=r||t,i=i||n,e.getDocument().defaultView.getSelection().setBaseAndExtent(t,n,r,i)}function d(e,t){return e&&e.getElementAtCursor("td,th",t)||t}function c(e,t){return e?e.getElementAtCursor("table",t):null}t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(null==e?void 0:e.selection)||{},n=t.firstCell,r=t.lastCell;if(!(e&&e.selection&&n&&r))return null;var i=e.cells,o={x:Math.min(n.x,r.x),y:Math.min(n.y,r.y)},a={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},l=function(e){e.x<0&&(e.x=0),e.y<0&&(e.y=0),e.y>=i.length&&(e.y=i.length-1);var t=i[e.y].length;e.x>=t&&(e.x=t-1)};return l(o),l(a),{firstCell:o,lastCell:a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteTableContents=void 0;var r=n(0);t.DeleteTableContents={keys:[46,8],shouldHandleEvent:function(e,t){return 1==t.getSelectionRangeEx().type},handleEvent:function(e,t){1==t.getSelectionRangeEx().type&&t.addUndoSnapshot((function(){t.getSelectedRegions().forEach((function(e){(0,r.safeInstanceOf)(e.rootNode,"HTMLTableCellElement")&&function(e,t){var n=new Range;n.selectNodeContents(e),n.deleteContents(),e.appendChild(t.getDocument().createElement("br"))}(e.rootNode,t)}))}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellCoordinates=void 0,t.getCellCoordinates=function(e,t){var n;if(null==e?void 0:e.cells)for(var r=0;r<e.cells.length;r++)for(var i=0;i<e.cells[r].length;i++)t==e.cells[r][i].td&&(n={x:i,y:r});return n}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(331),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoFormat=void 0;var r=n(332);Object.defineProperty(t,"AutoFormat",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/[`!@#$%^&*()_+\=\[\]{};':"\\|,.<>\/?~]/,i=function(){function e(){this.editor=null,this.lastKeyTyped=null}return e.prototype.getName=function(){return"AutoFormat"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.lastKeyTyped=null},e.prototype.onPluginEvent=function(e){var t=this;if(this.editor&&(7!==e.eventType&&5!==e.eventType&&6!==e.eventType||(this.lastKeyTyped=""),1===e.eventType)){var n=e.rawEvent.key;if(n&&n.length>1&&(this.lastKeyTyped=""),"-"!==this.lastKeyTyped||r.test(n)||" "===n||"-"===n)this.lastKeyTyped=n;else{var i=this.editor.getContentSearcherOfCursor(e),o=null==i?void 0:i.getSubStringBefore(3),a=null==i?void 0:i.getSubStringBefore(2),l="-"===(null==o?void 0:o[0]),s=" "===(null==o?void 0:o[0]);if(l||s||"string"==typeof o&&r.test(o[0])||"--"!==a)return;var u=null==i?void 0:i.getRangeFromText(a,!0),d=document.createTextNode("");this.editor.addUndoSnapshot((function(){u&&(u.deleteContents(),u.insertNode(d),t.editor.select(d,-1))}),"Format",!0,{formatApiName:"autoHyphen"}),this.lastKeyTyped=null}}},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(120),t),i(n(121),t),i(n(334),t),i(n(122),t),i(n(123),t),i(n(124),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(336),t)},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(120),t),i(n(121),t),i(n(337),t),i(n(122),t),i(n(123),t),i(n(124),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleTableOperation=t.CompatibleTableBorderFormat=t.CompatibleSelectionRangeTypes=t.CompatibleRegionType=t.CompatibleQueryScope=t.CompatiblePositionType=t.CompatiblePluginEventType=t.CompatibleNumberingListType=t.CompatibleNodeType=t.CompatibleListType=t.CompatibleKnownCreateElementDataIndex=t.CompatibleKeys=t.CompatibleIndentation=t.CompatibleImageEditOperation=t.CompatibleGetContentMode=t.CompatibleFontSizeChange=t.CompatibleExperimentalFeatures=t.CompatibleEntityOperation=t.CompatibleEntityClasses=t.CompatibleDocumentPosition=t.CompatibleDocumentCommand=t.CompatibleDirection=t.CompatibleDelimiterClasses=t.CompatibleDefinitionType=t.CompatibleDarkModeDatasetNames=t.CompatibleContentType=t.CompatibleContentTypePrefix=t.CompatibleContentPosition=t.CompatibleColorTransformDirection=t.CompatibleClearFormatMode=t.CompatibleChangeSource=t.CompatibleCapitalization=t.CompatibleBulletListType=t.CompatibleAlignment=void 0;var r=n(338);Object.defineProperty(t,"CompatibleAlignment",{enumerable:!0,get:function(){return r.CompatibleAlignment}});var i=n(339);Object.defineProperty(t,"CompatibleBulletListType",{enumerable:!0,get:function(){return i.CompatibleBulletListType}});var o=n(340);Object.defineProperty(t,"CompatibleCapitalization",{enumerable:!0,get:function(){return o.CompatibleCapitalization}});var a=n(341);Object.defineProperty(t,"CompatibleChangeSource",{enumerable:!0,get:function(){return a.CompatibleChangeSource}});var l=n(342);Object.defineProperty(t,"CompatibleClearFormatMode",{enumerable:!0,get:function(){return l.CompatibleClearFormatMode}});var s=n(343);Object.defineProperty(t,"CompatibleColorTransformDirection",{enumerable:!0,get:function(){return s.CompatibleColorTransformDirection}});var u=n(344);Object.defineProperty(t,"CompatibleContentPosition",{enumerable:!0,get:function(){return u.CompatibleContentPosition}});var d=n(345);Object.defineProperty(t,"CompatibleContentTypePrefix",{enumerable:!0,get:function(){return d.CompatibleContentTypePrefix}}),Object.defineProperty(t,"CompatibleContentType",{enumerable:!0,get:function(){return d.CompatibleContentType}});var c=n(346);Object.defineProperty(t,"CompatibleDarkModeDatasetNames",{enumerable:!0,get:function(){return c.CompatibleDarkModeDatasetNames}});var f=n(347);Object.defineProperty(t,"CompatibleDefinitionType",{enumerable:!0,get:function(){return f.CompatibleDefinitionType}});var h=n(348);Object.defineProperty(t,"CompatibleDelimiterClasses",{enumerable:!0,get:function(){return h.CompatibleDelimiterClasses}});var p=n(349);Object.defineProperty(t,"CompatibleDirection",{enumerable:!0,get:function(){return p.CompatibleDirection}});var v=n(350);Object.defineProperty(t,"CompatibleDocumentCommand",{enumerable:!0,get:function(){return v.CompatibleDocumentCommand}});var g=n(351);Object.defineProperty(t,"CompatibleDocumentPosition",{enumerable:!0,get:function(){return g.CompatibleDocumentPosition}});var m=n(352);Object.defineProperty(t,"CompatibleEntityClasses",{enumerable:!0,get:function(){return m.CompatibleEntityClasses}});var y=n(353);Object.defineProperty(t,"CompatibleEntityOperation",{enumerable:!0,get:function(){return y.CompatibleEntityOperation}});var b=n(354);Object.defineProperty(t,"CompatibleExperimentalFeatures",{enumerable:!0,get:function(){return b.CompatibleExperimentalFeatures}});var C=n(355);Object.defineProperty(t,"CompatibleFontSizeChange",{enumerable:!0,get:function(){return C.CompatibleFontSizeChange}});var E=n(356);Object.defineProperty(t,"CompatibleGetContentMode",{enumerable:!0,get:function(){return E.CompatibleGetContentMode}});var S=n(357);Object.defineProperty(t,"CompatibleImageEditOperation",{enumerable:!0,get:function(){return S.CompatibleImageEditOperation}});var w=n(358);Object.defineProperty(t,"CompatibleIndentation",{enumerable:!0,get:function(){return w.CompatibleIndentation}});var T=n(359);Object.defineProperty(t,"CompatibleKeys",{enumerable:!0,get:function(){return T.CompatibleKeys}});var P=n(360);Object.defineProperty(t,"CompatibleKnownCreateElementDataIndex",{enumerable:!0,get:function(){return P.CompatibleKnownCreateElementDataIndex}});var O=n(361);Object.defineProperty(t,"CompatibleListType",{enumerable:!0,get:function(){return O.CompatibleListType}});var M=n(362);Object.defineProperty(t,"CompatibleNodeType",{enumerable:!0,get:function(){return M.CompatibleNodeType}});var _=n(363);Object.defineProperty(t,"CompatibleNumberingListType",{enumerable:!0,get:function(){return _.CompatibleNumberingListType}});var D=n(364);Object.defineProperty(t,"CompatiblePluginEventType",{enumerable:!0,get:function(){return D.CompatiblePluginEventType}});var N=n(365);Object.defineProperty(t,"CompatiblePositionType",{enumerable:!0,get:function(){return N.CompatiblePositionType}});var x=n(366);Object.defineProperty(t,"CompatibleQueryScope",{enumerable:!0,get:function(){return x.CompatibleQueryScope}});var k=n(367);Object.defineProperty(t,"CompatibleRegionType",{enumerable:!0,get:function(){return k.CompatibleRegionType}});var I=n(368);Object.defineProperty(t,"CompatibleSelectionRangeTypes",{enumerable:!0,get:function(){return I.CompatibleSelectionRangeTypes}});var R=n(369);Object.defineProperty(t,"CompatibleTableBorderFormat",{enumerable:!0,get:function(){return R.CompatibleTableBorderFormat}});var A=n(370);Object.defineProperty(t,"CompatibleTableOperation",{enumerable:!0,get:function(){return A.CompatibleTableOperation}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleAlignment=void 0,function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(t.CompatibleAlignment||(t.CompatibleAlignment={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleBulletListType=void 0,function(e){e[e.Min=1]="Min",e[e.Disc=1]="Disc",e[e.Dash=2]="Dash",e[e.Square=3]="Square",e[e.ShortArrow=4]="ShortArrow",e[e.LongArrow=5]="LongArrow",e[e.UnfilledArrow=6]="UnfilledArrow",e[e.Hyphen=7]="Hyphen",e[e.DoubleLongArrow=8]="DoubleLongArrow",e[e.Circle=9]="Circle",e[e.Max=9]="Max"}(t.CompatibleBulletListType||(t.CompatibleBulletListType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleCapitalization=void 0,function(e){e.Sentence="sentence",e.Lowercase="lowercase",e.Uppercase="uppercase",e.CapitalizeEachWord="capitalize"}(t.CompatibleCapitalization||(t.CompatibleCapitalization={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleChangeSource=void 0,function(e){e.AutoLink="AutoLink",e.CreateLink="CreateLink",e.Format="Format",e.ImageResize="ImageResize",e.Paste="Paste",e.SetContent="SetContent",e.Cut="Cut",e.Drop="Drop",e.InsertEntity="InsertEntity",e.SwitchToDarkMode="SwitchToDarkMode",e.SwitchToLightMode="SwitchToLightMode",e.ListChain="ListChain"}(t.CompatibleChangeSource||(t.CompatibleChangeSource={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleClearFormatMode=void 0,function(e){e[e.Inline=0]="Inline",e[e.Block=1]="Block",e[e.AutoDetect=2]="AutoDetect"}(t.CompatibleClearFormatMode||(t.CompatibleClearFormatMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleColorTransformDirection=void 0,function(e){e[e.LightToDark=0]="LightToDark",e[e.DarkToLight=1]="DarkToLight"}(t.CompatibleColorTransformDirection||(t.CompatibleColorTransformDirection={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleContentPosition=void 0,function(e){e[e.Begin=0]="Begin",e[e.End=1]="End",e[e.DomEnd=2]="DomEnd",e[e.SelectionStart=3]="SelectionStart",e[e.Outside=4]="Outside",e[e.Range=5]="Range"}(t.CompatibleContentPosition||(t.CompatibleContentPosition={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleContentType=t.CompatibleContentTypePrefix=void 0,function(e){e.Text="text/",e.Image="image/"}(t.CompatibleContentTypePrefix||(t.CompatibleContentTypePrefix={})),function(e){e.PlainText="text/plain",e.HTML="text/html"}(t.CompatibleContentType||(t.CompatibleContentType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDarkModeDatasetNames=void 0,function(e){e.OriginalStyleColor="ogsc",e.OriginalStyleBackgroundColor="ogsb",e.OriginalAttributeColor="ogac",e.OriginalAttributeBackgroundColor="ogab"}(t.CompatibleDarkModeDatasetNames||(t.CompatibleDarkModeDatasetNames={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDefinitionType=void 0,function(e){e[e.Boolean=0]="Boolean",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Array=3]="Array",e[e.Object=4]="Object",e[e.Customize=5]="Customize"}(t.CompatibleDefinitionType||(t.CompatibleDefinitionType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDelimiterClasses=void 0,function(e){e.DELIMITER_BEFORE="entityDelimiterBefore",e.DELIMITER_AFTER="entityDelimiterAfter"}(t.CompatibleDelimiterClasses||(t.CompatibleDelimiterClasses={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDirection=void 0,function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft"}(t.CompatibleDirection||(t.CompatibleDirection={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDocumentCommand=void 0,function(e){e.AutoUrlDetect="AutoUrlDetect",e.BackColor="backColor",e.Bold="bold",e.ClearAuthenticationCache="ClearAuthenticationCache",e.ContentReadOnly="contentReadOnly",e.Copy="copy",e.CreateLink="createLink",e.Cut="cut",e.DecreaseFontSize="decreaseFontSize",e.DefaultParagraphSeparator="defaultParagraphSeparator",e.Delete="delete",e.EnableInlineTableEditing="enableInlineTableEditing",e.EnableObjectResizing="enableObjectResizing",e.FontName="fontName",e.FontSize="fontSize",e.ForeColor="foreColor",e.FormatBlock="formatBlock",e.ForwardDelete="forwardDelete",e.Heading="heading",e.HiliteColor="hiliteColor",e.IncreaseFontSize="increaseFontSize",e.Indent="indent",e.InsertBrOnReturn="insertBrOnReturn",e.InsertHorizontalRule="insertHorizontalRule",e.InsertHTML="insertHTML",e.InsertImage="insertImage",e.InsertOrderedList="insertOrderedList",e.InsertUnorderedList="insertUnorderedList",e.InsertParagraph="insertParagraph",e.InsertText="insertText",e.Italic="italic",e.JustifyCenter="justifyCenter",e.JustifyFull="justifyFull",e.JustifyLeft="justifyLeft",e.JustifyRight="justifyRight",e.Outdent="outdent",e.Paste="paste",e.Redo="redo",e.RemoveFormat="removeFormat",e.SelectAll="selectAll",e.StrikeThrough="strikeThrough",e.Subscript="subscript",e.Superscript="superscript",e.Underline="underline",e.Undo="undo",e.Unlink="unlink",e.StyleWithCSS="styleWithCSS"}(t.CompatibleDocumentCommand||(t.CompatibleDocumentCommand={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDocumentPosition=void 0,function(e){e[e.Same=0]="Same",e[e.Disconnected=1]="Disconnected",e[e.Preceding=2]="Preceding",e[e.Following=4]="Following",e[e.Contains=8]="Contains",e[e.ContainedBy=16]="ContainedBy"}(t.CompatibleDocumentPosition||(t.CompatibleDocumentPosition={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleEntityClasses=void 0,function(e){e.ENTITY_INFO_NAME="_Entity",e.ENTITY_TYPE_PREFIX="_EType_",e.ENTITY_ID_PREFIX="_EId_",e.ENTITY_READONLY_PREFIX="_EReadonly_"}(t.CompatibleEntityClasses||(t.CompatibleEntityClasses={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleEntityOperation=void 0,function(e){e[e.NewEntity=0]="NewEntity",e[e.Click=1]="Click",e[e.ContextMenu=2]="ContextMenu",e[e.Escape=3]="Escape",e[e.RemoveFromStart=4]="RemoveFromStart",e[e.RemoveFromEnd=5]="RemoveFromEnd",e[e.Overwrite=6]="Overwrite",e[e.PartialOverwrite=7]="PartialOverwrite",e[e.ReplaceTemporaryContent=8]="ReplaceTemporaryContent",e[e.AddShadowRoot=9]="AddShadowRoot",e[e.RemoveShadowRoot=10]="RemoveShadowRoot"}(t.CompatibleEntityOperation||(t.CompatibleEntityOperation={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleExperimentalFeatures=void 0,function(e){e.NewIndentation="NewIndentation",e.NewBullet="NewBullet",e.NewNumbering="NewNumbering",e.ListChain="ListChain",e.MergePastedLine="MergePastedLine",e.SingleDirectionResize="SingleDirectionResize",e.PasteWithLinkPreview="PasteWithLinkPreview",e.ImageRotate="ImageRotate",e.ImageCrop="ImageCrop",e.AlwaysApplyDefaultFormat="AlwaysApplyDefaultFormat",e.ConvertSingleImageBody="ConvertSingleImageBody",e.TableAlignment="TableAlignment",e.AdaptiveHandlesResizer="AdaptiveHandlesResizer",e.AutoHyphen="AutoHyphen",e.PendingStyleBasedFormat="PendingStyleBasedFormat",e.NormalizeList="NormalizeList",e.ImageSelection="ImageSelection",e.TabKeyTextFeatures="TabKeyTextFeatures",e.ListItemAlignment="ListItemAlignment",e.AutoFormatList="AutoFormatList",e.ReuseAllAncestorListElements="ReuseAllAncestorListElements",e.DefaultFormatInSpan="DefaultFormatInSpan",e.VariableBasedDarkColor="VariableBasedDarkColor",e.ReusableContentModel="ReusableContentModel",e.DeleteTableWithBackspace="DeleteTableWithBackspace",e.InlineEntityReadOnlyDelimiters="InlineEntityReadOnlyDelimiters"}(t.CompatibleExperimentalFeatures||(t.CompatibleExperimentalFeatures={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleFontSizeChange=void 0,function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(t.CompatibleFontSizeChange||(t.CompatibleFontSizeChange={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleGetContentMode=void 0,function(e){e[e.CleanHTML=0]="CleanHTML",e[e.RawHTMLOnly=1]="RawHTMLOnly",e[e.RawHTMLWithSelection=2]="RawHTMLWithSelection",e[e.PlainText=3]="PlainText",e[e.PlainTextFast=4]="PlainTextFast"}(t.CompatibleGetContentMode||(t.CompatibleGetContentMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleImageEditOperation=void 0,function(e){e[e.None=0]="None",e[e.CornerResize=1]="CornerResize",e[e.SideResize=2]="SideResize",e[e.Resize=3]="Resize",e[e.Rotate=4]="Rotate",e[e.ResizeAndRotate=7]="ResizeAndRotate",e[e.Crop=8]="Crop",e[e.All=15]="All"}(t.CompatibleImageEditOperation||(t.CompatibleImageEditOperation={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleIndentation=void 0,function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(t.CompatibleIndentation||(t.CompatibleIndentation={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleKeys=void 0,function(e){e[e.NULL=0]="NULL",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL_LEFT=17]="CTRL_LEFT",e[e.ALT=18]="ALT",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGEUP=33]="PAGEUP",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.DELETE=46]="DELETE",e[e.EIGHT_ASTIRISK=56]="EIGHT_ASTIRISK",e[e.EIGHT_ASTERISK=56]="EIGHT_ASTERISK",e[e.B=66]="B",e[e.I=73]="I",e[e.U=85]="U",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META_LEFT=91]="META_LEFT",e[e.COMMA=188]="COMMA",e[e.DASH_UNDERSCORE=189]="DASH_UNDERSCORE",e[e.PERIOD=190]="PERIOD",e[e.FORWARDSLASH=191]="FORWARDSLASH",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.GRAVE_TILDE=192]="GRAVE_TILDE",e[e.CONTENTCHANGED=257]="CONTENTCHANGED",e[e.RANGE=258]="RANGE",e[e.Ctrl=4096]="Ctrl",e[e.Meta=8192]="Meta",e[e.Shift=16384]="Shift"}(t.CompatibleKeys||(t.CompatibleKeys={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleKnownCreateElementDataIndex=void 0,function(e){e[e.None=0]="None",e[e.EmptyLine=1]="EmptyLine",e[e.BlockquoteWrapper=2]="BlockquoteWrapper",e[e.CopyPasteTempDiv=3]="CopyPasteTempDiv",e[e.BlockListItem=4]="BlockListItem",e[e.ContextMenuWrapper=5]="ContextMenuWrapper",e[e.ImageEditWrapper=6]="ImageEditWrapper",e[e.TableHorizontalResizer=7]="TableHorizontalResizer",e[e.TableVerticalResizer=8]="TableVerticalResizer",e[e.TableResizerLTR=9]="TableResizerLTR",e[e.TableResizerRTL=10]="TableResizerRTL",e[e.TableSelector=11]="TableSelector",e[e.EmptyLineFormatInSpan=12]="EmptyLineFormatInSpan"}(t.CompatibleKnownCreateElementDataIndex||(t.CompatibleKnownCreateElementDataIndex={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleListType=void 0,function(e){e[e.None=0]="None",e[e.Ordered=1]="Ordered",e[e.Unordered=2]="Unordered"}(t.CompatibleListType||(t.CompatibleListType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleNodeType=void 0,function(e){e[e.Element=1]="Element",e[e.Attribute=2]="Attribute",e[e.Text=3]="Text",e[e.ProcessingInstruction=7]="ProcessingInstruction",e[e.Comment=8]="Comment",e[e.Document=9]="Document",e[e.DocumentType=10]="DocumentType",e[e.DocumentFragment=11]="DocumentFragment"}(t.CompatibleNodeType||(t.CompatibleNodeType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleNumberingListType=void 0,function(e){e[e.Min=1]="Min",e[e.Decimal=1]="Decimal",e[e.DecimalDash=2]="DecimalDash",e[e.DecimalParenthesis=3]="DecimalParenthesis",e[e.DecimalDoubleParenthesis=4]="DecimalDoubleParenthesis",e[e.LowerAlpha=5]="LowerAlpha",e[e.LowerAlphaParenthesis=6]="LowerAlphaParenthesis",e[e.LowerAlphaDoubleParenthesis=7]="LowerAlphaDoubleParenthesis",e[e.LowerAlphaDash=8]="LowerAlphaDash",e[e.UpperAlpha=9]="UpperAlpha",e[e.UpperAlphaParenthesis=10]="UpperAlphaParenthesis",e[e.UpperAlphaDoubleParenthesis=11]="UpperAlphaDoubleParenthesis",e[e.UpperAlphaDash=12]="UpperAlphaDash",e[e.LowerRoman=13]="LowerRoman",e[e.LowerRomanParenthesis=14]="LowerRomanParenthesis",e[e.LowerRomanDoubleParenthesis=15]="LowerRomanDoubleParenthesis",e[e.LowerRomanDash=16]="LowerRomanDash",e[e.UpperRoman=17]="UpperRoman",e[e.UpperRomanParenthesis=18]="UpperRomanParenthesis",e[e.UpperRomanDoubleParenthesis=19]="UpperRomanDoubleParenthesis",e[e.UpperRomanDash=20]="UpperRomanDash",e[e.Max=20]="Max"}(t.CompatibleNumberingListType||(t.CompatibleNumberingListType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatiblePluginEventType=void 0,function(e){e[e.KeyDown=0]="KeyDown",e[e.KeyPress=1]="KeyPress",e[e.KeyUp=2]="KeyUp",e[e.Input=3]="Input",e[e.CompositionEnd=4]="CompositionEnd",e[e.MouseDown=5]="MouseDown",e[e.MouseUp=6]="MouseUp",e[e.ContentChanged=7]="ContentChanged",e[e.ExtractContentWithDom=8]="ExtractContentWithDom",e[e.BeforeCutCopy=9]="BeforeCutCopy",e[e.BeforePaste=10]="BeforePaste",e[e.EditorReady=11]="EditorReady",e[e.BeforeDispose=12]="BeforeDispose",e[e.PendingFormatStateChanged=13]="PendingFormatStateChanged",e[e.Scroll=14]="Scroll",e[e.EntityOperation=15]="EntityOperation",e[e.ContextMenu=16]="ContextMenu",e[e.EnteredShadowEdit=17]="EnteredShadowEdit",e[e.LeavingShadowEdit=18]="LeavingShadowEdit",e[e.EditImage=19]="EditImage",e[e.BeforeSetContent=20]="BeforeSetContent",e[e.ZoomChanged=21]="ZoomChanged",e[e.SelectionChanged=22]="SelectionChanged"}(t.CompatiblePluginEventType||(t.CompatiblePluginEventType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatiblePositionType=void 0,function(e){e[e.Begin=0]="Begin",e[e.End=-1]="End",e[e.Before=-2]="Before",e[e.After=-3]="After"}(t.CompatiblePositionType||(t.CompatiblePositionType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleQueryScope=void 0,function(e){e[e.Body=0]="Body",e[e.OnSelection=1]="OnSelection",e[e.InSelection=2]="InSelection"}(t.CompatibleQueryScope||(t.CompatibleQueryScope={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleRegionType=void 0,function(e){e[e.Table=0]="Table"}(t.CompatibleRegionType||(t.CompatibleRegionType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleSelectionRangeTypes=void 0,function(e){e[e.Normal=0]="Normal",e[e.TableSelection=1]="TableSelection",e[e.ImageSelection=2]="ImageSelection"}(t.CompatibleSelectionRangeTypes||(t.CompatibleSelectionRangeTypes={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleTableBorderFormat=void 0,function(e){e[e.DEFAULT=0]="DEFAULT",e[e.LIST_WITH_SIDE_BORDERS=1]="LIST_WITH_SIDE_BORDERS",e[e.NO_HEADER_BORDERS=2]="NO_HEADER_BORDERS",e[e.NO_SIDE_BORDERS=3]="NO_SIDE_BORDERS",e[e.FIRST_COLUMN_HEADER_EXTERNAL=4]="FIRST_COLUMN_HEADER_EXTERNAL",e[e.ESPECIAL_TYPE_1=5]="ESPECIAL_TYPE_1",e[e.ESPECIAL_TYPE_2=6]="ESPECIAL_TYPE_2",e[e.ESPECIAL_TYPE_3=7]="ESPECIAL_TYPE_3",e[e.CLEAR=8]="CLEAR"}(t.CompatibleTableBorderFormat||(t.CompatibleTableBorderFormat={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleTableOperation=void 0,function(e){e[e.InsertAbove=0]="InsertAbove",e[e.InsertBelow=1]="InsertBelow",e[e.InsertLeft=2]="InsertLeft",e[e.InsertRight=3]="InsertRight",e[e.DeleteTable=4]="DeleteTable",e[e.DeleteColumn=5]="DeleteColumn",e[e.DeleteRow=6]="DeleteRow",e[e.MergeAbove=7]="MergeAbove",e[e.MergeBelow=8]="MergeBelow",e[e.MergeLeft=9]="MergeLeft",e[e.MergeRight=10]="MergeRight",e[e.MergeCells=11]="MergeCells",e[e.SplitHorizontally=12]="SplitHorizontally",e[e.SplitVertically=13]="SplitVertically",e[e.AlignCenter=14]="AlignCenter",e[e.AlignLeft=15]="AlignLeft",e[e.AlignRight=16]="AlignRight",e[e.AlignCellLeft=17]="AlignCellLeft",e[e.AlignCellCenter=18]="AlignCellCenter",e[e.AlignCellRight=19]="AlignCellRight",e[e.AlignCellTop=20]="AlignCellTop",e[e.AlignCellMiddle=21]="AlignCellMiddle",e[e.AlignCellBottom=22]="AlignCellBottom"}(t.CompatibleTableOperation||(t.CompatibleTableOperation={}))}]);
//# sourceMappingURL=rooster-min.js.map