var roosterjs;(()=>{var e={8168:(e,t,r)=>{var n=r(8874),o={};for(var a in n)n.hasOwnProperty(a)&&(o[n[a]]=a);var i=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var l in i)if(i.hasOwnProperty(l)){if(!("channels"in i[l]))throw new Error("missing channels property: "+l);if(!("labels"in i[l]))throw new Error("missing channel labels property: "+l);if(i[l].labels.length!==i[l].channels)throw new Error("channel and label counts mismatch: "+l);var s=i[l].channels,c=i[l].labels;delete i[l].channels,delete i[l].labels,Object.defineProperty(i[l],"channels",{value:s}),Object.defineProperty(i[l],"labels",{value:c})}i.rgb.hsl=function(e){var t,r,n=e[0]/255,o=e[1]/255,a=e[2]/255,i=Math.min(n,o,a),l=Math.max(n,o,a),s=l-i;return l===i?t=0:n===l?t=(o-a)/s:o===l?t=2+(a-n)/s:a===l&&(t=4+(n-o)/s),(t=Math.min(60*t,360))<0&&(t+=360),r=(i+l)/2,[t,100*(l===i?0:r<=.5?s/(l+i):s/(2-l-i)),100*r]},i.rgb.hsv=function(e){var t,r,n,o,a,i=e[0]/255,l=e[1]/255,s=e[2]/255,c=Math.max(i,l,s),u=c-Math.min(i,l,s),d=function(e){return(c-e)/6/u+.5};return 0===u?o=a=0:(a=u/c,t=d(i),r=d(l),n=d(s),i===c?o=n-r:l===c?o=1/3+t-n:s===c&&(o=2/3+r-t),o<0?o+=1:o>1&&(o-=1)),[360*o,100*a,100*c]},i.rgb.hwb=function(e){var t=e[0],r=e[1],n=e[2];return[i.rgb.hsl(e)[0],1/255*Math.min(t,Math.min(r,n))*100,100*(n=1-1/255*Math.max(t,Math.max(r,n)))]},i.rgb.cmyk=function(e){var t,r=e[0]/255,n=e[1]/255,o=e[2]/255;return[100*((1-r-(t=Math.min(1-r,1-n,1-o)))/(1-t)||0),100*((1-n-t)/(1-t)||0),100*((1-o-t)/(1-t)||0),100*t]},i.rgb.keyword=function(e){var t=o[e];if(t)return t;var r,a,i,l=1/0;for(var s in n)if(n.hasOwnProperty(s)){var c=(a=e,i=n[s],Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2)+Math.pow(a[2]-i[2],2));c<l&&(l=c,r=s)}return r},i.keyword.rgb=function(e){return n[e]},i.rgb.xyz=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*t+.7152*r+.0722*n),100*(.0193*t+.1192*r+.9505*n)]},i.rgb.lab=function(e){var t=i.rgb.xyz(e),r=t[0],n=t[1],o=t[2];return n/=100,o/=108.883,r=(r/=95.047)>.008856?Math.pow(r,1/3):7.787*r+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(r-n),200*(n-(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116))]},i.hsl.rgb=function(e){var t,r,n,o,a,i=e[0]/360,l=e[1]/100,s=e[2]/100;if(0===l)return[a=255*s,a,a];t=2*s-(r=s<.5?s*(1+l):s+l-s*l),o=[0,0,0];for(var c=0;c<3;c++)(n=i+1/3*-(c-1))<0&&n++,n>1&&n--,a=6*n<1?t+6*(r-t)*n:2*n<1?r:3*n<2?t+(r-t)*(2/3-n)*6:t,o[c]=255*a;return o},i.hsl.hsv=function(e){var t=e[0],r=e[1]/100,n=e[2]/100,o=r,a=Math.max(n,.01);return r*=(n*=2)<=1?n:2-n,o*=a<=1?a:2-a,[t,100*(0===n?2*o/(a+o):2*r/(n+r)),(n+r)/2*100]},i.hsv.rgb=function(e){var t=e[0]/60,r=e[1]/100,n=e[2]/100,o=Math.floor(t)%6,a=t-Math.floor(t),i=255*n*(1-r),l=255*n*(1-r*a),s=255*n*(1-r*(1-a));switch(n*=255,o){case 0:return[n,s,i];case 1:return[l,n,i];case 2:return[i,n,s];case 3:return[i,l,n];case 4:return[s,i,n];case 5:return[n,i,l]}},i.hsv.hsl=function(e){var t,r,n,o=e[0],a=e[1]/100,i=e[2]/100,l=Math.max(i,.01);return n=(2-a)*i,r=a*l,[o,100*(r=(r/=(t=(2-a)*l)<=1?t:2-t)||0),100*(n/=2)]},i.hwb.rgb=function(e){var t,r,n,o,a,i,l,s=e[0]/360,c=e[1]/100,u=e[2]/100,d=c+u;switch(d>1&&(c/=d,u/=d),n=6*s-(t=Math.floor(6*s)),0!=(1&t)&&(n=1-n),o=c+n*((r=1-u)-c),t){default:case 6:case 0:a=r,i=o,l=c;break;case 1:a=o,i=r,l=c;break;case 2:a=c,i=r,l=o;break;case 3:a=c,i=o,l=r;break;case 4:a=o,i=c,l=r;break;case 5:a=r,i=c,l=o}return[255*a,255*i,255*l]},i.cmyk.rgb=function(e){var t=e[0]/100,r=e[1]/100,n=e[2]/100,o=e[3]/100;return[255*(1-Math.min(1,t*(1-o)+o)),255*(1-Math.min(1,r*(1-o)+o)),255*(1-Math.min(1,n*(1-o)+o))]},i.xyz.rgb=function(e){var t,r,n,o=e[0]/100,a=e[1]/100,i=e[2]/100;return r=-.9689*o+1.8758*a+.0415*i,n=.0557*o+-.204*a+1.057*i,t=(t=3.2406*o+-1.5372*a+-.4986*i)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,[255*(t=Math.min(Math.max(0,t),1)),255*(r=Math.min(Math.max(0,r),1)),255*(n=Math.min(Math.max(0,n),1))]},i.xyz.lab=function(e){var t=e[0],r=e[1],n=e[2];return r/=100,n/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(t-r),200*(r-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]},i.lab.xyz=function(e){var t,r,n,o=e[0];t=e[1]/500+(r=(o+16)/116),n=r-e[2]/200;var a=Math.pow(r,3),i=Math.pow(t,3),l=Math.pow(n,3);return r=a>.008856?a:(r-16/116)/7.787,t=i>.008856?i:(t-16/116)/7.787,n=l>.008856?l:(n-16/116)/7.787,[t*=95.047,r*=100,n*=108.883]},i.lab.lch=function(e){var t,r=e[0],n=e[1],o=e[2];return(t=360*Math.atan2(o,n)/2/Math.PI)<0&&(t+=360),[r,Math.sqrt(n*n+o*o),t]},i.lch.lab=function(e){var t,r=e[0],n=e[1];return t=e[2]/360*2*Math.PI,[r,n*Math.cos(t),n*Math.sin(t)]},i.rgb.ansi16=function(e){var t=e[0],r=e[1],n=e[2],o=1 in arguments?arguments[1]:i.rgb.hsv(e)[2];if(0===(o=Math.round(o/50)))return 30;var a=30+(Math.round(n/255)<<2|Math.round(r/255)<<1|Math.round(t/255));return 2===o&&(a+=60),a},i.hsv.ansi16=function(e){return i.rgb.ansi16(i.hsv.rgb(e),e[2])},i.rgb.ansi256=function(e){var t=e[0],r=e[1],n=e[2];return t===r&&r===n?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5)},i.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var r=.5*(1+~~(e>50));return[(1&t)*r*255,(t>>1&1)*r*255,(t>>2&1)*r*255]},i.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var r;return e-=16,[Math.floor(e/36)/5*255,Math.floor((r=e%36)/6)/5*255,r%6/5*255]},i.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},i.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var r=t[0];3===t[0].length&&(r=r.split("").map((function(e){return e+e})).join(""));var n=parseInt(r,16);return[n>>16&255,n>>8&255,255&n]},i.rgb.hcg=function(e){var t,r=e[0]/255,n=e[1]/255,o=e[2]/255,a=Math.max(Math.max(r,n),o),i=Math.min(Math.min(r,n),o),l=a-i;return t=l<=0?0:a===r?(n-o)/l%6:a===n?2+(o-r)/l:4+(r-n)/l+4,t/=6,[360*(t%=1),100*l,100*(l<1?i/(1-l):0)]},i.hsl.hcg=function(e){var t,r=e[1]/100,n=e[2]/100,o=0;return(t=n<.5?2*r*n:2*r*(1-n))<1&&(o=(n-.5*t)/(1-t)),[e[0],100*t,100*o]},i.hsv.hcg=function(e){var t=e[1]/100,r=e[2]/100,n=t*r,o=0;return n<1&&(o=(r-n)/(1-n)),[e[0],100*n,100*o]},i.hcg.rgb=function(e){var t=e[0]/360,r=e[1]/100,n=e[2]/100;if(0===r)return[255*n,255*n,255*n];var o,a=[0,0,0],i=t%1*6,l=i%1,s=1-l;switch(Math.floor(i)){case 0:a[0]=1,a[1]=l,a[2]=0;break;case 1:a[0]=s,a[1]=1,a[2]=0;break;case 2:a[0]=0,a[1]=1,a[2]=l;break;case 3:a[0]=0,a[1]=s,a[2]=1;break;case 4:a[0]=l,a[1]=0,a[2]=1;break;default:a[0]=1,a[1]=0,a[2]=s}return o=(1-r)*n,[255*(r*a[0]+o),255*(r*a[1]+o),255*(r*a[2]+o)]},i.hcg.hsv=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t),n=0;return r>0&&(n=t/r),[e[0],100*n,100*r]},i.hcg.hsl=function(e){var t=e[1]/100,r=e[2]/100*(1-t)+.5*t,n=0;return r>0&&r<.5?n=t/(2*r):r>=.5&&r<1&&(n=t/(2*(1-r))),[e[0],100*n,100*r]},i.hcg.hwb=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t);return[e[0],100*(r-t),100*(1-r)]},i.hwb.hcg=function(e){var t=e[1]/100,r=1-e[2]/100,n=r-t,o=0;return n<1&&(o=(r-n)/(1-n)),[e[0],100*n,100*o]},i.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},i.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},i.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},i.gray.hsl=i.gray.hsv=function(e){return[0,0,e[0]]},i.gray.hwb=function(e){return[0,100,e[0]]},i.gray.cmyk=function(e){return[0,0,0,e[0]]},i.gray.lab=function(e){return[e[0],0,0]},i.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),r=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(r.length)+r},i.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},2085:(e,t,r)=>{var n=r(8168),o=r(4111),a={};Object.keys(n).forEach((function(e){a[e]={},Object.defineProperty(a[e],"channels",{value:n[e].channels}),Object.defineProperty(a[e],"labels",{value:n[e].labels});var t=o(e);Object.keys(t).forEach((function(r){var n=t[r];a[e][r]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var r=e(t);if("object"==typeof r)for(var n=r.length,o=0;o<n;o++)r[o]=Math.round(r[o]);return r};return"conversion"in e&&(t.conversion=e.conversion),t}(n),a[e][r].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(n)}))})),e.exports=a},4111:(e,t,r)=>{var n=r(8168);function o(e,t){return function(r){return t(e(r))}}function a(e,t){for(var r=[t[e].parent,e],a=n[t[e].parent][e],i=t[e].parent;t[i].parent;)r.unshift(t[i].parent),a=o(n[t[i].parent][i],a),i=t[i].parent;return a.conversion=r,a}e.exports=function(e){for(var t=function(e){var t=function(){for(var e={},t=Object.keys(n),r=t.length,o=0;o<r;o++)e[t[o]]={distance:-1,parent:null};return e}(),r=[e];for(t[e].distance=0;r.length;)for(var o=r.pop(),a=Object.keys(n[o]),i=a.length,l=0;l<i;l++){var s=a[l],c=t[s];-1===c.distance&&(c.distance=t[o].distance+1,c.parent=o,r.unshift(s))}return t}(e),r={},o=Object.keys(t),i=o.length,l=0;l<i;l++){var s=o[l];null!==t[s].parent&&(r[s]=a(s,t))}return r}},8874:e=>{"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},9818:(e,t,r)=>{var n=r(8874),o=r(6851),a={};for(var i in n)n.hasOwnProperty(i)&&(a[n[i]]=i);var l=e.exports={to:{},get:{}};function s(e,t,r){return Math.min(Math.max(t,e),r)}function c(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}l.get=function(e){var t,r;switch(e.substring(0,3).toLowerCase()){case"hsl":t=l.get.hsl(e),r="hsl";break;case"hwb":t=l.get.hwb(e),r="hwb";break;default:t=l.get.rgb(e),r="rgb"}return t?{model:r,value:t}:null},l.get.rgb=function(e){if(!e)return null;var t,r,o,a=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(o=t[2],t=t[1],r=0;r<3;r++){var i=2*r;a[r]=parseInt(t.slice(i,i+2),16)}o&&(a[3]=parseInt(o,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(o=(t=t[1])[3],r=0;r<3;r++)a[r]=parseInt(t[r]+t[r],16);o&&(a[3]=parseInt(o+o,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(r=0;r<3;r++)a[r]=parseInt(t[r+1],0);t[4]&&(a[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(a=n[t[1]])?(a[3]=1,a):null:null;for(r=0;r<3;r++)a[r]=Math.round(2.55*parseFloat(t[r+1]));t[4]&&(a[3]=parseFloat(t[4]))}for(r=0;r<3;r++)a[r]=s(a[r],0,255);return a[3]=s(a[3],0,1),a},l.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var r=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,s(parseFloat(t[2]),0,100),s(parseFloat(t[3]),0,100),s(isNaN(r)?1:r,0,1)]}return null},l.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var r=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,s(parseFloat(t[2]),0,100),s(parseFloat(t[3]),0,100),s(isNaN(r)?1:r,0,1)]}return null},l.to.hex=function(){var e=o(arguments);return"#"+c(e[0])+c(e[1])+c(e[2])+(e[3]<1?c(Math.round(255*e[3])):"")},l.to.rgb=function(){var e=o(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},l.to.rgb.percent=function(){var e=o(arguments),t=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),n=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+r+"%, "+n+"%)":"rgba("+t+"%, "+r+"%, "+n+"%, "+e[3]+")"},l.to.hsl=function(){var e=o(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},l.to.hwb=function(){var e=o(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},l.to.keyword=function(e){return a[e.slice(0,3)]}},6767:(e,t,r)=>{"use strict";var n=r(9818),o=r(2085),a=[].slice,i=["keyword","gray","hex"],l={};Object.keys(o).forEach((function(e){l[a.call(o[e].labels).sort().join("")]=e}));var s={};function c(e,t){if(!(this instanceof c))return new c(e,t);if(t&&t in i&&(t=null),t&&!(t in o))throw new Error("Unknown model: "+t);var r,u;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof c)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var d=n.get(e);if(null===d)throw new Error("Unable to parse color from string: "+e);this.model=d.model,u=o[this.model].channels,this.color=d.value.slice(0,u),this.valpha="number"==typeof d.value[u]?d.value[u]:1}else if(e.length){this.model=t||"rgb",u=o[this.model].channels;var p=a.call(e,0,u);this.color=f(p,u),this.valpha="number"==typeof e[u]?e[u]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var m=Object.keys(e);"alpha"in e&&(m.splice(m.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var h=m.sort().join("");if(!(h in l))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=l[h];var g=o[this.model].labels,v=[];for(r=0;r<g.length;r++)v.push(e[g[r]]);this.color=f(v)}if(s[this.model])for(u=o[this.model].channels,r=0;r<u;r++){var b=s[this.model][r];b&&(this.color[r]=b(this.color[r]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function u(e,t,r){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(s[e]||(s[e]=[]))[t]=r})),e=e[0],function(n){var o;return arguments.length?(r&&(n=r(n)),(o=this[e]()).color[t]=n,o):(o=this[e]().color[t],r&&(o=r(o)),o)}}function d(e){return function(t){return Math.max(0,Math.min(e,t))}}function f(e,t){for(var r=0;r<t;r++)"number"!=typeof e[r]&&(e[r]=0);return e}c.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in n.to?this:this.rgb(),r=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return n.to[t.model](r)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),r=1===t.valpha?t.color:t.color.concat(this.valpha);return n.to.rgb.percent(r)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=o[this.model].channels,r=o[this.model].labels,n=0;n<t;n++)e[r[n]]=this.color[n];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new c(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new c(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:u("rgb",0,d(255)),green:u("rgb",1,d(255)),blue:u("rgb",2,d(255)),hue:u(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:u("hsl",1,d(100)),lightness:u("hsl",2,d(100)),saturationv:u("hsv",1,d(100)),value:u("hsv",2,d(100)),chroma:u("hcg",1,d(100)),gray:u("hcg",2,d(100)),white:u("hwb",1,d(100)),wblack:u("hwb",2,d(100)),cyan:u("cmyk",0,d(100)),magenta:u("cmyk",1,d(100)),yellow:u("cmyk",2,d(100)),black:u("cmyk",3,d(100)),x:u("xyz",0,d(100)),y:u("xyz",1,d(100)),z:u("xyz",2,d(100)),l:u("lab",0,d(100)),a:u("lab",1),b:u("lab",2),keyword:function(e){return arguments.length?new c(e):o[this.model].keyword(this.color)},hex:function(e){return arguments.length?new c(e):n.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],r=0;r<e.length;r++){var n=e[r]/255;t[r]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),r=e.luminosity();return t>r?(t+.05)/(r+.05):(r+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return c.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),r=t.color[0];return r=(r=(r+e)%360)<0?360+r:r,t.color[0]=r,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var r=e.rgb(),n=this.rgb(),o=void 0===t?.5:t,a=2*o-1,i=r.alpha()-n.alpha(),l=((a*i==-1?a:(a+i)/(1+a*i))+1)/2,s=1-l;return c.rgb(l*r.red()+s*n.red(),l*r.green()+s*n.green(),l*r.blue()+s*n.blue(),r.alpha()*o+n.alpha()*(1-o))}},Object.keys(o).forEach((function(e){if(-1===i.indexOf(e)){var t=o[e].channels;c.prototype[e]=function(){if(this.model===e)return new c(this);if(arguments.length)return new c(arguments,e);var r,n="number"==typeof arguments[t]?t:this.valpha;return new c((r=o[this.model][e].raw(this.color),Array.isArray(r)?r:[r]).concat(n),e)},c[e]=function(r){return"number"==typeof r&&(r=f(a.call(arguments),t)),new c(r,e)}}})),e.exports=c},5171:e=>{e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},6851:(e,t,r)=>{"use strict";var n=r(5171),o=Array.prototype.concat,a=Array.prototype.slice,i=e.exports=function(e){for(var t=[],r=0,i=e.length;r<i;r++){var l=e[r];n(l)?t=o.call(t,a.call(l)):t.push(l)}return t};i.wrap=function(e){return function(){return e(i(arguments))}}},1660:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkColor=void 0;var n=r(6134);Object.defineProperty(t,"getDarkColor",{enumerable:!0,get:function(){return n.default}})},6134:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6767);t.default=function(e,t){void 0===t&&(t=21.247);try{var r=n(e||void 0),o=r.lab().array(),a=(100-o[0])*((100-t)/100)+t;e=n.lab(a,o[1],o[2]).rgb().alpha(r.alpha()).toString()}catch(e){}return e}},8745:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatTextSegmentBeforeSelectionMarker=t.formatSegmentWithContentModel=t.formatParagraphWithContentModel=t.formatImageWithContentModel=t.formatTableWithContentModel=t.clearSelectedCells=t.insertTableColumn=t.insertTableRow=t.insertEntity=t.toggleCode=t.setParagraphMargin=t.adjustImageSelection=t.setImageAltText=t.adjustLinkSelection=t.removeLink=t.insertLink=t.clearFormat=t.getFormatState=t.changeImage=t.setImageBoxShadow=t.setImageBorder=t.setSpacing=t.toggleBlockQuote=t.setHeadingLevel=t.setDirection=t.setAlignment=t.setIndentation=t.setListStartNumber=t.setListStyle=t.insertImage=t.changeCapitalization=t.applySegmentFormat=t.changeFontSize=t.setTextColor=t.setFontSize=t.setFontName=t.setBackgroundColor=t.toggleSuperscript=t.toggleSubscript=t.toggleStrikethrough=t.toggleUnderline=t.toggleItalic=t.toggleBold=t.toggleNumbering=t.toggleBullet=t.applyTableBorderFormat=t.editTable=t.setTableCellShade=t.formatTable=t.insertTable=void 0,t.getListAnnounceData=t.matchLink=t.setModelIndentation=t.findListItemsInSameThread=t.setModelListStartNumber=t.setModelListStyle=t.setListType=t.formatInsertPointWithContentModel=void 0;var n=r(113);Object.defineProperty(t,"insertTable",{enumerable:!0,get:function(){return n.insertTable}});var o=r(5844);Object.defineProperty(t,"formatTable",{enumerable:!0,get:function(){return o.formatTable}});var a=r(9587);Object.defineProperty(t,"setTableCellShade",{enumerable:!0,get:function(){return a.setTableCellShade}});var i=r(5325);Object.defineProperty(t,"editTable",{enumerable:!0,get:function(){return i.editTable}});var l=r(7290);Object.defineProperty(t,"applyTableBorderFormat",{enumerable:!0,get:function(){return l.applyTableBorderFormat}});var s=r(7655);Object.defineProperty(t,"toggleBullet",{enumerable:!0,get:function(){return s.toggleBullet}});var c=r(6320);Object.defineProperty(t,"toggleNumbering",{enumerable:!0,get:function(){return c.toggleNumbering}});var u=r(9176);Object.defineProperty(t,"toggleBold",{enumerable:!0,get:function(){return u.toggleBold}});var d=r(6053);Object.defineProperty(t,"toggleItalic",{enumerable:!0,get:function(){return d.toggleItalic}});var f=r(1538);Object.defineProperty(t,"toggleUnderline",{enumerable:!0,get:function(){return f.toggleUnderline}});var p=r(8398);Object.defineProperty(t,"toggleStrikethrough",{enumerable:!0,get:function(){return p.toggleStrikethrough}});var m=r(8356);Object.defineProperty(t,"toggleSubscript",{enumerable:!0,get:function(){return m.toggleSubscript}});var h=r(79);Object.defineProperty(t,"toggleSuperscript",{enumerable:!0,get:function(){return h.toggleSuperscript}});var g=r(5707);Object.defineProperty(t,"setBackgroundColor",{enumerable:!0,get:function(){return g.setBackgroundColor}});var v=r(8151);Object.defineProperty(t,"setFontName",{enumerable:!0,get:function(){return v.setFontName}});var b=r(9316);Object.defineProperty(t,"setFontSize",{enumerable:!0,get:function(){return b.setFontSize}});var y=r(6268);Object.defineProperty(t,"setTextColor",{enumerable:!0,get:function(){return y.setTextColor}});var S=r(6385);Object.defineProperty(t,"changeFontSize",{enumerable:!0,get:function(){return S.changeFontSize}});var C=r(1089);Object.defineProperty(t,"applySegmentFormat",{enumerable:!0,get:function(){return C.applySegmentFormat}});var _=r(3870);Object.defineProperty(t,"changeCapitalization",{enumerable:!0,get:function(){return _.changeCapitalization}});var T=r(2549);Object.defineProperty(t,"insertImage",{enumerable:!0,get:function(){return T.insertImage}});var E=r(8907);Object.defineProperty(t,"setListStyle",{enumerable:!0,get:function(){return E.setListStyle}});var M=r(6916);Object.defineProperty(t,"setListStartNumber",{enumerable:!0,get:function(){return M.setListStartNumber}});var k=r(8474);Object.defineProperty(t,"setIndentation",{enumerable:!0,get:function(){return k.setIndentation}});var O=r(2993);Object.defineProperty(t,"setAlignment",{enumerable:!0,get:function(){return O.setAlignment}});var P=r(6763);Object.defineProperty(t,"setDirection",{enumerable:!0,get:function(){return P.setDirection}});var w=r(9762);Object.defineProperty(t,"setHeadingLevel",{enumerable:!0,get:function(){return w.setHeadingLevel}});var x=r(2815);Object.defineProperty(t,"toggleBlockQuote",{enumerable:!0,get:function(){return x.toggleBlockQuote}});var D=r(8492);Object.defineProperty(t,"setSpacing",{enumerable:!0,get:function(){return D.setSpacing}});var L=r(9782);Object.defineProperty(t,"setImageBorder",{enumerable:!0,get:function(){return L.setImageBorder}});var F=r(7017);Object.defineProperty(t,"setImageBoxShadow",{enumerable:!0,get:function(){return F.setImageBoxShadow}});var N=r(6758);Object.defineProperty(t,"changeImage",{enumerable:!0,get:function(){return N.changeImage}});var R=r(2509);Object.defineProperty(t,"getFormatState",{enumerable:!0,get:function(){return R.getFormatState}});var I=r(7637);Object.defineProperty(t,"clearFormat",{enumerable:!0,get:function(){return I.clearFormat}});var j=r(5854);Object.defineProperty(t,"insertLink",{enumerable:!0,get:function(){return j.insertLink}});var A=r(5972);Object.defineProperty(t,"removeLink",{enumerable:!0,get:function(){return A.removeLink}});var B=r(3657);Object.defineProperty(t,"adjustLinkSelection",{enumerable:!0,get:function(){return B.adjustLinkSelection}});var H=r(5040);Object.defineProperty(t,"setImageAltText",{enumerable:!0,get:function(){return H.setImageAltText}});var z=r(3775);Object.defineProperty(t,"adjustImageSelection",{enumerable:!0,get:function(){return z.adjustImageSelection}});var U=r(5787);Object.defineProperty(t,"setParagraphMargin",{enumerable:!0,get:function(){return U.setParagraphMargin}});var W=r(7311);Object.defineProperty(t,"toggleCode",{enumerable:!0,get:function(){return W.toggleCode}});var G=r(1323);Object.defineProperty(t,"insertEntity",{enumerable:!0,get:function(){return G.insertEntity}});var K=r(3353);Object.defineProperty(t,"insertTableRow",{enumerable:!0,get:function(){return K.insertTableRow}});var V=r(9281);Object.defineProperty(t,"insertTableColumn",{enumerable:!0,get:function(){return V.insertTableColumn}});var q=r(7140);Object.defineProperty(t,"clearSelectedCells",{enumerable:!0,get:function(){return q.clearSelectedCells}});var X=r(821);Object.defineProperty(t,"formatTableWithContentModel",{enumerable:!0,get:function(){return X.formatTableWithContentModel}});var $=r(3152);Object.defineProperty(t,"formatImageWithContentModel",{enumerable:!0,get:function(){return $.formatImageWithContentModel}});var Y=r(4890);Object.defineProperty(t,"formatParagraphWithContentModel",{enumerable:!0,get:function(){return Y.formatParagraphWithContentModel}});var Z=r(6648);Object.defineProperty(t,"formatSegmentWithContentModel",{enumerable:!0,get:function(){return Z.formatSegmentWithContentModel}});var Q=r(9082);Object.defineProperty(t,"formatTextSegmentBeforeSelectionMarker",{enumerable:!0,get:function(){return Q.formatTextSegmentBeforeSelectionMarker}});var J=r(6250);Object.defineProperty(t,"formatInsertPointWithContentModel",{enumerable:!0,get:function(){return J.formatInsertPointWithContentModel}});var ee=r(9689);Object.defineProperty(t,"setListType",{enumerable:!0,get:function(){return ee.setListType}});var te=r(5848);Object.defineProperty(t,"setModelListStyle",{enumerable:!0,get:function(){return te.setModelListStyle}});var re=r(6254);Object.defineProperty(t,"setModelListStartNumber",{enumerable:!0,get:function(){return re.setModelListStartNumber}});var ne=r(4514);Object.defineProperty(t,"findListItemsInSameThread",{enumerable:!0,get:function(){return ne.findListItemsInSameThread}});var oe=r(8722);Object.defineProperty(t,"setModelIndentation",{enumerable:!0,get:function(){return oe.setModelIndentation}});var ae=r(6089);Object.defineProperty(t,"matchLink",{enumerable:!0,get:function(){return ae.matchLink}});var ie=r(187);Object.defineProperty(t,"getListAnnounceData",{enumerable:!0,get:function(){return ie.getListAnnounceData}})},1230:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setModelAlignment=void 0;var n=r(8108),o=r(8871),a={left:{ltr:"start",rtl:"end"},center:{ltr:"center",rtl:"center"},right:{ltr:"end",rtl:"start"},justify:{ltr:"justify",rtl:"justify"}},i={left:{ltr:"alignLeft",rtl:"alignRight"},center:{ltr:"alignCenter",rtl:"alignCenter"},right:{ltr:"alignRight",rtl:"alignLeft"}};t.setModelAlignment=function(e,t){var r=(0,o.getOperationalBlocks)(e,["ListItem"],["TableCell"]);return r.forEach((function(e){var r=e.block,o=a[t]["rtl"==r.format.direction?"rtl":"ltr"];"Table"===r.blockType&&"justify"!==t?(0,n.alignTable)(r,i[t]["rtl"==r.format.direction?"rtl":"ltr"]):r&&("BlockGroup"===r.blockType&&"ListItem"===r.blockGroupType&&r.blocks.forEach((function(e){e.format.textAlign=o})),r.format.textAlign=o)})),r.length>0}},7444:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setModelDirection=void 0;var n=r(4514),o=r(8871);function a(e,t,r){if("rtl"==e.direction!=("rtl"==t)){e.direction=t;var n=e.marginLeft,a=e.paddingLeft;i(e,"marginLeft",e.marginRight),i(e,"marginRight",n),i(e,"paddingLeft",e.paddingRight),i(e,"paddingRight",a),r&&"Table"==r.blockType&&(r.rows.forEach((function(e){e.cells.forEach((function(e){(0,o.updateTableCellMetadata)(e,(function(t){if(null==t?void 0:t.borderOverride){var r=e.format.borderLeft;i(e.format,"borderLeft",e.format.borderRight),i(e.format,"borderRight",r)}return t}))}))})),(0,o.applyTableFormat)(r,void 0,!0))}}function i(e,t,r){r?e[t]=r:delete e[t]}t.setModelDirection=function(e,t){var r=(0,o.getOperationalBlocks)(e,["ListItem"],["TableCell"]);return r.forEach((function(r){var i=r.block;(0,o.isBlockGroupOfType)(i,"ListItem")?(0,n.findListItemsInSameThread)(e,i).forEach((function(e){e.levels.forEach((function(e){e.format.direction=t})),e.blocks.forEach((function(e){return a(e.format,t)}))})):i&&a(i.format,t,i)})),r.length>0}},8722:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setModelIndentation=void 0;var n=r(7582),o=r(4514),a=r(187),i=r(8871);function l(e){return e.blocks.some((function(e){if("Paragraph"==e.blockType)return e.segments.some((function(e){return e.isSelected}))}))}function s(e,t,r){void 0===r&&(r=40);var n=e.marginLeft,o=e.marginRight,a="rtl"==e.direction,l=(0,i.parseValueWithUnit)(a?o:n),s=(t?Math.ceil:Math.floor)(l/r)*r;return s==l&&(s=Math.max(s+r*(t?1:-1),0)),s==l?null:s}t.setModelIndentation=function(e,t,r,c){void 0===r&&(r=40);var u=(0,i.getOperationalBlocks)(e,["ListItem"],["TableCell"]),d="indent"==t,f=[];return u.forEach((function(t){var u=t.block,p=t.parent,m=t.path;if((0,i.isBlockGroupOfType)(u,"ListItem")){var h=(0,o.findListItemsInSameThread)(e,u)[0];if(l(h)&&1==h.levels.length){var g=u.levels[0],v=(k=g.format).marginLeft,b=k.marginRight,y=s(k,d,r),S="rtl"==k.direction,C=(0,i.parseValueWithUnit)(S?b:v);d||0!=C?null!==y&&(S?g.format.marginRight=y+"px":g.format.marginLeft=y+"px"):u.levels.pop()}else if(1==u.levels.length||!function(e,t,r){for(var n=r.blocks.indexOf(t)-1;n>=0;n--){var a=r.blocks[n];if((0,i.isBlockGroupOfType)(a,"ListItem")&&1==a.levels.length&&l(a))return l((0,o.findListItemsInSameThread)(e,a)[0]);if(!(0,i.isBlockGroupOfType)(a,"ListItem"))return!1}return!1}(e,u,p)){if(d){var _=u.levels[u.levels.length-1],T=(0,i.createListLevel)((null==_?void 0:_.listType)||"UL",null==_?void 0:_.format);(0,i.updateListMetadata)(T,(function(e){return(e=e||{}).applyListStyleFromLevel=!0,e})),delete T.format.startNumberOverride,u.levels.push(T)}else u.levels.pop();u.levels.length>0&&c&&(c.announceData=(0,a.getListAnnounceData)((0,n.__spreadArray)([u],(0,n.__read)(m),!1)))}}else if(u)for(var E=u,M=p;M&&f.indexOf(E)<0;){var k,O=m.indexOf(M);if(null!==(y=s(k=E.format,d,r))){(S="rtl"==k.direction)?k.marginRight=y+"px":k.marginLeft=y+"px",f.push(E);break}if(!("FormatContainer"==M.blockGroupType&&O>=0))break;delete M.cachedElement,E=M,M=m[O+1]}})),u.length>0}},9611:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleModelBlockQuote=void 0;var n=r(3388),o=r(8871);function a(e){return(0,o.isBlockGroupOfType)(e,"FormatContainer")&&"blockquote"==e.tagName}t.toggleModelBlockQuote=function(e,t,r){var i=(0,o.getOperationalBlocks)(e,["FormatContainer","ListItem"],["TableCell"],!0);if(i.every((function(e){return a(e.block)})))i.forEach((function(e){var t=e.block,r=e.parent;(0,o.unwrapBlock)(r,t)}));else{var l=[],s=function(e){return(0,o.createFormatContainer)("blockquote",e?r:t)},c=function(e,n,i){return function(e,t){return a(e)&&(0,o.areSameFormats)(t,e.format)}(n,(null==i?void 0:i.format)||(e?r:t))};i.forEach((function(e){var t=e.block,r=e.parent;a(t)||(0,n.wrapBlockStep1)(l,r,t,s,c)})),(0,n.wrapBlockStep2)(l,c)}return i.length>0}},4789:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearModelFormat=void 0;var n=r(7582),o=r(2737),a=r(8871);function i(e,t){var r=(0,a.getClosestAncestorBlockGroupIndex)(e,["FormatContainer"],["TableCell"]);if(r>=0&&r<e.length-1){var n=e[r],o=e[r+1].blocks.indexOf(n),i=n.blocks.indexOf(t);if(i>=0&&o>=0){var l=(0,a.createFormatContainer)(n.tagName,n.format);n.blocks.splice(i,1),l.blocks=n.blocks.splice(i),e[r+1].blocks.splice(o+1,0,t,l)}}}function l(e){var t=e[(0,a.getClosestAncestorBlockGroupIndex)(e,["ListItem"],["TableCell"])];t&&(t.levels=[])}function s(e,t){if("Divider"==t.blockType){var r=e[0].blocks.indexOf(t);r>=0&&e[0].blocks.splice(r,1)}else"Paragraph"==t.blockType&&(t.format={},delete t.decorator)}t.clearModelFormat=function(e,t,r,c){(0,a.iterateSelections)(e,(function(e,o,i,l){l&&r.push.apply(r,(0,n.__spreadArray)([],(0,n.__read)(l),!1)),i?t.push([e,i]):o&&function(e,t){if(e){var r=e.table,n=e.colIndex,o=e.rowIndex,i=e.isWholeTableSelected,l=r.rows[o].cells[n];l.isSelected&&((0,a.updateTableCellMetadata)(l,(function(){return null})),l.isHeader=!1,l.format={useBorderBox:l.format.useBorderBox}),t.find((function(e){return e[0]==r}))||t.push([r,i])}}(o,c)}),{includeListFormatHolder:e.format?"never":"anySegment"});var u=r[0];if(1==t.length&&function(e){var t="Paragraph"==e.blockType?e.segments.filter((function(e){return e.isSelected})):[];return 1==t.length&&"SelectionMarker"==t[0].segmentType}(t[0][1])&&1==t.length)r.splice.apply(r,(0,n.__spreadArray)([0,r.length],(0,n.__read)((0,o.adjustWordSelection)(e,u)),!1)),l(t[0][0]);else if(t.length>1||t.some((function(e){return function(e){return e.isSelected||"Paragraph"==e.blockType&&e.segments.every((function(e){return e.isSelected}))}(e[1])})))for(var d=t.length-1;d>=0;d--){var f=(0,n.__read)(t[d],2),p=f[0],m=f[1];s(p,m),l(p),i(p,m)}!function(e,t){e.forEach((function(e){e.format=(0,n.__assign)({},t||{}),e.link&&delete e.link.format.textColor,delete e.code}))}(r,e.format),function(e){e.forEach((function(e){var t=(0,n.__read)(e,2),r=t[0];t[1]&&(r.format={useBorderBox:r.format.useBorderBox,borderCollapse:r.format.borderCollapse},(0,a.updateTableMetadata)(r,(function(){return null}))),(0,a.applyTableFormat)(r,void 0,!0)}))}(c)}},9033:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducedModelChildProcessor=void 0;var n=r(7582),o=r(8871);t.reducedModelChildProcessor=function(e,t,r){if(!r.nodeStack){var a=(0,o.getSelectionRootNode)(r.selection);r.nodeStack=a?function(e,t){for(var r=[],n=t;n&&e!=n&&e.contains(n);)(0,o.isNodeOfType)(n,"ELEMENT_NODE")&&"TABLE"==n.tagName?r.splice(0,r.length,n):r.push(n),n=n.parentNode;return r}(t,a):[]}var i=r.nodeStack.pop();if(i){var l=(0,n.__read)((0,o.getRegularSelectionOffsets)(r,t),2),s=l[0],c=l[1],u=s>=0||c>=0?function(e,t){for(var r=0,n=e.firstChild;n&&n!=t;)r++,n=n.nextSibling;return r}(t,i):-1;u>=0&&(0,o.handleRegularSelection)(u,r,e,s,c),(0,o.processChildNode)(e,i,r),u>=0&&(0,o.handleRegularSelection)(u+1,r,e,s,c)}else r.defaultElementProcessors.child(e,t,r)}},3388:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapBlockStep2=t.wrapBlockStep1=void 0;var n=r(7582),o=r(8871);t.wrapBlockStep1=function(e,t,r,n,a){var i,l=null!==(i=null==t?void 0:t.blocks.indexOf(r))&&void 0!==i?i:-1;if(t&&l>=0){t.blocks.splice(l,1);var s=t.blocks[l-1],c="rtl"==r.format.direction,u=a(c,s)?s:function(e,t,r,n){var o=r(n);return e.blocks.splice(t,0,o),o}(t,l,n,c);(0,o.setParagraphNotImplicit)(r),(0,o.addBlock)(u,r),e.unshift({parent:t,wrapper:u})}},t.wrapBlockStep2=function(e,t){e.forEach((function(e){var r,a=e.parent,i=e.wrapper,l=a.blocks.indexOf(i),s=a.blocks[l+1],c="rtl"==i.format.direction;l>=0&&t(c,s,i)&&(i.blocks.forEach(o.setParagraphNotImplicit),(r=i.blocks).push.apply(r,(0,n.__spreadArray)([],(0,n.__read)(s.blocks),!1)),a.blocks.splice(l+1,1))}))}},4247:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertEntityModel=void 0;var n=r(7582),o=r(8871);t.insertEntityModel=function(e,t,r,a,i,l,s){var c,u,d,f,p=-1;if("begin"==r||"end"==r)d=e,p="begin"==r?0:e.blocks.length,a||Object.assign(t.format,e.format);else if(f=function(e,t,r){if(t)return t;var n=(0,o.deleteSelection)(e,[],r),a=n.insertPoint;return"range"==n.deleteResult&&(0,o.normalizeContentModel)(e),a}(e,s,l)){var m=f.marker,h=f.paragraph,g=f.path;if(a){var v="root"==r?(0,o.getClosestAncestorBlockGroupIndex)(g,["TableCell","Document"]):0;d=g[v];var b=g[v-1],y="FormatContainer"==(null==b?void 0:b.blockGroupType)||"General"==(null==b?void 0:b.blockGroupType)||"ListItem"==(null==b?void 0:b.blockGroupType)?b:h,S=d.blocks.indexOf(y);p=S>=0?S+1:-1}else{var C=h.segments.indexOf(m);Object.assign(t.format,m.format),C>=0&&h.segments.splice(i?C:C+1,0,t)}}if(p>=0&&d){var _=[],T=void 0;if(a){var E=d.blocks[p];_.push(t),"Paragraph"==(null==E?void 0:E.blockType)?T=E:E&&"Entity"!=E.blockType&&!i||((T=(0,o.createParagraph)(!1,{},e.format)).segments.push((0,o.createBr)(e.format)),_.push(T))}else(T=(0,o.createParagraph)(!1,void 0,e.format)).segments.push(t),_.push(T);if((c=d.blocks).splice.apply(c,(0,n.__spreadArray)([p,0],(0,n.__read)(_),!1)),i&&T){m=(0,o.createSelectionMarker)((null===(u=T.segments[0])||void 0===u?void 0:u.format)||e.format);var M=T.segments;a?M.unshift(m):M.push(m),(0,o.setSelection)(e,m,m)}}}},3446:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyImageBorderFormat=void 0;var n=r(8871);t.applyImageBorderFormat=function(e,t,r){if(t){var o=e.format,a=t.width,i=t.style,l=t.color,s=(0,n.extractBorderValues)(o.borderTop),c=s.color,u=s.width,d=s.style,f="";f=a?(0,n.parseValueWithUnit)(a)+"px":u||"1px",i?f=f+" "+i:d?f=f+" "+d:f+=" solid",l?f=f+" "+l:c&&(f=f+" "+c),e.format.borderLeft=f,e.format.borderTop=f,e.format.borderBottom=f,e.format.borderRight=f}else delete e.format.borderLeft,delete e.format.borderTop,delete e.format.borderBottom,delete e.format.borderRight;r&&(e.format.borderRadius=r)}},6089:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.matchLink=void 0;var n=r(7582),o=r(8871),a=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,i="[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",l="(?:"+i+"\\.)*"+i+"(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",s={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+l+"|www\\."+l,"i"),except:a,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+l,"i"),except:a},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+l+"|ftp\\."+l,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+l,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+l,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+l,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+l,"i")}};t.matchLink=function(e){var t,r;if(e)try{for(var a=(0,n.__values)((0,o.getObjectKeys)(s)),i=a.next();!i.done;i=a.next()){var l=i.value,c=s[l],u=e.match(c.match);if(u&&u[0]==e&&(!c.except||!c.except.test(e)))return{scheme:l,originalUrl:e,normalizedUrl:c.normalizeUrl?c.normalizeUrl(e):e}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return null}},4514:(e,t)=>{"use strict";function r(e,t){e.blocks.forEach((function(e){switch(e.blockType){case"BlockGroup":"ListItem"==e.blockGroupType?t.push(e):(n(t),r(e,t),n(t));break;case"Paragraph":n(t),e.segments.forEach((function(e){"General"==e.segmentType&&r(e,t)})),n(t);break;case"Table":n(t),e.rows.forEach((function(e){return e.cells.forEach((function(e){r(e,t)}))})),n(t)}}))}function n(e){var t=e[e.length-1];t&&null===t||e.push(null)}function o(e,t,r){var n=e[t].levels,o=e[r].levels;return n.length<=o.length&&n.every((function(e,t){return e.listType==o[t].listType}))}function a(e,t){return e.levels.slice(0,t).some((function(e){return void 0!==e.format.startNumberOverride}))}Object.defineProperty(t,"__esModule",{value:!0}),t.findListItemsInSameThread=void 0,t.findListItemsInSameThread=function(e,t){var n=[];return r(e,n),function(e,t){var r,n=[],i=e.indexOf(t),l=t.levels.length,s="OL"==(null===(r=t.levels[l-1])||void 0===r?void 0:r.listType);if(i>=0){for(var c=i;c>=0;c--){if(!(d=e[c])){if(s)continue;break}var u=a(d,l);if(o(e,i,c)){if(n.unshift(d),s&&u)break}else if(!s||u||d.levels.length<t.levels.length)break}for(c=i+1;c<e.length;c++){var d;if(!(d=e[c])){if(s)continue;break}if(u=a(d,l),o(e,i,c)&&!u)n.push(d);else if(!s||u||d.levels.length<t.levels.length)break}}return n}(n,t)}},187:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getListAnnounceData=void 0;var n=r(4514),o=r(8871);t.getListAnnounceData=function(e){var t=(0,o.getClosestAncestorBlockGroupIndex)(e,["ListItem"],["TableCell"]);if(t>=0){var r=e[t],a=r.levels[r.levels.length-1];if(a.format.displayForDummyItem)return null;if("OL"==a.listType){var i=function(e,t){for(var r,o,a=(0,n.findListItemsInSameThread)(e[e.length-1],t),i=0,l=0;l<a.length;l++){var s=a[l];if(0==i&&s.levels.length==t.levels.length&&(i=null!==(o=null===(r=s.levels[s.levels.length-1])||void 0===r?void 0:r.format.startNumberOverride)&&void 0!==o?o:1),s==t)break;if(s.levels.length<t.levels.length)i=0;else{if(s.levels.length>t.levels.length)continue;s.levels[s.levels.length-1].format.displayForDummyItem||i++}}return i}(e,r),l=(0,o.updateListMetadata)(a),s=(0,o.getAutoListStyleType)("OL",null!=l?l:{},r.levels.length-1,a.format.listStyleType);return void 0===s?null:{defaultStrings:"announceListItemNumbering",formatStrings:[(0,o.getOrderedListNumberStr)(s,i)]}}return{defaultStrings:"announceListItemBullet"}}return null}},9689:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setListType=void 0;var n=r(8871);function o(e){switch(e.blockType){case"Table":return!1;case"Paragraph":return e.segments.every((function(e){return"Br"==e.segmentType||"SelectionMarker"==e.segmentType}));default:return!0}}t.setListType=function(e,t,r){void 0===r&&(r=!1);var a=(0,n.getOperationalBlocks)(e,["ListItem"],[]),i=a.every((function(e){var r,a=e.block;return(0,n.isBlockGroupOfType)(a,"ListItem")?(null===(r=a.levels[a.levels.length-1])||void 0===r?void 0:r.listType)==t:o(a)})),l=[];return a.forEach((function(e,s){var c,u,d=e.block,f=e.parent;if((0,n.isBlockGroupOfType)(d,"ListItem")){var p=d.levels.pop();!i&&p?(p.listType=t,d.levels.push(p)):1==d.blocks.length&&(0,n.setParagraphNotImplicit)(d.blocks[0]),i&&d.blocks.forEach((function(e){d.format.marginLeft&&(e.format.marginLeft=d.format.marginLeft),d.format.marginRight&&(e.format.marginRight=d.format.marginRight),d.format.textAlign&&(e.format.textAlign=d.format.textAlign)}))}else{var m=f.blocks.indexOf(d);if(m>=0)if(1!=a.length&&o(d))l.forEach((function(e){return e.levels[0].format.marginBottom="0px"})),l=[];else{var h=f.blocks[m-1],g="Paragraph"==d.blockType&&(null===(c=d.segments[0])||void 0===c?void 0:c.format)||{},v=(0,n.createListItem)([(0,n.createListLevel)(t,{startNumberOverride:s>0||"BlockGroup"==(null==h?void 0:h.blockType)&&"ListItem"==h.blockGroupType&&"OL"==(null===(u=h.levels[0])||void 0===u?void 0:u.listType)?void 0:1,direction:d.format.direction,textAlign:d.format.textAlign,marginBottom:r?"0px":void 0,marginTop:r?"0px":void 0})],{fontFamily:g.fontFamily,fontSize:g.fontSize,textColor:g.textColor});"Paragraph"==d.blockType&&(0,n.setParagraphNotImplicit)(d),v.blocks.push(d),d.format.marginRight&&(v.format.marginRight=d.format.marginRight,d.format.marginRight=void 0),d.format.marginLeft&&(v.format.marginLeft=d.format.marginLeft,d.format.marginLeft=void 0),d.format.textAlign&&(v.format.textAlign=d.format.textAlign),f.blocks.splice(m,1,v),l.push(v)}}})),(0,n.normalizeContentModel)(e),a.length>0}},6254:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setModelListStartNumber=void 0;var n=r(8871);t.setModelListStartNumber=function(e,t){var r=(0,n.getFirstSelectedListItem)(e),o=null==r?void 0:r.levels[(null==r?void 0:r.levels.length)-1];return!!o&&(o.format.startNumberOverride=t,!0)}},5848:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setModelListStyle=void 0;var n=r(4514),o=r(8871);t.setModelListStyle=function(e,t){var r=(0,o.getFirstSelectedListItem)(e);if(r){var a=(0,n.findListItemsInSameThread)(e,r),i=r.levels.length-1;a.forEach((function(e){var r=e.levels[i];r&&(0,o.updateListMetadata)(r,(function(e){return Object.assign({},e,t)}))}))}return!!r}},982:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustSegmentSelection=void 0;var n=r(8871);t.adjustSegmentSelection=function(e,t,r){var o,a,i=(0,n.getSelectedParagraphs)(e),l=!1;return i.forEach((function(e){var n=o?0:e.segments.findIndex((function(e){return t(e)})),i=e.segments;if(!o){o=i[n];for(var s=n;s>0;s--){if(!r(i[s-1],o)){l=l||!!i[s-1].isSelected;break}o=i[s-1],l=l||!i[s-1].isSelected}}if(o)for(s=n;s<e.segments.length;s++){if(s!=n&&!r(i[s],a||i[n])){l=l||!!i[s].isSelected;break}a=i[s],l=l||!i[s].isSelected}})),o&&a&&(0,n.setSelection)(e,o,a),l}},9087:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustTrailingSpaceSelection=void 0;var n=r(7582),o=r(8871);function a(e){return e.isSelected&&(t=e.text).trimRight()!==t&&!function(e){return 0==e.trimRight().length}(e.text);var t}function i(e,t){var r,a=t.text.trimRight(),i=t.text.substring(a.length),l=(0,o.createText)(a,t.format,t.link,t.code);l.isSelected=!0;var s=t.link?(0,n.__assign)((0,n.__assign)({},t.link),{format:(0,n.__assign)((0,n.__assign)({},null===(r=t.link)||void 0===r?void 0:r.format),{underline:!1})}):void 0,c=(0,o.createText)(i,void 0,s,t.code);c.isSelected=!0;var u=e.segments.indexOf(t);e.segments.splice(u,1,l,c)}t.adjustTrailingSpaceSelection=function(e){(0,o.iterateSelections)(e,(function(e,t,r,n){if("Paragraph"===(null==r?void 0:r.blockType)&&n&&n.length>0)if(1===n.length&&"Text"===n[0].segmentType&&a(n[0]))i(r,n[0]);else{var o="SelectionMarker"===n[n.length-1].segmentType?n[n.length-2]:n[n.length-1];o&&"Text"===o.segmentType&&a(o)&&i(r,o)}return!1}))}},2737:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustWordSelection=void 0;var n=r(7582),o=r(8871);function a(e,t){var r=e.text,n=-1;if(t)for(var a=0;a<r.length;a++){var i=r[a];if((0,o.isPunctuation)(i)||(0,o.isSpace)(i)){n=a;break}}else for(a=r.length-1;a>=0;a--)if(i=r[a],(0,o.isPunctuation)(i)||(0,o.isSpace)(i)){n=a+1;break}return n}function i(e,t,r,n){var a=t.text,i=(0,o.createText)(a.substring(0,n),t.format,t.link,t.code),l=(0,o.createText)(a.substring(n,a.length),t.format,t.link,t.code);e.splice(r,1,i,l)}t.adjustWordSelection=function(e,t){var r;(0,o.iterateSelections)(e,(function(e,n,o,a){return"Paragraph"==(null==o?void 0:o.blockType)&&1==(null==a?void 0:a.length)&&a[0]==t&&(r=o),!0}));var l=r?(0,n.__spreadArray)([],(0,n.__read)(r.segments),!1):void 0;if(l&&r){for(var s=[],c=l.indexOf(t),u=c-1;u>=0&&"Text"==(d=l[u]).segmentType;u--){if((f=a(d,!1))>-1){if(f==d.text.length)break;i(l,d,u,f),s.push(l[u+1]);break}s.push(l[u])}if(c=l.indexOf(t),s.push(t),s.length<=1)return s;for(u=c+1;u<l.length;u++){var d,f;if("Text"!=(d=l[u]).segmentType)break;if((f=a(d,!0))>-1){if(0==f)break;i(l,d,u,f),s.push(l[u]);break}s.push(l[u])}return s[s.length-1]==t?[t]:(r.segments=l,s)}return[t]}},2483:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collapseTableSelection=void 0;var n=r(8871);t.collapseTableSelection=function(e,t){var r,o=t.firstColumn,a=null===(r=e[t.firstRow])||void 0===r?void 0:r.cells[o];a&&(0,n.addSegment)(a,(0,n.createSelectionMarker)())}},8108:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.alignTable=void 0,t.alignTable=function(e,t){e.format.marginLeft="alignLeft"==t?"":"auto",e.format.marginRight="alignRight"==t?"":"auto",delete e.cachedElement}},7298:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.alignTableCellVertically=t.alignTableCellHorizontally=void 0;var n=r(8871),o={alignCellLeft:"start",alignCellCenter:"center",alignCellRight:"end"},a={alignCellTop:"top",alignCellMiddle:"middle",alignCellBottom:"bottom"};function i(e,t){var r,o=(0,n.getSelectedCells)(e);if(o)for(var a=o.firstRow;a<=o.lastRow;a++)for(var i=o.firstColumn;i<=o.lastColumn;i++){var l=null===(r=e.rows[a])||void 0===r?void 0:r.cells[i];(null==l?void 0:l.format)&&(delete l.cachedElement,t(l),l.blocks.forEach((function(e){"Paragraph"===e.blockType&&delete e.format.textAlign})))}}t.alignTableCellHorizontally=function(e,t){i(e,(function(e){e.format.textAlign=o[t]}))},t.alignTableCellVertically=function(e,t){i(e,(function(e){e.format.verticalAlign=a[t],(0,n.updateTableCellMetadata)(e,(function(e){return(e=e||{}).vAlignOverride=!0,e}))}))}},1690:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canMergeCells=void 0,t.canMergeCells=function(e,t,r,n,o){var a=r==o||e[t].cells.every((function(e,t){return t<r||t>o||!e.spanAbove})),i=t==n||e.every((function(e,o){return o<t||o>n||!e.cells[r].spanLeft})),l=e[n].cells.map((function(t,a){return a>=r&&a<=o?function(e,t,r){for(var n,o,a=0,i=t+1;i<e.length&&(null===(o=null===(n=e[i])||void 0===n?void 0:n.cells[r])||void 0===o?void 0:o.spanAbove);i++)a++;return a}(e,n,a):-1})).every((function(e,t,n){return e<0||e==n[r]})),s=e.map((function(r,a){return a>=t&&a<=n?function(e,t,r){for(var n,o,a,i=0,l=r+1;l<(null===(n=e[t])||void 0===n?void 0:n.cells.length)&&(null===(a=null===(o=e[t])||void 0===o?void 0:o.cells[l])||void 0===a?void 0:a.spanLeft);l++)i++;return i}(e,a,o):-1})).every((function(e,r,n){return e<0||e==n[t]}));return a&&i&&l&&s}},7140:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearSelectedCells=void 0;var n=r(8871);t.clearSelectedCells=function(e,t){if(t.firstColumn>=0&&t.firstRow>=0&&t.lastColumn<e.widths.length&&t.lastRow<e.rows.length)for(var r=t.firstRow;r<=t.lastRow;r++)for(var o=e.rows[r],a=t.firstColumn;a<=t.lastColumn;a++){var i=o.cells[a];i.isSelected=!1,(0,n.setSelection)(i)}}},8046:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTableStructure=void 0;var n=r(8871);t.createTableStructure=function(e,t,r){var o=(0,n.createTable)(r);return(0,n.addBlock)(e,o),o.rows.forEach((function(e){for(var r=0;r<t;r++){var o=(0,n.createTableCell)();e.cells.push(o)}})),o}},3465:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTable=void 0,t.deleteTable=function(e){e.rows=[],delete e.cachedElement}},4794:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTableColumn=void 0;var n=r(2483),o=r(8871);t.deleteTableColumn=function(e){var t=(0,o.getSelectedCells)(e);if(t){for(var r=0;r<e.rows.length;r++){var a=e.rows[r].cells[t.lastColumn+1];a&&(a.spanLeft=a.spanLeft&&e.rows[r].cells[t.firstColumn].spanLeft),e.rows[r].cells.splice(t.firstColumn,t.lastColumn-t.firstColumn+1)}e.widths.splice(t.firstColumn,t.lastColumn-t.firstColumn+1),(0,n.collapseTableSelection)(e.rows,t)}}},5078:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTableRow=void 0;var n=r(2483),o=r(8871);t.deleteTableRow=function(e){var t=(0,o.getSelectedCells)(e);t&&(e.rows[t.firstRow].cells.forEach((function(r,n){var o,a=null===(o=e.rows[t.lastRow+1])||void 0===o?void 0:o.cells[n];a&&(a.spanAbove=a.spanAbove&&r.spanAbove)})),e.rows.splice(t.firstRow,t.lastRow-t.firstRow+1),(0,n.collapseTableSelection)(e.rows,t))}},597:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureFocusableParagraphForTable=void 0;var n=r(8871);function o(e){var t=(0,n.createParagraph)(!1,void 0,e.format),r=(0,n.createBr)(e.format);return t.segments.push(r),t}t.ensureFocusableParagraphForTable=function(e,t,r){var n,a,i,l=null===(n=r.rows.filter((function(e){return e.cells.length>0}))[0])||void 0===n?void 0:n.cells[0];if(l)(i=l.blocks.filter((function(e){return"Paragraph"==e.blockType}))[0])||(i=o(e),l.blocks.push(i));else{var s,c=r;for(i=o(e);s=t.shift();){var u=null!==(a=s.blocks.indexOf(c))&&void 0!==a?a:-1;if(s&&u>=0&&s.blocks.splice(u,1,i),"FormatContainer"!=s.blockGroupType||1!=s.blocks.length||s.blocks[0]!=i)break;c=s}}return i}},9281:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertTableColumn=void 0;var n=r(7140),o=r(8871);t.insertTableColumn=function(e,t){var r=(0,o.getSelectedCells)(e),a="insertLeft"==t;if(r){(0,n.clearSelectedCells)(e,r);for(var i=null==r?void 0:r.firstColumn;i<=r.lastColumn;i++)e.rows.forEach((function(e){var t=e.cells[a?r.firstColumn:r.lastColumn],n=(0,o.createTableCell)(t.spanLeft,t.spanAbove,t.isHeader,t.format,t.dataset);n.isSelected=!0,e.cells.splice(a?r.firstColumn:r.lastColumn+1,0,n)})),e.widths.splice(a?r.firstColumn:r.lastColumn+1,0,e.widths[a?r.firstColumn:r.lastColumn])}}},3353:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertTableRow=void 0;var n=r(7582),o=r(7140),a=r(8871);t.insertTableRow=function(e,t){var r=(0,a.getSelectedCells)(e),i="insertAbove"==t;if(r){(0,o.clearSelectedCells)(e,r);for(var l=r.firstRow;l<=r.lastRow;l++){var s=e.rows[i?r.firstRow:r.lastRow];e.rows.splice(i?r.firstRow:r.lastRow+1,0,{format:(0,n.__assign)({},s.format),cells:s.cells.map((function(e){var t=(0,a.createTableCell)(e.spanLeft,e.spanAbove,e.isHeader,e.format,e.dataset);return t.isSelected=!0,t})),height:s.height})}}}},1254:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableCells=void 0;var n=r(1690),o=r(8871);t.mergeTableCells=function(e){var t=(0,o.getSelectedCells)(e);if(t&&(0,n.canMergeCells)(e.rows,t.firstRow,t.firstColumn,t.lastRow,t.lastColumn))for(var r=t.firstRow;r<=t.lastRow;r++){for(var a=t.firstColumn;a<=t.lastColumn;a++){var i=e.rows[r].cells[a];i&&(i.spanLeft=a>t.firstColumn,i.spanAbove=r>t.firstRow,delete i.cachedElement)}delete e.rows[r].cachedElement}}},8402:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableColumn=void 0;var n=r(1690),o=r(8871);t.mergeTableColumn=function(e,t){var r,a,i,l,s=(0,o.getSelectedCells)(e);if(s){var c="mergeLeft"==t?s.firstColumn:s.lastColumn+1;if(c>0&&c<e.rows[0].cells.length)for(var u=s.firstRow;u<=s.lastRow;u++){var d=null===(r=e.rows[u])||void 0===r?void 0:r.cells[c];if(d&&(0,n.canMergeCells)(e.rows,u,c-1,u,c)){d.spanLeft=!0;for(var f=c;null===(i=null===(a=e.rows[u])||void 0===a?void 0:a.cells[f])||void 0===i?void 0:i.spanLeft;)delete e.rows[u].cells[f].cachedElement,f--;(null===(l=e.rows[u])||void 0===l?void 0:l.cells[f])&&(e.rows[u].cells[f].isSelected=!0,delete e.rows[u].cells[f].cachedElement),delete d.cachedElement}delete e.rows[u].cachedElement}}}},2447:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableRow=void 0;var n=r(1690),o=r(8871);t.mergeTableRow=function(e,t){var r,a,i,l=(0,o.getSelectedCells)(e);if(l){var s="mergeAbove"==t?l.firstRow:l.lastRow+1;if(s>0&&s<e.rows.length)for(var c=l.firstColumn;c<=l.lastColumn;c++){var u=e.rows[s].cells[c];if(u&&(0,n.canMergeCells)(e.rows,s-1,c,s,c)){u.spanAbove=!0;for(var d=s;null===(a=null===(r=e.rows[d])||void 0===r?void 0:r.cells[c])||void 0===a?void 0:a.spanAbove;)delete e.rows[d].cells[c].cachedElement,delete e.rows[d].cachedElement,d--;(null===(i=e.rows[d])||void 0===i?void 0:i.cells[c])&&(e.rows[d].cells[c].isSelected=!0,delete e.rows[d].cells[c].cachedElement,delete e.rows[d].cachedElement),delete u.cachedElement}}}}},9052:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitTableCellHorizontally=void 0;var n=r(7582),o=r(8871);t.splitTableCellHorizontally=function(e){var t=(0,o.getSelectedCells)(e);if(t)for(var r=function(r){if(e.rows.every((function(e,n){var o;return n<t.firstRow||n>t.lastRow||(null===(o=e.cells[r+1])||void 0===o?void 0:o.spanLeft)})))e.rows.forEach((function(e,n){delete e.cells[r].cachedElement,n>=t.firstRow&&n<=t.lastRow&&(e.cells[r+1].spanLeft=!1,delete e.cells[r+1].cachedElement)}));else{e.rows.forEach((function(e,a){var i=e.cells[r];if(i){var l=(0,o.createTableCell)(i.spanLeft,i.spanAbove,i.isHeader,i.format);l.dataset=(0,n.__assign)({},i.dataset),a<t.firstRow||a>t.lastRow?l.spanLeft=!0:l.isSelected=i.isSelected,e.cells.splice(r+1,0,l),delete e.cells[r].cachedElement}}));var a=Math.max(e.widths[r]/2,30);e.widths.splice(r,1,a,a)}},a=t.lastColumn;a>=t.firstColumn;a--)r(a)}},1286:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitTableCellVertically=void 0;var n=r(7582),o=r(8871);t.splitTableCellVertically=function(e){var t=(0,o.getSelectedCells)(e);if(t)for(var r=t.lastRow;r>=t.firstRow;r--){var a=e.rows[r],i=e.rows[r+1];if(a.cells.forEach((function(e){delete e.cachedElement})),delete a.cachedElement,null==i?void 0:i.cells.every((function(e,r){return r<t.firstColumn||r>t.lastColumn||e.spanAbove})))i.cells.forEach((function(e,r){r>=t.firstColumn&&r<=t.lastColumn&&(e.spanAbove=!1,delete e.cachedElement)})),delete i.cachedElement;else{var l=Math.max(a.height/=2,22),s={format:(0,n.__assign)({},a.format),height:l,cells:a.cells.map((function(e,r){var a=(0,o.createTableCell)(e.spanLeft,e.spanAbove,e.isHeader,e.format);return a.dataset=(0,n.__assign)({},e.dataset),r<t.firstColumn||r>t.lastColumn?a.spanAbove=!0:a.isSelected=e.isSelected,a}))};a.height=l,e.rows.splice(r+1,0,s)}}}},2993:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setAlignment=void 0;var n=r(1230);t.setAlignment=function(e,t){e.focus(),e.formatContentModel((function(e){return(0,n.setModelAlignment)(e,t)}),{apiName:"setAlignment"})}},6763:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setDirection=void 0;var n=r(7444);t.setDirection=function(e,t){e.focus(),e.formatContentModel((function(e){return(0,n.setModelDirection)(e,t)}),{apiName:"setDirection"})}},9762:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setHeadingLevel=void 0;var n=r(4890),o={h1:"2em",h2:"1.5em",h3:"1.17em",h4:"1em",h5:"0.83em",h6:"0.67em"};t.setHeadingLevel=function(e,t){e.focus(),(0,n.formatParagraphWithContentModel)(e,"setHeadingLevel",(function(e){var r,n,a,i=t>0?"h"+t:(n=(null==(r=e.decorator)?void 0:r.tagName)||"",(a=parseInt(n.substring(1)))>=1&&a<=6?n:null);t>0?(e.decorator={tagName:i,format:i?{fontWeight:"bold",fontSize:o[i]}:{}},e.segments.forEach((function(e){delete e.format.fontSize,delete e.format.fontWeight}))):i&&delete e.decorator}))}},8474:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setIndentation=void 0;var n=r(8871),o=r(8722);t.setIndentation=function(e,t,r){e.focus(),e.formatContentModel((function(e,a){var i=(0,o.setModelIndentation)(e,t,r);return i&&(0,n.normalizeContentModel)(e),a.newPendingFormat="preserve",i}),{apiName:"setIndentation"})}},5787:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setParagraphMargin=void 0;var n=r(8871),o=r(4890);t.setParagraphMargin=function(e,t,r){e.focus(),(0,o.formatParagraphWithContentModel)(e,"setParagraphMargin",(function(e){e.decorator||(e.decorator=(0,n.createParagraphDecorator)("p")),t?e.format.marginTop=t:null===t&&delete e.format.marginTop,r?e.format.marginBottom=r:null===r&&delete e.format.marginBottom}))}},8492:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSpacing=void 0;var n=r(4890);t.setSpacing=function(e,t){e.focus(),(0,n.formatParagraphWithContentModel)(e,"setSpacing",(function(e){e.format.lineHeight=t.toString(),e.segments.forEach((function(e){e.format.lineHeight&&delete e.format.lineHeight}))}))}},2815:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleBlockQuote=void 0;var n=r(7582),o=r(9611),a={borderLeft:"3px solid rgb(200, 200, 200)",textColor:"rgb(102, 102, 102)"},i={borderRight:"3px solid rgb(200, 200, 200)",textColor:"rgb(102, 102, 102)"},l={marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"};t.toggleBlockQuote=function(e,t,r){var s,c=(0,n.__assign)((0,n.__assign)((0,n.__assign)({},l),{paddingLeft:"10px"}),null!=t?t:a),u=(0,n.__assign)((0,n.__assign)((0,n.__assign)({},l),{paddingRight:"10px",direction:"rtl"}),null!==(s=null!=r?r:t)&&void 0!==s?s:i);e.focus(),e.formatContentModel((function(e,t){return t.newPendingFormat="preserve",(0,o.toggleModelBlockQuote)(e,c,u)}),{apiName:"toggleBlockQuote"})}},1323:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertEntity=void 0;var n=r(6250),o=r(4247),a=r(8871);t.insertEntity=function(e,t,r,i,l){var s=l||{},c=s.contentNode,u=s.focusAfterEntity,d=s.wrapperDisplay,f=s.skipUndoSnapshot,p=s.initialEntityState,m=e.getDocument().createElement(r?"div":"span"),h=null!=d?d:r?void 0:"inline-block";m.style.setProperty("display",h||null),null==h&&r&&(m.style.setProperty("width","100%"),m.style.setProperty("display","inline-block")),c&&m.appendChild(c);var g=(0,a.createEntity)(m,!0,void 0,t);f||e.takeSnapshot();var v={changeSource:a.ChangeSource.InsertEntity,getChangeData:function(){return{wrapper:m,type:t,id:"",isReadonly:!0}},apiName:"insertEntity"},b=function(e,t,n){return(0,o.insertEntityModel)(e,g,"string"==typeof i?i:"focus",r,u,t,n),(0,a.normalizeContentModel)(e),t.skipUndoSnapshot=!0,t.newEntities.push(g),!0};if("object"==typeof i?(0,n.formatInsertPointWithContentModel)(e,i,b,v):e.formatContentModel(b,v),!f){var y=void 0;if(p){var S=(0,a.parseEntityFormat)(m),C=S.id,_=S.entityType;y=C&&_?{id:C,type:_,state:p}:void 0}e.takeSnapshot(y)}return g}},7637:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearFormat=void 0;var n=r(4789),o=r(8871);t.clearFormat=function(e){e.focus(),e.formatContentModel((function(e){var t=[],r=[],a=[];return(0,n.clearModelFormat)(e,t,r,a),(0,o.normalizeContentModel)(e),t.length>0||r.length>0||a.length>0}),{apiName:"clearFormat"})}},2509:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFormatState=void 0;var n=r(9033),o=r(8871);t.getFormatState=function(e){var t=e.getPendingFormat(),r=e.getSnapshotsManager(),a={canUndo:r.hasNewContent||r.canMove(-1),canRedo:r.canMove(1),isDarkMode:e.isDarkMode()};return e.formatContentModel((function(e){return(0,o.retrieveModelFormatState)(e,t,a),!1}),void 0,{processorOverride:{child:n.reducedModelChildProcessor},tryGetFromCache:!0}),a}},3775:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustImageSelection=void 0;var n=r(982);t.adjustImageSelection=function(e){var t=null;return e.formatContentModel((function(e){return(0,n.adjustSegmentSelection)(e,(function(e){return!(!e.isSelected||"Image"!=e.segmentType||(t=e,0))}),(function(e,t){return e==t}))}),{apiName:"adjustImageSelection"}),t}},6758:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeImage=void 0;var n=r(3152),o=r(8871);t.changeImage=function(e,t){e.focus();var r=e.getDOMSelection();(0,o.readFile)(t,(function(t){t&&!e.isDisposed()&&"image"===(null==r?void 0:r.type)&&(0,n.formatImageWithContentModel)(e,"changeImage",(function(n){var a,i,l=null!==(i=null===(a=(0,o.updateImageMetadata)(n))||void 0===a?void 0:a.src)&&void 0!==i?i:"",s=n.src;n.src=t,n.dataset={},n.format.width="",n.format.height="",n.alt="",e.triggerEvent("editImage",{image:r.image,previousSrc:s,newSrc:t,originalSrc:l})}))}))}},2549:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertImage=void 0;var n=r(8871);function o(e,t){e.formatContentModel((function(e,r){var o=(0,n.createImage)(t,{backgroundColor:""}),a=(0,n.createContentModelDocument)();return(0,n.addSegment)(a,o),(0,n.mergeModel)(e,a,r,{mergeFormat:"mergeAll"}),o.isSelected=!0,(0,n.setSelection)(e,o),!0}),{apiName:"insertImage"})}t.insertImage=function(e,t){e.focus(),"string"==typeof t?o(e,t):(0,n.readFile)(t,(function(t){t&&!e.isDisposed()&&o(e,t)}))}},5040:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setImageAltText=void 0;var n=r(3152);t.setImageAltText=function(e,t){e.focus(),(0,n.formatImageWithContentModel)(e,"setImageAltText",(function(e){e.alt=t}))}},9782:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setImageBorder=void 0;var n=r(3446),o=r(3152);t.setImageBorder=function(e,t,r){e.focus(),(0,o.formatImageWithContentModel)(e,"setImageBorder",(function(e){(0,n.applyImageBorderFormat)(e,t,r)}))}},7017:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setImageBoxShadow=void 0;var n=r(3152);t.setImageBoxShadow=function(e,t,r){e.focus(),(0,n.formatImageWithContentModel)(e,"setImageBoxShadow",(function(e){e.format.boxShadow=t,r?(e.format.marginBottom=r,e.format.marginLeft=r,e.format.marginRight=r,e.format.marginTop=r):null===r&&(delete e.format.marginBottom,delete e.format.marginLeft,delete e.format.marginRight,delete e.format.marginTop)}))}},3657:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustLinkSelection=void 0;var n=r(982),o=r(2737),a=r(8871);t.adjustLinkSelection=function(e){var t="",r=null;return e.formatContentModel((function(e){var i,l,s=(0,n.adjustSegmentSelection)(e,(function(e){return!!e.isSelected&&!!e.link}),(function(e,t){return!!e.link&&e.link.format.href==t.link.format.href})),c=(0,a.getSelectedSegments)(e,!1),u=c[0];return 1==c.length&&"SelectionMarker"==u.segmentType&&(c=(0,o.adjustWordSelection)(e,u)).length>1&&(s=!0,(0,a.setSelection)(e,c[0],c[c.length-1])),t=c.map((function(e){return"Text"==e.segmentType?e.text:""})).join(""),r=(null===(l=null===(i=c[0])||void 0===i?void 0:i.link)||void 0===l?void 0:l.format.href)||null,s}),{apiName:"adjustLinkSelection"}),[t,r]}},5854:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertLink=void 0;var n=r(7582),o=r(9087),a=r(6089),i=r(8871),l=/^[a-zA-Z]+:/i,s=/^[\w.%+-]+@/i,c=/^ftp\./i;t.insertLink=function(e,t,r,d,f){e.focus();var p=(function(e){return e.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?"":e}(t)||"").trim();if(p){var m,h=(0,a.matchLink)(p),g=h?h.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(l)<0&&(t=0==e.search(s)?"mailto:":0==e.search(c)?"ftp://":"http://"),t+e}(p),v=[];e.formatContentModel((function(t,a){var l,s=(0,i.getSelectedSegments)(t,!1),c=s.map((function(e){return"Text"==e.segmentType?e.text:""})).join(""),m=d||c||"";if(s.some((function(e){return"SelectionMarker"!=e.segmentType}))&&c==m)s.forEach((function(e){var t=u(g,r,f,"Text"==e.segmentType);(0,i.addLink)(e,t),e.link&&v.push(e.link)}));else if(s.every((function(e){return"SelectionMarker"==e.segmentType}))||m&&m!=c){var b=(0,i.createText)(m||(h?h.originalUrl:p),(0,n.__assign)((0,n.__assign)({},null===(l=s[0])||void 0===l?void 0:l.format),e.getPendingFormat())),y=(0,i.createContentModelDocument)(),S=u(g,r,f);(0,i.addLink)(b,S),(0,i.addSegment)(y,b),b.link&&v.push(b.link),(0,i.mergeModel)(t,y,a,{mergeFormat:"mergeAll"})}return(0,o.adjustTrailingSpaceSelection)(t),s.length>0}),{changeSource:i.ChangeSource.CreateLink,onNodeCreated:function(e,t){!m&&v.indexOf(e)>=0&&(m=t)},getChangeData:function(){return m},apiName:"insertLink"})}};var u=function(e,t,r,n){return void 0===n&&(n=!0),{dataset:{},format:{href:e,anchorTitle:t,target:r,underline:n}}}},5972:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeLink=void 0;var n=r(982),o=r(8871);t.removeLink=function(e){e.focus(),e.formatContentModel((function(e){(0,n.adjustSegmentSelection)(e,(function(e){return!!e.isSelected&&!!e.link}),(function(e,t){return e.isSelected||!!e.link&&e.link.format.href==t.link.format.href}));var t=(0,o.getSelectedSegments)(e,!1),r=!1;return t.forEach((function(e){e.link&&(r=!0,delete e.link)})),r}),{apiName:"removeLink"})}},6916:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setListStartNumber=void 0;var n=r(6254);t.setListStartNumber=function(e,t){e.focus(),e.formatContentModel((function(e){return(0,n.setModelListStartNumber)(e,t)}),{apiName:"setListStartNumber"})}},8907:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setListStyle=void 0;var n=r(5848);t.setListStyle=function(e,t){e.focus(),e.formatContentModel((function(e){return(0,n.setModelListStyle)(e,t)}),{apiName:"setListStyle"})}},7655:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleBullet=void 0;var n=r(9689);t.toggleBullet=function(e,t){void 0===t&&(t=!1),e.focus(),e.formatContentModel((function(e,r){return r.newPendingFormat="preserve",(0,n.setListType)(e,"UL",t)}),{apiName:"toggleBullet"})}},6320:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleNumbering=void 0;var n=r(9689);t.toggleNumbering=function(e,t){void 0===t&&(t=!1),e.focus(),e.formatContentModel((function(e,r){return r.newPendingFormat="preserve",(0,n.setListType)(e,"OL",t)}),{apiName:"toggleNumbering"})}},1089:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applySegmentFormat=void 0;var n=r(6648);t.applySegmentFormat=function(e,t){(0,n.formatSegmentWithContentModel)(e,"applySegmentFormat",(function(e){e.backgroundColor=t.backgroundColor,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontWeight=t.fontWeight,e.italic=t.italic,e.strikethrough=t.strikethrough,e.superOrSubScriptSequence=t.superOrSubScriptSequence,e.textColor=t.textColor,e.underline=t.underline}),void 0,!0)}},3870:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeCapitalization=void 0;var n=r(6648);t.changeCapitalization=function(e,t,r){e.focus(),(0,n.formatSegmentWithContentModel)(e,"changeCapitalization",(function(e,n,o){if("Text"==(null==o?void 0:o.segmentType))switch(t){case"lowerCase":o.text=o.text.toLocaleLowerCase(r);break;case"upperCase":o.text=o.text.toLocaleUpperCase(r);break;case"capitalize":for(var a=o.text.toLocaleLowerCase(r).split(" "),i=0;i<a.length;i++)a[i]=a[i].charAt(0).toLocaleUpperCase(r)+a[i].slice(1);o.text=a.join(" ");break;case"sentence":var l=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");o.text=o.text.toLocaleLowerCase(r).replace(l,(function(e){return e.toLocaleUpperCase(r)}))}}))}},6385:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeFontSize=void 0;var n=r(6648),o=r(8871),a=r(9316),i=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];t.changeFontSize=function(e,t){e.focus(),(0,n.formatSegmentWithContentModel)(e,"changeFontSize",(function(e,r,n,l){return function(e,t,r){if(t.fontSize){var n=(0,o.parseValueWithUnit)(t.fontSize,void 0,"pt");if(n>0){var l=function(e,t,r){e=1==t?Math.floor(e):Math.ceil(e);var n=r[r.length-1];if(e<=r[0])e=Math.max(e+t,1);else if(e>n||e==n&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),n),1e3);else if(1==t){for(var o=0;o<r.length;o++)if(e<r[o]){e=r[o];break}}else for(o=r.length-1;o>=0;o--)if(e>r[o]){e=r[o];break}return e}(n,"increase"==e?1:-1,i);(0,a.setFontSizeInternal)(l+"pt",t,r)}}}(t,e,l)}),void 0,!0)}},5707:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setBackgroundColor=void 0;var n=r(8871),o=r(6648);t.setBackgroundColor=function(e,t){e.focus();var r=null,a=-1;(0,o.formatSegmentWithContentModel)(e,"setBackgroundColor",(function(e,n,o,i){null===t?delete e.backgroundColor:e.backgroundColor=t,o&&i&&"SelectionMarker"!=o.segmentType&&(a=(r=i).segments.indexOf(o))}),void 0,void 0,(function(e){var t;if(r&&a>=0){var o=(0,n.createSelectionMarker)(null===(t=r.segments[a])||void 0===t?void 0:t.format);r.segments.splice(a+1,0,o),(0,n.setSelection)(e,o,o)}}))}},8151:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFontName=void 0;var n=r(6648);t.setFontName=function(e,t){e.focus(),(0,n.formatSegmentWithContentModel)(e,"setFontName",(function(e,r,n){e.fontFamily=t,(null==n?void 0:n.code)&&(n.code.format.fontFamily=t)}),void 0,!0)}},9316:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFontSizeInternal=t.setFontSize=void 0;var n=r(6648);function o(e,t,r){var n;if(t.fontSize=e,null===(n=null==r?void 0:r.segmentFormat)||void 0===n?void 0:n.fontSize){var o=r.segmentFormat.fontSize;r.segments.forEach((function(e){e.format.fontSize||(e.format.fontSize=o)})),delete r.segmentFormat.fontSize}}t.setFontSize=function(e,t){e.focus(),(0,n.formatSegmentWithContentModel)(e,"setFontSize",(function(e,r,n,a){return o(t,e,a)}),void 0,!0)},t.setFontSizeInternal=o},6268:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTextColor=void 0;var n=r(6648);t.setTextColor=function(e,t){e.focus(),(0,n.formatSegmentWithContentModel)(e,"setTextColor",null===t?function(e,t,r){delete e.textColor,(null==r?void 0:r.link)&&delete r.link.format.textColor}:function(e,r,n){e.textColor=t,(null==n?void 0:n.link)&&(n.link.format.textColor=t)},void 0,!0)}},9176:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleBold=void 0;var n=r(6648),o=r(8871);t.toggleBold=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleBold",(function(e,t){e.fontWeight=t?"bold":"normal"}),(function(e,t,r){var n;return(0,o.isBold)(void 0===e.fontWeight?null===(n=null==r?void 0:r.decorator)||void 0===n?void 0:n.format.fontWeight:e.fontWeight)}))}},7311:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleCode=void 0;var n=r(8871),o=r(6648),a={format:{fontFamily:"monospace"}};t.toggleCode=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleCode",(function(e,t,r){r&&(t?(0,n.addCode)(r,a):delete r.code)}),(function(e,t){return!!(null==t?void 0:t.code)}))}},6053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleItalic=void 0;var n=r(6648);t.toggleItalic=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleItalic",(function(e,t){e.italic=!!t}),(function(e){return!!e.italic}))}},8398:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleStrikethrough=void 0;var n=r(6648);t.toggleStrikethrough=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleStrikethrough",(function(e,t){e.strikethrough=!!t}),(function(e){return!!e.strikethrough}))}},8356:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleSubscript=void 0;var n=r(6648);t.toggleSubscript=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleSubscript",(function(e,t){e.superOrSubScriptSequence=t?"sub":""}),(function(e){var t;return"sub"==(null===(t=e.superOrSubScriptSequence)||void 0===t?void 0:t.split(" ").pop())}))}},79:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleSuperscript=void 0;var n=r(6648);t.toggleSuperscript=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleSuperscript",(function(e,t){e.superOrSubScriptSequence=t?"super":""}),(function(e){var t;return"super"==(null===(t=e.superOrSubScriptSequence)||void 0===t?void 0:t.split(" ").pop())}))}},1538:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleUnderline=void 0;var n=r(9087),o=r(6648);t.toggleUnderline=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleUnderline",(function(e,t,r){e.underline=!!t,(null==r?void 0:r.link)&&(r.link.format.underline=!!t)}),(function(e,t){var r,n;return!!e.underline||!!(null===(n=null===(r=null==t?void 0:t.link)||void 0===r?void 0:r.format)||void 0===n?void 0:n.underline)}),!1,n.adjustTrailingSpaceSelection)}},7290:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyTableBorderFormat=void 0;var n=r(7582),o=r(8871);function a(e,t,r){r.forEach((function(r){e.format[r]=t})),(0,o.updateTableCellMetadata)(e,(function(e){return(e=e||{}).borderOverride=!0,e})),delete e.cachedElement}t.applyTableBorderFormat=function(e,t,r){e.formatContentModel((function(e){var i=(0,n.__read)((0,o.getFirstSelectedTable)(e),1)[0];if(i){var l=(0,o.getSelectedCells)(i),s={Top:!1,Bottom:!1,Left:!1,Right:!1},c="",u=i.format,d=t.width,f=t.style,p=t.color,m=(0,o.extractBorderValues)(u.borderTop),h=m.color,g=m.width,v=m.style;c=d?(0,o.parseValueWithUnit)(d)+"px":g||"1px",f?c=c+" "+f:v?c=c+" "+v:c+=" solid",p?c=c+" "+p:h&&(c=c+" "+h);var b="rtl"==i.format.direction;if(l){for(var y=[r];y.length;)switch(y.pop()){case"noBorders":c="",y.push("allBorders");break;case"allBorders":for(var S=["borderTop","borderBottom","borderLeft","borderRight"],C=l.firstRow;C<=l.lastRow;C++)for(var _=l.firstColumn;_<=l.lastColumn;_++)a(i.rows[C].cells[_],c,S);s.Top=!0,s.Bottom=!0,s.Left=!0,s.Right=!0;break;case"leftBorders":var T=["borderLeft"];for(C=l.firstRow;C<=l.lastRow;C++)a(i.rows[C].cells[b?l.lastColumn:l.firstColumn],c,T);b?s.Right=!0:s.Left=!0;break;case"rightBorders":var E=["borderRight"];for(C=l.firstRow;C<=l.lastRow;C++)a(i.rows[C].cells[b?l.firstColumn:l.lastColumn],c,E);b?s.Left=!0:s.Right=!0;break;case"topBorders":var M=["borderTop"];for(_=l.firstColumn;_<=l.lastColumn;_++)a(i.rows[l.firstRow].cells[_],c,M);s.Top=!0;break;case"bottomBorders":var k=["borderBottom"];for(_=l.firstColumn;_<=l.lastColumn;_++)a(i.rows[l.lastRow].cells[_],c,k);s.Bottom=!0;break;case"insideBorders":var O=l.lastColumn==l.firstColumn,P=l.lastRow==l.firstRow;if(O&&P)break;if(O){for(a(i.rows[l.firstRow].cells[l.firstColumn],c,["borderBottom"]),C=l.firstRow+1;C<=l.lastRow-1;C++)a(i.rows[C].cells[l.firstColumn],c,["borderTop","borderBottom"]);a(i.rows[l.lastRow].cells[l.firstColumn],c,["borderTop"]);break}if(P){for(a(i.rows[l.firstRow].cells[b?l.lastColumn:l.firstColumn],c,["borderRight"]),_=l.firstColumn+1;_<=l.lastColumn-1;_++)a(i.rows[l.firstRow].cells[_],c,["borderLeft","borderRight"]);a(i.rows[l.firstRow].cells[b?l.firstColumn:l.lastColumn],c,["borderLeft"]);break}for(a(i.rows[l.firstRow].cells[b?l.lastColumn:l.firstColumn],c,["borderBottom","borderRight"]),a(i.rows[l.firstRow].cells[b?l.firstColumn:l.lastColumn],c,["borderBottom","borderLeft"]),a(i.rows[l.lastRow].cells[b?l.lastColumn:l.firstColumn],c,["borderTop","borderRight"]),a(i.rows[l.lastRow].cells[b?l.firstColumn:l.lastColumn],c,["borderTop","borderLeft"]),_=l.firstColumn+1;_<l.lastColumn;_++)a(i.rows[l.firstRow].cells[_],c,["borderBottom","borderLeft","borderRight"]);for(_=l.firstColumn+1;_<l.lastColumn;_++)a(i.rows[l.lastRow].cells[_],c,["borderTop","borderLeft","borderRight"]);for(C=l.firstRow+1;C<l.lastRow;C++)a(i.rows[C].cells[l.firstColumn],c,["borderTop","borderBottom",b?"borderLeft":"borderRight"]);for(C=l.firstRow+1;C<l.lastRow;C++)a(i.rows[C].cells[l.lastColumn],c,["borderTop","borderBottom",b?"borderRight":"borderLeft"]);l.firstColumn++,l.firstRow++,l.lastColumn--,l.lastRow--,y.push("allBorders");break;case"outsideBorders":y.push("topBorders"),y.push("bottomBorders"),y.push("leftBorders"),y.push("rightBorders")}!function(e,t,r,n,o){if(n.Top&&t.firstRow-1>=0)for(var i=t.firstColumn;i<=t.lastColumn;i++)a(e.rows[t.firstRow-1].cells[i],r,["borderBottom"]);if(n.Bottom&&t.lastRow+1<e.rows.length)for(i=t.firstColumn;i<=t.lastColumn;i++)a(e.rows[t.lastRow+1].cells[i],r,["borderTop"]);if(n.Left&&t.firstColumn-1>=0)for(var l=t.firstRow;l<=t.lastRow;l++)a(e.rows[l].cells[t.firstColumn-1],r,[o?"borderLeft":"borderRight"]);if(n.Right&&t.lastColumn+1<e.rows[0].cells.length)for(l=t.firstRow;l<=t.lastRow;l++)a(e.rows[l].cells[t.lastColumn+1],r,[o?"borderRight":"borderLeft"])}(i,l,c,s,b)}return!0}return!1}),{apiName:"tableBorder"})}},5325:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.editTable=void 0;var n=r(8108),o=r(3465),a=r(4794),i=r(5078),l=r(821),s=r(9281),c=r(3353),u=r(1254),d=r(8402),f=r(2447),p=r(9052),m=r(1286),h=r(7298);t.editTable=function(e,t){e.focus(),function(e){if(e.getEnvironment().isSafari){var t=e.getDOMSelection();"range"!=(null==t?void 0:t.type)||t.range.collapsed||(t.range.collapse(!0),e.setDOMSelection({type:"range",range:t.range,isReverted:!1}))}}(e),(0,l.formatTableWithContentModel)(e,"editTable",(function(e){switch(t){case"alignCellLeft":case"alignCellCenter":case"alignCellRight":(0,h.alignTableCellHorizontally)(e,t);break;case"alignCellTop":case"alignCellMiddle":case"alignCellBottom":(0,h.alignTableCellVertically)(e,t);break;case"alignCenter":case"alignLeft":case"alignRight":(0,n.alignTable)(e,t);break;case"deleteColumn":(0,a.deleteTableColumn)(e);break;case"deleteRow":(0,i.deleteTableRow)(e);break;case"deleteTable":(0,o.deleteTable)(e);break;case"insertAbove":case"insertBelow":(0,c.insertTableRow)(e,t);break;case"insertLeft":case"insertRight":(0,s.insertTableColumn)(e,t);break;case"mergeAbove":case"mergeBelow":(0,f.mergeTableRow)(e,t);break;case"mergeCells":(0,u.mergeTableCells)(e);break;case"mergeLeft":case"mergeRight":(0,d.mergeTableColumn)(e,t);break;case"splitHorizontally":(0,p.splitTableCellHorizontally)(e);break;case"splitVertically":(0,m.splitTableCellVertically)(e)}}))}},5844:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatTable=void 0;var n=r(7582),o=r(8871);t.formatTable=function(e,t,r){e.focus(),e.formatContentModel((function(e){var a=(0,n.__read)((0,o.getFirstSelectedTable)(e),1)[0];return!!a&&(a.rows.forEach((function(e){e.cells.forEach((function(e){(0,o.updateTableCellMetadata)(e,(function(e){return e&&delete e.borderOverride,e}))}))})),(0,o.applyTableFormat)(a,t,r),!0)}),{apiName:"formatTable"})}},113:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertTable=void 0;var n=r(8046),o=r(8871);t.insertTable=function(e,t,r,a){e.focus(),e.formatContentModel((function(i,l){var s,c,u,d=(0,o.deleteSelection)(i,[],l).insertPoint;if(d){var f=(0,o.createContentModelDocument)(),p=(0,n.createTableStructure)(f,t,r);(0,o.normalizeTable)(p,e.getPendingFormat()||d.marker.format),a=a||{verticalAlign:"top"},(0,o.applyTableFormat)(p,a),(0,o.mergeModel)(i,f,l,{insertPosition:d,mergeFormat:"mergeAll"});var m=null===(c=null===(s=p.rows[0])||void 0===s?void 0:s.cells[0])||void 0===c?void 0:c.blocks[0];if("Paragraph"==(null==m?void 0:m.blockType)){var h=(0,o.createSelectionMarker)(null===(u=m.segments[0])||void 0===u?void 0:u.format);m.segments.unshift(h),(0,o.setSelection)(i,h)}return!0}return!1}),{apiName:"insertTable"})}},9587:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTableCellShade=void 0;var n=r(7582),o=r(8871);t.setTableCellShade=function(e,t){e.focus(),e.formatContentModel((function(e){var r=(0,n.__read)((0,o.getFirstSelectedTable)(e),1)[0];return!!r&&((0,o.normalizeTable)(r),r.rows.forEach((function(e){return e.cells.forEach((function(e){(0,o.hasSelectionInBlockGroup)(e)&&(0,o.setTableCellBackgroundColor)(e,t,!0)}))})),!0)}),{apiName:"setTableCellShade"})}},3152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatImageWithContentModel=void 0;var n=r(6648);t.formatImageWithContentModel=function(e,t,r){(0,n.formatSegmentWithContentModel)(e,t,(function(e,t,n){"Image"==(null==n?void 0:n.segmentType)&&r(n)}),void 0,void 0)}},6250:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatInsertPointWithContentModel=void 0;var n=r(7582),o=r(8871);function a(e){return function(t,r,n){var a=n;a.path=a.path||[];var l=!1;a.path[0]!=t&&(a.path.unshift(t),l=!0);for(var s=c(n,e,r),u=0,d=r.firstChild;d;d=d.nextSibling)i(e,u,n,t,s,r),(0,o.processChildNode)(t,d,n),u++;i(e,u,n,t,s,r),l&&a.path.shift()}}function i(e,t,r,n,o,a){t==o[2]&&(t<=o[0]||o[0]<0)&&(t<o[1]||o[1]<0)&&(s(n,r,a,t,e),o[2]=-1),t==o[0]&&(r.isInSelection=!0,s(n,r,a,t)),t==o[2]&&(t<o[1]||o[1]<0)&&(s(n,r,a,t,e),o[2]=-1),t==o[1]&&(s(n,r,a,t),r.isInSelection=!1),t==o[2]&&s(n,r,a,t,e)}t.formatInsertPointWithContentModel=function(e,t,r,n){var o={input:t};e.formatContentModel((function(e,t){if(r(e,t,o.result),null==o?void 0:o.result){var n=o.result,a=n.paragraph,i=n.marker,l=a.segments.indexOf(i);l>=0&&a.segments.splice(l,1)}return!0}),n,{processorOverride:{child:a(o),textWithSelection:l(o)},tryGetFromCache:!1})};var l=function(e){return function(t,r,a){var i=r.nodeValue||"",l=c(a,e,r),u=(0,n.__read)(l,3),d=u[0],f=u[1],p=u[2],m=function(e,n,c){(0,o.addTextSegment)(t,i.substring(0,e),a),s(t,a,r,n,c),l[0]-=e,l[1]-=e,l[2]=c?-1:l[2]-e,i=i.substring(e)};l[2]>=0&&(l[2]<=l[0]||l[0]<0)&&(l[2]<l[1]||l[1]<0)&&m(l[2],p,e),l[0]>=0&&(m(l[0],d),a.isInSelection=!0),l[2]>=0&&l[2]>l[0]&&(l[2]<l[1]||l[1]<0)&&m(l[2],p,e),l[1]>=0&&(m(l[1],f),a.isInSelection=!1),l[2]>=0&&l[2]>=l[1]&&m(l[2],p,e),(0,o.addTextSegment)(t,i,a)}};function s(e,t,r,a,i){var l=(0,o.buildSelectionMarker)(e,t,r,a);l.isSelected=!i;var s=(0,o.addSegment)(e,l,t.blockFormat,l.format);i&&t.path&&(i.result={path:(0,n.__spreadArray)([],(0,n.__read)(t.path),!1),paragraph:s,marker:l})}function c(e,t,r){var a=(0,n.__read)((0,o.getRegularSelectionOffsets)(e,r),2);return[a[0],a[1],t.input.node==r?t.input.offset:-1]}},4890:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatParagraphWithContentModel=void 0;var n=r(8871);t.formatParagraphWithContentModel=function(e,t,r){e.formatContentModel((function(e,t){var o=(0,n.getSelectedParagraphs)(e);return o.forEach(r),t.newPendingFormat="preserve",o.length>0}),{apiName:t})}},6648:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatSegmentWithContentModel=void 0;var n=r(7582),o=r(2737),a=r(8871);t.formatSegmentWithContentModel=function(e,t,r,i,l,s){e.formatContentModel((function(t,c){var u=(0,a.getSelectedSegmentsAndParagraphs)(t,!!l),d=1==u.length&&"SelectionMarker"==u[0][0].segmentType;if(d){var f=u[0][1],p=u[0][2];(u=(0,o.adjustWordSelection)(t,u[0][0]).map((function(e){return[e,f,p]}))).length>1&&(d=!1)}var m=u.map((function(e){return[e[0].format,e[0],e[1]]})),h=!!i&&m.every((function(e){var t=(0,n.__read)(e,3),r=t[0],o=t[1],a=t[2];return i(r,o,a)}));return m.forEach((function(e){var t=(0,n.__read)(e,3),o=t[0],a=t[1],i=t[2];return r(o,!h,a,i)})),null==s||s(t),d?(c.newPendingFormat=u[0][0].format,e.focus(),!1):m.length>0}),{apiName:t})}},821:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatTableWithContentModel=void 0;var n=r(7582),o=r(597),a=r(8871);t.formatTableWithContentModel=function(e,t,r,i){e.formatContentModel((function(e){var t=(0,n.__read)((0,a.getFirstSelectedTable)(e),2),i=t[0],l=t[1];if(i){if(r(i),!(0,a.hasSelectionInBlock)(i)){var s=(0,o.ensureFocusableParagraphForTable)(e,l,i);if(s){var c=(0,a.createSelectionMarker)(e.format);s.segments.unshift(c),(0,a.setParagraphNotImplicit)(s),(0,a.setSelection)(e,c)}}return(0,a.normalizeTable)(i,e.format),(0,a.hasMetadata)(i)&&(0,a.applyTableFormat)(i,void 0,!0),!0}return!1}),{apiName:t,selectionOverride:i})}},9082:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatTextSegmentBeforeSelectionMarker=void 0;var n=r(8871);t.formatTextSegmentBeforeSelectionMarker=function(e,t,r){var o=!1;return e.formatContentModel((function(e,r){var a=(0,n.getSelectedSegmentsAndParagraphs)(e,!1);if(a.length>0&&a[0][1]){var i=a[0][0],l=a[0][1],s=l.segments.indexOf(i);if("SelectionMarker"===i.segmentType&&s>0){var c=l.segments[s-1];if(c&&"Text"===c.segmentType)return o=!0,t(e,c,l,i.format,r)}}return!1}),r),o}},4013:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertInlineCss=t.retrieveCssRules=void 0;var n=r(7582),o=r(8871);t.retrieveCssRules=function(e){var t=(0,o.toArray)(e.querySelectorAll("style")),r=[];return t.forEach((function(e){for(var t,n,o=e.sheet,a=0;a<o.cssRules.length;a++){var i=o.cssRules[a];i.type==CSSRule.STYLE_RULE&&i.selectorText&&r.push({selectors:(n=i.selectorText,n.split(/(?![^(]*\)),/).map((function(e){return e.trim()}))),text:i.style.cssText})}null===(t=e.parentNode)||void 0===t||t.removeChild(e)})),r},t.convertInlineCss=function(e,t){for(var r=function(r){var a,i,l=t[r],s=l.selectors,c=l.text;try{for(var u=(a=void 0,(0,n.__values)(s)),d=u.next();!d.done;d=u.next()){var f=d.value;f&&f.trim()&&(0,o.toArray)(e.querySelectorAll(f)).forEach((function(e){return e.setAttribute("style",c+(e.getAttribute("style")||""))}))}}catch(e){a={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(a)throw a.error}}},a=t.length-1;a>=0;a--)r(a)}},4650:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDomToModelContextForSanitizing=void 0;var n=r(7582),o=r(351),a=r(8871),i=r(59),l=r(612),s=r(4370),c=r(3311),u=r(5452),d=r(3046),f={processorOverride:{},formatParserOverride:{},additionalFormatParsers:{},additionalAllowedTags:[],additionalDisallowedTags:[],styleSanitizers:{},attributeSanitizers:{}};t.createDomToModelContextForSanitizing=function(e,t,r,p){var m=(0,n.__assign)((0,n.__assign)({},f),p);return(0,a.createDomToModelContext)((0,n.__assign)({defaultFormat:t},(0,s.getRootComputedStyleForContext)(e)),r,{processorOverride:{"#text":d.pasteTextProcessor,entity:(0,i.createPasteEntityProcessor)(m),"*":(0,l.createPasteGeneralProcessor)(m)},formatParserOverride:{display:u.pasteDisplayFormatParser},additionalFormatParsers:{container:[o.containerSizeFormatParser],entity:[c.pasteBlockEntityParser]}},m)}},300:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createModelFromHtml=void 0;var n=r(4013),o=r(4650),a=r(8871);t.createModelFromHtml=function(e,t,r,i){var l,s=e?(new DOMParser).parseFromString(null!==(l=null==r?void 0:r(e))&&void 0!==l?l:e,"text/html"):null;if(null==s?void 0:s.body){var c=(0,o.createDomToModelContextForSanitizing)(s,i,void 0,t),u=s?(0,n.retrieveCssRules)(s):[];return(0,n.convertInlineCss)(s,u),(0,a.parseFormat)(s.body,c.formatParsers.segmentOnBlock,c.segmentFormat,c),(0,a.domToContentModel)(s.body,c)}return(0,a.createEmptyModel)(i)}},341:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSanitizedElement=t.sanitizeElement=t.DisallowedTags=t.AllowedTags=void 0;var n=r(8871);t.AllowedTags=["a","abbr","address","area","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","fieldset","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","menu","menuitem","meter","nav","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","small","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","tt","u","ul","var","wbr","xmp"],t.DisallowedTags=["applet","audio","base","basefont","embed","frame","frameset","iframe","link","meta","noscript","object","param","script","slot","source","style","template","title","track","video"];var o=/^\s*var\(\s*[a-zA-Z0-9-_]+\s*(,\s*(.*))?\)\s*$/,a="var(",i=["accept","align","alt","checked","cite","class","color","cols","colspan","contextmenu","coords","datetime","default","dir","dirname","disabled","download","face","headers","height","hidden","high","href","hreflang","ismap","kind","label","lang","list","low","max","maxlength","media","min","multiple","open","optimum","pattern","placeholder","readonly","rel","required","reversed","rows","rowspan","scope","selected","shape","size","sizes","span","spellcheck","src","srclang","srcset","start","step","style","tabindex","target","title","translate","type","usemap","valign","value","width","wrap","bgColor"],l={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none","font-style":"normal","font-variant-ligatures":"normal","font-variant-caps":"normal","font-weight":"400","letter-spacing":"normal",orphans:"2","text-align":"start","text-indent":"0px","text-transform":"none",widows:"2","word-spacing":"0px","white-space":"normal"};function s(e,t,r,n,o){for(var a=e.createElement(t),l=0;l<r.length;l++){var s=r[l],u=s.name.toLowerCase().trim(),d=s.value,f=null==o?void 0:o[u],p="style"==u?c(t,d,n):"function"==typeof f?f(d,t):"boolean"==typeof f?f?d:null:i.indexOf(u)>=0||0==u.indexOf("data-")?d:null;null==p||p.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)||a.setAttribute(u,p)}return a}function c(e,t,r){var n=t.split(";"),i=[];return n.forEach((function(t){var n=t.indexOf(":"),s=t.slice(0,n).trim(),c=t.slice(n+1).trim();if(s&&c){(function(e){return 0==e.indexOf(a)})(c)&&(c=function(e){var t=o.exec(e);return(null==t?void 0:t[2])||""}(c));var u=null==r?void 0:r[s],d="function"==typeof u?u(c,e):!1===u?null:c;d&&"inherit"!=d&&"initial"!=d&&d.indexOf("expression")<0&&!s.startsWith("-")&&l[s]!=d&&i.push(s+":"+d)}})),i.join(";")}t.sanitizeElement=function e(t,r,o,a,i){var l=t.tagName.toLowerCase(),c=o.indexOf(l)>=0?null:s(t.ownerDocument,r.indexOf(l)>=0?l:"span",t.attributes,a,i);if(c)for(var u=t.firstChild;u;u=u.nextSibling){var d=(0,n.isNodeOfType)(u,"ELEMENT_NODE")?e(u,r,o,a,i):(0,n.isNodeOfType)(u,"TEXT_NODE")?u.cloneNode():null;d&&(null==c||c.appendChild(d))}return c},t.createSanitizedElement=s},388:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exportContent=void 0;var n=r(8871);t.exportContent=function(e,t,r){if(void 0===t&&(t="HTML"),"PlainTextFast"==t)return e.getDOMHelper().getTextContent();var o=e.getContentModelCopy("clean");if("PlainText"==t)return(0,n.contentModelToText)(o,void 0,r);var a=e.getDocument(),i=a.createElement("div");return(0,n.contentModelToDom)(a,i,o,(0,n.createModelToDomContext)(void 0,r)),e.triggerEvent("extractContentWithDom",{clonedRoot:i},!0),i.innerHTML}},7093:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPasteFragment=void 0;var n=r(8871);t.createPasteFragment=function(e,t,r,o){var a=t.imageDataUri,i=t.text,l=e.createDocumentFragment();if("asImage"==r&&a||"asPlainText"!=r&&!i&&a){var s=e.createElement("img");s.style.maxWidth="100%",s.src=a,l.appendChild(s)}else"asPlainText"!=r&&o?(0,n.moveChildNodes)(l,o):i&&i.split("\n").forEach((function(t,r,o){(t=t.replace(/^ /g," ").replace(/ $/g," ").replace(/\r/g,"").replace(/ {2}/g,"  ")).includes("\t")&&(t=function(e,t){void 0===t&&(t=0);for(var r,n=e;-1!=(r=n.indexOf("\t"));){var o=n.slice(0,r),a=n.slice(r+1),i=6-(o.length+t)%6;n=o+Array(i).fill(" ").join("")+a}return n}(t));var a=e.createTextNode(t);2==o.length&&0==r?(l.appendChild(a),l.appendChild(e.createElement("br"))):r>0&&r<o.length-1?l.appendChild((0,n.wrap)(e,""==t?e.createElement("br"):a,"div")):l.appendChild(a)}));return l}},4637:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generatePasteOptionFromPlugins=void 0,t.generatePasteOptionFromPlugins=function(e,t,r,n,o){var a,i,l={eventType:"beforePaste",clipboardData:t,fragment:r,htmlBefore:null!==(a=n.htmlBefore)&&void 0!==a?a:"",htmlAfter:null!==(i=n.htmlAfter)&&void 0!==i?i:"",htmlAttributes:n.metadata,pasteType:o,domToModelOption:{additionalAllowedTags:[],additionalDisallowedTags:[],additionalFormatParsers:{},formatParserOverride:{},processorOverride:{},styleSanitizers:{},attributeSanitizers:{}}};return"asPlainText"==o?l:e.triggerEvent("beforePaste",l,!0)}},8501:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergePasteContent=t.cloneModelForPaste=void 0;var n=r(7582),o=r(4650),a=r(8871),i={backgroundColor:"",fontFamily:"",fontSize:"",fontWeight:"",italic:!1,letterSpacing:"",lineHeight:"",strikethrough:!1,superOrSubScriptSequence:"",textColor:"",underline:!1},l={includeCachedElement:function(e,t){return"cache"==t?void 0:e}};function s(e){return(0,a.cloneModel)(e,l)}function c(e){return 2==e.blocks.length&&"Table"===e.blocks[0].blockType&&"Paragraph"===e.blocks[1].blockType&&1===e.blocks[1].segments.length&&"Br"===e.blocks[1].segments[0].segmentType&&e.blocks.splice(1),1===e.blocks.length&&"Table"===e.blocks[0].blockType}t.cloneModelForPaste=s,t.mergePasteContent=function(e,t,r){var l=t.fragment,u=t.domToModelOption,d=t.customizedMerge,f=t.pasteType;e.formatContentModel((function(t,p){if(r.modelBeforePaste){var m=s(r.modelBeforePaste);t.blocks=m.blocks}var h=(0,a.getSelectedSegments)(t,!0)[0],g=(0,o.createDomToModelContextForSanitizing)(e.getDocument(),void 0,e.getEnvironment().domToModelSettings.customized,u);g.segmentFormat=h?(0,a.getSegmentTextFormat)(h):{};var v=(0,a.domToContentModel)(l,g),b={mergeFormat:"mergeFormat"==f?"keepSourceEmphasisFormat":"none",mergeTable:c(v)},y=d?d(t,v):(0,a.mergeModel)(t,v,p,b);return y&&(p.newPendingFormat=(0,n.__assign)((0,n.__assign)((0,n.__assign)({},i),t.format),y.marker.format)),!0}),{changeSource:a.ChangeSource.Paste,getChangeData:function(){return r},scrollCaretIntoView:!1,apiName:"paste"})}},710:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paste=void 0;var n=r(8501),o=r(4013),a=r(7093),i=r(4637),l=r(2040);function s(e,t){return e?(new DOMParser).parseFromString(t(e),"text/html"):null}t.paste=function(e,t,r){var c;void 0===r&&(r="normal"),e.focus();var u=e.getTrustedHTMLHandler();t.modelBeforePaste||e.formatContentModel((function(e){return t.modelBeforePaste=(0,n.cloneModelForPaste)(e),!1}));var d=s(t.rawHtml,u),f=(0,l.retrieveHtmlInfo)(d,t),p=(0,a.createPasteFragment)(e.getDocument(),t,r,null===(c=t.rawHtml==t.html?d:s(t.html,u))||void 0===c?void 0:c.body),m=(0,i.generatePasteOptionFromPlugins)(e,t,p,f,r);(0,o.convertInlineCss)(m.fragment,f.globalCssRules),(0,n.mergePasteContent)(e,m,t)}},2040:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveHtmlInfo=void 0;var n=r(7582),o=r(8871),a=r(4013),i="\x3c!--StartFragment--\x3e",l="\x3c!--EndFragment--\x3e";function s(e){var t,r={},n=null===(t=e.querySelector("html"))||void 0===t?void 0:t.attributes;return(n?(0,o.toArray)(n):[]).forEach((function(e){r[e.name]=e.value})),(0,o.toArray)(e.querySelectorAll("meta")).forEach((function(e){r[e.name]=e.content})),r}t.retrieveHtmlInfo=function(e,t){var r={metadata:{},globalCssRules:[]};return e&&(r=(0,n.__assign)((0,n.__assign)({},function(e){var t,r=null!==(t=e.rawHtml)&&void 0!==t?t:"",n=r.indexOf(i),o=r.lastIndexOf(l),a="",s="";return n>=0&&o>=n+20?(a=r.substring(0,n),s=r.substring(o+18),e.html=r.substring(n+20,o)):e.html=r,{htmlBefore:a,htmlAfter:s}}(t)),{globalCssRules:(0,a.retrieveCssRules)(e),metadata:s(e)}),t.htmlFirstLevelChildTags=function(e){for(var t,r=[],n=e.body.firstChild;n;n=n.nextSibling)(0,o.isNodeOfType)(n,"TEXT_NODE")?(null===(t=n.nodeValue)||void 0===t?void 0:t.replace(/(\r\n|\r|\n)/gm,"").trim())&&r.push(""):(0,o.isNodeOfType)(n,"ELEMENT_NODE")&&r.push(n.tagName);return r}(e)),r}},4986:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.redo=void 0,t.redo=function(e){e.focus();var t=e.getSnapshotsManager().move(1);t&&e.restoreSnapshot(t)}},4852:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.undo=void 0,t.undo=function(e){e.focus();var t=e.getSnapshotsManager();t.hasNewContent&&e.takeSnapshot();var r=t.move(-1);r&&e.restoreSnapshot(r)}},145:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addUndoSnapshot=void 0;var n=r(8871),o=r(3731),a=r(6906);t.addUndoSnapshot=function(e,t,r){var i=e.lifecycle,l=e.physicalRoot,s=e.logicalRoot,c=e.undo,u=null;if(!i.shadowEditFragment){var d=(0,o.createSnapshotSelection)(e),f=l.innerHTML;if(s!==l){var p=(0,n.findClosestEntityWrapper)(s,e.domHelper);if(!r&&p){var m=(0,n.parseEntityFormat)(p);if(m.entityType&&m.id){var h={eventType:"entityOperation",operation:"snapshotEntityState",entity:{type:m.entityType,id:m.id,wrapper:p,isReadonly:m.isReadonly},state:void 0};e.api.triggerEvent(e,h,!1),h.state&&(r=[{type:m.entityType,id:m.id,state:h.state}])}}}u={html:f,entityStates:r,isDarkMode:!!i.isDarkMode,selection:d},s!==l&&(u.logicalRootPath=(0,a.getPath)(s,0,l)),c.snapshotsManager.addSnapshot(u,!!t),c.snapshotsManager.hasNewContent=!1}return u}},3731:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSnapshotSelection=void 0;var n=r(8871),o=r(6906);function a(e,t){for(var r=e,o=!1;r&&t.contains(r);)(0,n.isNodeOfType)(r,"ELEMENT_NODE")&&(0,n.isElementOfType)(r,"table")&&(o=i(r)||o),r=r.parentNode;return o}function i(e){for(var t,r=!1,o=null,a=e.firstChild;a;a=a.nextSibling)switch((0,n.isNodeOfType)(a,"ELEMENT_NODE")?a.tagName:null){case"TR":o||(o=e.ownerDocument.createElement("tbody"),e.insertBefore(o,a)),o.appendChild(a),a=o,r=!0;break;case"TBODY":o?((0,n.moveChildNodes)(o,a,!0),null===(t=a.parentNode)||void 0===t||t.removeChild(a),a=o,r=!0):o=a;break;default:o=null}var i=e.querySelectorAll("colgroup"),l=e.querySelector("thead");return l&&i.forEach((function(e){l.contains(e)||l.appendChild(e)})),r}t.createSnapshotSelection=function(e){var t=e.physicalRoot,r=e.api,n=r.getDOMSelection(e);if("range"==(null==n?void 0:n.type)){var i=n.range,l=i.startContainer,s=i.startOffset,c=i.endContainer,u=i.endOffset,d=a(l,t);if(c!=l&&(d=a(c,t)||d),d){var f=t.ownerDocument.createRange();f.setStart(l,s),f.setEnd(c,u),r.setDOMSelection(e,{type:"range",range:f,isReverted:!!n.isReverted},!0)}}switch(null==n?void 0:n.type){case"image":return{type:"image",imageId:n.image.id};case"table":return{type:"table",tableId:n.table.id,firstColumn:n.firstColumn,lastColumn:n.lastColumn,firstRow:n.firstRow,lastRow:n.lastRow};case"range":var p=n.range;return{type:"range",start:(0,o.getPath)(p.startContainer,p.startOffset,t),end:(0,o.getPath)(p.endContainer,p.endOffset,t),isReverted:!!n.isReverted};default:return{type:"range",start:[],end:[],isReverted:!1}}}},6906:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPath=void 0;var n=r(8871);t.getPath=function(e,t,r){var o,a,i,l=[];if(!e||!r.contains(e))return l;if((0,n.isNodeOfType)(e,"TEXT_NODE")){for(i=e.parentNode;e.previousSibling&&(0,n.isNodeOfType)(e.previousSibling,"TEXT_NODE");)t+=(null===(o=e.previousSibling.nodeValue)||void 0===o?void 0:o.length)||0,e=e.previousSibling;l.unshift(t)}else i=e,e=e.childNodes[t];do{t=0;for(var s=!1,c=(null==i?void 0:i.firstChild)||null;c&&c!=e;c=c.nextSibling){if((0,n.isNodeOfType)(c,"TEXT_NODE")){if(0===(null===(a=c.nodeValue)||void 0===a?void 0:a.length)||s)continue;s=!0}else s=!1;t++}l.unshift(t),e=i,i=(null==i?void 0:i.parentNode)||null}while(e&&e!=r);return l}},5219:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.announce=void 0,t.announce=function(e,t){var r,n=t.text,o=t.defaultStrings,a=t.formatStrings,i=void 0===a?[]:a,l=e.lifecycle.announcerStringGetter,s=function(e,t){return null==e||(e=e.replace(/\{(\d+)\}/g,(function(e,r){var n=parseInt(r),o=t[n];return null!=o?o:""}))),e}(o&&(null==l?void 0:l(o))||n,i);if(s){var c=e.lifecycle.announceContainer;c&&s!=c.textContent||(null===(r=null==c?void 0:c.parentElement)||void 0===r||r.removeChild(c),c=function(e){var t=e.createElement("div");return t.style.clip="rect(0px, 0px, 0px, 0px)",t.style.clipPath="inset(100%)",t.style.height="1px",t.style.overflow="hidden",t.style.position="absolute",t.style.whiteSpace="nowrap",t.style.width="1px",t.ariaLive="assertive",e.body.appendChild(t),t}(e.physicalRoot.ownerDocument),e.lifecycle.announceContainer=c),c&&(c.textContent=s)}}},8819:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachDomEvent=void 0;var n=r(8871);t.attachDomEvent=function(e,t){var r=(0,n.getObjectKeys)(t||{}).map((function(r){var n=t[r],o=n.pluginEventType,a=n.beforeDispatch,i=r,l=function(t){a&&a(t),null!=o&&e.api.triggerEvent(e,{eventType:o,rawEvent:t},!1)};return e.logicalRoot.addEventListener(i,l),function(){e.logicalRoot.removeEventListener(i,l)}}));return function(){return r.forEach((function(e){return e()}))}}},4810:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coreApiMap=void 0;var n=r(145),o=r(5219),a=r(8819),i=r(8296),l=r(9470),s=r(5090),c=r(9633),u=r(8109),d=r(8680),f=r(2394),p=r(636),m=r(6276),h=r(4368),g=r(4895),v=r(4488),b=r(1863);t.coreApiMap={createContentModel:i.createContentModel,createEditorContext:l.createEditorContext,formatContentModel:c.formatContentModel,setContentModel:p.setContentModel,setLogicalRoot:g.setLogicalRoot,getDOMSelection:u.getDOMSelection,setDOMSelection:m.setDOMSelection,focus:s.focus,addUndoSnapshot:n.addUndoSnapshot,restoreUndoSnapshot:f.restoreUndoSnapshot,attachDomEvent:a.attachDomEvent,triggerEvent:b.triggerEvent,switchShadowEdit:v.switchShadowEdit,getVisibleViewport:d.getVisibleViewport,setEditorStyle:h.setEditorStyle,announce:o.announce}},8296:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModel=void 0;var n=r(5593),o=r(8871);t.createContentModel=function(e,t,r){var a;if(null===(a=e.cache.textMutationObserver)||void 0===a||a.flushMutations(),!r&&(!t||t.tryGetFromCache)){var i=e.cache.cachedModel;if(i)return e.lifecycle.shadowEditFragment?(0,o.cloneModel)(i,{includeCachedElement:!0}):i}var l="none"==r?void 0:r||e.api.getDOMSelection(e)||void 0,s=!t&&!r,c=e.api.createEditorContext(e,s),u=e.environment.domToModelSettings,d=t?(0,o.createDomToModelContext)(c,u.builtIn,u.customized,t):(0,o.createDomToModelContextWithConfig)(u.calculated,c);l&&(d.selection=l);var f=(0,o.domToContentModel)(e.logicalRoot,d);return s&&(e.cache.cachedModel=f,(0,n.updateCachedSelection)(e.cache,l)),f}},9470:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditorContext=void 0;var n=r(7582),o=r(4370);t.createEditorContext=function(e,t){var r,a=e.lifecycle,i=e.format,l=e.darkColorHandler,s=e.logicalRoot,c=e.cache,u=e.domHelper;t=t&&!e.lifecycle.shadowEditFragment;var d=(0,n.__assign)({isDarkMode:a.isDarkMode,defaultFormat:i.defaultFormat,pendingFormat:null!==(r=i.pendingFormat)&&void 0!==r?r:void 0,darkColorHandler:l,addDelimiterForEntity:!0,allowCacheElement:!0,domIndexer:t?c.domIndexer:void 0,zoomScale:u.calculateZoomScale()},(0,o.getRootComputedStyleForContext)(s.ownerDocument));return e.domHelper.isRightToLeft()&&(d.isRootRtl=!0),d}},4370:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRootComputedStyleForContext=void 0;var n=r(8871);t.getRootComputedStyleForContext=function(e){var t,r=null===(t=e.defaultView)||void 0===t?void 0:t.getComputedStyle(e.documentElement);return{rootFontSize:(0,n.parseValueWithUnit)(null==r?void 0:r.fontSize)||16}}},5090:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.focus=void 0,t.focus=function(e){var t;if(!e.lifecycle.shadowEditFragment){var r=e.api,n=e.domHelper,o=e.selection;n.hasFocus()||"range"!=(null===(t=o.selection)||void 0===t?void 0:t.type)||r.setDOMSelection(e,o.selection,!0),n.hasFocus()||e.logicalRoot.focus()}}},9633:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatContentModel=void 0;var n=r(7582),o=r(8871);function a(e,t,r){var o,a="preserve"==t.newPendingFormat?null===(o=e.format.pendingFormat)||void 0===o?void 0:o.format:t.newPendingFormat;a&&"range"==(null==r?void 0:r.type)&&r.range.collapsed&&(e.format.pendingFormat={format:(0,n.__assign)({},a),insertPoint:{node:r.range.startContainer,offset:r.range.startOffset}})}function i(e,t){return e.newEntities.map((function(e){return{entity:e,operation:"newEntity",rawEvent:t}})).concat(e.deletedEntities.map((function(e){return{entity:e.entity,operation:e.operation,rawEvent:t}})))}t.formatContentModel=function(e,t,r,n){var l,s=r||{},c=s.apiName,u=s.onNodeCreated,d=s.getChangeData,f=s.changeSource,p=s.rawEvent,m=s.selectionOverride,h=s.scrollCaretIntoView,g=e.api.createContentModel(e,n,m),v={newEntities:[],deletedEntities:[],rawEvent:p,newImages:[]},b=e.domHelper.hasFocus(),y=t(g,v),S=v.skipUndoSnapshot,C=v.clearModelCache,_=v.entityStates,T=v.canUndoByBackspace;if(y){var E=e.undo.isNested,M=!S&&!E,k=void 0;M&&(e.undo.isNested=!0,e.api.addUndoSnapshot(e,!!T,_));try{if(function(e,t){if(t.newImages.length>0){var r=e.domHelper.getClientWidth(),n=Math.max(r,10);t.newImages.forEach((function(e){e.format.maxWidth=n+"px"}))}}(e,v),k=null!==(l=e.api.setContentModel(e,g,b?void 0:{ignoreSelection:!0},u))&&void 0!==l?l:void 0,a(e,v,k),k&&h){var O=(0,o.getSelectionRootNode)(k),P=O&&e.domHelper.findClosestElementAncestor(O);null==P||P.scrollIntoView()}var w={eventType:"contentChanged",contentModel:C?void 0:g,selection:C?void 0:k,source:f||o.ChangeSource.Format,data:null==d?void 0:d(),formatApiName:c,changedEntities:i(v,p)};e.api.triggerEvent(e,w,!0),T&&"range"==(null==k?void 0:k.type)&&(e.undo.autoCompleteInsertPoint={node:k.range.startContainer,offset:k.range.startOffset}),M?e.api.addUndoSnapshot(e,!1,_):e.undo.snapshotsManager.hasNewContent=!0}finally{E||(e.undo.isNested=!1)}}else C&&(e.cache.cachedModel=void 0,e.cache.cachedSelection=void 0),a(e,v,e.api.getDOMSelection(e));v.announceData&&e.api.announce(e,v.announceData)}},8109:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDOMSelection=void 0,t.getDOMSelection=function(e){if(e.lifecycle.shadowEditFragment)return null;var t=e.selection.selection;return!t||"range"==t.type&&e.domHelper.hasFocus()?function(e){var t,r=null===(t=e.logicalRoot.ownerDocument.defaultView)||void 0===t?void 0:t.getSelection(),n=r&&r.rangeCount>0?r.getRangeAt(0):null;return r&&n&&e.logicalRoot.contains(n.commonAncestorContainer)?{type:"range",range:n,isReverted:r.focusNode!=n.endContainer||r.focusOffset!=n.endOffset}:null}(e):t}},8680:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVisibleViewport=void 0;var n=r(7582),o=r(8871);t.getVisibleViewport=function(e){var t=e.domEvent.scrollContainer;return function(e,t){void 0===t&&(t=[]);var r=e.map((function(e){return(0,o.normalizeRect)(e.getBoundingClientRect())})).concat(t).filter((function(e){return!!e})),a={top:Math.max.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(r.map((function(e){return e.top}))),!1)),bottom:Math.min.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(r.map((function(e){return e.bottom}))),!1)),left:Math.max.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(r.map((function(e){return e.left}))),!1)),right:Math.min.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(r.map((function(e){return e.right}))),!1))};return a.top<a.bottom&&a.left<a.right?a:null}(t==e.physicalRoot?[t]:[t,e.physicalRoot])}},4038:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPositionFromPath=void 0;var n=r(8871);t.getPositionFromPath=function(e,t){for(var r=0,o=0;o<t.length&&(r=t[o],o<t.length-1&&e&&(0,n.isNodeOfType)(e,"ELEMENT_NODE")&&e.childNodes.length>r);o++)e=e.childNodes[r];return{node:e,offset:r}}},5559:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreSnapshotColors=void 0;var n=r(8871);t.restoreSnapshotColors=function(e,t){var r=e.lifecycle.isDarkMode;e.darkColorHandler.updateKnownColor(r),!!t.isDarkMode!=!!r&&(0,n.transformColor)(e.physicalRoot,!1,r?"lightToDark":"darkToLight",e.darkColorHandler)}},9808:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreSnapshotHTML=void 0;var n=r(8871);function o(e,t){var r=null;return(0,n.isNodeOfType)(t,"ELEMENT_NODE")&&((0,n.isEntityElement)(t)?r=a(e,(0,n.parseEntityFormat)(t).id):(0,n.isBlockEntityContainer)(t)&&(r=function(e,t){for(var r,o=e.firstChild;o;o=o.nextSibling)if((0,n.isEntityElement)(o)&&(0,n.isNodeOfType)(o,"ELEMENT_NODE")){var i=null===(r=a(t,(0,n.parseEntityFormat)(o).id))||void 0===r?void 0:r.parentElement;return(0,n.isNodeOfType)(i,"ELEMENT_NODE")&&(0,n.isBlockEntityContainer)(i)?i:null}return null}(t,e))),r}function a(e,t){var r=t?e[t]:void 0;return(null==r?void 0:r.canPersist)?r.element:null}t.restoreSnapshotHTML=function(e,t){for(var r,a,i,l=e.physicalRoot,s=e.entity.entityMap,c=l.firstChild,u=(new DOMParser).parseFromString(null!==(a=null===(r=e.trustedHTMLHandler)||void 0===r?void 0:r.call(e,t.html))&&void 0!==a?a:t.html,"text/html").body.firstChild;u;){var d=u.nextSibling,f=o(s,u);f?c=(0,n.reuseCachedElement)(l,f,c):(l.insertBefore(u,c),(0,n.isNodeOfType)(u,"ELEMENT_NODE")&&(0,n.getAllEntityWrappers)(u).forEach((function(e){var t,r=o(s,e);if(r){if(r==c){var n=r.cloneNode();l.insertBefore(n,c),c=n}null===(t=e.parentNode)||void 0===t||t.replaceChild(r,e)}}))),u=d}for(;c;)d=c.nextSibling,null===(i=c.parentNode)||void 0===i||i.removeChild(c),c=d}},9912:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreSnapshotLogicalRoot=void 0;var n=r(4038);t.restoreSnapshotLogicalRoot=function(e,t){if(t.logicalRootPath&&t.logicalRootPath.length>0){var r=(0,n.getPositionFromPath)(e.physicalRoot,t.logicalRootPath).node;r!==e.logicalRoot&&e.api.setLogicalRoot(e,r)}else e.api.setLogicalRoot(e,null)}},7233:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreSnapshotSelection=void 0;var n=r(4038);t.restoreSnapshotSelection=function(e,t){var r=t.selection,o=e.physicalRoot,a=null;try{if(r)switch(r.type){case"range":var i=(0,n.getPositionFromPath)(o,r.start),l=(0,n.getPositionFromPath)(o,r.end),s=o.ownerDocument.createRange();s.setStart(i.node,i.offset),s.setEnd(l.node,l.offset),a={type:"range",range:s,isReverted:r.isReverted};break;case"table":var c=o.querySelector("#"+r.tableId);c&&(a={type:"table",table:c,firstColumn:r.firstColumn,firstRow:r.firstRow,lastColumn:r.lastColumn,lastRow:r.lastRow});break;case"image":var u=o.querySelector("#"+r.imageId);u&&(a={type:"image",image:u})}a&&e.api.setDOMSelection(e,a)}catch(e){}}},2394:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreUndoSnapshot=void 0;var n=r(8871),o=r(5559),a=r(9808),i=r(9912),l=r(7233);t.restoreUndoSnapshot=function(e,t){e.api.triggerEvent(e,{eventType:"beforeSetContent",newContent:t.html},!0);try{e.undo.isRestoring=!0,(0,a.restoreSnapshotHTML)(e,t),(0,i.restoreSnapshotLogicalRoot)(e,t),(0,l.restoreSnapshotSelection)(e,t),(0,o.restoreSnapshotColors)(e,t);var r={eventType:"contentChanged",entityStates:t.entityStates,source:n.ChangeSource.SetContent};e.api.triggerEvent(e,r,!1)}finally{e.undo.isRestoring=!1}}},636:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setContentModel=void 0;var n=r(5593),o=r(8871);t.setContentModel=function(e,t,r,a){var i,l=e.api.createEditorContext(e,!0),s=r?(0,o.createModelToDomContext)(l,e.environment.modelToDomSettings.builtIn,e.environment.modelToDomSettings.customized,r):(0,o.createModelToDomContextWithConfig)(e.environment.modelToDomSettings.calculated,l);s.onNodeCreated=a;var c=(0,o.contentModelToDom)(e.logicalRoot.ownerDocument,e.logicalRoot,t,s);return e.lifecycle.shadowEditFragment||((0,n.updateCachedSelection)(e.cache,c||void 0),!(null==r?void 0:r.ignoreSelection)&&c?e.api.setDOMSelection(e,c):e.selection.selection=c,null===(i=e.cache.textMutationObserver)||void 0===i||i.flushMutations(),e.cache.cachedModel=t),c}},3950:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addRangeToSelection=void 0,t.addRangeToSelection=function(e,t,r){var n;void 0===r&&(r=!1);var o=null===(n=e.defaultView)||void 0===n?void 0:n.getSelection();if(o){var a=o.rangeCount>0&&o.getRangeAt(0);if(a&&a.startContainer==t.startContainer&&a.endContainer==t.endContainer&&a.startOffset==t.startOffset&&a.endOffset==t.endOffset)return;o.removeAllRanges(),r?o.setBaseAndExtent(t.endContainer,t.endOffset,t.startContainer,t.startOffset):o.addRange(t)}}},5010:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findLastedCoInMergedCell=void 0,t.findLastedCoInMergedCell=function(e,t){for(var r,n,o,a,i=t.row,l=t.col;i>=0&&l>=0&&i<e.length&&l<(null!==(n=null===(r=e[i])||void 0===r?void 0:r.length)&&void 0!==n?n:0);){var s=null===(o=e[i])||void 0===o?void 0:o[l+1],c=null===(a=e[i+1])||void 0===a?void 0:a[l];if("spanLeft"==s||"spanBoth"==s)l++;else{if("spanTop"!=c&&"spanBoth"!=c)return{row:i,col:l};i++}}return null}},2607:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findTableCellElement=void 0,t.findTableCellElement=function(e,t){for(var r,n,o,a=t.row,i=t.col;a>=0&&i>=0&&a<e.length&&i<(null!==(n=null===(r=e[a])||void 0===r?void 0:r.length)&&void 0!==n?n:0);){var l=null===(o=e[a])||void 0===o?void 0:o[i];if(!l)break;if("object"==typeof l)return{cell:l,row:a,col:i};"spanLeft"==l||"spanBoth"==l?i--:a--}return null}},6276:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setDOMSelection=void 0;var n=r(3950),o=r(9310),a=r(5010),i=r(2607),l=r(8871),s="_DOMSelection",c="_DOMSelectionHideCursor",u="_DOMSelectionHideSelection";function d(e,t,r){var o;if(t&&e.contains(t)){var a=e.createRange(),i=void 0;if(a.selectNode(t),r)a.collapse();else{var l=null===(o=e.defaultView)||void 0===o?void 0:o.getSelection(),s=l&&l.rangeCount>0&&l.getRangeAt(0);l&&s&&(i=l.focusNode!=s.endContainer||l.focusOffset!=s.endOffset)}(0,n.addRangeToSelection)(e,a,i)}}t.setDOMSelection=function(e,t,r){var f,p,m,h=e.selection.skipReselectOnFocus,g=e.physicalRoot.ownerDocument,v=e.lifecycle.isDarkMode;e.selection.skipReselectOnFocus=!0,e.api.setEditorStyle(e,s,null),e.api.setEditorStyle(e,c,null),e.api.setEditorStyle(e,u,null);try{switch(null==t?void 0:t.type){case"image":var b=function(e){var t=e.parentElement;return t&&(0,l.isNodeOfType)(t,"ELEMENT_NODE")&&(0,l.isElementOfType)(t,"span")&&t.firstChild==e&&t.lastChild==e||(0,l.wrap)(e.ownerDocument,e,"span"),e}(t.image);e.selection.selection={type:"image",image:b};var y=v?e.selection.imageSelectionBorderColorDark:e.selection.imageSelectionBorderColor;e.api.setEditorStyle(e,s,"outline-style:auto!important; outline-color:"+y+"!important;",["span:has(>img#"+(0,o.ensureUniqueId)(b,"image")+")"]),e.api.setEditorStyle(e,u,"background-color: transparent !important;",["*::selection"]),d(g,b,!1);break;case"table":var S=t.table,C=t.firstColumn,_=t.firstRow,T=t.lastColumn,E=t.lastRow,M=(0,l.parseTableCells)(t.table),k={row:Math.min(_,E),col:Math.min(C,T),cell:null},O={row:Math.max(_,E),col:Math.max(C,T)};if(k=(0,i.findTableCellElement)(M,k)||k,O=(0,a.findLastedCoInMergedCell)(M,O)||O,isNaN(k.row)||isNaN(k.col)||isNaN(O.row)||isNaN(O.col))return;t={type:"table",table:S,firstRow:k.row,firstColumn:k.col,lastRow:O.row,lastColumn:O.col};var P=(0,o.ensureUniqueId)(S,"table"),w=0==k.row&&0==k.col&&O.row==M.length-1&&O.col==(null!==(p=null===(f=M[O.row])||void 0===f?void 0:f.length)&&void 0!==p?p:0)-1?["#"+P,"#"+P+" *"]:function(e,t,r,n,o){var a=[],i=0,s=(0,l.toArray)(r.childNodes).filter((function(e){return["THEAD","TBODY","TFOOT"].indexOf((0,l.isNodeOfType)(e,"ELEMENT_NODE")?e.tagName:"")>-1})).map((function(e){var t={el:e.tagName,start:i,end:e.childNodes.length+i};return i=t.end,t}));return e.forEach((function(e,r){for(var i=0,l=s.filter((function(e){return e.start<=r&&e.end>r}))[0],c=l?">"+l.el+">":">",u=l&&r+1>=l.start?r+1-l.start:r+1,d=0;d<e.length;d++){var f=e[d];if("object"==typeof f&&(i++,r>=n.row&&r<=o.row&&d>=n.col&&d<=o.col)){var p="#"+t+c+" tr:nth-child("+u+")>"+f.tagName+":nth-child("+i+")";a.push(p,p+" *")}}})),a}(M,P,S,k,O);e.selection.selection=t;var x=v?e.selection.tableCellSelectionBackgroundColorDark:e.selection.tableCellSelectionBackgroundColor;e.api.setEditorStyle(e,s,"background-color:"+x+"!important;",w),e.api.setEditorStyle(e,c,"caret-color: transparent");var D=(null===(m=k.cell)||void 0===m?void 0:m.firstElementChild)||k.cell;D&&d(g,D||void 0,!0);break;case"range":(0,n.addRangeToSelection)(g,t.range,t.isReverted),e.selection.selection=e.domHelper.hasFocus()?null:t;break;default:e.selection.selection=null}}finally{e.selection.skipReselectOnFocus=h}if(!r){var L={eventType:"selectionChanged",newSelection:t};e.api.triggerEvent(e,L,!0)}}},9310:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureUniqueId=void 0,t.ensureUniqueId=function(e,t){t=e.id||t;for(var r=e.ownerDocument,n=0;!e.id||r.querySelectorAll("#"+e.id).length>1;)e.id=t+"_"+n++;return e.id}},4368:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEditorStyle=void 0;var n=r(9310);t.setEditorStyle=function(e,t,r,o,a){void 0===a&&(a=9e3);var i=e.lifecycle.styleElements[t];if(!i&&r){var l=e.physicalRoot.ownerDocument;i=l.createElement("style"),l.head.appendChild(i),i.dataset.roosterjsStyleKey=t,e.lifecycle.styleElements[t]=i}var s=null==i?void 0:i.sheet;if(s){for(var c=s.cssRules.length-1;c>=0;c--)s.deleteRule(c);if(r){var u="#"+(0,n.ensureUniqueId)(e.physicalRoot,"contentDiv"),d=o?"string"==typeof o?[u+"::"+o]:function(e,t,r){var n=[],o=[],a=0;return t.forEach((function(t){a>=r&&(n.push(o.join(",")),o=[],a=0);var i=e+" "+t;a+=i.length+1,o.push(i)})),n.push(o.join(",")),n}(u,o,a-r.length-3):[u];d.forEach((function(e){s.insertRule(e+" {"+r+"}")}))}}}},4895:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setLogicalRoot=void 0,t.setLogicalRoot=function(e,t){if(t&&!e.physicalRoot.contains(t))return null;if(t||(t=e.physicalRoot),t!==e.logicalRoot){e.logicalRoot.contentEditable="false",t.contentEditable="true",e.logicalRoot=t,e.selection.selection=null,e.cache.cachedModel=void 0,e.cache.cachedSelection=void 0;var r={eventType:"logicalRootChanged",logicalRoot:t};e.api.triggerEvent(e,r,!1)}}},4488:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchShadowEdit=void 0;var n=r(8871);t.switchShadowEdit=function(e,t){var r=e;if(t!=!!r.lifecycle.shadowEditFragment)if(t){var o=r.cache.cachedModel?null:r.api.createContentModel(r),a=r.logicalRoot.ownerDocument.createDocumentFragment(),i=r.logicalRoot.cloneNode(!0);(0,n.moveChildNodes)(a,i),r.api.triggerEvent(r,{eventType:"enteredShadowEdit"},!1),!r.cache.cachedModel&&o&&(r.cache.cachedModel=o),r.lifecycle.shadowEditFragment=a}else r.lifecycle.shadowEditFragment=null,r.api.triggerEvent(r,{eventType:"leavingShadowEdit"},!1),r.cache.cachedModel&&((0,n.iterateSelections)(r.cache.cachedModel,(function(){})),r.api.setContentModel(r,r.cache.cachedModel,{ignoreSelection:!0}))}},1863:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=void 0;var r=["editorReady","beforeDispose","extractContentWithDom","zoomChanged"];t.triggerEvent=function(e,t,n){e.lifecycle.shadowEditFragment&&!(r.indexOf(t.eventType)>=0)||!n&&e.plugins.some((function(e){return function(e,t){var r;return!(!t.onPluginEvent||!(null===(r=t.willHandleEventExclusively)||void 0===r?void 0:r.call(t,e)))&&(t.onPluginEvent(e),!0)}(t,e)}))||e.plugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))}},4388:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCachePlugin=void 0;var n=r(2597),o=r(7973),a=r(3680),i=r(5593),l=function(){function e(e,t){var r=this;this.editor=null,this.onMutation=function(e){r.editor&&(e?r.updateCachedModel(r.editor,!0):r.invalidateCache())},this.onNativeSelectionChange=function(){var e;(null===(e=r.editor)||void 0===e?void 0:e.hasFocus())&&r.updateCachedModel(r.editor)},this.state=e.disableCache?{}:{domIndexer:a.domIndexerImpl,textMutationObserver:(0,o.createTextMutationObserver)(t,this.onMutation)}}return e.prototype.getName=function(){return"Cache"},e.prototype.initialize=function(e){var t;this.editor=e,this.editor.getDocument().addEventListener("selectionchange",this.onNativeSelectionChange),null===(t=this.state.textMutationObserver)||void 0===t||t.startObserving()},e.prototype.dispose=function(){var e;null===(e=this.state.textMutationObserver)||void 0===e||e.stopObserving(),this.editor&&(this.editor.getDocument().removeEventListener("selectionchange",this.onNativeSelectionChange),this.editor=null)},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"keyDown":case"input":this.state.textMutationObserver||this.invalidateCache();break;case"selectionChanged":this.updateCachedModel(this.editor);break;case"contentChanged":var t=e.contentModel,r=e.selection;t&&this.state.domIndexer?(this.state.cachedModel=t,(0,i.updateCachedSelection)(this.state,r)):this.invalidateCache()}},e.prototype.invalidateCache=function(){var e;(null===(e=this.editor)||void 0===e?void 0:e.isInShadowEdit())||(this.state.cachedModel=void 0,this.state.cachedSelection=void 0)},e.prototype.updateCachedModel=function(e,t){var r,o=this.state.cachedSelection;this.state.cachedSelection=void 0;var a=e.getDOMSelection()||void 0,l=this.state.cachedModel;!t&&o&&a&&(0,n.areSameSelection)(a,o)?this.state.cachedSelection=o:l&&a&&(null===(r=this.state.domIndexer)||void 0===r?void 0:r.reconcileSelection(l,a,o))?(0,i.updateCachedSelection)(this.state,a):this.invalidateCache()},e}();t.createCachePlugin=function(e,t){return new l(e,t)}},2597:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areSameSelection=void 0,t.areSameSelection=function(e,t){if(e==t)return!0;switch(e.type){case"image":return"image"==t.type&&t.image==e.image;case"table":return"table"==t.type&&t.table==e.table&&t.firstColumn==e.firstColumn&&t.lastColumn==e.lastColumn&&t.firstRow==e.firstRow&&t.lastRow==e.lastRow;default:return"range"==t.type&&e.range.startContainer==t.start.node&&e.range.endContainer==t.end.node&&e.range.startOffset==t.start.offset&&e.range.endOffset==t.end.offset}}},3680:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domIndexerImpl=void 0;var n=r(7582),o=r(8871);function a(e){var t,r=null!==(t=e.__roosterjsContentModel)&&void 0!==t?t:{},n=r.paragraph,o=r.segments;return n&&"Paragraph"==n.blockType&&Array.isArray(n.segments)&&Array.isArray(o)}function i(e,t,r){e.__roosterjsContentModel={paragraph:t,segments:r}}function l(e,t){return(0,o.isNodeOfType)(e,"TEXT_NODE")?a(e)?c(e,t):void 0:t>=e.childNodes.length?s(e.lastChild,!0):s(e.childNodes[t],!1)}function s(e,t){var r;if(e&&a(e)){var n=e.__roosterjsContentModel,i=n.paragraph,l=n.segments,s=i.segments.indexOf(l[0]);if(s>=0){var c=!t&&i.segments[s-1]||i.segments[s];r=(0,o.createSelectionMarker)(c.format),i.segments.splice(t?s+1:s,0,r)}}return r}function c(e,t,r){var a,l,s=e.__roosterjsContentModel,c=s.paragraph,u=s.segments,d=u[0],f=u[u.length-1];if("Text"==(null==d?void 0:d.segmentType)&&"Text"==(null==f?void 0:f.segmentType)){var p=[],m=e.nodeValue||"",h=[];if(void 0===t)d.text=m,p.push(d),h.push(d);else{if(t>0&&(d.text=m.substring(0,t),p.push(d),h.push(d)),void 0===r){var g=(0,o.createSelectionMarker)(d.format);p.push(g),l=g,r=t}else if(r>t){var v=(0,o.createText)(m.substring(t,r),d.format,d.link,d.code);v.isSelected=!0,p.push(v),h.push(v),l=v}if(r<m.length){var b=(0,o.createText)(m.substring(r),d.format,d.link,d.code);p.push(b),h.push(b)}}var y=c.segments.indexOf(d),S=c.segments.indexOf(f);if(y>=0&&S>=0){for(;y>0&&"SelectionMarker"==c.segments[y-1].segmentType;)y--;for(;S<c.segments.length-1&&"SelectionMarker"==c.segments[S+1].segmentType;)S++;(a=c.segments).splice.apply(a,(0,n.__spreadArray)([y,S-y+1],(0,n.__read)(p),!1))}i(e,c,h),delete c.cachedElement}return l}t.domIndexerImpl={onSegment:i,onParagraph:function e(t){for(var r=null,n=t.firstChild;n;n=n.nextSibling)if((0,o.isNodeOfType)(n,"TEXT_NODE"))if(r){var i=a(r)?r.__roosterjsContentModel:void 0;i&&a(n)&&(i.segments=i.segments.concat(n.__roosterjsContentModel.segments),n.__roosterjsContentModel.segments=[])}else r=n;else(0,o.isNodeOfType)(n,"ELEMENT_NODE")?(r=null,e(n)):r=null},onTable:function(e,t){e.__roosterjsContentModel={tableRows:t.rows}},reconcileSelection:function(e,t,r){var n,i,s;switch(r&&("range"==r.type&&(i=(n=r).start,s=n.end,i.node==s.node&&i.offset==s.offset)&&(0,o.isNodeOfType)(r.start.node,"TEXT_NODE")?a(r.start.node)&&c(r.start.node):(0,o.setSelection)(e)),t.type){case"image":case"table":return!1;case"range":var u=t.range;if(u){var d=u.startContainer,f=u.startOffset,p=u.endContainer,m=u.endOffset,h=u.collapsed;if(delete e.hasRevertedRangeSelection,h)return!!l(d,f);if(d==p&&(0,o.isNodeOfType)(d,"TEXT_NODE"))return t.isReverted&&(e.hasRevertedRangeSelection=!0),a(d)&&!!c(d,f,m);var g=l(d,f),v=l(p,m);return!(!g||!v||(t.isReverted&&(e.hasRevertedRangeSelection=!0),(0,o.setSelection)(e,g,v),0))}}return!1}}},7973:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTextMutationObserver=void 0;var r=function(){function e(e,t){var r=this;this.contentDiv=e,this.onMutation=t,this.onMutationInternal=function(e){var t,n=null===(t=e[0])||void 0===t?void 0:t.target;if(n){var o=e.every((function(e){return"characterData"==e.type&&e.target==n}));r.onMutation(o)}},this.observer=new MutationObserver(this.onMutationInternal)}return e.prototype.startObserving=function(){this.observer.observe(this.contentDiv,{subtree:!0,childList:!0,attributes:!0,characterData:!0})},e.prototype.stopObserving=function(){this.observer.disconnect()},e.prototype.flushMutations=function(){var e=this.observer.takeRecords();this.onMutationInternal(e)},e}();t.createTextMutationObserver=function(e,t){return new r(e,t)}},5593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateCachedSelection=void 0,t.updateCachedSelection=function(e,t){if("range"==(null==t?void 0:t.type)){var r=t.range,n=r.startContainer,o=r.startOffset,a=r.endContainer,i=r.endOffset,l=t.isReverted;e.cachedSelection={type:"range",isReverted:l,start:{node:n,offset:o},end:{node:a,offset:i}}}else e.cachedSelection=t}},6222:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContextMenuPlugin=void 0;var n=r(7582),o=r(8871),a=function(){function e(e){var t,r=this;this.editor=null,this.disposer=null,this.onContextMenuEvent=function(e){var t;if(r.editor){var o=[],a=e,i=2==a.button?a.target:r.getFocusedNode(r.editor);i&&r.state.contextMenuProviders.forEach((function(e){var t,r=null!==(t=e.getContextMenuItems(i))&&void 0!==t?t:[];(null==r?void 0:r.length)>0&&(o.length>0&&o.push(null),o.push.apply(o,(0,n.__spreadArray)([],(0,n.__read)(r),!1)))})),null===(t=r.editor)||void 0===t||t.triggerEvent("contextMenu",{rawEvent:a,items:o})}},this.state={contextMenuProviders:(null===(t=e.plugins)||void 0===t?void 0:t.filter(i))||[]}}return e.prototype.getName=function(){return"ContextMenu"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.attachDomEvent({contextmenu:{beforeDispatch:this.onContextMenuEvent}})},e.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.getFocusedNode=function(e){var t=e.getDOMSelection();return t?("range"==t.type&&t.range.collapse(!0),(0,o.getSelectionRootNode)(t)||null):null},e}();function i(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.getContextMenuItems)}t.createContextMenuPlugin=function(e){return new a(e)}},1465:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCopyPastePlugin=t.preprocessTable=t.onNodeCreated=t.adjustSelectionForCopyCut=void 0;var n=r(7582),o=r(3950),a=r(230),i=r(3311),l=r(710),s=r(8871),c=function(){function e(e){var t=this;this.editor=null,this.disposer=null,this.onPaste=function(e){if(t.editor&&function(e){return!!e.clipboardData}(e)){var r=t.editor,n=e.clipboardData;(null==n?void 0:n.items)&&(e.preventDefault(),(0,s.extractClipboardItems)((0,s.toArray)(n.items),t.state.allowedCustomPasteType).then((function(e){r.isDisposed()||(0,l.paste)(r,e,t.state.defaultPasteType)})))}},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[],tempDiv:null,defaultPasteType:e.defaultPasteType}}return e.prototype.getName=function(){return"CopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.attachDomEvent({paste:{beforeDispatch:function(e){return t.onPaste(e)}},copy:{beforeDispatch:function(e){return t.onCutCopy(e,!1)}},cut:{beforeDispatch:function(e){return t.onCutCopy(e,!0)}}})},e.prototype.dispose=function(){var e;this.state.tempDiv&&(null===(e=this.state.tempDiv.parentNode)||void 0===e||e.removeChild(this.state.tempDiv),this.state.tempDiv=null),this.disposer&&this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onCutCopy=function(e,r){var n,i=this;if(this.editor){var l=this.editor.getDocument(),c=this.editor.getDOMSelection();if(c&&("range"!=c.type||!c.range.collapsed)){var p=this.editor.getContentModelCopy("disconnected");"table"===c.type?(0,s.iterateSelections)(p,(function(e,t){return!!(null==t?void 0:t.table)&&(f(t.table),!0)})):"range"===c.type&&u(p);var m=this.getTempDiv(this.editor.getDocument()),h=(0,s.createModelToDomContext)();h.onNodeCreated=t.onNodeCreated;var g=(0,s.contentModelToDom)(m.ownerDocument,m,p,h),v=g?function(e,t){var r,n=null;if("table"===t.type){var o=t.table,a=1==(null===(r=o.parentElement)||void 0===r?void 0:r.childElementCount)?o.parentElement:o;(n=e.createRange()).selectNode(a)}else"image"===t.type?(n=e.createRange()).selectNode(t.image):n=t.range;return n}(l,g):null;v?((v=this.editor.triggerEvent("beforeCutCopy",{clonedRoot:m,range:v,rawEvent:e,isCut:r}).range)&&(0,o.addRangeToSelection)(l,v),null===(n=l.defaultView)||void 0===n||n.requestAnimationFrame((function(){i.editor&&(d(m),i.editor.setDOMSelection(c),i.editor.focus(),r&&i.editor.formatContentModel((function(e,t){return"range"==(0,s.deleteSelection)(e,[a.deleteEmptyList],t).deleteResult&&(0,s.normalizeContentModel)(e),!0}),{apiName:"cut",changeSource:s.ChangeSource.Cut}))}))):d(m)}}},e.prototype.getTempDiv=function(e){if(!this.state.tempDiv){var t=e.createElement("div");t.style.width="600px",t.style.height="1px",t.style.overflow="hidden",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.userSelect="text",t.contentEditable="true",e.body.appendChild(t),this.state.tempDiv=t}var r=this.state.tempDiv;return r.style.backgroundColor="white",r.style.color="black",r.childNodes.forEach((function(e){return r.removeChild(e)})),r.style.display="",r.focus(),r},e}();function u(e){var t,r,n;(0,s.iterateSelections)(e,(function(e,o,a,i){if(t)return o!=n&&(null==r?void 0:r.segments.includes(t))&&r.segments.splice(r.segments.indexOf(t),1),!0;var l=null==i?void 0:i.find((function(e){return"SelectionMarker"==e.segmentType}));return!t&&l&&(n=o,r="Paragraph"==(null==a?void 0:a.blockType)?a:void 0,t=l),!1}))}function d(e){e.style.backgroundColor="",e.style.color="",e.style.display="none",(0,s.moveChildNodes)(e)}function f(e){var t=(0,s.getSelectedCells)(e);e.rows=e.rows.map((function(e){return(0,n.__assign)((0,n.__assign)({},e),{cells:e.cells.filter((function(e){return e.isSelected}))})})).filter((function(e){return e.cells.length>0})),delete e.format.width,e.widths=t?e.widths.filter((function(e,r){return r>=(null==t?void 0:t.firstColumn)&&r<=(null==t?void 0:t.lastColumn)})):[]}t.adjustSelectionForCopyCut=u,t.onNodeCreated=function(e,t){(0,s.isNodeOfType)(t,"ELEMENT_NODE")&&(0,s.isElementOfType)(t,"table")&&(0,s.wrap)(t.ownerDocument,t,"div"),(0,s.isNodeOfType)(t,"ELEMENT_NODE")&&!t.isContentEditable&&t.removeAttribute("contenteditable"),(0,i.onCreateCopyEntityNode)(e,t)},t.preprocessTable=f,t.createCopyPastePlugin=function(e){return new c(e)}},230:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteEmptyList=void 0;var n=r(8871);function o(e){return e&&"Paragraph"==e.blockType?e.segments.every((function(e){return"SelectionMarker"!==e.segmentType&&"Br"==e.segmentType})):e&&"BlockGroup"==e.blockType?e.blocks.every(o):!!e}t.deleteEmptyList=function(e){var t=e.insertPoint;if("range"==e.deleteResult&&(null==t?void 0:t.path)){var r=(0,n.getClosestAncestorBlockGroupIndex)(t.path,["ListItem"],["TableCell"]),a=t.path[r];if(r>=0&&a&&"ListItem"==a.blockGroupType){var i=t.path[r+1].blocks.indexOf(a),l=i>-1?t.path[r+1].blocks[i-1]:void 0,s=i>-1?t.path[r+1].blocks[i+1]:void 0;(0,n.hasSelectionInBlockGroup)(a)&&(!l||(0,n.hasSelectionInBlock)(l))&&s&&o(s)&&(a.levels=[])}}}},9785:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditorCorePlugins=void 0;var n=r(4388),o=r(6222),a=r(1465),i=r(5947),l=r(9514),s=r(8283),c=r(2933),u=r(535),d=r(9465);t.createEditorCorePlugins=function(e,t){return{cache:(0,n.createCachePlugin)(e,t),format:(0,s.createFormatPlugin)(e),copyPaste:(0,a.createCopyPastePlugin)(e),domEvent:(0,i.createDOMEventPlugin)(e,t),lifecycle:(0,c.createLifecyclePlugin)(e,t),entity:(0,l.createEntityPlugin)(),selection:(0,u.createSelectionPlugin)(e),contextMenu:(0,o.createContextMenuPlugin)(e),undo:(0,d.createUndoPlugin)(e)}}},5947:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDOMEventPlugin=void 0;var n=r(8871),o={keydown:"keyDown",keyup:"keyUp",keypress:"keyPress"},a=function(){function e(e,t){var r=this;this.editor=null,this.disposer=null,this.onDragStart=function(e){var t=e,r=t.target,o=(0,n.isNodeOfType)(r,"ELEMENT_NODE")?r:r.parentElement;o&&!o.isContentEditable&&t.preventDefault()},this.onDrop=function(){var e,t,o=null===(e=r.editor)||void 0===e?void 0:e.getDocument();null===(t=null==o?void 0:o.defaultView)||void 0===t||t.requestAnimationFrame((function(){r.editor&&(r.editor.takeSnapshot(),r.editor.triggerEvent("contentChanged",{source:n.ChangeSource.Drop}))}))},this.onScroll=function(e){var t;null===(t=r.editor)||void 0===t||t.triggerEvent("scroll",{rawEvent:e,scrollContainer:r.state.scrollContainer})},this.keyboardEventHandler={beforeDispatch:function(e){var t=o[e.type];((0,n.isCharacterValue)(e)||(0,n.isCursorMovingKey)(e))&&e.stopPropagation(),r.editor&&t&&!e.isComposing&&!r.state.isInIME&&r.editor.triggerEvent(t,{rawEvent:e})}},this.inputEventHandler={beforeDispatch:function(e){e.stopPropagation(),!r.editor||e.isComposing||r.state.isInIME||r.editor.triggerEvent("input",{rawEvent:e})}},this.onMouseDown=function(e){r.editor&&(r.state.mouseUpEventListerAdded||(r.editor.getDocument().addEventListener("mouseup",r.onMouseUp,!0),r.state.mouseUpEventListerAdded=!0,r.state.mouseDownX=e.pageX,r.state.mouseDownY=e.pageY),r.editor.triggerEvent("mouseDown",{rawEvent:e}))},this.onMouseUp=function(e){r.editor&&(r.removeMouseUpEventListener(),r.editor.triggerEvent("mouseUp",{rawEvent:e,isClicking:r.state.mouseDownX==e.pageX&&r.state.mouseDownY==e.pageY}))},this.onCompositionStart=function(){r.state.isInIME=!0},this.onCompositionEnd=function(e){var t;r.state.isInIME=!1,null===(t=r.editor)||void 0===t||t.triggerEvent("compositionEnd",{rawEvent:e})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,mouseDownX:null,mouseDownY:null,mouseUpEventListerAdded:!1}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,r;this.editor=e;var n=this.editor.getDocument(),o={keypress:this.keyboardEventHandler,keydown:this.keyboardEventHandler,keyup:this.keyboardEventHandler,input:this.inputEventHandler,mousedown:{beforeDispatch:this.onMouseDown},compositionstart:{beforeDispatch:this.onCompositionStart},compositionend:{beforeDispatch:this.onCompositionEnd},dragstart:{beforeDispatch:this.onDragStart},drop:{beforeDispatch:this.onDrop}};this.disposer=this.editor.attachDomEvent(o),this.state.scrollContainer.addEventListener("scroll",this.onScroll),null===(t=n.defaultView)||void 0===t||t.addEventListener("scroll",this.onScroll),null===(r=n.defaultView)||void 0===r||r.addEventListener("resize",this.onScroll)},e.prototype.dispose=function(){var e,t,r,n;this.removeMouseUpEventListener();var o=null===(e=this.editor)||void 0===e?void 0:e.getDocument();null===(t=null==o?void 0:o.defaultView)||void 0===t||t.removeEventListener("resize",this.onScroll),null===(r=null==o?void 0:o.defaultView)||void 0===r||r.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),null===(n=this.disposer)||void 0===n||n.call(this),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.removeMouseUpEventListener=function(){this.editor&&this.state.mouseUpEventListerAdded&&(this.state.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.createDOMEventPlugin=function(e,t){return new a(e,t)}},9514:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEntityPlugin=void 0;var n=r(1964),o=r(8871),a=r(9617),i=/_(\d{1,8})$/,l=function(){function e(){this.editor=null,this.state={entityMap:{}}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.state.entityMap={}},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"mouseUp":this.handleMouseUpEvent(this.editor,e);break;case"contentChanged":this.handleContentChangedEvent(this.editor,e);break;case"keyDown":(0,a.handleDelimiterKeyDownEvent)(this.editor,e);break;case"compositionEnd":(0,a.handleCompositionEndEvent)(this.editor,e);break;case"editorReady":this.handleContentChangedEvent(this.editor);break;case"extractContentWithDom":this.handleExtractContentWithDomEvent(this.editor,e.clonedRoot)}},e.prototype.handleMouseUpEvent=function(e,t){var r=t.rawEvent,n=t.isClicking,a=r.target;if(n&&this.editor)for(;a&&this.editor.getDOMHelper().isNodeInEditor(a);){if((0,o.isEntityElement)(a)){this.triggerEvent(e,a,"click",r);break}a=a.parentNode}},e.prototype.handleContentChangedEvent=function(e,t){var r,n=this,i=null!==(r=null==t?void 0:t.changedEntities)&&void 0!==r?r:this.getChangedEntities(e),l=null==t?void 0:t.entityStates;i.forEach((function(t){var r=t.entity,a=t.operation,i=t.rawEvent,l=r.entityFormat,s=l.id,c=l.entityType,u=l.isFakeEntity,d=r.wrapper;if(c&&!u)if("newEntity"==a){r.entityFormat.id=n.ensureUniqueId(c,null!=s?s:"",d),d.className=(0,o.generateEntityClassNames)(r.entityFormat),r.entityFormat.isReadonly&&(d.contentEditable="false");var f=n.triggerEvent(e,d,a,i);n.state.entityMap[r.entityFormat.id]={element:d,canPersist:null==f?void 0:f.shouldPersist},e.isDarkMode()&&(0,o.transformColor)(d,!0,"lightToDark",e.getColorManager())}else if(s){var p=n.state.entityMap[s];p&&(p.isDeleted=!0),n.triggerEvent(e,d,a,i)}})),null==l||l.forEach((function(t){var r,o=t.id,a=t.state,i=null===(r=n.state.entityMap[o])||void 0===r?void 0:r.element;i&&n.triggerEvent(e,i,"updateEntityState",void 0,a)})),(0,a.handleDelimiterContentChangedEvent)(e)},e.prototype.getChangedEntities=function(e){var t=this,r=[];return e.formatContentModel((function(e){return(0,n.findAllEntities)(e,r),!1})),(0,o.getObjectKeys)(this.state.entityMap).forEach((function(e){var n=t.state.entityMap[e];if(!n.isDeleted){var a=r.findIndex((function(t){return"newEntity"==t.operation&&t.entity.entityFormat.id==e&&t.entity.wrapper==n.element}));if(a>=0)r.splice(a,1);else{var i=(0,o.parseEntityFormat)(n.element);if(!i.isFakeEntity){var l=(0,o.createEntity)(n.element,i.isReadonly,{},i.entityType,i.id);r.push({entity:l,operation:"overwrite"})}}}})),r},e.prototype.handleExtractContentWithDomEvent=function(e,t){var r=this;(0,o.getAllEntityWrappers)(t).forEach((function(t){t.removeAttribute("contentEditable"),r.triggerEvent(e,t,"replaceTemporaryContent")}))},e.prototype.triggerEvent=function(e,t,r,n,a){var i=(0,o.parseEntityFormat)(t);return i.id&&i.entityType&&!i.isFakeEntity?e.triggerEvent("entityOperation",{operation:r,rawEvent:n,entity:{id:i.id,type:i.entityType,isReadonly:!!i.isReadonly,wrapper:t},state:"updateEntityState"==r?a:void 0,shouldPersist:"newEntity"==r||void 0}):null},e.prototype.ensureUniqueId=function(e,t,r){for(var n=i.exec(t),o=(n?t.substr(0,t.length-n[0].length):t)||e,a="",l=n&&parseInt(n[1])||0;;l++){a=l>0?o+"_"+l:o;var s=this.state.entityMap[a];if(!s||s.element==r)break}return a},e}();t.createEntityPlugin=function(){return new l}},8656:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustSelectionAroundEntity=void 0;var n=r(7582),o=r(8871);t.adjustSelectionAroundEntity=function(e,t,r){var a,i=e.isDisposed()?null:e.getDOMSelection();if(i&&"range"==i.type){var l=i.range,s=i.isReverted,c=s?l.startContainer:l.endContainer,u=s?l.startOffset:l.endOffset,d=(0,o.isNodeOfType)(c,"ELEMENT_NODE")?c:c.parentElement,f="ArrowLeft"==t!=!(!d||"rtl"!=(null===(a=e.getDocument().defaultView)||void 0===a?void 0:a.getComputedStyle(d).direction));d&&((0,o.isEntityDelimiter)(d,!f)&&(f&&0==u||!f&&1==u)||(0,o.isBlockEntityContainer)(d))&&e.formatContentModel((function(t){var a,i,c=(0,o.getSelectedSegmentsAndParagraphs)(t,!1,!0),u=c[s?0:c.length-1],d=null!==(i=null===(a=null==u?void 0:u[1])||void 0===a?void 0:a.segments.indexOf(u[0]))&&void 0!==i?i:-1;if(u&&u[1]&&d>=0){var p=(0,n.__read)(u,3),m=p[0],h=p[1],g=p[2],v=r&&!l.collapsed&&f!=!!s,b=function(e,t,r,n){var a=null;if("Entity"==(null==e?void 0:e.segmentType))a=e;else{var i=t[0].blocks,l=i.indexOf(r),s=l>=0?i[n?l-1:l+1]:null;"Entity"==(null==s?void 0:s.blockType)&&(a=s)}var c=a?n?a.wrapper.previousElementSibling:a.wrapper.nextElementSibling:null;return(0,o.isNodeOfType)(c,"ELEMENT_NODE")&&(0,o.isEntityDelimiter)(c,n)?c:null}(v?m:h.segments[f?d-1:d+1],g,h,f);if(b){var y=function(e,t,r,n,o){var a=e.cloneRange();return t?r?a.setEndBefore(n):a.setStartAfter(n):(r?a.setStartBefore(n):a.setEndAfter(n),o||(r?a.setEndBefore(n):a.setStartAfter(n))),a}(l,v,f,b,r);e.setDOMSelection({type:"range",range:y,isReverted:!y.collapsed&&s})}}return!1}))}}},9617:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleEnterInlineEntity=t.handleKeyDownInBlockDelimiter=t.handleDelimiterKeyDownEvent=t.handleCompositionEndEvent=t.handleDelimiterContentChangedEvent=t.preventTypeInDelimiter=void 0;var n=r(7582),o=r(8656),a=r(4304),i=r(8871),l="entityDelimiterBefore",s="entityDelimiterAfter",c="."+s+",."+l,u="​";function d(e,t){var r=e.classList.contains(s)?e.previousElementSibling:e.nextElementSibling;r&&(0,i.isEntityElement)(r)&&(f([r.previousElementSibling,r.nextElementSibling].filter((function(e){return!!e}))),t.formatContentModel((function(e,t){return(0,i.iterateSelections)(e,(function(e,t,r,n){"Paragraph"==(null==r?void 0:r.blockType)&&r.segments.forEach((function(e){"Text"==e.segmentType&&(e.text=e.text.replace(u,""))}))})),t.skipUndoSnapshot=!0,!0})))}function f(e){e.forEach((function(e){var t,r;if((0,i.isNodeOfType)(e,"ELEMENT_NODE"))if((0,i.isEntityDelimiter)(e)){var n=e.classList.contains(l)?e.nextElementSibling:e.previousElementSibling;(0,i.isNodeOfType)(n,"ELEMENT_NODE")&&(0,i.isEntityElement)(n)||null===(r=null==(t=e)?void 0:t.parentElement)||void 0===r||r.removeChild(t)}else!function(e,t){if(void 0===t&&(t=!0),e){var r=e.classList.contains(s)?e.previousElementSibling:e.nextElementSibling;t&&r&&(0,i.isEntityElement)(r)||(e.classList.remove(s,l),e.normalize(),e.childNodes.forEach((function(e){var t,r,n=null!==(r=null===(t=e.textContent)||void 0===t?void 0:t.indexOf(u))&&void 0!==r?r:-1;if(n>=0){var o=new Range;o.setStart(e,n),o.setEnd(e,n+1),o.deleteContents()}})))}}(e)}))}function p(e,t){var r,n,o,l,s,d=e.range,f=e.isReverted,p=f?d.startContainer:d.endContainer,m=f?d.startOffset:d.endOffset;if(p){var h=(0,a.normalizePos)(p,m);p=h.node,m=h.offset}if((0,i.isNodeOfType)(p,"ELEMENT_NODE"))p=p.childNodes.length==m?p:p.childNodes.item(m);else{var g=t?u+t:u;p=p.textContent!=g&&(p.textContent||"").length==m?null!==(o=null!==(r=p.nextSibling)&&void 0!==r?r:null===(n=p.parentElement)||void 0===n?void 0:n.closest(c))&&void 0!==o?o:null:null!==(s=null===(l=null==p?void 0:p.parentElement)||void 0===l?void 0:l.closest(c))&&void 0!==s?s:null}return p&&!p.hasChildNodes()&&(p=p.nextSibling),(0,i.isNodeOfType)(p,"ELEMENT_NODE")?p:null}function m(e,r,n,o){var a,l=e.getDOMHelper();if(n&&(0,i.isEntityDelimiter)(n)&&l.isNodeInEditor(n)){var c=(0,i.findClosestBlockEntityContainer)(n,l),u="Enter"===o.key;c&&l.isNodeInEditor(c)?(n.classList.contains(s)?r.setStartAfter(c):r.setStartBefore(c),r.collapse(!0),u&&o.preventDefault(),e.formatContentModel(t.handleKeyDownInBlockDelimiter,{selectionOverride:{type:"range",isReverted:!1,range:r}})):u?(o.preventDefault(),e.formatContentModel(t.handleEnterInlineEntity)):(e.takeSnapshot(),null===(a=e.getDocument().defaultView)||void 0===a||a.requestAnimationFrame((function(){return d(n,e)})))}}t.preventTypeInDelimiter=d,t.handleDelimiterContentChangedEvent=function(e){var t=e.getDOMHelper();f(t.queryElements(c)),function(e,t){if(e.length>0){var r=(0,i.createModelToDomContext)();e.forEach((function(e){(0,i.isNodeOfType)(e,"ELEMENT_NODE")&&(0,i.isEntityElement)(e)&&!e.isContentEditable&&(0,i.addDelimiters)(e.ownerDocument,e,t,r)}))}}(t.queryElements("span._Entity"),e.getPendingFormat())},t.handleCompositionEndEvent=function(e,t){var r=e.getDOMSelection();if("range"==(null==r?void 0:r.type)&&r.range.collapsed){var n=p(r,t.rawEvent.data);(null==n?void 0:n.firstChild)&&(0,i.isNodeOfType)(n.firstChild,"TEXT_NODE")&&n.matches(c)&&n.textContent==u+t.rawEvent.data&&d(n,e)}},t.handleDelimiterKeyDownEvent=function(e,t){var r,n=e.getDOMSelection();if(n&&"range"==n.type){var a=t.rawEvent,l=n.range,s=a.key;switch(s){case"Enter":if(l.collapsed)m(e,l,p(n),a);else{var c=e.getDOMHelper(),u=(0,i.findClosestEntityWrapper)(l.startContainer,c);u&&(0,i.isNodeOfType)(u,"ELEMENT_NODE")&&c.isNodeInEditor(u)&&h(e,u,a)}break;case"ArrowLeft":case"ArrowRight":a.altKey||a.ctrlKey||a.metaKey||null===(r=e.getDocument().defaultView)||void 0===r||r.requestAnimationFrame((function(){(0,o.adjustSelectionAroundEntity)(e,s,a.shiftKey)}));break;default:(0,i.isCharacterValue)(a)&&l.collapsed&&m(e,l,p(n),a)}}},t.handleKeyDownInBlockDelimiter=function(e,t){return(0,i.iterateSelections)(e,(function(e,r,o){if("Paragraph"==(null==o?void 0:o.blockType)){delete o.isImplicit;var a=o.segments.find((function(e){return"SelectionMarker"==e.segmentType}));"SelectionMarker"==(null==a?void 0:a.segmentType)&&(o.segmentFormat=(0,n.__assign)({},a.format),t.newPendingFormat=(0,n.__assign)({},a.format)),o.segments.unshift((0,i.createBr)())}})),!0},t.handleEnterInlineEntity=function(e){var t,r,o;if((0,i.iterateSelections)(e,(function(e,t,n){"Paragraph"==(null==n?void 0:n.blockType)&&(r=n,o=e[e.length-1])})),r&&o){var a=r.segments.find((function(e){return"SelectionMarker"==e.segmentType}));if(a){var l=r.segments.indexOf(a),s=r.segments.splice(l),c=(0,i.createParagraph)(!1,r.format,r.segmentFormat,r.decorator);(r.segments.every((function(e){return"SelectionMarker"==e.segmentType||"Br"==e.segmentType}))||s.every((function(e){return"SelectionMarker"==e.segmentType})))&&c.segments.push((0,i.createBr)(r.format)),(t=c.segments).push.apply(t,(0,n.__spreadArray)([],(0,n.__read)(s),!1));var u=o.blocks.indexOf(r);u>=0&&o.blocks.splice(u+1,0,c)}}return!0};var h=function(e,t,r){var n=(0,i.parseEntityFormat)(t);n.id&&n.entityType&&!n.isFakeEntity&&e.triggerEvent("entityOperation",{operation:"click",entity:{id:n.id,type:n.entityType,isReadonly:!!n.isReadonly,wrapper:t},rawEvent:r})}},1964:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findAllEntities=void 0,t.findAllEntities=function e(t,r){t.blocks.forEach((function(t){switch(t.blockType){case"BlockGroup":e(t,r);break;case"Entity":r.push({entity:t,operation:"newEntity"});break;case"Paragraph":t.segments.forEach((function(t){switch(t.segmentType){case"Entity":r.push({entity:t,operation:"newEntity"});break;case"General":e(t,r)}}));break;case"Table":t.rows.forEach((function(t){return t.cells.forEach((function(t){return e(t,r)}))}))}}))}},8283:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFormatPlugin=void 0;var n=r(7582),o=r(1800),a=r(6668),i=r(8871),l={backgroundColor:"backgroundColor",textColor:"color",fontFamily:"fontFamily",fontSize:"fontSize"},s=function(){function e(e){var t=this;this.editor=null,this.lastCheckedNode=null,this.state={defaultFormat:(0,n.__assign)({},e.defaultSegmentFormat),pendingFormat:null},this.defaultFormatKeys=new Set,(0,i.getObjectKeys)(l).forEach((function(e){t.state.defaultFormat[e]&&t.defaultFormatKeys.add(l[e])}))}return e.prototype.getName=function(){return"Format"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"input":case"compositionEnd":this.checkAndApplyPendingFormat(e.rawEvent.data);break;case"keyDown":(0,i.isCursorMovingKey)(e.rawEvent)?(this.clearPendingFormat(),this.lastCheckedNode=null):this.defaultFormatKeys.size>0&&((0,i.isCharacterValue)(e.rawEvent)||"Process"==e.rawEvent.key)&&this.shouldApplyDefaultFormat(this.editor)&&(0,o.applyDefaultFormat)(this.editor,this.state.defaultFormat);break;case"mouseUp":case"contentChanged":this.lastCheckedNode=null,this.canApplyPendingFormat()||this.clearPendingFormat()}},e.prototype.checkAndApplyPendingFormat=function(e){this.editor&&e&&this.state.pendingFormat&&((0,a.applyPendingFormat)(this.editor,e,this.state.pendingFormat.format),this.clearPendingFormat())},e.prototype.clearPendingFormat=function(){this.state.pendingFormat=null},e.prototype.canApplyPendingFormat=function(){var e=!1;if(this.state.pendingFormat&&this.editor){var t=this.editor.getDOMSelection(),r="range"==(null==t?void 0:t.type)&&t.range.collapsed?t.range:null,n=this.state.pendingFormat.insertPoint,o=n.node,a=n.offset;r&&r.startContainer==o&&r.startOffset==a&&(e=!0)}return e},e.prototype.shouldApplyDefaultFormat=function(e){var t,r,n=e.getDOMSelection(),o="range"==(null==n?void 0:n.type)?n.range:null,a=null!==(t=null==o?void 0:o.startContainer)&&void 0!==t?t:null;if(a&&a!=this.lastCheckedNode){this.lastCheckedNode=a;for(var l=e.getDOMHelper(),s=(0,i.isNodeOfType)(a,"ELEMENT_NODE")?a:a.parentElement,c=new Set,u=function(){if(null===(r=s.getAttribute)||void 0===r?void 0:r.call(s,"style")){var e=s.style;if(d.defaultFormatKeys.forEach((function(t){e[t]&&c.add(t)})),c.size==d.defaultFormatKeys.size)return{value:!1}}if((0,i.isBlockElement)(s))return"break";s=s.parentElement},d=this;(null==s?void 0:s.parentElement)&&l.isNodeInEditor(s.parentElement);){var f=u();if("object"==typeof f)return f.value;if("break"===f)break}return!0}return!1},e}();t.createFormatPlugin=function(e){return new s(e)}},1800:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyDefaultFormat=void 0;var n=r(7582),o=r(8871);function a(e,t,r){return(0,n.__assign)((0,n.__assign)((0,n.__assign)({},t),e.getPendingFormat()),r)}t.applyDefaultFormat=function(e,t){e.formatContentModel((function(r,n){var i=(0,o.deleteSelection)(r,[],n);if("range"==i.deleteResult)return(0,o.normalizeContentModel)(r),e.takeSnapshot(),!0;if("notDeleted"==i.deleteResult&&i.insertPoint){var l=i.insertPoint,s=l.paragraph,c=l.path,u=l.marker,d=c[0].blocks,f=d.length,p=d.indexOf(s);if(s.isImplicit&&1==s.segments.length&&s.segments[0]==u&&f>0&&p==f-1){var m=d[p-1];"Paragraph"!=(null==m?void 0:m.blockType)&&(n.newPendingFormat=a(e,t,u.format))}else s.segments.every((function(e){return"Text"!=e.segmentType}))&&(n.newPendingFormat=a(e,t,u.format))}return!1}))}},6668:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyPendingFormat=void 0;var n=r(7582),o=r(8871);t.applyPendingFormat=function(e,t,r){var a=!1;e.formatContentModel((function(e,i){return(0,o.iterateSelections)(e,(function(e,i,l,s){if("Paragraph"==(null==l?void 0:l.blockType)&&1==(null==s?void 0:s.length)&&"SelectionMarker"==s[0].segmentType){var c=s[0],u=l.segments.indexOf(c),d=l.segments[u-1];if("Text"==(null==d?void 0:d.segmentType)){var f=d.text,p=f.substr(-t.length,t.length);if(p==t||" "==t&&" "==p){c.format=(0,n.__assign)({},r),d.text=f.substring(0,f.length-t.length);var m=(0,o.createText)(" "==t?" ":t,(0,n.__assign)((0,n.__assign)({},d.format),r));l.segments.splice(u,0,m),(0,o.setParagraphNotImplicit)(l),a=!0}}}return!0})),a&&((0,o.normalizeContentModel)(e),i.skipUndoSnapshot=!0),a}),{apiName:"applyPendingFormat"})}},2933:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLifecyclePlugin=void 0;var n=r(8871),o="contenteditable",a=function(){function e(e,t){var r=this;this.editor=null,this.initializer=null,this.disposer=null,null===t.getAttribute(o)&&(this.initializer=function(){t.contentEditable="true",t.style.userSelect="text"},this.disposer=function(){t.style.userSelect="",t.removeAttribute(o)}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){r.adjustContainerColor(t)},this.state={isDarkMode:!!e.inDarkMode,shadowEditFragment:null,styleElements:{},announcerStringGetter:e.announcerStringGetter}}return e.prototype.getName=function(){return"Lifecycle"},e.prototype.initialize=function(e){var t;this.editor=e,null===(t=this.initializer)||void 0===t||t.call(this),this.adjustColor(),this.editor.triggerEvent("editorReady",{},!0)},e.prototype.dispose=function(){var e,t,r=this;null===(e=this.editor)||void 0===e||e.triggerEvent("beforeDispose",{},!0),(0,n.getObjectKeys)(this.state.styleElements).forEach((function(e){var t,n=r.state.styleElements[e];null===(t=n.parentElement)||void 0===t||t.removeChild(n),delete r.state.styleElements[e]}));var o=this.state.announceContainer;o&&(null===(t=o.parentElement)||void 0===t||t.removeChild(o),delete this.state.announceContainer),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){"contentChanged"!=e.eventType||e.source!=n.ChangeSource.SwitchToDarkMode&&e.source!=n.ChangeSource.SwitchToLightMode||this.adjustColor()},e.prototype.adjustContainerColor=function(e){if(this.editor){var t=this.state.isDarkMode,r=this.editor.getColorManager();(0,n.setColor)(e,"#000000",!1,t,r),(0,n.setColor)(e,"#ffffff",!0,t,r)}},e}();t.createLifecyclePlugin=function(e,t){return new a(e,t)}},535:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionPlugin=t.DEFAULT_TABLE_CELL_SELECTION_BACKGROUND_COLOR=t.DEFAULT_SELECTION_BORDER_COLOR=void 0;var n=r(2981),o=r(2607),a=r(4263),i=r(4304),l=r(8871),s="ArrowUp",c="ArrowDown",u="ArrowLeft",d="ArrowRight";t.DEFAULT_SELECTION_BORDER_COLOR="#DB626C",t.DEFAULT_TABLE_CELL_SELECTION_BACKGROUND_COLOR="#C6C6C6";var f=function(){function e(e){var r,o,i=this;this.editor=null,this.disposer=null,this.isSafari=!1,this.isMac=!1,this.scrollTopCache=0,this.onMouseMove=function(e){var t,r,o;if(i.editor&&i.state.tableSelection){var a=!!i.state.tableSelection.lastCo,s=e.target,c=i.editor.getDOMHelper(),u=i.editor.getDocument().createRange(),d=i.state.tableSelection.startNode,f=s.compareDocumentPosition(d)==Node.DOCUMENT_POSITION_FOLLOWING;f?(u.setStart(s,0),u.setEnd(d,(0,l.isNodeOfType)(d,"TEXT_NODE")?null!==(r=null===(t=d.nodeValue)||void 0===t?void 0:t.length)&&void 0!==r?r:0:d.childNodes.length)):(u.setStart(d,0),u.setEnd(s,0));var p=u.commonAncestorContainer,m=i.parseTableSelection(p,d,c);if(m){var h=(0,n.findCoordinate)(m.parsedTable,s,c);m.table!=i.state.tableSelection.table&&(i.state.tableSelection=m,i.state.tableSelection.lastCo=null!=h?h:void 0);var g=h&&i.updateTableSelection(h);(a||g)&&e.preventDefault()}else"table"==(null===(o=i.editor.getDOMSelection())||void 0===o?void 0:o.type)&&i.setDOMSelection({type:"range",range:u,isReverted:f},i.state.tableSelection)}},this.onDrop=function(){i.detachMouseEvent()},this.getContainedTargetImage=function(e,t){if(!i.isMac||!t||"image"!==t.type)return null;var r=e.target;return(0,l.isNodeOfType)(r,"ELEMENT_NODE")&&(0,l.isElementOfType)(r,"span")&&r.firstChild===t.image?t.image:null},this.onFocus=function(){var e;!i.state.skipReselectOnFocus&&i.state.selection&&i.setDOMSelection(i.state.selection,i.state.tableSelection),"range"!=(null===(e=i.state.selection)||void 0===e?void 0:e.type)||i.isSafari||(i.state.selection=null),i.scrollTopCache&&i.editor&&(i.editor.getScrollContainer().scrollTop=i.scrollTopCache,i.scrollTopCache=0)},this.onBlur=function(){if(i.editor){i.state.selection||(i.state.selection=i.editor.getDOMSelection());var e=i.editor.getScrollContainer();i.scrollTopCache=e.scrollTop}},this.onSelectionChange=function(){var e;if((null===(e=i.editor)||void 0===e?void 0:e.hasFocus())&&!i.editor.isInShadowEdit()){var t=i.editor.getDOMSelection(),r=i.editor.getDocument().getSelection();if("image"==(null==t?void 0:t.type)&&r&&r&&!(0,a.isSingleImageInSelection)(r)){var n=r.getRangeAt(0);i.editor.setDOMSelection({type:"range",range:n,isReverted:r.focusNode!=n.endContainer||r.focusOffset!=n.endOffset})}"range"==(null==t?void 0:t.type)&&(i.isSafari&&(i.state.selection=t),i.trySelectSingleImage(t))}},this.state={selection:null,tableSelection:null,imageSelectionBorderColor:null!==(r=e.imageSelectionBorderColor)&&void 0!==r?r:t.DEFAULT_SELECTION_BORDER_COLOR,imageSelectionBorderColorDark:e.imageSelectionBorderColor?void 0:t.DEFAULT_SELECTION_BORDER_COLOR,tableCellSelectionBackgroundColor:null!==(o=e.tableCellSelectionBackgroundColor)&&void 0!==o?o:t.DEFAULT_TABLE_CELL_SELECTION_BACKGROUND_COLOR,tableCellSelectionBackgroundColorDark:e.tableCellSelectionBackgroundColor?void 0:t.DEFAULT_TABLE_CELL_SELECTION_BACKGROUND_COLOR}}return e.prototype.getName=function(){return"Selection"},e.prototype.initialize=function(e){this.editor=e,!this.state.imageSelectionBorderColorDark&&this.state.imageSelectionBorderColor&&(this.state.imageSelectionBorderColorDark=e.getColorManager().getDarkColor(this.state.imageSelectionBorderColor,void 0,"border")),!this.state.tableCellSelectionBackgroundColorDark&&this.state.tableCellSelectionBackgroundColor&&(this.state.tableCellSelectionBackgroundColorDark=e.getColorManager().getDarkColor(this.state.tableCellSelectionBackgroundColor,void 0,"background"));var t=this.editor.getEnvironment(),r=this.editor.getDocument();this.isSafari=!!t.isSafari,this.isMac=!!t.isMac,r.addEventListener("selectionchange",this.onSelectionChange),this.isSafari?this.disposer=this.editor.attachDomEvent({focus:{beforeDispatch:this.onFocus},drop:{beforeDispatch:this.onDrop}}):this.disposer=this.editor.attachDomEvent({focus:{beforeDispatch:this.onFocus},blur:{beforeDispatch:this.onBlur},drop:{beforeDispatch:this.onDrop}})},e.prototype.dispose=function(){var e;null===(e=this.editor)||void 0===e||e.getDocument().removeEventListener("selectionchange",this.onSelectionChange),this.disposer&&(this.disposer(),this.disposer=null),this.detachMouseEvent(),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"mouseDown":this.onMouseDown(this.editor,e.rawEvent);break;case"mouseUp":this.onMouseUp(e);break;case"keyDown":this.onKeyDown(this.editor,e.rawEvent);break;case"contentChanged":this.state.tableSelection=null;break;case"scroll":this.editor.hasFocus()||(this.scrollTopCache=e.scrollContainer.scrollTop)}},e.prototype.onMouseDown=function(e,t){var r,o,a=e.getDOMSelection();if(2===t.button&&(o=null!==(r=this.getClickingImage(t))&&void 0!==r?r:this.getContainedTargetImage(t,a))&&o.isContentEditable)this.selectImageWithRange(o,t);else if("image"!=(null==a?void 0:a.type)||a.image===t.target){var i;"table"==(null==a?void 0:a.type)&&0==t.button&&this.setDOMSelection(null,null);var l=t.target;if(l&&0==t.button&&(i=this.parseTableSelection(l,l,e.getDOMHelper()))){if(this.state.tableSelection=i,t.detail>=3){var s=(0,n.findCoordinate)(i.parsedTable,t.target,e.getDOMHelper());s&&(i.lastCo=s,this.updateTableSelection(s),t.preventDefault())}this.state.mouseDisposer=e.attachDomEvent({mousemove:{beforeDispatch:this.onMouseMove}})}}else this.selectBeforeOrAfterElement(e,a.image)},e.prototype.selectImageWithRange=function(e,t){var r,n=e.ownerDocument.createRange();n.selectNode(e);var o=null===(r=this.editor)||void 0===r?void 0:r.getDOMSelection();"image"==(null==o?void 0:o.type)&&e==o.image?t.preventDefault():this.setDOMSelection({type:"range",isReverted:!1,range:n},null)},e.prototype.onMouseUp=function(e){var t;(t=this.getClickingImage(e.rawEvent))&&t.isContentEditable&&1!=e.rawEvent.button&&(2==e.rawEvent.button||e.isClicking)&&this.selectImageWithRange(t,e.rawEvent),this.detachMouseEvent()},e.prototype.onKeyDown=function(e,t){var r,n=this,o=t.key,a=e.getDOMSelection(),i=e.getDocument().defaultView;switch(null==a?void 0:a.type){case"image":(0,l.isModifierKey)(t)||t.shiftKey||!a.image.parentNode||("Escape"===o?(this.selectBeforeOrAfterElement(e,a.image),t.stopPropagation()):"Delete"!==o&&"Backspace"!==o&&this.selectBeforeOrAfterElement(e,a.image));break;case"range":if(o==s||o==c||o==u||o==d||"Tab"==o){var f=a.range.startContainer;this.state.tableSelection=this.parseTableSelection(f,f,e.getDOMHelper());var p="Tab"==o?this.getTabKey(t):o;this.state.tableSelection&&(null==i||i.requestAnimationFrame((function(){return n.handleSelectionInTable(p)})))}break;case"table":if(null===(r=this.state.tableSelection)||void 0===r?void 0:r.lastCo){var m=t.shiftKey,h=t.key;if(!m||h!=u&&h!=d)!m||h!=s&&h!=c?"Shift"==h||(0,l.isCharacterValue)(t)||h!=s&&h!=c&&h!=u&&h!=d||(this.setDOMSelection(null,this.state.tableSelection),null==i||i.requestAnimationFrame((function(){return n.handleSelectionInTable(h)}))):(this.updateTableSelectionFromKeyboard(h==s?-1:1,0),t.preventDefault());else{var g="rtl"==(null==i?void 0:i.getComputedStyle(this.state.tableSelection.table).direction);this.updateTableSelectionFromKeyboard(0,(h==u?-1:1)*(g?-1:1)),t.preventDefault()}}}},e.prototype.getTabKey=function(e){return e.shiftKey?"TabLeft":"TabRight"},e.prototype.handleSelectionInTable=function(e){var t,r,a,i,l,u;if(this.editor&&this.state.tableSelection){var d=this.editor.getDOMSelection(),f=this.editor.getDOMHelper();if("range"==(null==d?void 0:d.type)){var p=d.range,m=p.collapsed,h=p.startContainer,g=p.endContainer,v=p.commonAncestorContainer,b=d.isReverted,y=b?g:h,S=b?h:g,C=this.parseTableSelection(v,y,f);if(!C)return;var _=(0,n.findCoordinate)(null==C?void 0:C.parsedTable,S,f),T=this.state.tableSelection,E=T.parsedTable,M=T.firstCo,k=T.table;if(_&&C.table==k){if(_.col==M.col||e!=s&&e!=c)if("TabLeft"==e||"TabRight"==e)for(var O="TabLeft"==e,P=O?-1:1,w=null!==(a=_.row)&&void 0!==a?a:0,x=(null!==(i=_.col)&&void 0!==i?i:0)+P;;x+=P){if(x<0||x>=E[w].length){if((w+=P)<0){this.selectBeforeOrAfterElement(this.editor,C.table);break}if(w>=E.length){this.selectBeforeOrAfterElement(this.editor,C.table,!0);break}x=O?E[w].length-1:0}var D=E[w][x];if("string"!=typeof D){this.setRangeSelectionInTable(D,0,this.editor),_.row=w,_.col=x;break}}else this.state.tableSelection=null;else{var L=e==s?-1:1,F=null===(t=(0,o.findTableCellElement)(E,M))||void 0===t?void 0:t.cell,N=null;for(_={row:M.row+L,col:M.col};_.row>=0&&_.row<E.length&&(N=(null===(r=(0,o.findTableCellElement)(E,_))||void 0===r?void 0:r.cell)||null)==F;)_.row+=L;m&&N&&this.setRangeSelectionInTable(N,e==s?N.childNodes.length:0,this.editor)}m&&(_.col!=M.col||_.row!=M.row)&&_.row>=0&&_.row==E.length-1&&_.col==(null===(l=E[_.row])||void 0===l?void 0:l.length)-1&&(null===(u=this.editor)||void 0===u||u.announce({defaultStrings:"announceOnFocusLastCell"}))}!m&&_&&(this.state.tableSelection=C,this.updateTableSelection(_))}}},e.prototype.setRangeSelectionInTable=function(e,t,r){var n=(0,i.normalizePos)(e,t),o=n.node,a=n.offset,l=r.getDocument().createRange();l.setStart(o,a),l.collapse(!0),this.setDOMSelection({type:"range",range:l,isReverted:!1},null)},e.prototype.updateTableSelectionFromKeyboard=function(e,t){var r;if((null===(r=this.state.tableSelection)||void 0===r?void 0:r.lastCo)&&this.editor){var n=this.state.tableSelection,o=n.lastCo,a=n.parsedTable,i=o.row+e,l=o.col+t;i>=0&&i<a.length&&l>=0&&l<a[i].length&&this.updateTableSelection({row:i,col:l})}},e.prototype.selectBeforeOrAfterElement=function(e,t,r){var n=e.getDocument(),o=t.parentNode,a=o&&(0,l.toArray)(o.childNodes).indexOf(t);if(o&&null!==a&&a>=0){var i=n.createRange();i.setStart(o,a+(r?1:0)),i.collapse(),this.setDOMSelection({type:"range",range:i,isReverted:!1},null)}},e.prototype.getClickingImage=function(e){var t=e.target;return(0,l.isNodeOfType)(t,"ELEMENT_NODE")&&(0,l.isElementOfType)(t,"img")?t:null},e.prototype.parseTableSelection=function(e,t,r){var o,a,i;return(o=r.findClosestElementAncestor(e,"table"))&&o.isContentEditable&&(a=(0,l.parseTableCells)(o))&&(i=(0,n.findCoordinate)(a,t,r))?{table:o,parsedTable:a,firstCo:i,startNode:t}:null},e.prototype.updateTableSelection=function(e){if(this.state.tableSelection&&this.editor){var t=this.state.tableSelection,r=t.table,n=t.firstCo,o=t.parsedTable,a=t.startNode;if(t.lastCo||n.row!=e.row||n.col!=e.col)return this.state.tableSelection.lastCo=e,this.setDOMSelection({type:"table",table:r,firstRow:n.row,firstColumn:n.col,lastRow:e.row,lastColumn:e.col},{table:r,firstCo:n,lastCo:e,parsedTable:o,startNode:a}),!0}return!1},e.prototype.setDOMSelection=function(e,t){var r;null===(r=this.editor)||void 0===r||r.setDOMSelection(e),this.state.tableSelection=t},e.prototype.detachMouseEvent=function(){this.state.mouseDisposer&&(this.state.mouseDisposer(),this.state.mouseDisposer=void 0)},e.prototype.trySelectSingleImage=function(e){if(!e.range.collapsed){var t=(0,a.isSingleImageInSelection)(e.range);t&&this.setDOMSelection({type:"image",image:t},null)}},e}();t.createSelectionPlugin=function(e){return new f(e)}},2981:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findCoordinate=void 0,t.findCoordinate=function(e,t,r){var n=r.findClosestElementAncestor(t,"TH,TD"),o=null;return n&&e.some((function(e,t){var r=n?e.indexOf(n):-1;return o=r>=0?{row:t,col:r}:null})),o||e.some((function(e,r){var n=e.findIndex((function(e){return"object"==typeof e&&e.contains(t)}));return o=n>=0?{row:r,col:n}:null})),o}},4263:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSingleImageInSelection=void 0;var n=r(8871);t.isSingleImageInSelection=function(e){var t=function(e){return function(e){return!!e.getRangeAt}(e)?{startNode:e.anchorNode,endNode:e.focusNode,startOffset:e.anchorOffset,endOffset:e.focusOffset}:{startNode:e.startContainer,endNode:e.endContainer,startOffset:e.startOffset,endOffset:e.endOffset}}(e),r=t.startNode,o=t.endNode,a=t.startOffset,i=t.endOffset,l=Math.max(a,i),s=Math.min(a,i);if(r&&o&&r==o&&l-s==1){var c=null==r?void 0:r.childNodes.item(s);if((0,n.isNodeOfType)(c,"ELEMENT_NODE")&&(0,n.isElementOfType)(c,"img"))return c}return null}},4304:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizePos=void 0;var n=r(8871),o=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];t.normalizePos=function(e,t){var r,a,i,l,s=(0,n.isNodeOfType)(e,"TEXT_NODE")?null!==(a=null===(r=e.nodeValue)||void 0===r?void 0:r.length)&&void 0!==a?a:0:e.childNodes.length;for(t=Math.max(Math.min(t,s),0);null==e?void 0:e.lastChild;)if(t>=e.childNodes.length)e=e.lastChild,t=(0,n.isNodeOfType)(e,"TEXT_NODE")?null!==(l=null===(i=e.nodeValue)||void 0===i?void 0:i.length)&&void 0!==l?l:0:e.childNodes.length;else{var c=e.childNodes[t];if((0,n.isNodeOfType)(c,"ELEMENT_NODE")&&o.indexOf(c.tagName)>=0)break;e=e.childNodes[t],t=0}return{node:e,offset:t}}},426:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSnapshotsManager=void 0;var r=function(){function e(e){this.hasNewContentValue=!1,this.snapshots=null!=e?e:{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:1e7}}return Object.defineProperty(e.prototype,"hasNewContent",{get:function(){return this.hasNewContentValue},set:function(e){this.hasNewContentValue=e},enumerable:!1,configurable:!0}),e.prototype.canMove=function(e){var t=this.snapshots.currentIndex+e;return t>=0&&t<this.snapshots.snapshots.length},e.prototype.move=function(e){var t,r,n=null;return this.canMove(e)&&(this.snapshots.currentIndex+=e,this.snapshots.autoCompleteIndex=-1,n=this.snapshots.snapshots[this.snapshots.currentIndex]),null===(r=(t=this.snapshots).onChanged)||void 0===r||r.call(t,"move"),n},e.prototype.addSnapshot=function(e,t){var r,n,o=this.snapshots.snapshots[this.snapshots.currentIndex],a=o&&o.html==e.html&&!o.entityStates&&!e.entityStates,i=!o||function(e,t){return e.html!==t.html||e.entityStates&&t.entityStates&&e.entityStates!==t.entityStates||!e.entityStates&&t.entityStates}(o,e);if(this.snapshots.currentIndex<0||i){this.clearRedo(),this.snapshots.snapshots.push(e),this.snapshots.currentIndex++,this.snapshots.totalSize+=this.getSnapshotLength(e);for(var l=0;l<this.snapshots.snapshots.length&&this.snapshots.totalSize>this.snapshots.maxSize;)this.snapshots.totalSize-=this.getSnapshotLength(this.snapshots.snapshots[l]),l++;l>0&&(this.snapshots.snapshots.splice(0,l),this.snapshots.currentIndex-=l,this.snapshots.autoCompleteIndex>=0&&(this.snapshots.autoCompleteIndex-=l)),t&&(this.snapshots.autoCompleteIndex=this.snapshots.currentIndex)}else a&&this.snapshots.snapshots.splice(this.snapshots.currentIndex,1,e);null===(n=(r=this.snapshots).onChanged)||void 0===n||n.call(r,"add")},e.prototype.clearRedo=function(){var e,t;if(this.canMove(1)){for(var r=0,n=this.snapshots.currentIndex+1;n<this.snapshots.snapshots.length;n++)r+=this.getSnapshotLength(this.snapshots.snapshots[n]);this.snapshots.snapshots.splice(this.snapshots.currentIndex+1),this.snapshots.totalSize-=r,this.snapshots.autoCompleteIndex=-1,null===(t=(e=this.snapshots).onChanged)||void 0===t||t.call(e,"clear")}},e.prototype.canUndoAutoComplete=function(){return this.snapshots.autoCompleteIndex>=0&&this.snapshots.currentIndex-this.snapshots.autoCompleteIndex==1},e.prototype.getSnapshotLength=function(e){var t,r;return null!==(r=null===(t=e.html)||void 0===t?void 0:t.length)&&void 0!==r?r:0},e}();t.createSnapshotsManager=function(e){return new r(e)}},9465:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createUndoPlugin=void 0;var n=r(8871),o=r(426),a=r(4852),i="Backspace",l="Delete",s="Enter",c=function(){function e(e){this.editor=null,this.state={snapshotsManager:(0,o.createSnapshotsManager)(e.snapshots),isRestoring:!1,isNested:!1,autoCompleteInsertPoint:null,lastKeyPress:null}}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.willHandleEventExclusively=function(e){return!!this.editor&&"keyDown"==e.eventType&&e.rawEvent.key==i&&!e.rawEvent.ctrlKey&&this.canUndoAutoComplete(this.editor)},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"editorReady":var t=this.state.snapshotsManager,r=t.hasNewContent||t.canMove(-1),n=t.canMove(1);r||n||this.addUndoSnapshot();break;case"keyDown":this.onKeyDown(this.editor,e.rawEvent);break;case"keyPress":this.onKeyPress(this.editor,e.rawEvent);break;case"compositionEnd":this.clearRedoForInput(),this.addUndoSnapshot();break;case"contentChanged":this.onContentChanged(e);break;case"beforeKeyboardEditing":this.onBeforeKeyboardEditing(e.rawEvent);break;case"mouseDown":this.state.snapshotsManager.hasNewContent&&this.addUndoSnapshot()}},e.prototype.onKeyDown=function(e,t){var r=this.state.snapshotsManager;if(t.key==i&&!t.altKey||t.key==l){if(t.key==i&&!t.ctrlKey&&this.canUndoAutoComplete(e))t.preventDefault(),(0,a.undo)(e),this.state.autoCompleteInsertPoint=null,this.state.lastKeyPress=t.key;else if(!t.defaultPrevented){var o=e.getDOMSelection();!o||"range"==o.type&&o.range.collapsed&&this.state.lastKeyPress==t.key&&!this.isCtrlOrMetaPressed(e,t)||this.addUndoSnapshot(),r.hasNewContent=!0,this.state.lastKeyPress=t.key}}else(0,n.isCursorMovingKey)(t)?(r.hasNewContent&&this.addUndoSnapshot(),this.state.lastKeyPress=null):this.state.lastKeyPress!=i&&this.state.lastKeyPress!=l||r.hasNewContent&&this.addUndoSnapshot()},e.prototype.onKeyPress=function(e,t){if(!t.metaKey){var r=e.getDOMSelection();r&&("range"!=r.type||!r.range.collapsed)||" "==t.key&&" "!=this.state.lastKeyPress||t.key==s?(this.addUndoSnapshot(),t.key==s&&(this.state.snapshotsManager.hasNewContent=!0)):this.clearRedoForInput(),this.state.lastKeyPress=t.key}},e.prototype.onBeforeKeyboardEditing=function(e){e.key!=this.state.lastKeyPress&&this.addUndoSnapshot(),this.state.lastKeyPress=e.key,this.state.snapshotsManager.hasNewContent=!0},e.prototype.onContentChanged=function(e){this.state.isRestoring||e.source==n.ChangeSource.SwitchToDarkMode||e.source==n.ChangeSource.SwitchToLightMode||e.source==n.ChangeSource.Keyboard||this.clearRedoForInput()},e.prototype.clearRedoForInput=function(){this.state.snapshotsManager.clearRedo(),this.state.lastKeyPress=null,this.state.snapshotsManager.hasNewContent=!0},e.prototype.canUndoAutoComplete=function(e){var t,r=e.getDOMSelection();return this.state.snapshotsManager.canUndoAutoComplete()&&"range"==(null==r?void 0:r.type)&&r.range.collapsed&&r.range.startContainer==(null===(t=this.state.autoCompleteInsertPoint)||void 0===t?void 0:t.node)&&r.range.startOffset==this.state.autoCompleteInsertPoint.offset},e.prototype.addUndoSnapshot=function(){var e;null===(e=this.editor)||void 0===e||e.takeSnapshot(),this.state.autoCompleteInsertPoint=null},e.prototype.isCtrlOrMetaPressed=function(e,t){return e.getEnvironment().isMac?t.metaKey:t.ctrlKey},e}();t.createUndoPlugin=function(e){return new c(e)}},532:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Editor=void 0;var n=r(7582),o=r(5259),a=r(8871),i=function(){function e(e,t){var r,n=this;void 0===t&&(t={}),this.core=null,this.cloneOptionCallback=function(e,t){if("cache"!=t){var r=e.cloneNode(!0);if(n.isDarkMode()){var o=n.getColorManager();(0,a.transformColor)(r,!0,"darkToLight",o),r.style.color=r.style.color||"inherit",r.style.backgroundColor=r.style.backgroundColor||"inherit"}return r}},this.core=(0,o.createEditorCore)(e,t);var i=null!==(r=t.initialModel)&&void 0!==r?r:(0,a.createEmptyModel)(t.defaultSegmentFormat);this.core.api.setContentModel(this.core,i,{ignoreSelection:!0}),this.core.plugins.forEach((function(e){return e.initialize(n)}))}return e.prototype.dispose=function(){for(var e,t=this.getCore(),r=t.plugins.length-1;r>=0;r--){var n=t.plugins[r];try{n.dispose()}catch(r){null===(e=t.disposeErrorHandler)||void 0===e||e.call(t,n,r)}}t.darkColorHandler.reset(),this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.getContentModelCopy=function(e){var t=this.getCore();switch(e){case"connected":case"disconnected":return(0,a.cloneModel)(t.api.createContentModel(t,{processorOverride:{table:a.tableProcessor},tryGetFromCache:!1}),{includeCachedElement:this.cloneOptionCallback});case"clean":var r=(0,a.createDomToModelContextWithConfig)(t.environment.domToModelSettings.calculated,t.api.createEditorContext(t,!1));return(0,a.cloneModel)((0,a.domToContentModel)(t.physicalRoot,r),{includeCachedElement:this.cloneOptionCallback})}},e.prototype.getEnvironment=function(){return this.getCore().environment},e.prototype.getDOMSelection=function(){var e=this.getCore();return e.api.getDOMSelection(e)},e.prototype.setDOMSelection=function(e){var t=this.getCore();t.api.setDOMSelection(t,e)},e.prototype.setLogicalRoot=function(e){var t=this.getCore();t.api.setLogicalRoot(t,e)},e.prototype.formatContentModel=function(e,t,r){var n=this.getCore();n.api.formatContentModel(n,e,t,r)},e.prototype.getPendingFormat=function(){var e,t;return null!==(t=null===(e=this.getCore().format.pendingFormat)||void 0===e?void 0:e.format)&&void 0!==t?t:null},e.prototype.getDOMHelper=function(){return this.getCore().domHelper},e.prototype.takeSnapshot=function(e){var t=this.getCore();return t.api.addUndoSnapshot(t,!1,e?[e]:void 0)},e.prototype.restoreSnapshot=function(e){var t=this.getCore();t.api.restoreUndoSnapshot(t,e)},e.prototype.getDocument=function(){return this.getCore().physicalRoot.ownerDocument},e.prototype.focus=function(){var e=this.getCore();e.api.focus(e)},e.prototype.hasFocus=function(){return this.getCore().domHelper.hasFocus()},e.prototype.triggerEvent=function(e,t,r){void 0===r&&(r=!1);var o=this.getCore(),a=(0,n.__assign)({eventType:e},t);return o.api.triggerEvent(o,a,r),a},e.prototype.attachDomEvent=function(e){var t=this.getCore();return t.api.attachDomEvent(t,e)},e.prototype.getSnapshotsManager=function(){return this.getCore().undo.snapshotsManager},e.prototype.isDarkMode=function(){return this.getCore().lifecycle.isDarkMode},e.prototype.setDarkModeState=function(e){var t=this.getCore();!!e!=t.lifecycle.isDarkMode&&((0,a.transformColor)(t.physicalRoot,!1,e?"lightToDark":"darkToLight",t.darkColorHandler),t.lifecycle.isDarkMode=!!e,t.api.triggerEvent(t,{eventType:"contentChanged",source:e?a.ChangeSource.SwitchToDarkMode:a.ChangeSource.SwitchToLightMode},!0))},e.prototype.isInShadowEdit=function(){return!!this.getCore().lifecycle.shadowEditFragment},e.prototype.startShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!0)},e.prototype.stopShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!1)},e.prototype.getColorManager=function(){return this.getCore().darkColorHandler},e.prototype.getTrustedHTMLHandler=function(){return this.getCore().trustedHTMLHandler},e.prototype.getScrollContainer=function(){return this.getCore().domEvent.scrollContainer},e.prototype.getVisibleViewport=function(){return this.getCore().api.getVisibleViewport(this.getCore())},e.prototype.setEditorStyle=function(e,t,r){var n=this.getCore();n.api.setEditorStyle(n,e,t,r)},e.prototype.announce=function(e){var t=this.getCore();t.api.announce(t,e)},e.prototype.getCore=function(){if(!this.core)throw new Error("Editor is already disposed");return this.core},e}();t.Editor=i},4021:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDOMHelper=void 0;var n=r(8871),o=function(){function e(e){this.contentDiv=e}return e.prototype.queryElements=function(e){return(0,n.toArray)(this.contentDiv.querySelectorAll(e))},e.prototype.getTextContent=function(){return this.contentDiv.textContent||""},e.prototype.isNodeInEditor=function(e){return this.contentDiv.contains(e)},e.prototype.calculateZoomScale=function(){var e,t=(null===(e=this.contentDiv.getBoundingClientRect())||void 0===e?void 0:e.width)||0,r=this.contentDiv.offsetWidth;return r>0&&t>0?Math.round(t/r*100)/100:1},e.prototype.setDomAttribute=function(e,t){null===t?this.contentDiv.removeAttribute(e):this.contentDiv.setAttribute(e,t)},e.prototype.getDomAttribute=function(e){return this.contentDiv.getAttribute(e)},e.prototype.getDomStyle=function(e){return this.contentDiv.style[e]},e.prototype.findClosestElementAncestor=function(e,t){var r=(0,n.isNodeOfType)(e,"ELEMENT_NODE")?e:e.parentElement,o=t?null==r?void 0:r.closest(t):r;return o&&this.isNodeInEditor(o)&&o!=this.contentDiv?o:null},e.prototype.hasFocus=function(){var e=this.contentDiv.ownerDocument.activeElement;return!(!e||!this.contentDiv.contains(e))},e.prototype.isRightToLeft=function(){var e,t=this.contentDiv,r=null===(e=t.ownerDocument.defaultView)||void 0===e?void 0:e.getComputedStyle(t);return"rtl"==(null==r?void 0:r.direction)},e.prototype.getClientWidth=function(){var e,t=this.contentDiv,r=null===(e=t.ownerDocument.defaultView)||void 0===e?void 0:e.getComputedStyle(t),o=(0,n.parseValueWithUnit)(null==r?void 0:r.paddingLeft),a=(0,n.parseValueWithUnit)(null==r?void 0:r.paddingRight);return this.contentDiv.clientWidth-(o+a)},e}();t.createDOMHelper=function(e){return new o(e)}},848:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDarkColorHandler=void 0;var r=function(){function e(e,t,r){this.root=e,this.getDarkColor=t,this.knownColors=r}return e.prototype.updateKnownColor=function(e,t,r){var n=this;t&&r?(this.knownColors[t]||(this.knownColors[t]=r),e&&this.root.style.setProperty(t,r.darkModeColor)):e&&Object.keys(this.knownColors).forEach((function(e){n.root.style.setProperty(e,n.knownColors[e].darkModeColor)}))},e.prototype.reset=function(){var e=this;Object.keys(this.knownColors).forEach((function(t){e.root.style.removeProperty(t)}))},e}();t.createDarkColorHandler=function(e,t,n){return void 0===n&&(n={}),new r(e,t,n)}},5259:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkColorFallback=t.defaultTrustHtmlHandler=t.createEditorCore=void 0;var n=r(7582),o=r(4810),a=r(848),i=r(4021),l=r(7617),s=r(9785);function c(e,t){var r,n,o,a=null===(r=e.ownerDocument.defaultView)||void 0===r?void 0:r.navigator,i=null!==(n=null==a?void 0:a.userAgent)&&void 0!==n?n:"",s=null!==(o=null==a?void 0:a.appVersion)&&void 0!==o?o:"";return{domToModelSettings:(0,l.createDomToModelSettings)(t),modelToDomSettings:(0,l.createModelToDomSettings)(t),isMac:-1!=s.indexOf("Mac"),isAndroid:/android/i.test(i),isSafari:i.indexOf("Safari")>=0&&i.indexOf("Chrome")<0&&i.indexOf("Android")<0,isMobileOrTablet:u(i)}}function u(e){return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substring(0,4)))}function d(e){return e}function f(e){return e}t.createEditorCore=function(e,t){var r,l,u=(0,s.createEditorCorePlugins)(t,e);return(0,n.__assign)((0,n.__assign)({physicalRoot:e,logicalRoot:e,api:(0,n.__assign)((0,n.__assign)({},o.coreApiMap),t.coreApiOverride),originalApi:(0,n.__assign)({},o.coreApiMap),plugins:(0,n.__spreadArray)((0,n.__spreadArray)([u.cache,u.format,u.copyPaste,u.domEvent,u.selection,u.entity],(0,n.__read)((null!==(r=t.plugins)&&void 0!==r?r:[]).filter((function(e){return!!e}))),!1),[u.undo,u.contextMenu,u.lifecycle],!1),environment:c(e,t),darkColorHandler:(0,a.createDarkColorHandler)(e,null!==(l=t.getDarkColor)&&void 0!==l?l:f,t.knownColors),trustedHTMLHandler:t.trustedHTMLHandler||d,domHelper:(0,i.createDOMHelper)(e)},function(e){return{domEvent:e.domEvent.getState(),copyPaste:e.copyPaste.getState(),cache:e.cache.getState(),format:e.format.getState(),lifecycle:e.lifecycle.getState(),entity:e.entity.getState(),selection:e.selection.getState(),contextMenu:e.contextMenu.getState(),undo:e.undo.getState()}}(u)),{disposeErrorHandler:t.disposeErrorHandler})},t.defaultTrustHtmlHandler=d,t.getDarkColorFallback=f},7617:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createModelToDomSettings=t.createDomToModelSettings=void 0;var n=r(8871),o=r(2291),a=r(7018);t.createDomToModelSettings=function(e){var t,r={processorOverride:{table:o.tablePreProcessor}},a=null!==(t=e.defaultDomToModelOptions)&&void 0!==t?t:{};return{builtIn:r,customized:a,calculated:(0,n.createDomToModelConfig)([r,a])}},t.createModelToDomSettings=function(e){var t,r={metadataAppliers:{listItem:a.listItemMetadataApplier,listLevel:a.listLevelMetadataApplier}},o=null!==(t=e.defaultModelToDomOptions)&&void 0!==t?t:{};return{builtIn:r,customized:o,calculated:(0,n.createModelToDomConfig)([r,o])}}},4781:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paste=t.redo=t.undo=t.exportContent=t.createModelFromHtml=t.Editor=void 0;var n=r(532);Object.defineProperty(t,"Editor",{enumerable:!0,get:function(){return n.Editor}});var o=r(300);Object.defineProperty(t,"createModelFromHtml",{enumerable:!0,get:function(){return o.createModelFromHtml}});var a=r(388);Object.defineProperty(t,"exportContent",{enumerable:!0,get:function(){return a.exportContent}});var i=r(4852);Object.defineProperty(t,"undo",{enumerable:!0,get:function(){return i.undo}});var l=r(4986);Object.defineProperty(t,"redo",{enumerable:!0,get:function(){return l.redo}});var s=r(710);Object.defineProperty(t,"paste",{enumerable:!0,get:function(){return s.paste}})},351:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.containerSizeFormatParser=void 0,t.containerSizeFormatParser=function(e,t){"DIV"==t.tagName&&(delete e.width,delete e.height)}},7018:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listLevelMetadataApplier=t.listItemMetadataApplier=void 0;var n=r(8871),o=/\$\{(\w+)\}/;function a(e,t,r){if("OL"==e){var a=(0,n.getOrderedListNumberStr)(t,null!=r?r:1),i=n.OrderedListStyleMap[t];return i?i.replace(o,a):void 0}return n.UnorderedListStyleMap[t]}function i(e,t){var r="OL"==t?n.OrderedListStyleMap[e]:n.UnorderedListStyleMap[e];return(null==r?void 0:r.indexOf('"'))>=0}t.listItemMetadataApplier={metadataDefinition:n.ListMetadataDefinition,applierFunction:function(e,t,r){var o,l=r.listFormat.nodeStack.length-2;if(l>=0){var s=null!==(o=r.listFormat.nodeStack[l+1].listType)&&void 0!==o?o:"OL",c=(0,n.getAutoListStyleType)(s,null!=e?e:{},l);void 0!==c&&(i(c,s)?t.listStyleType=a(s,c,r.listFormat.threadItemCounts[l]):delete t.listStyleType)}}},t.listLevelMetadataApplier={metadataDefinition:n.ListMetadataDefinition,applierFunction:function(e,t,r){var o,l=r.listFormat.nodeStack.length-2;if(l>=0){var s=null!==(o=r.listFormat.nodeStack[l+1].listType)&&void 0!==o?o:"OL",c=(0,n.getAutoListStyleType)(s,null!=e?e:{},l);if(void 0!==c)if(i(c,s))delete t.listStyleType;else{var u=a(s,c,r.listFormat.threadItemCounts[l]);u&&(t.listStyleType=u)}}}}},3311:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pasteBlockEntityParser=t.onCreateCopyEntityNode=void 0;var n=r(8871),o="_EBlock",a="100%",i="inline-block";t.onCreateCopyEntityNode=function(e,t){var r=e;r&&r.wrapper&&"Entity"==r.blockType&&(0,n.isNodeOfType)(t,"ELEMENT_NODE")&&(0,n.isElementOfType)(t,"div")&&!(0,n.isBlockElement)(r.wrapper)&&r.wrapper.style.display==i&&r.wrapper.style.width==a&&(t.classList.add(o),t.style.display="block",t.style.width="")},t.pasteBlockEntityParser=function(e,t){t.classList.contains(o)&&(t.classList.remove(o),t.style.display=i,t.style.width=a)}},5452:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pasteDisplayFormatParser=void 0,t.pasteDisplayFormatParser=function(e,t){var r=t.style.display;r&&"flex"!=r&&(e.display=r)}},59:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPasteEntityProcessor=void 0;var n=r(341),o={position:!1};t.createPasteEntityProcessor=function(e){var t=n.AllowedTags.concat(e.additionalAllowedTags),r=n.DisallowedTags.concat(e.additionalDisallowedTags),a=Object.assign({},o,e.styleSanitizers),i=e.attributeSanitizers;return function(e,o,l){var s=(0,n.sanitizeElement)(o,t,r,a,i);s&&l.defaultElementProcessors.entity(e,s,l)}}},612:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPasteGeneralProcessor=t.removeDisplayFlex=void 0;var n=r(8871),o=r(341);t.removeDisplayFlex=function(e){return"flex"==e?null:e};var a={position:!1,display:t.removeDisplayFlex};t.createPasteGeneralProcessor=function(e){var t=o.AllowedTags.concat(e.additionalAllowedTags),r=o.DisallowedTags.concat(e.additionalDisallowedTags),i=Object.assign({},a,e.styleSanitizers),l=e.attributeSanitizers;return function(e,a,s){var c=a.tagName.toLowerCase(),u=t.indexOf(c)>=0?function(e,t,r){var a,s,c=(0,o.createSanitizedElement)(t.ownerDocument,t.tagName,t.attributes,i,l);(0,n.moveChildNodes)(c,t),null===(s=(a=r.defaultElementProcessors)["*"])||void 0===s||s.call(a,e,c,r)}:r.indexOf(c)>=0?void 0:s.defaultElementProcessors.span;null==u||u(e,a,s)}}},3046:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pasteTextProcessor=void 0;var n=r(8871);t.pasteTextProcessor=function(e,t,r){var o,a,i=r.blockFormat.whiteSpace;(0,n.isWhiteSpacePreserved)(i)&&(t.nodeValue=null!==(a=null===(o=t.nodeValue)||void 0===o?void 0:o.replace(/\u0020\u0020/g,"  "))&&void 0!==a?a:""),r.defaultElementProcessors["#text"](e,t,r)}},2291:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tablePreProcessor=void 0;var n=r(8871);t.tablePreProcessor=function(e,t,r){var o=function(e,t){var r=(0,n.getSelectionRootNode)(t.selection);return(0,n.hasMetadata)(e)||t.isInSelection||r&&e.contains(r)}(t,r)?n.tableProcessor:n.entityProcessor;o(e,t,r)}},1105:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultContentModelFormatMap=void 0,t.defaultContentModelFormatMap={a:{underline:!0,textColor:void 0},blockquote:{marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},code:{fontFamily:"monospace"},h1:{fontWeight:"bold",fontSize:"2em"},h2:{fontWeight:"bold",fontSize:"1.5em"},h3:{fontWeight:"bold",fontSize:"1.17em"},h4:{fontWeight:"bold",fontSize:"1em"},h5:{fontWeight:"bold",fontSize:"0.83em"},h6:{fontWeight:"bold",fontSize:"0.67em"},p:{marginTop:"1em",marginBottom:"1em"},pre:{fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"}}},3413:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultHTMLStyleMap=void 0;var n=r(7582),o={display:"block"};t.defaultHTMLStyleMap={address:o,article:o,aside:o,b:{fontWeight:"bold"},blockquote:{display:"block",marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},br:o,center:{display:"block",textAlign:"center"},dd:o,div:o,dl:o,dt:o,em:{fontStyle:"italic"},fieldset:o,figcaption:o,figure:o,footer:o,form:o,h1:{display:"block",fontWeight:"bold",fontSize:"2em"},h2:{display:"block",fontWeight:"bold",fontSize:"1.5em"},h3:{display:"block",fontWeight:"bold",fontSize:"1.17em"},h4:{display:"block",fontWeight:"bold"},h5:{display:"block",fontWeight:"bold",fontSize:"0.83em"},h6:{display:"block",fontWeight:"bold",fontSize:"0.67em"},header:o,hr:o,i:{fontStyle:"italic"},li:{display:"list-item"},main:o,nav:o,ol:(0,n.__assign)((0,n.__assign)({},o),{paddingInlineStart:"40px"}),p:{display:"block",marginTop:"1em",marginBottom:"1em"},pre:{display:"block",fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"},s:{textDecoration:"line-through"},section:o,strike:{textDecoration:"line-through"},strong:{fontWeight:"bold"},sub:{verticalAlign:"sub",fontSize:"smaller"},sup:{verticalAlign:"super",fontSize:"smaller"},table:{display:"table",boxSizing:"border-box"},td:{display:"table-cell"},th:{display:"table-cell"},u:{textDecoration:"underline"},ul:(0,n.__assign)((0,n.__assign)({},o),{paddingInlineStart:"40px"})}},7383:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BulletListType=void 0,t.BulletListType={Min:1,Disc:1,Dash:2,Square:3,ShortArrow:4,LongArrow:5,UnfilledArrow:6,Hyphen:7,DoubleLongArrow:8,Circle:9,Max:9}},5442:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeSource=void 0,t.ChangeSource={AutoLink:"AutoLink",CreateLink:"CreateLink",Format:"Format",ImageResize:"ImageResize",Paste:"Paste",SetContent:"SetContent",Cut:"Cut",Drop:"Drop",InsertEntity:"InsertEntity",SwitchToDarkMode:"SwitchToDarkMode",SwitchToLightMode:"SwitchToLightMode",ListChain:"ListChain",Keyboard:"Keyboard",AutoFormat:"AutoFormat"}},2897:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberingListType=void 0,t.NumberingListType={Min:1,Decimal:1,DecimalDash:2,DecimalParenthesis:3,DecimalDoubleParenthesis:4,LowerAlpha:5,LowerAlphaParenthesis:6,LowerAlphaDoubleParenthesis:7,LowerAlphaDash:8,UpperAlpha:9,UpperAlphaParenthesis:10,UpperAlphaDoubleParenthesis:11,UpperAlphaDash:12,LowerRoman:13,LowerRomanParenthesis:14,LowerRomanDoubleParenthesis:15,LowerRomanDash:16,UpperRoman:17,UpperRomanParenthesis:18,UpperRomanDoubleParenthesis:19,UpperRomanDash:20,Max:20}},913:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.OrderedListStyleMap=void 0;var o=r(2897);t.OrderedListStyleMap=((n={})[o.NumberingListType.Decimal]="decimal",n[o.NumberingListType.DecimalDash]='"${Number}- "',n[o.NumberingListType.DecimalParenthesis]='"${Number}) "',n[o.NumberingListType.DecimalDoubleParenthesis]='"(${Number}) "',n[o.NumberingListType.LowerAlpha]="lower-alpha",n[o.NumberingListType.LowerAlphaDash]='"${LowerAlpha}- "',n[o.NumberingListType.LowerAlphaParenthesis]='"${LowerAlpha}) "',n[o.NumberingListType.LowerAlphaDoubleParenthesis]='"(${LowerAlpha}) "',n[o.NumberingListType.UpperAlpha]="upper-alpha",n[o.NumberingListType.UpperAlphaDash]='"${UpperAlpha}- "',n[o.NumberingListType.UpperAlphaParenthesis]='"${UpperAlpha}) "',n[o.NumberingListType.UpperAlphaDoubleParenthesis]='"(${UpperAlpha}) "',n[o.NumberingListType.LowerRoman]="lower-roman",n[o.NumberingListType.LowerRomanDash]='"${LowerRoman}- "',n[o.NumberingListType.LowerRomanParenthesis]='"${LowerRoman}) "',n[o.NumberingListType.LowerRomanDoubleParenthesis]='"(${LowerRoman}) "',n[o.NumberingListType.UpperRoman]="upper-roman",n[o.NumberingListType.UpperRomanDash]='"${UpperRoman}- "',n[o.NumberingListType.UpperRomanParenthesis]='"${UpperRoman}) "',n[o.NumberingListType.UpperRomanDoubleParenthesis]='"(${UpperRoman}) "',n)},5074:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableBorderFormat=void 0,t.TableBorderFormat={Min:0,Default:0,ListWithSideBorders:1,NoHeaderBorders:2,NoSideBorders:3,FirstColumnHeaderExternal:4,EspecialType1:5,EspecialType2:6,EspecialType3:7,Clear:8,Max:8}},123:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.UnorderedListStyleMap=void 0;var o=r(7383);t.UnorderedListStyleMap=((n={})[o.BulletListType.Disc]="disc",n[o.BulletListType.Square]='"∎ "',n[o.BulletListType.Circle]="circle",n[o.BulletListType.Dash]='"- "',n[o.BulletListType.LongArrow]='"➔ "',n[o.BulletListType.DoubleLongArrow]='"➔ "',n[o.BulletListType.ShortArrow]='"➢ "',n[o.BulletListType.UnfilledArrow]='"➪ "',n[o.BulletListType.Hyphen]='"— "',n)},5953:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildFormatParsers=t.createDomToModelConfig=t.createDomToModelContextWithConfig=t.createDomToModelContext=void 0;var n=r(7582),o=r(4153),a=r(546),i=r(5606);function l(e,t){return Object.assign({},t,{isInSelection:!1},{blockFormat:(null==t?void 0:t.isRootRtl)?{direction:"rtl"}:{},segmentFormat:{},listFormat:{levels:[],threadItemCounts:[]}},{link:{format:{},dataset:{}},code:{format:{}},blockDecorator:{format:{},tagName:""}},e)}function s(e){return{elementProcessors:Object.assign.apply(Object,(0,n.__spreadArray)([{},o.defaultProcessorMap],(0,n.__read)(e.map((function(e){return null==e?void 0:e.processorOverride}))),!1)),formatParsers:c(e.map((function(e){return null==e?void 0:e.formatParserOverride})),e.map((function(e){return null==e?void 0:e.additionalFormatParsers}))),defaultElementProcessors:o.defaultProcessorMap,defaultFormatParsers:i.defaultFormatParsers}}function c(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var r=Object.assign.apply(Object,(0,n.__spreadArray)([{}],(0,n.__read)(e),!1)),o=(0,a.getObjectKeys)(i.defaultFormatKeysPerCategory).reduce((function(e,o){var a,l=(a=i.defaultFormatKeysPerCategory[o].map((function(e){return void 0===r[e]?i.defaultFormatParsers[e]:r[e]}))).concat.apply(a,(0,n.__spreadArray)([],(0,n.__read)(t.map((function(e){var t;return null!==(t=null==e?void 0:e[o])&&void 0!==t?t:[]}))),!1));return e[o]=l,e}),{text:[]});return t.forEach((function(e){(null==e?void 0:e.text)&&(o.text=o.text.concat(e.text))})),o}t.createDomToModelContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l(s(t),e)},t.createDomToModelContextWithConfig=l,t.createDomToModelConfig=s,t.buildFormatParsers=c},4153:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultProcessorMap=void 0;var n=r(6861),o=r(1438),a=r(5035),i=r(2162),l=r(84),s=r(1447),c=r(8167),u=r(1291),d=r(6779),f=r(9750),p=r(4551),m=r(2395),h=r(3780),g=r(7659),v=r(4030),b=r(8604),y=r(3919),S=r(793),C=r(6214),_=r(1881);t.defaultProcessorMap={a:g.linkProcessor,b:h.knownElementProcessor,blockquote:h.knownElementProcessor,br:n.brProcessor,code:a.codeProcessor,div:h.knownElementProcessor,em:h.knownElementProcessor,font:c.fontProcessor,i:h.knownElementProcessor,img:m.imageProcessor,h1:f.headingProcessor,h2:f.headingProcessor,h3:f.headingProcessor,h4:f.headingProcessor,h5:f.headingProcessor,h6:f.headingProcessor,hr:p.hrProcessor,li:v.listItemProcessor,ol:b.listProcessor,p:y.pProcessor,pre:u.formatContainerProcessor,s:h.knownElementProcessor,section:h.knownElementProcessor,span:h.knownElementProcessor,strike:h.knownElementProcessor,strong:h.knownElementProcessor,sub:h.knownElementProcessor,sup:h.knownElementProcessor,table:S.tableProcessor,u:h.knownElementProcessor,ul:b.listProcessor,"*":d.generalProcessor,"#text":C.textProcessor,textWithSelection:_.textWithSelectionProcessor,element:l.elementProcessor,entity:s.entityProcessor,child:o.childProcessor,delimiter:i.delimiterProcessor}},6373:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domToContentModel=void 0;var n=r(2178),o=r(4527);t.domToContentModel=function(e,t){var r,a=(0,n.createContentModelDocument)(t.defaultFormat);return"range"==(null===(r=t.selection)||void 0===r?void 0:r.type)&&t.selection.isReverted&&(a.hasRevertedRangeSelection=!0),t.elementProcessors.child(a,e,t),(0,o.normalizeContentModel)(a),a}},7665:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blockProcessor=void 0;var n=r(7582),o=r(6954),a=r(1291),i=r(673),l=r(2487),s=["A","CODE"];t.blockProcessor=function(e,t,r,c){var u=r.blockDecorator.tagName?r.blockDecorator:void 0,d=s.indexOf(t.tagName)>=0;(0,l.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var f=(0,n.__assign)({},r.blockFormat);if((0,l.parseFormat)(t,r.formatParsers.container,f,r),a.ContextStyles.forEach((function(e){f[e]&&(r.blockFormat[e]=f[e])})),!d){var p=(0,i.createParagraph)(!1,f,c,u);(0,o.addBlock)(e,p)}r.elementProcessors.child(e,t,r)}},6861:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.brProcessor=void 0;var n=r(8613),o=r(5713);t.brProcessor=function(e,t,r){var a,i=(0,o.createBr)(r.segmentFormat);r.isInSelection&&(i.isSelected=!0);var l=(0,n.addSegment)(e,i,r.blockFormat);null===(a=r.domIndexer)||void 0===a||a.onSegment(t,l,[i])}},1438:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleRegularSelection=t.processChildNode=t.childProcessor=void 0;var n=r(7582),o=r(3344),a=r(4714),i=r(8882);function l(e,t,r){(0,i.isNodeOfType)(t,"ELEMENT_NODE")&&"none"!=t.style.display?r.elementProcessors.element(e,t,r):(0,i.isNodeOfType)(t,"TEXT_NODE")&&r.elementProcessors["#text"](e,t,r)}function s(e,t,r,n,a,i){var l;e==n&&(t.isInSelection=!0,(0,o.addSelectionMarker)(r,t,i,e)),e==a&&"range"==(null===(l=t.selection)||void 0===l?void 0:l.type)&&(t.selection.range.collapsed||(0,o.addSelectionMarker)(r,t,i,e),t.isInSelection=!1)}t.childProcessor=function(e,t,r){for(var o=(0,n.__read)((0,a.getRegularSelectionOffsets)(r,t),2),i=o[0],c=o[1],u=0,d=t.firstChild;d;d=d.nextSibling)s(u,r,e,i,c,t),l(e,d,r),u++;s(u,r,e,i,c,t)},t.processChildNode=l,t.handleRegularSelection=s},5035:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codeProcessor=void 0;var n=r(3780),o=r(2487),a=r(4968);t.codeProcessor=function(e,t,r){(0,a.stackFormat)(r,{code:"codeDefault"},(function(){(0,o.parseFormat)(t,r.formatParsers.code,r.code.format,r),(0,n.knownElementProcessor)(e,t,r)}))}},2162:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delimiterProcessor=void 0;var n=r(3344);t.delimiterProcessor=function(e,t,r){var o,a,i="range"==(null===(o=r.selection)||void 0===o?void 0:o.type)?r.selection.range:null;i&&(t.contains(i.startContainer)&&(r.isInSelection=!0,(0,n.addSelectionMarker)(e,r)),"range"==(null===(a=r.selection)||void 0===a?void 0:a.type)&&t.contains(i.endContainer)&&(r.selection.range.collapsed||(0,n.addSelectionMarker)(e,r),r.isInSelection=!1))}},84:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elementProcessor=void 0;var n=r(3566);t.elementProcessor=function(e,t,r){var o=t.tagName.toLowerCase(),a=function(e,t){return(0,n.isEntityElement)(e)||"false"==e.contentEditable?t.elementProcessors.entity:null}(t,r)||function(e,t){return(0,n.isEntityDelimiter)(e)?t.elementProcessors.delimiter:null}(t,r)||r.elementProcessors[o]||o.indexOf(":")>=0&&r.elementProcessors.child||r.elementProcessors["*"];a(e,t,r)}},1447:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entityProcessor=void 0;var n=r(6954),o=r(8613),a=r(7974),i=r(9630),l=r(2487),s=r(4968);t.entityProcessor=function(e,t,r){var c=(0,i.isBlockElement)(t)||"inline-block"==t.style.display&&"100%"==t.style.width;(0,s.stackFormat)(r,{segment:c?"empty":void 0,paragraph:"empty"},(function(){var i,s=(0,a.createEntity)(t,!0,r.segmentFormat);if((0,l.parseFormat)(t,r.formatParsers.entity,s.entityFormat,r),r.isInSelection&&(s.isSelected=!0),c)(0,n.addBlock)(e,s);else{var u=(0,o.addSegment)(e,s);null===(i=r.domIndexer)||void 0===i||i.onSegment(t,u,[s])}}))}},8167:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontProcessor=void 0;var n=r(9630),o=r(2487),a=r(4968),i=["10px","13px","16px","18px","24px","32px","48px"];t.fontProcessor=function(e,t,r){(0,a.stackFormat)(r,{segment:(0,n.isBlockElement)(t)?"shallowCloneForBlock":"shallowClone"},(function(){var n,a,l=t.getAttribute("face"),s=(n=t.getAttribute("size"),a=parseInt(n||""),Number.isNaN(a)?void 0:a<1?i[0]:a>i.length?i[i.length-1]:i[a-1]),c=t.getAttribute("color"),u=r.segmentFormat;l&&(u.fontFamily=l),s&&(u.fontSize=s),c&&(u.textColor=c),(0,o.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r),r.elementProcessors.child(e,t,r)}))}},1291:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatContainerProcessor=t.ContextStyles=void 0;var n=r(7582),o=r(6954),a=r(1096),i=r(673),l=r(9408),s=r(2487),c=r(1966),u=r(4968);t.ContextStyles=["marginLeft","marginRight","paddingLeft","paddingRight"],t.formatContainerProcessor=function(e,r,d){(0,u.stackFormat)(d,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){(0,s.parseFormat)(r,d.formatParsers.block,d.blockFormat,d),(0,s.parseFormat)(r,d.formatParsers.segmentOnBlock,d.segmentFormat,d);var i=(0,n.__assign)({},d.blockFormat);(0,s.parseFormat)(r,d.formatParsers.container,i,d);var u="block"==(0,l.getDefaultStyle)(r).display?r.tagName.toLowerCase():"div",f=(0,a.createFormatContainer)(u,i);if(t.ContextStyles.forEach((function(e){delete d.blockFormat[e]})),d.elementProcessors.child(f,r,d),r.style.fontSize&&0==parseInt(r.style.fontSize)&&(f.zeroFontSize=!0),function(e){var t=e.blocks[0];return"div"==e.tagName&&1==e.blocks.length&&"Paragraph"==t.blockType&&t.isImplicit}(f)){var p=f.blocks[0];f.zeroFontSize&&(p.segmentFormat=Object.assign({},p.segmentFormat,{fontSize:"0"})),Object.assign(p.format,f.format),(0,c.setParagraphNotImplicit)(p),(0,o.addBlock)(e,p)}else(0,o.addBlock)(e,f)})),(0,o.addBlock)(e,(0,i.createParagraph)(!0,d.blockFormat))}},6779:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generalProcessor=void 0;var n=r(6954),o=r(6630),a=r(8613),i=r(513),l=r(8465),s=r(9630),c=r(2487),u=r(4968),d=function(e,t,r){var o=(0,i.createGeneralBlock)(t),a=r.isInSelection;(0,u.stackFormat)(r,{segment:"empty",paragraph:"empty",link:"empty"},(function(){(0,n.addBlock)(e,o),(0,c.parseFormat)(t,r.formatParsers.general,o.format,r),r.elementProcessors.child(o,t,r)})),a&&r.isInSelection&&(o.isSelected=!0)},f=function(e,t,r){var n,i=(0,l.createGeneralSegment)(t,r.segmentFormat),s=r.isInSelection;(0,o.addDecorators)(i,r);var d=(0,a.addSegment)(e,i);null===(n=r.domIndexer)||void 0===n||n.onSegment(t,d,[i]),(0,u.stackFormat)(r,{segment:"empty"},(function(){(0,c.parseFormat)(t,r.formatParsers.general,i.format,r),r.elementProcessors.child(i,t,r)})),s&&r.isInSelection&&(i.isSelected=!0)};t.generalProcessor=function(e,t,r){((0,s.isBlockElement)(t)?d:f)(e,t,r)}},9750:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.headingProcessor=void 0;var n=r(6954),o=r(7665),a=r(673),i=r(4002),l=r(546),s=r(2487),c=r(4968);t.headingProcessor=function(e,t,r){(0,c.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone",blockDecorator:"empty"},(function(){var n={};(0,s.parseFormat)(t,r.formatParsers.segmentOnBlock,n,r),(0,l.getObjectKeys)(n).forEach((function(e){delete r.segmentFormat[e]})),r.blockDecorator=(0,i.createParagraphDecorator)(t.tagName,n),(0,o.blockProcessor)(e,t,r)})),(0,n.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat))}},4551:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hrProcessor=void 0;var n=r(6954),o=r(9002),a=r(2487),i=r(4968);t.hrProcessor=function(e,t,r){(0,i.stackFormat)(r,{paragraph:"shallowClone"},(function(){(0,a.parseFormat)(t,r.formatParsers.divider,r.blockFormat,r);var i=(0,o.createDivider)("hr",r.blockFormat);t.size&&(i.size=t.size),r.isInSelection&&(i.isSelected=!0),(0,n.addBlock)(e,i)}))}},2395:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.imageProcessor=void 0;var n=r(6630),o=r(8613),a=r(1143),i=r(2487),l=r(4968);t.imageProcessor=function(e,t,r){(0,l.stackFormat)(r,{segment:"shallowClone"},(function(){var l,s,c,u=r.segmentFormat,d=null!==(l=t.getAttribute("src"))&&void 0!==l?l:"";(0,i.parseFormat)(t,r.formatParsers.segment,u,r),(0,i.parseFormat)(t,r.formatParsers.image,u,r),(0,i.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var f=(0,a.createImage)(d,u),p=t.alt,m=t.title;(0,i.parseFormat)(t,r.formatParsers.dataset,f.dataset,r),(0,n.addDecorators)(f,r),p&&(f.alt=p),m&&(f.title=m),r.isInSelection&&(f.isSelected=!0),"image"==(null===(s=r.selection)||void 0===s?void 0:s.type)&&r.selection.image==t&&(f.isSelectedAsImageSelection=!0,f.isSelected=!0);var h=(0,o.addSegment)(e,f);null===(c=r.domIndexer)||void 0===c||c.onSegment(t,h,[f])}))}},3780:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.knownElementProcessor=void 0;var n=r(6954),o=r(7665),a=r(673),i=r(1291),l=r(9408),s=r(9630),c=r(2487),u=r(4968),d=["marginBottom","marginTop","paddingBottom","paddingTop","paddingLeft","paddingRight","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","width","height","maxWidth","maxHeight","minWidth","minHeight"],f=["H1","H2","H3","H4","H5","H6","P","A"],p=["A","CODE"];t.knownElementProcessor=function(e,t,r){var m=(0,s.isBlockElement)(t);if((m||"inline-block"==t.style.display)&&function(e,t){if(f.indexOf(e.tagName)>=0)return!1;var r=e.style,n=(0,l.getDefaultStyle)(e),o=r.getPropertyValue("background-color");return!(!o||"transparent"==o)||(!!d.some((function(e){return parseInt(r[e]||n[e]||"")>0}))||("auto"==r.marginLeft||"auto"==r.marginRight||!!e.getAttribute("align")))}(t))(0,i.formatContainerProcessor)(e,t,r);else if(m){var h=r.blockDecorator.tagName?r.blockDecorator:void 0,g=p.indexOf(t.tagName)>=0;(0,u.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){var n={};(0,c.parseFormat)(t,r.formatParsers.segmentOnBlock,n,r),Object.assign(r.segmentFormat,n),(0,o.blockProcessor)(e,t,r,n)})),m&&!g&&(0,n.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat,void 0,h))}else(0,u.stackFormat)(r,{segment:"shallowClone",paragraph:"shallowClone",link:"cloneFormat"},(function(){(0,c.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r),r.link.format.href&&"A"!=t.tagName&&(0,c.parseFormat)(t,r.formatParsers.segmentUnderLink,r.link.format,r),r.elementProcessors.child(e,t,r)}))}},7659:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.linkProcessor=void 0;var n=r(3780),o=r(2487),a=r(4968);t.linkProcessor=function(e,t,r){t.hasAttribute("href")?(0,a.stackFormat)(r,{link:"linkDefault"},(function(){(0,o.parseFormat)(t,r.formatParsers.link,r.link.format,r),(0,o.parseFormat)(t,r.formatParsers.dataset,r.link.dataset,r),(0,n.knownElementProcessor)(e,t,r)})):(0,n.knownElementProcessor)(e,t,r)}},4030:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listItemProcessor=void 0;var n=r(5297),o=r(2487),a=r(4968);t.listItemProcessor=function(e,t,r){var i,l=r.listFormat;if(l.listParent&&l.levels.length>0)(0,a.stackFormat)(r,{segment:"shallowCloneForBlock"},(function(){(0,o.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r);var e=(0,n.createListItem)(l.levels,r.segmentFormat);(0,o.parseFormat)(t,r.formatParsers.listItemElement,e.format,r),l.listParent.blocks.push(e),(0,o.parseFormat)(t,r.formatParsers.listItemThread,e.levels[e.levels.length-1].format,r),r.elementProcessors.child(e,t,r);var a=e.blocks[0];1==e.blocks.length&&"Paragraph"==a.blockType&&a.isImplicit&&(Object.assign(e.format,a.format),a.format={})}));else{var s=null===(i=l.listParent)||void 0===i?void 0:i.blocks,c=null==s?void 0:s[(null==s?void 0:s.length)-1];r.elementProcessors["*"]("BlockGroup"==(null==c?void 0:c.blockType)?c:e,t,r)}}},8604:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listProcessor=void 0;var n=r(6549),o=r(2487),a=r(4968);t.listProcessor=function(e,t,r){(0,a.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},(function(){var a=(0,n.createListLevel)(t.tagName,r.blockFormat),i=r.listFormat;(0,o.parseFormat)(t,r.formatParsers.dataset,a.dataset,r),(0,o.parseFormat)(t,r.formatParsers.listLevelThread,a.format,r),(0,o.parseFormat)(t,r.formatParsers.listLevel,a.format,r),(0,o.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r);var l=i.listParent;i.listParent=i.listParent||e,i.levels.push(a);try{r.elementProcessors.child(e,t,r)}finally{i.levels.pop(),i.listParent=l}}))}},3919:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pProcessor=void 0;var n=r(6954),o=r(7665),a=r(673),i=r(4002),l=r(2487),s=r(4968);t.pProcessor=function(e,t,r){(0,s.stackFormat)(r,{blockDecorator:"empty",segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){r.blockDecorator=(0,i.createParagraphDecorator)(t.tagName);var n={};(0,l.parseFormat)(t,r.formatParsers.segmentOnBlock,n,r),Object.assign(r.segmentFormat,n),(0,o.blockProcessor)(e,t,r,n)})),(0,n.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat))}},793:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tableProcessor=void 0;var n=r(7582),o=r(6954),a=r(711),i=r(804),l=r(5627),s=r(6714),c=r(8882),u=r(2487),d=r(4406),f=r(4968);function p(e){for(var t=[],r=0,n=e.length-1;n>=0;n--)if("number"==typeof(o=e[n])){r=o;break}for(n=e.length-2;n>=0;n--){var o;void 0===(o=e[n])?t[n]=0:(t[n]=r-o,r=o)}return t}t.tableProcessor=function(e,t,r){(0,f.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},(function(){var m,h;(0,u.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var g=(0,a.createTable)(t.rows.length,r.blockFormat),v="table"==(null===(m=r.selection)||void 0===m?void 0:m.type)?r.selection:null,b=(null==v?void 0:v.table)==t;r.allowCacheElement&&(g.cachedElement=t),null===(h=r.domIndexer)||void 0===h||h.onTable(t,g),(0,u.parseFormat)(t,r.formatParsers.table,g.format,r),(0,u.parseFormat)(t,r.formatParsers.tableBorder,g.format,r),(0,u.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r),(0,u.parseFormat)(t,r.formatParsers.dataset,g.dataset,r),(0,o.addBlock)(e,g);for(var y=[0],S=function(e,t,r){for(var n,o,a=0,i=!1,l=e.firstChild;l;l=l.nextSibling)if((0,c.isNodeOfType)(l,"ELEMENT_NODE")&&"COLGROUP"==l.tagName){i=!0;for(var s=l.firstChild;s;s=s.nextSibling)if((0,c.isNodeOfType)(s,"ELEMENT_NODE")&&"COL"==s.tagName){var f={};(0,u.parseFormat)(s,t.formatParsers.tableColumn,f,t);for(var p=0;p<parseInt(null!==(n=s.getAttribute("span"))&&void 0!==n?n:"1");p++)if(void 0===f.width)r.push(void 0);else{var m=(0,d.parseValueWithUnit)(null!==(o=f.width)&&void 0!==o?o:"",void 0,"px");r.push(m+a),a+=m}}}return i}(t,r,y),C=[0],_=r.zoomScale||1,T=function(e){var o=t.rows[e],a=g.rows[e],d=o.parentNode;(0,c.isNodeOfType)(d,"ELEMENT_NODE")&&((0,s.isElementOfType)(d,"tbody")||(0,s.isElementOfType)(d,"thead")||(0,s.isElementOfType)(d,"tfoot"))?(0,u.parseFormat)(d,r.formatParsers.tableRow,a.format,r):r.allowCacheElement&&(a.cachedElement=o),(0,u.parseFormat)(o,r.formatParsers.tableRow,a.format,r),(0,f.stackFormat)(r,{paragraph:"shallowClone",segment:"shallowClone"},(function(){var t=o.parentElement,s=null==t?void 0:t.tagName;!t||"TBODY"!=s&&"THEAD"!=s&&"TFOOT"!=s||((0,u.parseFormat)(t,r.formatParsers.block,r.blockFormat,r),(0,u.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r)),(0,u.parseFormat)(o,r.formatParsers.block,r.blockFormat,r),(0,u.parseFormat)(o,r.formatParsers.segmentOnBlock,r.segmentFormat,r);for(var c,d=function(t,s){for(;a.cells[s];s++);var d=o.cells[t],p=r.isInSelection,m=s+d.colSpan,h=e+d.rowSpan,T=void 0===y[m],E=void 0===C[h];if(T||E){var M=(0,l.getBoundingClientRect)(d);if(M.width>0||M.height>0){if(T){var k=y[s];y[m]=("number"==typeof k?k:0)+M.width/_}E&&(C[h]=C[e]+M.height/_)}}(0,f.stackFormat)(r,{paragraph:"shallowClone",segment:"shallowClone"},(function(){(0,u.parseFormat)(d,r.formatParsers.block,r.blockFormat,r),(0,u.parseFormat)(d,r.formatParsers.segmentOnTableCell,r.segmentFormat,r);var t=(0,n.__assign)({},r.blockFormat),o={};(0,u.parseFormat)(d,r.formatParsers.tableCell,t,r),(0,u.parseFormat)(d,r.formatParsers.tableBorder,t,r),(0,u.parseFormat)(d,r.formatParsers.dataset,o,r);for(var a=1;a<=d.colSpan;a++,s++)for(var l=1;l<=d.rowSpan;l++){var c=1==a&&1==l,f=(0,i.createTableCell)(a>1,l>1,"TH"==d.tagName,t);f.dataset=(0,n.__assign)({},o);var m=g.rows[e+l-1];if(m&&(m.cells[s]=f),c){r.allowCacheElement&&!S&&(f.cachedElement=d);var h=r.listFormat,y=h.listParent,C=h.levels;r.listFormat.listParent=void 0,r.listFormat.levels=[];try{r.elementProcessors.child(f,d,r)}finally{r.listFormat.listParent=y,r.listFormat.levels=C}}var _=r.isInSelection;(p&&_||b&&v&&e>=v.firstRow&&e<=v.lastRow&&s>=v.firstColumn&&s<=v.lastColumn)&&(f.isSelected=!0)}})),c=s},p=0,m=0;p<o.cells.length;p++)d(p,m),m=c}));for(var p=0;p<a.cells.length;p++)a.cells[p]||(a.cells[p]=(0,i.createTableCell)(!1,!1,!1,r.blockFormat))},E=0;E<t.rows.length;E++)T(E);g.widths=p(y);var M=p(C);g.rows.forEach((function(e,t){M[t]>0&&(e.height=M[t])}))}))}},6214:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textProcessor=void 0;var n=r(2452),o=r(4968);function a(e,t,r){var o,a=(0,n.ensureParagraph)(e,r.blockFormat),i=a.segments.length;r.elementProcessors.textWithSelection(e,t,r);var l=a.segments.slice(i);null===(o=r.domIndexer)||void 0===o||o.onSegment(t,a,l.filter((function(e){return"Text"==(null==e?void 0:e.segmentType)})))}t.textProcessor=function(e,t,r){r.formatParsers.text.length>0?(0,o.stackFormat)(r,{segment:"shallowClone"},(function(){r.formatParsers.text.forEach((function(n){n(r.segmentFormat,t,r),a(e,t,r)}))})):a(e,t,r)}},1881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textWithSelectionProcessor=void 0;var n=r(3344),o=r(2221),a=r(4714);t.textWithSelectionProcessor=function(e,t,r){var i=t.nodeValue||"",l=(0,a.getRegularSelectionOffsets)(r,t),s=l[0],c=l[1];if(s>=0){var u=i.substring(0,s);(0,o.addTextSegment)(e,u,r),r.isInSelection=!0,(0,n.addSelectionMarker)(e,r,t,s),i=i.substring(s),c-=s}c>=0&&(u=i.substring(0,c),(0,o.addTextSegment)(e,u,r),!r.selection||"range"==r.selection.type&&r.selection.range.collapsed||(0,n.addSelectionMarker)(e,r,t,l[1]),r.isInSelection=!1,i=i.substring(c)),(0,o.addTextSegment)(e,i,r)}},3344:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSelectionMarker=void 0;var n=r(8613),o=r(8823);t.addSelectionMarker=function(e,t,r,a){var i=(0,o.buildSelectionMarker)(e,t,r,a);(0,n.addSegment)(e,i,t.blockFormat,i.format)}},7866:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areSameFormats=void 0;var n=r(546);t.areSameFormats=function(e,t){if(e==t)return!0;var r=(0,n.getObjectKeys)(e),o=(0,n.getObjectKeys)(t);return r.length==o.length&&r.every((function(r){return e[r]==t[r]}))}},8823:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildSelectionMarker=void 0;var n=r(6630),o=r(9804);t.buildSelectionMarker=function(e,t,r,a){var i=e.blocks[e.blocks.length-1],l=i&&"Paragraph"==i.blockType?i.decorator?{fontFamily:i.decorator.format.fontFamily,fontSize:i.decorator.format.fontSize}:i.segmentFormat?{fontFamily:i.segmentFormat.fontFamily,fontSize:i.segmentFormat.fontSize}:{}:{},s=t.pendingFormat&&t.pendingFormat.insertPoint.node===r&&t.pendingFormat.insertPoint.offset===a?t.pendingFormat.format:void 0,c=Object.assign({},t.defaultFormat,l,t.segmentFormat,s),u=(0,o.createSelectionMarker)(c);return(0,n.addDecorators)(u,t),u}},5627:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingClientRect=void 0,t.getBoundingClientRect=function(e){return e.getBoundingClientRect()}},9408:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultStyle=void 0;var n=r(3413);t.getDefaultStyle=function(e){var t=e.tagName.toLowerCase();return n.defaultHTMLStyleMap[t]||{}}},4714:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRegularSelectionOffsets=void 0,t.getRegularSelectionOffsets=function(e,t){var r,n="range"==(null===(r=e.selection)||void 0===r?void 0:r.type)?e.selection.range:null;return[(null==n?void 0:n.startContainer)==t?n.startOffset:-1,(null==n?void 0:n.endContainer)==t?n.endOffset:-1]}},9630:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBlockElement=void 0;var n=r(9408),o=["block","list-item","table","table-cell","flex"];t.isBlockElement=function(e){var t=e.style.display||(0,n.getDefaultStyle)(e).display||"";return o.indexOf(t)>=0}},2487:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFormat=void 0;var n=r(9408);t.parseFormat=function(e,t,r,o){var a=(0,n.getDefaultStyle)(e);t.forEach((function(t){null==t||t(r,e,o,a)}))}},4968:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackFormat=void 0;var n=r(7582),o=r(546),a=["backgroundColor"],i=["marginLeft","marginRight","paddingLeft","paddingRight"];function l(e,t){switch(t){case"empty":return{};case void 0:return e;default:var r=(0,n.__assign)({},e);if((0,o.getObjectKeys)(e).forEach((function(e){("shallowCloneForBlock"==t&&a.indexOf(e)>=0||"shallowCloneForGroup"==t&&i.indexOf(e)>=0)&&delete r[e]})),"shallowClone"==t||"shallowCloneForGroup"==t){var l=e;l.textIndent&&(delete r.isTextIndentApplied,l.isTextIndentApplied=!0)}return r}}t.stackFormat=function(e,t,r){var o,a=e.segmentFormat,i=e.blockFormat,s=e.link,c=e.code,u=e.blockDecorator,d=t.segment,f=t.paragraph,p=t.link,m=t.code,h=t.blockDecorator;try{e.segmentFormat=l(a,d),e.blockFormat=l(i,f),e.link=function(e,t){switch(t){case"linkDefault":return{format:{underline:!0},dataset:{}};case"empty":return{format:{},dataset:{}};default:return{dataset:e.dataset,format:(0,n.__assign)({},e.format)}}}(s,p),e.code=function(e,t){switch(t){case"codeDefault":return{format:{fontFamily:"monospace"}};case"empty":return{format:{}};default:return e}}(c,m),e.blockDecorator=(o=u,"empty"===h?{format:{},tagName:""}:o),r()}finally{e.segmentFormat=a,e.blockFormat=i,e.link=s,e.code=c,e.blockDecorator=u}}},3566:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addDelimiters=t.isBlockEntityContainer=t.isEntityDelimiter=t.generateEntityClassNames=t.parseEntityFormat=t.getAllEntityWrappers=t.findClosestBlockEntityContainer=t.findClosestEntityWrapper=t.isEntityElement=void 0;var n=r(7582),o=r(4043),a=r(6714),i=r(8882),l=r(7834),s="_Entity",c="."+s,u="_EType_",d="_EId_",f="_EReadonly_",p="entityDelimiterBefore",m="entityDelimiterAfter",h="_E_EBlockEntityContainer",g="."+h;function v(e,t){return(null==e?void 0:e.classList.contains(t))&&"​"==e.textContent?e:void 0}function b(e,t,r){var n,o=e.createElement("span");return o.className=r?m:p,o.appendChild(e.createTextNode("​")),null===(n=t.parentNode)||void 0===n||n.insertBefore(o,r?t.nextSibling:t),o}t.isEntityElement=function(e){return(0,i.isNodeOfType)(e,"ELEMENT_NODE")&&e.classList.contains(s)},t.findClosestEntityWrapper=function(e,t){return t.findClosestElementAncestor(e,c)},t.findClosestBlockEntityContainer=function(e,t){return t.findClosestElementAncestor(e,g)},t.getAllEntityWrappers=function(e){return(0,l.toArray)(e.querySelectorAll("."+s))},t.parseEntityFormat=function(e){var t=!1,r={};return e.classList.forEach((function(e){t=function(e,t){if(e==s)return!0;0==e.indexOf(u)?t.entityType=e.substring(7):0==e.indexOf(d)?t.id=e.substring(5):0==e.indexOf(f)&&(t.isReadonly="1"==e.substring(11))}(e,r)||t})),t||(r.isFakeEntity=!0,r.isReadonly=!e.isContentEditable),r},t.generateEntityClassNames=function(e){var t;return e.isFakeEntity?"":s+" "+u+(null!==(t=e.entityType)&&void 0!==t?t:"")+" "+(e.id?""+d+e.id+" ":"")+f+(e.isReadonly?"1":"0")},t.isEntityDelimiter=function(e,t){var r=void 0===t||t,n=void 0===t||!t;return(0,a.isElementOfType)(e,"span")&&(n&&e.classList.contains(m)||r&&e.classList.contains(p))&&"​"===e.textContent},t.isBlockEntityContainer=function(e){return(0,a.isElementOfType)(e,"div")&&e.classList.contains(h)},t.addDelimiters=function(e,t,r,a){var i,l,s,c,u=(0,n.__read)((l=[],s=(i=t).nextElementSibling,c=i.previousElementSibling,l.push(v(s,m),v(c,p)),l),2),d=u[0],f=u[1];return d||(d=b(e,t,!0),a&&r&&(0,o.applyFormat)(d,a.formatAppliers.segment,r,a)),f||(f=b(e,t,!1),a&&r&&(0,o.applyFormat)(f,a.formatAppliers.segment,r,a)),[d,f]}},8712:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cacheGetEventData=void 0,t.cacheGetEventData=function(e,t,r){var n=e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:r(e);return e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=n,n}},4063:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCursorMovingKey=t.isCharacterValue=t.isModifierKey=void 0;var r=new Set(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"]);function n(e){var t=e.ctrlKey||"Control"===e.key,r=e.altKey||"Alt"===e.key,n=e.metaKey||"Meta"===e.key;return t||r||n}t.isModifierKey=n,t.isCharacterValue=function(e){return!n(e)&&!!e.key&&1==e.key.length},t.isCursorMovingKey=function(e){return r.has(e.key)}},5238:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.extractClipboardItems=void 0;var o=r(5801),a=((n={})["text/html"]=function(e,t){return e.rawHtml=t},n["text/plain"]=function(e,t){return e.text=t},n["text/*"]=function(e,t,r){return!!r&&(e.customValues[r]=t)},n["text/link-preview"]=function(e,t){try{e.customValues["link-preview"]=t,e.linkPreview=JSON.parse(t)}catch(e){}},n);t.extractClipboardItems=function(e,t){var r={types:[],text:"",image:null,files:[],rawHtml:null,customValues:{},pasteNativeEvent:!0};return Promise.all((e||[]).map((function(e){var n=e.type;if(0!=n.indexOf("image/")||r.image||"file"!=e.kind){if("file"==e.kind)return new Promise((function(t){var o=e.getAsFile();o&&(r.types.push(n),r.files.push(o)),t()}));var i=function(e,t){var r=0==e.indexOf("text/")?e.substring(5):null,n=t&&r?t.indexOf(r):-1;return r&&n>=0?r:void 0}(n,t),l=a[n]||(i?a["text/*"]:null);return new Promise((function(t){return l?e.getAsString((function(e){r.types.push(n),l(r,e,i),t()})):t()}))}return r.types.push(n),r.image=e.getAsFile(),new Promise((function(e){r.image?(0,o.readFile)(r.image,(function(t){r.imageDataUri=t,e()})):e()}))}))).then((function(){return r}))}},546:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getObjectKeys=void 0,t.getObjectKeys=function(e){return Object.keys(e)}},6714:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isElementOfType=void 0,t.isElementOfType=function(e,t){var r;return(null===(r=null==e?void 0:e.tagName)||void 0===r?void 0:r.toLocaleLowerCase())==t}},8882:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeOfType=void 0,t.isNodeOfType=function(e,t){return!!e&&e.nodeType==Node[t]}},7509:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWhiteSpacePreserved=void 0;var r=["pre","pre-wrap","break-spaces"];t.isWhiteSpacePreserved=function(e){return!!e&&r.indexOf(e)>=0}},973:(e,t)=>{"use strict";function r(e,t,r){if(e){for(;!r&&e.firstChild;)e.removeChild(e.firstChild);for(;null==t?void 0:t.firstChild;)e.appendChild(t.firstChild)}}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapAllChildNodes=t.moveChildNodes=void 0,t.moveChildNodes=r,t.wrapAllChildNodes=function(e,t){var n=e.ownerDocument.createElement(t);return r(n,e),e.appendChild(n),n}},5077:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeRect=void 0,t.normalizeRect=function(e){var t=e||{left:0,right:0,top:0,bottom:0},r=t.left,n=t.right,o=t.top,a=t.bottom;return 0===r&&0===n&&0===o&&0===a?null:{left:Math.round(r),right:Math.round(n),top:Math.round(o),bottom:Math.round(a)}}},5801:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readFile=void 0,t.readFile=function(e,t){if(e){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=function(){t(null)},r.readAsDataURL(e)}}},5345:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeNode=t.reuseCachedElement=void 0;var n=r(3566);t.reuseCachedElement=function(e,t,r){var o;if(t.parentNode==e){for(var a=(0,n.isEntityElement)(t);r&&r!=t&&(a||!(0,n.isEntityElement)(r));){var i=r.nextSibling;null===(o=r.parentNode)||void 0===o||o.removeChild(r),r=i}r&&r==t?r=r.nextSibling:e.insertBefore(t,r)}else e.insertBefore(t,r);return r},t.removeNode=function(e){var t,r=e.nextSibling;return null===(t=e.parentNode)||void 0===t||t.removeChild(e),r}},3282:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionRootNode=void 0,t.getSelectionRootNode=function(e){return e?"range"==e.type?e.range.commonAncestorContainer:"table"==e.type?e.table:"image"==e.type?e.image:void 0:void 0}},1302:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeText=t.isSpace=t.isPunctuation=void 0;var r=/[\u2000\u2009\u200a​\u200b​\u202f\u205f​\u3000\s\t\r\n]/gm;t.isPunctuation=function(e){return'.,?!:"()[]\\/'.indexOf(e)>=0},t.isSpace=function(e){var t,n=null!==(t=null==e?void 0:e.charCodeAt(0))&&void 0!==t?t:0;return 160==n||32==n||r.test(e)},t.normalizeText=function(e,t){return e.replace(t?/^\u0020+/:/\u0020+$/," ")}},2384:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combineBorderValue=t.extractBorderValues=void 0;var r=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"],n=/^(thin|medium|thick|[\d\.]+\w*)$/;t.extractBorderValues=function(e){var t={};return(e||"").replace(/, /g,",").split(" ").forEach((function(e){r.indexOf(e)>=0&&!t.style?t.style=e:n.test(e)&&!t.width?t.width=e:e&&!t.color&&(t.color=e)})),t},t.combineBorderValue=function(e){return[e.width||"",e.style||"",e.color||""].join(" ").trim()||"none"}},2391:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBold=void 0,t.isBold=function(e){return!!e&&("bold"==e||"bolder"==e||parseInt(e)>=600)}},483:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformColor=void 0;var n=r(1410);function o(e,t,r){r&&a(e)&&t(e);for(var n=e.firstChild;n;n=n.nextSibling)a(n)&&t(n),o(n,t)}function a(e){var t=e;return e.nodeType==Node.ELEMENT_NODE&&!!t.style}t.transformColor=function(e,t,r,a){var i="lightToDark"==r;o(e,(function(e){var t=(0,n.getColor)(e,!1,!i,a),r=(0,n.getColor)(e,!0,!i,a);(0,n.setColor)(e,t,!1,i,a),(0,n.setColor)(e,r,!0,i,a)}),t)}},9981:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseTableCells=void 0;var n=r(7834);t.parseTableCells=function(e){var t=(0,n.toArray)(e.rows),r=t.map((function(e){return[]}));return t.forEach((function(e,t){for(var n=0,o=0;n<e.cells.length;n++){for(;void 0!==r[t][o];o++);for(var a=e.cells[n],i=0;i<a.colSpan;i++,o++)for(var l=0;l<a.rowSpan;l++)r[t+l]&&(r[t+l][o]=0==i?0==l?a:"spanTop":0==l?"spanLeft":"spanBoth")}for(var s=0;s<r[t].length;s++)r[t][s]=r[t][s]||null})),r}},7834:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toArray=void 0,t.toArray=function(e){return[].slice.call(e)}},3242:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=void 0,t.unwrap=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},3168:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrap=void 0,t.wrap=function(e,t,r){var n,o=e.createElement(r);return null===(n=t.parentNode)||void 0===n||n.insertBefore(o,t),o.appendChild(t),o}},5729:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.directionFormatHandler=void 0,t.directionFormatHandler={parse:function(e,t,r,n){var o=t.style.direction||t.dir||n.direction;o&&(e.direction="rtl"==o?"rtl":"ltr")},apply:function(e,t){e.direction&&(t.style.direction=e.direction)}}},1051:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayFormatHandler=void 0,t.displayFormatHandler={parse:function(e,t){var r=t.style.display;r&&(e.display=r)},apply:function(e,t){e.display&&(t.style.display=e.display)}}},292:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.htmlAlignFormatHandler=void 0;var n=r(73),o=r(5729);t.htmlAlignFormatHandler={parse:function(e,t,r,a){o.directionFormatHandler.parse(e,t,r,a);var i=t.getAttribute("align");i&&(e.htmlAlign=(0,n.calcAlign)(i,e.direction),delete e.textAlign,delete r.blockFormat.textAlign)},apply:function(e,t){var r="rtl"==e.direction?"rtl":"ltr";e.htmlAlign&&t.setAttribute("align",n.ResultMap[e.htmlAlign][r])}}},2962:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lineHeightFormatHandler=void 0,t.lineHeightFormatHandler={parse:function(e,t,r,n){var o=t.style.lineHeight||n.lineHeight;o&&"inherit"!=o&&(e.lineHeight=o)},apply:function(e,t){e.lineHeight&&(t.style.lineHeight=e.lineHeight)}}},9084:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.marginFormatHandler=void 0;var n=r(4406),o=["marginTop","marginRight","marginBottom","marginLeft"];t.marginFormatHandler={parse:function(e,t,r,a){o.forEach((function(r){var o=t.style[r]||a[r];if(o)switch(r){case"marginTop":case"marginBottom":e[r]=o;break;case"marginLeft":case"marginRight":e[r]=e[r]?(0,n.parseValueWithUnit)(e[r]||"",t)+(0,n.parseValueWithUnit)(o,t)+"px":o}}))},apply:function(e,t,r){o.forEach((function(n){var o=e[n];o!=r.implicitFormat[n]&&(t.style[n]=o||"0")}))}}},9:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paddingFormatHandler=void 0;var n=r(5729),o=["paddingTop","paddingRight","paddingBottom","paddingLeft"],a={paddingLeft:"paddingInlineStart"},i={paddingRight:"paddingInlineStart"};t.paddingFormatHandler={parse:function(e,t,r,l){n.directionFormatHandler.parse(e,t,r,l),o.forEach((function(r){var n,o,s=t.style[r],c=("rtl"==e.direction?i:a)[r],u=(null!==(o=null!==(n=l[r])&&void 0!==n?n:c?l[c]:void 0)&&void 0!==o?o:"0px")+"";s||(s=u),s&&"0"!=s||(s="0px"),s&&s!=u&&(e[r]=s)}))},apply:function(e,t,r){o.forEach((function(r){var n=e[r],o=void 0;"OL"!=t.tagName&&"UL"!=t.tagName||("rtl"==e.direction&&"paddingRight"==r||"rtl"!=e.direction&&"paddingLeft"==r)&&(o="40px"),n&&n!=o&&(t.style[r]=n)}))}}},6135:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textAlignFormatHandler=void 0;var n=r(73),o=r(5729);t.textAlignFormatHandler={parse:function(e,t,r,a){var i;o.directionFormatHandler.parse(e,t,r,a);var l=t.style.textAlign||a.textAlign;"LI"==t.tagName&&"flex"===(null===(i=t.parentElement)||void 0===i?void 0:i.style.display)&&"column"===t.parentElement.style.flexDirection&&t.style.alignSelf&&(l=t.style.alignSelf),l&&(e.textAlign=(0,n.calcAlign)(l,e.direction))},apply:function(e,t){var r="rtl"==e.direction?"rtl":"ltr";if(e.textAlign){var o=t.parentElement,a=null==o?void 0:o.tagName;"LI"!=t.tagName||!o||"OL"!=a&&"UL"!=a?t.style.textAlign=n.ResultMap[e.textAlign][r]:(t.style.alignSelf=e.textAlign,t.parentElement.style.flexDirection="column",t.parentElement.style.display="flex")}}}},990:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textIndentFormatHandler=void 0,t.textIndentFormatHandler={parse:function(e,t){var r=t.style.textIndent;r&&(e.textIndent=r)},apply:function(e,t){e.textIndent&&(t.style.textIndent=e.textIndent)}}},3743:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.whiteSpaceFormatHandler=void 0;var n=r(539);t.whiteSpaceFormatHandler={parse:function(e,t,r,o){var a=t.style.whiteSpace||o.whiteSpace;(0,n.shouldSetValue)(a,"normal",e.whiteSpace,o.whiteSpace)&&(e.whiteSpace=a)},apply:function(e,t,r){var n=r.implicitFormat.whiteSpace;e.whiteSpace!=n&&(t.style.whiteSpace=e.whiteSpace||"normal")}}},5687:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.backgroundColorFormatHandler=void 0;var n=r(1410),o=r(539);t.backgroundColorFormatHandler={parse:function(e,t,r,a){var i=(0,n.getColor)(t,!0,!!r.isDarkMode,r.darkColorHandler)||a.backgroundColor;(0,o.shouldSetValue)(i,"transparent",void 0,a.backgroundColor)&&(e.backgroundColor=i)},apply:function(e,t,r){e.backgroundColor&&(0,n.setColor)(t,e.backgroundColor,!0,!!r.isDarkMode,r.darkColorHandler)}}},6027:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.borderBoxFormatHandler=void 0,t.borderBoxFormatHandler={parse:function(e,t){var r;"border-box"==(null===(r=t.style)||void 0===r?void 0:r.boxSizing)&&(e.useBorderBox=!0)},apply:function(e,t){e.useBorderBox&&(t.style.boxSizing="border-box")}}},5493:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.borderFormatHandler=t.BorderKeys=void 0,t.BorderKeys=["borderTop","borderRight","borderBottom","borderLeft"];var r=["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"],n=["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"],o=t.BorderKeys.concat(n);t.borderFormatHandler={parse:function(e,o,a,i){t.BorderKeys.forEach((function(t,n){var a,l=o.style[t],s=null!==(a=i[r[n]])&&void 0!==a?a:"0px",c=o.style[r[n]];"0"==c&&(c="0px"),l&&c!=s&&(e[t]="none"==l?"":l)}));var l=o.style.borderRadius;l?e.borderRadius=l:n.forEach((function(t){var r=o.style[t];r&&(e[t]=r)}))},apply:function(e,t){o.forEach((function(r){var n=e[r];n&&(t.style[r]=n)})),e.borderRadius&&(t.style.borderRadius=e.borderRadius)}}},705:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boxShadowFormatHandler=void 0,t.boxShadowFormatHandler={parse:function(e,t){var r;(null===(r=t.style)||void 0===r?void 0:r.boxShadow)&&(e.boxShadow=t.style.boxShadow)},apply:function(e,t){e.boxShadow&&(t.style.boxShadow=e.boxShadow)}}},938:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.datasetFormatHandler=void 0;var n=r(546);t.datasetFormatHandler={parse:function(e,t){var r=t.dataset;(0,n.getObjectKeys)(r).forEach((function(t){e[t]=r[t]||""}))},apply:function(e,t){(0,n.getObjectKeys)(e).forEach((function(r){t.dataset[r]=e[r]}))}}},6586:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.floatFormatHandler=void 0,t.floatFormatHandler={parse:function(e,t){var r=t.style.float||t.getAttribute("align");r&&(e.float=r)},apply:function(e,t){e.float&&(t.style.float=e.float)}}},5965:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.idFormatHandler=void 0,t.idFormatHandler={parse:function(e,t){t.id&&(e.id=t.id)},apply:function(e,t){e.id&&(t.id=e.id)}}},1481:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sizeFormatHandler=void 0;var r=/[\d\.]+%/;function n(e,t){var n=e.getAttribute(t),o=parseInt(n||"");return n&&r.test(n)?n:Number.isNaN(o)||0==o?void 0:o+"px"}t.sizeFormatHandler={parse:function(e,t,r){var o=t.style.width||n(t,"width"),a=t.style.height||n(t,"height"),i=t.style.maxWidth,l=t.style.maxHeight,s=t.style.minWidth,c=t.style.minHeight;o&&(e.width=o),a&&(e.height=a),i&&(e.maxWidth=i),l&&(e.maxHeight=l),s&&(e.minWidth=s),c&&(e.minHeight=c)},apply:function(e,t){e.width&&(t.style.width=e.width),e.height&&(t.style.height=e.height),e.maxWidth&&(t.style.maxWidth=e.maxWidth),e.maxHeight&&(t.style.maxHeight=e.maxHeight),e.minWidth&&(t.style.minWidth=e.minWidth),e.minHeight&&(t.style.minHeight=e.minHeight)}}},3634:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verticalAlignFormatHandler=void 0,t.verticalAlignFormatHandler={parse:function(e,t){switch(t.style.verticalAlign||t.getAttribute("valign")){case"baseline":case"initial":case"super":case"sub":case"text-top":case"text-bottom":case"top":e.verticalAlign="top";break;case"bottom":e.verticalAlign="bottom";break;case"middle":e.verticalAlign="middle"}},apply:function(e,t){e.verticalAlign&&(t.style.verticalAlign=e.verticalAlign)}}},5565:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wordBreakFormatHandler=void 0,t.wordBreakFormatHandler={parse:function(e,t,r,n){var o=t.style.wordBreak||n.wordBreak;o&&(e.wordBreak=o)},apply:function(e,t){e.wordBreak&&(t.style.wordBreak=e.wordBreak)}}},5606:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFormatAppliers=t.defaultFormatParsers=t.defaultFormatKeysPerCategory=void 0;var n=r(7582),o=r(5687),a=r(3489),i=r(6027),l=r(5493),s=r(705),c=r(938),u=r(5729),d=r(1051),f=r(1443),p=r(6586),m=r(6092),h=r(9115),g=r(546),v=r(292),b=r(5965),y=r(6533),S=r(6031),C=r(2962),_=r(9424),T=r(3749),E=r(7089),M=r(5280),k=r(9084),O=r(9),P=r(1481),w=r(8626),x=r(4110),D=r(2941),L=r(5253),F=r(6135),N=r(389),R=r(3231),I=r(990),j=r(1026),A=r(3634),B=r(3743),H=r(5565),z={backgroundColor:o.backgroundColorFormatHandler,bold:a.boldFormatHandler,border:l.borderFormatHandler,borderBox:i.borderBoxFormatHandler,boxShadow:s.boxShadowFormatHandler,dataset:c.datasetFormatHandler,direction:u.directionFormatHandler,display:d.displayFormatHandler,float:p.floatFormatHandler,fontFamily:m.fontFamilyFormatHandler,fontSize:h.fontSizeFormatHandler,entity:f.entityFormatHandler,htmlAlign:v.htmlAlignFormatHandler,id:b.idFormatHandler,italic:y.italicFormatHandler,letterSpacing:S.letterSpacingFormatHandler,lineHeight:C.lineHeightFormatHandler,link:_.linkFormatHandler,listItemThread:T.listItemThreadFormatHandler,listLevelThread:E.listLevelThreadFormatHandler,listStyle:M.listStyleFormatHandler,margin:k.marginFormatHandler,padding:O.paddingFormatHandler,size:P.sizeFormatHandler,strike:w.strikeFormatHandler,superOrSubScript:x.superOrSubScriptFormatHandler,tableLayout:D.tableLayoutFormatHandler,tableSpacing:L.tableSpacingFormatHandler,textAlign:F.textAlignFormatHandler,textColor:N.textColorFormatHandler,textColorOnTableCell:R.textColorOnTableCellFormatHandler,textIndent:I.textIndentFormatHandler,underline:j.underlineFormatHandler,verticalAlign:A.verticalAlignFormatHandler,whiteSpace:B.whiteSpaceFormatHandler,wordBreak:H.wordBreakFormatHandler},U=["letterSpacing","fontFamily","fontSize"],W=["strike","underline","superOrSubScript","italic","bold"],G=["direction","textAlign","textIndent","lineHeight","whiteSpace"],K=["backgroundColor","margin","padding","border"];t.defaultFormatKeysPerCategory={block:G,listItemThread:["listItemThread"],listLevelThread:["listLevelThread"],listItemElement:(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(G),!1),["direction","textAlign","lineHeight","margin","listStyle"],!1),listLevel:["direction","textAlign","margin","padding","listStyle","backgroundColor"],styleBasedSegment:(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(U),!1),["textColor","backgroundColor","lineHeight"],!1),elementBasedSegment:W,segment:(0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(U),!1),(0,n.__read)(W),!1),["textColor","backgroundColor","lineHeight"],!1),segmentOnBlock:(0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(U),!1),(0,n.__read)(W),!1),["textColor"],!1),segmentOnTableCell:(0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(U),!1),(0,n.__read)(W),!1),["textColorOnTableCell"],!1),tableCell:["border","backgroundColor","padding","verticalAlign","wordBreak","textColor","htmlAlign","size"],tableRow:["backgroundColor"],tableColumn:["size"],table:["id","border","backgroundColor","display","htmlAlign","margin","size","tableLayout","textColor"],tableBorder:["borderBox","tableSpacing"],tableCellBorder:["borderBox"],image:["id","size","margin","padding","borderBox","border","boxShadow","display","float","verticalAlign"],link:["link","textColor","underline","display","margin","padding","backgroundColor","border","size","textAlign"],segmentUnderLink:["textColor"],code:["fontFamily","display"],dataset:["dataset"],divider:(0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(G),!1),(0,n.__read)(K),!1),["display","size","htmlAlign"],!1),container:(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(K),!1),["htmlAlign","size","display"],!1),entity:["entity"],general:["textColor","backgroundColor"]},t.defaultFormatParsers=(0,g.getObjectKeys)(z).reduce((function(e,t){return e[t]=z[t].parse,e}),{}),t.defaultFormatAppliers=(0,g.getObjectKeys)(z).reduce((function(e,t){return e[t]=z[t].apply,e}),{})},1443:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entityFormatHandler=void 0;var n=r(3566);t.entityFormatHandler={parse:function(e,t){Object.assign(e,(0,n.parseEntityFormat)(t))},apply:function(e,t){e.isFakeEntity||(t.className=(0,n.generateEntityClassNames)(e)),e.isReadonly?t.contentEditable="false":t.removeAttribute("contenteditable")}}},3749:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listItemThreadFormatHandler=void 0;var n=r(6714),o=r(8882);function a(e){return(0,n.isElementOfType)(e,"li")&&(0,o.isNodeOfType)(e.parentNode,"ELEMENT_NODE")&&(0,n.isElementOfType)(e.parentNode,"ol")}t.listItemThreadFormatHandler={parse:function(e,t,r,n){var o=r.listFormat,i=o.levels.length,l=t.style.display||n.display;l&&"list-item"!=l?e.displayForDummyItem=l:a(t)&&i>0&&(o.threadItemCounts[i-1]++,o.threadItemCounts.splice(i),o.levels.forEach((function(e){delete e.format.startNumberOverride})))},apply:function(e,t,r){var n;if(e.displayForDummyItem)t.style.display=e.displayForDummyItem;else if(a(t)){var o=r.listFormat,i=o.threadItemCounts,l=o.nodeStack.length-2;l>=0&&(i.splice(l+1),i[l]=(null!==(n=i[l])&&void 0!==n?n:0)+1)}}}},7089:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listLevelThreadFormatHandler=void 0;var n=r(6714);t.listLevelThreadFormatHandler={parse:function(e,t,r){if((0,n.isElementOfType)(t,"ol")){var o=r.listFormat,a=o.threadItemCounts,i=o.levels.length;"number"==typeof a[i]&&t.start!=a[i]+1&&(e.startNumberOverride=t.start),a[i]=t.start-1}},apply:function(e,t,r){var o=r.listFormat,a=o.threadItemCounts,i=o.nodeStack.length-2;if(i>=0&&(0,n.isElementOfType)(t,"ol")){var l=e.startNumberOverride;"number"==typeof l?a[i]=l-1:"number"!=typeof a[i]&&(a[i]=0),a.splice(i+1),t.start=a[i]+1}}}},5280:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listStyleFormatHandler=void 0,t.listStyleFormatHandler={parse:function(e,t){var r=t.style.listStylePosition,n=t.style.listStyleType;r&&(e.listStylePosition=r),n&&(e.listStyleType=n)},apply:function(e,t){e.listStylePosition&&(t.style.listStylePosition=e.listStylePosition),e.listStyleType&&(t.style.listStyleType=e.listStyleType)}}},3489:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boldFormatHandler=void 0;var n=r(539),o=r(973);t.boldFormatHandler={parse:function(e,t,r,o){var a=t.style.fontWeight||o.fontWeight;(0,n.shouldSetValue)(a,"400",e.fontWeight,o.fontWeight)&&(e.fontWeight=a)},apply:function(e,t,r){if(void 0!==e.fontWeight){var n=r.implicitFormat.fontWeight;(n&&n!=e.fontWeight||!n&&e.fontWeight&&"normal"!=e.fontWeight)&&("bold"==e.fontWeight?(0,o.wrapAllChildNodes)(t,"b"):t.style.fontWeight=e.fontWeight||"normal")}}}},6092:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontFamilyFormatHandler=void 0,t.fontFamilyFormatHandler={parse:function(e,t,r,n){var o=t.style.fontFamily||n.fontFamily;o&&"inherit"!=o&&(e.fontFamily=o)},apply:function(e,t,r){e.fontFamily&&e.fontFamily!=r.implicitFormat.fontFamily&&(t.style.fontFamily=e.fontFamily)}}},9115:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontSizeFormatHandler=void 0;var n=r(4110),o=r(4406);t.fontSizeFormatHandler={parse:function(e,t,r,i){var l=t.style.fontSize||i.fontSize,s=t.style.verticalAlign||i.verticalAlign;l&&!(0,n.isSuperOrSubScript)(l,s)&&"inherit"!=l&&(t.style.fontSize?e.fontSize=function(e,t,r){var n=a[e],i=e.endsWith("rem");if(n)return n;if(!("smaller"==e||"larger"==e||e.endsWith("em")||e.endsWith("%")||i))return"inherit"==e||"revert"==e||"unset"==e?void 0:e;if(t||i){var l=i?r.rootFontSize:(0,o.parseValueWithUnit)(t);if(l)switch(e){case"smaller":return Math.round(500*l/6)/100+"px";case"larger":return Math.round(600*l/5)/100+"px";default:return(0,o.parseValueWithUnit)(e,l,"px")+"px"}}}(l,r.segmentFormat.fontSize,r):i.fontSize&&(e.fontSize=l))},apply:function(e,t,r){e.fontSize&&e.fontSize!=r.implicitFormat.fontSize&&(t.style.fontSize=e.fontSize)}};var a={"xx-small":"6.75pt","x-small":"7.5pt",small:"9.75pt",medium:"12pt",large:"13.5pt","x-large":"18pt","xx-large":"24pt","xxx-large":"36pt"}},6533:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.italicFormatHandler=void 0;var n=r(973);t.italicFormatHandler={parse:function(e,t,r,n){var o=t.style.fontStyle||n.fontStyle;"italic"==o||"oblique"==o?e.italic=!0:"initial"!=o&&"normal"!=o||(e.italic=!1)},apply:function(e,t,r){void 0!==e.italic&&!!r.implicitFormat.italic!=!!e.italic&&(e.italic?(0,n.wrapAllChildNodes)(t,"i"):t.style.fontStyle="normal")}}},6031:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.letterSpacingFormatHandler=void 0;var n=r(539);t.letterSpacingFormatHandler={parse:function(e,t,r,o){var a=t.style.letterSpacing||o.letterSpacing;(0,n.shouldSetValue)(a,"normal",e.letterSpacing,o.letterSpacing)&&(e.letterSpacing=a)},apply:function(e,t){e.letterSpacing&&(t.style.letterSpacing=e.letterSpacing)}}},9424:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.linkFormatHandler=void 0;var n=r(6714);t.linkFormatHandler={parse:function(e,t){if((0,n.isElementOfType)(t,"a")){var r=t.name,o=t.getAttribute("href"),a=t.target,i=t.rel,l=t.id,s=t.className,c=t.title;r&&(e.name=r),o&&(e.href=o),a&&(e.target=a),l&&(e.anchorId=l),i&&(e.relationship=i),c&&(e.anchorTitle=c),s&&(e.anchorClass=s)}},apply:function(e,t){(0,n.isElementOfType)(t,"a")&&e.href&&(t.href=e.href,e.name&&(t.name=e.name),e.target&&(t.target=e.target),e.anchorId&&(t.id=e.anchorId),e.anchorClass&&(t.className=e.anchorClass),e.anchorTitle&&(t.title=e.anchorTitle),e.relationship&&(t.rel=e.relationship))}}},8626:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.strikeFormatHandler=void 0;var n=r(973);t.strikeFormatHandler={parse:function(e,t,r,n){var o=t.style.textDecoration||n.textDecoration;(null==o?void 0:o.indexOf("line-through"))>=0&&(e.strikethrough=!0)},apply:function(e,t){e.strikethrough&&(0,n.wrapAllChildNodes)(t,"s")}}},4110:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSuperOrSubScript=t.superOrSubScriptFormatHandler=void 0;var n=r(973);function o(e,t){return"smaller"==e&&("sub"==t||"super"==t)}t.superOrSubScriptFormatHandler={parse:function(e,t,r,n){var a=t.style.verticalAlign||n.verticalAlign;o(t.style.fontSize||n.fontSize,a)&&(e.superOrSubScriptSequence=(e.superOrSubScriptSequence||"").split(" ").concat(a).join(" ").trim())},apply:function(e,t){e.superOrSubScriptSequence&&e.superOrSubScriptSequence.split(" ").reverse().forEach((function(e){var r="super"==e?"sup":"sub"==e?"sub":null;r&&(0,n.wrapAllChildNodes)(t,r)}))}},t.isSuperOrSubScript=o},389:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textColorFormatHandler=void 0;var n=r(1410);t.textColorFormatHandler={parse:function(e,t,r,o){var a=(0,n.getColor)(t,!1,!!r.isDarkMode,r.darkColorHandler)||o.color;a&&"inherit"!=a&&(e.textColor=a)},apply:function(e,t,r){var o=r.implicitFormat.textColor;e.textColor&&e.textColor!=o&&(0,n.setColor)(t,e.textColor,!1,!!r.isDarkMode,r.darkColorHandler)}}},1026:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.underlineFormatHandler=void 0;var n=r(973);t.underlineFormatHandler={parse:function(e,t,r,n){var o=t.style.textDecoration||n.textDecoration;(null==o?void 0:o.indexOf("underline"))>=0?e.underline=!0:"A"==t.tagName&&"none"==o&&(e.underline=!1)},apply:function(e,t,r){void 0!==e.underline&&!!r.implicitFormat.underline!=!!e.underline&&(e.underline?(0,n.wrapAllChildNodes)(t,"u"):t.style.textDecoration="none")}}},2941:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tableLayoutFormatHandler=void 0,t.tableLayoutFormatHandler={parse:function(e,t){var r=t.style.tableLayout;r&&"inherit"!=r&&(e.tableLayout=r)},apply:function(e,t){e.tableLayout&&(t.style.tableLayout=e.tableLayout)}}},5253:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tableSpacingFormatHandler=void 0;var r="collapse",n="separate";t.tableSpacingFormatHandler={parse:function(e,t){(t.style.borderCollapse==r||t.getAttribute("cellPadding"))&&(e.borderCollapse=!0),t.style.borderCollapse==n&&(e.borderSeparate=!0)},apply:function(e,t){e.borderCollapse?(t.style.borderCollapse=r,t.style.borderSpacing="0",t.style.boxSizing="border-box"):e.borderSeparate&&(t.style.borderCollapse=n,t.style.borderSpacing="0",t.style.boxSizing="border-box")}}},3231:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textColorOnTableCellFormatHandler=void 0,t.textColorOnTableCellFormatHandler={parse:function(e,t){t.style.color&&delete e.textColor},apply:function(){}}},1410:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseColor=t.setColor=t.getColor=t.DeprecatedColors=void 0;var n=r(7582),o=r(546);t.DeprecatedColors=["inactiveborder","activeborder","inactivecaptiontext","inactivecaption","activecaption","appworkspace","infobackground","background","buttonhighlight","buttonshadow","captiontext","infotext","menutext","menu","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedfhadow","windowtext","windowframe","window"];var a=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,i=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,l=/^rgb\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,s=/^rgba\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,c=/^\s*var\(\s*(\-\-[a-zA-Z0-9\-_]+)\s*(?:,\s*(.*))?\)\s*$/,u="var(";function d(e){var t;return(t=(e=(e||"").trim()).match(a))?[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]:(t=e.match(i))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:(t=e.match(l)||e.match(s))?[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]:null}t.getColor=function(e,r,n,a){var i=(r?e.style.backgroundColor:e.style.color)||e.getAttribute(r?"bgcolor":"color")||void 0;if(i&&t.DeprecatedColors.indexOf(i)>-1)i=r?void 0:"rgb(0, 0, 0)";else if(a&&i){var l=i.startsWith(u)?c.exec(i):null;l?i=l[2]||"":n&&(i=function(e,t){var r=d(e);if(r&&t){var n=(0,o.getObjectKeys)(t).find((function(e){var n=d(t[e].darkModeColor);return n&&n[0]==r[0]&&n[1]==r[1]&&n[2]==r[2]}));if(n)return t[n].lightModeColor}return null}(i,a.knownColors)||"")}return i},t.setColor=function(e,t,r,o,a){var i,l,s=t&&t.startsWith(u)?c.exec(t):null,d=(0,n.__read)(null!=s?s:[],3),f=(d[0],d[1]),p=d[2];if(t=null!=p?p:t,a&&t){var m=f||"--darkColor_"+t.replace(/[^\d\w]/g,"_"),h=(null===(l=null===(i=a.knownColors)||void 0===i?void 0:i[m])||void 0===l?void 0:l.darkModeColor)||a.getDarkColor(t,void 0,r?"background":"text",e);a.updateKnownColor(o,m,{lightModeColor:t,darkModeColor:h}),t=o?""+u+m+", "+t+")":t}e.removeAttribute(r?"bgcolor":"color"),e.style.setProperty(r?"background-color":"color",t||null)},t.parseColor=d},73:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcAlign=t.ResultMap=void 0,t.ResultMap={start:{ltr:"left",rtl:"right"},center:{ltr:"center",rtl:"center"},end:{ltr:"right",rtl:"left"},initial:{ltr:"initial",rtl:"initial"},justify:{ltr:"justify",rtl:"justify"}},t.calcAlign=function(e,t){switch(e){case"center":return"center";case"left":return"rtl"==t?"end":"start";case"right":return"rtl"==t?"start":"end";case"start":case"end":case"justify":case"initial":return e;default:return}}},4406:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseValueWithUnit=void 0;var n=r(7582),o=/(-?\d+(\.\d+)?)([a-z]+|%)/;function a(e){var t,r;if(void 0===e)return 0;if("number"==typeof e)return e;var n=null!==(r=null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e).fontSize)&&void 0!==r?r:"";return i(parseFloat(n))}function i(e){return Math.round(4e3*e/3)/1e3}t.parseValueWithUnit=function(e,t,r){void 0===e&&(e=""),void 0===r&&(r="px");var l,s=o.exec(e),c=0;if(s){var u=(0,n.__read)(s,4),d=(u[0],u[1]),f=(u[2],u[3]),p=parseFloat(d);switch(f){case"px":c=p;break;case"pt":c=i(p);break;case"em":c=a(t)*p;break;case"ex":c=a(t)*p/2;break;case"%":c=a(t)*p/100;break;case"in":c=96*p;break;case"rem":c=(a(t)||16)*p}}return c>0&&"pt"==r&&(l=c,c=Math.round(3e3*l/4)/1e3),c}},539:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldSetValue=void 0,t.shouldSetValue=function(e,t,r,n){return!!e&&"inherit"!=e&&!!(e!=t||r||n&&e!=n)}},8871:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDivider=t.createEntity=t.createGeneralBlock=t.createGeneralSegment=t.createParagraphDecorator=t.createContentModelDocument=t.createImage=t.createText=t.createTableCell=t.createTable=t.createSelectionMarker=t.createParagraph=t.createFormatContainer=t.createListItem=t.createBr=t.normalizeRect=t.isWhiteSpacePreserved=t.reuseCachedElement=t.findClosestBlockEntityContainer=t.isBlockEntityContainer=t.isEntityDelimiter=t.addDelimiters=t.generateEntityClassNames=t.parseEntityFormat=t.getAllEntityWrappers=t.findClosestEntityWrapper=t.isEntityElement=t.wrap=t.wrapAllChildNodes=t.moveChildNodes=t.toArray=t.getObjectKeys=t.isElementOfType=t.isNodeOfType=t.hasMetadata=t.getMetadata=t.updateMetadata=t.buildSelectionMarker=t.isBlockElement=t.areSameFormats=t.parseFormat=t.getRegularSelectionOffsets=t.tableProcessor=t.entityProcessor=t.processChildNode=t.handleRegularSelection=t.childProcessor=t.contentModelToText=t.contentModelToDom=t.domToContentModel=void 0,t.getFirstSelectedListItem=t.iterateSelections=t.getClosestAncestorBlockGroupIndex=t.isBlockGroupOfType=t.cacheGetEventData=t.extractClipboardItems=t.transformColor=t.readFile=t.parseTableCells=t.normalizeText=t.isSpace=t.isPunctuation=t.extractBorderValues=t.combineBorderValue=t.isCursorMovingKey=t.isModifierKey=t.isCharacterValue=t.getSelectionRootNode=t.isBold=t.createModelToDomConfig=t.createModelToDomContextWithConfig=t.createModelToDomContext=t.createDomToModelConfig=t.createDomToModelContextWithConfig=t.createDomToModelContext=t.parseColor=t.setColor=t.getColor=t.DeprecatedColors=t.BorderKeys=t.parseValueWithUnit=t.getAutoListStyleType=t.getOrderedListNumberStr=t.setParagraphNotImplicit=t.normalizeSingleSegment=t.isEmpty=t.addSegment=t.unwrapBlock=t.isGeneralSegment=t.normalizeContentModel=t.normalizeParagraph=t.addTextSegment=t.addLink=t.addCode=t.addBlock=t.mutateSegment=t.mutateSegments=t.mutateBlock=t.createEmptyModel=t.createListLevel=void 0,t.UnorderedListStyleMap=t.OrderedListStyleMap=t.TableBorderFormat=t.NumberingListType=t.BulletListType=t.ChangeSource=t.ListMetadataDefinition=t.getListMetadata=t.updateListMetadata=t.getTableMetadata=t.updateTableMetadata=t.getTableCellMetadata=t.updateTableCellMetadata=t.getImageMetadata=t.updateImageMetadata=t.getSegmentTextFormat=t.getListStyleTypeFromString=t.retrieveModelFormatState=t.setTableCellBackgroundColor=t.MIN_ALLOWED_TABLE_CELL_WIDTH=t.normalizeTable=t.applyTableFormat=t.deleteBlock=t.deleteSegment=t.deleteSelection=t.mergeModel=t.cloneModel=t.setSelection=t.hasSelectionInBlockGroup=t.hasSelectionInSegment=t.hasSelectionInBlock=t.getSelectedCells=t.getSelectedSegmentsAndParagraphs=t.getSelectedSegments=t.getSelectedParagraphs=t.getOperationalBlocks=t.getFirstSelectedTable=void 0;var n=r(6373);Object.defineProperty(t,"domToContentModel",{enumerable:!0,get:function(){return n.domToContentModel}});var o=r(7802);Object.defineProperty(t,"contentModelToDom",{enumerable:!0,get:function(){return o.contentModelToDom}});var a=r(3348);Object.defineProperty(t,"contentModelToText",{enumerable:!0,get:function(){return a.contentModelToText}});var i=r(1438);Object.defineProperty(t,"childProcessor",{enumerable:!0,get:function(){return i.childProcessor}}),Object.defineProperty(t,"handleRegularSelection",{enumerable:!0,get:function(){return i.handleRegularSelection}}),Object.defineProperty(t,"processChildNode",{enumerable:!0,get:function(){return i.processChildNode}});var l=r(1447);Object.defineProperty(t,"entityProcessor",{enumerable:!0,get:function(){return l.entityProcessor}});var s=r(793);Object.defineProperty(t,"tableProcessor",{enumerable:!0,get:function(){return s.tableProcessor}});var c=r(4714);Object.defineProperty(t,"getRegularSelectionOffsets",{enumerable:!0,get:function(){return c.getRegularSelectionOffsets}});var u=r(2487);Object.defineProperty(t,"parseFormat",{enumerable:!0,get:function(){return u.parseFormat}});var d=r(7866);Object.defineProperty(t,"areSameFormats",{enumerable:!0,get:function(){return d.areSameFormats}});var f=r(9630);Object.defineProperty(t,"isBlockElement",{enumerable:!0,get:function(){return f.isBlockElement}});var p=r(8823);Object.defineProperty(t,"buildSelectionMarker",{enumerable:!0,get:function(){return p.buildSelectionMarker}});var m=r(8880);Object.defineProperty(t,"updateMetadata",{enumerable:!0,get:function(){return m.updateMetadata}}),Object.defineProperty(t,"getMetadata",{enumerable:!0,get:function(){return m.getMetadata}}),Object.defineProperty(t,"hasMetadata",{enumerable:!0,get:function(){return m.hasMetadata}});var h=r(8882);Object.defineProperty(t,"isNodeOfType",{enumerable:!0,get:function(){return h.isNodeOfType}});var g=r(6714);Object.defineProperty(t,"isElementOfType",{enumerable:!0,get:function(){return g.isElementOfType}});var v=r(546);Object.defineProperty(t,"getObjectKeys",{enumerable:!0,get:function(){return v.getObjectKeys}});var b=r(7834);Object.defineProperty(t,"toArray",{enumerable:!0,get:function(){return b.toArray}});var y=r(973);Object.defineProperty(t,"moveChildNodes",{enumerable:!0,get:function(){return y.moveChildNodes}}),Object.defineProperty(t,"wrapAllChildNodes",{enumerable:!0,get:function(){return y.wrapAllChildNodes}});var S=r(3168);Object.defineProperty(t,"wrap",{enumerable:!0,get:function(){return S.wrap}});var C=r(3566);Object.defineProperty(t,"isEntityElement",{enumerable:!0,get:function(){return C.isEntityElement}}),Object.defineProperty(t,"findClosestEntityWrapper",{enumerable:!0,get:function(){return C.findClosestEntityWrapper}}),Object.defineProperty(t,"getAllEntityWrappers",{enumerable:!0,get:function(){return C.getAllEntityWrappers}}),Object.defineProperty(t,"parseEntityFormat",{enumerable:!0,get:function(){return C.parseEntityFormat}}),Object.defineProperty(t,"generateEntityClassNames",{enumerable:!0,get:function(){return C.generateEntityClassNames}}),Object.defineProperty(t,"addDelimiters",{enumerable:!0,get:function(){return C.addDelimiters}}),Object.defineProperty(t,"isEntityDelimiter",{enumerable:!0,get:function(){return C.isEntityDelimiter}}),Object.defineProperty(t,"isBlockEntityContainer",{enumerable:!0,get:function(){return C.isBlockEntityContainer}}),Object.defineProperty(t,"findClosestBlockEntityContainer",{enumerable:!0,get:function(){return C.findClosestBlockEntityContainer}});var _=r(5345);Object.defineProperty(t,"reuseCachedElement",{enumerable:!0,get:function(){return _.reuseCachedElement}});var T=r(7509);Object.defineProperty(t,"isWhiteSpacePreserved",{enumerable:!0,get:function(){return T.isWhiteSpacePreserved}});var E=r(5077);Object.defineProperty(t,"normalizeRect",{enumerable:!0,get:function(){return E.normalizeRect}});var M=r(5713);Object.defineProperty(t,"createBr",{enumerable:!0,get:function(){return M.createBr}});var k=r(5297);Object.defineProperty(t,"createListItem",{enumerable:!0,get:function(){return k.createListItem}});var O=r(1096);Object.defineProperty(t,"createFormatContainer",{enumerable:!0,get:function(){return O.createFormatContainer}});var P=r(673);Object.defineProperty(t,"createParagraph",{enumerable:!0,get:function(){return P.createParagraph}});var w=r(9804);Object.defineProperty(t,"createSelectionMarker",{enumerable:!0,get:function(){return w.createSelectionMarker}});var x=r(711);Object.defineProperty(t,"createTable",{enumerable:!0,get:function(){return x.createTable}});var D=r(804);Object.defineProperty(t,"createTableCell",{enumerable:!0,get:function(){return D.createTableCell}});var L=r(2362);Object.defineProperty(t,"createText",{enumerable:!0,get:function(){return L.createText}});var F=r(1143);Object.defineProperty(t,"createImage",{enumerable:!0,get:function(){return F.createImage}});var N=r(2178);Object.defineProperty(t,"createContentModelDocument",{enumerable:!0,get:function(){return N.createContentModelDocument}});var R=r(4002);Object.defineProperty(t,"createParagraphDecorator",{enumerable:!0,get:function(){return R.createParagraphDecorator}});var I=r(8465);Object.defineProperty(t,"createGeneralSegment",{enumerable:!0,get:function(){return I.createGeneralSegment}});var j=r(513);Object.defineProperty(t,"createGeneralBlock",{enumerable:!0,get:function(){return j.createGeneralBlock}});var A=r(7974);Object.defineProperty(t,"createEntity",{enumerable:!0,get:function(){return A.createEntity}});var B=r(9002);Object.defineProperty(t,"createDivider",{enumerable:!0,get:function(){return B.createDivider}});var H=r(6549);Object.defineProperty(t,"createListLevel",{enumerable:!0,get:function(){return H.createListLevel}});var z=r(1434);Object.defineProperty(t,"createEmptyModel",{enumerable:!0,get:function(){return z.createEmptyModel}});var U=r(9370);Object.defineProperty(t,"mutateBlock",{enumerable:!0,get:function(){return U.mutateBlock}}),Object.defineProperty(t,"mutateSegments",{enumerable:!0,get:function(){return U.mutateSegments}}),Object.defineProperty(t,"mutateSegment",{enumerable:!0,get:function(){return U.mutateSegment}});var W=r(6954);Object.defineProperty(t,"addBlock",{enumerable:!0,get:function(){return W.addBlock}});var G=r(6630);Object.defineProperty(t,"addCode",{enumerable:!0,get:function(){return G.addCode}});var K=r(6630);Object.defineProperty(t,"addLink",{enumerable:!0,get:function(){return K.addLink}});var V=r(2221);Object.defineProperty(t,"addTextSegment",{enumerable:!0,get:function(){return V.addTextSegment}});var q=r(7589);Object.defineProperty(t,"normalizeParagraph",{enumerable:!0,get:function(){return q.normalizeParagraph}});var X=r(4527);Object.defineProperty(t,"normalizeContentModel",{enumerable:!0,get:function(){return X.normalizeContentModel}});var $=r(2006);Object.defineProperty(t,"isGeneralSegment",{enumerable:!0,get:function(){return $.isGeneralSegment}});var Y=r(1123);Object.defineProperty(t,"unwrapBlock",{enumerable:!0,get:function(){return Y.unwrapBlock}});var Z=r(8613);Object.defineProperty(t,"addSegment",{enumerable:!0,get:function(){return Z.addSegment}});var Q=r(9929);Object.defineProperty(t,"isEmpty",{enumerable:!0,get:function(){return Q.isEmpty}});var J=r(2025);Object.defineProperty(t,"normalizeSingleSegment",{enumerable:!0,get:function(){return J.normalizeSingleSegment}});var ee=r(1966);Object.defineProperty(t,"setParagraphNotImplicit",{enumerable:!0,get:function(){return ee.setParagraphNotImplicit}});var te=r(9926);Object.defineProperty(t,"getOrderedListNumberStr",{enumerable:!0,get:function(){return te.getOrderedListNumberStr}});var re=r(9914);Object.defineProperty(t,"getAutoListStyleType",{enumerable:!0,get:function(){return re.getAutoListStyleType}});var ne=r(4406);Object.defineProperty(t,"parseValueWithUnit",{enumerable:!0,get:function(){return ne.parseValueWithUnit}});var oe=r(5493);Object.defineProperty(t,"BorderKeys",{enumerable:!0,get:function(){return oe.BorderKeys}});var ae=r(1410);Object.defineProperty(t,"DeprecatedColors",{enumerable:!0,get:function(){return ae.DeprecatedColors}}),Object.defineProperty(t,"getColor",{enumerable:!0,get:function(){return ae.getColor}}),Object.defineProperty(t,"setColor",{enumerable:!0,get:function(){return ae.setColor}}),Object.defineProperty(t,"parseColor",{enumerable:!0,get:function(){return ae.parseColor}});var ie=r(5953);Object.defineProperty(t,"createDomToModelContext",{enumerable:!0,get:function(){return ie.createDomToModelContext}}),Object.defineProperty(t,"createDomToModelContextWithConfig",{enumerable:!0,get:function(){return ie.createDomToModelContextWithConfig}}),Object.defineProperty(t,"createDomToModelConfig",{enumerable:!0,get:function(){return ie.createDomToModelConfig}});var le=r(4051);Object.defineProperty(t,"createModelToDomContext",{enumerable:!0,get:function(){return le.createModelToDomContext}}),Object.defineProperty(t,"createModelToDomContextWithConfig",{enumerable:!0,get:function(){return le.createModelToDomContextWithConfig}}),Object.defineProperty(t,"createModelToDomConfig",{enumerable:!0,get:function(){return le.createModelToDomConfig}});var se=r(2391);Object.defineProperty(t,"isBold",{enumerable:!0,get:function(){return se.isBold}});var ce=r(3282);Object.defineProperty(t,"getSelectionRootNode",{enumerable:!0,get:function(){return ce.getSelectionRootNode}});var ue=r(4063);Object.defineProperty(t,"isCharacterValue",{enumerable:!0,get:function(){return ue.isCharacterValue}}),Object.defineProperty(t,"isModifierKey",{enumerable:!0,get:function(){return ue.isModifierKey}}),Object.defineProperty(t,"isCursorMovingKey",{enumerable:!0,get:function(){return ue.isCursorMovingKey}});var de=r(2384);Object.defineProperty(t,"combineBorderValue",{enumerable:!0,get:function(){return de.combineBorderValue}}),Object.defineProperty(t,"extractBorderValues",{enumerable:!0,get:function(){return de.extractBorderValues}});var fe=r(1302);Object.defineProperty(t,"isPunctuation",{enumerable:!0,get:function(){return fe.isPunctuation}}),Object.defineProperty(t,"isSpace",{enumerable:!0,get:function(){return fe.isSpace}}),Object.defineProperty(t,"normalizeText",{enumerable:!0,get:function(){return fe.normalizeText}});var pe=r(9981);Object.defineProperty(t,"parseTableCells",{enumerable:!0,get:function(){return pe.parseTableCells}});var me=r(5801);Object.defineProperty(t,"readFile",{enumerable:!0,get:function(){return me.readFile}});var he=r(483);Object.defineProperty(t,"transformColor",{enumerable:!0,get:function(){return he.transformColor}});var ge=r(5238);Object.defineProperty(t,"extractClipboardItems",{enumerable:!0,get:function(){return ge.extractClipboardItems}});var ve=r(8712);Object.defineProperty(t,"cacheGetEventData",{enumerable:!0,get:function(){return ve.cacheGetEventData}});var be=r(7682);Object.defineProperty(t,"isBlockGroupOfType",{enumerable:!0,get:function(){return be.isBlockGroupOfType}});var ye=r(8092);Object.defineProperty(t,"getClosestAncestorBlockGroupIndex",{enumerable:!0,get:function(){return ye.getClosestAncestorBlockGroupIndex}});var Se=r(3001);Object.defineProperty(t,"iterateSelections",{enumerable:!0,get:function(){return Se.iterateSelections}});var Ce=r(6522);Object.defineProperty(t,"getFirstSelectedListItem",{enumerable:!0,get:function(){return Ce.getFirstSelectedListItem}}),Object.defineProperty(t,"getFirstSelectedTable",{enumerable:!0,get:function(){return Ce.getFirstSelectedTable}}),Object.defineProperty(t,"getOperationalBlocks",{enumerable:!0,get:function(){return Ce.getOperationalBlocks}}),Object.defineProperty(t,"getSelectedParagraphs",{enumerable:!0,get:function(){return Ce.getSelectedParagraphs}}),Object.defineProperty(t,"getSelectedSegments",{enumerable:!0,get:function(){return Ce.getSelectedSegments}}),Object.defineProperty(t,"getSelectedSegmentsAndParagraphs",{enumerable:!0,get:function(){return Ce.getSelectedSegmentsAndParagraphs}});var _e=r(3899);Object.defineProperty(t,"getSelectedCells",{enumerable:!0,get:function(){return _e.getSelectedCells}});var Te=r(4652);Object.defineProperty(t,"hasSelectionInBlock",{enumerable:!0,get:function(){return Te.hasSelectionInBlock}});var Ee=r(264);Object.defineProperty(t,"hasSelectionInSegment",{enumerable:!0,get:function(){return Ee.hasSelectionInSegment}});var Me=r(1665);Object.defineProperty(t,"hasSelectionInBlockGroup",{enumerable:!0,get:function(){return Me.hasSelectionInBlockGroup}});var ke=r(9645);Object.defineProperty(t,"setSelection",{enumerable:!0,get:function(){return ke.setSelection}});var Oe=r(7005);Object.defineProperty(t,"cloneModel",{enumerable:!0,get:function(){return Oe.cloneModel}});var Pe=r(417);Object.defineProperty(t,"mergeModel",{enumerable:!0,get:function(){return Pe.mergeModel}});var we=r(1077);Object.defineProperty(t,"deleteSelection",{enumerable:!0,get:function(){return we.deleteSelection}});var xe=r(224);Object.defineProperty(t,"deleteSegment",{enumerable:!0,get:function(){return xe.deleteSegment}});var De=r(8322);Object.defineProperty(t,"deleteBlock",{enumerable:!0,get:function(){return De.deleteBlock}});var Le=r(9490);Object.defineProperty(t,"applyTableFormat",{enumerable:!0,get:function(){return Le.applyTableFormat}});var Fe=r(2751);Object.defineProperty(t,"normalizeTable",{enumerable:!0,get:function(){return Fe.normalizeTable}}),Object.defineProperty(t,"MIN_ALLOWED_TABLE_CELL_WIDTH",{enumerable:!0,get:function(){return Fe.MIN_ALLOWED_TABLE_CELL_WIDTH}});var Ne=r(9371);Object.defineProperty(t,"setTableCellBackgroundColor",{enumerable:!0,get:function(){return Ne.setTableCellBackgroundColor}});var Re=r(8329);Object.defineProperty(t,"retrieveModelFormatState",{enumerable:!0,get:function(){return Re.retrieveModelFormatState}});var Ie=r(8225);Object.defineProperty(t,"getListStyleTypeFromString",{enumerable:!0,get:function(){return Ie.getListStyleTypeFromString}});var je=r(4455);Object.defineProperty(t,"getSegmentTextFormat",{enumerable:!0,get:function(){return je.getSegmentTextFormat}});var Ae=r(1210);Object.defineProperty(t,"updateImageMetadata",{enumerable:!0,get:function(){return Ae.updateImageMetadata}}),Object.defineProperty(t,"getImageMetadata",{enumerable:!0,get:function(){return Ae.getImageMetadata}});var Be=r(8502);Object.defineProperty(t,"updateTableCellMetadata",{enumerable:!0,get:function(){return Be.updateTableCellMetadata}}),Object.defineProperty(t,"getTableCellMetadata",{enumerable:!0,get:function(){return Be.getTableCellMetadata}});var He=r(3562);Object.defineProperty(t,"updateTableMetadata",{enumerable:!0,get:function(){return He.updateTableMetadata}}),Object.defineProperty(t,"getTableMetadata",{enumerable:!0,get:function(){return He.getTableMetadata}});var ze=r(8458);Object.defineProperty(t,"updateListMetadata",{enumerable:!0,get:function(){return ze.updateListMetadata}}),Object.defineProperty(t,"getListMetadata",{enumerable:!0,get:function(){return ze.getListMetadata}}),Object.defineProperty(t,"ListMetadataDefinition",{enumerable:!0,get:function(){return ze.ListMetadataDefinition}});var Ue=r(5442);Object.defineProperty(t,"ChangeSource",{enumerable:!0,get:function(){return Ue.ChangeSource}});var We=r(7383);Object.defineProperty(t,"BulletListType",{enumerable:!0,get:function(){return We.BulletListType}});var Ge=r(2897);Object.defineProperty(t,"NumberingListType",{enumerable:!0,get:function(){return Ge.NumberingListType}});var Ke=r(5074);Object.defineProperty(t,"TableBorderFormat",{enumerable:!0,get:function(){return Ke.TableBorderFormat}});var Ve=r(913);Object.defineProperty(t,"OrderedListStyleMap",{enumerable:!0,get:function(){return Ve.OrderedListStyleMap}});var qe=r(123);Object.defineProperty(t,"UnorderedListStyleMap",{enumerable:!0,get:function(){return qe.UnorderedListStyleMap}})},1966:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setParagraphNotImplicit=void 0,t.setParagraphNotImplicit=function(e){"Paragraph"==e.blockType&&e.isImplicit&&(e.isImplicit=!1)}},6954:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addBlock=void 0,t.addBlock=function(e,t){e.blocks.push(t)}},6630:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addDecorators=t.addCode=t.addLink=void 0;var n=r(7582);function o(e,t){t.format.href&&(e.link={format:(0,n.__assign)({},t.format),dataset:(0,n.__assign)({},t.dataset)})}function a(e,t){t.format.fontFamily&&(e.code={format:(0,n.__assign)({},t.format)})}t.addLink=o,t.addCode=a,t.addDecorators=function(e,t){o(e,t.link),a(e,t.code)}},8613:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSegment=void 0;var n=r(2452);t.addSegment=function(e,t,r,o){var a=(0,n.ensureParagraph)(e,r,o),i=a.segments[a.segments.length-1];return(null==r?void 0:r.textIndent)&&(r.isTextIndentApplied&&0==a.segments.length?delete a.format.textIndent:r.isTextIndentApplied=!0,delete a.format.isTextIndentApplied),"SelectionMarker"==t.segmentType?i&&i.isSelected&&t.isSelected||a.segments.push(t):(t.isSelected&&"SelectionMarker"==(null==i?void 0:i.segmentType)&&i.isSelected&&a.segments.pop(),a.segments.push(t)),a}},2221:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addTextSegment=void 0;var n=r(6630),o=r(8613),a=r(2362),i=r(2452),l=r(75),s=r(7509);t.addTextSegment=function(e,t,r){var c,u;if(t){var d=(0,i.ensureParagraph)(e,r.blockFormat);(!(0,l.hasSpacesOnly)(t)||(null!==(c=null==d?void 0:d.segments.length)&&void 0!==c?c:0)>0||(0,s.isWhiteSpacePreserved)(null==d?void 0:d.format.whiteSpace))&&(u=(0,a.createText)(t,r.segmentFormat),r.isInSelection&&(u.isSelected=!0),(0,n.addDecorators)(u,r),(0,o.addSegment)(e,u,r.blockFormat))}return u}},2452:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureParagraph=void 0;var n=r(6954),o=r(673),a=r(9370);t.ensureParagraph=function(e,t,r){var i=e.blocks[e.blocks.length-1];if("Paragraph"==(null==i?void 0:i.blockType))return(0,a.mutateBlock)(i);var l=(0,o.createParagraph)(!0,t,r);return(0,n.addBlock)(e,l),l}},75:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasSpacesOnly=void 0;var r=/^[\r\n\t ]*$/;t.hasSpacesOnly=function(e){return r.test(e)}},9929:(e,t)=>{"use strict";function r(e){switch(e.blockType){case"Paragraph":return 0==e.segments.length;case"Table":return e.rows.every((function(e){return 0==e.cells.length}));case"BlockGroup":return n(e);default:return!1}}function n(e){switch(e.blockGroupType){case"FormatContainer":return"div"!=e.tagName&&e.blocks.every(r);case"ListItem":return e.blocks.every(r);case"Document":case"General":case"TableCell":return!1;default:return!0}}function o(e){switch(e.segmentType){case"Text":return!e.text;case"Image":return!e.src;default:return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmpty=t.isSegmentEmpty=t.isBlockGroupEmpty=t.isBlockEmpty=void 0,t.isBlockEmpty=r,t.isBlockGroupEmpty=n,t.isSegmentEmpty=o,t.isEmpty=function(e){return function(e){return"string"==typeof e.blockGroupType}(e)?n(e):function(e){return"string"==typeof e.blockType}(e)?r(e):!!function(e){return"string"==typeof e.segmentType}(e)&&o(e)}},9370:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mutateSegment=t.mutateSegments=t.mutateBlock=void 0;var n=r(7582);function o(e){return e.cachedElement&&delete e.cachedElement,"Table"==e.blockType?e.rows.forEach((function(e){delete e.cachedElement})):"ListItem"==e.blockGroupType&&e.levels.forEach((function(e){return delete e.cachedElement})),e}function a(e,t){var r=o(e),n=[r,[],[]];return t&&t.forEach((function(t){var o=e.segments.indexOf(t);o>=0&&(n[1].push(r.segments[o]),n[2].push(o))})),n}t.mutateBlock=o,t.mutateSegments=a,t.mutateSegment=function(e,t,r){var o,i=(0,n.__read)(a(e,[t]),3),l=i[0],s=i[1],c=i[2],u=s[0]==t?s[0]:null;return r&&u&&r(s[0],l,c[0]),[l,u,null!==(o=c[0])&&void 0!==o?o:-1]}},4527:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeContentModel=void 0;var n=r(9929),o=r(7589),a=r(1123);t.normalizeContentModel=function e(t){for(var r=t.blocks.length-1;r>=0;r--){var i=t.blocks[r];switch(i.blockType){case"BlockGroup":"ListItem"==i.blockGroupType&&0==i.levels.length?(r+=i.blocks.length,(0,a.unwrapBlock)(t,i)):e(i);break;case"Paragraph":(0,o.normalizeParagraph)(i);break;case"Table":for(var l=0;l<i.rows.length;l++)for(var s=0;s<i.rows[l].cells.length;s++)i.rows[l].cells[s]&&e(i.rows[l].cells[s])}(0,n.isBlockEmpty)(i)&&t.blocks.splice(r,1)}}},7589:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeParagraph=void 0;var n=r(7866),o=r(5713),a=r(9929),i=r(7509),l=r(2025);t.normalizeParagraph=function(e){var t=e.segments;if(!e.isImplicit&&t.length>0){var r=t[t.length-1],c=t[t.length-2];if("SelectionMarker"!=r.segmentType||c&&"Br"!=c.segmentType){if(t.length>1&&"Br"==t[t.length-1].segmentType){var u=t.filter((function(e){return"SelectionMarker"!=e.segmentType}));u.length>1&&"Br"!=u[u.length-2].segmentType&&t.pop()}}else t.push((0,o.createBr)(r.format))}(0,i.isWhiteSpacePreserved)(e.format.whiteSpace)||(0,l.normalizeAllSegments)(e),function(e){var t=e.segments.find((function(e){return"SelectionMarker"==e.segmentType}));if(t){var r=e.segments.indexOf(t),o=e.segments[r-1],a=e.segments[r+1];(o&&!o.link&&(0,n.areSameFormats)(o.format,t.format)&&(!a||!a.link&&(0,n.areSameFormats)(a.format,t.format))&&t.link||!o&&t.link&&a&&!a.link&&(0,n.areSameFormats)(a.format,t.format))&&delete t.link}}(e),function(e){for(var t=e.segments.length-1;t>=0;t--)(0,a.isSegmentEmpty)(e.segments[t])&&e.segments.splice(t,1)}(e),function(e){if(!e.decorator){var t=e.segments.filter((function(e){return"SelectionMarker"!=e.segmentType})),r=e.segmentFormat||{},n=!1;s.forEach((function(e){n=function(e,t,r){var n,o=null===(n=e[0])||void 0===n?void 0:n.format;return!(!(null==o?void 0:o[r])||!e.every((function(e){return e.format[r]==o[r]}))||(t[r]=o[r],0))}(t,r,e)||n})),n&&(e.segmentFormat=r)}}(e)};var s=["fontFamily","fontSize","textColor"]},2025:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeSegment=t.createNormalizeSegmentContext=t.normalizeSingleSegment=t.normalizeAllSegments=void 0;var n=r(75),o=" ",a=" ",i=/^\u0020+/,l=/\u0020+$/;function s(e){return Object.assign(null!=e?e:{},{textSegments:[],ignoreLeadingSpaces:!0,ignoreTrailingSpaces:!0,lastInlineSegment:void 0,lastTextSegment:void 0})}function c(e,t){switch(e.segmentType){case"Br":u(t.textSegments,t.lastInlineSegment),d(t.lastTextSegment,t.lastInlineSegment),s(t);break;case"Entity":case"General":case"Image":t.lastInlineSegment=e,t.ignoreLeadingSpaces=!1;break;case"Text":t.textSegments.push(e),t.lastInlineSegment=e,t.lastTextSegment=e;var r=e.text.substring(0,1),c=e.text.substr(-1);(0,n.hasSpacesOnly)(e.text)||(r==o&&(e.text=e.text.replace(i,t.ignoreLeadingSpaces?"":a)),c==o&&(e.text=e.text.replace(l,t.ignoreTrailingSpaces?o:a))),t.ignoreLeadingSpaces=c==o}}function u(e,t){e.forEach((function(e){if(e!=t){var r=e.text;r.substr(-1)==a&&r.length>1&&r.substr(-2,1)!=o&&(e.text=r.substring(0,r.length-1)+o)}}))}function d(e,t){e&&e==t&&(null==e?void 0:e.text.substr(-1))==o&&(e.text=e.text.replace(l,""))}t.normalizeAllSegments=function(e){var t=s();e.segments.forEach((function(e){c(e,t)})),u(t.textSegments,t.lastInlineSegment),d(t.lastTextSegment,t.lastInlineSegment)},t.normalizeSingleSegment=function(e,t){void 0===t&&(t=!1);var r=s();r.ignoreTrailingSpaces=t,c(e,r)},t.createNormalizeSegmentContext=function(){return s()},t.normalizeSegment=c},1123:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unwrapBlock=void 0;var n=r(7582),o=r(1966);t.unwrapBlock=function(e,t){var r,a,i=null!==(a=null==e?void 0:e.blocks.indexOf(t))&&void 0!==a?a:-1;i>=0&&(t.blocks.forEach(o.setParagraphNotImplicit),null==e||(r=e.blocks).splice.apply(r,(0,n.__spreadArray)([i,1],(0,n.__read)(t.blocks),!1)))}},5713:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createBr=void 0;var n=r(7582);t.createBr=function(e){return{segmentType:"Br",format:e?(0,n.__assign)({},e):{}}}},2178:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelDocument=void 0,t.createContentModelDocument=function(e){var t={blockGroupType:"Document",blocks:[]};return e&&(t.format=e),t}},9002:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDivider=void 0;var n=r(7582);t.createDivider=function(e,t){return{blockType:"Divider",tagName:e,format:t?(0,n.__assign)({},t):{}}}},1434:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEmptyModel=void 0;var n=r(5713),o=r(2178),a=r(673),i=r(9804);t.createEmptyModel=function(e){var t=(0,o.createContentModelDocument)(e),r=(0,a.createParagraph)(!1,void 0,e);return r.segments.push((0,i.createSelectionMarker)(e),(0,n.createBr)(e)),t.blocks.push(r),t}},7974:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEntity=void 0;var n=r(7582);t.createEntity=function(e,t,r,o,a){return void 0===t&&(t=!0),{segmentType:"Entity",blockType:"Entity",format:(0,n.__assign)({},r),entityFormat:{id:a,entityType:o,isReadonly:t},wrapper:e}}},1096:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFormatContainer=void 0;var n=r(7582);t.createFormatContainer=function(e,t){return{blockType:"BlockGroup",blockGroupType:"FormatContainer",tagName:e,blocks:[],format:(0,n.__assign)({},t||{})}}},513:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneralBlock=void 0,t.createGeneralBlock=function(e){return{blockType:"BlockGroup",blockGroupType:"General",element:e,blocks:[],format:{}}}},8465:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneralSegment=void 0;var n=r(7582);t.createGeneralSegment=function(e,t){return{blockType:"BlockGroup",blockGroupType:"General",segmentType:"General",format:t?(0,n.__assign)({},t):{},blocks:[],element:e}}},1143:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createImage=void 0;var n=r(7582);t.createImage=function(e,t){return{segmentType:"Image",src:e,format:t?(0,n.__assign)({},t):{},dataset:{}}}},5297:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListItem=void 0;var n=r(6549),o=r(9804);t.createListItem=function(e,t){var r=(0,o.createSelectionMarker)(t);return r.isSelected=!1,{blockType:"BlockGroup",blockGroupType:"ListItem",blocks:[],levels:e?e.map((function(e){return(0,n.createListLevel)(e.listType,e.format,e.dataset)})):[],formatHolder:r,format:{}}}},6549:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListLevel=void 0;var n=r(7582);t.createListLevel=function(e,t,r){return{listType:e,format:(0,n.__assign)({},t),dataset:(0,n.__assign)({},r)}}},673:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParagraph=void 0;var n=r(7582);t.createParagraph=function(e,t,r,o){var a={blockType:"Paragraph",segments:[],format:t?(0,n.__assign)({},t):{}};return r&&Object.keys(r).length>0&&(a.segmentFormat=(0,n.__assign)({},r)),e&&(a.isImplicit=!0),o&&(a.decorator={tagName:o.tagName,format:(0,n.__assign)({},o.format)}),a}},4002:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParagraphDecorator=void 0;var n=r(7582);t.createParagraphDecorator=function(e,t){return{tagName:e.toLocaleLowerCase(),format:(0,n.__assign)({},t||{})}}},9804:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionMarker=void 0;var n=r(7582);t.createSelectionMarker=function(e){return{segmentType:"SelectionMarker",isSelected:!0,format:e?(0,n.__assign)({},e):{}}}},711:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTable=void 0;var n=r(7582);t.createTable=function(e,t){for(var r=[],o=0;o<e;o++)r.push({height:0,format:{},cells:[]});return{blockType:"Table",rows:r,format:(0,n.__assign)({},t||{}),widths:[],dataset:{}}}},804:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTableCell=void 0;var n=r(7582);t.createTableCell=function(e,t,r,o,a){var i="number"==typeof e?e>1:!!e,l="number"==typeof t?t>1:!!t;return{blockGroupType:"TableCell",blocks:[],format:o?(0,n.__assign)({},o):{},spanLeft:i,spanAbove:l,isHeader:!!r,dataset:(0,n.__assign)({},a)}}},2362:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createText=void 0;var n=r(7582),o=r(6630);t.createText=function(e,t,r,a){var i={segmentType:"Text",text:e,format:t?(0,n.__assign)({},t):{}};return r&&(0,o.addLink)(i,r),a&&(0,o.addCode)(i,a),i}},9490:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.applyTableFormat=void 0;var o=r(7582),a=r(5493),i=r(2384),l=r(9371),s=r(5074),c=r(8502),u=r(3562),d={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:s.TableBorderFormat.Default,verticalAlign:null};t.applyTableFormat=function(e,t,r){var n=e.rows;(0,u.updateTableMetadata)(e,(function(s){var u=(0,o.__assign)((0,o.__assign)((0,o.__assign)({},d),s),t||{}),h=function(e,t){var r={bgColorOverrides:[],vAlignOverrides:[],borderOverrides:[]};return e.forEach((function(e){var n=[],o=[],a=[];r.bgColorOverrides.push(n),r.vAlignOverrides.push(o),r.borderOverrides.push(a),e.cells.forEach((function(e){(0,c.updateTableCellMetadata)(e,(function(e){return e&&t?(n.push(!1),delete e.bgColorOverride):n.push(!!(null==e?void 0:e.bgColorOverride)),o.push(!!(null==e?void 0:e.vAlignOverride)),a.push(!!(null==e?void 0:e.borderOverride)),e}))}))})),r}(n,!r);return delete e.cachedElement,function(e){e.forEach((function(e){e.cells.forEach((function(e){delete e.cachedElement})),delete e.cachedElement}))}(n),function(e,t,r){var n=t.hasBandedRows,o=t.hasBandedColumns,s=t.bgColorOdd,c=t.bgColorEven;e.forEach((function(u,d){u.cells.forEach((function(p,h){var g;if(!r.borderOverrides[d][h]&&"number"==typeof t.tableBorderFormat){var v=null===(g=f[t.tableBorderFormat])||void 0===g?void 0:g.call(f,{firstRow:0===d,lastRow:d===e.length-1,firstColumn:0===h,lastColumn:h===u.cells.length-1}),b=[t.topBorderColor,t.verticalBorderColor,t.bottomBorderColor,t.verticalBorderColor];null==v||v.forEach((function(e,t){var r=!e&&b[t]||"";p.format[a.BorderKeys[t]]=(0,i.combineBorderValue)({style:m(r),width:"1px",color:r})}))}if(!r.bgColorOverrides[d][h]){var y=(n||o)&&(o&&h%2!=0||n&&d%2!=0)?s:c;(0,l.setTableCellBackgroundColor)(p,y,!1,!0)}t.verticalAlign&&!r.vAlignOverrides[d][h]&&(p.format.verticalAlign=t.verticalAlign)}))}))}(n,u,h),function(e,t,r){e.forEach((function(n,o){n.cells.forEach((function(n,a){t.hasFirstColumn&&0===a?(n.isHeader=!0,0===o||r.bgColorOverrides[o][a]||(p(n.format,"borderTop"),(0,l.setTableCellBackgroundColor)(n,null,!1,!0)),o!==e.length-1&&0!==o&&p(n.format,"borderBottom")):n.isHeader=!1}))}))}(n,u,h),function(e,t,r){var n;null===(n=e[0])||void 0===n||n.cells.forEach((function(e,n){e.isHeader=t.hasHeaderRow,t.hasHeaderRow&&t.headerRowColor&&(r.bgColorOverrides[0][n]||(0,l.setTableCellBackgroundColor)(e,t.headerRowColor,!1,!0),p(e.format,"borderTop",t.headerRowColor),p(e.format,"borderRight",t.headerRowColor),p(e.format,"borderLeft",t.headerRowColor))}))}(n,u,h),u}))};var f=((n={})[s.TableBorderFormat.Default]=function(e){return[!1,!1,!1,!1]},n[s.TableBorderFormat.ListWithSideBorders]=function(e){return[!1,!e.lastColumn,!1,!e.firstColumn]},n[s.TableBorderFormat.FirstColumnHeaderExternal]=function(e){var t=e.firstColumn,r=e.firstRow;return[!r,!e.lastColumn&&!t||t&&r,!e.lastRow&&!r,!t]},n[s.TableBorderFormat.NoHeaderBorders]=function(e){var t=e.firstRow,r=e.firstColumn,n=e.lastColumn;return[t,t||n,!1,t||r]},n[s.TableBorderFormat.NoSideBorders]=function(e){var t=e.firstColumn;return[!1,e.lastColumn,!1,t]},n[s.TableBorderFormat.EspecialType1]=function(e){var t=e.firstRow,r=e.firstColumn;return[r&&!t,t,r&&!t,t&&!r]},n[s.TableBorderFormat.EspecialType2]=function(e){var t=e.firstRow,r=e.firstColumn;return[!t,t||!r,!t,!r]},n[s.TableBorderFormat.EspecialType3]=function(e){var t=e.firstColumn,r=e.firstRow;return[!0,r||!t,!r,!0]},n[s.TableBorderFormat.Clear]=function(){return[!0,!0,!0,!0]},n);function p(e,t,r){var n=(0,i.extractBorderValues)(e[t]);n.color=r||"",n.style=m(n.color),e[t]=(0,i.combineBorderValue)(n)}function m(e){return e&&"transparent"!=e?"solid":"none"}},7005:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneModel=void 0;var n=r(7582);function o(e){return{format:Object.assign({},e.format)}}function a(e){return{dataset:Object.assign({},e.dataset)}}function i(e){var t=e.blockType;return Object.assign({blockType:t},o(e))}function l(e,t){return{blockGroupType:e.blockGroupType,blocks:e.blocks.map((function(e){return function(e,t){switch(e.blockType){case"BlockGroup":switch(e.blockGroupType){case"FormatContainer":return function(e,t){var r=e.tagName,n=e.cachedElement,o=Object.assign({tagName:r,cachedElement:p(n,"cache",t)},i(e),l(e,t));return e.zeroFontSize&&(o.zeroFontSize=!0),o}(e,t);case"General":return d(e,t);case"ListItem":return function(e,t){var r=e.formatHolder,n=e.levels,o=e.cachedElement;return Object.assign({formatHolder:f(r),levels:n.map(u),cachedElement:p(o,"cache",t)},i(e),l(e,t))}(e,t)}break;case"Divider":return function(e,t){var r=e.tagName,n=e.isSelected,o=e.cachedElement;return Object.assign({isSelected:n,tagName:r,cachedElement:p(o,"cache",t)},i(e))}(e,t);case"Entity":return c(e,t);case"Paragraph":return function(e,t){var r=e.cachedElement,l=e.segments,u=e.isImplicit,m=e.decorator,h=e.segmentFormat,g=Object.assign({cachedElement:p(r,"cache",t),isImplicit:u,segments:l.map((function(e){return function(e,t){switch(e.segmentType){case"Br":return s(e);case"Entity":return c(e,t);case"General":return function(e,t){return Object.assign(d(e,t),s(e))}(e,t);case"Image":return i=(o=e).src,l=o.alt,u=o.title,p=o.isSelectedAsImageSelection,Object.assign({src:i,alt:l,title:u,isSelectedAsImageSelection:p},s(o),a(o));case"SelectionMarker":return f(e);case"Text":return n=(r=e).text,Object.assign({text:n},s(r))}var r,n,o,i,l,u,p}(e,t)})),segmentFormat:h?(0,n.__assign)({},h):void 0},i(e),o(e));return m&&(g.decorator=Object.assign({tagName:m.tagName},o(m))),g}(e,t);case"Table":return function(e,t){var r=e.cachedElement,n=e.widths,s=e.rows;return Object.assign({cachedElement:p(r,"cache",t),widths:Array.from(n),rows:s.map((function(e){return function(e,t){var r=e.height,n=e.cells,i=e.cachedElement;return Object.assign({height:r,cachedElement:p(i,"cache",t),cells:n.map((function(e){return function(e,t){var r=e.cachedElement,n=e.isSelected,i=e.spanAbove,s=e.spanLeft,c=e.isHeader;return Object.assign({cachedElement:p(r,"cache",t),isSelected:n,spanAbove:i,spanLeft:s,isHeader:c},l(e,t),o(e),a(e))}(e,t)}))},o(e))}(e,t)}))},i(e),a(e))}(e,t)}}(e,t)}))}}function s(e){var t=e.segmentType,r=e.isSelected,n=e.code,i=e.link,l=Object.assign({segmentType:t,isSelected:r},o(e));return n&&(l.code=o(n)),i&&(l.link=Object.assign(o(i),a(i))),l}function c(e,t){var r=e.wrapper,o=e.entityFormat;return Object.assign({wrapper:p(r,"entity",t),entityFormat:(0,n.__assign)({},o)},i(e),s(e))}function u(e){var t=e.listType;return Object.assign({listType:t},o(e),a(e))}function d(e,t){var r=e.element;return Object.assign({element:p(r,"general",t)},i(e),l(e,t))}function f(e){return Object.assign({isSelected:e.isSelected},s(e))}function p(e,t,r){var n=r.includeCachedElement;if(e){if(n){if(!0===n)return e;var o=n(e,t);if(("general"==t||"entity"==t)&&!o)throw new Error("Entity and General Model must has wrapper element");return o}return"cache"==t?void 0:e.cloneNode(!0)}}t.cloneModel=function(e,t){var r=l(e,t||{});return e.format&&(r.format=Object.assign({},e.format)),r}},8322:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBlock=void 0,t.deleteBlock=function(e,t,r,n,o){var a=e.indexOf(t);switch(t.blockType){case"Table":case"Divider":return r?e.splice(a,1,r):e.splice(a,1),!0;case"Entity":var i=t.isSelected?"overwrite":"forward"==o?"removeFromStart":"backward"==o?"removeFromEnd":void 0;return void 0!==i&&(r?e.splice(a,1,r):e.splice(a,1),null==n||n.deletedEntities.push({entity:t,operation:i})),!0;case"BlockGroup":switch(t.blockGroupType){case"General":return!!r&&(e.splice(a,1,r),!0);case"ListItem":case"FormatContainer":return e.splice(a,1),!0}}return!1}},4630:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteExpandedSelection=void 0;var n=r(7582),o=r(5713),a=r(673),i=r(9804),l=r(8322),s=r(224),c=r(4455),u=r(3001),d=r(1966),f={contentUnderSelectedTableCell:"ignoreForTableOrCell",contentUnderSelectedGeneralElement:"generalElementOnly",includeListFormatHolder:"never"};function p(e,t,r,n){return{marker:e,paragraph:t,path:r,tableContext:n}}t.deleteExpandedSelection=function(e,t){var r={deleteResult:"notDeleted",insertPoint:null,formatContext:t};return(0,u.iterateSelections)(e,(function(t,u,f,m){var h=(0,a.createParagraph)(!0,void 0,e.format),g=e.format,v=0;if(m)m[0]&&"Paragraph"==(null==f?void 0:f.blockType)&&(v=(h=f).segments.indexOf(m[0]),g=(0,c.getSegmentTextFormat)(m[0]),r.lastParagraph=h,r.lastTableContext=u,m.forEach((function(e,n){0!=n||r.insertPoint||"SelectionMarker"!=e.segmentType?(0,s.deleteSegment)(f,e,r.formatContext)&&(r.deleteResult="range"):r.insertPoint=p(e,f,t,u)})),"range"==r.deleteResult&&(0,d.setParagraphNotImplicit)(f));else if(f){var b=t[0].blocks;(0,l.deleteBlock)(b,f,h,r.formatContext)&&(r.deleteResult="range")}else if(u){var y=u.table,S=u.colIndex,C=u.rowIndex,_=y.rows[C],T=_.cells[S];t=(0,n.__spreadArray)([T],(0,n.__read)(t),!1),h.segments.push((0,o.createBr)(e.format)),T.blocks=[h],delete T.cachedElement,delete _.cachedElement,r.deleteResult="range"}if(!r.insertPoint){var E=(0,i.createSelectionMarker)(g);(0,d.setParagraphNotImplicit)(h),h.segments.splice(v,0,E),r.insertPoint=p(E,h,t,u)}}),f),r}},224:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSegment=void 0;var n=r(3125),o=r(7509),a=r(2025),i=r(1302);t.deleteSegment=function(e,t,r,l){var s=e.segments,c=s.indexOf(t),u=(0,o.isWhiteSpacePreserved)(e.format.whiteSpace),d="forward"==l,f="backward"==l;switch(u||function(e,t){for(var r,n=t-1;"SelectionMarker"==(null===(r=e[n])||void 0===r?void 0:r.segmentType);)n--;var o=e[n];o&&(0,a.normalizeSingleSegment)(o)}(s,c),t.segmentType){case"Br":case"Image":case"SelectionMarker":return s.splice(c,1),!0;case"Entity":var p=t.isSelected?"overwrite":d?"removeFromStart":f?"removeFromEnd":void 0;return void 0!==p&&(s.splice(c,1),null==r||r.deletedEntities.push({entity:t,operation:p})),!0;case"Text":var m=t.text;return 0==m.length||t.isSelected?s.splice(c,1):l&&(m=(0,n.deleteSingleChar)(m,d),u||(m=(0,i.normalizeText)(m,d)),""==m?s.splice(c,1):t.text=m),!0;case"General":return!!t.isSelected&&(s.splice(c,1),!0)}}},1077:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSelection=void 0;var n=r(7582),o=r(4630);t.deleteSelection=function(e,t,r){void 0===t&&(t=[]);var a=(0,o.deleteExpandedSelection)(e,r);return t.forEach((function(e){e&&function(e){return!!e.insertPoint}(a)&&e(a)})),function(e){var t,r=e.insertPoint,o=e.deleteResult,a=e.lastParagraph,i=e.lastTableContext;r&&"notDeleted"!=o&&"nothingToDelete"!=o&&a&&a!=r.paragraph&&i==r.tableContext&&((t=r.paragraph.segments).push.apply(t,(0,n.__spreadArray)([],(0,n.__read)(a.segments),!1)),a.segments=[])}(a),a}},3125:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSingleChar=void 0;var n=r(7582);t.deleteSingleChar=function(e,t){for(var r=(0,n.__spreadArray)([],(0,n.__read)(e),!1),o=0,a=t?0:r.length-1,i="notDeleted";a>=0&&a<r.length&&"done"!=i;a+=t?1:-1)switch(r[a]){case"‍":case"⃣":case"︎":case"️":i="notDeleted",o++;break;default:"notDeleted"==i?(i="waiting",o++):"waiting"==i&&(i="done")}return r.splice(t?0:r.length-o,o),r.join("")}},8092:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClosestAncestorBlockGroupIndex=void 0,t.getClosestAncestorBlockGroupIndex=function(e,t,r){void 0===r&&(r=[]);for(var n=0;n<e.length;n++){var o=e[n];if(t.indexOf(o.blockGroupType)>=0)return n;if(r.indexOf(o.blockGroupType)>=0)return-1}return-1}},8225:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getListStyleTypeFromString=void 0;var n=r(546),o=r(913),a=r(123);t.getListStyleTypeFromString=function(e,t){var r="OL"==e?o.OrderedListStyleMap:a.UnorderedListStyleMap,i=(0,n.getObjectKeys)(r).find((function(e){return r[e]==t}));return i&&"string"==typeof i?parseInt(i):i}},4455:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSegmentTextFormat=void 0,t.getSegmentTextFormat=function(e){var t,n=null!==(t=null==e?void 0:e.format)&&void 0!==t?t:{},o=n.fontFamily,a=n.fontSize,i=n.textColor,l=n.backgroundColor,s=n.letterSpacing,c=n.lineHeight;return r({fontFamily:o,fontSize:a,textColor:i,backgroundColor:l,letterSpacing:s,lineHeight:c})};var r=function(e){var t={};return Object.keys(e).filter((function(r){var n=e[r];void 0!==n&&(t[r]=n)})),t}},417:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeModel=void 0;var n=r(7582),o=r(8613),a=r(9490),i=r(5297),l=r(673),s=r(9804),c=r(804),u=r(1077),d=r(8092),f=r(546),p=r(4527),m=r(2751),h=["h1","h2","h3","h4","h5","h6"];function g(e,t,r,o,a){var i=e.paragraph,l=e.marker,s=r?i:y(e,t.format),c=s.segments.indexOf(l);if("none"==(null==a?void 0:a.mergeFormat)&&r&&(s.segments.forEach((function(e){e.format=(0,n.__assign)((0,n.__assign)({},s.segmentFormat||{}),e.format)})),delete s.segmentFormat),c>=0)for(var u=0;u<t.segments.length;u++){var d=t.segments[u];s.segments.splice(c+u,0,d),o&&("Entity"==d.segmentType&&o.newEntities.push(d),"Image"==d.segmentType&&o.newImages.push(d))}if(t.decorator&&(s.decorator=(0,n.__assign)({},t.decorator),h.indexOf(s.decorator.tagName)>-1)){var p=(0,f.getObjectKeys)(s.decorator.format),m=(0,f.getObjectKeys)(s.segmentFormat||{});p.forEach((function(e){var t;m.indexOf(e)>-1&&(null===(t=s.segmentFormat)||void 0===t||delete t[e])}))}s.format=r?(0,n.__assign)((0,n.__assign)({},s.format),t.format):t.format}function v(e,t,r){var n,i,l=e.tableContext,u=e.marker;if(l&&1==r.blocks.length&&r.blocks[0]==t){for(var d=l.table,f=l.colIndex,p=l.rowIndex,h=0;h<t.rows.length;h++)for(var g=0;g<t.rows[h].cells.length;g++){var v=t.rows[h].cells[g];if(0==h&&f+g>=d.rows[0].cells.length)for(var b=0;b<d.rows.length;b++){var y=null===(n=d.rows[b])||void 0===n?void 0:n.cells[f+g-1];d.rows[b].cells[f+g]=(0,c.createTableCell)(!1,!1,null==y?void 0:y.isHeader,null==y?void 0:y.format)}if(0==g&&p+h>=d.rows.length)for(d.rows[p+h]||(d.rows[p+h]={cells:[],format:{},height:0}),b=0;b<d.rows[p].cells.length;b++){var C=null===(i=d.rows[p+h-1])||void 0===i?void 0:i.cells[b];d.rows[p+h].cells[b]=(0,c.createTableCell)(!1,!1,!1,null==C?void 0:C.format)}var _=d.rows[p+h].cells[f+g];if(d.rows[p+h].cells[f+g]=v,0==h&&0==g){var T=(0,s.createSelectionMarker)(u.format),E=(0,o.addSegment)(v,T);e.path[0]==_&&(e.path[0]=v,e.marker=T,e.paragraph=E)}}(0,m.normalizeTable)(d,e.marker.format),(0,a.applyTableFormat)(d,void 0,!0)}else S(e,t)}function b(e,t){y(e,t.format);var r=e.path,o=e.paragraph,a=(0,d.getClosestAncestorBlockGroupIndex)(r,["ListItem"]),i=r[a],l=r[a+1],s=l.blocks.indexOf(i||o);s>=0&&l.blocks.splice(s,0,t),i&&(null==i||i.levels.forEach((function(e,r){t.levels[r]=(0,n.__assign)({},e)})))}function y(e,t){var r=e.paragraph,o=e.marker,a=e.path,s=r.segments.indexOf(o),c=a[0].blocks.indexOf(r),u=(0,l.createParagraph)(!1,(0,n.__assign)((0,n.__assign)({},r.format),t),r.segmentFormat);s>=0&&(u.segments=r.segments.splice(s)),c>=0&&a[0].blocks.splice(c+1,0,u);var f=(0,d.getClosestAncestorBlockGroupIndex)(a,["ListItem"],["FormatContainer","TableCell"]),p=a[f];if(p){var m=f>=0?a[f+1]:null,h=m?m.blocks.indexOf(p):-1;if(h>=0&&m){var g=(0,i.createListItem)(p.levels,p.formatHolder.format);c>=0&&(g.blocks=p.blocks.splice(c+1)),h>=0&&m.blocks.splice(h+1,0,g),a[f]=g}}return e.paragraph=u,u}function S(e,t){var r=e.path,n=y(e,"Paragraph"!==t.blockType?{}:t.format),o=r[0].blocks.indexOf(n);o>=0&&r[0].blocks.splice(o,0,t)}function C(e,t,r){e.blocks.forEach((function(e){var o;switch(function(e,t){"keepSourceEmphasisFormat"==e&&t.format.backgroundColor&&delete t.format.backgroundColor}(r,e),e.blockType){case"BlockGroup":"ListItem"==e.blockGroupType&&(e.formatHolder.format=_(r,t,e.formatHolder.format)),C(e,t,r);break;case"Table":e.rows.forEach((function(e){return e.cells.forEach((function(e){C(e,t,r)}))}));break;case"Paragraph":var a=(null===(o=e.decorator)||void 0===o?void 0:o.format)||{};e.segments.forEach((function(e){"General"==e.segmentType&&C(e,t,r),e.format=_(r,t,(0,n.__assign)((0,n.__assign)({},a),e.format))})),"keepSourceEmphasisFormat"===r&&delete e.decorator}}))}function _(e,t,r){return"mergeAll"==e?(0,n.__assign)((0,n.__assign)({},t),r):(0,n.__assign)((0,n.__assign)({},t),(a={},i=(o=r).fontWeight,l=o.italic,s=o.underline,i&&"normal"!=i&&(a.fontWeight=i),l&&(a.italic=l),s&&(a.underline=s),a));var o,a,i,l,s}t.mergeModel=function(e,t,r,o){var a,i=null!==(a=null==o?void 0:o.insertPosition)&&void 0!==a?a:(0,u.deleteSelection)(e,[],r).insertPoint;if(i){(null==o?void 0:o.mergeFormat)&&"none"!=o.mergeFormat&&C(t,(0,n.__assign)((0,n.__assign)({},e.format||{}),i.marker.format),null==o?void 0:o.mergeFormat);for(var l=0;l<t.blocks.length;l++){var s=t.blocks[l];switch(s.blockType){case"Paragraph":g(i,s,0==l,r,o);break;case"Divider":S(i,s);break;case"Entity":S(i,s),null==r||r.newEntities.push(s);break;case"Table":1==t.blocks.length&&(null==o?void 0:o.mergeTable)?v(i,s,t):S(i,s);break;case"BlockGroup":switch(s.blockGroupType){case"General":case"FormatContainer":S(i,s);break;case"ListItem":b(i,s)}}}}return(0,p.normalizeContentModel)(e),i}},2751:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeTable=t.MIN_ALLOWED_TABLE_CELL_WIDTH=void 0;var n=r(7582),o=r(6954),a=r(8613),i=r(5713),l=r(673);function s(e){return e<=4?120:e<=6?100:70}function c(e,t){var r;t.blocks.every((function(e){return"Paragraph"==e.blockType&&(0==(t=(t=e.segments).filter((function(e){return"SelectionMarker"!=e.segmentType}))).length||1==t.length&&"Br"==t[0].segmentType);var t}))||((r=e.blocks).push.apply(r,(0,n.__spreadArray)([],(0,n.__read)(t.blocks),!1)),t.blocks=[])}t.MIN_ALLOWED_TABLE_CELL_WIDTH=30,t.normalizeTable=function(e,r){var u,d=e.format;d.borderCollapse&&d.useBorderBox||(d.borderCollapse=!0,d.useBorderBox=!0),e.rows.forEach((function(e,t){e.cells.forEach((function(e,s){if(0==e.blocks.length){var c=e.format.textColor?(0,n.__assign)((0,n.__assign)({},r),{textColor:e.format.textColor}):r;(0,o.addBlock)(e,(0,l.createParagraph)(void 0,void 0,c)),(0,a.addSegment)(e,(0,i.createBr)(c))}0==t?e.spanAbove=!1:t>0&&e.isHeader&&(e.isHeader=!1,delete e.cachedElement),0==s&&(e.spanLeft=!1),e.format.useBorderBox=!0})),e.height<22&&(e.height=22)}));for(var f=Math.max.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(e.rows.map((function(e){return e.cells.length}))),!1)),p=0;p<f;p++)void 0===e.widths[p]?e.widths[p]=s(f):e.widths[p]<t.MIN_ALLOWED_TABLE_CELL_WIDTH&&(e.widths[p]=t.MIN_ALLOWED_TABLE_CELL_WIDTH);for(var m=function(t){e.rows.forEach((function(e){var r=e.cells[t],n=e.cells[t-1];r&&n&&r.spanLeft&&c(n,r)})),e.rows.every((function(e){var r;return null===(r=e.cells[t])||void 0===r?void 0:r.spanLeft}))&&(e.rows.forEach((function(e){return e.cells.splice(t,1)})),e.widths.splice(t-1,2,e.widths[t-1]+e.widths[t]))},h=((null===(u=e.rows[0])||void 0===u?void 0:u.cells.length)||0)-1;h>0;h--)m(h);for(var g=function(t){var r=e.rows[t];r.cells.forEach((function(r,n){var o,a=null===(o=e.rows[t-1])||void 0===o?void 0:o.cells[n];a&&r.spanAbove&&c(a,r)})),r.cells.every((function(e){return e.spanAbove}))&&(e.rows[t-1].height+=r.height,e.rows.splice(t,1))},v=e.rows.length-1;v>0;v--)g(v)}},8329:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveModelFormatState=void 0;var n=r(2384),o=r(8092),a=r(2391),i=r(3001),l=r(4406),s=r(3562);function c(e,t,r,n,o){void 0===o&&(o=function(e){return e}),n?void 0!==r&&(e[t]=r):o(r)!==o(e[t])&&delete e[t]}t.retrieveModelFormatState=function(e,t,r){var u,d,f,p=!0,m=!0,h=!0;(0,i.iterateSelections)(e,(function(i,f,g,v){if(function(e,t,r){var n,a,i=(0,o.getClosestAncestorBlockGroupIndex)(t,["ListItem"],[]),l=(0,o.getClosestAncestorBlockGroupIndex)(t,["FormatContainer"],[]);if(i>=0){var s=t[i],u=null===(n=null==s?void 0:s.levels[s.levels.length-1])||void 0===n?void 0:n.listType;c(e,"isBullet","UL"==u,r),c(e,"isNumbering","OL"==u,r)}c(e,"isBlockQuote",l>=0&&"blockquote"==(null===(a=t[l])||void 0===a?void 0:a.tagName),r)}(r,i,p),g&&(d?r.isMultilineSelection=!0:d=g),"Paragraph"==(null==g?void 0:g.blockType)&&(function(e,t,r){var n,o=parseInt(((null===(n=t.decorator)||void 0===n?void 0:n.tagName)||"").substring(1)),a=o>=1&&o<=6?o:void 0;c(e,"marginBottom",t.format.marginBottom,r),c(e,"marginTop",t.format.marginTop,r),c(e,"headingLevel",a,r),c(e,"textAlign",t.format.textAlign,r),c(e,"direction",t.format.direction,r)}(r,g,p),null==v||v.forEach((function(o){var i,s,u,d,f,b,y,S,C;if(h||"SelectionMarker"!=o.segmentType){var _=Object.assign({},e.format);null==_||delete _.italic,null==_||delete _.underline,null==_||delete _.fontWeight,function(e,t,r){var n,o,i=null===(o=null===(n=r.superOrSubScriptSequence)||void 0===n?void 0:n.split(" "))||void 0===o?void 0:o.pop();c(e,"isBold",(0,a.isBold)(r.fontWeight),t),c(e,"isItalic",r.italic,t),c(e,"isUnderline",r.underline,t),c(e,"isStrikeThrough",r.strikethrough,t),c(e,"isSuperscript","super"==i,t),c(e,"isSubscript","sub"==i,t),c(e,"letterSpacing",r.letterSpacing,t),c(e,"fontName",r.fontFamily,t),c(e,"fontSize",r.fontSize,t,(function(e){return(0,l.parseValueWithUnit)(e,void 0,"pt")+"pt"})),c(e,"backgroundColor",r.backgroundColor,t),c(e,"textColor",r.textColor,t),c(e,"fontWeight",r.fontWeight,t),c(e,"lineHeight",r.lineHeight,t)}(r,p,Object.assign({},_,g.format,null===(i=g.decorator)||void 0===i?void 0:i.format,o.format,null===(s=o.code)||void 0===s?void 0:s.format,null===(u=o.link)||void 0===u?void 0:u.format,t)),c(r,"isCodeInline",!!(null==o?void 0:o.code),p)}h=!1,r.canUnlink=r.canUnlink||!!o.link,r.canAddImageAltText=r.canAddImageAltText||v.some((function(e){return"Image"==e.segmentType})),p=!1,"Image"===o.segmentType&&(m?(d=r,f=o.format,"borderTop",y=(b=(0,n.extractBorderValues)(f.borderTop)).color,S=b.width,C=b.style,d.imageFormat={borderColor:y,borderWidth:S,borderStyle:C,boxShadow:f.boxShadow,borderRadius:f.borderRadius},m=!1):r.imageFormat=void 0)})),p=!1),f)if(u){var b=u.table,y=u.colIndex,S=u.rowIndex;f.table!=b||f.colIndex==y&&f.rowIndex==S||(r.canMergeTableCell=!0,r.isMultilineSelection=!0)}else!function(e,t){var r=(0,s.updateTableMetadata)(e.table);t.isInTable=!0,t.tableHasHeader=e.table.rows.some((function(e){return e.cells.some((function(e){return e.isHeader}))})),r&&(t.tableFormat=r)}(f,r),u=f}),{includeListFormatHolder:"never"}),r.fontSize&&(r.fontSize=(f=r.fontSize)&&f.indexOf("px")==f.length-2?Math.round(75*parseFloat(f)+.05)/100+"pt":f)}},9371:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTableCellBackgroundColor=void 0;var n=r(7582),o=r(1410),a=r(8502),i="#ffffff",l="#000000";function s(e,t){var r=c(t);return[i,"rgb(255,255,255)"].indexOf(e)>-1&&(r>80||""==t)||[l,"rgb(0,0,0)"].indexOf(e)>-1&&(r<20||""==t)}function c(e){var t=(0,o.parseColor)(e);if(t){var r=t[0]/255,n=t[1]/255,a=t[2]/255;return 50*(Math.max(r,n,a)+Math.min(r,n,a))}return 255}t.setTableCellBackgroundColor=function(e,t,r,o){if(t){e.format.backgroundColor=t,r&&(0,a.updateTableCellMetadata)(e,(function(e){return(e=e||{}).bgColorOverride=!0,e}));var u=c(t);u<20?e.format.textColor=i:u>80?e.format.textColor=l:delete e.format.textColor,o&&function(e){e.format.textColor&&e.blocks.forEach((function(t){var r;"Paragraph"==t.blockType&&((null===(r=t.segmentFormat)||void 0===r?void 0:r.textColor)||(t.segmentFormat=(0,n.__assign)((0,n.__assign)({},t.segmentFormat),{textColor:e.format.textColor})),t.segments.forEach((function(t){var r;(null===(r=t.format)||void 0===r?void 0:r.textColor)||(t.format=(0,n.__assign)((0,n.__assign)({},t.format),{textColor:e.format.textColor}))})))}))}(e)}else delete e.format.backgroundColor,delete e.format.textColor,o&&function(e){e.blocks.forEach((function(t){var r,n;"Paragraph"==t.blockType&&((null===(r=t.segmentFormat)||void 0===r?void 0:r.textColor)&&s(null===(n=t.segmentFormat)||void 0===n?void 0:n.textColor,e.format.backgroundColor||"")&&delete t.segmentFormat.textColor,t.segments.forEach((function(t){t.format.textColor&&s(t.format.textColor,e.format.backgroundColor||"")&&delete t.format.textColor})))}))}(e);delete e.cachedElement}},9914:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAutoListStyleType=void 0;var n=r(7383),o=r(2897),a=[o.NumberingListType.Decimal,o.NumberingListType.LowerAlpha,o.NumberingListType.LowerRoman],i=[n.BulletListType.Disc,n.BulletListType.Circle,n.BulletListType.Square],l={"lower-alpha":o.NumberingListType.LowerAlpha,"lower-latin":o.NumberingListType.LowerAlpha,"upper-alpha":o.NumberingListType.UpperAlpha,"upper-latin":o.NumberingListType.UpperAlpha,"lower-roman":o.NumberingListType.LowerRoman,"upper-roman":o.NumberingListType.UpperRoman},s={disc:n.BulletListType.Disc,circle:n.BulletListType.Circle,square:n.BulletListType.Square};t.getAutoListStyleType=function(e,t,r,n){var o=t.orderedStyleType,c=t.unorderedStyleType,u=t.applyListStyleFromLevel;return"OL"==e?"number"==typeof o?o:u?a[r%a.length]:n?l[n]:void 0:"number"==typeof c?c:u?i[r%i.length]:n?s[n]:void 0}},9926:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOrderedListNumberStr=void 0;var n=r(7582),o=r(546),a=r(2897),i={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};function l(e,t){var r="";for(e--;e>=0;)r=String.fromCharCode(e%26+65)+r,e=Math.floor(e/26)-1;return t?r.toLowerCase():r}function s(e,t){var r,a,l="";try{for(var s=(0,n.__values)((0,o.getObjectKeys)(i)),c=s.next();!c.done;c=s.next()){var u=c.value,d=Math.floor(e/i[u]);e-=d*i[u],l+=u.repeat(d)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(r)throw r.error}}return t?l.toLocaleLowerCase():l}t.getOrderedListNumberStr=function(e,t){switch(e){case a.NumberingListType.LowerAlpha:case a.NumberingListType.LowerAlphaDash:case a.NumberingListType.LowerAlphaDoubleParenthesis:case a.NumberingListType.LowerAlphaParenthesis:return l(t,!0);case a.NumberingListType.UpperAlpha:case a.NumberingListType.UpperAlphaDash:case a.NumberingListType.UpperAlphaDoubleParenthesis:case a.NumberingListType.UpperAlphaParenthesis:return l(t,!1);case a.NumberingListType.LowerRoman:case a.NumberingListType.LowerRomanDash:case a.NumberingListType.LowerRomanDoubleParenthesis:case a.NumberingListType.LowerRomanParenthesis:return s(t,!0);case a.NumberingListType.UpperRoman:case a.NumberingListType.UpperRomanDash:case a.NumberingListType.UpperRomanDoubleParenthesis:case a.NumberingListType.UpperRomanParenthesis:return s(t,!1);default:return t+""}}},836:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createObjectDefinition=t.createArrayDefinition=t.createStringDefinition=t.createBooleanDefinition=t.createNumberDefinition=void 0,t.createNumberDefinition=function(e,t,r,n,o){return{type:"number",isOptional:e,value:t,maxValue:n,minValue:r,allowNull:o}},t.createBooleanDefinition=function(e,t,r){return{type:"boolean",isOptional:e,value:t,allowNull:r}},t.createStringDefinition=function(e,t,r){return{type:"string",isOptional:e,value:t,allowNull:r}},t.createArrayDefinition=function(e,t,r,n,o){return{type:"array",isOptional:t,itemDef:e,minLength:r,maxLength:n,allowNull:o}},t.createObjectDefinition=function(e,t,r){return{type:"object",isOptional:t,propertyDef:e,allowNull:r}}},1210:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateImageMetadata=t.getImageMetadata=void 0;var n=r(8880),o=r(836),a=(0,o.createNumberDefinition)(),i=(0,o.createObjectDefinition)({widthPx:a,heightPx:a,leftPercent:a,rightPercent:a,topPercent:a,bottomPercent:a,angleRad:a,src:(0,o.createStringDefinition)(),naturalHeight:a,naturalWidth:a});t.getImageMetadata=function(e){return(0,n.getMetadata)(e,i)},t.updateImageMetadata=function(e,t){return(0,n.updateMetadata)(e,t,i)}},8458:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateListMetadata=t.getListMetadata=t.ListMetadataDefinition=void 0;var n=r(7383),o=r(8880),a=r(2897),i=r(836);t.ListMetadataDefinition=(0,i.createObjectDefinition)({orderedStyleType:(0,i.createNumberDefinition)(!0,void 0,a.NumberingListType.Min,a.NumberingListType.Max),unorderedStyleType:(0,i.createNumberDefinition)(!0,void 0,n.BulletListType.Min,n.BulletListType.Max),applyListStyleFromLevel:(0,i.createBooleanDefinition)(!0)},!0,!0),t.getListMetadata=function(e){return(0,o.getMetadata)(e,t.ListMetadataDefinition)},t.updateListMetadata=function(e,r){return(0,o.updateMetadata)(e,r,t.ListMetadataDefinition)}},8880:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasMetadata=t.updateMetadata=t.getMetadata=void 0;var n=r(3039),o="editingInfo";function a(e,t){var r=e.dataset[o],a=null;try{a=JSON.parse(r)}catch(e){}return!t||(0,n.validate)(a,t)?a:null}t.getMetadata=a,t.updateMetadata=function(e,t,r){var i=a(e,r);return t&&((i=t(i))?r&&!(0,n.validate)(i,r)||(e.dataset[o]=JSON.stringify(i)):delete e.dataset[o]),i},t.hasMetadata=function(e){return!!e.dataset[o]}},8502:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateTableCellMetadata=t.getTableCellMetadata=void 0;var n=r(836),o=r(8880),a=(0,n.createObjectDefinition)({bgColorOverride:(0,n.createBooleanDefinition)(!0),vAlignOverride:(0,n.createBooleanDefinition)(!0),borderOverride:(0,n.createBooleanDefinition)(!0)},!1,!0);t.getTableCellMetadata=function(e){return(0,o.getMetadata)(e,a)},t.updateTableCellMetadata=function(e,t){return(0,o.updateMetadata)(e,t,a)}},3562:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateTableMetadata=t.getTableMetadata=void 0;var n=r(8880),o=r(5074),a=r(836),i=(0,a.createStringDefinition)(!1,void 0,!0),l=(0,a.createBooleanDefinition)(!1),s=(0,a.createObjectDefinition)({topBorderColor:i,bottomBorderColor:i,verticalBorderColor:i,hasHeaderRow:l,headerRowColor:i,hasFirstColumn:l,hasBandedColumns:l,hasBandedRows:l,bgColorEven:i,bgColorOdd:i,tableBorderFormat:(0,a.createNumberDefinition)(!1,void 0,o.TableBorderFormat.Min,o.TableBorderFormat.Max),verticalAlign:i},!1,!0);t.getTableMetadata=function(e){return(0,n.getMetadata)(e,s)},t.updateTableMetadata=function(e,t){return(0,n.updateMetadata)(e,t,s)}},3039:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validate=void 0;var n=r(546);t.validate=function e(t,r){var o,a,i=!1;if(r.isOptional&&void 0===t||r.allowNull&&null===t)i=!0;else{if(!r.isOptional&&void 0===t||!r.allowNull&&null===t)return!1;switch(r.type){case"string":i="string"==typeof t&&(void 0===r.value||t===r.value);break;case"number":i="number"==typeof t&&(void 0===r.value||(o=r.value,a=t,Math.abs(o-a)<.001))&&(void 0===r.minValue||t>=r.minValue)&&(void 0===r.maxValue||t<=r.maxValue);break;case"boolean":i="boolean"==typeof t&&(void 0===r.value||t===r.value);break;case"array":i=Array.isArray(t)&&(void 0===r.minLength||t.length>=r.minLength)&&(void 0===r.maxLength||t.length<=r.maxLength)&&t.every((function(t){return e(t,r.itemDef)}));break;case"object":i="object"==typeof t&&(0,n.getObjectKeys)(r.propertyDef).every((function(n){return e(t[n],r.propertyDef[n])}))}}return i}},6522:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstSelectedListItem=t.getFirstSelectedTable=t.getOperationalBlocks=t.getSelectedParagraphs=t.getSelectedSegments=t.getSelectedSegmentsAndParagraphs=void 0;var n=r(7582),o=r(8092),a=r(7682),i=r(3001),l=r(9370);function s(e,t,r,n){var o=u(e,{includeListFormatHolder:t?"allSegments":"never"}),a=[];return o.forEach((function(e){var o=e.segments,i=e.block,s=e.path;if(o)if(t&&!i&&1==o.length&&"ListItem"==s[0].blockGroupType&&o[0]==s[0].formatHolder){var c=s[0];n&&(0,l.mutateBlock)(c),a.push([c.formatHolder,null,s])}else"Paragraph"==(null==i?void 0:i.blockType)&&(n&&(0,l.mutateBlock)(i),o.forEach((function(e){!r&&"Entity"==e.segmentType&&e.entityFormat.isReadonly||a.push([e,i,s])})))})),a}function c(e,t,r,n){var a=[],i=n?t.map((function(e){return[e]})):[t],l=u(e,{includeListFormatHolder:"never",contentUnderSelectedTableCell:"ignoreForTable"});return d(l),l.forEach((function(e){for(var t=e.path,n=e.block,l=function(e){var l=(0,o.getClosestAncestorBlockGroupIndex)(t,i[e],r);return l>=0?(a.filter((function(e){return e.block==t[l]})).length<=0&&a.push({parent:t[l+1],block:t[l],path:t.slice(l+1)}),"break"):e==i.length-1&&n?(a.push({parent:t[0],block:n,path:t}),"break"):void 0},s=0;s<i.length&&"break"!==l(s);s++);})),a}function u(e,t){var r=[];return(0,i.iterateSelections)(e,(function(e,t,n,o){r.push({path:e,tableContext:t,block:n,segments:o})}),t),r}function d(e){e.length>1&&f(e,!1)&&e.pop(),e.length>1&&f(e,!0)&&e.shift()}function f(e,t){var r,n=e[t?0:e.length-1];if("Paragraph"==(null===(r=n.block)||void 0===r?void 0:r.blockType)&&n.segments&&n.segments.length>0){var o=n.block.segments,a=n.segments[0];return 1==n.segments.length&&"SelectionMarker"==a.segmentType&&a==o[t?o.length-1:0]}return!1}t.getSelectedSegmentsAndParagraphs=s,t.getSelectedSegments=function(e,t,r){return(r?s(e,t,!1,!0):s(e,t)).map((function(e){return e[0]}))},t.getSelectedParagraphs=function(e,t){var r=u(e,{includeListFormatHolder:"never"}),n=[];return d(r),r.forEach((function(e){var r=e.block;"Paragraph"==(null==r?void 0:r.blockType)&&n.push(t?(0,l.mutateBlock)(r):r)})),n},t.getOperationalBlocks=c,t.getFirstSelectedTable=function(e){var t,r=u(e,{includeListFormatHolder:"never"}),o=[];return d(r),r.forEach((function(e){var r=e.block,a=e.tableContext,i=e.path;if(!t)if("Table"==(null==r?void 0:r.blockType))t=r,o=(0,n.__spreadArray)([],(0,n.__read)(i),!1);else if(null==a?void 0:a.table){t=a.table;var l=i.filter((function(e){return e.blocks.indexOf(a.table)>=0}))[0],s=i.indexOf(l);o=s>=0?i.slice(s):[]}})),[t,o]},t.getFirstSelectedListItem=function(e){var t;return c(e,["ListItem"],["TableCell"]).forEach((function(e){!t&&(0,a.isBlockGroupOfType)(e.block,"ListItem")&&(t=e.block)})),t}},3899:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectedCells=void 0;var n=r(1665);t.getSelectedCells=function(e){var t=-1,r=-1,o=-1,a=-1,i=!1;return e.rows.forEach((function(e,l){return e.cells.forEach((function(e,s){(0,n.hasSelectionInBlockGroup)(e)&&(i=!0,t<0&&(t=l),r<0&&(r=s),o=Math.max(o,l),a=Math.max(a,s))}))})),i?{firstRow:t,firstColumn:r,lastRow:o,lastColumn:a}:null}},4652:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasSelectionInBlock=void 0;var n=r(1665),o=r(264);t.hasSelectionInBlock=function(e){switch(e.blockType){case"Paragraph":return e.segments.some(o.hasSelectionInSegment);case"Table":return e.rows.some((function(e){return e.cells.some(n.hasSelectionInBlockGroup)}));case"BlockGroup":return(0,n.hasSelectionInBlockGroup)(e);case"Divider":case"Entity":return!!e.isSelected;default:return!1}}},1665:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasSelectionInBlockGroup=void 0;var n=r(4652);t.hasSelectionInBlockGroup=function(e){return!("TableCell"!=e.blockGroupType||!e.isSelected)||!!e.blocks.some(n.hasSelectionInBlock)}},264:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasSelectionInSegment=void 0;var n=r(4652);t.hasSelectionInSegment=function(e){return e.isSelected||"General"==e.segmentType&&e.blocks.some(n.hasSelectionInBlock)}},3001:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iterateSelections=void 0;var n=r(7582);function o(e,t,r,a,i){for(var l=e[0],s=(null==r?void 0:r.includeListFormatHolder)||"allSegments",c=(null==r?void 0:r.contentUnderSelectedTableCell)||"include",u=(null==r?void 0:r.contentUnderSelectedGeneralElement)||"contentOnly",d=!1,f=!1,p=0;p<l.blocks.length;p++){var m=l.blocks[p];switch(m.blockType){case"BlockGroup":var h=(0,n.__spreadArray)([m],(0,n.__read)(e),!1);if("General"==m.blockGroupType){var g=!(P=i||m.isSelected)||"both"==u||"contentOnly"==u,v=P&&("both"==u||"generalElementOnly"==u||0==m.blocks.length);if(g&&o(h,t,r,a,P)||v&&t(e,a,m))return!0}else if(o(h,t,r,a,i))return!0;break;case"Table":var b=m.rows,y=b.every((function(e){return e.cells.every((function(e){return e.isSelected}))}));if("include"!=c&&y){if(t(e,a,m))return!0}else for(var S=0;S<b.length;S++)for(var C=b[S],_=0;_<C.cells.length;_++){var T=C.cells[_];if(T){var E={table:m,rowIndex:S,colIndex:_,isWholeTableSelected:y};if(T.isSelected&&t(e,E))return!0;if((!T.isSelected||"ignoreForTableOrCell"!=c)&&o((0,n.__spreadArray)([T],(0,n.__read)(e),!1),t,r,E,P=i||T.isSelected))return!0}}break;case"Paragraph":for(var M=[],k=0;k<m.segments.length;k++){var O=m.segments[k],P=i||O.isSelected;if("General"==O.segmentType){if(g=!P||"both"==u||"contentOnly"==u,v=P&&("both"==u||"generalElementOnly"==u||0==O.blocks.length),g&&o((0,n.__spreadArray)([O],(0,n.__read)(e),!1),t,r,a,P))return!0;v&&M.push(O)}else P&&M.push(O);P?d=!0:f=!0}if(M.length>0&&t(e,a,m,M))return!0;break;case"Divider":case"Entity":if((i||m.isSelected)&&t(e,a,m))return!0}}return!("never"==s||"ListItem"!=l.blockGroupType||!d||f&&"anySegment"!=s||!t(e,a,void 0,[l.formatHolder]))}t.iterateSelections=function(e,t,r){o([e],(function(e,r,n,o){var a;return(null===(a=n)||void 0===a?void 0:a.cachedElement)&&delete n.cachedElement,t(e,r,n,o)}),r)}},9645:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSelection=void 0;var n=r(2006);function o(e,t,r,s){return l(t,e,r,s,(function(t){return(0,n.isGeneralSegment)(e)&&i(e,t),e.blocks.forEach((function(e){t=function(e,t,r,n){switch(e.blockType){case"BlockGroup":return o(e,t,r,n);case"Table":return function(e,t,r,n){var l=a(e,r),s=n?a(e,n):l;if(t)e.rows.forEach((function(e){return e.cells.forEach((function(e){t=o(e,t,r,n)}))}));else for(var c=0;c<e.rows.length;c++)for(var u=e.rows[c],d=0;d<u.cells.length;d++){var f=e.rows[c].cells[d],p=c>=l.row&&c<=s.row&&d>=l.col&&d<=s.col;i(f,p),p||o(f,!1,r,n)}return t}(e,t,r,n);case"Divider":case"Entity":return l(t,e,r,n,(function(t){return t?e.isSelected=!0:delete e.isSelected,t}));case"Paragraph":var s=[];for(e.segments.forEach((function(e,a){t=l(t,e,r,n,(function(t){return function(e,t,r,n,a,l){switch(e.segmentType){case"SelectionMarker":return(!t||e!=n&&e!=a)&&r.push(l),t;case"General":return i(e,t),e!=n&&e!=a?o(e,t,n,a):t;case"Image":return i(e,t),e.isSelectedAsImageSelection=n==e&&(!a||a==e),t;default:return i(e,t),t}}(e,t,s,r,n,a)}))}));s.length>0;){var c=s.pop();c>=0&&e.segments.splice(c,1)}return t;default:return t}}(e,t,r,s)})),t}))}function a(e,t){var r=-1;return{row:t?e.rows.findIndex((function(e){return(r=e.cells.indexOf(t))>=0})):-1,col:r}}function i(e,t){return t?e.isSelected=!0:delete e.isSelected,t}function l(e,t,r,n,o){return(e=o(e=e||t==r))&&!!n&&t!=n}t.setSelection=function(e,t,r){o(e,!1,t||null,r||null)}},7682:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBlockGroupOfType=void 0,t.isBlockGroupOfType=function(e,t){return(null==e?void 0:e.blockGroupType)==t}},2006:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeneralSegment=void 0,t.isGeneralSegment=function(e){return"General"==e.blockGroupType&&"General"==e.segmentType}},7802:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contentModelToDom=void 0;var n=r(8882),o=r(7834);function a(e){var t,r,a,i;if(e.block&&(e.segment?(0,n.isNodeOfType)(e.segment,"TEXT_NODE")?i={container:e.segment,offset:(null===(t=e.segment.nodeValue)||void 0===t?void 0:t.length)||0}:e.segment.parentNode&&(i={container:e.segment.parentNode,offset:(0,o.toArray)(e.segment.parentNode.childNodes).indexOf(e.segment)+1}):i={container:e.block,offset:0}),i&&(0,n.isNodeOfType)(i.container,"DOCUMENT_FRAGMENT_NODE")){var l=i.container.childNodes;if(l.length>i.offset)i={container:l[i.offset],offset:0};else if(i.container.lastChild){var s=i.container.lastChild;i={container:s,offset:(0,n.isNodeOfType)(s,"TEXT_NODE")?null!==(a=null===(r=s.nodeValue)||void 0===r?void 0:r.length)&&void 0!==a?a:0:s.childNodes.length}}else i=void 0}return i}t.contentModelToDom=function(e,t,r,n){n.modelHandlers.blockGroupChildren(e,t,r,n);var o=function(e,t){var r,n,o=t.regularSelection,i=o.start,l=o.end,s=t.tableSelection,c=t.imageSelection;if(c)return c;if((r=i&&a(i))&&(n=l&&a(l))){var u=e.createRange();return u.setStart(r.container,r.offset),u.setEnd(n.container,n.offset),{type:"range",range:u,isReverted:!1}}return s||null}(e,n);return r.hasRevertedRangeSelection&&"range"==(null==o?void 0:o.type)&&(o.isReverted=!0),t.normalize(),o}},4051:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildFormatAppliers=t.createModelToDomConfig=t.createModelToDomContextWithConfig=t.createModelToDomContext=void 0;var n=r(7582),o=r(8203),a=r(546),i=r(5606);function l(e,t){return Object.assign({},t,{regularSelection:{current:{block:null,segment:null}}},{listFormat:{threadItemCounts:[],nodeStack:[]},implicitFormat:{}},e)}function s(e){return{modelHandlers:Object.assign.apply(Object,(0,n.__spreadArray)([{},o.defaultContentModelHandlers],(0,n.__read)(e.map((function(e){return null==e?void 0:e.modelHandlerOverride}))),!1)),formatAppliers:c(e.map((function(e){return null==e?void 0:e.formatApplierOverride})),e.map((function(e){return null==e?void 0:e.additionalFormatAppliers}))),defaultModelHandlers:o.defaultContentModelHandlers,defaultFormatAppliers:i.defaultFormatAppliers,metadataAppliers:Object.assign.apply(Object,(0,n.__spreadArray)([{}],(0,n.__read)(e.map((function(e){return null==e?void 0:e.metadataAppliers}))),!1))}}function c(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var r=Object.assign.apply(Object,(0,n.__spreadArray)([{}],(0,n.__read)(e),!1)),o=(0,a.getObjectKeys)(i.defaultFormatKeysPerCategory).reduce((function(e,o){var a,l=(a=i.defaultFormatKeysPerCategory[o].map((function(e){return void 0===r[e]?i.defaultFormatAppliers[e]:r[e]}))).concat.apply(a,(0,n.__spreadArray)([],(0,n.__read)(t.map((function(e){var t;return null!==(t=null==e?void 0:e[o])&&void 0!==t?t:[]}))),!1));return e[o]=l,e}),{text:[]});return t.forEach((function(e){(null==e?void 0:e.text)&&(o.text=o.text.concat(e.text))})),o}t.createModelToDomContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l(s(t),e)},t.createModelToDomContextWithConfig=l,t.createModelToDomConfig=s,t.buildFormatAppliers=c},8203:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultContentModelHandlers=void 0;var n=r(5388),o=r(4392),a=r(2799),i=r(3433),l=r(4242),s=r(2058),c=r(8197),u=r(7262),d=r(5288),f=r(3169),p=r(4232),m=r(6850),h=r(3577),g=r(5849),v=r(6809);t.defaultContentModelHandlers={block:n.handleBlock,blockGroupChildren:o.handleBlockGroupChildren,br:a.handleBr,entityBlock:l.handleEntityBlock,entitySegment:l.handleEntitySegment,generalBlock:c.handleGeneralBlock,generalSegment:c.handleGeneralSegment,divider:i.handleDivider,image:u.handleImage,list:d.handleList,listItem:f.handleListItem,paragraph:p.handleParagraph,formatContainer:s.handleFormatContainer,segment:m.handleSegment,segmentDecorator:h.handleSegmentDecorator,table:g.handleTable,text:v.handleText}},5388:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleBlock=void 0,t.handleBlock=function(e,t,r,n,o){var a=n.modelHandlers;switch(r.blockType){case"Table":o=a.table(e,t,r,n,o);break;case"Paragraph":o=a.paragraph(e,t,r,n,o);break;case"Entity":o=a.entityBlock(e,t,r,n,o);break;case"Divider":o=a.divider(e,t,r,n,o);break;case"BlockGroup":switch(r.blockGroupType){case"General":o=a.generalBlock(e,t,r,n,o);break;case"FormatContainer":o=a.formatContainer(e,t,r,n,o);break;case"ListItem":o=a.listItem(e,t,r,n,o)}}return o}},4392:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleBlockGroupChildren=void 0,t.handleBlockGroupChildren=function(e,t,r,n){var o,a=n.listFormat,i=a.nodeStack,l=t.firstChild;try{for(r.blocks.forEach((function(r,o){0!=o&&"BlockGroup"==r.blockType&&"ListItem"==r.blockGroupType||(a.nodeStack=[]),l=n.modelHandlers.block(e,t,r,n,l)}));l;){var s=l.nextSibling;null===(o=l.parentNode)||void 0===o||o.removeChild(l),l=s}}finally{a.nodeStack=i}}},2799:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleBr=void 0;var n=r(3249);t.handleBr=function(e,t,r,o,a){var i=e.createElement("br"),l=e.createElement("span");l.appendChild(i),t.appendChild(l),(0,n.handleSegmentCommon)(e,i,l,r,o,a)}},3433:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleDivider=void 0;var n=r(4043),o=r(5345);t.handleDivider=function(e,t,r,a,i){var l,s=a.allowCacheElement?r.cachedElement:void 0;return s?i=(0,o.reuseCachedElement)(t,s,i):(s=e.createElement(r.tagName),a.allowCacheElement&&(r.cachedElement=s),t.insertBefore(s,i),(0,n.applyFormat)(s,a.formatAppliers.divider,r.format,a),r.size&&s.setAttribute("size",r.size)),null===(l=a.onNodeCreated)||void 0===l||l.call(a,r,s),i}},4242:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleEntitySegment=t.handleEntityBlock=void 0;var n=r(7582),o=r(3566),a=r(4043),i=r(546),l=r(5345),s=r(3168),c="_E_EBlockEntityContainer";function u(e){var t;return(0,n.__assign)((0,n.__assign)({},null===(t=e.pendingFormat)||void 0===t?void 0:t.format),e.defaultFormat)}t.handleEntityBlock=function(e,t,r,n,i){var d,f,p=r.entityFormat,m=r.wrapper;(0,a.applyFormat)(m,n.formatAppliers.entity,p,n);var h=n.addDelimiterForEntity&&"inline-block"==m.style.display&&"100%"==m.style.width,g=null===(d=m.parentElement)||void 0===d?void 0:d.classList.contains(c),v=g&&h?m.parentElement:m;return i=(0,l.reuseCachedElement)(t,v,i),h&&(g||(0,s.wrap)(e,m,"div").classList.add(c),(0,o.addDelimiters)(e,m,u(n),n)),null===(f=n.onNodeCreated)||void 0===f||f.call(n,r,m),i},t.handleEntitySegment=function(e,t,r,l,c){var d,f=r.entityFormat,p=r.wrapper,m=r.format;if(t.appendChild(p),null==c||c.push(p),(0,i.getObjectKeys)(m).length>0){var h=(0,s.wrap)(e,p,"span");(0,a.applyFormat)(h,l.formatAppliers.segment,m,l)}if((0,a.applyFormat)(p,l.formatAppliers.entity,f,l),l.addDelimiterForEntity&&f.isReadonly){var g=(0,n.__read)((0,o.addDelimiters)(e,p,u(l),l),2),v=g[0],b=g[1];null==c||c.push(v,b),l.regularSelection.current.segment=v}else l.regularSelection.current.segment=p;null===(d=l.onNodeCreated)||void 0===d||d.call(l,r,p)}},2058:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleFormatContainer=void 0;var n=r(4043),o=r(9929),a=r(5345),i=r(1498),l={fontFamily:"monospace",whiteSpace:"pre"};t.handleFormatContainer=function(e,t,r,s,c){var u,d=s.allowCacheElement?r.cachedElement:void 0;if(d)c=(0,a.reuseCachedElement)(t,d,c),s.modelHandlers.blockGroupChildren(e,d,r,s);else if(!(0,o.isBlockGroupEmpty)(r)){var f=e.createElement(r.tagName);s.allowCacheElement&&(r.cachedElement=f),t.insertBefore(f,c),(0,i.stackFormat)(s,r.tagName,(function(){(0,n.applyFormat)(f,s.formatAppliers.container,r.format,s),(0,n.applyFormat)(f,s.formatAppliers.segmentOnBlock,r.format,s),(0,n.applyFormat)(f,s.formatAppliers.container,r.format,s)})),"pre"==r.tagName?(0,i.stackFormat)(s,l,(function(){s.modelHandlers.blockGroupChildren(e,f,r,s)})):s.modelHandlers.blockGroupChildren(e,f,r,s),d=f}return d&&(null===(u=s.onNodeCreated)||void 0===u||u.call(s,r,d)),c}},8197:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleGeneralSegment=t.handleGeneralBlock=void 0;var n=r(4043),o=r(3249),a=r(8882),i=r(5345),l=r(3168);t.handleGeneralBlock=function(e,t,r,o,a){var l,s=r.element;return a&&s.parentNode==t?a=(0,i.reuseCachedElement)(t,s,a):(s=s.cloneNode(),r.element=s,(0,n.applyFormat)(s,o.formatAppliers.general,r.format,o),t.insertBefore(s,a)),null===(l=o.onNodeCreated)||void 0===l||l.call(o,r,s),o.modelHandlers.blockGroupChildren(e,s,r,o),a},t.handleGeneralSegment=function(e,t,r,i,s){var c,u=r.element.cloneNode();if(r.element=u,t.appendChild(u),(0,a.isNodeOfType)(u,"ELEMENT_NODE")){var d=(0,l.wrap)(e,u,"span");(0,o.handleSegmentCommon)(e,u,d,r,i,s),(0,n.applyFormat)(u,i.formatAppliers.general,r.format,i),null===(c=i.onNodeCreated)||void 0===c||c.call(i,r,u)}i.modelHandlers.blockGroupChildren(e,u,r,i)}},7262:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleImage=void 0;var n=r(4043),o=r(3249),a=r(4406);t.handleImage=function(e,t,r,i,l){var s=e.createElement("img"),c=document.createElement("span");t.appendChild(c),c.appendChild(s),s.src=r.src,r.alt&&(s.alt=r.alt),r.title&&(s.title=r.title),(0,n.applyFormat)(s,i.formatAppliers.image,r.format,i),(0,n.applyFormat)(s,i.formatAppliers.dataset,r.dataset,i);var u=r.format,d=u.width,f=u.height,p=d?(0,a.parseValueWithUnit)(d):0,m=f?(0,a.parseValueWithUnit)(f):0;p>0&&(s.width=p),m>0&&(s.height=m),r.isSelectedAsImageSelection&&(i.imageSelection={type:"image",image:s}),(0,o.handleSegmentCommon)(e,s,c,r,i,l)}},5288:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleList=void 0;var n=r(7582),o=r(4043),a=r(669);t.handleList=function(e,t,r,i,l){var s,c,u=0,d=i.listFormat.nodeStack;for(0==d.length&&d.push({node:t});u<r.levels.length&&u+1<d.length;u++){var f=d[u+1],p=r.levels[u];if(f.listType!=p.listType||(null===(s=f.dataset)||void 0===s?void 0:s.editingInfo)!=p.dataset.editingInfo||"OL"==p.listType&&"number"==typeof p.format.startNumberOverride)break}for(d.splice(u+1);u<r.levels.length;u++){var m=r.levels[u],h=e.createElement(m.listType||"UL");d[d.length-1].node.insertBefore(h,0==u?l:null),d.push((0,n.__assign)({node:h},m)),(0,o.applyFormat)(h,i.formatAppliers.listLevelThread,m.format,i),(0,a.applyMetadata)(m,i.metadataAppliers.listLevel,m.format,i),(0,o.applyFormat)(h,i.formatAppliers.listLevel,m.format,i),(0,o.applyFormat)(h,i.formatAppliers.dataset,m.dataset,i),null===(c=i.onNodeCreated)||void 0===c||c.call(i,m,h)}return l}},3169:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleListItem=void 0;var n=r(4043),o=r(669),a=r(1966),i=r(3242);t.handleListItem=function(e,t,r,l,s){var c,u;s=l.modelHandlers.list(e,t,r,l,s);var d=l.listFormat.nodeStack,f=(null===(c=null==d?void 0:d[(null==d?void 0:d.length)-1])||void 0===c?void 0:c.node)||t,p=e.createElement("li"),m=r.levels[r.levels.length-1];return f.insertBefore(p,(null==s?void 0:s.parentNode)==f?s:null),m?((0,n.applyFormat)(p,l.formatAppliers.segment,r.formatHolder.format,l),(0,n.applyFormat)(p,l.formatAppliers.listItemThread,m.format,l),(0,o.applyMetadata)(m,l.metadataAppliers.listItem,r.format,l),(0,n.applyFormat)(p,l.formatAppliers.listItemElement,r.format,l),l.modelHandlers.blockGroupChildren(e,p,r,l)):(r.blocks.forEach(a.setParagraphNotImplicit),l.modelHandlers.blockGroupChildren(e,p,r,l),(0,i.unwrap)(p)),null===(u=l.onNodeCreated)||void 0===u||u.call(l,r,p),s}},4232:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleParagraph=void 0;var n=r(7582),o=r(4043),a=r(546),i=r(8588),l=r(5345),s=r(1498),c=r(3242);t.handleParagraph=function(e,t,r,u,d){var f,p=u.allowCacheElement?r.cachedElement:void 0;return p?d=(0,l.reuseCachedElement)(t,p,d):(0,s.stackFormat)(u,(null===(f=r.decorator)||void 0===f?void 0:f.tagName)||null,(function(){var l,f,m,h,g=!r.isImplicit||!!r.decorator||(0,a.getObjectKeys)(r.format).length>0&&r.segments.some((function(e){return"SelectionMarker"!=e.segmentType})),v=g?(0,n.__assign)((0,n.__assign)({},(null===(l=r.decorator)||void 0===l?void 0:l.format)||{}),r.segmentFormat):{};p=e.createElement((null===(f=r.decorator)||void 0===f?void 0:f.tagName)||"div"),t.insertBefore(p,d),u.regularSelection.current={block:g?p:p.parentNode,segment:null};var b=function(){var t=p;if(t){var o=r.segments[0];"SelectionMarker"==(null==o?void 0:o.segmentType)&&u.modelHandlers.text(e,t,(0,n.__assign)((0,n.__assign)({},o),{segmentType:"Text",text:""}),u,[]),r.segments.forEach((function(n){var o=[];u.modelHandlers.segment(e,t,n,u,o),o.forEach((function(e){var t;null===(t=u.domIndexer)||void 0===t||t.onSegment(e,r,[n])}))}))}};g?((0,s.stackFormat)(u,v,b),(0,o.applyFormat)(p,u.formatAppliers.block,r.format,u),(0,o.applyFormat)(p,u.formatAppliers.container,r.format,u),(0,o.applyFormat)(p,u.formatAppliers.segmentOnBlock,v,u)):b(),(0,i.optimize)(p),d=p.nextSibling,p&&(null===(m=u.onNodeCreated)||void 0===m||m.call(u,r,p),null===(h=u.domIndexer)||void 0===h||h.onParagraph(p)),g?u.allowCacheElement&&(r.cachedElement=p):((0,c.unwrap)(p),p=void 0)})),d}},6850:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegment=void 0;var n=r(7582);t.handleSegment=function(e,t,r,o,a){var i=o.regularSelection;switch(r.isSelected&&!i.start&&(i.start=(0,n.__assign)({},i.current)),r.segmentType){case"Text":o.modelHandlers.text(e,t,r,o,a);break;case"Br":o.modelHandlers.br(e,t,r,o,a);break;case"Image":o.modelHandlers.image(e,t,r,o,a);break;case"General":o.modelHandlers.generalSegment(e,t,r,o,a);break;case"Entity":o.modelHandlers.entitySegment(e,t,r,o,a)}r.isSelected&&i.start&&(i.end=(0,n.__assign)({},i.current))}},3577:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegmentDecorator=void 0;var n=r(4043),o=r(8882),a=r(1498),i=r(973);t.handleSegmentDecorator=function(e,t,r,l,s){var c=r.code,u=r.link;(0,o.isNodeOfType)(t,"ELEMENT_NODE")&&(u&&(0,a.stackFormat)(l,"a",(function(){var e,r=(0,i.wrapAllChildNodes)(t,"a");(0,n.applyFormat)(r,l.formatAppliers.link,u.format,l),(0,n.applyFormat)(r,l.formatAppliers.dataset,u.dataset,l),null==s||s.push(r),null===(e=l.onNodeCreated)||void 0===e||e.call(l,u,r)})),c&&(0,a.stackFormat)(l,"code",(function(){var e,r=(0,i.wrapAllChildNodes)(t,"code");(0,n.applyFormat)(r,l.formatAppliers.code,c.format,l),null==s||s.push(r),null===(e=l.onNodeCreated)||void 0===e||e.call(l,c,r)})))}},5849:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleTable=void 0;var n=r(4043),o=r(8880),a=r(9929),i=r(973),l=r(5345);t.handleTable=function(e,t,r,s,c){var u,d,f,p,m,h,g;if((0,a.isBlockEmpty)(r))return c;var v=s.allowCacheElement?r.cachedElement:void 0;v?(c=(0,l.reuseCachedElement)(t,v,c),(0,i.moveChildNodes)(v)):(v=e.createElement("table"),s.allowCacheElement&&(r.cachedElement=v),t.insertBefore(v,c),(0,n.applyFormat)(v,s.formatAppliers.block,r.format,s),(0,n.applyFormat)(v,s.formatAppliers.table,r.format,s),(0,n.applyFormat)(v,s.formatAppliers.tableBorder,r.format,s),(0,n.applyFormat)(v,s.formatAppliers.dataset,r.dataset,s)),null===(u=s.onNodeCreated)||void 0===u||u.call(s,r,v);var b=e.createElement("tbody");v.appendChild(b);for(var y=0;y<r.rows.length;y++){var S=r.rows[y];if(0!=S.cells.length){var C=s.allowCacheElement&&S.cachedElement||e.createElement("tr");b.appendChild(C),(0,i.moveChildNodes)(C),S.cachedElement||(s.allowCacheElement&&(S.cachedElement=C),(0,n.applyFormat)(C,s.formatAppliers.tableRow,S.format,s)),null===(d=s.onNodeCreated)||void 0===d||d.call(s,S,C);for(var _=0;_<S.cells.length;_++){var T=S.cells[_];if(T.isSelected){var E=s.tableSelection||{type:"table",table:v,firstColumn:_,lastColumn:_,firstRow:y,lastRow:y};E.table==v&&(E.lastColumn=Math.max(E.lastColumn,_),E.lastRow=Math.max(E.lastRow,y)),s.tableSelection=E}if(!T.spanAbove&&!T.spanLeft){var M=s.allowCacheElement&&T.cachedElement||e.createElement(T.isHeader?"th":"td");C.appendChild(M);for(var k=1,O=1,P=r.widths[_],w=S.height;null===(p=null===(f=r.rows[y+k])||void 0===f?void 0:f.cells[_])||void 0===p?void 0:p.spanAbove;k++)w+=r.rows[y+k].height;for(;null===(m=S.cells[_+O])||void 0===m?void 0:m.spanLeft;O++)P+=r.widths[_+O];k>1&&(M.rowSpan=k),O>1&&(M.colSpan=O),(!T.cachedElement||T.format.useBorderBox&&(0,o.hasMetadata)(r))&&(P>0&&!M.style.width&&(M.style.width=P+"px"),w>0&&!M.style.height&&(M.style.height=w+"px")),T.cachedElement||(s.allowCacheElement&&(T.cachedElement=M),(0,n.applyFormat)(M,s.formatAppliers.block,T.format,s),(0,n.applyFormat)(M,s.formatAppliers.tableCell,T.format,s),(0,n.applyFormat)(M,s.formatAppliers.tableCellBorder,T.format,s),(0,n.applyFormat)(M,s.formatAppliers.dataset,T.dataset,s)),s.modelHandlers.blockGroupChildren(e,M,T,s),null===(h=s.onNodeCreated)||void 0===h||h.call(s,T,M)}}}}return null===(g=s.domIndexer)||void 0===g||g.onTable(v,r),c}},6809:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleText=void 0;var n=r(3249);t.handleText=function(e,t,r,o,a){var i=e.createTextNode(r.text),l=e.createElement("span");t.appendChild(l),l.appendChild(i),o.formatAppliers.text.forEach((function(e){return e(r.format,i,o)})),(0,n.handleSegmentCommon)(e,i,l,r,o,a)}},972:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeNode=void 0;var n=r(8882),o=["SPAN","B","EM","I","U","SUB","SUP","STRIKE","S","A","CODE"];function a(e,t){var r=e.attributes,n=t.attributes;if(r.length!=n.length)return!1;for(var o=0;o<r.length;o++)if(r[o].name!=n[o].name||r[o].value!=n[o].value)return!1;return!0}t.mergeNode=function(e){for(var t=e.firstChild;t;){var r=t.nextSibling;if(r&&(0,n.isNodeOfType)(t,"ELEMENT_NODE")&&(0,n.isNodeOfType)(r,"ELEMENT_NODE")&&t.tagName==r.tagName&&o.indexOf(t.tagName)>=0&&a(t,r)){for(;r.firstChild;)t.appendChild(r.firstChild);r.parentNode.removeChild(r)}else t=r}}},8588:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.optimize=void 0;var n=r(3566),o=r(972),a=r(6507);t.optimize=function e(t){if(!(0,n.isEntityElement)(t)){(0,a.removeUnnecessarySpan)(t),(0,o.mergeNode)(t);for(var r=t.firstChild;r;r=r.nextSibling)e(r)}}},6507:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeUnnecessarySpan=void 0;var n=r(8882);t.removeUnnecessarySpan=function(e){for(var t=e.firstChild;t;)if((0,n.isNodeOfType)(t,"ELEMENT_NODE")&&"SPAN"==t.tagName&&0==t.attributes.length&&!o(t)){var r=t,a=t.nextSibling;for(t=t.nextSibling;r.lastChild;){var i=r.lastChild;e.insertBefore(i,a),a=i}e.removeChild(r)}else t=t.nextSibling};var o=function(e){return(0,n.isNodeOfType)(e.firstChild,"ELEMENT_NODE")&&"IMG"==e.firstChild.tagName&&e.firstChild==e.lastChild}},4043:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyFormat=void 0,t.applyFormat=function(e,t,r,n){t.forEach((function(t){null==t||t(r,e,n)}))}},669:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyMetadata=void 0;var n=r(8880);t.applyMetadata=function(e,t,r,o){t&&(0,n.updateMetadata)(e,(function(e){return t.applierFunction(e,r,o),e}),t.metadataDefinition)}},3249:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegmentCommon=void 0;var n=r(4043);t.handleSegmentCommon=function(e,t,r,o,a,i){var l;t.firstChild||(a.regularSelection.current.segment=t),(0,n.applyFormat)(r,a.formatAppliers.styleBasedSegment,o.format,a),null==i||i.push(t),a.modelHandlers.segmentDecorator(e,r,o,a,i),(0,n.applyFormat)(r,a.formatAppliers.elementBasedSegment,o.format,a),null===(l=a.onNodeCreated)||void 0===l||l.call(a,o,t)}},1498:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackFormat=void 0;var n=r(7582),o=r(1105);t.stackFormat=function(e,t,r){var a="string"==typeof t?o.defaultContentModelFormatMap[t]:t;if(a){var i=e.implicitFormat;try{e.implicitFormat=(0,n.__assign)((0,n.__assign)({},i),a),r()}finally{e.implicitFormat=i}}else r()}},3348:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contentModelToText=void 0;var r={onDivider:function(e){return"hr"==e.tagName?"________________________________________":""},onEntityBlock:function(){return""},onEntitySegment:function(e){var t;return null!==(t=e.wrapper.textContent)&&void 0!==t?t:""},onGeneralSegment:function(e){var t;return null!==(t=e.element.textContent)&&void 0!==t?t:""},onImage:function(){return" "},onText:function(e){return e.text},onParagraph:function(){return!0},onTable:function(){return!0},onBlockGroup:function(){return!0}};function n(e,t,r){r.onBlockGroup(e)&&e.blocks.forEach((function(e){switch(e.blockType){case"Paragraph":if(r.onParagraph(e)){var o="";e.segments.forEach((function(e){switch(e.segmentType){case"Br":t.push(o),o="";break;case"Entity":o+=r.onEntitySegment(e);break;case"General":o+=r.onGeneralSegment(e);break;case"Text":o+=r.onText(e);break;case"Image":o+=r.onImage(e)}})),o&&t.push(o)}break;case"Divider":t.push(r.onDivider(e));break;case"Entity":t.push(r.onEntityBlock(e));break;case"Table":r.onTable(e)&&e.rows.forEach((function(e){return e.cells.forEach((function(e){n(e,t,r)}))}));break;case"BlockGroup":n(e,t,r)}}))}t.contentModelToText=function(e,t,o){void 0===t&&(t="\r\n");var a=[];return n(e,a,Object.assign({},r,o)),a.join(t)}},6582:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoFormatPlugin=void 0;var n=r(8871),o=r(4744),a=r(8316),i=r(8745),l=r(918),s=r(5884),c=r(7604),u=r(3395),d=r(4422),f={autoBullet:!1,autoNumbering:!1,autoUnlink:!1,autoLink:!1,autoHyphen:!1,autoFraction:!1,autoOrdinals:!1},p=function(){function e(e){void 0===e&&(e=f),this.options=e,this.editor=null}return e.prototype.getName=function(){return"AutoFormat"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"input":this.handleEditorInputEvent(this.editor,e);break;case"keyDown":this.handleKeyDownEvent(this.editor,e);break;case"contentChanged":this.handleContentChangedEvent(this.editor,e)}},e.prototype.handleEditorInputEvent=function(e,t){var r=this,n=t.rawEvent,o=e.getDOMSelection();if("insertText"===n.inputType&&o&&"range"===o.type&&o.range.collapsed&&" "===n.data){var d={changeSource:"",apiName:""};(0,i.formatTextSegmentBeforeSelectionMarker)(e,(function(e,t,n,o,i){var f=r.options,p=f.autoBullet,g=f.autoNumbering,v=f.autoLink,b=f.autoHyphen,y=f.autoFraction,S=f.autoOrdinals,C=!1,_=!1,T=!1,E=!1,M=!1;return(p||g)&&(T=(0,l.keyboardListTrigger)(e,n,i,p,g)),v&&(_=(0,a.createLinkAfterSpace)(t,n,i)),b&&(C=(0,c.transformHyphen)(t,n,i)),y&&(E=(0,s.transformFraction)(t,n,i)),S&&(M=(0,u.transformOrdinals)(t,n,i)),d.apiName=m(T,C),d.changeSource=h(T,C,_),T||C||_||E||M}),d)}},e.prototype.handleKeyDownEvent=function(e,t){var r=t.rawEvent;r.defaultPrevented||t.handledByEditFeature||"Backspace"!==r.key||this.options.autoUnlink&&(0,d.unlink)(e,r)},e.prototype.handleContentChangedEvent=function(e,t){var r=this.options.autoLink;"Paste"==t.source&&r&&(0,o.createLink)(e)},e}();t.AutoFormatPlugin=p;var m=function(e,t){return e?"autoToggleList":t?"autoHyphen":""},h=function(e,t,r){return e||t?n.ChangeSource.AutoFormat:r?n.ChangeSource.AutoLink:""}},7604:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformHyphen=void 0;var n=r(9943);t.transformHyphen=function(e,t,r){var o=e.text.split(" ");if("--"===o[o.length-2]){var a=e.text.lastIndexOf("--");return(l=(0,n.splitTextSegment)(e,t,a,a+2)).text=l.text.replace("--","—"),r.canUndoByBackspace=!0,!0}var i=o.pop();if(i&&(null==i?void 0:i.indexOf("--"))>-1&&"--"!==i.trim()){a=e.text.indexOf(i);var l,s=(l=(0,n.splitTextSegment)(e,t,a,a+i.length-1)).text.length;if("-"!==l.text[0]&&"-"!==l.text[s-1])return l.text=l.text.replace("--","—"),r.canUndoByBackspace=!0,!0}return!1}},4744:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLink=void 0;var n=r(8871),o=r(8745);t.createLink=function(e){var t=null;(0,o.formatTextSegmentBeforeSelectionMarker)(e,(function(e,t,r){if(t.link)return!0;var a=null;return!(t.link||!(a=(0,o.matchLink)(t.text))||((0,n.addLink)(t,{format:{href:a.normalizedUrl,underline:!0},dataset:{}}),0))}),{changeSource:n.ChangeSource.AutoLink,onNodeCreated:function(e,r){t||(t=r)},getChangeData:function(){return t}})}},8316:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLinkAfterSpace=void 0;var n=r(8745),o=r(9943);t.createLinkAfterSpace=function(e,t,r){var a=e.text.split(" ").pop(),i=null==a?void 0:a.trim(),l=null;return!!(i&&a&&(l=(0,n.matchLink)(i)))&&((0,o.splitTextSegment)(e,t,e.text.length-a.trimLeft().length,e.text.trimRight().length).link={format:{href:l.normalizedUrl,underline:!0},dataset:{}},r.canUndoByBackspace=!0,!0)}},4422:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unlink=void 0;var n=r(8745);t.unlink=function(e,t){(0,n.formatTextSegmentBeforeSelectionMarker)(e,(function(e,r,n){return!!(null==r?void 0:r.link)&&(r.link=void 0,t.preventDefault(),!0)}))}},3520:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertAlphaToDecimals=void 0,t.convertAlphaToDecimals=function(e){var t=e.toUpperCase();if(t){for(var r=0,n=0;n<t.length;n++)r=26*r+(t.charCodeAt(n)-65+1);return r}}},2407:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIndex=void 0;var n=r(3520);t.getIndex=function(e){var t=e.replace(/[^a-zA-Z0-9 ]/g,""),r=parseInt(t);return isNaN(r)?(0,n.convertAlphaToDecimals)(t):r}},6659:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getListTypeStyle=void 0;var n=r(8745),o=r(5911),a=r(8871);t.getListTypeStyle=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0);var n=(0,a.getSelectedSegmentsAndParagraphs)(e,!0);if(n[0]){var d=n[0][0],f=n[0][1],p=null==f?void 0:f.segments[0];if(d&&"SelectionMarker"==d.segmentType&&p&&"Text"==p.segmentType){var m=p.text.trim(),h=c[m];if(h&&t)return{listType:"UL",styleType:h};if(r){var g=l(e,f),v=i(e,g),b=s(g),y=(0,o.getNumberingListStyle)(m,v,b);if(y)return{listType:"OL",styleType:y,index:!u(m)&&b===y&&v?v+1:void 0}}}}};var i=function(e,t){return t?(0,n.findListItemsInSameThread)(e,t).length:void 0},l=function(e,t){var r=(0,a.getOperationalBlocks)(e,["ListItem"],["TableCell"])[0],n=void 0;if(r){var o=r.parent.blocks.indexOf(t);if(o>-1)for(var i=o-1;i>-1;i--){var l=r.parent.blocks[i];if((0,a.isBlockGroupOfType)(l,"ListItem")){n=l;break}}}return n},s=function(e){var t;if(null==e?void 0:e.levels[0].dataset)return null===(t=(0,a.updateListMetadata)(e.levels[0]))||void 0===t?void 0:t.orderedStyleType},c={"*":a.BulletListType.Disc,"-":a.BulletListType.Dash,"--":a.BulletListType.Square,"->":a.BulletListType.LongArrow,"--\x3e":a.BulletListType.DoubleLongArrow,"=>":a.BulletListType.UnfilledArrow,">":a.BulletListType.ShortArrow,"—":a.BulletListType.Hyphen},u=function(e){var t=e.replace(/[^\w\s]/g,"");return/^[1aAiI]$/.test(t)}},5911:(e,t,r)=>{"use strict";var n,o,a,i,l,s;Object.defineProperty(t,"__esModule",{value:!0}),t.getNumberingListStyle=void 0;var c,u,d=r(2407),f=r(8871);!function(e){e[e.Decimal=1]="Decimal",e[e.LowerAlpha=2]="LowerAlpha",e[e.UpperAlpha=3]="UpperAlpha",e[e.LowerRoman=4]="LowerRoman",e[e.UpperRoman=5]="UpperRoman"}(c||(c={})),function(e){e[e.Dot=1]="Dot",e[e.Dash=2]="Dash",e[e.Parenthesis=3]="Parenthesis",e[e.DoubleParenthesis=4]="DoubleParenthesis"}(u||(u={}));var p={".":1,"-":2,")":3},m=[f.NumberingListType.LowerRoman,f.NumberingListType.LowerRomanDash,f.NumberingListType.LowerRomanDoubleParenthesis,f.NumberingListType.LowerRomanParenthesis],h=[f.NumberingListType.UpperRoman,f.NumberingListType.UpperRomanDash,f.NumberingListType.UpperRomanDoubleParenthesis,f.NumberingListType.UpperRomanParenthesis],g=["1","a","A","I","i"],v=["i","v","x","l","c","d","m"],b=["I","V","X","L","C","D","M"],y=((n={})[1]=function(e){return E[e]||void 0},n[2]=function(e){return T[e]||void 0},n[3]=function(e){return _[e]||void 0},n[4]=function(e){return C[e]||void 0},n[5]=function(e){return S[e]||void 0},n),S=((o={})[1]=f.NumberingListType.UpperRoman,o[2]=f.NumberingListType.UpperRomanDash,o[3]=f.NumberingListType.UpperRomanParenthesis,o[4]=f.NumberingListType.UpperRomanDoubleParenthesis,o),C=((a={})[1]=f.NumberingListType.LowerRoman,a[2]=f.NumberingListType.LowerRomanDash,a[3]=f.NumberingListType.LowerRomanParenthesis,a[4]=f.NumberingListType.LowerRomanDoubleParenthesis,a),_=((i={})[1]=f.NumberingListType.UpperAlpha,i[2]=f.NumberingListType.UpperAlphaDash,i[3]=f.NumberingListType.UpperAlphaParenthesis,i[4]=f.NumberingListType.UpperAlphaDoubleParenthesis,i),T=((l={})[1]=f.NumberingListType.LowerAlpha,l[2]=f.NumberingListType.LowerAlphaDash,l[3]=f.NumberingListType.LowerAlphaParenthesis,l[4]=f.NumberingListType.LowerAlphaDoubleParenthesis,l),E=((s={})[1]=f.NumberingListType.Decimal,s[2]=f.NumberingListType.DecimalDash,s[3]=f.NumberingListType.DecimalParenthesis,s[4]=f.NumberingListType.DecimalDoubleParenthesis,s);t.getNumberingListStyle=function(e,t,r){var n=e.trim(),o="("===n[0]&&")"===n[n.length-1],a=o?n.slice(1,-1):n.slice(0,-1),i=(0,d.getIndex)(a),l=g.indexOf(a)<0;if(!(!i||i<1||!t&&l||t&&l&&!function(e,t){return t&&e&&t+1===e}(i,t))){var s=function(e){return Number(e)||/^[A-Za-z\s]*$/.test(e)}(a)?function(e,t,r){var n=t?4:p[e[e.length-1]];if(n){var o=function(e,t){if(!isNaN(parseInt(e)))return 1;if(/[a-z]+/g.test(e)){if(4===t&&m.indexOf(t)>-1&&v.indexOf(e[0])>-1||!t&&"i"===e)return 4;if(2===t||!t&&"a"===e)return 2}else if(/[A-Z]+/g.test(e)){if(5==t&&h.indexOf(t)>-1&&b.indexOf(e[0])>-1||!t&&"I"===e)return 5;if(3==t||!t&&"A"===e)return 3}}(t?e.slice(1,-1):e.slice(0,-1),r);return o?y[o](n):void 0}}(n,o,l?r:void 0):void 0;return s}}},918:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardListTrigger=void 0;var n=r(6659),o=r(8745);t.keyboardListTrigger=function(e,t,r,o,i){void 0===o&&(o=!0),void 0===i&&(i=!0);var l=(0,n.getListTypeStyle)(e,o,i);if(l){t.segments.splice(0,1);var s=l.listType,c=l.styleType,u=l.index;return a(e,s,c,u),r.canUndoByBackspace=!0,!0}return!1};var a=function(e,t,r,n){(0,o.setListType)(e,t);var a="OL"==t;n&&n>1&&a&&(0,o.setModelListStartNumber)(e,n),(0,o.setModelListStyle)(e,a?{orderedStyleType:r}:{unorderedStyleType:r})}},5884:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformFraction=void 0;var n=r(9943),o={"1/2":"½","1/4":"¼","3/4":"¾"};t.transformFraction=function(e,t,r){var a,i=null===(a=e.text.split(" ").pop())||void 0===a?void 0:a.trim();if(i&&o[i]){var l=e.text.length-1,s=l-i.length;return(0,n.splitTextSegment)(e,t,s,l).text=o[i],r.canUndoByBackspace=!0,!0}return!1}},3395:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformOrdinals=void 0;var n=r(9943);t.transformOrdinals=function(e,t,r){var o,a=null===(o=e.text.split(" ").pop())||void 0===o?void 0:o.trim();if(a){var i=a.substring(a.length-2),l=parseInt(a);if(l&&function(e){return{1:"st",2:"nd",3:"rd"}[e]||"th"}(l)===i)return(0,n.splitTextSegment)(e,t,e.text.length-3,e.text.length-1).format.superOrSubScriptSequence="super",r.canUndoByBackspace=!0,!0}return!1}},8189:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMenuPluginBase=void 0;var r=function(){function e(e){var t=this;this.options=e,this.container=null,this.editor=null,this.isMenuShowing=!1,this.onDismiss=function(){var e,r;t.container&&t.isMenuShowing&&(null===(r=(e=t.options).dismiss)||void 0===r||r.call(e,t.container),t.isMenuShowing=!1)}}return e.prototype.getName=function(){return"ContextMenu"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e;this.onDismiss(),(null===(e=this.container)||void 0===e?void 0:e.parentNode)&&(this.container.parentNode.removeChild(this.container),this.container=null),this.editor=null},e.prototype.onPluginEvent=function(e){if("contextMenu"==e.eventType&&e.items.length>0){var t=e.rawEvent,r=e.items;this.onDismiss(),this.options.allowDefaultMenu||t.preventDefault(),this.initContainer(t.pageX,t.pageY)&&(this.options.render(this.container,r,this.onDismiss),this.isMenuShowing=!0)}},e.prototype.initContainer=function(e,t){var r,n;return!this.container&&this.editor&&(this.container=this.editor.getDocument().createElement("div"),this.container.style.position="fixed",this.container.style.width="0",this.container.style.height="0",this.editor.getDocument().body.appendChild(this.container)),null===(r=this.container)||void 0===r||r.style.setProperty("left",e+"px"),null===(n=this.container)||void 0===n||n.style.setProperty("top",t+"px"),!!this.container},e}();t.ContextMenuPluginBase=r},9251:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomReplacePlugin=void 0;var n=r(8745),o=function(){function e(e){this.customReplacements=e,this.editor=null,this.triggerKeys=[]}return e.prototype.getName=function(){return"CustomReplace"},e.prototype.initialize=function(e){this.editor=e,this.triggerKeys=this.customReplacements.map((function(e){return e.stringToReplace.slice(-1)}))},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){this.editor&&"input"===e.eventType&&this.handleEditorInputEvent(this.editor,e)},e.prototype.handleEditorInputEvent=function(e,t){var r=this,o=t.rawEvent,a=e.getDOMSelection(),i=o.data;this.customReplacements.length>0&&"insertText"===o.inputType&&a&&"range"===a.type&&a.range.collapsed&&i&&this.triggerKeys.indexOf(i)>-1&&(0,n.formatTextSegmentBeforeSelectionMarker)(e,(function(e,t,n,o,a){return!!r.customReplacements.some((function(e){var r=e.stringToReplace,o=e.replacementString;return(0,e.replacementHandler)(t,r,o,n)}))&&(a.canUndoByBackspace=!0,!0)}))},e}();t.CustomReplacePlugin=o},958:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditPlugin=void 0;var n=r(3467),o=r(6076),a=r(6414),i=function(){function e(){this.editor=null,this.disposer=null,this.shouldHandleNextInputEvent=!1,this.selectionAfterDelete=null}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){var t=this;this.editor=e,e.getEnvironment().isAndroid&&(this.disposer=this.editor.attachDomEvent({beforeinput:{beforeDispatch:function(r){return t.handleBeforeInputEvent(e,r)}}}))},e.prototype.dispose=function(){var e;this.editor=null,null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"keyDown":this.handleKeyDownEvent(this.editor,e);break;case"keyUp":this.selectionAfterDelete&&(this.editor.setDOMSelection(this.selectionAfterDelete),this.selectionAfterDelete=null)}},e.prototype.handleKeyDownEvent=function(e,t){var r=t.rawEvent;if(!r.defaultPrevented&&!t.handledByEditFeature)switch(r.key){case"Backspace":(0,n.keyboardDelete)(e,r);break;case"Delete":t.rawEvent.shiftKey||(0,n.keyboardDelete)(e,r);break;case"Tab":(0,a.keyboardTab)(e,r);break;case"Unidentified":e.getEnvironment().isAndroid&&(this.shouldHandleNextInputEvent=!0);break;default:(0,o.keyboardInput)(e,r)}},e.prototype.handleBeforeInputEvent=function(e,t){if(this.shouldHandleNextInputEvent&&t instanceof InputEvent&&!t.defaultPrevented){this.shouldHandleNextInputEvent=!1;var r=!1;switch(t.inputType){case"deleteContentBackward":r=(0,n.keyboardDelete)(e,new KeyboardEvent("keydown",{key:"Backspace",keyCode:8,which:8}));break;case"deleteContentForward":r=(0,n.keyboardDelete)(e,new KeyboardEvent("keydown",{key:"Delete",keyCode:46,which:46}))}r&&(t.preventDefault(),this.selectionAfterDelete=e.getDOMSelection())}},e}();t.EditPlugin=i},8562:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteAllSegmentBefore=void 0;var n=r(8871);t.deleteAllSegmentBefore=function(e){if("notDeleted"==e.deleteResult)for(var t=e.insertPoint,r=t.paragraph,o=t.marker,a=r.segments.indexOf(o)-1;a>=0;a--){var i=r.segments[a];i.isSelected=!0,(0,n.deleteSegment)(r,i,e.formatContext)&&(e.deleteResult="range")}}},6274:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.backwardDeleteCollapsedSelection=t.forwardDeleteCollapsedSelection=void 0;var n=r(7457),o=r(8745),a=r(8871);function i(e){return function(t){var r;if("notDeleted"==t.deleteResult){var i="forward"==e,l=t.insertPoint,s=l.paragraph,c=l.marker,u=l.path,d=l.tableContext,f=s.segments;!function(e){var t,r;if("Br"==(null===(t=e[e.length-1])||void 0===t?void 0:t.segmentType)){var n=e.filter((function(e){return"SelectionMarker"!=e.segmentType}));"Br"!=(null===(r=n[n.length-2])||void 0===r?void 0:r.segmentType)&&e.pop()}}(f);var p,m,h=f.indexOf(c)+(i?1:-1),g=f[h];if(g)(0,a.deleteSegment)(s,g,t.formatContext,e)&&(t.deleteResult="singleChar",(0,a.setParagraphNotImplicit)(s));else if(function(e,t,r,n){return!e&&1==t.length&&"SelectionMarker"==t[0].segmentType&&r.format.marginLeft&&parseInt(r.format.marginLeft)&&(0,a.getClosestAncestorBlockGroupIndex)(n,["Document","TableCell"],["ListItem"])>-1}(i,f,s,u)&&(m=function(e){var t=e[e.length-1];return"Document"==t.blockGroupType?t:null}(u)))(0,o.setModelIndentation)(m,"outdent"),t.deleteResult="range";else if(p=(0,n.getLeafSiblingBlock)(u,s,i)){var v=p.block,b=p.path,y=p.siblingSegment;"Paragraph"==v.blockType?(y?(0,a.deleteSegment)(v,y,t.formatContext,e)&&(t.deleteResult="range"):(i?t.lastParagraph=v:("Br"==(null===(r=v.segments[v.segments.length-1])||void 0===r?void 0:r.segmentType)&&v.segments.pop(),t.insertPoint={marker:c,paragraph:v,path:b,tableContext:d},t.lastParagraph=s,delete v.cachedElement),t.deleteResult="range"),t.lastTableContext=d):(0,a.deleteBlock)(b[0].blocks,v,void 0,t.formatContext,e)&&(t.deleteResult="range")}else t.deleteResult="nothingToDelete"}}}t.forwardDeleteCollapsedSelection=i("forward"),t.backwardDeleteCollapsedSelection=i("backward")},5718:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteEmptyQuote=void 0;var n=r(8871);t.deleteEmptyQuote=function(e){var t=e.deleteResult;if("nothingToDelete"==t||"notDeleted"==t||"range"==t){var r=e.insertPoint,l=e.formatContext,s=r.path,c=null==l?void 0:l.rawEvent,u=(0,n.getClosestAncestorBlockGroupIndex)(s,["FormatContainer","ListItem"],["TableCell"]),d=s[u];if(d&&"FormatContainer"===d.blockGroupType&&"blockquote"==d.tagName){var f=s[u+1],p=f.blocks.indexOf(d),m=f.blocks[p];(0,n.isBlockGroupOfType)(m,"FormatContainer")&&"blockquote"===m.tagName&&(o(m)?((0,n.unwrapBlock)(f,m),null==c||c.preventDefault(),e.deleteResult="range"):a(m)&&"Enter"===(null==c?void 0:c.key)&&(i(m,f,p),null==c||c.preventDefault(),e.deleteResult="range"))}}};var o=function(e){return 1===e.blocks.length&&"Paragraph"===e.blocks[0].blockType&&e.blocks[0].segments.every((function(e){return"SelectionMarker"===e.segmentType||"Br"===e.segmentType}))},a=function(e){var t=e.blocks.length,r=e.blocks[t-1];if(r&&"Paragraph"===r.blockType)return r.segments.every((function(e){return"SelectionMarker"===e.segmentType||"Br"===e.segmentType}))},i=function(e,t,r){var o=e.blocks.length;e.blocks.splice(o-1,1);var a=(0,n.createSelectionMarker)(),i=(0,n.createParagraph)(!1);i.segments.push(a),t.blocks.splice(r+1,0,i)}},1365:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteList=void 0;var n=r(8871);t.deleteList=function(e){if("notDeleted"==e.deleteResult){var t=e.insertPoint,r=t.paragraph,o=t.marker,a=t.path;if(r.segments[0]==o){var i=a[(0,n.getClosestAncestorBlockGroupIndex)(a,["ListItem"],["TableCell","FormatContainer"])],l=null==i?void 0:i.levels[i.levels.length-1];l&&(null==i?void 0:i.blocks[0])==r&&("block"==l.format.displayForDummyItem?i.levels.pop():l.format.displayForDummyItem="block",e.deleteResult="range")}}}},9120:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.backwardDeleteWordSelection=t.forwardDeleteWordSelection=void 0;var n,o=r(7582),a=r(8871);function i(e){return function(t){if("notDeleted"==t.deleteResult)for(var r=t.insertPoint,n=r.marker,i=r.paragraph,l=i.segments.indexOf(n),s="forward"==e,c=function(e,t,r,n){var i,l,s,c,u,d,f,p,m,h;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:i=r?1:-1,l=e.segments,s=(0,a.isWhiteSpacePreserved)(e.format.whiteSpace),c=t+i,o.label=1;case 1:if(!(c>=0&&c<l.length))return[3,12];switch((u=l[c]).segmentType){case"Text":return[3,2];case"Image":return[3,7];case"SelectionMarker":return[3,9]}return[3,10];case 2:d=r?0:u.text.length-1,o.label=3;case 3:return d>=0&&d<u.text.length?(f=u.text[d],p=(0,a.isPunctuation)(f),m=(0,a.isSpace)(f),[4,{punctuation:p,space:m,text:!p&&!m}]):[3,6];case 4:if(o.sent()){if(h=(h=u.text).substring(0,d)+h.substring(d+1),s||(h=(0,a.normalizeText)(h,r)),n.deleteResult="range",!h)return l.splice(c,1),i>0&&(c-=i),[3,6];u.text=h,i>0&&(d-=i)}o.label=5;case 5:return d+=i,[3,3];case 6:return[3,11];case 7:return[4,{punctuation:!0,space:!1,text:!1}];case 8:return o.sent()&&(l.splice(c,1),i>0&&(c-=i),n.deleteResult="range"),[3,11];case 9:return[3,11];case 10:return[2,null];case 11:return c+=i,[3,1];case 12:return[2,null]}}))}(i,l,s,t),u=c.next(),d=0;5!=d&&!u.done;){var f=u.value,p=f.punctuation,m=f.space,h=f.text;switch(d){case 0:d=m?4:p?1:2,u=c.next(!0);break;case 1:s&&m?(d=3,u=c.next(!0)):p?u=c.next(!0):d=5;break;case 2:s&&m?(d=3,u=c.next(!0)):h?u=c.next(!0):d=5;break;case 3:p||!m?d=5:u=c.next(!0);break;case 4:m?u=c.next(!0):p?(d=s?3:1,u=c.next(!0)):d=s?5:2}}}}!function(e){e[e.Start=0]="Start",e[e.Punctuation=1]="Punctuation",e[e.Text=2]="Text",e[e.NonText=3]="NonText",e[e.Space=4]="Space",e[e.End=5]="End"}(n||(n={})),t.forwardDeleteWordSelection=i("forward"),t.backwardDeleteWordSelection=i("backward")},824:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDeleteAllSegmentsBefore=t.shouldDeleteWord=t.handleKeyboardEventResult=void 0;var n=r(8871);t.handleKeyboardEventResult=function(e,t,r,o,a){switch(a.skipUndoSnapshot=!0,a.clearModelCache=!1,o){case"notDeleted":return a.clearModelCache=!0,!1;case"nothingToDelete":return r.preventDefault(),!1;case"range":case"singleChar":return r.preventDefault(),(0,n.normalizeContentModel)(t),"range"==o&&(a.skipUndoSnapshot=!1),e.triggerEvent("beforeKeyboardEditing",{rawEvent:r}),!0}},t.shouldDeleteWord=function(e,t){return t&&e.altKey&&!e.metaKey||!t&&e.ctrlKey&&!e.altKey},t.shouldDeleteAllSegmentsBefore=function(e){return e.metaKey&&!e.altKey}},1850:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleEnterOnList=void 0;var n=r(7582),o=r(8745),a=r(8871);t.handleEnterOnList=function(e){var t=e.deleteResult;if("nothingToDelete"==t||"notDeleted"==t||"range"==t){var r=e.insertPoint,s=e.formatContext,c=r.path,u=null==s?void 0:s.rawEvent,d=(0,a.getClosestAncestorBlockGroupIndex)(c,["ListItem"],["TableCell"]),f=c[d],p=c[d+1];if(f&&"ListItem"===f.blockGroupType&&p){var m=p.blocks.indexOf(f),h=p.blocks[m+1];if("range"==t&&h){(0,a.normalizeContentModel)(p);var g=p.blocks[m+1];if((0,a.isBlockGroupOfType)(g,"ListItem")&&g.levels[0]){g.levels.forEach((function(e,t){e.format.startNumberOverride=void 0,e.dataset=f.levels[t]?f.levels[t].dataset:{}}));var v=f.blocks[f.blocks.length-1],b=g.blocks[0];"Paragraph"===b.blockType&&"Paragraph"===v.blockType&&"SelectionMarker"===v.segments[v.segments.length-1].segmentType&&(v.segments.pop(),b.segments.unshift((0,a.createSelectionMarker)(r.marker.format))),e.lastParagraph=void 0}}else if("range"!==t)if(i(f))f.levels.pop();else{var y=l(e,f,p);e.formatContext&&(e.formatContext.announceData=(0,o.getListAnnounceData)((0,n.__spreadArray)([y],(0,n.__read)(c.slice(d+1)),!1)))}null==u||u.preventDefault(),e.deleteResult="range"}}};var i=function(e){return 1===e.blocks.length&&"Paragraph"===e.blocks[0].blockType&&2===e.blocks[0].segments.length&&"SelectionMarker"===e.blocks[0].segments[0].segmentType&&"Br"===e.blocks[0].segments[1].segmentType},l=function(e,t,r){var n=e.insertPoint,o=r.blocks.indexOf(t),i=c(n),l=s(t),u=(0,a.createListItem)(l,n.marker.format);return u.blocks.push(i),n.paragraph=i,e.lastParagraph=i,r.blocks.splice(o+1,0,u),u},s=function(e){return e.levels.map((function(e){return(0,a.createListLevel)(e.listType,(0,n.__assign)((0,n.__assign)({},e.format),{startNumberOverride:void 0,displayForDummyItem:void 0}),e.dataset)}))},c=function(e){var t,r=e.paragraph,o=e.marker,i=(0,a.createParagraph)(!1,r.format,r.segmentFormat),l=r.segments.indexOf(o),s=r.segments.splice(l,r.segments.length-l);return(t=i.segments).push.apply(t,(0,n.__spreadArray)([],(0,n.__read)(s),!1)),(0,a.setParagraphNotImplicit)(r),r.segments.every((function(e){return"SelectionMarker"==e.segmentType}))&&r.segments.push((0,a.createBr)(o.format)),(0,a.normalizeParagraph)(i),i}},3467:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardDelete=void 0;var n=r(8562),o=r(5718),a=r(1365),i=r(8871),l=r(824),s=r(9120),c=r(6274);t.keyboardDelete=function(e,t){var r=!1;return function(e,t){if(e){if("range"==e.type&&e.range.collapsed){var r=e.range;return!((0,i.isNodeOfType)(r.startContainer,"TEXT_NODE")&&!(0,i.isModifierKey)(t)&&(function(e,t){return"Backspace"==e.key&&t.startOffset>1}(t,r)||function(e,t){var r,n;return"Delete"==e.key&&t.startOffset<(null!==(n=null===(r=t.startContainer.nodeValue)||void 0===r?void 0:r.length)&&void 0!==n?n:0)-1}(t,r)))}return!0}return!1}(e.getDOMSelection(),t)&&e.formatContentModel((function(u,d){var f=(0,i.deleteSelection)(u,function(e,t){var r="Delete"==e.key,i=(0,l.shouldDeleteAllSegmentsBefore)(e)&&!r?n.deleteAllSegmentBefore:null,u=(0,l.shouldDeleteWord)(e,t)?r?s.forwardDeleteWordSelection:s.backwardDeleteWordSelection:null,d=r?c.forwardDeleteCollapsedSelection:c.backwardDeleteCollapsedSelection,f=r?null:o.deleteEmptyQuote;return[i,u,r?null:a.deleteList,d,f]}(t,!!e.getEnvironment().isMac),d).deleteResult;return r=(0,l.handleKeyboardEventResult)(e,u,t,f,d)}),{rawEvent:t,changeSource:i.ChangeSource.Keyboard,getChangeData:function(){return t.which},scrollCaretIntoView:!1,apiName:"Delete"==t.key?"handleDeleteKey":"handleBackspaceKey"}),r}},6076:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardInput=void 0;var n=r(5718),o=r(8871),a=r(1850);t.keyboardInput=function(e,t){var r=e.getDOMSelection();if(function(e,t){return!!e&&!((0,o.isModifierKey)(t)||"Enter"!=t.key&&"Space"!=t.key&&1!=t.key.length)&&("range"!=e.type||!e.range.collapsed||i(e,t))}(r,t))return e.takeSnapshot(),e.formatContentModel((function(e,l){var s,c=(0,o.deleteSelection)(e,function(e,t){return i(e,t)?[a.handleEnterOnList,n.deleteEmptyQuote]:[]}(r,t),l);return l.clearModelCache=!0,l.skipUndoSnapshot=!0,"range"==c.deleteResult&&(l.newPendingFormat=null===(s=c.insertPoint)||void 0===s?void 0:s.marker.format,(0,o.normalizeContentModel)(e),!0)}),{scrollCaretIntoView:!1,rawEvent:t}),!0};var i=function(e,t){return e&&"range"==e.type&&"Enter"==t.key&&!t.shiftKey}},6414:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardTab=void 0;var n=r(8871),o=r(6299),a=r(5126),i=r(1796),l=r(4605),s=r(8745);t.keyboardTab=function(e,t){var r=e.getDOMSelection();switch(null==r?void 0:r.type){case"range":return e.formatContentModel((function(e,r){return function(e,t,r){var i=(0,n.getOperationalBlocks)(e,["ListItem","TableCell"],[]),c=i.length>0?i[0].block:void 0;return i.length>1?((0,s.setModelIndentation)(e,t.shiftKey?"outdent":"indent"),t.preventDefault(),!0):(0,n.isBlockGroupOfType)(c,"TableCell")?(0,l.handleTabOnTableCell)(e,c,t):"Paragraph"===(null==c?void 0:c.blockType)?(0,a.handleTabOnParagraph)(e,c,t,r):!!(0,n.isBlockGroupOfType)(c,"ListItem")&&(0,o.handleTabOnList)(e,c,t,r)}(e,t,r)}),{apiName:"handleTabKey"}),!0;case"table":return e.formatContentModel((function(e){return(0,i.handleTabOnTable)(e,t)}),{apiName:"handleTabKey"}),!0}}},6299:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleTabOnList=void 0;var n=r(5126),o=r(8745);t.handleTabOnList=function(e,t,r,a){var i=function(e){return e.blocks.filter((function(e){return"Paragraph"==e.blockType&&e.segments.some((function(e){return e.isSelected}))}))}(t);return function(e){return"Paragraph"==e.blocks[0].blockType&&"SelectionMarker"==e.blocks[0].segments[0].segmentType}(t)||1!=i.length||"Paragraph"!==i[0].blockType?((0,o.setModelIndentation)(e,r.shiftKey?"outdent":"indent",void 0,a),r.preventDefault(),!0):(0,n.handleTabOnParagraph)(e,i[0],r,a)}},5126:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleTabOnParagraph=void 0;var n=r(8871),o=r(8745),a="    ";t.handleTabOnParagraph=function(e,t,r,i){var l=t.segments.filter((function(e){return e.isSelected})),s=1===l.length&&"SelectionMarker"===l[0].segmentType,c=t.segments.every((function(e){return e.isSelected}));if("SelectionMarker"===t.segments[0].segmentType&&s||c){var u=t.format,d=u.marginLeft,f=u.marginRight,p="rtl"===u.direction;if(r.shiftKey&&(!p&&(!d||"0px"==d)||p&&(!f||"0px"==f)))return!1;(0,o.setModelIndentation)(e,r.shiftKey?"outdent":"indent",void 0,i)}else if(s){var m=t.segments.findIndex((function(e){return"SelectionMarker"===e.segmentType}));if(r.shiftKey){if("Text"==(v=t.segments[m-1]).segmentType){var h=v.text.length-4;if(v.text===a)t.segments.splice(m-1,1);else{if(v.text.substring(h)!==a)return!1;v.text=v.text.substring(0,h)}}}else{var g=t.segments[m].format,v=(0,n.createText)(a,g);t.segments.splice(m,0,v)}}else{var b=void 0,y=void 0;if(t.segments.forEach((function(e,t){e.isSelected&&(b||(b=t),y=t)})),!b||!y)return!1;var S=t.segments[b],C=(0,n.createText)(r.shiftKey?a:" ",S.format),_=(0,n.createSelectionMarker)(S.format);t.segments.splice(b,y-b+1,C,_)}return r.preventDefault(),!0}},1796:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleTabOnTable=void 0;var n=r(8871),o=r(8745);t.handleTabOnTable=function(e,t){var r=(0,n.getFirstSelectedTable)(e)[0];return!(!r||!function(e){var t,r,n,o;return(null===(r=null===(t=e.rows[0])||void 0===t?void 0:t.cells[0])||void 0===r?void 0:r.isSelected)&&(null===(o=null===(n=e.rows[e.rows.length-1])||void 0===n?void 0:n.cells[e.widths.length-1])||void 0===o?void 0:o.isSelected)}(r)||((0,o.setModelIndentation)(e,t.shiftKey?"outdent":"indent"),t.preventDefault(),0))}},4605:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleTabOnTableCell=void 0;var n=r(8745),o=r(8871);t.handleTabOnTableCell=function(e,t,r){var a,i,l,s=(0,o.getFirstSelectedTable)(e)[0];if(!r.shiftKey&&s&&(null===(a=s.rows[s.rows.length-1])||void 0===a?void 0:a.cells[s.widths.length-1])===t){(0,n.insertTableRow)(s,"insertBelow"),(0,n.clearSelectedCells)(s,{firstRow:s.rows.length-1,firstColumn:0,lastRow:s.rows.length-1,lastColumn:s.widths.length-1}),(0,o.normalizeTable)(s,e.format);var c=null===(l=null===(i=s.rows[s.rows.length-1])||void 0===i?void 0:i.cells[0])||void 0===l?void 0:l.blocks[0];if("Paragraph"==c.blockType){var u=(0,o.createSelectionMarker)(e.format);c.segments.unshift(u),(0,o.setParagraphNotImplicit)(c),(0,o.setSelection)(s.rows[s.rows.length-1].cells[0],u)}return r.preventDefault(),!0}return!1}},7457:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLeafSiblingBlock=void 0;var n=r(7582),o=r(8871);t.getLeafSiblingBlock=function(e,t,r){for(var a,i=(0,n.__spreadArray)([],(0,n.__read)(e),!1),l=function(){var e=i[0],n=e.blocks.indexOf(t);if(n<0)return"break";var l=e.blocks[n+(r?1:-1)];if(l){for(;"BlockGroup"==l.blockType;){var s=l.blocks[r?0:l.blocks.length-1];if(!s)return{value:{block:l,path:i}};if("BlockGroup"!=s.blockType)return i.unshift(l),{value:{block:s,path:i}};i.unshift(l),l=s}return{value:{block:l,path:i}}}if((0,o.isGeneralSegment)(e)){i.shift();var c=-1,u=e,d=null===(a=i[0])||void 0===a?void 0:a.blocks.find((function(e){return"Paragraph"==e.blockType&&(c=e.segments.indexOf(u))>=0}));if(!d)return"break";var f=d.segments[c+(r?1:-1)];if(f)return{value:{block:d,path:i,siblingSegment:f}};t=d}else{if("Document"==e.blockGroupType||"TableCell"==e.blockGroupType)return"break";i.shift(),t=e}};i.length>0;){var s=l();if("object"==typeof s)return s.value;if("break"===s)break}return null}},8863:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HyperlinkPlugin=void 0;var n=r(8745),o=function(e){return e},a=function(){function e(e,t,r){var n=this;void 0===e&&(e=o),this.tooltip=e,this.target=t,this.onLinkClick=r,this.editor=null,this.domHelper=null,this.isMac=!1,this.disposer=null,this.currentNode=null,this.currentLink=null,this.onMouse=function(e){n.runWithHyperlink(e.target,(function(t,r){var o,a="mouseover"==e.type?"function"==typeof n.tooltip?n.tooltip(t,r):n.tooltip:null;null===(o=n.domHelper)||void 0===o||o.setDomAttribute("title",a)}))}}return e.prototype.getName=function(){return"Hyperlink"},e.prototype.initialize=function(e){this.editor=e,this.domHelper=e.getDOMHelper(),this.isMac=!!e.getEnvironment().isMac,this.disposer=e.attachDomEvent({mouseover:{beforeDispatch:this.onMouse},mouseout:{beforeDispatch:this.onMouse}})},e.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.currentNode=null,this.currentLink=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t,r,o,a,i=this;if("keyDown"==e.eventType){var l="range"==(null==(s=null===(t=this.editor)||void 0===t?void 0:t.getDOMSelection())?void 0:s.type)?s.range.commonAncestorContainer:null;l&&l!=this.currentNode&&(this.currentNode=l,this.currentLink=null,this.runWithHyperlink(l,(function(e,t){l.textContent&&(a=(0,n.matchLink)(l.textContent))&&a.normalizedUrl==e&&(i.currentLink=t)})))}else if("keyUp"==e.eventType){var s,c="range"==(null==(s=null===(r=this.editor)||void 0===r?void 0:r.getDOMSelection())?void 0:s.type)?s.range.commonAncestorContainer:null;c&&c==this.currentNode&&this.currentLink&&this.currentLink.contains(c)&&c.textContent&&(a=(0,n.matchLink)(c.textContent))&&this.currentLink.setAttribute("href",a.normalizedUrl)}else"mouseUp"==e.eventType&&e.isClicking?this.runWithHyperlink(e.rawEvent.target,(function(t,r){var n,o;if(!(null===(n=i.onLinkClick)||void 0===n?void 0:n.call(i,r,e.rawEvent))&&i.isCtrlOrMetaPressed(e.rawEvent)&&0===e.rawEvent.button){e.rawEvent.preventDefault();var a=i.target||"_blank",l=null===(o=i.editor)||void 0===o?void 0:o.getDocument().defaultView;try{null==l||l.open(t,a)}catch(e){}}})):"contentChanged"==e.eventType&&(null===(o=this.domHelper)||void 0===o||o.setDomAttribute("title",null))},e.prototype.runWithHyperlink=function(e,t){var r,n=null===(r=this.domHelper)||void 0===r?void 0:r.findClosestElementAncestor(e,"a[href]"),o=null==n?void 0:n.getAttribute("href");o&&n&&t(o,n)},e.prototype.isCtrlOrMetaPressed=function(e){return this.isMac?e.metaKey:e.ctrlKey},e}();t.HyperlinkPlugin=a},1297:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDOMInsertPointRect=t.CustomReplacePlugin=t.PickerPlugin=t.HyperlinkPlugin=t.MarkdownPlugin=t.WatermarkPlugin=t.ContextMenuPluginBase=t.ShortcutPlugin=t.ShortcutOutdentList=t.ShortcutIndentList=t.ShortcutDecreaseFont=t.ShortcutIncreaseFont=t.ShortcutNumbering=t.ShortcutBullet=t.ShortcutRedoMacOS=t.ShortcutRedoAlt=t.ShortcutRedo=t.ShortcutUndo2=t.ShortcutUndo=t.ShortcutClearFormat=t.ShortcutUnderline=t.ShortcutItalic=t.ShortcutBold=t.AutoFormatPlugin=t.EditPlugin=t.PastePlugin=t.TableEditPlugin=void 0;var n=r(7237);Object.defineProperty(t,"TableEditPlugin",{enumerable:!0,get:function(){return n.TableEditPlugin}});var o=r(2502);Object.defineProperty(t,"PastePlugin",{enumerable:!0,get:function(){return o.PastePlugin}});var a=r(958);Object.defineProperty(t,"EditPlugin",{enumerable:!0,get:function(){return a.EditPlugin}});var i=r(6582);Object.defineProperty(t,"AutoFormatPlugin",{enumerable:!0,get:function(){return i.AutoFormatPlugin}});var l=r(312);Object.defineProperty(t,"ShortcutBold",{enumerable:!0,get:function(){return l.ShortcutBold}}),Object.defineProperty(t,"ShortcutItalic",{enumerable:!0,get:function(){return l.ShortcutItalic}}),Object.defineProperty(t,"ShortcutUnderline",{enumerable:!0,get:function(){return l.ShortcutUnderline}}),Object.defineProperty(t,"ShortcutClearFormat",{enumerable:!0,get:function(){return l.ShortcutClearFormat}}),Object.defineProperty(t,"ShortcutUndo",{enumerable:!0,get:function(){return l.ShortcutUndo}}),Object.defineProperty(t,"ShortcutUndo2",{enumerable:!0,get:function(){return l.ShortcutUndo2}}),Object.defineProperty(t,"ShortcutRedo",{enumerable:!0,get:function(){return l.ShortcutRedo}}),Object.defineProperty(t,"ShortcutRedoAlt",{enumerable:!0,get:function(){return l.ShortcutRedoAlt}}),Object.defineProperty(t,"ShortcutRedoMacOS",{enumerable:!0,get:function(){return l.ShortcutRedoMacOS}}),Object.defineProperty(t,"ShortcutBullet",{enumerable:!0,get:function(){return l.ShortcutBullet}}),Object.defineProperty(t,"ShortcutNumbering",{enumerable:!0,get:function(){return l.ShortcutNumbering}}),Object.defineProperty(t,"ShortcutIncreaseFont",{enumerable:!0,get:function(){return l.ShortcutIncreaseFont}}),Object.defineProperty(t,"ShortcutDecreaseFont",{enumerable:!0,get:function(){return l.ShortcutDecreaseFont}}),Object.defineProperty(t,"ShortcutIndentList",{enumerable:!0,get:function(){return l.ShortcutIndentList}}),Object.defineProperty(t,"ShortcutOutdentList",{enumerable:!0,get:function(){return l.ShortcutOutdentList}});var s=r(7049);Object.defineProperty(t,"ShortcutPlugin",{enumerable:!0,get:function(){return s.ShortcutPlugin}});var c=r(8189);Object.defineProperty(t,"ContextMenuPluginBase",{enumerable:!0,get:function(){return c.ContextMenuPluginBase}});var u=r(8185);Object.defineProperty(t,"WatermarkPlugin",{enumerable:!0,get:function(){return u.WatermarkPlugin}});var d=r(7790);Object.defineProperty(t,"MarkdownPlugin",{enumerable:!0,get:function(){return d.MarkdownPlugin}});var f=r(8863);Object.defineProperty(t,"HyperlinkPlugin",{enumerable:!0,get:function(){return f.HyperlinkPlugin}});var p=r(3111);Object.defineProperty(t,"PickerPlugin",{enumerable:!0,get:function(){return p.PickerPlugin}});var m=r(9251);Object.defineProperty(t,"CustomReplacePlugin",{enumerable:!0,get:function(){return m.CustomReplacePlugin}});var h=r(1136);Object.defineProperty(t,"getDOMInsertPointRect",{enumerable:!0,get:function(){return h.getDOMInsertPointRect}})},7790:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarkdownPlugin=void 0;var n=r(2588),o={strikethrough:!1,bold:!1,italic:!1},a=function(){function e(e){void 0===e&&(e=o),this.options=e,this.editor=null,this.shouldBold=!1,this.shouldItalic=!1,this.shouldStrikethrough=!1,this.shouldCode=!1,this.lastKeyTyped=null}return e.prototype.getName=function(){return"Markdown"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.disableAllFeatures(),this.lastKeyTyped=null},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"input":this.handleEditorInputEvent(this.editor,e);break;case"keyDown":this.handleBackspaceEvent(e),this.handleKeyDownEvent(e);break;case"contentChanged":this.handleContentChangedEvent(e)}},e.prototype.handleEditorInputEvent=function(e,t){var r=t.rawEvent,o=e.getDOMSelection();if(o&&"range"==o.type&&o.range.collapsed&&"insertText"==r.inputType)switch(r.data){case"*":this.options.bold&&(this.shouldBold?((0,n.setFormat)(e,"*",{fontWeight:"bold"}),this.shouldBold=!1):this.shouldBold=!0);break;case"~":this.options.strikethrough&&(this.shouldStrikethrough?((0,n.setFormat)(e,"~",{strikethrough:!0}),this.shouldStrikethrough=!1):this.shouldStrikethrough=!0);break;case"_":this.options.italic&&(this.shouldItalic?((0,n.setFormat)(e,"_",{italic:!0}),this.shouldItalic=!1):this.shouldItalic=!0);break;case"`":this.options.codeFormat&&(this.shouldCode?((0,n.setFormat)(e,"`",{},this.options.codeFormat),this.shouldCode=!1):this.shouldCode=!0)}},e.prototype.handleKeyDownEvent=function(e){var t=e.rawEvent;if(!e.handledByEditFeature&&!t.defaultPrevented)switch(t.key){case"Enter":this.disableAllFeatures(),this.lastKeyTyped=null;break;case" ":"*"===this.lastKeyTyped&&this.shouldBold?this.shouldBold=!1:"~"===this.lastKeyTyped&&this.shouldStrikethrough?this.shouldStrikethrough=!1:"_"===this.lastKeyTyped&&this.shouldItalic?this.shouldItalic=!1:"`"===this.lastKeyTyped&&this.shouldCode&&(this.shouldCode=!1),this.lastKeyTyped=null;break;default:this.lastKeyTyped=t.key}},e.prototype.handleBackspaceEvent=function(e){e.handledByEditFeature||"Backspace"!==e.rawEvent.key||("*"===this.lastKeyTyped&&this.shouldBold?this.shouldBold=!1:"~"===this.lastKeyTyped&&this.shouldStrikethrough?this.shouldStrikethrough=!1:"_"===this.lastKeyTyped&&this.shouldItalic?this.shouldItalic=!1:"`"===this.lastKeyTyped&&this.shouldCode&&(this.shouldCode=!1),this.lastKeyTyped=null)},e.prototype.handleContentChangedEvent=function(e){"Format"==e.source&&this.disableAllFeatures()},e.prototype.disableAllFeatures=function(){this.shouldBold=!1,this.shouldItalic=!1,this.shouldStrikethrough=!1,this.shouldCode=!1},e}();t.MarkdownPlugin=a},2588:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFormat=void 0;var n=r(7582),o=r(8745),a=r(9943);t.setFormat=function(e,t,r,i){(0,o.formatTextSegmentBeforeSelectionMarker)(e,(function(e,o,l,s,c){if(o.text[o.text.length-1]==t){var u=o.text.slice(0,-1);if(c.newPendingFormat=(0,n.__assign)((0,n.__assign)({},s),{strikethrough:!!s.strikethrough,italic:!!s.italic,fontWeight:(null==s?void 0:s.fontWeight)?"bold":void 0}),u.indexOf(t)>-1){var d=o.text.length,f=o.text.substring(0,d-1).lastIndexOf(t);if(d-f>2){var p=(0,a.splitTextSegment)(o,l,f,d);return p.text=p.text.replace(t,"").slice(0,-1),p.format=(0,n.__assign)((0,n.__assign)({},p.format),r),i&&(p.code={format:i}),c.canUndoByBackspace=!0,!0}}}return!1}))}},3342:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.excelHandler=t.childProcessor=t.processPastedContentFromExcel=void 0;var n=r(7582),o=r(3521),a=r(8871),i=r(3315),l=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,s=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,c=/<tr[^>]*>[^<]*/i,u=/<table[^>]*>[^<]*/i,d="solid 1px #d4d4d4";function f(e,t){if(e.match(l)){var r=t.match(c);e=(r?r[0]:"<TR>")+e+"</TR>"}if(e.match(s)){var n=t.match(u);e=(n?n[0]:"<TABLE>")+e+"</TABLE>"}return e}t.processPastedContentFromExcel=function(e,r,n){var l=e.fragment,s=e.htmlBefore,c=e.clipboardData,u=c.html?f(c.html,s):void 0;if(u&&c.html!=u){var p=(new DOMParser).parseFromString(r(u),"text/html");(0,a.moveChildNodes)(l,null==p?void 0:p.body)}var m=l.firstChild;(0,a.isNodeOfType)(m,"ELEMENT_NODE")&&"div"==m.tagName&&m.firstChild&&Array.from(m.childNodes).every((function(e){var t=(0,a.isNodeOfType)(e,"ELEMENT_NODE")&&e.tagName;return"META"==t||"TABLE"==t&&e==m.lastChild}))&&m.lastChild&&e.fragment.replaceChildren(m.lastChild),(0,o.addParser)(e.domToModelOption,"tableCell",(function(e,t){n||"none"!==t.style.borderStyle||(e.borderBottom=d,e.borderLeft=d,e.borderRight=d,e.borderTop=d)})),(0,i.setProcessor)(e.domToModelOption,"child",t.childProcessor)},t.childProcessor=function(e,t,r){var o=(0,n.__assign)({},r.segmentFormat);"TableCell"===e.blockGroupType&&e.format.textColor&&!r.segmentFormat.textColor&&(r.segmentFormat.textColor=e.format.textColor),r.defaultElementProcessors.child(e,t,r),"TableCell"===e.blockGroupType&&e.format.textColor&&(r.segmentFormat=o,delete e.format.textColor)},t.excelHandler=f},2502:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PastePlugin=void 0;var n=r(3521),o=r(8871),a=r(1920),i=r(5247),l=r(4382),s=r(1738),c=r(3342),u=r(6635),d=r(5934),f=r(2843),p=function(){function e(e){this.allowExcelNoBorderTable=e,this.editor=null}return e.prototype.getName=function(){return"Paste"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor&&"beforePaste"==e.eventType&&e.domToModelOption){var t=(0,i.getPasteSource)(e,!1),r=e.pasteType;switch(t){case"wordDesktop":(0,d.processPastedContentFromWordDesktop)(e,this.editor.getTrustedHTMLHandler());break;case"wacComponents":(0,f.processPastedContentWacComponents)(e);break;case"excelOnline":case"excelDesktop":"normal"!==r&&"mergeFormat"!==r||(0,c.processPastedContentFromExcel)(e,this.editor.getTrustedHTMLHandler(),this.allowExcelNoBorderTable);break;case"googleSheets":e.domToModelOption.additionalAllowedTags.push(s.PastePropertyNames.GOOGLE_SHEET_NODE_NAME);break;case"powerPointDesktop":(0,u.processPastedContentFromPowerPoint)(e,this.editor.getTrustedHTMLHandler())}(0,n.addParser)(e.domToModelOption,"link",l.parseLink),(0,n.addParser)(e.domToModelOption,"tableCell",a.deprecatedBorderColorParser),(0,n.addParser)(e.domToModelOption,"tableCell",g),(0,n.addParser)(e.domToModelOption,"table",a.deprecatedBorderColorParser),"mergeFormat"===r&&((0,n.addParser)(e.domToModelOption,"block",m),(0,n.addParser)(e.domToModelOption,"listLevel",m))}},e}();t.PastePlugin=p;var m=function(e,t){t.style.backgroundColor&&delete e.backgroundColor},h=new Map([["borderTop",{w:"borderTopWidth",s:"borderTopStyle",c:"borderTopColor"}],["borderRight",{w:"borderRightWidth",s:"borderRightStyle",c:"borderRightColor"}],["borderBottom",{w:"borderBottomWidth",s:"borderBottomStyle",c:"borderBottomColor"}],["borderLeft",{w:"borderLeftWidth",s:"borderLeftStyle",c:"borderLeftColor"}]]);function g(e,t){o.BorderKeys.forEach((function(r){if(!e[r]){var n=h.get(r);n&&t.style[n.w]&&t.style[n.s]&&!t.style[n.c]&&(e[r]=t.style[n.w]+" "+t.style[n.s])}}))}},6635:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processPastedContentFromPowerPoint=void 0;var n=r(8871);t.processPastedContentFromPowerPoint=function(e,t){var r=e.fragment,o=e.clipboardData;if(o.html&&!o.text&&o.image){var a=(new DOMParser).parseFromString(t(o.html),"text/html");(0,n.moveChildNodes)(r,null==a?void 0:a.body)}}},7341:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WAC_IDENTIFY_SELECTOR=t.TEMP_ELEMENTS_CLASSES=t.COMMENT_HIGHLIGHT_CLICKED_CLASS=t.COMMENT_HIGHLIGHT_CLASS=t.LIST_CONTAINER_ELEMENT_CLASS_NAME=t.PARAGRAPH=t.OUTLINE_ELEMENT=t.IMAGE_CONTAINER=t.IMAGE_BORDER=t.NUMBER_LIST_STYLE=t.BULLET_LIST_STYLE=t.WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES=void 0;var n=r(7582);t.WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES=["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle"],t.BULLET_LIST_STYLE="BulletListStyle",t.NUMBER_LIST_STYLE="NumberListStyle",t.IMAGE_BORDER="WACImageBorder",t.IMAGE_CONTAINER="WACImageContainer",t.OUTLINE_ELEMENT="OutlineElement",t.PARAGRAPH="Paragraph",t.LIST_CONTAINER_ELEMENT_CLASS_NAME="ListContainerWrapper",t.COMMENT_HIGHLIGHT_CLASS="CommentHighlightRest",t.COMMENT_HIGHLIGHT_CLICKED_CLASS="CommentHighlightClicked",t.TEMP_ELEMENTS_CLASSES=(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(t.WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES),!1),["ListMarkerWrappingSpan"],!1),t.WAC_IDENTIFY_SELECTOR='ul[class^="'+t.BULLET_LIST_STYLE+'"]>.'+t.OUTLINE_ELEMENT+',ol[class^="'+t.NUMBER_LIST_STYLE+'"]>.'+t.OUTLINE_ELEMENT+",span."+t.IMAGE_CONTAINER+",span."+t.IMAGE_BORDER+",."+t.COMMENT_HIGHLIGHT_CLASS+",."+t.COMMENT_HIGHLIGHT_CLICKED_CLASS+","+t.WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES.map((function(e){return'table div[class^="'+e+'"]'})).join(",")},2843:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processPastedContentWacComponents=void 0;var n=r(7582),o=r(3521),a=r(8871),i=r(3315),l=r(7341),s=["UL","OL","LI"],c=s.join(","),u=function(e,t){var r=t.style.verticalAlign;"super"===r&&(e.superOrSubScriptSequence="super"),"sub"===r&&(e.superOrSubScriptSequence="sub")},d=function(e,t,r){var n=t.tagName;if(t.matches(l.WAC_IDENTIFY_SELECTOR)&&(t.style.removeProperty("display"),t.style.removeProperty("margin")),t.classList.contains(l.LIST_CONTAINER_ELEMENT_CLASS_NAME))r.elementProcessors.child(e,t,r);else if(!l.TEMP_ELEMENTS_CLASSES.some((function(e){return t.classList.contains(e)}))){if(function(e,t,r){return r.listFormat.levels.length>0&&s.every((function(t){return t!=e}))&&!t.closest(c)}(n,t,r)){var o=r.listFormat;o.levels=[],o.listParent=void 0}r.defaultElementProcessors.element(e,t,r)}},f=function(e,t,r){var o,i,l,s,c,u=parseInt(null!==(o=t.getAttribute("data-aria-level"))&&void 0!==o?o:""),d=r.listFormat,f=(null===(i=d.levels[r.listFormat.levels.length-1])||void 0===i?void 0:i.listType)||(null===(l=t.closest("ol,ul"))||void 0===l?void 0:l.tagName.toUpperCase()),p=(0,a.createListLevel)(f,r.blockFormat);if((0,a.parseFormat)(t,r.formatParsers.listLevelThread,p.format,r),(0,a.parseFormat)(t,r.formatParsers.listLevel,p.format,r),r.listFormat.levels=d.currentListLevels||r.listFormat.levels,u>0)if(u>r.listFormat.levels.length)for(;u!=r.listFormat.levels.length;)r.listFormat.levels.push(p);else r.listFormat.levels.splice(u,r.listFormat.levels.length-1),r.listFormat.levels[u-1]=p;null===(c=(s=r.defaultElementProcessors).li)||void 0===c||c.call(s,e,t,r);var m=d.listParent;if(m){var h=m.blocks[m.blocks.length-1];"BlockGroup"==h.blockType&&"ListItem"==h.blockGroupType&&function(e,t,r){if(e&&"UL"!=e.listType){var o=t.closest("ol"),a=r.listFormat,i=(0,n.__read)(function(e,t){var r=t&&Array.from((null==e?void 0:e.querySelectorAll("li"))||[]).indexOf(t);return[parseInt((null==e?void 0:e.getAttribute("start"))||"1")+(r&&r>0?r:0),parseInt((null==t?void 0:t.getAttribute("data-aria-level"))||"")]}(o,t),2),l=i[0],s=i[1];a.listItemThread||(a.listItemThread=[]);var c=a.listItemThread[s];c&&l-c!=1&&(e.format.startNumberOverride=l),a.listItemThread[s]=l}}(h.levels[h.levels.length-1],t,r)}var g=[];d.levels.forEach((function(e){var t={dataset:(0,n.__assign)({},e.dataset),format:(0,n.__assign)({},e.format),listType:e.listType};g.push(t)})),d.currentListLevels=g,d.levels=[]},p=function(e,t){"block"===t.style.display&&(e.displayForDummyItem=void 0),e.marginLeft=void 0},m=function(e){e.marginLeft=void 0,e.paddingLeft=void 0},h=function(e,t){(t.className.includes(l.COMMENT_HIGHLIGHT_CLASS)||t.className.includes(l.COMMENT_HIGHLIGHT_CLICKED_CLASS))&&delete e.backgroundColor};t.processPastedContentWacComponents=function(e){(0,o.addParser)(e.domToModelOption,"segment",u),(0,o.addParser)(e.domToModelOption,"listItemThread",p),(0,o.addParser)(e.domToModelOption,"listLevel",m),(0,o.addParser)(e.domToModelOption,"container",g),(0,o.addParser)(e.domToModelOption,"table",g),(0,o.addParser)(e.domToModelOption,"segment",h),(0,i.setProcessor)(e.domToModelOption,"element",d),(0,i.setProcessor)(e.domToModelOption,"li",f)};var g=function(e,t){t.style.marginLeft.startsWith("-")&&delete e.marginLeft}},6559:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStyleMetadata=void 0;var n=r(7582),o=r(8871),a=/[\n\t'{}"]+/g;t.getStyleMetadata=function(e,t){var r=new Map;return(new DOMParser).parseFromString(t(e.htmlBefore),"text/html").querySelectorAll("style").forEach((function(e){for(var t=(null==e?void 0:e.innerHTML.trim())||"",i=0,l=function(){var e=t.indexOf("@",i+1),l=t.indexOf("}",e),s=t.indexOf("{",e);i=e;var c=t.substring(e+1,s).replace(a,"").replace("list","").trimRight().trimLeft(),u=t.substring(s,l+1).trimLeft().trimRight(),d={};u.split(";").forEach((function(e){var t=(0,n.__read)(e.split(":"),2),r=t[0],o=t[1];if(r&&o){var i=r.replace(a,"").trimRight().trimLeft(),l=o.replace(a,"").trimRight().trimLeft();d[i]=l}}));var f={"mso-level-number-format":d["mso-level-number-format"],"mso-level-start-at":d["mso-level-start-at"]||"1","mso-level-text":d["mso-level-text"]};(0,o.getObjectKeys)(f).some((function(e){return!!f[e]}))&&r.set(c,f)};i>=0;)l()})),r}},5934:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processPastedContentFromWordDesktop=void 0;var n=r(3521),o=r(6559),a=r(4103),i=r(1671),l=r(5776),s=r(1615),c=r(3315);t.processPastedContentFromWordDesktop=function(e,t){var r=(0,o.getStyleMetadata)(e,t);(0,c.setProcessor)(e.domToModelOption,"element",u(r)),(0,n.addParser)(e.domToModelOption,"block",s.removeNegativeTextIndentParser),(0,n.addParser)(e.domToModelOption,"listLevel",d),(0,n.addParser)(e.domToModelOption,"container",f),(0,n.addParser)(e.domToModelOption,"table",f)};var u=function(e){return function(t,r,n){var o=(0,a.getStyles)(r);(0,l.processWordList)(o,t,r,n,e)||(0,i.processWordComments)(o,r)||n.defaultElementProcessors.element(t,r,n)}};function d(e,t,r,n){""!=t.style.marginLeft&&(e.marginLeft=n.marginLeft),e.marginBottom=void 0}var f=function(e){var t;(null===(t=e.marginLeft)||void 0===t?void 0:t.startsWith("-"))&&delete e.marginLeft}},1671:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processWordComments=void 0;var n=r(8871),o=/#_msocom_/;t.processWordComments=function(e,t){return"comment"==e["mso-special-character"]||(0,n.isElementOfType)(t,"a")&&o.test(t.href)||"comment-list"==e["mso-element"]}},5776:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processWordList=void 0;var n=r(7582),o=r(1615),a=r(8871),i=/%[0-9a-zA-Z]+/g;function l(e,t){t.style.marginLeft&&"0in"!=t.style.marginLeft&&(e.paddingLeft="0px"),t.style.marginRight&&"0in"!=t.style.marginRight&&(e.paddingRight="0px")}t.processWordList=function(e,t,r,s,c){var u,d=s.listFormat;d.wordKnownLevels||(d.wordKnownLevels=new Map);var f=e["mso-list"]||"";if("ignore"===f.toLowerCase())return!0;var p=(0,n.__read)(f.split(" "),2),m=p[0],h=p[1];if(d.wordLevel=h&&parseInt(h.substr(5)),d.wordList=m||"l0",0==d.levels.length&&(d.levels=d.wordList&&d.wordKnownLevels.get(d.wordList)||[]),f&&t&&"number"==typeof d.wordLevel){var g=d.wordLevel,v=d.wordList,b=c.get(m+":"+h),y="bullet"!=(null===(u=null==b?void 0:b["mso-level-number-format"])||void 0===u?void 0:u.toLowerCase())?"OL":"UL",S=(0,a.createListLevel)(y);if((0,a.parseFormat)(r,(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(s.formatParsers.listLevel),!1),[l],!1),S.format,s),g>d.levels.length)for(;g!=d.levels.length;)d.levels.push(S);else d.levels.splice(g,d.levels.length-1),d.levels[g-1]=S;return d.levels[d.levels.length-1].format.wordList=v,d.listParent=t,function(e,t,r,n,l){var s=e.levels[e.levels.length-1].listType,c=function(e,t){var r,n=(null==e?void 0:e["mso-level-number-format"])||"decimal";if(null==e?void 0:e["mso-level-text"]){var o="";switch(n){case"alpha-upper":o="UpperAlpha";break;case"alpha-lower":o="LowerAlpha";break;case"roman-lower":o="LowerRoman";break;case"roman-upper":o="UpperRoman";break;default:o="Number"}r='"'+(e["mso-level-text"]||"").replace("\\","").replace('"',"").replace(i,"${"+o+"}")+' "'}else switch(n){case"alpha-lower":r="lower-alpha";break;case"roman-lower":r="lower-roman";break;case"roman-upper":r="upper-roman";break;default:r="decimal"}return(0,a.getListStyleTypeFromString)(t,r)}(l,s);c&&(0,a.updateListMetadata)(e.levels[e.levels.length-1],(function(e){return Object.assign({},e,{unorderedStyleType:"UL"==s?c:void 0,orderedStyleType:"OL"==s?c:void 0})}));var u=(0,a.createListItem)(e.levels,t.segmentFormat);(0,a.parseFormat)(r,t.formatParsers.segmentOnBlock,t.segmentFormat,t),(0,a.parseFormat)(r,t.formatParsers.listItemElement,u.format,t),(0,a.parseFormat)(r,[o.removeNegativeTextIndentParser],u.format,t),"OL"==s&&function(e,t,r){var n,o,i=t.listFormat,l=i.listParent,s=i.wordList,c=i.wordKnownLevels,u=i.wordLevel,d=i.levels,f=function(e){for(var t=((null==e?void 0:e.blocks.length)||0)-1;t>0;t--){var r=null==e?void 0:e.blocks[t];if(r&&!(0,a.isEmpty)(r))return r}}(l);if(("BlockGroup"!=(null==f?void 0:f.blockType)||"ListItem"!=f.blockGroupType||u&&(null===(o=null===(n=f.levels[u])||void 0===n?void 0:n.format)||void 0===o?void 0:o.wordList)!=s)&&s){var p=(null==r?void 0:r["mso-level-start-at"])?parseInt(r["mso-level-start-at"]):NaN,m=(null==c?void 0:c.get(s))||[];null==p||isNaN(p)||m.length==d.length||(e.levels[e.levels.length-1].format.startNumberOverride=p)}}(u,t,l),t.elementProcessors.child(u,r,t),(0,a.addBlock)(n,u)}(d,s,r,t,b),d.levels.length>0&&d.wordKnownLevels.get(v)!=d.levels&&d.wordKnownLevels.set(v,(0,n.__spreadArray)([],(0,n.__read)(d.levels),!1)),!0}return!1}},1615:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeNegativeTextIndentParser=void 0,t.removeNegativeTextIndentParser=function(e,t){var r;(null===(r=e.textIndent)||void 0===r?void 0:r.startsWith("-"))&&delete e.textIndent}},1738:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PastePropertyNames=void 0,t.PastePropertyNames={GOOGLE_SHEET_NODE_NAME:"google-sheets-html-origin",PROG_ID_NAME:"ProgId",EXCEL_DESKTOP_ATTRIBUTE_NAME:"xmlns:x"}},60:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.documentContainWacElements=void 0;var n=r(7341);t.documentContainWacElements=function(e){return!!e.fragment.querySelector(n.WAC_IDENTIFY_SELECTOR)}},5247:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPasteSource=void 0;var n=r(60),o=r(524),a=r(2816),i=r(377),l=r(2929),s=r(4936),c=r(3048),u=new Map([["wordDesktop",s.isWordDesktopDocument],["excelDesktop",o.isExcelDesktopDocument],["excelOnline",a.isExcelOnlineDocument],["powerPointDesktop",l.isPowerPointDesktopDocument],["wacComponents",n.documentContainWacElements],["googleSheets",i.isGoogleSheetDocument],["singleImage",c.shouldConvertToSingleImage]]);t.getPasteSource=function(e,t){var r=e.htmlAttributes,n=e.clipboardData,o=e.fragment,a=null,i={htmlAttributes:r,fragment:o,shouldConvertSingleImage:t,clipboardData:n};return u.forEach((function(e,t){!a&&e(i)&&(a=t)})),null!=a?a:"default"}},524:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isExcelDesktopDocument=void 0;var n=r(1738);t.isExcelDesktopDocument=function(e){return"urn:schemas-microsoft-com:office:excel"==e.htmlAttributes[n.PastePropertyNames.EXCEL_DESKTOP_ATTRIBUTE_NAME]}},2816:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isExcelOnlineDocument=void 0;var n=r(1738);t.isExcelOnlineDocument=function(e){var t=e.htmlAttributes;return"Excel.Sheet"==t[n.PastePropertyNames.PROG_ID_NAME]&&null==t[n.PastePropertyNames.EXCEL_DESKTOP_ATTRIBUTE_NAME]}},377:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGoogleSheetDocument=void 0;var n=r(1738);t.isGoogleSheetDocument=function(e){return!!e.fragment.querySelector(n.PastePropertyNames.GOOGLE_SHEET_NODE_NAME)}},2929:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPowerPointDesktopDocument=void 0;var n=r(1738);t.isPowerPointDesktopDocument=function(e){return"PowerPoint.Slide"==e.htmlAttributes[n.PastePropertyNames.PROG_ID_NAME]}},4936:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWordDesktopDocument=void 0;var n=r(1738);t.isWordDesktopDocument=function(e){var t=e.htmlAttributes;return"urn:schemas-microsoft-com:office:word"==t["xmlns:w"]||"Word.Document"==t[n.PastePropertyNames.PROG_ID_NAME]}},3048:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldConvertToSingleImage=void 0,t.shouldConvertToSingleImage=function(e){var t,r=e.shouldConvertSingleImage,n=e.clipboardData;return r&&1==(null===(t=n.htmlFirstLevelChildTags)||void 0===t?void 0:t.length)&&"IMG"==n.htmlFirstLevelChildTags[0]}},3521:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addParser=void 0,t.addParser=function(e,t,r){var n;e.additionalFormatParsers||(e.additionalFormatParsers={}),e.additionalFormatParsers[t]||(e.additionalFormatParsers[t]=[]),null===(n=e.additionalFormatParsers[t])||void 0===n||n.push(r)}},1920:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deprecatedBorderColorParser=void 0;var n=r(8871);t.deprecatedBorderColorParser=function(e){n.BorderKeys.forEach((function(t){var r=e[t],o="";if(r&&n.DeprecatedColors.some((function(e){return r.indexOf(e)>-1&&(o=e)}))){var a=r.replace(o,"").trimRight();e[t]=a}}))}},4103:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStyles=void 0,t.getStyles=function(e){var t={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach((function(e){var r=e.indexOf(":"),n=e.slice(0,r),o=e.slice(r+1);n&&o&&(t[n.trim()]=o.trim())})),t}},4382:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLink=void 0;var n=r(8871),o=["http:","https:","notes:","mailto:","onenote:"],a=/^file:\/\/\/[a-zA-Z\/]/i;t.parseLink=function(e,t){if((0,n.isElementOfType)(t,"a")){var r;try{r=new URL(t.href)}catch(e){r=void 0}(r&&-1===o.indexOf(r.protocol)||a.test(t.href))&&(t.removeAttribute("href"),e.href="")}}},3315:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setProcessor=void 0,t.setProcessor=function(e,t,r){e.processorOverride||(e.processorOverride={}),e.processorOverride[t]=r}},3357:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PickerHelperImpl=void 0;var n=r(8745),o=r(6745),a=r(8871),i=function(){function e(e,t,r){this.editor=e,this.handler=t,this.triggerCharacter=r,this.direction=null}return e.prototype.replaceQueryString=function(e,t,r){var i=this;this.editor.focus(),(0,n.formatTextSegmentBeforeSelectionMarker)(this.editor,(function(t,n,l,s,c){var u=[];return!!(0,o.getQueryString)(i.triggerCharacter,l,n,u)&&(u.forEach((function(e){return e.isSelected=!0})),(0,a.mergeModel)(t,e,c),c.canUndoByBackspace=r,!0)}),t)},e.prototype.closePicker=function(){var e,t;this.direction&&(this.direction=null,null===(t=(e=this.handler).onClosePicker)||void 0===t||t.call(e))},e}();t.PickerHelperImpl=i},3111:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PickerPlugin=void 0;var n=r(8871),o=r(8745),a=r(6745),i=r(3357),l=function(){function e(e,t){this.triggerCharacter=e,this.handler=t,this.isMac=!1,this.lastQueryString="",this.helper=null}return e.prototype.getName=function(){return"Picker"},e.prototype.initialize=function(e){this.isMac=!!e.getEnvironment().isMac,this.helper=new i.PickerHelperImpl(e,this.handler,this.triggerCharacter),this.handler.onInitialize(this.helper)},e.prototype.dispose=function(){this.handler.onDispose(),this.helper=null},e.prototype.willHandleEventExclusively=function(e){var t;return!!(null===(t=this.helper)||void 0===t?void 0:t.direction)&&"keyDown"==e.eventType&&((0,n.isCursorMovingKey)(e.rawEvent)||"Enter"==e.rawEvent.key||"Tab"==e.rawEvent.key||"Escape"==e.rawEvent.key)},e.prototype.onPluginEvent=function(e){if(this.helper)switch(e.eventType){case"contentChanged":this.helper.direction&&(e.source==n.ChangeSource.SetContent?this.helper.closePicker():this.onSuggestingInput(this.helper));break;case"keyDown":this.helper.direction&&this.onSuggestingKeyDown(this.helper,e.rawEvent);break;case"input":this.helper.direction?this.onSuggestingInput(this.helper):this.onInput(this.helper,e.rawEvent);break;case"mouseUp":this.helper.direction&&this.helper.closePicker()}},e.prototype.onSuggestingKeyDown=function(e,t){var r,n,o,a,i,l,s,c,u,d;switch(t.key){case"ArrowLeft":case"ArrowRight":if("horizontal"==e.direction||"both"==e.direction){var f="ArrowRight"==t.key;e.editor.getDOMHelper().isRightToLeft()&&(f=!f),null===(n=(r=this.handler).onSelectionChanged)||void 0===n||n.call(r,f?"next":"previous")}t.preventDefault();break;case"ArrowUp":case"ArrowDown":f="ArrowDown"==t.key,"horizontal"!=e.direction&&(null===(a=(o=this.handler).onSelectionChanged)||void 0===a||a.call(o,"both"==e.direction?f?"nextRow":"previousRow":f?"next":"previous")),t.preventDefault();break;case"PageUp":case"PageDown":null===(l=(i=this.handler).onSelectionChanged)||void 0===l||l.call(i,"PageDown"==t.key?"nextPage":"previousPage"),t.preventDefault();break;case"Home":case"End":var p=this.isMac?t.metaKey:t.ctrlKey;null===(c=(s=this.handler).onSelectionChanged)||void 0===c||c.call(s,"Home"==t.key?p?"first":"firstInRow":p?"last":"lastInRow"),t.preventDefault();break;case"Escape":e.closePicker(),t.preventDefault();break;case"Enter":case"Tab":null===(d=(u=this.handler).onSelect)||void 0===d||d.call(u),t.preventDefault()}},e.prototype.onSuggestingInput=function(e){var t=this;(0,o.formatTextSegmentBeforeSelectionMarker)(e.editor,(function(r,n,o){var i,l,s=(0,a.getQueryString)(t.triggerCharacter,o,n).replace(/[\u0020\u00A0]/g," "),c=t.lastQueryString;return s&&(s.length>=c.length&&0==s.indexOf(c)||s.length<c.length&&0==c.indexOf(s))?(t.lastQueryString=s,null===(l=(i=t.handler).onQueryStringChanged)||void 0===l||l.call(i,s)):e.closePicker(),!1}))||e.closePicker()},e.prototype.onInput=function(e,t){var r=this;"insertText"==t.inputType&&t.data==this.triggerCharacter&&(0,o.formatTextSegmentBeforeSelectionMarker)(e.editor,(function(t,o){if(o.text.endsWith(r.triggerCharacter)){var a=o.text[o.text.length-2];if(!a||!a.trim()||(0,n.isPunctuation)(a)){var i=e.editor.getDOMSelection(),l="range"==(null==i?void 0:i.type)&&i.range.collapsed?{node:i.range.startContainer,offset:i.range.startOffset}:null;l&&(r.lastQueryString=r.triggerCharacter,e.direction=r.handler.onTrigger(r.lastQueryString,l))}}return!1}))},e}();t.PickerPlugin=l},6745:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryString=void 0;var n=r(9943);t.getQueryString=function(e,t,r,o){for(var a="",i=t.segments.indexOf(r);i>=0;i--){var l=t.segments[i];if("Text"!=l.segmentType){a="";break}var s=l.text.lastIndexOf(e);if(s>=0){a=l.text.substring(s)+a,null==o||o.unshift(s>0?(0,n.splitTextSegment)(l,t,s,l.text.length):l);break}a=l.text+a,null==o||o.unshift(l)}return i<0&&(a=""),a}},7270:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createElement=void 0;var n=r(8871);t.createElement=function e(t,r){if(!t||!t.tag)return null;var o=t.tag,a=t.namespace,i=t.className,l=t.style,s=t.dataset,c=t.attributes,u=t.children,d=a?r.createElementNS(a,o):r.createElement(o);return l&&d.setAttribute("style",l),i&&(d.className=i),s&&(0,n.isNodeOfType)(d,"ELEMENT_NODE")&&(0,n.getObjectKeys)(s).forEach((function(e){d.dataset[e]=s[e]})),c&&(0,n.getObjectKeys)(c).forEach((function(e){d.setAttribute(e,c[e])})),u&&u.forEach((function(t){if("string"==typeof t)d.appendChild(r.createTextNode(t));else if(t){var n=e(t,r);n&&d.appendChild(n)}})),d}},5043:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DragAndDropHelper=void 0;var n=r(7582),o={MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEUP:"mouseup",getPageXY:function(e){return[e.pageX,e.pageY]}},a={MOUSEDOWN:"touchstart",MOUSEMOVE:"touchmove",MOUSEUP:"touchend",getPageXY:function(e){var t=0,r=0;if(e.targetTouches&&e.targetTouches.length>0){var n=e.targetTouches[0];t=n.pageX,r=n.pageY}return[t,r]}};var i=function(){function e(e,t,r,i,l,s){var c=this;this.trigger=e,this.context=t,this.onSubmit=r,this.handler=i,this.zoomScale=l,this.initX=0,this.initY=0,this.initValue=void 0,this.onMouseDown=function(e){var t,r,o;e.preventDefault(),e.stopPropagation(),c.addDocumentEvents(),t=(0,n.__read)(c.dndMouse.getPageXY(e),2),c.initX=t[0],c.initY=t[1],c.initValue=null===(o=(r=c.handler).onDragStart)||void 0===o?void 0:o.call(r,c.context,e)},this.onMouseMove=function(e){var t,r,o;e.preventDefault();var a=(0,n.__read)(c.dndMouse.getPageXY(e),2),i=a[0],l=a[1],s=(i-c.initX)/c.zoomScale,u=(l-c.initY)/c.zoomScale;c.initValue&&(null===(r=(t=c.handler).onDragging)||void 0===r?void 0:r.call(t,c.context,e,c.initValue,s,u))&&(null===(o=c.onSubmit)||void 0===o||o.call(c,c.context,c.trigger))},this.onMouseUp=function(e){var t,r,n;e.preventDefault(),c.removeDocumentEvents(),(null===(r=(t=c.handler).onDragEnd)||void 0===r?void 0:r.call(t,c.context,e,c.initValue))&&(null===(n=c.onSubmit)||void 0===n||n.call(c,c.context,c.trigger))},this.dndMouse=s?a:o,e.addEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown)}return e.prototype.dispose=function(){this.trigger.removeEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown),this.removeDocumentEvents()},Object.defineProperty(e.prototype,"mouseType",{get:function(){return this.dndMouse==a?"touch":"mouse"},enumerable:!1,configurable:!0}),e.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.addEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},e.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.removeEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},e}();t.DragAndDropHelper=i},1136:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDOMInsertPointRect=void 0;var n=r(8871);t.getDOMInsertPointRect=function(e,t){var r,o=t.node,a=t.offset,i=e.createRange();i.setStart(o,a);var l=(0,n.normalizeRect)(i.getBoundingClientRect());if(l)return l;for(;o.lastChild;)a==o.childNodes.length?a=(o=o.lastChild).childNodes.length:(o=o.childNodes[a],a=0);var s=i.getClientRects&&i.getClientRects();if(l=s&&1==s.length?(0,n.normalizeRect)(s[0]):null)return l;if((0,n.isNodeOfType)(o,"TEXT_NODE")){var c=o.ownerDocument.createElement("span");if(c.textContent="​",i.insertNode(c),l=(0,n.normalizeRect)(c.getBoundingClientRect()),null===(r=c.parentNode)||void 0===r||r.removeChild(c),l)return l}return(0,n.isNodeOfType)(o,"ELEMENT_NODE")&&o.getBoundingClientRect&&(l=(0,n.normalizeRect)(o.getBoundingClientRect()))?l:null}},6690:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIntersectedRect=void 0;var n=r(7582),o=r(8871);t.getIntersectedRect=function(e,t){void 0===t&&(t=[]);var r=e.map((function(e){return(0,o.normalizeRect)(e.getBoundingClientRect())})).concat(t).filter((function(e){return!!e})),a={top:Math.max.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(r.map((function(e){return e.top}))),!1)),bottom:Math.min.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(r.map((function(e){return e.bottom}))),!1)),left:Math.max.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(r.map((function(e){return e.left}))),!1)),right:Math.min.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(r.map((function(e){return e.right}))),!1))};return a.top<a.bottom&&a.left<a.right?a:null}},9943:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitTextSegment=void 0;var n=r(7582),o=r(8871);t.splitTextSegment=function(e,t,r,a){var i,l=e.text,s=t.segments.indexOf(e),c=(0,o.createText)(l.substring(r,a),e.format,e.link,e.code),u=[c];return r>0&&u.unshift((0,o.createText)(l.substring(0,r),e.format,e.link,e.code)),a<l.length&&u.push((0,o.createText)(l.substring(a),e.format,e.link,e.code)),u.forEach((function(t){return t.isSelected=e.isSelected})),(i=t.segments).splice.apply(i,(0,n.__spreadArray)([s,1],(0,n.__read)(u),!1)),c}},7049:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShortcutPlugin=void 0;var n=r(8871),o=r(312),a=[o.ShortcutBold,o.ShortcutItalic,o.ShortcutUnderline,o.ShortcutClearFormat,o.ShortcutUndo,o.ShortcutUndo2,o.ShortcutRedo,o.ShortcutRedoAlt,o.ShortcutRedoMacOS,o.ShortcutBullet,o.ShortcutNumbering,o.ShortcutIncreaseFont,o.ShortcutDecreaseFont,o.ShortcutIndentList,o.ShortcutOutdentList],i=function(){function e(e){void 0===e&&(e=a),this.shortcuts=e,this.editor=null,this.isMac=!1}return e.prototype.getName=function(){return"Shortcut"},e.prototype.initialize=function(e){this.editor=e,this.isMac=!!this.editor.getEnvironment().isMac},e.prototype.dispose=function(){this.editor=null},e.prototype.willHandleEventExclusively=function(e){return"keyDown"==e.eventType&&(e.rawEvent.ctrlKey||e.rawEvent.altKey||e.rawEvent.metaKey)&&!!this.cacheGetCommand(e)},e.prototype.onPluginEvent=function(e){if(this.editor&&"keyDown"==e.eventType){var t=this.cacheGetCommand(e);t&&(t.onClick(this.editor),e.rawEvent.preventDefault())}},e.prototype.cacheGetCommand=function(e){var t=this;return(0,n.cacheGetEventData)(e,"__ShortcutCommandCache",(function(e){return t.editor&&t.shortcuts.filter((function(r){return t.matchOS(r.environment)&&t.matchShortcut(r.shortcutKey,e.rawEvent)}))[0]}))},e.prototype.matchOS=function(e){switch(e){case"mac":return this.isMac;case"nonMac":return!this.isMac;default:return!0}},e.prototype.matchShortcut=function(e,t){var r=t.ctrlKey,n=t.altKey,o=t.shiftKey,a=t.which,i=t.metaKey,l=this.isMac?i:r;return("ctrl"==e.modifierKey&&l&&!n||"alt"==e.modifierKey&&n&&!l)&&o==e.shiftKey&&e.which==a},e}();t.ShortcutPlugin=i},312:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShortcutOutdentList=t.ShortcutIndentList=t.ShortcutDecreaseFont=t.ShortcutIncreaseFont=t.ShortcutNumbering=t.ShortcutBullet=t.ShortcutRedoAlt=t.ShortcutRedoMacOS=t.ShortcutRedo=t.ShortcutUndo2=t.ShortcutUndo=t.ShortcutClearFormat=t.ShortcutUnderline=t.ShortcutItalic=t.ShortcutBold=void 0;var n,o=r(4781),a=r(7192),i=r(8745);!function(e){e[e.BACKSPACE=8]="BACKSPACE",e[e.SPACE=32]="SPACE",e[e.B=66]="B",e[e.I=73]="I",e[e.U=85]="U",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.ArrowRight=39]="ArrowRight",e[e.ArrowLeft=37]="ArrowLeft"}(n||(n={})),t.ShortcutBold={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:66},onClick:function(e){return(0,i.toggleBold)(e)}},t.ShortcutItalic={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:73},onClick:function(e){return(0,i.toggleItalic)(e)}},t.ShortcutUnderline={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:85},onClick:function(e){return(0,i.toggleUnderline)(e)}},t.ShortcutClearFormat={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:32},onClick:function(e){return(0,i.clearFormat)(e)},environment:"nonMac"},t.ShortcutUndo={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:90},onClick:function(e){return(0,o.undo)(e)}},t.ShortcutUndo2={shortcutKey:{modifierKey:"alt",shiftKey:!1,which:8},onClick:function(e){return(0,o.undo)(e)},environment:"nonMac"},t.ShortcutRedo={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:89},onClick:function(e){return(0,o.redo)(e)},environment:"nonMac"},t.ShortcutRedoMacOS={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:90},onClick:function(e){return(0,o.redo)(e)},environment:"mac"},t.ShortcutRedoAlt={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:90},onClick:function(e){return(0,o.redo)(e)}},t.ShortcutBullet={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:190},onClick:function(e){return(0,i.toggleBullet)(e)}},t.ShortcutNumbering={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:191},onClick:function(e){return(0,i.toggleNumbering)(e)}},t.ShortcutIncreaseFont={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:190},onClick:function(e){return(0,i.changeFontSize)(e,"increase")}},t.ShortcutDecreaseFont={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:188},onClick:function(e){return(0,i.changeFontSize)(e,"decrease")}},t.ShortcutIndentList={shortcutKey:{modifierKey:"alt",shiftKey:!0,which:39},onClick:function(e){(0,a.setShortcutIndentationCommand)(e,"indent")},environment:"nonMac"},t.ShortcutOutdentList={shortcutKey:{modifierKey:"alt",shiftKey:!0,which:37},onClick:function(e){(0,a.setShortcutIndentationCommand)(e,"outdent")},environment:"nonMac"}},7192:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setShortcutIndentationCommand=void 0;var n=r(8871),o=r(8745);t.setShortcutIndentationCommand=function(e,t){e.formatContentModel((function(e,r){var a=(0,n.getFirstSelectedListItem)(e);return!(!a||"Paragraph"!=a.blocks[0].blockType||"SelectionMarker"!=a.blocks[0].segments[0].segmentType||((0,o.setModelIndentation)(e,t,void 0,r),0))}))}},7237:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableEditPlugin=void 0;var n=r(8871),o=r(2789),a=function(){function e(e,t,r){var o=this;this.anchorContainerSelector=e,this.onTableEditorCreated=t,this.disableFeatures=r,this.editor=null,this.onMouseMoveDisposer=null,this.tableRectMap=null,this.tableEditor=null,this.onMouseOut=function(e){var t=e.relatedTarget,r=e.currentTarget;(0,n.isNodeOfType)(t,"ELEMENT_NODE")&&(0,n.isNodeOfType)(r,"ELEMENT_NODE")&&o.tableEditor&&!o.tableEditor.isOwnedElement(t)&&!r.contains(t)&&o.setTableEditor(null)},this.onMouseMove=function(e){var t,r=e;if(!(r.buttons>0)&&o.editor){o.ensureTableRects();var n=o.editor.getDocument().defaultView||window,a=r.pageX-n.scrollX,i=r.pageY-n.scrollY,l=null;if(o.tableRectMap)for(var s=o.tableRectMap.length-1;s>=0;s--){var c=o.tableRectMap[s],u=c.table,d=c.rect;if(a>=d.left-12&&a<=d.right+12&&i>=d.top-12&&i<=d.bottom+12){l=u;break}}o.setTableEditor(l,r),null===(t=o.tableEditor)||void 0===t||t.onMouseMove(a,i)}},this.invalidateTableRects=function(){o.tableRectMap=null}}return e.prototype.getName=function(){return"TableEdit"},e.prototype.initialize=function(e){this.editor=e,this.onMouseMoveDisposer=this.editor.attachDomEvent({mousemove:{beforeDispatch:this.onMouseMove}}),this.editor.getScrollContainer().addEventListener("mouseout",this.onMouseOut)},e.prototype.dispose=function(){var e,t,r=null===(e=this.editor)||void 0===e?void 0:e.getScrollContainer();null==r||r.removeEventListener("mouseout",this.onMouseOut),null===(t=this.onMouseMoveDisposer)||void 0===t||t.call(this),this.invalidateTableRects(),this.disposeTableEditor(),this.editor=null,this.onMouseMoveDisposer=null,this.onTableEditorCreated=void 0},e.prototype.onPluginEvent=function(e){switch(e.eventType){case"input":case"contentChanged":case"scroll":case"zoomChanged":this.setTableEditor(null),this.invalidateTableRects()}},e.prototype.setTableEditor=function(e,t){if(this.tableEditor&&!this.tableEditor.isEditing()&&e!=this.tableEditor.table&&this.disposeTableEditor(),!this.tableEditor&&e&&this.editor&&e.rows.length>0){var r=this.anchorContainerSelector?this.editor.getDocument().querySelector(this.anchorContainerSelector):void 0;this.tableEditor=new o.TableEditor(this.editor,e,this.invalidateTableRects,(0,n.isNodeOfType)(r,"ELEMENT_NODE")?r:void 0,null==t?void 0:t.currentTarget,this.onTableEditorCreated,this.disableFeatures)}},e.prototype.disposeTableEditor=function(){var e;null===(e=this.tableEditor)||void 0===e||e.dispose(),this.tableEditor=null},e.prototype.ensureTableRects=function(){var e=this;!this.tableRectMap&&this.editor&&(this.tableRectMap=[],this.editor.getDOMHelper().queryElements("table").forEach((function(t){if(t.isContentEditable){var r=(0,n.normalizeRect)(t.getBoundingClientRect());r&&e.tableRectMap&&e.tableRectMap.push({table:t,rect:r})}})))},e}();t.TableEditPlugin=a},2789:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableEditor=void 0;var n,o=r(9395),a=r(125),i=r(1037),l=r(1523),s=r(7571),c=r(8871);!function(e){e[e.top=0]="top",e[e.side=1]="side"}(n||(n={}));var u=function(){function e(e,t,r,n,o,a,i){var l,s=this;this.editor=e,this.table=t,this.onChanged=r,this.anchorContainer=n,this.contentDiv=o,this.onTableEditorCreated=a,this.disableFeatures=i,this.horizontalInserter=null,this.verticalInserter=null,this.horizontalResizer=null,this.verticalResizer=null,this.tableResizer=null,this.tableMover=null,this.range=null,this.onEditorCreated=function(e,t){var r,n=null===(r=s.onTableEditorCreated)||void 0===r?void 0:r.call(s,e,t),o=t&&s.getOnMouseOut(t);return o&&t.addEventListener("mouseout",o),function(){null==n||n(),o&&t.removeEventListener("mouseout",o)}},this.onFinishEditing=function(){return s.editor.focus(),s.range&&s.editor.setDOMSelection({type:"range",range:s.range,isReverted:!1}),s.editor.takeSnapshot(),s.onChanged(),s.isCurrentlyEditing=!1,!1},this.onStartTableResize=function(){s.isCurrentlyEditing=!0,s.onStartResize()},this.onStartCellResize=function(){s.isCurrentlyEditing=!0,s.disposeTableResizer(),s.onStartResize()},this.onStartTableMove=function(){s.isCurrentlyEditing=!0,s.disposeTableResizer(),s.disposeTableInserter(),s.disposeCellResizers()},this.onEndTableMove=function(){return s.disposeTableMover(),s.onFinishEditing()},this.onInserted=function(){s.disposeTableResizer(),s.onFinishEditing()},this.onSelect=function(e){var t,r;if(s.editor.focus(),e){var n=(0,c.parseTableCells)(e),o={table:e,firstRow:0,firstColumn:0,lastRow:n.length-1,lastColumn:(null!==(r=null===(t=n[0])||void 0===t?void 0:t.length)&&void 0!==r?r:0)-1,type:"table"};s.editor.setDOMSelection(o)}},this.getOnMouseOut=function(e){return function(t){e&&t.relatedTarget!=e&&(0,c.isNodeOfType)(s.contentDiv,"ELEMENT_NODE")&&(0,c.isNodeOfType)(t.relatedTarget,"ELEMENT_NODE")&&s.contentDiv!=t.relatedTarget&&!s.isEditing()&&s.dispose()}},this.isRTL="rtl"==(null===(l=e.getDocument().defaultView)||void 0===l?void 0:l.getComputedStyle(t).direction),this.setEditorFeatures(),this.isCurrentlyEditing=!1}return e.prototype.dispose=function(){this.disposeTableResizer(),this.disposeCellResizers(),this.disposeTableInserter(),this.disposeTableMover()},e.prototype.isEditing=function(){return this.isCurrentlyEditing},e.prototype.isOwnedElement=function(e){return[this.tableResizer,this.tableMover,this.horizontalInserter,this.verticalInserter,this.horizontalResizer,this.verticalResizer].filter((function(e){return!!(null==e?void 0:e.div)})).some((function(t){return(null==t?void 0:t.div)==e}))},e.prototype.onMouseMove=function(e,t){var r,n=(0,c.normalizeRect)(this.table.getBoundingClientRect());if(n){for(var o=t<=n.top+6?0:this.isRTL?e>=n.right-6?1:void 0:e<=n.left+6?1:void 0,a=o?1:0,i=0;i<this.table.rows.length;i++){for(var l=this.table.rows[i],s=0;s<l.cells.length;s++){var u=l.cells[s],d=(0,c.normalizeRect)(u.getBoundingClientRect());if(d&&n){var f=t<=d.bottom,p=this.isRTL?e<=d.right+6*a:e<=d.right,m=this.isRTL?e>=d.left:e>=d.left-6*a;if(f&&p&&m){if(0===i&&0==o){var h=(d.left+d.right)/2,g=this.isRTL?e<h:e>h;!this.isFeatureDisabled("VerticalTableInserter")&&this.setInserterTd(g?u:l.cells[s-1],!1)}else if(0===s&&1==o){var v=null===(r=this.table.rows[i-1])||void 0===r?void 0:r.cells[0],b=v?(0,c.normalizeRect)(v.getBoundingClientRect()):null,y=b?this.isRTL?b.right===d.right:b.left===d.left:null;!this.isFeatureDisabled("HorizontalTableInserter")&&this.setInserterTd(t<(d.top+d.bottom)/2&&y?v:u,!0)}else this.setInserterTd(null);!this.isFeatureDisabled("CellResizer")&&this.setResizingTd(u);break}}}if(s<l.cells.length)break}this.setEditorFeatures()}},e.prototype.setEditorFeatures=function(){var e=this.isFeatureDisabled("TableSelector"),t=this.isFeatureDisabled("TableMover");this.tableMover||e&&t||(this.tableMover=(0,i.createTableMover)(this.table,this.editor,this.isRTL,e?function(){}:this.onSelect,this.onStartTableMove,this.onEndTableMove,this.contentDiv,this.anchorContainer,this.onEditorCreated,t)),this.tableResizer||this.isFeatureDisabled("TableResizer")||(this.tableResizer=(0,l.createTableResizer)(this.table,this.editor,this.isRTL,this.onStartTableResize,this.onFinishEditing,this.contentDiv,this.anchorContainer,this.onTableEditorCreated))},e.prototype.setResizingTd=function(e){this.horizontalResizer&&this.horizontalResizer.node!=e&&this.disposeCellResizers(),!this.horizontalResizer&&e&&(this.horizontalResizer=(0,o.createCellResizer)(this.editor,e,this.table,this.isRTL,!0,this.onStartCellResize,this.onFinishEditing,this.anchorContainer),this.verticalResizer=(0,o.createCellResizer)(this.editor,e,this.table,this.isRTL,!1,this.onStartCellResize,this.onFinishEditing,this.anchorContainer))},e.prototype.setInserterTd=function(e,t){var r=t?this.horizontalInserter:this.verticalInserter;if((null===e||r&&r.node!=e)&&this.disposeTableInserter(),!this.horizontalInserter&&!this.verticalInserter&&e){var n=(0,a.createTableInserter)(this.editor,e,this.table,this.isRTL,!!t,this.onInserted,this.anchorContainer,this.onEditorCreated);t?this.horizontalInserter=n:this.verticalInserter=n}},e.prototype.disposeTableResizer=function(){this.tableResizer&&((0,s.disposeTableEditFeature)(this.tableResizer),this.tableResizer=null)},e.prototype.disposeTableInserter=function(){this.horizontalInserter&&((0,s.disposeTableEditFeature)(this.horizontalInserter),this.horizontalInserter=null),this.verticalInserter&&((0,s.disposeTableEditFeature)(this.verticalInserter),this.verticalInserter=null)},e.prototype.disposeCellResizers=function(){this.horizontalResizer&&((0,s.disposeTableEditFeature)(this.horizontalResizer),this.horizontalResizer=null),this.verticalResizer&&((0,s.disposeTableEditFeature)(this.verticalResizer),this.verticalResizer=null)},e.prototype.disposeTableMover=function(){this.tableMover&&((0,s.disposeTableEditFeature)(this.tableMover),this.tableMover=null)},e.prototype.onStartResize=function(){this.isCurrentlyEditing=!0;var e=this.editor.getDOMSelection();e&&"range"==e.type&&(this.range=e.range),this.editor.takeSnapshot()},e.prototype.isFeatureDisabled=function(e){var t;return null===(t=this.disableFeatures)||void 0===t?void 0:t.includes(e)},e}();t.TableEditor=u},9395:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCellResizer=t.VERTICAL_RESIZER_ID=t.HORIZONTAL_RESIZER_ID=void 0;var n=r(7582),o=r(7270),a=r(5043),i=r(8871);function l(e,t){var r=e.td,o=e.onStart,a=(0,i.normalizeRect)(r.getBoundingClientRect()),l=r.cellIndex,s=r.parentElement&&(0,i.isElementOfType)(r.parentElement,"tr")?r.parentElement:void 0,c=null==s?void 0:s.rowIndex;if(null==c)return{cmTable:void 0,anchorColumn:void 0,anchorRow:void 0,anchorRowHeight:-1,allWidths:[]};var u=e.editor,d=e.table,f=u.getDOMSelection();u.setDOMSelection({type:"table",firstColumn:0,firstRow:0,lastColumn:0,lastRow:0,table:d});var p=(0,i.getFirstSelectedTable)(u.getContentModelCopy("disconnected"))[0];return u.setDOMSelection(f),a&&p?(o(),{cmTable:p,anchorColumn:l,anchorRow:c,anchorRowHeight:p.rows[c].height,allWidths:(0,n.__spreadArray)([],(0,n.__read)(p.widths),!1)}):{cmTable:p,anchorColumn:void 0,anchorRow:void 0,anchorRowHeight:-1,allWidths:[]}}function s(e,t,r,n,o){var a=e.table,l=r.cmTable,s=r.anchorRow,c=r.anchorRowHeight;if(l&&null!=s){l.rows[s].height=(null!=c?c:0)+o,(0,i.normalizeTable)(l);for(var u=a.rows[s],d=0;d<u.cells.length;d++)u.cells[d].style.height=l.rows[s].height+"px";return!0}return!1}function c(e,t,r,n){var o=e.table,a=e.isRTL,l=r.cmTable,s=r.anchorColumn,c=r.allWidths;if(l&&null!=s){var u=n*(a?-1:1);if(s==l.widths.length-1)l.widths[s]=c[s]+u;else{var d=c[s]+u,f=c[s+1]-u;if(d<i.MIN_ALLOWED_TABLE_CELL_WIDTH||f<i.MIN_ALLOWED_TABLE_CELL_WIDTH)return!1;l.widths[s]=d,l.widths[s+1]=f}(0,i.normalizeTable)(l);for(var p=0;p<o.rows.length;p++)for(var m=o.rows[p],h=0;h<m.cells.length;h++)m.cells[h].style.width=l.widths[h]+"px";return!0}return!1}function u(e,r){var n=e.td,o=(0,i.normalizeRect)(n.getBoundingClientRect());o&&(r.id=t.HORIZONTAL_RESIZER_ID,r.style.top=o.bottom-4+"px",r.style.left=o.left+"px",r.style.width=o.right-o.left+"px",r.style.height="4px")}function d(e,r){var n=e.td,o=e.isRTL,a=(0,i.normalizeRect)(n.getBoundingClientRect());a&&(r.id=t.VERTICAL_RESIZER_ID,r.style.top=a.top+"px",r.style.left=(o?a.left:a.right)-4+1+"px",r.style.width="4px",r.style.height=a.bottom-a.top+"px")}t.HORIZONTAL_RESIZER_ID="horizontalResizer",t.VERTICAL_RESIZER_ID="verticalResizer",t.createCellResizer=function(e,t,r,n,i,f,p,m){var h=t.ownerDocument,g={tag:"div",style:"position: fixed; cursor: "+(i?"row":"col")+"-resize; user-select: none"},v=e.getDOMHelper().calculateZoomScale(),b=(0,o.createElement)(g,h);(m||h.body).appendChild(b);var y={editor:e,td:t,table:r,isRTL:n,zoomScale:v,onStart:f},S=i?u:d;S(y,b);var C={onDragStart:l,onDragging:i?s:c,onDragEnd:p};return{node:t,div:b,featureHandler:new a.DragAndDropHelper(b,y,S,C,v,e.getEnvironment().isMobileOrTablet)}}},7571:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disposeTableEditFeature=void 0,t.disposeTableEditFeature=function(e){var t,r,n;e&&(null===(t=e.featureHandler)||void 0===t||t.dispose(),e.featureHandler=null,null===(n=null===(r=e.div)||void 0===r?void 0:r.parentNode)||void 0===n||n.removeChild(e.div),e.div=null)}},125:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTableInserter=t.VERTICAL_INSERTER_ID=t.HORIZONTAL_INSERTER_ID=void 0;var n=r(7270),o=r(6690),a=r(8871),i=r(8745);t.HORIZONTAL_INSERTER_ID="horizontalInserter",t.VERTICAL_INSERTER_ID="verticalInserter",t.createTableInserter=function(e,r,i,s,c,u,d,f){var p=(0,a.normalizeRect)(r.getBoundingClientRect()),m=e.getVisibleViewport(),h=i&&m?(0,o.getIntersectedRect)([i],[m]):null;if(p&&h){var g=r.ownerDocument,v=function(e,t,r,n){var o=t?"white":"#4A4A4A";return{tag:"div",style:"position: fixed; width: 12px; height: 12px; font-size: 16px; color: black; line-height: 8px; vertical-align: middle; text-align: center; cursor: pointer; border: solid 1px "+o+"; border-radius: 50%; background-color: "+n,children:[{tag:"div",style:"position: absolute; box-sizing: border-box; background-color: "+n+";"+(e?(r?"right":"left")+": 12px; top: 5px; height: 3px; border-top: 1px solid "+o+"; border-bottom: 1px solid "+o+"; border-right: 1px solid "+o+"; border-left: 0px;":"left: 5px; top: 12px; width: 3px; border-left: 1px solid "+o+"; border-right: 1px solid "+o+"; border-bottom: 1px solid "+o+"; border-top: 0px;")},"+"]}}(c,e.isDarkMode(),s,e.getDOMHelper().getDomStyle("backgroundColor")||"white"),b=(0,n.createElement)(v,g);return c?(b.id=t.HORIZONTAL_INSERTER_ID,b.style.left=(s?h.right:h.left-13)+"px",b.style.top=p.bottom-8+"px",b.firstChild.style.width=h.right-h.left+"px"):(b.id=t.VERTICAL_INSERTER_ID,b.style.left=(s?p.left-8:p.right-8)+"px",b.style.top=h.top-13+"px",b.firstChild.style.height=h.bottom-h.top+"px"),(d||g.body).appendChild(b),{div:b,featureHandler:new l(b,r,i,c,e,u,f),node:r}}return null};var l=function(){function e(e,t,r,n,o,l,s){var c=this;this.div=e,this.td=t,this.table=r,this.isHorizontal=n,this.editor=o,this.onInsert=l,this.insertTd=function(){var e=c.td.cellIndex,t=c.td.parentElement&&(0,a.isElementOfType)(c.td.parentElement,"tr")?c.td.parentElement:void 0,r=t&&t.rowIndex;null!=(null==t?void 0:t.cells)&&null!=r&&((0,i.formatTableWithContentModel)(c.editor,"editTablePlugin",(function(e){c.isHorizontal?(0,i.insertTableRow)(e,"insertBelow"):(0,i.insertTableColumn)(e,"insertRight")}),{type:"table",firstColumn:e,firstRow:r,lastColumn:e,lastRow:r,table:c.table}),c.onInsert())},this.div.addEventListener("click",this.insertTd),this.disposer=null==s?void 0:s(n?"HorizontalTableInserter":"VerticalTableInserter",e)}return e.prototype.dispose=function(){var e;this.div.removeEventListener("click",this.insertTd),null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=void 0},e}()},1037:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onDragEnd=t.onDragging=t.onDragStart=t.createTableMover=t.TABLE_MOVER_ID=void 0;var n=r(7582),o=r(7270),a=r(5043),i=r(8745),l=r(8871),s=12;t.TABLE_MOVER_ID="_Table_Mover";var c="_TableMoverCursorStyle";t.createTableMover=function(e,r,n,a,i,c,d,f,g,v){var b=(0,l.normalizeRect)(e.getBoundingClientRect());if(!function(e,t,r){var n=e.getVisibleViewport();if((0,l.isNodeOfType)(r,"ELEMENT_NODE")&&n&&t){var o=(0,l.normalizeRect)(r.getBoundingClientRect());return!!o&&o.top<=t.top&&n.top<=t.top}return!0}(r,b,d))return null;var y=r.getDOMHelper().calculateZoomScale(),S=e.ownerDocument,C=(0,o.createElement)({tag:"div",style:"position: fixed; cursor: move; user-select: none; border: 1px solid #808080"},S);C.id=t.TABLE_MOVER_ID,C.style.width="12px",C.style.height="12px",(f||S.body).appendChild(C);var _={table:e,zoomScale:y,rect:b,isRTL:n,editor:r,div:C,onFinishDragging:a,onStart:i,onEnd:c,disableMovement:v};return function(e,t){var r=e.rect;r&&(t.style.top=r.top-s+"px",t.style.left=r.left-s-2+"px")}(_,C),{node:e,div:C,featureHandler:new u(C,_,(function(){}),v?{onDragEnd:h}:{onDragStart:p,onDragging:m,onDragEnd:h},_.zoomScale,g,r.getEnvironment().isMobileOrTablet)}};var u=function(e){function t(t,r,n,o,a,i,l){var s=e.call(this,t,r,n,o,a,l)||this;return s.disposer=null==i?void 0:i("TableMover",t),s}return(0,n.__extends)(t,e),t.prototype.dispose=function(){var t;null===(t=this.disposer)||void 0===t||t.call(this),this.disposer=void 0,e.prototype.dispose.call(this)},t}(a.DragAndDropHelper);function d(e,t,r){var n;null==e||e.setEditorStyle(c,t?null!==(n="cursor: "+r)&&void 0!==n?n:"move":null)}function f(e,t,r){var n=e.getDocument(),o=e.getDOMHelper();if(n.caretRangeFromPoint){var a=n.caretRangeFromPoint(t,r);if(a&&o.isNodeInEditor(a.startContainer))return{node:a.startContainer,offset:a.startOffset}}if("caretPositionFromPoint"in n){var i=n.caretPositionFromPoint(t,r);if(i&&o.isNodeInEditor(i.offsetNode))return{node:i.offsetNode,offset:i.offset}}if(n.elementFromPoint){var l=n.elementFromPoint(t,r);if(l&&o.isNodeInEditor(l))return{node:l,offset:0}}return null}function p(e){var t;e.onStart();var r=e.editor,a=e.table,i=e.div;d(r,!0,"move");var s=a.getBoundingClientRect(),c=(0,o.createElement)({tag:"div",style:"position: fixed; user-select: none; border: 1px solid #808080"},document);c.style.width=s.width+"px",c.style.height=s.height+"px",c.style.top=s.top+"px",c.style.left=s.left+"px",null===(t=i.parentNode)||void 0===t||t.appendChild(c);var u=r.getDOMSelection();r.setDOMSelection({type:"table",firstColumn:0,firstRow:0,lastColumn:0,lastRow:0,table:a});var f=(0,n.__read)((0,l.getFirstSelectedTable)(r.getContentModelCopy("disconnected")),1)[0];return r.setDOMSelection(u),{cmTable:f,initialSelection:u,tableRect:c}}function m(e,t,r){var n=r.tableRect,o=e.editor;n.style.top=t.clientY+s+"px",n.style.left=t.clientX+s+"px";var a=f(o,t.clientX,t.clientY);if(a){var i=o.getDocument().createRange();return i.setStart(a.node,a.offset),i.collapse(!0),o.setDOMSelection({type:"range",range:i,isReverted:!1}),!0}return!1}function h(e,t,r){var o,a,s=e.editor,c=e.table,u=e.onFinishDragging,p=e.disableMovement,m=t.target;if(null==r||r.tableRect.remove(),d(s,!1),m==e.div)return u(c),e.onEnd(),!0;if(c.contains(m)||!s.getDOMHelper().isNodeInEditor(m)||p)return s.setDOMSelection(null!==(o=null==r?void 0:r.initialSelection)&&void 0!==o?o:null),e.onEnd(),!1;var h=!1,g=f(s,t.clientX,t.clientY);return g?(0,i.formatInsertPointWithContentModel)(s,g,(function(e,t,o){var a,i=(0,n.__read)((0,l.getFirstSelectedTable)(e),2),s=i[0],c=i[1];if(s){var u=c[0].blocks.indexOf(s);c[0].blocks.splice(u,1)}if(o&&(null==r?void 0:r.cmTable)){var d=(0,l.createContentModelDocument)();if(d.blocks.push(r.cmTable),h=!!(0,l.mergeModel)(e,d,t,{mergeFormat:"none",insertPosition:o})){var f=null!==(a=(0,l.getFirstSelectedTable)(e)[0])&&void 0!==a?a:r.cmTable;if(f){var p=f.rows[0].cells[0],m=null==p?void 0:p.blocks[0];if("Paragraph"==(null==m?void 0:m.blockType)){var g=(0,l.createSelectionMarker)(e.format);m.segments.unshift(g),(0,l.setParagraphNotImplicit)(m),(0,l.setSelection)(p,g)}}}return h}}),{selectionOverride:{type:"table",firstColumn:0,firstRow:0,lastColumn:0,lastRow:0,table:c},apiName:"TableMover"}):s.setDOMSelection(null!==(a=null==r?void 0:r.initialSelection)&&void 0!==a?a:null),e.onEnd(),h}t.onDragStart=p,t.onDragging=m,t.onDragEnd=h},1523:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTableResizer=t.TABLE_RESIZER_ID=void 0;var n=r(7582),o=r(7270),a=r(5043),i=r(8871),l=12;t.TABLE_RESIZER_ID="_Table_Resizer",t.createTableResizer=function(e,r,n,a,h,g,v,b){if(!m(r,(0,i.normalizeRect)(e.getBoundingClientRect()),g))return null;var y=e.ownerDocument,S=r.getDOMHelper().calculateZoomScale(),C={tag:"div",style:"position: fixed; cursor: "+(n?"ne":"nw")+"-resize; user-select: none; border: 1px solid #808080"},_=(0,o.createElement)(C,y);_.id=t.TABLE_RESIZER_ID,_.style.width=l+"px",_.style.height=l+"px",(v||y.body).appendChild(_);var T={isRTL:n,table:e,zoomScale:S,onStart:a,onEnd:h,div:_,editor:r,contentDiv:g};return f(T,_),{node:e,div:_,featureHandler:new s(_,T,p,{onDragStart:c,onDragging:u,onDragEnd:d},S,r.getEnvironment().isMobileOrTablet,b)}};var s=function(e){function t(t,r,n,o,a,i,l){var s=e.call(this,t,r,n,o,a,i)||this;return s.disposer=null==l?void 0:l("TableResizer",t),s}return(0,n.__extends)(t,e),t.prototype.dispose=function(){var t;null===(t=this.disposer)||void 0===t||t.call(this),this.disposer=void 0,e.prototype.dispose.call(this)},t}(a.DragAndDropHelper);function c(e,t){e.onStart();var r=e.editor,n=e.table,o=r.getDOMSelection();r.setDOMSelection({type:"table",firstColumn:0,firstRow:0,lastColumn:0,lastRow:0,table:n});var a=(0,i.getFirstSelectedTable)(r.getContentModelCopy("disconnected"))[0];r.setDOMSelection(o);var l=[];null==a||a.rows.forEach((function(e){l.push(e.height)}));var s=[];return null==a||a.widths.forEach((function(e){s.push(e)})),{originalRect:n.getBoundingClientRect(),cmTable:a,originalHeights:null!=l?l:[],originalWidths:null!=s?s:[]}}function u(e,t,r,n,o){var a,l,s=e.isRTL,c=e.zoomScale,u=e.table,d=r.originalRect,f=r.originalHeights,p=r.originalWidths,m=r.cmTable,h=1+n/d.width*c*(s?-1:1),g=1+o/d.height*c,v=Math.abs(h-1)>.001,b=Math.abs(g-1)>.001;if(u.style.setProperty("width",null),u.style.setProperty("height",null),m&&m.rows&&(v||b)){for(var y=0;y<m.rows.length;y++)for(var S=0;S<m.rows[y].cells.length;S++)m.rows[y].cells[S]&&(v&&0==y&&(m.widths[S]=(null!==(a=p[S])&&void 0!==a?a:0)*h),b&&0==S&&(m.rows[y].height=(null!==(l=f[y])&&void 0!==l?l:0)*g));(0,i.normalizeTable)(m);for(var C=0;C<u.rows.length;C++){var _=u.rows[C];if(0!=_.cells.length)for(var T=0;T<_.cells.length;T++){var E=_.cells[T];E.style.width=m.widths[T]+"px",E.style.height=m.rows[C].height+"px"}}return!0}return!1}function d(e,t,r){return e.editor.isDisposed()||(m(e.editor,(0,i.normalizeRect)(e.table.getBoundingClientRect()),e.contentDiv)&&(e.div.style.visibility="visible",f(e,e.div)),e.onEnd()),!1}function f(e,t){var r=e.table,n=e.isRTL,o=(0,i.normalizeRect)(r.getBoundingClientRect());o&&(t.style.top=o.bottom+"px",t.style.left=n?o.left-l-2+"px":o.right+"px")}function p(e,t){t.style.visibility="hidden"}function m(e,t,r){var n=e.getVisibleViewport();if((0,i.isNodeOfType)(r,"ELEMENT_NODE")&&n&&t){var o=(0,i.normalizeRect)(r.getBoundingClientRect());return!!o&&o.bottom>=t.bottom&&n.bottom>=t.bottom}return!0}},8185:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WatermarkPlugin=void 0;var n=r(8871),o=r(5269),a="_WatermarkContent",i={fontFamily:"font-family",fontSize:"font-size",textColor:"color"},l=function(){function e(e,t){this.watermark=e,this.editor=null,this.isShowing=!1,this.format=t||{fontSize:"14px",textColor:"#AAAAAA"}}return e.prototype.getName=function(){return"Watermark"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=this,r=this.editor;r&&("input"==e.eventType&&"insertText"==e.rawEvent.inputType||"compositionEnd"==e.eventType?this.showHide(r,!1):"editorReady"!=e.eventType&&"contentChanged"!=e.eventType&&"input"!=e.eventType&&"beforeDispose"!=e.eventType||r.formatContentModel((function(e){var n=(0,o.isModelEmptyFast)(e);return t.showHide(r,n),!1})))},e.prototype.showHide=function(e,t){this.isShowing&&!t?this.hide(e):!this.isShowing&&t&&this.show(e)},e.prototype.show=function(e){var t=this,r='position: absolute; pointer-events: none; content: "'+this.watermark+'";';(0,n.getObjectKeys)(i).forEach((function(e){t.format[e]&&(r+=i[e]+": "+t.format[e]+"!important;")})),e.setEditorStyle(a,r,"before"),this.isShowing=!0},e.prototype.hide=function(e){e.setEditorStyle(a,null),this.isShowing=!1},e}();t.WatermarkPlugin=l},5269:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isModelEmptyFast=void 0,t.isModelEmptyFast=function(e){var t=e.blocks[0];return!(e.blocks.length>1)&&(!t||"Paragraph"==t.blockType&&(0==t.segments.length||!t.segments.some((function(e){return"Entity"==e.segmentType||"Image"==e.segmentType||"General"==e.segmentType||"Text"==e.segmentType&&e.text}))&&!(t.format.marginRight&&parseFloat(t.format.marginRight)>0||t.format.marginLeft&&parseFloat(t.format.marginLeft)>0)&&t.segments.filter((function(e){return"Br"==e.segmentType})).length<=1))}},8234:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5115:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditor=void 0;var n=r(7582),o=r(4781),a=r(1297);t.createEditor=function(e,t,r){var i={plugins:(0,n.__spreadArray)([new a.PastePlugin,new a.EditPlugin,new a.ShortcutPlugin],(0,n.__read)(null!=t?t:[]),!1),initialModel:r,defaultSegmentFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new o.Editor(e,i)}},8608:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditor=void 0;var n=r(7582),o=r(5115);Object.defineProperty(t,"createEditor",{enumerable:!0,get:function(){return o.createEditor}}),(0,n.__exportStar)(r(8234),t),(0,n.__exportStar)(r(8871),t),(0,n.__exportStar)(r(4781),t),(0,n.__exportStar)(r(8745),t),(0,n.__exportStar)(r(1297),t),(0,n.__exportStar)(r(1660),t)},7582:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__assign:()=>a,__asyncDelegator:()=>M,__asyncGenerator:()=>E,__asyncValues:()=>k,__await:()=>T,__awaiter:()=>m,__classPrivateFieldGet:()=>D,__classPrivateFieldIn:()=>F,__classPrivateFieldSet:()=>L,__createBinding:()=>g,__decorate:()=>l,__esDecorate:()=>c,__exportStar:()=>v,__extends:()=>o,__generator:()=>h,__importDefault:()=>x,__importStar:()=>w,__makeTemplateObject:()=>O,__metadata:()=>p,__param:()=>s,__propKey:()=>d,__read:()=>y,__rest:()=>i,__runInitializers:()=>u,__setFunctionName:()=>f,__spread:()=>S,__spreadArray:()=>_,__spreadArrays:()=>C,__values:()=>b,default:()=>N});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function l(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function s(e,t){return function(r,n){t(r,n,e)}}function c(e,t,r,n,o,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var l,s=n.kind,c="getter"===s?"get":"setter"===s?"set":"value",u=!t&&e?n.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),f=!1,p=r.length-1;p>=0;p--){var m={};for(var h in n)m[h]="access"===h?{}:n[h];for(var h in n.access)m.access[h]=n.access[h];m.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var g=(0,r[p])("accessor"===s?{get:d.get,set:d.set}:d[c],m);if("accessor"===s){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(l=i(g.get))&&(d.get=l),(l=i(g.set))&&(d.set=l),(l=i(g.init))&&o.unshift(l)}else(l=i(g))&&("field"===s?o.unshift(l):d[c]=l)}u&&Object.defineProperty(u,n.name,d),f=!0}function u(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function f(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{s(n.next(e))}catch(e){a(e)}}function l(e){try{s(n.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))}function h(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(s){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{r=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}}var g=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function v(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,l=a.length;i<l;i++,o++)n[o]=a[i];return n}function _(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function T(e){return this instanceof T?(this.v=e,this):new T(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||l(e,t)}))})}function l(e,t){try{(r=o[e](t)).value instanceof T?Promise.resolve(r.value.v).then(s,c):u(a[0][2],r)}catch(e){u(a[0][3],e)}var r}function s(e){l("next",e)}function c(e){l("throw",e)}function u(e,t){e(t),a.shift(),a.length&&l(a[0][0],a[0][1])}}function M(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:T(e[n](t)),done:!1}:o?o(t):t}:o}}function k(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,o,(t=e[r](t)).done,t.value)}))}}}function O(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return P(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function D(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function L(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function F(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}const N={__extends:o,__assign:a,__rest:i,__decorate:l,__param:s,__metadata:p,__awaiter:m,__generator:h,__createBinding:g,__exportStar:v,__values:b,__read:y,__spread:S,__spreadArrays:C,__spreadArray:_,__await:T,__asyncGenerator:E,__asyncDelegator:M,__asyncValues:k,__makeTemplateObject:O,__importStar:w,__importDefault:x,__classPrivateFieldGet:D,__classPrivateFieldSet:L,__classPrivateFieldIn:F}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n=r(8608);roosterjs=n})();
//# sourceMappingURL=rooster-min.js.map