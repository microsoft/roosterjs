var roosterjsContentModel;(()=>{var e={8168:(e,t,r)=>{var n=r(8874),o={};for(var a in n)n.hasOwnProperty(a)&&(o[n[a]]=a);var i=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var l in i)if(i.hasOwnProperty(l)){if(!("channels"in i[l]))throw new Error("missing channels property: "+l);if(!("labels"in i[l]))throw new Error("missing channel labels property: "+l);if(i[l].labels.length!==i[l].channels)throw new Error("channel and label counts mismatch: "+l);var s=i[l].channels,c=i[l].labels;delete i[l].channels,delete i[l].labels,Object.defineProperty(i[l],"channels",{value:s}),Object.defineProperty(i[l],"labels",{value:c})}i.rgb.hsl=function(e){var t,r,n=e[0]/255,o=e[1]/255,a=e[2]/255,i=Math.min(n,o,a),l=Math.max(n,o,a),s=l-i;return l===i?t=0:n===l?t=(o-a)/s:o===l?t=2+(a-n)/s:a===l&&(t=4+(n-o)/s),(t=Math.min(60*t,360))<0&&(t+=360),r=(i+l)/2,[t,100*(l===i?0:r<=.5?s/(l+i):s/(2-l-i)),100*r]},i.rgb.hsv=function(e){var t,r,n,o,a,i=e[0]/255,l=e[1]/255,s=e[2]/255,c=Math.max(i,l,s),d=c-Math.min(i,l,s),u=function(e){return(c-e)/6/d+.5};return 0===d?o=a=0:(a=d/c,t=u(i),r=u(l),n=u(s),i===c?o=n-r:l===c?o=1/3+t-n:s===c&&(o=2/3+r-t),o<0?o+=1:o>1&&(o-=1)),[360*o,100*a,100*c]},i.rgb.hwb=function(e){var t=e[0],r=e[1],n=e[2];return[i.rgb.hsl(e)[0],1/255*Math.min(t,Math.min(r,n))*100,100*(n=1-1/255*Math.max(t,Math.max(r,n)))]},i.rgb.cmyk=function(e){var t,r=e[0]/255,n=e[1]/255,o=e[2]/255;return[100*((1-r-(t=Math.min(1-r,1-n,1-o)))/(1-t)||0),100*((1-n-t)/(1-t)||0),100*((1-o-t)/(1-t)||0),100*t]},i.rgb.keyword=function(e){var t=o[e];if(t)return t;var r,a,i,l=1/0;for(var s in n)if(n.hasOwnProperty(s)){var c=(a=e,i=n[s],Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2)+Math.pow(a[2]-i[2],2));c<l&&(l=c,r=s)}return r},i.keyword.rgb=function(e){return n[e]},i.rgb.xyz=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*t+.7152*r+.0722*n),100*(.0193*t+.1192*r+.9505*n)]},i.rgb.lab=function(e){var t=i.rgb.xyz(e),r=t[0],n=t[1],o=t[2];return n/=100,o/=108.883,r=(r/=95.047)>.008856?Math.pow(r,1/3):7.787*r+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(r-n),200*(n-(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116))]},i.hsl.rgb=function(e){var t,r,n,o,a,i=e[0]/360,l=e[1]/100,s=e[2]/100;if(0===l)return[a=255*s,a,a];t=2*s-(r=s<.5?s*(1+l):s+l-s*l),o=[0,0,0];for(var c=0;c<3;c++)(n=i+1/3*-(c-1))<0&&n++,n>1&&n--,a=6*n<1?t+6*(r-t)*n:2*n<1?r:3*n<2?t+(r-t)*(2/3-n)*6:t,o[c]=255*a;return o},i.hsl.hsv=function(e){var t=e[0],r=e[1]/100,n=e[2]/100,o=r,a=Math.max(n,.01);return r*=(n*=2)<=1?n:2-n,o*=a<=1?a:2-a,[t,100*(0===n?2*o/(a+o):2*r/(n+r)),(n+r)/2*100]},i.hsv.rgb=function(e){var t=e[0]/60,r=e[1]/100,n=e[2]/100,o=Math.floor(t)%6,a=t-Math.floor(t),i=255*n*(1-r),l=255*n*(1-r*a),s=255*n*(1-r*(1-a));switch(n*=255,o){case 0:return[n,s,i];case 1:return[l,n,i];case 2:return[i,n,s];case 3:return[i,l,n];case 4:return[s,i,n];case 5:return[n,i,l]}},i.hsv.hsl=function(e){var t,r,n,o=e[0],a=e[1]/100,i=e[2]/100,l=Math.max(i,.01);return n=(2-a)*i,r=a*l,[o,100*(r=(r/=(t=(2-a)*l)<=1?t:2-t)||0),100*(n/=2)]},i.hwb.rgb=function(e){var t,r,n,o,a,i,l,s=e[0]/360,c=e[1]/100,d=e[2]/100,u=c+d;switch(u>1&&(c/=u,d/=u),n=6*s-(t=Math.floor(6*s)),0!=(1&t)&&(n=1-n),o=c+n*((r=1-d)-c),t){default:case 6:case 0:a=r,i=o,l=c;break;case 1:a=o,i=r,l=c;break;case 2:a=c,i=r,l=o;break;case 3:a=c,i=o,l=r;break;case 4:a=o,i=c,l=r;break;case 5:a=r,i=c,l=o}return[255*a,255*i,255*l]},i.cmyk.rgb=function(e){var t=e[0]/100,r=e[1]/100,n=e[2]/100,o=e[3]/100;return[255*(1-Math.min(1,t*(1-o)+o)),255*(1-Math.min(1,r*(1-o)+o)),255*(1-Math.min(1,n*(1-o)+o))]},i.xyz.rgb=function(e){var t,r,n,o=e[0]/100,a=e[1]/100,i=e[2]/100;return r=-.9689*o+1.8758*a+.0415*i,n=.0557*o+-.204*a+1.057*i,t=(t=3.2406*o+-1.5372*a+-.4986*i)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,[255*(t=Math.min(Math.max(0,t),1)),255*(r=Math.min(Math.max(0,r),1)),255*(n=Math.min(Math.max(0,n),1))]},i.xyz.lab=function(e){var t=e[0],r=e[1],n=e[2];return r/=100,n/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(t-r),200*(r-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]},i.lab.xyz=function(e){var t,r,n,o=e[0];t=e[1]/500+(r=(o+16)/116),n=r-e[2]/200;var a=Math.pow(r,3),i=Math.pow(t,3),l=Math.pow(n,3);return r=a>.008856?a:(r-16/116)/7.787,t=i>.008856?i:(t-16/116)/7.787,n=l>.008856?l:(n-16/116)/7.787,[t*=95.047,r*=100,n*=108.883]},i.lab.lch=function(e){var t,r=e[0],n=e[1],o=e[2];return(t=360*Math.atan2(o,n)/2/Math.PI)<0&&(t+=360),[r,Math.sqrt(n*n+o*o),t]},i.lch.lab=function(e){var t,r=e[0],n=e[1];return t=e[2]/360*2*Math.PI,[r,n*Math.cos(t),n*Math.sin(t)]},i.rgb.ansi16=function(e){var t=e[0],r=e[1],n=e[2],o=1 in arguments?arguments[1]:i.rgb.hsv(e)[2];if(0===(o=Math.round(o/50)))return 30;var a=30+(Math.round(n/255)<<2|Math.round(r/255)<<1|Math.round(t/255));return 2===o&&(a+=60),a},i.hsv.ansi16=function(e){return i.rgb.ansi16(i.hsv.rgb(e),e[2])},i.rgb.ansi256=function(e){var t=e[0],r=e[1],n=e[2];return t===r&&r===n?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5)},i.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var r=.5*(1+~~(e>50));return[(1&t)*r*255,(t>>1&1)*r*255,(t>>2&1)*r*255]},i.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var r;return e-=16,[Math.floor(e/36)/5*255,Math.floor((r=e%36)/6)/5*255,r%6/5*255]},i.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},i.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var r=t[0];3===t[0].length&&(r=r.split("").map((function(e){return e+e})).join(""));var n=parseInt(r,16);return[n>>16&255,n>>8&255,255&n]},i.rgb.hcg=function(e){var t,r=e[0]/255,n=e[1]/255,o=e[2]/255,a=Math.max(Math.max(r,n),o),i=Math.min(Math.min(r,n),o),l=a-i;return t=l<=0?0:a===r?(n-o)/l%6:a===n?2+(o-r)/l:4+(r-n)/l+4,t/=6,[360*(t%=1),100*l,100*(l<1?i/(1-l):0)]},i.hsl.hcg=function(e){var t,r=e[1]/100,n=e[2]/100,o=0;return(t=n<.5?2*r*n:2*r*(1-n))<1&&(o=(n-.5*t)/(1-t)),[e[0],100*t,100*o]},i.hsv.hcg=function(e){var t=e[1]/100,r=e[2]/100,n=t*r,o=0;return n<1&&(o=(r-n)/(1-n)),[e[0],100*n,100*o]},i.hcg.rgb=function(e){var t=e[0]/360,r=e[1]/100,n=e[2]/100;if(0===r)return[255*n,255*n,255*n];var o,a=[0,0,0],i=t%1*6,l=i%1,s=1-l;switch(Math.floor(i)){case 0:a[0]=1,a[1]=l,a[2]=0;break;case 1:a[0]=s,a[1]=1,a[2]=0;break;case 2:a[0]=0,a[1]=1,a[2]=l;break;case 3:a[0]=0,a[1]=s,a[2]=1;break;case 4:a[0]=l,a[1]=0,a[2]=1;break;default:a[0]=1,a[1]=0,a[2]=s}return o=(1-r)*n,[255*(r*a[0]+o),255*(r*a[1]+o),255*(r*a[2]+o)]},i.hcg.hsv=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t),n=0;return r>0&&(n=t/r),[e[0],100*n,100*r]},i.hcg.hsl=function(e){var t=e[1]/100,r=e[2]/100*(1-t)+.5*t,n=0;return r>0&&r<.5?n=t/(2*r):r>=.5&&r<1&&(n=t/(2*(1-r))),[e[0],100*n,100*r]},i.hcg.hwb=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t);return[e[0],100*(r-t),100*(1-r)]},i.hwb.hcg=function(e){var t=e[1]/100,r=1-e[2]/100,n=r-t,o=0;return n<1&&(o=(r-n)/(1-n)),[e[0],100*n,100*o]},i.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},i.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},i.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},i.gray.hsl=i.gray.hsv=function(e){return[0,0,e[0]]},i.gray.hwb=function(e){return[0,100,e[0]]},i.gray.cmyk=function(e){return[0,0,0,e[0]]},i.gray.lab=function(e){return[e[0],0,0]},i.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),r=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(r.length)+r},i.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},2085:(e,t,r)=>{var n=r(8168),o=r(4111),a={};Object.keys(n).forEach((function(e){a[e]={},Object.defineProperty(a[e],"channels",{value:n[e].channels}),Object.defineProperty(a[e],"labels",{value:n[e].labels});var t=o(e);Object.keys(t).forEach((function(r){var n=t[r];a[e][r]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var r=e(t);if("object"==typeof r)for(var n=r.length,o=0;o<n;o++)r[o]=Math.round(r[o]);return r};return"conversion"in e&&(t.conversion=e.conversion),t}(n),a[e][r].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(n)}))})),e.exports=a},4111:(e,t,r)=>{var n=r(8168);function o(e,t){return function(r){return t(e(r))}}function a(e,t){for(var r=[t[e].parent,e],a=n[t[e].parent][e],i=t[e].parent;t[i].parent;)r.unshift(t[i].parent),a=o(n[t[i].parent][i],a),i=t[i].parent;return a.conversion=r,a}e.exports=function(e){for(var t=function(e){var t=function(){for(var e={},t=Object.keys(n),r=t.length,o=0;o<r;o++)e[t[o]]={distance:-1,parent:null};return e}(),r=[e];for(t[e].distance=0;r.length;)for(var o=r.pop(),a=Object.keys(n[o]),i=a.length,l=0;l<i;l++){var s=a[l],c=t[s];-1===c.distance&&(c.distance=t[o].distance+1,c.parent=o,r.unshift(s))}return t}(e),r={},o=Object.keys(t),i=o.length,l=0;l<i;l++){var s=o[l];null!==t[s].parent&&(r[s]=a(s,t))}return r}},8874:e=>{"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},9818:(e,t,r)=>{var n=r(8874),o=r(6851),a={};for(var i in n)n.hasOwnProperty(i)&&(a[n[i]]=i);var l=e.exports={to:{},get:{}};function s(e,t,r){return Math.min(Math.max(t,e),r)}function c(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}l.get=function(e){var t,r;switch(e.substring(0,3).toLowerCase()){case"hsl":t=l.get.hsl(e),r="hsl";break;case"hwb":t=l.get.hwb(e),r="hwb";break;default:t=l.get.rgb(e),r="rgb"}return t?{model:r,value:t}:null},l.get.rgb=function(e){if(!e)return null;var t,r,o,a=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(o=t[2],t=t[1],r=0;r<3;r++){var i=2*r;a[r]=parseInt(t.slice(i,i+2),16)}o&&(a[3]=parseInt(o,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(o=(t=t[1])[3],r=0;r<3;r++)a[r]=parseInt(t[r]+t[r],16);o&&(a[3]=parseInt(o+o,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(r=0;r<3;r++)a[r]=parseInt(t[r+1],0);t[4]&&(a[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(a=n[t[1]])?(a[3]=1,a):null:null;for(r=0;r<3;r++)a[r]=Math.round(2.55*parseFloat(t[r+1]));t[4]&&(a[3]=parseFloat(t[4]))}for(r=0;r<3;r++)a[r]=s(a[r],0,255);return a[3]=s(a[3],0,1),a},l.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var r=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,s(parseFloat(t[2]),0,100),s(parseFloat(t[3]),0,100),s(isNaN(r)?1:r,0,1)]}return null},l.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var r=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,s(parseFloat(t[2]),0,100),s(parseFloat(t[3]),0,100),s(isNaN(r)?1:r,0,1)]}return null},l.to.hex=function(){var e=o(arguments);return"#"+c(e[0])+c(e[1])+c(e[2])+(e[3]<1?c(Math.round(255*e[3])):"")},l.to.rgb=function(){var e=o(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},l.to.rgb.percent=function(){var e=o(arguments),t=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),n=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+r+"%, "+n+"%)":"rgba("+t+"%, "+r+"%, "+n+"%, "+e[3]+")"},l.to.hsl=function(){var e=o(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},l.to.hwb=function(){var e=o(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},l.to.keyword=function(e){return a[e.slice(0,3)]}},6767:(e,t,r)=>{"use strict";var n=r(9818),o=r(2085),a=[].slice,i=["keyword","gray","hex"],l={};Object.keys(o).forEach((function(e){l[a.call(o[e].labels).sort().join("")]=e}));var s={};function c(e,t){if(!(this instanceof c))return new c(e,t);if(t&&t in i&&(t=null),t&&!(t in o))throw new Error("Unknown model: "+t);var r,d;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof c)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var u=n.get(e);if(null===u)throw new Error("Unable to parse color from string: "+e);this.model=u.model,d=o[this.model].channels,this.color=u.value.slice(0,d),this.valpha="number"==typeof u.value[d]?u.value[d]:1}else if(e.length){this.model=t||"rgb",d=o[this.model].channels;var p=a.call(e,0,d);this.color=f(p,d),this.valpha="number"==typeof e[d]?e[d]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var m=Object.keys(e);"alpha"in e&&(m.splice(m.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var v=m.sort().join("");if(!(v in l))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=l[v];var g=o[this.model].labels,h=[];for(r=0;r<g.length;r++)h.push(e[g[r]]);this.color=f(h)}if(s[this.model])for(d=o[this.model].channels,r=0;r<d;r++){var b=s[this.model][r];b&&(this.color[r]=b(this.color[r]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function d(e,t,r){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(s[e]||(s[e]=[]))[t]=r})),e=e[0],function(n){var o;return arguments.length?(r&&(n=r(n)),(o=this[e]()).color[t]=n,o):(o=this[e]().color[t],r&&(o=r(o)),o)}}function u(e){return function(t){return Math.max(0,Math.min(e,t))}}function f(e,t){for(var r=0;r<t;r++)"number"!=typeof e[r]&&(e[r]=0);return e}c.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in n.to?this:this.rgb(),r=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return n.to[t.model](r)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),r=1===t.valpha?t.color:t.color.concat(this.valpha);return n.to.rgb.percent(r)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=o[this.model].channels,r=o[this.model].labels,n=0;n<t;n++)e[r[n]]=this.color[n];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new c(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new c(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:d("rgb",0,u(255)),green:d("rgb",1,u(255)),blue:d("rgb",2,u(255)),hue:d(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:d("hsl",1,u(100)),lightness:d("hsl",2,u(100)),saturationv:d("hsv",1,u(100)),value:d("hsv",2,u(100)),chroma:d("hcg",1,u(100)),gray:d("hcg",2,u(100)),white:d("hwb",1,u(100)),wblack:d("hwb",2,u(100)),cyan:d("cmyk",0,u(100)),magenta:d("cmyk",1,u(100)),yellow:d("cmyk",2,u(100)),black:d("cmyk",3,u(100)),x:d("xyz",0,u(100)),y:d("xyz",1,u(100)),z:d("xyz",2,u(100)),l:d("lab",0,u(100)),a:d("lab",1),b:d("lab",2),keyword:function(e){return arguments.length?new c(e):o[this.model].keyword(this.color)},hex:function(e){return arguments.length?new c(e):n.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],r=0;r<e.length;r++){var n=e[r]/255;t[r]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),r=e.luminosity();return t>r?(t+.05)/(r+.05):(r+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return c.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),r=t.color[0];return r=(r=(r+e)%360)<0?360+r:r,t.color[0]=r,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var r=e.rgb(),n=this.rgb(),o=void 0===t?.5:t,a=2*o-1,i=r.alpha()-n.alpha(),l=((a*i==-1?a:(a+i)/(1+a*i))+1)/2,s=1-l;return c.rgb(l*r.red()+s*n.red(),l*r.green()+s*n.green(),l*r.blue()+s*n.blue(),r.alpha()*o+n.alpha()*(1-o))}},Object.keys(o).forEach((function(e){if(-1===i.indexOf(e)){var t=o[e].channels;c.prototype[e]=function(){if(this.model===e)return new c(this);if(arguments.length)return new c(arguments,e);var r,n="number"==typeof arguments[t]?t:this.valpha;return new c((r=o[this.model][e].raw(this.color),Array.isArray(r)?r:[r]).concat(n),e)},c[e]=function(r){return"number"==typeof r&&(r=f(a.call(arguments),t)),new c(r,e)}}})),e.exports=c},5171:e=>{e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},6851:(e,t,r)=>{"use strict";var n=r(5171),o=Array.prototype.concat,a=Array.prototype.slice,i=e.exports=function(e){for(var t=[],r=0,i=e.length;r<i;r++){var l=e[r];n(l)?t=o.call(t,a.call(l)):t.push(l)}return t};i.wrap=function(e){return function(){return e(i(arguments))}}},5511:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertEntity=t.toggleCode=t.setParagraphMargin=t.adjustImageSelection=t.setImageAltText=t.adjustLinkSelection=t.removeLink=t.insertLink=t.clearFormat=t.getFormatState=t.changeImage=t.setImageBoxShadow=t.setImageBorder=t.setSpacing=t.toggleBlockQuote=t.setHeadingLevel=t.setDirection=t.setAlignment=t.setIndentation=t.hasSelectionInBlockGroup=t.hasSelectionInSegment=t.hasSelectionInBlock=t.setListStartNumber=t.setListStyle=t.insertImage=t.changeCapitalization=t.applySegmentFormat=t.changeFontSize=t.setTextColor=t.setFontSize=t.setFontName=t.setBackgroundColor=t.toggleSuperscript=t.toggleSubscript=t.toggleStrikethrough=t.toggleUnderline=t.toggleItalic=t.toggleBold=t.toggleNumbering=t.toggleBullet=t.applyTableBorderFormat=t.editTable=t.setTableCellShade=t.formatTable=t.insertTable=void 0;var n=r(9743);Object.defineProperty(t,"insertTable",{enumerable:!0,get:function(){return n.default}});var o=r(7841);Object.defineProperty(t,"formatTable",{enumerable:!0,get:function(){return o.default}});var a=r(5265);Object.defineProperty(t,"setTableCellShade",{enumerable:!0,get:function(){return a.default}});var i=r(4997);Object.defineProperty(t,"editTable",{enumerable:!0,get:function(){return i.default}});var l=r(3503);Object.defineProperty(t,"applyTableBorderFormat",{enumerable:!0,get:function(){return l.default}});var s=r(3879);Object.defineProperty(t,"toggleBullet",{enumerable:!0,get:function(){return s.default}});var c=r(5387);Object.defineProperty(t,"toggleNumbering",{enumerable:!0,get:function(){return c.default}});var d=r(985);Object.defineProperty(t,"toggleBold",{enumerable:!0,get:function(){return d.default}});var u=r(6589);Object.defineProperty(t,"toggleItalic",{enumerable:!0,get:function(){return u.default}});var f=r(9997);Object.defineProperty(t,"toggleUnderline",{enumerable:!0,get:function(){return f.default}});var p=r(6668);Object.defineProperty(t,"toggleStrikethrough",{enumerable:!0,get:function(){return p.default}});var m=r(7636);Object.defineProperty(t,"toggleSubscript",{enumerable:!0,get:function(){return m.default}});var v=r(2634);Object.defineProperty(t,"toggleSuperscript",{enumerable:!0,get:function(){return v.default}});var g=r(4402);Object.defineProperty(t,"setBackgroundColor",{enumerable:!0,get:function(){return g.default}});var h=r(5215);Object.defineProperty(t,"setFontName",{enumerable:!0,get:function(){return h.default}});var b=r(5130);Object.defineProperty(t,"setFontSize",{enumerable:!0,get:function(){return b.default}});var y=r(9945);Object.defineProperty(t,"setTextColor",{enumerable:!0,get:function(){return y.default}});var C=r(4969);Object.defineProperty(t,"changeFontSize",{enumerable:!0,get:function(){return C.default}});var S=r(7376);Object.defineProperty(t,"applySegmentFormat",{enumerable:!0,get:function(){return S.default}});var _=r(6452);Object.defineProperty(t,"changeCapitalization",{enumerable:!0,get:function(){return _.default}});var k=r(2051);Object.defineProperty(t,"insertImage",{enumerable:!0,get:function(){return k.default}});var P=r(4898);Object.defineProperty(t,"setListStyle",{enumerable:!0,get:function(){return P.default}});var w=r(1045);Object.defineProperty(t,"setListStartNumber",{enumerable:!0,get:function(){return w.default}});var M=r(496);Object.defineProperty(t,"hasSelectionInBlock",{enumerable:!0,get:function(){return M.default}});var E=r(3766);Object.defineProperty(t,"hasSelectionInSegment",{enumerable:!0,get:function(){return E.default}});var O=r(8629);Object.defineProperty(t,"hasSelectionInBlockGroup",{enumerable:!0,get:function(){return O.default}});var T=r(584);Object.defineProperty(t,"setIndentation",{enumerable:!0,get:function(){return T.default}});var F=r(6633);Object.defineProperty(t,"setAlignment",{enumerable:!0,get:function(){return F.default}});var x=r(3838);Object.defineProperty(t,"setDirection",{enumerable:!0,get:function(){return x.default}});var D=r(8086);Object.defineProperty(t,"setHeadingLevel",{enumerable:!0,get:function(){return D.default}});var j=r(7459);Object.defineProperty(t,"toggleBlockQuote",{enumerable:!0,get:function(){return j.default}});var B=r(2579);Object.defineProperty(t,"setSpacing",{enumerable:!0,get:function(){return B.default}});var A=r(2233);Object.defineProperty(t,"setImageBorder",{enumerable:!0,get:function(){return A.default}});var L=r(9423);Object.defineProperty(t,"setImageBoxShadow",{enumerable:!0,get:function(){return L.default}});var N=r(1422);Object.defineProperty(t,"changeImage",{enumerable:!0,get:function(){return N.default}});var R=r(2283);Object.defineProperty(t,"getFormatState",{enumerable:!0,get:function(){return R.default}});var I=r(4822);Object.defineProperty(t,"clearFormat",{enumerable:!0,get:function(){return I.default}});var H=r(90);Object.defineProperty(t,"insertLink",{enumerable:!0,get:function(){return H.default}});var z=r(4040);Object.defineProperty(t,"removeLink",{enumerable:!0,get:function(){return z.default}});var W=r(4315);Object.defineProperty(t,"adjustLinkSelection",{enumerable:!0,get:function(){return W.default}});var G=r(1431);Object.defineProperty(t,"setImageAltText",{enumerable:!0,get:function(){return G.default}});var U=r(4701);Object.defineProperty(t,"adjustImageSelection",{enumerable:!0,get:function(){return U.default}});var K=r(3471);Object.defineProperty(t,"setParagraphMargin",{enumerable:!0,get:function(){return K.default}});var V=r(7402);Object.defineProperty(t,"toggleCode",{enumerable:!0,get:function(){return V.default}});var q=r(1331);Object.defineProperty(t,"insertEntity",{enumerable:!0,get:function(){return q.default}})},5329:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setModelAlignment=void 0;var n=r(7854),o=r(79),a={left:{ltr:"start",rtl:"end"},center:{ltr:"center",rtl:"center"},right:{ltr:"end",rtl:"start"}},i={left:{ltr:"alignLeft",rtl:"alignRight"},center:{ltr:"alignCenter",rtl:"alignCenter"},right:{ltr:"alignRight",rtl:"alignLeft"}};t.setModelAlignment=function(e,t){var r=(0,o.getOperationalBlocks)(e,["ListItem"],["TableCell"]);return r.forEach((function(e){var r=e.block,o=a[t]["rtl"==r.format.direction?"rtl":"ltr"];"Table"===r.blockType?(0,n.alignTable)(r,i[t]["rtl"==r.format.direction?"rtl":"ltr"]):r&&(r.format.textAlign=o)})),r.length>0}},6483:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setModelDirection=void 0;var n=r(5825),o=r(79);function a(e,t){if("rtl"==e.direction!=("rtl"==t)){e.direction=t;var r=e.marginLeft,n=e.paddingLeft;i(e,"marginLeft",e.marginRight),i(e,"marginRight",r),i(e,"paddingLeft",e.paddingRight),i(e,"paddingRight",n)}}function i(e,t,r){r?e[t]=r:delete e[t]}t.setModelDirection=function(e,t){var r=(0,o.getOperationalBlocks)(e,["ListItem"],["TableCell"]);return r.forEach((function(r){var i=r.block;(0,o.isBlockGroupOfType)(i,"ListItem")?(0,n.findListItemsInSameThread)(e,i).forEach((function(e){e.levels.forEach((function(e){e.format.direction=t})),e.blocks.forEach((function(e){return a(e.format,t)}))})):i&&a(i.format,t)})),r.length>0}},6892:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setModelIndentation=void 0;var n=r(1246),o=r(79);t.setModelIndentation=function(e,t,r){void 0===r&&(r=40);var a=(0,o.getOperationalBlocks)(e,["ListItem"],["TableCell"]),i="indent"==t;return a.forEach((function(e){var t=e.block;if((0,o.isBlockGroupOfType)(t,"ListItem"))if(i){var a=t.levels[t.levels.length-1],l=(0,n.createListLevel)((null==a?void 0:a.listType)||"UL",null==a?void 0:a.format);delete l.format.startNumberOverride,t.levels.push(l)}else t.levels.pop();else if(t){var s=t.format,c=s.marginLeft,d=s.marginRight,u="rtl"==s.direction,f=(0,n.parseValueWithUnit)(u?d:c),p=(i?Math.ceil:Math.floor)(f/r)*r;p==f&&(p=Math.max(p+r*(i?1:-1),0)),u?s.marginRight=p+"px":s.marginLeft=p+"px"}})),a.length>0}},159:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleModelBlockQuote=void 0;var n=r(1246),o=r(79),a=r(4324);function i(e){return(0,o.isBlockGroupOfType)(e,"FormatContainer")&&"blockquote"==e.tagName}t.toggleModelBlockQuote=function(e,t){var r=(0,o.getOperationalBlocks)(e,["FormatContainer","ListItem"],["TableCell"],!0);if(r.every((function(e){return i(e.block)})))r.forEach((function(e){var t=e.block,r=e.parent;(0,n.unwrapBlock)(r,t)}));else{var l=[],s=function(){return(0,n.createFormatContainer)("blockquote",t)},c=function(e,r){return function(e,t){return i(e)&&(0,n.areSameFormats)(t,e.format)}(e,(null==r?void 0:r.format)||t)};r.forEach((function(e){var t=e.block,r=e.parent;i(t)||(0,a.wrapBlockStep1)(l,r,t,s,c)})),(0,a.wrapBlockStep2)(l,c)}return r.length>0}},8684:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearModelFormat=void 0;var n=r(7582),o=r(8894),a=r(1246),i=r(79);function l(e,t){var r=(0,i.getClosestAncestorBlockGroupIndex)(e,["FormatContainer"],["TableCell"]);if(r>=0&&r<e.length-1){var n=e[r],o=e[r+1].blocks.indexOf(n),l=n.blocks.indexOf(t);if(l>=0&&o>=0){var s=(0,a.createFormatContainer)(n.tagName,n.format);n.blocks.splice(l,1),s.blocks=n.blocks.splice(l),e[r+1].blocks.splice(o+1,0,t,s)}}}function s(e){var t=e[(0,i.getClosestAncestorBlockGroupIndex)(e,["ListItem"],["TableCell"])];t&&(t.levels=[])}function c(e,t){if("Divider"==t.blockType){var r=e[0].blocks.indexOf(t);r>=0&&e[0].blocks.splice(r,1)}else"Paragraph"==t.blockType&&(t.format={},delete t.decorator)}t.clearModelFormat=function(e,t,r,a){(0,i.iterateSelections)(e,(function(e,o,l,s){s&&r.push.apply(r,(0,n.__spreadArray)([],(0,n.__read)(s),!1)),l?t.push([e,l]):o&&function(e,t){if(e){var r=e.table,n=e.colIndex,o=e.rowIndex,a=e.isWholeTableSelected,l=r.rows[o].cells[n];l.isSelected&&((0,i.updateTableCellMetadata)(l,(function(){return null})),l.isHeader=!1,l.format={useBorderBox:l.format.useBorderBox}),t.find((function(e){return e[0]==r}))||t.push([r,a])}}(o,a)}),{includeListFormatHolder:e.format?"never":"anySegment"});var d=r[0];if(1==t.length&&function(e){var t="Paragraph"==e.blockType?e.segments.filter((function(e){return e.isSelected})):[];return 1==t.length&&"SelectionMarker"==t[0].segmentType}(t[0][1])&&1==t.length)r.splice.apply(r,(0,n.__spreadArray)([0,r.length],(0,n.__read)((0,o.adjustWordSelection)(e,d)),!1)),s(t[0][0]);else if(t.length>1||t.some((function(e){return function(e){return e.isSelected||"Paragraph"==e.blockType&&e.segments.every((function(e){return e.isSelected}))}(e[1])})))for(var u=t.length-1;u>=0;u--){var f=(0,n.__read)(t[u],2),p=f[0],m=f[1];c(p,m),s(p),l(p,m)}!function(e,t){e.forEach((function(e){e.format=(0,n.__assign)({},t||{}),e.link&&delete e.link.format.textColor,delete e.code}))}(r,e.format),function(e){e.forEach((function(e){var t=(0,n.__read)(e,2),r=t[0];t[1]&&(r.format={useBorderBox:r.format.useBorderBox,borderCollapse:r.format.borderCollapse},(0,i.updateTableMetadata)(r,(function(){return null}))),(0,i.applyTableFormat)(r,void 0,!0)}))}(a)}},6515:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveModelFormatState=void 0;var n=r(79);function o(e,t,r,n){n?void 0!==r&&(e[t]=r):r!==e[t]&&delete e[t]}t.retrieveModelFormatState=function(e,t,r){var a,i,l,s=!0,c=!0,d=!0;(0,n.iterateSelections)(e,(function(l,u,f,p){if(function(e,t,r){var a,i,l=(0,n.getClosestAncestorBlockGroupIndex)(t,["ListItem"],[]),s=(0,n.getClosestAncestorBlockGroupIndex)(t,["FormatContainer"],[]);if(l>=0){var c=t[l],d=null===(a=null==c?void 0:c.levels[c.levels.length-1])||void 0===a?void 0:a.listType;o(e,"isBullet","UL"==d,r),o(e,"isNumbering","OL"==d,r)}o(e,"isBlockQuote",s>=0&&"blockquote"==(null===(i=t[s])||void 0===i?void 0:i.tagName),r)}(r,l,s),f&&(i?r.isMultilineSelection=!0:i=f),"Paragraph"==(null==f?void 0:f.blockType)&&(function(e,t,r){var n,a=parseInt(((null===(n=t.decorator)||void 0===n?void 0:n.tagName)||"").substring(1)),i=a>=1&&a<=6?a:void 0;o(e,"marginBottom",t.format.marginBottom,r),o(e,"marginTop",t.format.marginTop,r),o(e,"headingLevel",i,r),o(e,"textAlign",t.format.textAlign,r),o(e,"direction",t.format.direction,r)}(r,f,s),null==p||p.forEach((function(a){var i,l,u,m,v,g,h,b,y;if(d||"SelectionMarker"!=a.segmentType){var C=Object.assign({},e.format);null==C||delete C.italic,null==C||delete C.underline,null==C||delete C.fontWeight,function(e,t,r){var a,i,l=null===(i=null===(a=r.superOrSubScriptSequence)||void 0===a?void 0:a.split(" "))||void 0===i?void 0:i.pop();o(e,"isBold",(0,n.isBold)(r.fontWeight),t),o(e,"isItalic",r.italic,t),o(e,"isUnderline",r.underline,t),o(e,"isStrikeThrough",r.strikethrough,t),o(e,"isSuperscript","super"==l,t),o(e,"isSubscript","sub"==l,t),o(e,"letterSpacing",r.letterSpacing,t),o(e,"fontName",r.fontFamily,t),o(e,"fontSize",r.fontSize,t),o(e,"backgroundColor",r.backgroundColor,t),o(e,"textColor",r.textColor,t),o(e,"fontWeight",r.fontWeight,t),o(e,"lineHeight",r.lineHeight,t)}(r,s,Object.assign({},C,f.format,null===(i=f.decorator)||void 0===i?void 0:i.format,a.format,null===(l=a.code)||void 0===l?void 0:l.format,null===(u=a.link)||void 0===u?void 0:u.format,t)),o(r,"isCodeInline",!!(null==a?void 0:a.code),s)}d=!1,r.canUnlink=r.canUnlink||!!a.link,r.canAddImageAltText=r.canAddImageAltText||p.some((function(e){return"Image"==e.segmentType})),s=!1,"Image"===a.segmentType&&(c?(m=r,v=a.format,"borderTop",h=(g=(0,n.extractBorderValues)(v.borderTop)).color,b=g.width,y=g.style,m.imageFormat={borderColor:h,borderWidth:b,borderStyle:y,boxShadow:v.boxShadow,borderRadius:v.borderRadius},c=!1):r.imageFormat=void 0)})),s=!1),u)if(a){var m=a.table,v=a.colIndex,g=a.rowIndex;u.table!=m||u.colIndex==v&&u.rowIndex==g||(r.canMergeTableCell=!0,r.isMultilineSelection=!0)}else!function(e,t){var r=(0,n.updateTableMetadata)(e.table);t.isInTable=!0,t.tableHasHeader=e.table.rows.some((function(e){return e.cells.some((function(e){return e.isHeader}))})),r&&(t.tableFormat=r)}(u,r),a=u}),{includeListFormatHolder:"never"}),r.fontSize&&(r.fontSize=(l=r.fontSize)&&l.indexOf("px")==l.length-2?Math.round(75*parseFloat(l)+.05)/100+"pt":l)}},4324:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapBlockStep2=t.wrapBlockStep1=void 0;var n=r(7582),o=r(1246);t.wrapBlockStep1=function(e,t,r,n,a){var i,l=null!==(i=null==t?void 0:t.blocks.indexOf(r))&&void 0!==i?i:-1;if(t&&l>=0){t.blocks.splice(l,1);var s=t.blocks[l-1],c=a(s)?s:function(e,t,r){var n=r();return e.blocks.splice(t,0,n),n}(t,l,n);(0,o.setParagraphNotImplicit)(r),(0,o.addBlock)(c,r),e.unshift({parent:t,wrapper:c})}},t.wrapBlockStep2=function(e,t){e.forEach((function(e){var r,a=e.parent,i=e.wrapper,l=a.blocks.indexOf(i),s=a.blocks[l+1];l>=0&&t(s,i)&&(i.blocks.forEach(o.setParagraphNotImplicit),(r=i.blocks).push.apply(r,(0,n.__spreadArray)([],(0,n.__read)(s.blocks),!1)),a.blocks.splice(l+1,1))}))}},2589:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readFile=void 0,t.readFile=function(e,t){if(e){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=function(){t(null)},r.readAsDataURL(e)}}},2504:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertEntityModel=void 0;var n=r(7582),o=r(79),a=r(1246);t.insertEntityModel=function(e,t,r,i,l,s){var c,d,u,f,p=-1;if("begin"==r||"end"==r)u=e,p="begin"==r?0:e.blocks.length;else if((f=(0,o.deleteSelection)(e,[],s)).insertPoint){var m=f.insertPoint,v=m.marker,g=m.paragraph,h=m.path;if("range"==f.deleteResult&&(0,a.normalizeContentModel)(e),i){var b="root"==r?(0,o.getClosestAncestorBlockGroupIndex)(h,["TableCell","Document"]):0;u=h[b];var y=h[b-1],C="FormatContainer"==(null==y?void 0:y.blockGroupType)||"General"==(null==y?void 0:y.blockGroupType)||"ListItem"==(null==y?void 0:y.blockGroupType)?y:g,S=u.blocks.indexOf(C);p=S>=0?S+1:-1}else{var _=g.segments.indexOf(v);_>=0&&g.segments.splice(l?_:_+1,0,t)}}if(p>=0&&u){var k=[],P=void 0;if(i){var w=u.blocks[p];k.push(t),"Paragraph"==(null==w?void 0:w.blockType)?P=w:w&&"Entity"!=w.blockType&&!l||((P=(0,a.createParagraph)(!1,{},e.format)).segments.push((0,a.createBr)(e.format)),k.push(P))}else(P=(0,a.createParagraph)(!1,void 0,e.format)).segments.push(t),k.push(P);if((c=u.blocks).splice.apply(c,(0,n.__spreadArray)([p,0],(0,n.__read)(k),!1)),l&&P){v=(0,a.createSelectionMarker)((null===(d=P.segments[0])||void 0===d?void 0:d.format)||e.format);var M=P.segments;i?M.unshift(v):M.push(v),(0,o.setSelection)(e,v,v)}}}},3481:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(79),o=r(1246);t.default=function(e,t,r){if(t){var a=e.format,i=t.width,l=t.style,s=t.color,c=(0,n.extractBorderValues)(a.borderTop),d=c.color,u=c.width,f=c.style,p="";p=i?(0,o.parseValueWithUnit)(i)+"px":u||"1px",l?p=p+" "+l:f?p=p+" "+f:p+=" solid",s?p=p+" "+s:d&&(p=p+" "+d),e.format.borderLeft=p,e.format.borderTop=p,e.format.borderBottom=p,e.format.borderRight=p}else delete e.format.borderLeft,delete e.format.borderTop,delete e.format.borderBottom,delete e.format.borderRight;r&&(e.format.borderRadius=r)}},5825:(e,t)=>{"use strict";function r(e,t){e.blocks.forEach((function(e){switch(e.blockType){case"BlockGroup":"ListItem"==e.blockGroupType?t.push(e):(n(t),r(e,t),n(t));break;case"Paragraph":n(t),e.segments.forEach((function(e){"General"==e.segmentType&&r(e,t)})),n(t);break;case"Table":n(t),e.rows.forEach((function(e){return e.cells.forEach((function(e){r(e,t)}))})),n(t)}}))}function n(e){var t=e[e.length-1];t&&null===t||e.push(null)}function o(e,t,r){var n=e[t].levels,o=e[r].levels;return n.length<=o.length&&n.every((function(e,t){return e.listType==o[t].listType}))}function a(e,t){return e.levels.slice(0,t).some((function(e){return void 0!==e.format.startNumberOverride}))}Object.defineProperty(t,"__esModule",{value:!0}),t.findListItemsInSameThread=void 0,t.findListItemsInSameThread=function(e,t){var n=[];return r(e,n),function(e,t){var r,n=[],i=e.indexOf(t),l=t.levels.length,s="OL"==(null===(r=t.levels[l-1])||void 0===r?void 0:r.listType);if(i>=0){for(var c=i;c>=0;c--){if(!(u=e[c])){if(s)continue;break}var d=a(u,l);if(o(e,i,c)){if(n.unshift(u),s&&d)break}else if(!s||d)break}for(c=i+1;c<e.length;c++){var u;if(!(u=e[c])){if(s)continue;break}if(d=a(u,l),o(e,i,c)&&!d)n.push(u);else if(!s||d)break}}return n}(n,t)}},3632:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setListType=void 0;var n=r(79),o=r(1246);function a(e){switch(e.blockType){case"Table":return!1;case"Paragraph":return e.segments.every((function(e){return"Br"==e.segmentType||"SelectionMarker"==e.segmentType}));default:return!0}}t.setListType=function(e,t){var r=(0,n.getOperationalBlocks)(e,["ListItem"],[]),i=r.every((function(e){var r,o=e.block;return(0,n.isBlockGroupOfType)(o,"ListItem")?(null===(r=o.levels[o.levels.length-1])||void 0===r?void 0:r.listType)==t:a(o)})),l=[],s=!1;return r.forEach((function(e,c){var d,u,f=e.block,p=e.parent;if((0,n.isBlockGroupOfType)(f,"ListItem")){var m=f.levels.pop();!i&&m?(m.listType=t,f.levels.push(m)):1==f.blocks.length&&(0,o.setParagraphNotImplicit)(f.blocks[0])}else{var v=p.blocks.indexOf(f);if(v>=0)if(1!=r.length&&a(f))s=!0,l.forEach((function(e){return e.levels[0].format.marginBottom="0"})),l=[];else{var g=p.blocks[v-1],h="Paragraph"==f.blockType&&(null===(d=f.segments[0])||void 0===d?void 0:d.format)||{},b=(0,o.createListItem)([(0,o.createListLevel)(t,{startNumberOverride:c>0||"BlockGroup"==(null==g?void 0:g.blockType)&&"ListItem"==g.blockGroupType&&"OL"==(null===(u=g.levels[0])||void 0===u?void 0:u.listType)?void 0:1,direction:f.format.direction,textAlign:f.format.textAlign,marginTop:s?"0":void 0,marginBlockEnd:"0px",marginBlockStart:"0px"})],{fontFamily:h.fontFamily,fontSize:h.fontSize,textColor:h.textColor});"Paragraph"==f.blockType&&(f.isImplicit=!0),b.blocks.push(f),p.blocks.splice(v,1,b),l.push(b)}}})),(0,o.normalizeContentModel)(e),r.length>0}},1560:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustSegmentSelection=void 0;var n=r(79);t.adjustSegmentSelection=function(e,t,r){var o,a,i=(0,n.getSelectedParagraphs)(e),l=!1;return i.forEach((function(e){var n=o?0:e.segments.findIndex((function(e){return t(e)})),i=e.segments;if(!o){o=i[n];for(var s=n;s>0;s--){if(!r(i[s-1],o)){l=l||!!i[s-1].isSelected;break}o=i[s-1],l=l||!i[s-1].isSelected}}if(o)for(s=n;s<e.segments.length;s++){if(s!=n&&!r(i[s],a||i[n])){l=l||!!i[s].isSelected;break}a=i[s],l=l||!i[s].isSelected}})),o&&a&&(0,n.setSelection)(e,o,a),l}},8894:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustWordSelection=void 0;var n=r(7582),o=r(1246),a=r(79);function i(e,t){var r=e.text,n=-1;if(t)for(var o=0;o<r.length;o++){var i=r[o];if((0,a.isPunctuation)(i)||(0,a.isSpace)(i)){n=o;break}}else for(o=r.length-1;o>=0;o--)if(i=r[o],(0,a.isPunctuation)(i)||(0,a.isSpace)(i)){n=o+1;break}return n}function l(e,t,r,n){var a=t.text,i=(0,o.createText)(a.substring(0,n),t.format,t.link,t.code),l=(0,o.createText)(a.substring(n,a.length),t.format,t.link,t.code);e.splice(r,1,i,l)}t.adjustWordSelection=function(e,t){var r;(0,a.iterateSelections)(e,(function(e,n,o,a){return"Paragraph"==(null==o?void 0:o.blockType)&&1==(null==a?void 0:a.length)&&a[0]==t&&(r=o),!0}));var o=r?(0,n.__spreadArray)([],(0,n.__read)(r.segments),!1):void 0;if(o&&r){for(var s=[],c=o.indexOf(t),d=c-1;d>=0&&"Text"==(u=o[d]).segmentType;d--){if((f=i(u,!1))>-1){if(f==u.text.length)break;l(o,u,d,f),s.push(o[d+1]);break}s.push(o[d])}if(c=o.indexOf(t),s.push(t),s.length<=1)return s;for(d=c+1;d<o.length;d++){var u,f;if("Text"!=(u=o[d]).segmentType)break;if((f=i(u,!0))>-1){if(0==f)break;l(o,u,d,f),s.push(o[d]);break}s.push(o[d])}return s[s.length-1]==t?[t]:(r.segments=o,s)}return[t]}},2185:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collapseTableSelection=void 0;var n=r(1246);t.collapseTableSelection=function(e,t){var r,o=t.firstCol,a=null===(r=e[t.firstRow])||void 0===r?void 0:r.cells[o];a&&(0,n.addSegment)(a,(0,n.createSelectionMarker)())}},7854:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.alignTable=void 0,t.alignTable=function(e,t){e.format.marginLeft="alignLeft"==t?"":"auto",e.format.marginRight="alignRight"==t?"":"auto",delete e.cachedElement}},2793:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.alignTableCellVertically=t.alignTableCellHorizontally=void 0;var n=r(1758),o=r(79),a={alignCellLeft:"start",alignCellCenter:"center",alignCellRight:"end"},i={alignCellTop:"top",alignCellMiddle:"middle",alignCellBottom:"bottom"};function l(e,t){var r,o=(0,n.getSelectedCells)(e);if(o)for(var a=o.firstRow;a<=o.lastRow;a++)for(var i=o.firstCol;i<=o.lastCol;i++){var l=null===(r=e.rows[a])||void 0===r?void 0:r.cells[i];(null==l?void 0:l.format)&&(delete l.cachedElement,t(l),l.blocks.forEach((function(e){"Paragraph"===e.blockType&&delete e.format.textAlign})))}}t.alignTableCellHorizontally=function(e,t){l(e,(function(e){e.format.textAlign=a[t]}))},t.alignTableCellVertically=function(e,t){l(e,(function(e){e.format.verticalAlign=i[t],(0,o.updateTableCellMetadata)(e,(function(e){return(e=e||{}).vAlignOverride=!0,e}))}))}},5553:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canMergeCells=void 0,t.canMergeCells=function(e,t,r,n,o){var a=r==o||e[t].cells.every((function(e,t){return t<r||t>o||!e.spanAbove})),i=t==n||e.every((function(e,o){return o<t||o>n||!e.cells[r].spanLeft})),l=e[n].cells.map((function(t,a){return a>=r&&a<=o?function(e,t,r){for(var n,o,a=0,i=t+1;i<e.length&&(null===(o=null===(n=e[i])||void 0===n?void 0:n.cells[r])||void 0===o?void 0:o.spanAbove);i++)a++;return a}(e,n,a):-1})).every((function(e,t,n){return e<0||e==n[r]})),s=e.map((function(r,a){return a>=t&&a<=n?function(e,t,r){for(var n,o,a,i=0,l=r+1;l<(null===(n=e[t])||void 0===n?void 0:n.cells.length)&&(null===(a=null===(o=e[t])||void 0===o?void 0:o.cells[l])||void 0===a?void 0:a.spanLeft);l++)i++;return i}(e,a,o):-1})).every((function(e,r,n){return e<0||e==n[t]}));return a&&i&&l&&s}},5827:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTableStructure=void 0;var n=r(1246);t.createTableStructure=function(e,t,r){var o=(0,n.createTable)(r);return(0,n.addBlock)(e,o),o.rows.forEach((function(e){for(var r=0;r<t;r++){var o=(0,n.createTableCell)();e.cells.push(o)}})),o}},3245:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTable=void 0,t.deleteTable=function(e){e.rows=[],delete e.cachedElement}},1247:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTableColumn=void 0;var n=r(2185),o=r(1758);t.deleteTableColumn=function(e){var t=(0,o.getSelectedCells)(e);if(t){for(var r=0;r<e.rows.length;r++){var a=e.rows[r].cells[t.lastCol+1];a&&(a.spanLeft=a.spanLeft&&e.rows[r].cells[t.firstCol].spanLeft),e.rows[r].cells.splice(t.firstCol,t.lastCol-t.firstCol+1)}e.widths.splice(t.firstCol,t.lastCol-t.firstCol+1),(0,n.collapseTableSelection)(e.rows,t)}}},3283:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTableRow=void 0;var n=r(2185),o=r(1758);t.deleteTableRow=function(e){var t=(0,o.getSelectedCells)(e);t&&(e.rows[t.firstRow].cells.forEach((function(r,n){var o,a=null===(o=e.rows[t.lastRow+1])||void 0===o?void 0:o.cells[n];a&&(a.spanAbove=a.spanAbove&&r.spanAbove)})),e.rows.splice(t.firstRow,t.lastRow-t.firstRow+1),(0,n.collapseTableSelection)(e.rows,t))}},1055:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureFocusableParagraphForTable=void 0;var n=r(1246);function o(e){var t=(0,n.createParagraph)(!1,void 0,e.format),r=(0,n.createBr)(e.format);return t.segments.push(r),t}t.ensureFocusableParagraphForTable=function(e,t,r){var n,a,i,l=null===(n=r.rows.filter((function(e){return e.cells.length>0}))[0])||void 0===n?void 0:n.cells[0];if(l)(i=l.blocks.filter((function(e){return"Paragraph"==e.blockType}))[0])||(i=o(e),l.blocks.push(i));else{var s,c=r;for(i=o(e);s=t.shift();){var d=null!==(a=s.blocks.indexOf(c))&&void 0!==a?a:-1;if(s&&d>=0&&s.blocks.splice(d,1,i),"FormatContainer"!=s.blockGroupType||1!=s.blocks.length||s.blocks[0]!=i)break;c=s}}return i}},1758:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectedCells=void 0;var n=r(8629);t.getSelectedCells=function(e){var t=-1,r=-1,o=-1,a=-1,i=!1;return e.rows.forEach((function(e,l){return e.cells.forEach((function(e,s){(0,n.default)(e)&&(i=!0,t<0&&(t=l),r<0&&(r=s),o=Math.max(o,l),a=Math.max(a,s))}))})),i?{firstRow:t,firstCol:r,lastRow:o,lastCol:a}:null}},8204:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertTableColumn=void 0;var n=r(1246),o=r(1758);t.insertTableColumn=function(e,t){var r=(0,o.getSelectedCells)(e),a="insertLeft"==t;if(r)for(var i=null==r?void 0:r.firstCol;i<=r.lastCol;i++)e.rows.forEach((function(e){var t=e.cells[a?r.firstCol:r.lastCol];e.cells.splice(a?r.firstCol:r.lastCol+1,0,(0,n.createTableCell)(t.spanLeft,t.spanAbove,t.isHeader,t.format))})),e.widths.splice(a?r.firstCol:r.lastCol+1,0,e.widths[a?r.firstCol:r.lastCol])}},9740:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertTableRow=void 0;var n=r(7582),o=r(1246),a=r(1758);t.insertTableRow=function(e,t){var r=(0,a.getSelectedCells)(e),i="insertAbove"==t;if(r)for(var l=r.firstRow;l<=r.lastRow;l++){var s=e.rows[i?r.firstRow:r.lastRow];e.rows.splice(i?r.firstRow:r.lastRow+1,0,{format:(0,n.__assign)({},s.format),cells:s.cells.map((function(e){return(0,o.createTableCell)(e.spanLeft,e.spanAbove,e.isHeader,e.format)})),height:s.height})}}},6252:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableCells=void 0;var n=r(5553),o=r(1758);t.mergeTableCells=function(e){var t=(0,o.getSelectedCells)(e);if(t&&(0,n.canMergeCells)(e.rows,t.firstRow,t.firstCol,t.lastRow,t.lastCol))for(var r=t.firstRow;r<=t.lastRow;r++){for(var a=t.firstCol;a<=t.lastCol;a++){var i=e.rows[r].cells[a];i&&(i.spanLeft=a>t.firstCol,i.spanAbove=r>t.firstRow,delete i.cachedElement)}delete e.rows[r].cachedElement}}},4497:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableColumn=void 0;var n=r(5553),o=r(1758);t.mergeTableColumn=function(e,t){var r,a,i,l,s=(0,o.getSelectedCells)(e);if(s){var c="mergeLeft"==t?s.firstCol:s.lastCol+1;if(c>0&&c<e.rows[0].cells.length)for(var d=s.firstRow;d<=s.lastRow;d++){var u=null===(r=e.rows[d])||void 0===r?void 0:r.cells[c];if(u&&(0,n.canMergeCells)(e.rows,d,c-1,d,c)){u.spanLeft=!0;for(var f=c;null===(i=null===(a=e.rows[d])||void 0===a?void 0:a.cells[f])||void 0===i?void 0:i.spanLeft;)delete e.rows[d].cells[f].cachedElement,f--;(null===(l=e.rows[d])||void 0===l?void 0:l.cells[f])&&(e.rows[d].cells[f].isSelected=!0,delete e.rows[d].cells[f].cachedElement),delete u.cachedElement}delete e.rows[d].cachedElement}}}},8323:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableRow=void 0;var n=r(5553),o=r(1758);t.mergeTableRow=function(e,t){var r,a,i,l=(0,o.getSelectedCells)(e);if(l){var s="mergeAbove"==t?l.firstRow:l.lastRow+1;if(s>0&&s<e.rows.length)for(var c=l.firstCol;c<=l.lastCol;c++){var d=e.rows[s].cells[c];if(d&&(0,n.canMergeCells)(e.rows,s-1,c,s,c)){d.spanAbove=!0;for(var u=s;null===(a=null===(r=e.rows[u])||void 0===r?void 0:r.cells[c])||void 0===a?void 0:a.spanAbove;)delete e.rows[u].cells[c].cachedElement,delete e.rows[u].cachedElement,u--;(null===(i=e.rows[u])||void 0===i?void 0:i.cells[c])&&(e.rows[u].cells[c].isSelected=!0,delete e.rows[u].cells[c].cachedElement,delete e.rows[u].cachedElement),delete d.cachedElement}}}}},8616:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitTableCellHorizontally=void 0;var n=r(7582),o=r(1246),a=r(1758);t.splitTableCellHorizontally=function(e){var t=(0,a.getSelectedCells)(e);if(t)for(var r=function(r){if(e.rows.every((function(e,n){var o;return n<t.firstRow||n>t.lastRow||(null===(o=e.cells[r+1])||void 0===o?void 0:o.spanLeft)})))e.rows.forEach((function(e,n){delete e.cells[r].cachedElement,n>=t.firstRow&&n<=t.lastRow&&(e.cells[r+1].spanLeft=!1,delete e.cells[r+1].cachedElement)}));else{e.rows.forEach((function(e,a){var i=e.cells[r];if(i){var l=(0,o.createTableCell)(i.spanLeft,i.spanAbove,i.isHeader,i.format);l.dataset=(0,n.__assign)({},i.dataset),a<t.firstRow||a>t.lastRow?l.spanLeft=!0:l.isSelected=i.isSelected,e.cells.splice(r+1,0,l),delete e.cells[r].cachedElement}}));var a=Math.max(e.widths[r]/2,30);e.widths.splice(r,1,a,a)}},i=t.lastCol;i>=t.firstCol;i--)r(i)}},1972:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitTableCellVertically=void 0;var n=r(7582),o=r(1246),a=r(1758);t.splitTableCellVertically=function(e){var t=(0,a.getSelectedCells)(e);if(t)for(var r=t.lastRow;r>=t.firstRow;r--){var i=e.rows[r],l=e.rows[r+1];if(i.cells.forEach((function(e){delete e.cachedElement})),delete i.cachedElement,null==l?void 0:l.cells.every((function(e,r){return r<t.firstCol||r>t.lastCol||e.spanAbove})))l.cells.forEach((function(e,r){r>=t.firstCol&&r<=t.lastCol&&(e.spanAbove=!1,delete e.cachedElement)})),delete l.cachedElement;else{var s=Math.max(i.height/=2,22),c={format:(0,n.__assign)({},i.format),height:s,cells:i.cells.map((function(e,r){var a=(0,o.createTableCell)(e.spanLeft,e.spanAbove,e.isHeader,e.format);return a.dataset=(0,n.__assign)({},e.dataset),r<t.firstCol||r>t.lastCol?a.spanAbove=!0:a.isSelected=e.isSelected,a}))};i.height=s,e.rows.splice(r+1,0,c)}}}},6633:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5329);t.default=function(e,t){e.focus(),e.formatContentModel((function(e){return(0,n.setModelAlignment)(e,t)}),{apiName:"setAlignment"})}},3838:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6483);t.default=function(e,t){e.focus(),e.formatContentModel((function(e){return(0,n.setModelDirection)(e,t)}),{apiName:"setDirection"})}},8086:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2469),o={h1:"2em",h2:"1.5em",h3:"1.17em",h4:"1em",h5:"0.83em",h6:"0.67em"};t.default=function(e,t){e.focus(),(0,n.formatParagraphWithContentModel)(e,"setHeadingLevel",(function(e){var r,n,a,i=t>0?"h"+t:(n=(null==(r=e.decorator)?void 0:r.tagName)||"",(a=parseInt(n.substring(1)))>=1&&a<=6?n:null);t>0?(e.decorator={tagName:i,format:i?{fontWeight:"bold",fontSize:o[i]}:{}},e.segments.forEach((function(e){delete e.format.fontSize,delete e.format.fontWeight}))):i&&delete e.decorator}))}},584:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1246),o=r(6892);t.default=function(e,t,r){e.focus(),e.formatContentModel((function(e,a){var i=(0,o.setModelIndentation)(e,t,r);return i&&(0,n.normalizeContentModel)(e),a.newPendingFormat="preserve",i}),{apiName:"setIndentation"})}},3471:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1246),o=r(2469);t.default=function(e,t,r){e.focus(),(0,o.formatParagraphWithContentModel)(e,"setParagraphMargin",(function(e){e.decorator||(e.decorator=(0,n.createParagraphDecorator)("p")),t?e.format.marginTop=t:null===t&&delete e.format.marginTop,r?e.format.marginBottom=r:null===r&&delete e.format.marginBottom}))}},2579:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2469);t.default=function(e,t){e.focus(),(0,n.formatParagraphWithContentModel)(e,"setSpacing",(function(e){e.format.lineHeight=t.toString(),e.segments.forEach((function(e){e.format.lineHeight&&delete e.format.lineHeight}))}))}},7459:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7582),o=r(159),a={borderLeft:"3px solid rgb(200, 200, 200)",textColor:"rgb(102, 102, 102)"},i={marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px",paddingLeft:"10px"};t.default=function(e,t){void 0===t&&(t=a);var r=(0,n.__assign)((0,n.__assign)({},i),t);e.focus(),e.formatContentModel((function(e,t){return t.newPendingFormat="preserve",(0,o.toggleModelBlockQuote)(e,r)}),{apiName:"toggleBlockQuote"})}},1331:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(79),o=r(1246),a=r(2504);t.default=function(e,t,r,i,l){var s=l||{},c=s.contentNode,d=s.focusAfterEntity,u=s.wrapperDisplay,f=s.skipUndoSnapshot,p=e.getDocument().createElement(r?"div":"span"),m=null!=u?u:r?void 0:"inline-block";p.style.setProperty("display",m||null),c&&p.appendChild(c);var v=(0,o.createEntity)(p,!0,void 0,t);return e.formatContentModel((function(e,t){return(0,a.insertEntityModel)(e,v,"string"==typeof i?i:"focus",r,d,t),(0,o.normalizeContentModel)(e),t.skipUndoSnapshot=f,t.newEntities.push(v),!0}),{selectionOverride:"object"==typeof i?i:void 0,changeSource:n.ChangeSource.InsertEntity,getChangeData:function(){return{wrapper:p,type:t,id:"",isReadonly:!0}},apiName:"insertEntity"}),v}},4822:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8684),o=r(1246);t.default=function(e){e.focus(),e.formatContentModel((function(e){var t=[],r=[],a=[];return(0,n.clearModelFormat)(e,t,r,a),(0,o.normalizeContentModel)(e),t.length>0||r.length>0||a.length>0}),{apiName:"clearFormat"})}},2283:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducedModelChildProcessor=void 0;var n=r(7582),o=r(79),a=r(6515),i=r(1246);function l(e,t,r){if(!r.nodeStack){var a=(0,o.getSelectionRootNode)(r.selection);r.nodeStack=a?function(e,t){for(var r=[],n=t;n&&e!=n&&e.contains(n);)(0,i.isNodeOfType)(n,"ELEMENT_NODE")&&"TABLE"==n.tagName?r.splice(0,r.length,n):r.push(n),n=n.parentNode;return r}(t,a):[]}var l=r.nodeStack.pop();if(l){var s=(0,n.__read)((0,i.getRegularSelectionOffsets)(r,t),2),c=s[0],d=s[1],u=c>=0||d>=0?function(e,t){for(var r=0,n=e.firstChild;n&&n!=t;)r++,n=n.nextSibling;return r}(t,l):-1;u>=0&&(0,i.handleRegularSelection)(u,r,e,c,d),(0,i.processChildNode)(e,l,r),u>=0&&(0,i.handleRegularSelection)(u+1,r,e,c,d)}else r.defaultElementProcessors.child(e,t,r)}t.default=function(e){var t=e.getPendingFormat(),r=e.createContentModel({processorOverride:{child:l}}),o=(0,n.__assign)((0,n.__assign)({},e.getUndoState()),{isDarkMode:e.isDarkMode(),zoomScale:e.getZoomScale()});return(0,a.retrieveModelFormatState)(r,t,o),o},t.reducedModelChildProcessor=l},4701:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1560);t.default=function(e){var t=null;return e.formatContentModel((function(e){return(0,n.adjustSegmentSelection)(e,(function(e){return!(!e.isSelected||"Image"!=e.segmentType||(t=e,0))}),(function(e,t){return e==t}))}),{apiName:"adjustImageSelection"}),t}},1422:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(287),o=r(2589),a=r(79);t.default=function(e,t){e.focus();var r=e.getDOMSelection();(0,o.readFile)(t,(function(t){t&&!e.isDisposed()&&"image"===(null==r?void 0:r.type)&&(0,n.default)(e,"changeImage",(function(n){var o,i,l=null!==(i=null===(o=(0,a.updateImageMetadata)(n))||void 0===o?void 0:o.src)&&void 0!==i?i:"",s=n.src;n.src=t,n.dataset={},n.format.width="",n.format.height="",n.alt="",e.triggerPluginEvent(19,{image:r.image,previousSrc:s,newSrc:t,originalSrc:l})}))}))}},2051:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1246),o=r(79),a=r(2589);function i(e,t){e.formatContentModel((function(e,r){var a=(0,n.createImage)(t,{backgroundColor:""}),i=(0,n.createContentModelDocument)();return(0,n.addSegment)(i,a),(0,o.mergeModel)(e,i,r,{mergeFormat:"mergeAll"}),!0}),{apiName:"insertImage"})}t.default=function(e,t){e.focus(),"string"==typeof t?i(e,t):(0,a.readFile)(t,(function(t){t&&!e.isDisposed()&&i(e,t)}))}},1431:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(287);t.default=function(e,t){e.focus(),(0,n.default)(e,"setImageAltText",(function(e){e.alt=t}))}},2233:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3481),o=r(287);t.default=function(e,t,r){e.focus(),(0,o.default)(e,"setImageBorder",(function(e){(0,n.default)(e,t,r)}))}},9423:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(287);t.default=function(e,t,r){e.focus(),(0,n.default)(e,"setImageBoxShadow",(function(e){e.format.boxShadow=t,r?(e.format.marginBottom=r,e.format.marginLeft=r,e.format.marginRight=r,e.format.marginTop=r):null===r&&(delete e.format.marginBottom,delete e.format.marginLeft,delete e.format.marginRight,delete e.format.marginTop)}))}},4315:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1560),o=r(8894),a=r(79);t.default=function(e){var t="",r=null;return e.formatContentModel((function(e){var i,l,s=(0,n.adjustSegmentSelection)(e,(function(e){return!!e.isSelected&&!!e.link}),(function(e,t){return!!e.link&&e.link.format.href==t.link.format.href})),c=(0,a.getSelectedSegments)(e,!1),d=c[0];return 1==c.length&&"SelectionMarker"==d.segmentType&&(c=(0,o.adjustWordSelection)(e,d)).length>1&&(s=!0,(0,a.setSelection)(e,c[0],c[c.length-1])),t=c.map((function(e){return"Text"==e.segmentType?e.text:""})).join(""),r=(null===(l=null===(i=c[0])||void 0===i?void 0:i.link)||void 0===l?void 0:l.format.href)||null,s}),{apiName:"adjustLinkSelection"}),[t,r]}},90:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7582),o=r(79),a=r(2347),i=r(1246),l=/^[a-zA-Z]+:/i,s=/^[\w.%+-]+@/i,c=/^ftp\./i;t.default=function(e,t,r,u,f){e.focus();var p=(function(e){var t=new a.HtmlSanitizer,r=document.createElement("a");return r.href=e||"",t.sanitize(r),r.getAttribute("href")||""}(t)||"").trim();if(p){var m,v=(0,a.matchLink)(p),g=v?v.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(l)<0&&(t=0==e.search(s)?"mailto:":0==e.search(c)?"ftp://":"http://"),t+e}(p),h=[];e.formatContentModel((function(t,a){var l,s=(0,o.getSelectedSegments)(t,!1),c=s.map((function(e){return"Text"==e.segmentType?e.text:""})).join(""),m=u||c||"";if(s.some((function(e){return"SelectionMarker"!=e.segmentType}))&&c==m)s.forEach((function(e){var t=d(g,r,f,"Text"==e.segmentType);(0,i.addLink)(e,t),e.link&&h.push(e.link)}));else if(s.every((function(e){return"SelectionMarker"==e.segmentType}))||m&&m!=c){var b=(0,i.createText)(m||(v?v.originalUrl:p),(0,n.__assign)((0,n.__assign)({},null===(l=s[0])||void 0===l?void 0:l.format),e.getPendingFormat())),y=(0,i.createContentModelDocument)(),C=d(g,r,f);(0,i.addLink)(b,C),(0,i.addSegment)(y,b),b.link&&h.push(b.link),(0,o.mergeModel)(t,y,a,{mergeFormat:"mergeAll"})}return s.length>0}),{changeSource:o.ChangeSource.CreateLink,onNodeCreated:function(e,t){!m&&h.indexOf(e)>=0&&(m=t)},getChangeData:function(){return m},apiName:"insertLink"})}};var d=function(e,t,r,n){return void 0===n&&(n=!0),{dataset:{},format:{href:e,anchorTitle:t,target:r,underline:n}}}},4040:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1560),o=r(79);t.default=function(e){e.focus(),e.formatContentModel((function(e){(0,n.adjustSegmentSelection)(e,(function(e){return!!e.isSelected&&!!e.link}),(function(e,t){return e.isSelected||!!e.link&&e.link.format.href==t.link.format.href}));var t=(0,o.getSelectedSegments)(e,!1),r=!1;return t.forEach((function(e){e.link&&(r=!0,delete e.link)})),r}),{apiName:"removeLink"})}},1045:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(79);t.default=function(e,t){e.focus(),e.formatContentModel((function(e){var r=(0,n.getFirstSelectedListItem)(e),o=null==r?void 0:r.levels[(null==r?void 0:r.levels.length)-1];return!!o&&(o.format.startNumberOverride=t,!0)}),{apiName:"setListStartNumber"})}},4898:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5825),o=r(79);t.default=function(e,t){e.focus(),e.formatContentModel((function(e){var r=(0,o.getFirstSelectedListItem)(e);if(r){var a=(0,n.findListItemsInSameThread)(e,r),i=r.levels.length-1;return a.forEach((function(e){var r=e.levels[i];r&&(0,o.updateListMetadata)(r,(function(e){return Object.assign({},e,t)}))})),!0}return!1}),{apiName:"setListStyle"})}},3879:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3632);t.default=function(e){e.focus(),e.formatContentModel((function(e,t){return t.newPendingFormat="preserve",(0,n.setListType)(e,"UL")}),{apiName:"toggleBullet"})}},5387:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3632);t.default=function(e){e.focus(),e.formatContentModel((function(e,t){return t.newPendingFormat="preserve",(0,n.setListType)(e,"OL")}),{apiName:"toggleNumbering"})}},7376:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2848);t.default=function(e,t){(0,n.formatSegmentWithContentModel)(e,"applySegmentFormat",(function(e){e.backgroundColor=t.backgroundColor,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontWeight=t.fontWeight,e.italic=t.italic,e.strikethrough=t.strikethrough,e.superOrSubScriptSequence=t.superOrSubScriptSequence,e.textColor=t.textColor,e.underline=t.underline}),void 0,!0)}},6452:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2848);t.default=function(e,t,r){e.focus(),(0,n.formatSegmentWithContentModel)(e,"changeCapitalization",(function(e,n,o){if("Text"==(null==o?void 0:o.segmentType))switch(t){case"lowerCase":o.text=o.text.toLocaleLowerCase(r);break;case"upperCase":o.text=o.text.toLocaleUpperCase(r);break;case"capitalize":for(var a=o.text.toLocaleLowerCase(r).split(" "),i=0;i<a.length;i++)a[i]=a[i].charAt(0).toLocaleUpperCase(r)+a[i].slice(1);o.text=a.join(" ");break;case"sentence":var l=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");o.text=o.text.toLocaleLowerCase(r).replace(l,(function(e){return e.toLocaleUpperCase(r)}))}}))}},4969:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2848),o=r(1246),a=r(5130),i=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];t.default=function(e,t){e.focus(),(0,n.formatSegmentWithContentModel)(e,"changeFontSize",(function(e,r,n,l){return function(e,t,r){if(t.fontSize){var n=(0,o.parseValueWithUnit)(t.fontSize,void 0,"pt");if(n>0){var l=function(e,t,r){e=1==t?Math.floor(e):Math.ceil(e);var n=r[r.length-1];if(e<=r[0])e=Math.max(e+t,1);else if(e>n||e==n&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),n),1e3);else if(1==t){for(var o=0;o<r.length;o++)if(e<r[o]){e=r[o];break}}else for(o=r.length-1;o>=0;o--)if(e>r[o]){e=r[o];break}return e}(n,"increase"==e?1:-1,i);(0,a.setFontSizeInternal)(l+"pt",t,r)}}}(t,e,l)}),void 0,!0)}},4402:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1246),o=r(2848),a=r(79);t.default=function(e,t){e.focus();var r=null,i=-1;(0,o.formatSegmentWithContentModel)(e,"setBackgroundColor",(function(e,n,o,a){null===t?delete e.backgroundColor:e.backgroundColor=t,o&&a&&"SelectionMarker"!=o.segmentType&&(i=(r=a).segments.indexOf(o))}),void 0,void 0,(function(e){var t;if(r&&i>=0){var o=(0,n.createSelectionMarker)(null===(t=r.segments[i])||void 0===t?void 0:t.format);r.segments.splice(i+1,0,o),(0,a.setSelection)(e,o,o)}}))}},5215:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2848);t.default=function(e,t){e.focus(),(0,n.formatSegmentWithContentModel)(e,"setFontName",(function(e,r,n){e.fontFamily=t,(null==n?void 0:n.code)&&(n.code.format.fontFamily=t)}),void 0,!0)}},5130:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFontSizeInternal=void 0;var n=r(2848);function o(e,t,r){var n;if(t.fontSize=e,null===(n=null==r?void 0:r.segmentFormat)||void 0===n?void 0:n.fontSize){var o=r.segmentFormat.fontSize;r.segments.forEach((function(e){e.format.fontSize||(e.format.fontSize=o)})),delete r.segmentFormat.fontSize}}t.default=function(e,t){e.focus(),(0,n.formatSegmentWithContentModel)(e,"setFontSize",(function(e,r,n,a){return o(t,e,a)}),void 0,!0)},t.setFontSizeInternal=o},9945:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2848);t.default=function(e,t){e.focus(),(0,n.formatSegmentWithContentModel)(e,"setTextColor",null===t?function(e,t,r){delete e.textColor,(null==r?void 0:r.link)&&delete r.link.format.textColor}:function(e,r,n){e.textColor=t,(null==n?void 0:n.link)&&(n.link.format.textColor=t)},void 0,!0)}},985:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2848),o=r(79);t.default=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleBold",(function(e,t){e.fontWeight=t?"bold":"normal"}),(function(e,t,r){var n;return(0,o.isBold)(void 0===e.fontWeight?null===(n=null==r?void 0:r.decorator)||void 0===n?void 0:n.format.fontWeight:e.fontWeight)}))}},7402:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1246),o=r(2848),a={format:{fontFamily:"monospace"}};t.default=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleCode",(function(e,t,r){r&&(t?(0,n.addCode)(r,a):delete r.code)}),(function(e,t){return!!(null==t?void 0:t.code)}))}},6589:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2848);t.default=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleItalic",(function(e,t){e.italic=!!t}),(function(e){return!!e.italic}))}},6668:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2848);t.default=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleStrikethrough",(function(e,t){e.strikethrough=!!t}),(function(e){return!!e.strikethrough}))}},7636:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2848);t.default=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleSubscript",(function(e,t){e.superOrSubScriptSequence=t?"sub":""}),(function(e){var t;return"sub"==(null===(t=e.superOrSubScriptSequence)||void 0===t?void 0:t.split(" ").pop())}))}},2634:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2848);t.default=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleSuperscript",(function(e,t){e.superOrSubScriptSequence=t?"super":""}),(function(e){var t;return"super"==(null===(t=e.superOrSubScriptSequence)||void 0===t?void 0:t.split(" ").pop())}))}},9997:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2848);t.default=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleUnderline",(function(e,t,r){e.underline=!!t,(null==r?void 0:r.link)&&(r.link.format.underline=!!t)}),(function(e,t){var r,n;return!!e.underline||!!(null===(n=null===(r=null==t?void 0:t.link)||void 0===r?void 0:r.format)||void 0===n?void 0:n.underline)}))}},496:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8629),o=r(3766);t.default=function(e){switch(e.blockType){case"Paragraph":return e.segments.some(o.default);case"Table":return e.rows.some((function(e){return e.cells.some(n.default)}));case"BlockGroup":return(0,n.default)(e);case"Divider":case"Entity":return!!e.isSelected;default:return!1}}},8629:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(496);t.default=function(e){return!("TableCell"!=e.blockGroupType||!e.isSelected)||!!e.blocks.some(n.default)}},3766:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(496);t.default=function(e){return e.isSelected||"General"==e.segmentType&&e.blocks.some(n.default)}},3503:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7582),o=r(1758),a=r(1246),i=r(79);function l(e,t,r){r.forEach((function(r){e.format[r]=t})),(0,i.updateTableCellMetadata)(e,(function(e){return(e=e||{}).borderOverride=!0,e})),delete e.cachedElement}t.default=function(e,t,r){e.formatContentModel((function(e){var s=(0,n.__read)((0,i.getFirstSelectedTable)(e),1)[0];if(s){var c=(0,o.getSelectedCells)(s),d={Top:!1,Bottom:!1,Left:!1,Right:!1},u="",f=s.format,p=t.width,m=t.style,v=t.color,g=(0,i.extractBorderValues)(f.borderTop),h=g.color,b=g.width,y=g.style;if(u=p?(0,a.parseValueWithUnit)(p)+"px":b||"1px",m?u=u+" "+m:y?u=u+" "+y:u+=" solid",v?u=u+" "+v:h&&(u=u+" "+h),c){for(var C=[r];C.length;)switch(C.pop()){case"noBorders":u="",C.push("allBorders");break;case"allBorders":for(var S=["borderTop","borderBottom","borderLeft","borderRight"],_=c.firstRow;_<=c.lastRow;_++)for(var k=c.firstCol;k<=c.lastCol;k++)l(s.rows[_].cells[k],u,S);d.Top=!0,d.Bottom=!0,d.Left=!0,d.Right=!0;break;case"leftBorders":var P=["borderLeft"];for(_=c.firstRow;_<=c.lastRow;_++)l(s.rows[_].cells[c.firstCol],u,P);d.Left=!0;break;case"rightBorders":var w=["borderRight"];for(_=c.firstRow;_<=c.lastRow;_++)l(s.rows[_].cells[c.lastCol],u,w);d.Right=!0;break;case"topBorders":var M=["borderTop"];for(k=c.firstCol;k<=c.lastCol;k++)l(s.rows[c.firstRow].cells[k],u,M);d.Top=!0;break;case"bottomBorders":var E=["borderBottom"];for(k=c.firstCol;k<=c.lastCol;k++)l(s.rows[c.lastRow].cells[k],u,E);d.Bottom=!0;break;case"insideBorders":var O=c.lastCol==c.firstCol,T=c.lastRow==c.firstRow;if(O&&T)break;if(O){for(l(s.rows[c.firstRow].cells[c.firstCol],u,["borderBottom"]),_=c.firstRow+1;_<=c.lastRow-1;_++)l(s.rows[_].cells[c.firstCol],u,["borderTop","borderBottom"]);l(s.rows[c.lastRow].cells[c.firstCol],u,["borderTop"]);break}if(T){for(l(s.rows[c.firstRow].cells[c.firstCol],u,["borderRight"]),k=c.firstCol+1;k<=c.lastCol-1;k++)l(s.rows[c.firstRow].cells[k],u,["borderLeft","borderRight"]);l(s.rows[c.firstRow].cells[c.lastCol],u,["borderLeft"]);break}for(l(s.rows[c.firstRow].cells[c.firstCol],u,["borderBottom","borderRight"]),l(s.rows[c.firstRow].cells[c.lastCol],u,["borderBottom","borderLeft"]),l(s.rows[c.lastRow].cells[c.firstCol],u,["borderTop","borderRight"]),l(s.rows[c.lastRow].cells[c.lastCol],u,["borderTop","borderLeft"]),k=c.firstCol+1;k<c.lastCol;k++)l(s.rows[c.firstRow].cells[k],u,["borderBottom","borderLeft","borderRight"]);for(k=c.firstCol+1;k<c.lastCol;k++)l(s.rows[c.lastRow].cells[k],u,["borderTop","borderLeft","borderRight"]);for(_=c.firstRow+1;_<c.lastRow;_++)l(s.rows[_].cells[c.firstCol],u,["borderTop","borderBottom","borderRight"]);for(_=c.firstRow+1;_<c.lastRow;_++)l(s.rows[_].cells[c.lastCol],u,["borderTop","borderBottom","borderLeft"]);c.firstCol++,c.firstRow++,c.lastCol--,c.lastRow--,C.push("allBorders");break;case"outsideBorders":C.push("topBorders"),C.push("bottomBorders"),C.push("leftBorders"),C.push("rightBorders")}!function(e,t,r,n){if(n.Top&&t.firstRow-1>=0)for(var o=t.firstCol;o<=t.lastCol;o++)l(e.rows[t.firstRow-1].cells[o],r,["borderBottom"]);if(n.Bottom&&t.lastRow+1<e.rows.length)for(o=t.firstCol;o<=t.lastCol;o++)l(e.rows[t.lastRow+1].cells[o],r,["borderTop"]);if(n.Left&&t.firstCol-1>=0)for(var a=t.firstRow;a<=t.lastRow;a++)l(e.rows[a].cells[t.firstCol-1],r,["borderRight"]);if(n.Right&&t.lastCol+1<e.rows[0].cells.length)for(a=t.firstRow;a<=t.lastRow;a++)l(e.rows[a].cells[t.lastCol+1],r,["borderLeft"])}(s,c,u,d)}return!0}return!1}),{apiName:"tableBorder"})}},4997:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7582),o=r(496),a=r(7854),i=r(3245),l=r(1247),s=r(3283),c=r(1055),d=r(8204),u=r(9740),f=r(6252),p=r(4497),m=r(8323),v=r(8616),g=r(1972),h=r(79),b=r(2793),y=r(1246);t.default=function(e,t){e.focus(),e.formatContentModel((function(e){var r=(0,n.__read)((0,h.getFirstSelectedTable)(e),2),C=r[0],S=r[1];if(C){switch(t){case"alignCellLeft":case"alignCellCenter":case"alignCellRight":(0,b.alignTableCellHorizontally)(C,t);break;case"alignCellTop":case"alignCellMiddle":case"alignCellBottom":(0,b.alignTableCellVertically)(C,t);break;case"alignCenter":case"alignLeft":case"alignRight":(0,a.alignTable)(C,t);break;case"deleteColumn":(0,l.deleteTableColumn)(C);break;case"deleteRow":(0,s.deleteTableRow)(C);break;case"deleteTable":(0,i.deleteTable)(C);break;case"insertAbove":case"insertBelow":(0,u.insertTableRow)(C,t);break;case"insertLeft":case"insertRight":(0,d.insertTableColumn)(C,t);break;case"mergeAbove":case"mergeBelow":(0,m.mergeTableRow)(C,t);break;case"mergeCells":(0,f.mergeTableCells)(C);break;case"mergeLeft":case"mergeRight":(0,p.mergeTableColumn)(C,t);break;case"splitHorizontally":(0,v.splitTableCellHorizontally)(C);break;case"splitVertically":(0,g.splitTableCellVertically)(C)}if(!(0,o.default)(C)){var _=(0,c.ensureFocusableParagraphForTable)(e,S,C);if(_){var k=(0,y.createSelectionMarker)(e.format);_.segments.unshift(k),(0,y.setParagraphNotImplicit)(_),(0,h.setSelection)(e,k)}}return(0,h.normalizeTable)(C,e.format),(0,y.hasMetadata)(C)&&(0,h.applyTableFormat)(C,void 0,!0),!0}return!1}),{apiName:"editTable"})}},7841:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7582),o=r(79);t.default=function(e,t,r){e.focus(),e.formatContentModel((function(e){var a=(0,n.__read)((0,o.getFirstSelectedTable)(e),1)[0];return!!a&&(a.rows.forEach((function(e){e.cells.forEach((function(e){(0,o.updateTableCellMetadata)(e,(function(e){return e&&delete e.borderOverride,e}))}))})),(0,o.applyTableFormat)(a,t,r),!0)}),{apiName:"formatTable"})}},9743:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1246),o=r(5827),a=r(79);t.default=function(e,t,r,i){e.focus(),e.formatContentModel((function(l,s){var c,d,u,f=(0,a.deleteSelection)(l,[],s).insertPoint;if(f){var p=(0,n.createContentModelDocument)(),m=(0,o.createTableStructure)(p,t,r);(0,a.normalizeTable)(m,e.getPendingFormat()||f.marker.format),i=i||{verticalAlign:"top"},(0,a.applyTableFormat)(m,i),(0,a.mergeModel)(l,p,s,{insertPosition:f,mergeFormat:"mergeAll"});var v=null===(d=null===(c=m.rows[0])||void 0===c?void 0:c.cells[0])||void 0===d?void 0:d.blocks[0];if("Paragraph"==(null==v?void 0:v.blockType)){var g=(0,n.createSelectionMarker)(null===(u=v.segments[0])||void 0===u?void 0:u.format);v.segments.unshift(g),(0,a.setSelection)(l,g)}return!0}return!1}),{apiName:"insertTable"})}},5265:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7582),o=r(8629),a=r(79);t.default=function(e,t){e.focus(),e.formatContentModel((function(e){var r=(0,n.__read)((0,a.getFirstSelectedTable)(e),1)[0];return!!r&&((0,a.normalizeTable)(r),r.rows.forEach((function(e){return e.cells.forEach((function(e){(0,o.default)(e)&&(0,a.setTableCellBackgroundColor)(e,t,!0)}))})),!0)}),{apiName:"setTableCellShade"})}},287:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2848);t.default=function(e,t,r){(0,n.formatSegmentWithContentModel)(e,t,(function(e,t,n){"Image"==(null==n?void 0:n.segmentType)&&r(n)}),void 0,void 0)}},2469:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatParagraphWithContentModel=void 0;var n=r(79);t.formatParagraphWithContentModel=function(e,t,r){e.formatContentModel((function(e,t){var o=(0,n.getSelectedParagraphs)(e);return o.forEach(r),t.newPendingFormat="preserve",o.length>0}),{apiName:t})}},2848:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatSegmentWithContentModel=void 0;var n=r(7582),o=r(8894),a=r(79);t.formatSegmentWithContentModel=function(e,t,r,i,l,s){e.formatContentModel((function(t,c){var d=(0,a.getSelectedSegmentsAndParagraphs)(t,!!l),u=e.getPendingFormat(),f=1==d.length&&"SelectionMarker"==d[0][0].segmentType;if(f){var p=d[0][1];(d=(0,o.adjustWordSelection)(t,d[0][0]).map((function(e){return[e,p]}))).length>1&&(f=!1)}var m=u?[[u,null,null]]:d.map((function(e){return[e[0].format,e[0],e[1]]})),v=!!i&&m.every((function(e){var t=(0,n.__read)(e,3),r=t[0],o=t[1],a=t[2];return i(r,o,a)}));return m.forEach((function(e){var t=(0,n.__read)(e,3),o=t[0],a=t[1],i=t[2];return r(o,!v,a,i)})),null==s||s(t),!u&&f&&(c.newPendingFormat=d[0][0].format),f?(e.focus(),!1):m.length>0}),{apiName:t})}},6133:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BulletListType=void 0,t.BulletListType={Min:1,Disc:1,Dash:2,Square:3,ShortArrow:4,LongArrow:5,UnfilledArrow:6,Hyphen:7,DoubleLongArrow:8,Circle:9,Max:9}},4791:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeSource=void 0,t.ChangeSource={AutoLink:"AutoLink",CreateLink:"CreateLink",Format:"Format",ImageResize:"ImageResize",Paste:"Paste",SetContent:"SetContent",Cut:"Cut",Drop:"Drop",InsertEntity:"InsertEntity",SwitchToDarkMode:"SwitchToDarkMode",SwitchToLightMode:"SwitchToLightMode",ListChain:"ListChain",Keyboard:"Keyboard"}},1884:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberingListType=void 0,t.NumberingListType={Min:1,Decimal:1,DecimalDash:2,DecimalParenthesis:3,DecimalDoubleParenthesis:4,LowerAlpha:5,LowerAlphaParenthesis:6,LowerAlphaDoubleParenthesis:7,LowerAlphaDash:8,UpperAlpha:9,UpperAlphaParenthesis:10,UpperAlphaDoubleParenthesis:11,UpperAlphaDash:12,LowerRoman:13,LowerRomanParenthesis:14,LowerRomanDoubleParenthesis:15,LowerRomanDash:16,UpperRoman:17,UpperRomanParenthesis:18,UpperRomanDoubleParenthesis:19,UpperRomanDash:20,Max:20}},314:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableBorderFormat=void 0,t.TableBorderFormat={Min:0,Default:0,ListWithSideBorders:1,NoHeaderBorders:2,NoSideBorders:3,FirstColumnHeaderExternal:4,EspecialType1:5,EspecialType2:6,EspecialType3:7,Clear:8,Max:8}},8952:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModel=void 0;var n=r(7582),o=r(1591),a=r(1246);t.createContentModel=function(e,t,r){var i=r?null:e.cache.cachedModel;if(i&&e.lifecycle.shadowEditFragment&&(i=(0,o.cloneModel)(i,{includeCachedElement:!0})),i)return i;var l=r||e.api.getDOMSelection(e)||void 0,s=function(e,t,r){var o=e.api.createEditorContext(e),i=r?a.createDomToModelContext.apply(void 0,(0,n.__spreadArray)((0,n.__spreadArray)([o],(0,n.__read)(e.defaultDomToModelOptions||[]),!1),[r],!1)):(0,a.createDomToModelContextWithConfig)(e.defaultDomToModelConfig,o);return(0,a.domToContentModel)(e.contentDiv,i,t)}(e,l,t);return t||r||(e.cache.cachedModel=s,e.cache.cachedSelection=l),s}},313:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditorContext=void 0,t.createEditorContext=function(e){var t=e.lifecycle,r=e.format,n=e.darkColorHandler,o=e.contentDiv,a=e.cache,i={isDarkMode:t.isDarkMode,defaultFormat:r.defaultFormat,darkColorHandler:n,addDelimiterForEntity:!0,allowCacheElement:!0,domIndexer:a.domIndexer};return function(e,t){var r,n=null===(r=null==e?void 0:e.ownerDocument.defaultView)||void 0===r?void 0:r.getComputedStyle(e);"rtl"==(null==n?void 0:n.direction)&&(t.isRootRtl=!0)}(o,i),function(e,t){var r,n=(null===(r=null==e?void 0:e.getBoundingClientRect())||void 0===r?void 0:r.width)||0,o=e.offsetWidth;o>0&&n>0&&(t.zoomScale=Math.round(n/o*100)/100)}(o,i),i}},562:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatContentModel=void 0;var n=r(7582),o=r(4791);t.formatContentModel=function(e,t,r){var n,l=r||{},s=l.apiName,c=l.onNodeCreated,d=l.getChangeData,u=l.changeSource,f=l.rawEvent,p=l.selectionOverride,m=e.api.createContentModel(e,void 0,p),v={newEntities:[],deletedEntities:[],rawEvent:f,newImages:[]};if(t(m,v)){var g=function(){!function(e,t){e.lifecycle.isDarkMode&&t.newEntities.forEach((function(t){e.api.transformColor(e,t.wrapper,!0,null,0)}))}(e,v),function(e,t){t.deletedEntities.forEach((function(r){var n=r.entity,o=n.wrapper,i=n.entityFormat,l=i.id,s=i.entityType,c=i.isReadonly,d=r.operation;if(l&&s){var u={id:l,type:s,isReadonly:!!c,wrapper:o};e.api.triggerEvent(e,{eventType:15,entity:u,operation:a[d],rawEvent:t.rawEvent},!1)}}))}(e,v),function(e,t){if(t.newImages.length>0){var r=e.api.getVisibleViewport(e);if(r){var n=r.left,o=r.right,a=Math.max(o-n,10);t.newImages.forEach((function(e){e.format.maxWidth=a+"px"}))}}}(e,v),n=e.api.setContentModel(e,m,void 0,c)||void 0,i(e,v,n)};v.skipUndoSnapshot?g():e.api.addUndoSnapshot(e,g,null,!1,{formatApiName:s});var h={eventType:7,contentModel:v.clearModelCache?void 0:m,selection:v.clearModelCache?void 0:n,source:u||o.ChangeSource.Format,data:null==d?void 0:d(),additionalData:{formatApiName:s}};e.api.triggerEvent(e,h,!0)}else v.clearModelCache&&(e.cache.cachedModel=void 0,e.cache.cachedSelection=void 0),i(e,v,e.api.getDOMSelection(e))};var a={overwrite:6,removeFromEnd:5,removeFromStart:4};function i(e,t,r){var o,a="preserve"==t.newPendingFormat?null===(o=e.format.pendingFormat)||void 0===o?void 0:o.format:t.newPendingFormat;a&&"range"==(null==r?void 0:r.type)&&r.range.collapsed&&(e.format.pendingFormat={format:(0,n.__assign)({},a),posContainer:r.range.startContainer,posOffset:r.range.startOffset})}},4666:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDOMSelection=void 0,t.getDOMSelection=function(e){var t;return null!==(t=e.cache.cachedSelection)&&void 0!==t?t:function(e){var t=e.api.getSelectionRangeEx(e);return 0==t.type&&t.ranges[0]?{type:"range",range:t.ranges[0]}:1==t.type&&t.coordinates?{type:"table",table:t.table,firstColumn:t.coordinates.firstCell.x,lastColumn:t.coordinates.lastCell.x,firstRow:t.coordinates.firstCell.y,lastRow:t.coordinates.lastCell.y}:2==t.type?{type:"image",image:t.image}:null}(e)}},5192:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVisibleViewport=void 0;var n=r(7582);t.getVisibleViewport=function(e){var t=e.domEvent.scrollContainer;return function(e,t){void 0===t&&(t=[]);var r=e.map((function(e){return r=(t=e.getBoundingClientRect()||{left:0,right:0,top:0,bottom:0}).left,n=t.right,o=t.top,a=t.bottom,0===r&&0===n&&0===o&&0===a?null:{left:Math.round(r),right:Math.round(n),top:Math.round(o),bottom:Math.round(a)};var t,r,n,o,a})).concat(t).filter((function(e){return!!e})),o={top:Math.max.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(r.map((function(e){return e.top}))),!1)),bottom:Math.min.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(r.map((function(e){return e.bottom}))),!1)),left:Math.max.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(r.map((function(e){return e.left}))),!1)),right:Math.min.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(r.map((function(e){return e.right}))),!1))};return o.top<o.bottom&&o.left<o.right?o:null}(t==e.contentDiv?[t]:[t,e.contentDiv])}},6402:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setContentModel=void 0;var n=r(7582),o=r(1246);t.setContentModel=function(e,t,r,a){var i=e.api.createEditorContext(e),l=r?o.createModelToDomContext.apply(void 0,(0,n.__spreadArray)((0,n.__spreadArray)([i],(0,n.__read)(e.defaultModelToDomOptions||[]),!1),[r],!1)):(0,o.createModelToDomContextWithConfig)(e.defaultModelToDomConfig,i),s=(0,o.contentModelToDom)(e.contentDiv.ownerDocument,e.contentDiv,t,l,a);return e.lifecycle.shadowEditFragment||(e.cache.cachedSelection=s||void 0,s&&((null==r?void 0:r.ignoreSelection)?"range"==s.type&&(e.domEvent.selectionRange=s.range):e.api.setDOMSelection(e,s)),e.cache.cachedModel=t),s}},2065:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setDOMSelection=void 0,t.setDOMSelection=function(e,t){var r="range"==t.type?{type:0,ranges:[t.range],areAllCollapsed:t.range.collapsed}:"image"==t.type?{type:2,ranges:[],areAllCollapsed:!1,image:t.image}:{type:1,ranges:[],areAllCollapsed:!1,table:t.table,coordinates:{firstCell:{x:t.firstColumn,y:t.firstRow},lastCell:{x:t.lastColumn,y:t.lastRow}}};e.api.select(e,r)}},3733:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchShadowEdit=void 0;var n=r(7269),o=r(1246);t.switchShadowEdit=function(e,t){var r=e;if(t!=!!r.lifecycle.shadowEditFragment)if(t){var a=r.cache.cachedModel?null:r.api.createContentModel(r),i=r.contentDiv.ownerDocument.createDocumentFragment(),l=r.contentDiv.cloneNode(!0);(0,o.moveChildNodes)(i,l),r.api.triggerEvent(r,{eventType:17,fragment:i,selectionPath:null},!1),!r.cache.cachedModel&&a&&(r.cache.cachedModel=a),r.lifecycle.shadowEditFragment=i}else r.lifecycle.shadowEditFragment=null,r.api.triggerEvent(r,{eventType:18},!1),r.cache.cachedModel&&((0,n.iterateSelections)(r.cache.cachedModel,(function(){})),r.api.setContentModel(r,r.cache.cachedModel,{ignoreSelection:!0}))}},1741:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelCachePlugin=void 0;var n=r(4429),o=r(3343),a=r(2060),i=function(){function e(e){var t=this;this.editor=null,this.onNativeSelectionChange=function(){var e;(null===(e=t.editor)||void 0===e?void 0:e.hasFocus())&&t.updateCachedModel(t.editor)},this.state={domIndexer:e.cacheModel?o.contentModelDomIndexer:void 0}}return e.prototype.getName=function(){return"ContentModelCache"},e.prototype.initialize=function(e){this.editor=e,this.editor.getDocument().addEventListener("selectionchange",this.onNativeSelectionChange)},e.prototype.dispose=function(){this.editor&&(this.editor.getDocument().removeEventListener("selectionchange",this.onNativeSelectionChange),this.editor=null)},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case 0:this.shouldClearCache(e)&&this.invalidateCache();break;case 3:this.updateCachedModel(this.editor,!0);break;case 22:this.updateCachedModel(this.editor);break;case 7:var t=e,r=t.contentModel,n=t.selection;r&&this.state.domIndexer?(this.state.cachedModel=r,this.state.cachedSelection=n):this.invalidateCache()}},e.prototype.invalidateCache=function(){var e;(null===(e=this.editor)||void 0===e?void 0:e.isInShadowEdit())||(this.state.cachedModel=void 0,this.state.cachedSelection=void 0)},e.prototype.updateCachedModel=function(e,t){var r,o=this.state.cachedSelection;this.state.cachedSelection=void 0;var a=e.getDOMSelection()||void 0,i=this.state.cachedModel;!t&&o&&a&&(0,n.areSameSelection)(a,o)?this.state.cachedSelection=o:i&&a&&(null===(r=this.state.domIndexer)||void 0===r?void 0:r.reconcileSelection(i,a,o))?this.state.cachedSelection=a:this.invalidateCache()},e.prototype.shouldClearCache=function(e){var t,r=e.rawEvent;return!!e.handledByEditFeature||!!r.defaultPrevented||"Enter"==r.key||!("range"==(null===(t=this.state.cachedSelection)||void 0===t?void 0:t.type)&&this.state.cachedSelection.range.collapsed||!(0,a.isCharacterValue)(r))},e}();t.createContentModelCachePlugin=function(e){return new i(e)}},8135:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelCopyPastePlugin=t.onNodeCreated=void 0;var n=r(7582),o=r(7696),a=r(4791),i=r(1591),l=r(2162),s=r(2347),c=r(7269),d=r(3408),u=r(1246),f=function(){function e(e){var t=this;this.editor=null,this.disposer=null,this.onPaste=function(e){if(t.editor&&function(e){return!!e.clipboardData}(e)){var r=t.editor,n=e.clipboardData;(null==n?void 0:n.items)&&(e.preventDefault(),(0,s.extractClipboardItems)((0,u.toArray)(n.items),{allowedCustomPasteType:t.state.allowedCustomPasteType},!0).then((function(e){r.isDisposed()||(0,d.paste)(r,e)})))}},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[]}}return e.prototype.getName=function(){return"ContentModelCopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:function(e){return t.onPaste(e)},copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},e.prototype.dispose=function(){this.disposer&&this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onCutCopy=function(e,r){var s=this;if(this.editor){var d=this.editor.getDocument(),f=this.editor.getDOMSelection();if(f&&("range"!=f.type||!f.range.collapsed)){var m=this.editor.createContentModel(),v=(0,i.cloneModel)(m,{includeCachedElement:!!this.editor.isDarkMode()&&function(e,t){var r;if("cache"!=t){var n=e.cloneNode(!0);return null===(r=s.editor)||void 0===r||r.transformToDarkColor(n,1),n.style.color=n.style.color||"inherit",n.style.backgroundColor=n.style.backgroundColor||"inherit",n}}});"table"===f.type&&(0,c.iterateSelections)(v,(function(e,t){if(null==t?void 0:t.table){var r=null==t?void 0:t.table;return r.rows=r.rows.map((function(e){return(0,n.__assign)((0,n.__assign)({},e),{cells:e.cells.filter((function(e){return e.isSelected}))})})).filter((function(e){return e.cells.length>0})),!0}return!1}));var g=this.getTempDiv(this.editor),h=(0,u.contentModelToDom)(g.ownerDocument,g,v,(0,u.createModelToDomContext)(),t.onNodeCreated),b=h?function(e,t,r){var n,o=null;if("table"===t.type){var a=r.querySelector("#"+t.table.id),i=1==(null===(n=a.parentElement)||void 0===n?void 0:n.childElementCount)?a.parentElement:a;(o=e.createRange()).selectNode(i)}else if("image"===t.type){var l=r.querySelector("#"+t.image.id);l&&(o=e.createRange()).selectNode(l)}else o=t.range;return o}(d,h,g):null;b?((b=this.editor.triggerPluginEvent(9,{clonedRoot:g,range:b,rawEvent:e,isCut:r}).range)&&(0,o.addRangeToSelection)(d,b),this.editor.runAsync((function(e){var t=e;p(g),t.focus(),t.setDOMSelection(f),r&&t.formatContentModel((function(e,t){return"range"==(0,l.deleteSelection)(e,[],t).deleteResult&&(0,u.normalizeContentModel)(e),!0}),{apiName:"cut",changeSource:a.ChangeSource.Cut})}))):p(g)}}},e.prototype.getTempDiv=function(e){var t=e.getCustomData("CopyPasteTempDiv",(function(){var t=e.getDocument().createElement("div");return t.style.width="600px",t.style.height="1px",t.style.overflow="hidden",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.userSelect="text",t.contentEditable="true",e.getDocument().body.appendChild(t),t}),(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}));return t.style.backgroundColor="white",t.style.color="black",t.childNodes.forEach((function(e){return t.removeChild(e)})),t.style.display="",t.focus(),t},e}();function p(e){e.style.backgroundColor="",e.style.color="",e.style.display="none",(0,u.moveChildNodes)(e)}t.onNodeCreated=function(e,t){(0,u.isNodeOfType)(t,"ELEMENT_NODE")&&(0,u.isElementOfType)(t,"table")&&(0,u.wrap)(t.ownerDocument,t,"div"),(0,u.isNodeOfType)(t,"ELEMENT_NODE")&&!t.isContentEditable&&t.removeAttribute("contenteditable")},t.createContentModelCopyPastePlugin=function(e){return new f(e)}},4039:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelFormatPlugin=void 0;var n=r(7582),o=r(547),a=r(7202),i=r(1246),l=r(2060),s=new Set(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"]),c=function(){function e(e){this.editor=null,this.hasDefaultFormat=!1,this.state={defaultFormat:(0,n.__assign)({},e.defaultSegmentFormat),pendingFormat:null}}return e.prototype.getName=function(){return"ContentModelFormat"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.hasDefaultFormat=(0,i.getObjectKeys)(this.state.defaultFormat).filter((function(e){return void 0!==t.state.defaultFormat[e]})).length>0},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case 3:(this.editor.getEnvironment().isAndroid||!e.rawEvent.isComposing&&!this.editor.isInIME())&&this.checkAndApplyPendingFormat(e.rawEvent.data);break;case 4:this.checkAndApplyPendingFormat(e.rawEvent.data);break;case 0:s.has(e.rawEvent.key)?this.clearPendingFormat():this.hasDefaultFormat&&((0,l.isCharacterValue)(e.rawEvent)||"Process"==e.rawEvent.key)&&(0,o.applyDefaultFormat)(this.editor,this.state.defaultFormat);break;case 6:case 7:this.canApplyPendingFormat()||this.clearPendingFormat()}},e.prototype.checkAndApplyPendingFormat=function(e){this.editor&&e&&this.state.pendingFormat&&((0,a.applyPendingFormat)(this.editor,e,this.state.pendingFormat.format),this.clearPendingFormat())},e.prototype.clearPendingFormat=function(){this.state.pendingFormat=null},e.prototype.canApplyPendingFormat=function(){var e=!1;if(this.state.pendingFormat&&this.editor){var t=this.editor.getDOMSelection(),r="range"==(null==t?void 0:t.type)&&t.range.collapsed?t.range:null,n=this.state.pendingFormat,o=n.posContainer,a=n.posOffset;r&&r.startContainer==o&&r.startOffset==a&&(e=!0)}return e},e}();t.createContentModelFormatPlugin=function(e){return new c(e)}},7174:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDOMEventPlugin=void 0;var n=r(7582),o=r(2060),a=function(){function e(e,t){var r,a=this;this.editor=null,this.disposer=null,this.onDragStart=function(e){var t,r=e,n=null===(t=a.editor)||void 0===t?void 0:t.getElementAtCursor("*",r.target);n&&!n.isContentEditable&&r.preventDefault()},this.onDrop=function(){var e;null===(e=a.editor)||void 0===e||e.runAsync((function(e){e.addUndoSnapshot((function(){}),"Drop")}))},this.onFocus=function(){var e,t,r;if(!a.state.skipReselectOnFocus){var n=a.state.tableSelectionRange||{},o=n.table,i=n.coordinates,l=(a.state.imageSelectionRange||{}).image;o&&i?null===(e=a.editor)||void 0===e||e.select(o,i):l?null===(t=a.editor)||void 0===t||t.select(l):a.state.selectionRange&&(null===(r=a.editor)||void 0===r||r.select(a.state.selectionRange))}a.state.selectionRange=null},this.onKeyDownDocument=function(e){9!=e.which||e.defaultPrevented||a.cacheSelection()},this.onMouseDownDocument=function(e){!a.editor||a.state.selectionRange||a.editor.contains(e.target)||a.cacheSelection()},this.cacheSelection=function(){!a.state.selectionRange&&a.editor&&(a.state.selectionRange=a.editor.getSelectionRange(!1))},this.onScroll=function(e){var t;null===(t=a.editor)||void 0===t||t.triggerPluginEvent(14,{rawEvent:e,scrollContainer:a.state.scrollContainer})},this.onKeyboardEvent=function(e){((0,o.isCharacterValue)(e)||e.which>=33&&e.which<=40)&&e.stopPropagation()},this.onInputEvent=function(e){e.stopPropagation()},this.onMouseDown=function(e){a.editor&&(a.state.mouseUpEventListerAdded||(a.editor.getDocument().addEventListener("mouseup",a.onMouseUp,!0),a.state.mouseUpEventListerAdded=!0,a.state.mouseDownX=e.pageX,a.state.mouseDownY=e.pageY),a.editor.triggerPluginEvent(5,{rawEvent:e}))},this.onMouseUp=function(e){a.editor&&(a.removeMouseUpEventListener(),a.editor.triggerPluginEvent(6,{rawEvent:e,isClicking:a.state.mouseDownX==e.pageX&&a.state.mouseDownY==e.pageY}))},this.onContextMenuEvent=function(e){var t,r,o=[],i=null===(t=a.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(),l=null==i?void 0:i.getInlineElementBefore(),s=e.target;2!=e.button&&l&&(s=l.getContainerNode()),a.state.contextMenuProviders.forEach((function(e){var t,r=null!==(t=e.getContextMenuItems(s))&&void 0!==t?t:[];(null==r?void 0:r.length)>0&&(o.length>0&&o.push(null),o.push.apply(o,(0,n.__spreadArray)([],(0,n.__read)(r),!1)))})),null===(r=a.editor)||void 0===r||r.triggerPluginEvent(16,{rawEvent:e,items:o})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,selectionRange:null,contextMenuProviders:(null===(r=e.plugins)||void 0===r?void 0:r.filter(i))||[],tableSelectionRange:null,imageSelectionRange:null,mouseDownX:null,mouseDownY:null,mouseUpEventListerAdded:!1}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,r,n,o=this;this.editor=e;var a=this.editor.getDocument(),i={keypress:this.getEventHandler(1),keydown:this.getEventHandler(0),keyup:this.getEventHandler(2),mousedown:this.onMouseDown,contextmenu:this.onContextMenuEvent,compositionstart:function(){return o.state.isInIME=!0},compositionend:function(t){o.state.isInIME=!1,e.triggerPluginEvent(4,{rawEvent:t})},dragstart:this.onDragStart,drop:this.onDrop,focus:this.onFocus,input:this.getEventHandler(3)};this.editor.getEnvironment().isSafari?(a.addEventListener("mousedown",this.onMouseDownDocument,!0),a.addEventListener("keydown",this.onKeyDownDocument),null===(t=a.defaultView)||void 0===t||t.addEventListener("blur",this.cacheSelection)):i.blur=this.cacheSelection,this.disposer=e.addDomEventHandler(i),this.state.scrollContainer.addEventListener("scroll",this.onScroll),null===(r=a.defaultView)||void 0===r||r.addEventListener("scroll",this.onScroll),null===(n=a.defaultView)||void 0===n||n.addEventListener("resize",this.onScroll)},e.prototype.dispose=function(){var e,t,r,n,o;this.removeMouseUpEventListener();var a=null===(e=this.editor)||void 0===e?void 0:e.getDocument();a&&(a.removeEventListener("mousedown",this.onMouseDownDocument,!0),a.removeEventListener("keydown",this.onKeyDownDocument),null===(t=a.defaultView)||void 0===t||t.removeEventListener("blur",this.cacheSelection)),null===(r=null==a?void 0:a.defaultView)||void 0===r||r.removeEventListener("resize",this.onScroll),null===(n=null==a?void 0:a.defaultView)||void 0===n||n.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),null===(o=this.disposer)||void 0===o||o.call(this),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.getEventHandler=function(e){var t=this;return{pluginEventType:e,beforeDispatch:function(r){return 3==e?t.onInputEvent(r):t.onKeyboardEvent(r)}}},e.prototype.removeMouseUpEventListener=function(){this.editor&&this.state.mouseUpEventListerAdded&&(this.state.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();function i(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.getContextMenuItems)}t.createDOMEventPlugin=function(e,t){return new a(e,t)}},9410:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLifecyclePlugin=void 0;var n=r(4791),o=r(1246),a="contenteditable",i=function(){function e(e,t){var r,n=this;this.editor=null,this.initializer=null,this.disposer=null,this.onInitialNodeCreated=function(e,t){var r;"Entity"!=(r=e).segmentType&&"Entity"!=r.blockType||!n.editor||n.editor.transformToDarkColor(t,0)},this.initialModel=null!==(r=e.initialModel)&&void 0!==r?r:this.createInitModel(e.defaultSegmentFormat),null===t.getAttribute(a)&&(this.initializer=function(){t.contentEditable="true",t.style.userSelect="text"},this.disposer=function(){t.style.userSelect="",t.removeAttribute(a)}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){n.adjustContainerColor(t)},this.state={isDarkMode:!!e.inDarkMode,onExternalContentTransform:null,shadowEditFragment:null}}return e.prototype.getName=function(){return"Lifecycle"},e.prototype.initialize=function(e){var t;this.editor=e,this.editor.setContentModel(this.initialModel,{ignoreSelection:!0},this.editor.isDarkMode()?this.onInitialNodeCreated:void 0),this.initialModel=(0,o.createContentModelDocument)(),null===(t=this.initializer)||void 0===t||t.call(this),this.adjustColor(),this.editor.triggerPluginEvent(11,{},!0)},e.prototype.dispose=function(){var e;null===(e=this.editor)||void 0===e||e.triggerPluginEvent(12,{},!0),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){7!=e.eventType||e.source!=n.ChangeSource.SwitchToDarkMode&&e.source!=n.ChangeSource.SwitchToLightMode||(this.state.isDarkMode=e.source==n.ChangeSource.SwitchToDarkMode,this.adjustColor())},e.prototype.adjustContainerColor=function(e){if(this.editor){var t=this.state.isDarkMode,r=this.editor.getDarkColorHandler();(0,o.setColor)(e,"#000000",!1,r,t),(0,o.setColor)(e,"#ffffff",!0,r,t)}},e.prototype.createInitModel=function(e){var t=(0,o.createContentModelDocument)(e),r=(0,o.createParagraph)(!1,void 0,e);return r.segments.push((0,o.createSelectionMarker)(e),(0,o.createBr)(e)),t.blocks.push(r),t},e}();t.createLifecyclePlugin=function(e,t){return new i(e,t)}},8701:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createStandaloneEditorCorePlugins=void 0;var n=r(1741),o=r(8135),a=r(4039),i=r(7174),l=r(9410);t.createStandaloneEditorCorePlugins=function(e,t){return{cache:(0,n.createContentModelCachePlugin)(e),format:(0,a.createContentModelFormatPlugin)(e),copyPaste:(0,o.createContentModelCopyPastePlugin)(e),domEvent:(0,i.createDOMEventPlugin)(e,t),lifecycle:(0,l.createLifecyclePlugin)(e,t)}}},7696:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addRangeToSelection=void 0,t.addRangeToSelection=function(e,t){var r,n=null===(r=e.defaultView)||void 0===r?void 0:r.getSelection();n&&(n.removeAllRanges(),n.addRange(t))}},547:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyDefaultFormat=void 0;var n=r(7582),o=r(2162),a=r(1246);function i(e,t,r){return(0,n.__assign)((0,n.__assign)((0,n.__assign)({},t),e.getPendingFormat()),r)}t.applyDefaultFormat=function(e,t){var r,n,l,s=e.getDOMSelection(),c="range"==(null==s?void 0:s.type)?s.range:null,d=null!==(r=null==c?void 0:c.startContainer)&&void 0!==r?r:null,u=null!==(n=null==c?void 0:c.startOffset)&&void 0!==n?n:null;if(d){for(var f=d;f&&e.contains(f);){if((0,a.isNodeOfType)(f,"ELEMENT_NODE")){if(null===(l=f.getAttribute)||void 0===l?void 0:l.call(f,"style"))return;if((0,a.isBlockElement)(f))break}f=f.parentNode}e.formatContentModel((function(r,n){var l=(0,o.deleteSelection)(r,[],n);if("range"==l.deleteResult)return(0,a.normalizeContentModel)(r),e.addUndoSnapshot(),!0;if("notDeleted"==l.deleteResult&&l.insertPoint&&d&&null!==u){var s=l.insertPoint,c=s.paragraph,f=s.path,p=s.marker,m=f[0].blocks,v=m.length,g=m.indexOf(c);if(c.isImplicit&&1==c.segments.length&&c.segments[0]==p&&v>0&&g==v-1){var h=m[g-1];"Paragraph"!=(null==h?void 0:h.blockType)&&(n.newPendingFormat=i(e,t,p.format))}else c.segments.every((function(e){return"Text"!=e.segmentType}))&&(n.newPendingFormat=i(e,t,p.format))}return!1}))}}},7202:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyPendingFormat=void 0;var n=r(7582),o=r(7269),a=r(1246);t.applyPendingFormat=function(e,t,r){var i=!1;e.formatContentModel((function(e,l){return(0,o.iterateSelections)(e,(function(e,o,l,s){if("Paragraph"==(null==l?void 0:l.blockType)&&1==(null==s?void 0:s.length)&&"SelectionMarker"==s[0].segmentType){var c=s[0],d=l.segments.indexOf(c),u=l.segments[d-1];if("Text"==(null==u?void 0:u.segmentType)){var f=u.text,p=f.substr(-t.length,t.length);if(p==t||" "==t&&" "==p){c.format=(0,n.__assign)({},r),u.text=f.substring(0,f.length-t.length);var m=(0,a.createText)(" "==t?" ":t,(0,n.__assign)((0,n.__assign)({},u.format),r));l.segments.splice(d,0,m),(0,a.setParagraphNotImplicit)(l),i=!0}}}return!0})),i&&((0,a.normalizeContentModel)(e),l.skipUndoSnapshot=!0),i}),{apiName:"applyPendingFormat"})}},4429:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areSameSelection=void 0,t.areSameSelection=function(e,t){if(e==t)return!0;switch(e.type){case"image":return"image"==t.type&&t.image==e.image;case"table":return"table"==t.type&&t.table==e.table&&t.firstColumn==e.firstColumn&&t.lastColumn==e.lastColumn&&t.firstRow==e.firstRow&&t.lastRow==e.lastRow;default:return"range"==t.type&&(r=t.range,n=e.range,!(!r||!n||r.startContainer!=n.startContainer||r.startOffset!=n.startOffset||r.endContainer!=n.endContainer||r.endOffset!=n.endOffset))}var r,n}},3343:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contentModelDomIndexer=void 0;var n=r(7582),o=r(1246),a=r(2569);function i(e){var t,r=null!==(t=e.__roosterjsContentModel)&&void 0!==t?t:{},n=r.paragraph,o=r.segments;return n&&"Paragraph"==n.blockType&&Array.isArray(n.segments)&&Array.isArray(o)}function l(e,t,r){e.__roosterjsContentModel={paragraph:t,segments:r}}function s(e,t){return(0,o.isNodeOfType)(e,"TEXT_NODE")?i(e)?d(e,t):void 0:t>=e.childNodes.length?c(e.lastChild,!0):c(e.childNodes[t],!1)}function c(e,t){var r;if(e&&i(e)){var n=e.__roosterjsContentModel,a=n.paragraph,l=n.segments,s=a.segments.indexOf(l[0]);if(s>=0){var c=!t&&a.segments[s-1]||a.segments[s];r=(0,o.createSelectionMarker)(c.format),a.segments.splice(t?s+1:s,0,r)}}return r}function d(e,t,r){var a,i,s=e.__roosterjsContentModel,c=s.paragraph,d=s.segments,u=d[0],f=d[d.length-1];if("Text"==(null==u?void 0:u.segmentType)&&"Text"==(null==f?void 0:f.segmentType)){var p=[],m=e.nodeValue||"",v=[];if(void 0===t)u.text=m,p.push(u),v.push(u);else{if(t>0&&(u.text=m.substring(0,t),p.push(u),v.push(u)),void 0===r){var g=(0,o.createSelectionMarker)(u.format);p.push(g),i=g,r=t}else if(r>t){var h=(0,o.createText)(m.substring(t,r),u.format,u.link,u.code);h.isSelected=!0,p.push(h),v.push(h),i=h}if(r<m.length){var b=(0,o.createText)(m.substring(r),u.format,u.link,u.code);p.push(b),v.push(b)}}var y=c.segments.indexOf(u),C=c.segments.indexOf(f);if(y>=0&&C>=0){for(;y>0&&"SelectionMarker"==c.segments[y-1].segmentType;)y--;for(;C<c.segments.length-1&&"SelectionMarker"==c.segments[C+1].segmentType;)C++;(a=c.segments).splice.apply(a,(0,n.__spreadArray)([y,C-y+1],(0,n.__read)(p),!1))}l(e,c,v),delete c.cachedElement}return i}t.contentModelDomIndexer={onSegment:l,onParagraph:function e(t){for(var r=null,n=t.firstChild;n;n=n.nextSibling)if((0,o.isNodeOfType)(n,"TEXT_NODE"))if(r){var a=i(r)?r.__roosterjsContentModel:void 0;a&&i(n)&&(a.segments=a.segments.concat(n.__roosterjsContentModel.segments),n.__roosterjsContentModel.segments=[])}else r=n;else(0,o.isNodeOfType)(n,"ELEMENT_NODE")?(r=null,e(n)):r=null},onTable:function(e,t){e.__roosterjsContentModel={tableRows:t.rows}},reconcileSelection:function(e,t,r){switch(r&&("range"==r.type&&r.range.collapsed&&(0,o.isNodeOfType)(r.range.startContainer,"TEXT_NODE")?i(r.range.startContainer)&&d(r.range.startContainer):(0,a.setSelection)(e)),t.type){case"image":case"table":return!1;case"range":var n=t.range;if(n){var l=n.startContainer,c=n.startOffset,u=n.endContainer,f=n.endOffset;if(n.collapsed)return!!s(l,c);if(l==u&&(0,o.isNodeOfType)(l,"TEXT_NODE"))return i(l)&&!!d(l,c,f);var p=s(l,c),m=s(u,f);return!(!p||!m||((0,a.setSelection)(e,p,m),0))}}return!1}}},4023:(e,t,r)=>{"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.DarkColorHandlerImpl=void 0;var a,i=r(6767),l=r(2347),s=/^\s*var\(\s*(\-\-[a-zA-Z0-9\-_]+)\s*(?:,\s*(.*))?\)\s*$/;!function(e){e[e.CssColor=0]="CssColor",e[e.HtmlColor=1]="HtmlColor"}(a||(a={}));var c=[(n={},n[0]="color",n[1]="color",n),(o={},o[0]="background-color",o[1]="bgcolor",o)],d=function(){function e(e,t){this.contentDiv=e,this.knownColors={},this.baseLightness=function(e){var t=21.25;if(e)try{t=i(e||void 0).lab().array()[0]}catch(e){}return t}(t)}return e.prototype.getKnownColorsCopy=function(){return Object.values(this.knownColors)},e.prototype.registerColor=function(e,t,r){var n,o=this.parseColorValue(e);return o&&(e=o.lightModeColor,r=o.darkModeColor||r,n=o.key),t&&e?(n=n||"--darkColor_"+e.replace(/[^\d\w]/g,"_"),this.knownColors[n]||(r=r||function(e,t){try{var r=i(e||void 0),n=r.lab().array(),o=(100-n[0])*((100-t)/100)+t;e=i.lab(o,n[1],n[2]).rgb().alpha(r.alpha()).toString()}catch(e){}return e}(e,this.baseLightness),this.knownColors[n]={lightModeColor:e,darkModeColor:r},this.contentDiv.style.setProperty(n,r)),"var("+n+", "+e+")"):e},e.prototype.reset=function(){var e=this;(0,l.getObjectKeys)(this.knownColors).forEach((function(t){return e.contentDiv.style.removeProperty(t)})),this.knownColors={}},e.prototype.parseColorValue=function(e,t){var r,n,o,a="";if(e){var i=e.startsWith("var(")?s.exec(e):null;i?i[2]?(n=i[1],a=i[2],o=null===(r=this.knownColors[n])||void 0===r?void 0:r.darkModeColor):a="":t?(a=this.findLightColorFromDarkColor(e)||"")&&(o=e):a=e}return{key:n,lightModeColor:a,darkModeColor:o}},e.prototype.findLightColorFromDarkColor=function(e){var t=this,r=(0,l.parseColor)(e);if(r){var n=(0,l.getObjectKeys)(this.knownColors).find((function(e){var n=(0,l.parseColor)(t.knownColors[e].darkModeColor);return n&&n[0]==r[0]&&n[1]==r[1]&&n[2]==r[2]}));if(n)return this.knownColors[n].lightModeColor}return null},e.prototype.transformElementColor=function(e,t,r){var n=this;c.forEach((function(o,a){var i=n.parseColorValue(e.style.getPropertyValue(o[0])||e.getAttribute(o[1]),!!t).lightModeColor;e.style.setProperty(o[0],null),e.removeAttribute(o[1]),i&&"inherit"!=i&&(0,l.setColor)(e,i,0!=a,r,!1,n)}))},e}();t.DarkColorHandlerImpl=d},7962:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultTrustHtmlHandler=t.createStandaloneEditorCore=void 0;var n=r(7582),o=r(8701),a=r(1718),i=r(4023),l=r(5904);function s(e){return e}t.createStandaloneEditorCore=function(e,t,r,c,d){var u,f=(0,o.createStandaloneEditorCorePlugins)(t,e);return(0,n.__assign)((0,n.__assign)((0,n.__assign)({contentDiv:e,api:(0,n.__assign)((0,n.__assign)((0,n.__assign)({},l.standaloneCoreApiMap),r),t.coreApiOverride),originalApi:(0,n.__assign)((0,n.__assign)({},l.standaloneCoreApiMap),r),plugins:(0,n.__spreadArray)((0,n.__spreadArray)([f.cache,f.format,f.copyPaste,f.domEvent],(0,n.__read)(d),!1),[f.lifecycle],!1),environment:(u=window.navigator.userAgent,{isMac:-1!=window.navigator.appVersion.indexOf("Mac"),isAndroid:/android/i.test(u),isSafari:u.indexOf("Safari")>=0&&u.indexOf("Chrome")<0&&u.indexOf("Android")<0}),darkColorHandler:new i.DarkColorHandlerImpl(e,t.baseDarkColor),imageSelectionBorderColor:t.imageSelectionBorderColor,trustedHTMLHandler:t.trustedHTMLHandler||s},(0,a.createStandaloneEditorDefaultSettings)(t)),function(e){return{domEvent:e.domEvent.getState(),copyPaste:e.copyPaste.getState(),cache:e.cache.getState(),format:e.format.getState(),lifecycle:e.lifecycle.getState()}}(f)),c)},t.defaultTrustHtmlHandler=s},1718:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createStandaloneEditorDefaultSettings=void 0;var n=r(1246),o=r(3484),a=r(5555);t.createStandaloneEditorDefaultSettings=function(e){var t=[{processorOverride:{table:a.tablePreProcessor}},e.defaultDomToModelOptions],r=[{metadataAppliers:{listItem:o.listItemMetadataApplier,listLevel:o.listLevelMetadataApplier}},e.defaultModelToDomOptions];return{defaultDomToModelOptions:t,defaultModelToDomOptions:r,defaultDomToModelConfig:(0,n.createDomToModelConfig)(t),defaultModelToDomConfig:(0,n.createModelToDomConfig)(r)}}},5904:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.standaloneCoreApiMap=void 0;var n=r(8952),o=r(313),a=r(562),i=r(4666),l=r(5192),s=r(6402),c=r(2065),d=r(3733);t.standaloneCoreApiMap={createContentModel:n.createContentModel,createEditorContext:o.createEditorContext,formatContentModel:a.formatContentModel,getDOMSelection:i.getDOMSelection,setContentModel:s.setContentModel,setDOMSelection:c.setDOMSelection,switchShadowEdit:d.switchShadowEdit,getVisibleViewport:l.getVisibleViewport}},79:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createStandaloneEditorCore=t.TableBorderFormat=t.NumberingListType=t.BulletListType=t.ChangeSource=t.updateListMetadata=t.updateTableMetadata=t.updateTableCellMetadata=t.updateImageMetadata=t.normalizeText=t.isSpace=t.isPunctuation=t.extractBorderValues=t.combineBorderValue=t.isModifierKey=t.isCharacterValue=t.setTableCellBackgroundColor=t.normalizeTable=t.applyTableFormat=t.setSelection=t.getSelectedSegmentsAndParagraphs=t.getSelectedSegments=t.getSelectedParagraphs=t.getOperationalBlocks=t.getFirstSelectedTable=t.getFirstSelectedListItem=t.deleteBlock=t.deleteSegment=t.deleteSelection=t.getSelectionRootNode=t.iterateSelections=t.createModelFromHtml=t.isBold=t.getClosestAncestorBlockGroupIndex=t.isBlockGroupOfType=t.mergeModel=t.paste=t.cloneModel=void 0;var n=r(1591);Object.defineProperty(t,"cloneModel",{enumerable:!0,get:function(){return n.cloneModel}});var o=r(3408);Object.defineProperty(t,"paste",{enumerable:!0,get:function(){return o.paste}});var a=r(5834);Object.defineProperty(t,"mergeModel",{enumerable:!0,get:function(){return a.mergeModel}});var i=r(4518);Object.defineProperty(t,"isBlockGroupOfType",{enumerable:!0,get:function(){return i.isBlockGroupOfType}});var l=r(2948);Object.defineProperty(t,"getClosestAncestorBlockGroupIndex",{enumerable:!0,get:function(){return l.getClosestAncestorBlockGroupIndex}});var s=r(3364);Object.defineProperty(t,"isBold",{enumerable:!0,get:function(){return s.isBold}});var c=r(6594);Object.defineProperty(t,"createModelFromHtml",{enumerable:!0,get:function(){return c.createModelFromHtml}});var d=r(7269);Object.defineProperty(t,"iterateSelections",{enumerable:!0,get:function(){return d.iterateSelections}});var u=r(9411);Object.defineProperty(t,"getSelectionRootNode",{enumerable:!0,get:function(){return u.getSelectionRootNode}});var f=r(2162);Object.defineProperty(t,"deleteSelection",{enumerable:!0,get:function(){return f.deleteSelection}});var p=r(3326);Object.defineProperty(t,"deleteSegment",{enumerable:!0,get:function(){return p.deleteSegment}});var m=r(6698);Object.defineProperty(t,"deleteBlock",{enumerable:!0,get:function(){return m.deleteBlock}});var v=r(7610);Object.defineProperty(t,"getFirstSelectedListItem",{enumerable:!0,get:function(){return v.getFirstSelectedListItem}}),Object.defineProperty(t,"getFirstSelectedTable",{enumerable:!0,get:function(){return v.getFirstSelectedTable}}),Object.defineProperty(t,"getOperationalBlocks",{enumerable:!0,get:function(){return v.getOperationalBlocks}}),Object.defineProperty(t,"getSelectedParagraphs",{enumerable:!0,get:function(){return v.getSelectedParagraphs}}),Object.defineProperty(t,"getSelectedSegments",{enumerable:!0,get:function(){return v.getSelectedSegments}}),Object.defineProperty(t,"getSelectedSegmentsAndParagraphs",{enumerable:!0,get:function(){return v.getSelectedSegmentsAndParagraphs}});var g=r(2569);Object.defineProperty(t,"setSelection",{enumerable:!0,get:function(){return g.setSelection}});var h=r(3074);Object.defineProperty(t,"applyTableFormat",{enumerable:!0,get:function(){return h.applyTableFormat}});var b=r(3834);Object.defineProperty(t,"normalizeTable",{enumerable:!0,get:function(){return b.normalizeTable}});var y=r(9556);Object.defineProperty(t,"setTableCellBackgroundColor",{enumerable:!0,get:function(){return y.setTableCellBackgroundColor}});var C=r(2060);Object.defineProperty(t,"isCharacterValue",{enumerable:!0,get:function(){return C.isCharacterValue}}),Object.defineProperty(t,"isModifierKey",{enumerable:!0,get:function(){return C.isModifierKey}});var S=r(1437);Object.defineProperty(t,"combineBorderValue",{enumerable:!0,get:function(){return S.combineBorderValue}}),Object.defineProperty(t,"extractBorderValues",{enumerable:!0,get:function(){return S.extractBorderValues}});var _=r(459);Object.defineProperty(t,"isPunctuation",{enumerable:!0,get:function(){return _.isPunctuation}}),Object.defineProperty(t,"isSpace",{enumerable:!0,get:function(){return _.isSpace}}),Object.defineProperty(t,"normalizeText",{enumerable:!0,get:function(){return _.normalizeText}});var k=r(3380);Object.defineProperty(t,"updateImageMetadata",{enumerable:!0,get:function(){return k.updateImageMetadata}});var P=r(7786);Object.defineProperty(t,"updateTableCellMetadata",{enumerable:!0,get:function(){return P.updateTableCellMetadata}});var w=r(6161);Object.defineProperty(t,"updateTableMetadata",{enumerable:!0,get:function(){return w.updateTableMetadata}});var M=r(3484);Object.defineProperty(t,"updateListMetadata",{enumerable:!0,get:function(){return M.updateListMetadata}});var E=r(4791);Object.defineProperty(t,"ChangeSource",{enumerable:!0,get:function(){return E.ChangeSource}});var O=r(6133);Object.defineProperty(t,"BulletListType",{enumerable:!0,get:function(){return O.BulletListType}});var T=r(1884);Object.defineProperty(t,"NumberingListType",{enumerable:!0,get:function(){return T.NumberingListType}});var F=r(314);Object.defineProperty(t,"TableBorderFormat",{enumerable:!0,get:function(){return F.TableBorderFormat}});var x=r(7962);Object.defineProperty(t,"createStandaloneEditorCore",{enumerable:!0,get:function(){return x.createStandaloneEditorCore}})},2624:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createObjectDefinition=t.createArrayDefinition=t.createStringDefinition=t.createBooleanDefinition=t.createNumberDefinition=void 0,t.createNumberDefinition=function(e,t,r,n,o){return{type:"number",isOptional:e,value:t,maxValue:n,minValue:r,allowNull:o}},t.createBooleanDefinition=function(e,t,r){return{type:"boolean",isOptional:e,value:t,allowNull:r}},t.createStringDefinition=function(e,t,r){return{type:"string",isOptional:e,value:t,allowNull:r}},t.createArrayDefinition=function(e,t,r,n,o){return{type:"array",isOptional:t,itemDef:e,minLength:r,maxLength:n,allowNull:o}},t.createObjectDefinition=function(e,t,r){return{type:"object",isOptional:t,propertyDef:e,allowNull:r}}},3380:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateImageMetadata=void 0;var n=r(1246),o=r(2624),a=(0,o.createNumberDefinition)(),i=(0,o.createObjectDefinition)({widthPx:a,heightPx:a,leftPercent:a,rightPercent:a,topPercent:a,bottomPercent:a,angleRad:a,src:(0,o.createStringDefinition)(),naturalHeight:a,naturalWidth:a});t.updateImageMetadata=function(e,t){return(0,n.updateMetadata)(e,t,i)}},3484:(e,t,r)=>{"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.updateListMetadata=t.listLevelMetadataApplier=t.listItemMetadataApplier=void 0;var a=r(7582),i=r(6133),l=r(2624),s=r(1246),c=r(1884),d=["decimal","lower-alpha","lower-roman"],u=["disc","circle","square"],f=/\$\{(\w+)\}/,p={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},m=((n={})[c.NumberingListType.Decimal]="decimal",n[c.NumberingListType.DecimalDash]='"${Number}- "',n[c.NumberingListType.DecimalParenthesis]='"${Number}) "',n[c.NumberingListType.DecimalDoubleParenthesis]='"(${Number}) "',n[c.NumberingListType.LowerAlpha]="lower-alpha",n[c.NumberingListType.LowerAlphaDash]='"${LowerAlpha}- "',n[c.NumberingListType.LowerAlphaParenthesis]='"${LowerAlpha}) "',n[c.NumberingListType.LowerAlphaDoubleParenthesis]='"(${LowerAlpha}) "',n[c.NumberingListType.UpperAlpha]="upper-alpha",n[c.NumberingListType.UpperAlphaDash]='"${UpperAlpha}- "',n[c.NumberingListType.UpperAlphaParenthesis]='"${UpperAlpha}) "',n[c.NumberingListType.UpperAlphaDoubleParenthesis]='"(${UpperAlpha}) "',n[c.NumberingListType.LowerRoman]="lower-roman",n[c.NumberingListType.LowerRomanDash]='"${LowerRoman}- "',n[c.NumberingListType.LowerRomanParenthesis]='"${LowerRoman}) "',n[c.NumberingListType.LowerRomanDoubleParenthesis]='"(${LowerRoman}) "',n[c.NumberingListType.UpperRoman]="upper-roman",n[c.NumberingListType.UpperRomanDash]='"${UpperRoman}- "',n[c.NumberingListType.UpperRomanParenthesis]='"${UpperRoman}) "',n[c.NumberingListType.UpperRomanDoubleParenthesis]='"(${UpperRoman}) "',n),v=((o={})[i.BulletListType.Disc]="disc",o[i.BulletListType.Square]='"∎ "',o[i.BulletListType.Circle]="circle",o[i.BulletListType.Dash]='"- "',o[i.BulletListType.LongArrow]='"➔ "',o[i.BulletListType.DoubleLongArrow]='"➔ "',o[i.BulletListType.ShortArrow]='"➢ "',o[i.BulletListType.UnfilledArrow]='"➪ "',o[i.BulletListType.Hyphen]='"— "',o);function g(e,t){var r="";for(e--;e>=0;)r=String.fromCharCode(e%26+65)+r,e=Math.floor(e/26)-1;return t?r.toLowerCase():r}function h(e,t){var r,n,o="";try{for(var i=(0,a.__values)((0,s.getObjectKeys)(p)),l=i.next();!l.done;l=i.next()){var c=l.value,d=Math.floor(e/p[c]);e-=d*p[c],o+=c.repeat(d)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return t?o.toLocaleLowerCase():o}var b=(0,l.createObjectDefinition)({orderedStyleType:(0,l.createNumberDefinition)(!0,void 0,c.NumberingListType.Min,c.NumberingListType.Max),unorderedStyleType:(0,l.createNumberDefinition)(!0,void 0,i.BulletListType.Min,i.BulletListType.Max)},!0,!0);function y(e){return e.indexOf('"')>=0}function C(e,t,r){var n=t.orderedStyleType,o=t.unorderedStyleType;return"OL"==e?void 0===n?d[r%d.length]:m[n]:void 0===o?u[r%u.length]:v[o]}t.listItemMetadataApplier={metadataDefinition:b,applierFunction:function(e,t,r){var n,o,a,i=r.listFormat.nodeStack.length-2;if(i>=0){var l=null!==(n=r.listFormat.nodeStack[i+1].listType)&&void 0!==n?n:"OL",s=C(l,null!=e?e:{},i);s&&y(s)?t.listStyleType="OL"==l?(o=s,a=r.listFormat.threadItemCounts[i],o?o.replace(f,(function(e,t){switch(t){case"Number":return a+"";case"LowerAlpha":return g(a,!0);case"UpperAlpha":return g(a,!1);case"LowerRoman":return h(a,!0);case"UpperRoman":return h(a,!1)}return""})):void 0):s:delete t.listStyleType}}},t.listLevelMetadataApplier={metadataDefinition:b,applierFunction:function(e,t,r){var n,o=r.listFormat.nodeStack.length-2;if(o>=0){var a=C(null!==(n=r.listFormat.nodeStack[o+1].listType)&&void 0!==n?n:"OL",null!=e?e:{},o);a&&!y(a)?t.listStyleType=a:delete t.listStyleType}}},t.updateListMetadata=function(e,t){return(0,s.updateMetadata)(e,t,b)}},7786:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateTableCellMetadata=void 0;var n=r(2624),o=r(1246),a=(0,n.createObjectDefinition)({bgColorOverride:(0,n.createBooleanDefinition)(!0),vAlignOverride:(0,n.createBooleanDefinition)(!0),borderOverride:(0,n.createBooleanDefinition)(!0)},!1,!0);t.updateTableCellMetadata=function(e,t){return(0,o.updateMetadata)(e,t,a)}},6161:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateTableMetadata=void 0;var n=r(314),o=r(1246),a=r(2624),i=(0,a.createStringDefinition)(!1,void 0,!0),l=(0,a.createBooleanDefinition)(!1),s=(0,a.createObjectDefinition)({topBorderColor:i,bottomBorderColor:i,verticalBorderColor:i,hasHeaderRow:l,headerRowColor:i,hasFirstColumn:l,hasBandedColumns:l,hasBandedRows:l,bgColorEven:i,bgColorOdd:i,tableBorderFormat:(0,a.createNumberDefinition)(!1,void 0,n.TableBorderFormat.Min,n.TableBorderFormat.Max),verticalAlign:i},!1,!0);t.updateTableMetadata=function(e,t){return(0,o.updateMetadata)(e,t,s)}},2539:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteExpandedSelection=void 0;var n=r(7582),o=r(6698),a=r(3326),i=r(7269),l=r(1246),s={contentUnderSelectedTableCell:"ignoreForTableOrCell",contentUnderSelectedGeneralElement:"generalElementOnly",includeListFormatHolder:"never"};function c(e,t,r,n){return{marker:e,paragraph:t,path:r,tableContext:n}}t.deleteExpandedSelection=function(e,t){var r={deleteResult:"notDeleted",insertPoint:null,formatContext:t};return(0,i.iterateSelections)(e,(function(t,i,s,d){var u=(0,l.createParagraph)(!0,void 0,e.format),f=e.format,p=0;if(d)d[0]&&"Paragraph"==(null==s?void 0:s.blockType)&&(p=(u=s).segments.indexOf(d[0]),f=d[0].format,r.lastParagraph=u,r.lastTableContext=i,d.forEach((function(e,n){0!=n||r.insertPoint||"SelectionMarker"!=e.segmentType?(0,a.deleteSegment)(s,e,r.formatContext)&&(r.deleteResult="range"):r.insertPoint=c(e,s,t,i)})),"range"==r.deleteResult&&(0,l.setParagraphNotImplicit)(s));else if(s){var m=t[0].blocks;(0,o.deleteBlock)(m,s,u,r.formatContext)&&(r.deleteResult="range")}else if(i){var v=i.table,g=i.colIndex,h=i.rowIndex,b=v.rows[h],y=b.cells[g];t=(0,n.__spreadArray)([y],(0,n.__read)(t),!1),u.segments.push((0,l.createBr)(e.format)),y.blocks=[u],delete y.cachedElement,delete b.cachedElement,r.deleteResult="range"}if(!r.insertPoint){var C=(0,l.createSelectionMarker)(f);(0,l.setParagraphNotImplicit)(u),u.segments.splice(p,0,C),r.insertPoint=c(C,u,t,i)}}),s),r}},7411:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSingleChar=void 0;var n=r(7582);t.deleteSingleChar=function(e,t){for(var r=(0,n.__spreadArray)([],(0,n.__read)(e),!1),o=0,a=t?0:r.length-1,i="notDeleted";a>=0&&a<r.length&&"done"!=i;a+=t?1:-1)switch(r[a]){case"‍":case"⃣":case"︎":case"️":i="notDeleted",o++;break;default:"notDeleted"==i?(i="waiting",o++):"waiting"==i&&(i="done")}return r.splice(t?0:r.length-o,o),r.join("")}},5555:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tablePreProcessor=void 0;var n=r(1246),o=r(9411);t.tablePreProcessor=function(e,t,r){var a=function(e,t){var r=(0,o.getSelectionRootNode)(t.selection);return(0,n.hasMetadata)(e)||t.isInSelection||r&&e.contains(r)}(t,r)?n.tableProcessor:n.entityProcessor;a(e,t,r)}},1437:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combineBorderValue=t.extractBorderValues=void 0;var r=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"],n=/^(thin|medium|thick|[\d\.]+\w*)$/;t.extractBorderValues=function(e){var t={};return(e||"").replace(/, /g,",").split(" ").forEach((function(e){r.indexOf(e)>=0&&!t.style?t.style=e:n.test(e)&&!t.width?t.width=e:e&&!t.color&&(t.color=e)})),t},t.combineBorderValue=function(e){return[e.width||"",e.style||"",e.color||""].join(" ").trim()||"none"}},2060:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCharacterValue=t.isModifierKey=void 0;function r(e){var t=e.ctrlKey||"Control"===e.key,r=e.altKey||"Alt"===e.key,n=e.metaKey||"Meta"===e.key;return t||r||n}t.isModifierKey=r,t.isCharacterValue=function(e){return!r(e)&&!!e.key&&1==e.key.length}},459:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeText=t.isSpace=t.isPunctuation=void 0;var r=/[\u2000\u2009\u200a​\u200b​\u202f\u205f​\u3000\s\t\r\n]/gm;t.isPunctuation=function(e){return'.,?!:"()[]\\/'.indexOf(e)>=0},t.isSpace=function(e){var t,n=null!==(t=null==e?void 0:e.charCodeAt(0))&&void 0!==t?t:0;return 160==n||32==n||r.test(e)},t.normalizeText=function(e,t){return e.replace(t?/^\u0020+/:/\u0020+$/," ")}},1591:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneModel=void 0;var n=r(7582);function o(e){return{format:Object.assign({},e.format)}}function a(e){return{dataset:Object.assign({},e.dataset)}}function i(e){var t=e.blockType;return Object.assign({blockType:t},o(e))}function l(e,t){return{blockGroupType:e.blockGroupType,blocks:e.blocks.map((function(e){return function(e,t){switch(e.blockType){case"BlockGroup":switch(e.blockGroupType){case"FormatContainer":return function(e,t){var r=e.tagName,n=e.cachedElement,o=Object.assign({tagName:r,cachedElement:p(n,"cache",t)},i(e),l(e,t));return e.zeroFontSize&&(o.zeroFontSize=!0),o}(e,t);case"General":return u(e,t);case"ListItem":return function(e,t){var r=e.formatHolder,n=e.levels;return Object.assign({formatHolder:f(r),levels:n.map(d)},i(e),l(e,t))}(e,t)}break;case"Divider":return function(e,t){var r=e.tagName,n=e.isSelected,o=e.cachedElement;return Object.assign({isSelected:n,tagName:r,cachedElement:p(o,"cache",t)},i(e))}(e,t);case"Entity":return c(e,t);case"Paragraph":return function(e,t){var r=e.cachedElement,l=e.segments,d=e.isImplicit,m=e.decorator,v=e.segmentFormat,g=Object.assign({cachedElement:p(r,"cache",t),isImplicit:d,segments:l.map((function(e){return function(e,t){switch(e.segmentType){case"Br":return s(e);case"Entity":return c(e,t);case"General":return function(e,t){return Object.assign(u(e,t),s(e))}(e,t);case"Image":return i=(o=e).src,l=o.alt,d=o.title,p=o.isSelectedAsImageSelection,Object.assign({src:i,alt:l,title:d,isSelectedAsImageSelection:p},s(o),a(o));case"SelectionMarker":return f(e);case"Text":return n=(r=e).text,Object.assign({text:n},s(r))}var r,n,o,i,l,d,p}(e,t)})),segmentFormat:v?(0,n.__assign)({},v):void 0},i(e),o(e));return m&&(g.decorator=Object.assign({tagName:m.tagName},o(m))),g}(e,t);case"Table":return function(e,t){var r=e.cachedElement,n=e.widths,s=e.rows;return Object.assign({cachedElement:p(r,"cache",t),widths:Array.from(n),rows:s.map((function(e){return function(e,t){var r=e.height,n=e.cells,i=e.cachedElement;return Object.assign({height:r,cachedElement:p(i,"cache",t),cells:n.map((function(e){return function(e,t){var r=e.cachedElement,n=e.isSelected,i=e.spanAbove,s=e.spanLeft,c=e.isHeader;return Object.assign({cachedElement:p(r,"cache",t),isSelected:n,spanAbove:i,spanLeft:s,isHeader:c},l(e,t),o(e),a(e))}(e,t)}))},o(e))}(e,t)}))},i(e),a(e))}(e,t)}}(e,t)}))}}function s(e){var t=e.segmentType,r=e.isSelected,n=e.code,i=e.link,l=Object.assign({segmentType:t,isSelected:r},o(e));return n&&(l.code=o(n)),i&&(l.link=Object.assign(o(i),a(i))),l}function c(e,t){var r=e.wrapper,o=e.entityFormat;return Object.assign({wrapper:p(r,"entity",t),entityFormat:(0,n.__assign)({},o)},i(e),s(e))}function d(e){var t=e.listType;return Object.assign({listType:t},o(e),a(e))}function u(e,t){var r=e.element;return Object.assign({element:p(r,"general",t)},i(e),l(e,t))}function f(e){return Object.assign({isSelected:e.isSelected},s(e))}function p(e,t,r){var n=r.includeCachedElement;if(e){if(n){if(!0===n)return e;var o=n(e,t);if(("general"==t||"entity"==t)&&!o)throw new Error("Entity and General Model must has wrapper element");return o}return"cache"==t?void 0:e.cloneNode(!0)}}t.cloneModel=function(e,t){var r=l(e,t||{});return e.format&&(r.format=Object.assign({},e.format)),r}},6594:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createModelFromHtml=void 0;var n=r(1246);t.createModelFromHtml=function(e,t,r){var o,a=(new DOMParser).parseFromString(null!==(o=null==r?void 0:r(e))&&void 0!==o?o:e,"text/html");return(null==a?void 0:a.body)?(0,n.domToContentModel)(a.body,(0,n.createDomToModelContext)(void 0,t)):void 0}},2948:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClosestAncestorBlockGroupIndex=void 0,t.getClosestAncestorBlockGroupIndex=function(e,t,r){void 0===r&&(r=[]);for(var n=0;n<e.length;n++){var o=e[n];if(t.indexOf(o.blockGroupType)>=0)return n;if(r.indexOf(o.blockGroupType)>=0)return-1}return-1}},4518:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBlockGroupOfType=void 0,t.isBlockGroupOfType=function(e,t){return(null==e?void 0:e.blockGroupType)==t}},3364:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBold=void 0,t.isBold=function(e){return!!e&&("bold"==e||"bolder"==e||parseInt(e)>=600)}},5834:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeModel=void 0;var n=r(7582),o=r(3074),a=r(2162),i=r(2948),l=r(3834),s=r(1246),c=["h1","h2","h3","h4","h5","h6"];function d(e,t,r,o,a){var i=e.paragraph,l=e.marker,d=r?i:p(e,t.format),u=d.segments.indexOf(l);if("none"==(null==a?void 0:a.mergeFormat)&&r&&(d.segments.forEach((function(e){e.format=(0,n.__assign)((0,n.__assign)({},d.segmentFormat||{}),e.format)})),delete d.segmentFormat),u>=0)for(var f=0;f<t.segments.length;f++){var m=t.segments[f];d.segments.splice(u+f,0,m),o&&("Entity"==m.segmentType&&o.newEntities.push(m),"Image"==m.segmentType&&o.newImages.push(m))}if(t.decorator&&(d.decorator=(0,n.__assign)({},t.decorator),c.indexOf(d.decorator.tagName)>-1)){var v=(0,s.getObjectKeys)(d.decorator.format),g=(0,s.getObjectKeys)(d.segmentFormat||{});v.forEach((function(e){var t;g.indexOf(e)>-1&&(null===(t=d.segmentFormat)||void 0===t||delete t[e])}))}r||(d.format=t.format)}function u(e,t,r){var n,a,i=e.tableContext,c=e.marker;if(i&&1==r.blocks.length&&r.blocks[0]==t){for(var d=i.table,u=i.colIndex,f=i.rowIndex,p=0;p<t.rows.length;p++)for(var v=0;v<t.rows[p].cells.length;v++){var g=t.rows[p].cells[v];if(0==p&&u+v>=d.rows[0].cells.length)for(var h=0;h<d.rows.length;h++){var b=null===(n=d.rows[h])||void 0===n?void 0:n.cells[u+v-1];d.rows[h].cells[u+v]=(0,s.createTableCell)(!1,!1,null==b?void 0:b.isHeader,null==b?void 0:b.format)}if(0==v&&f+p>=d.rows.length)for(d.rows[f+p]||(d.rows[f+p]={cells:[],format:{},height:0}),h=0;h<d.rows[f].cells.length;h++){var y=null===(a=d.rows[f+p-1])||void 0===a?void 0:a.cells[h];d.rows[f+p].cells[h]=(0,s.createTableCell)(!1,!1,!1,null==y?void 0:y.format)}var C=d.rows[f+p].cells[u+v];if(d.rows[f+p].cells[u+v]=g,0==p&&0==v){var S=(0,s.createSelectionMarker)(c.format),_=(0,s.addSegment)(g,S);e.path[0]==C&&(e.path[0]=g,e.marker=S,e.paragraph=_)}}(0,l.normalizeTable)(d,e.marker.format),(0,o.applyTableFormat)(d,void 0,!0)}else m(e,t)}function f(e,t){p(e,t.format);var r=e.path,o=e.paragraph,a=(0,i.getClosestAncestorBlockGroupIndex)(r,["ListItem"]),l=r[a],s=r[a+1],c=s.blocks.indexOf(l||o);c>=0&&s.blocks.splice(c,0,t),l&&(null==l||l.levels.forEach((function(e,r){t.levels[r]=(0,n.__assign)({},e)})))}function p(e,t){var r=e.paragraph,o=e.marker,a=e.path,l=r.segments.indexOf(o),c=a[0].blocks.indexOf(r),d=(0,s.createParagraph)(!1,(0,n.__assign)((0,n.__assign)({},r.format),t),r.segmentFormat);l>=0&&(d.segments=r.segments.splice(l)),c>=0&&a[0].blocks.splice(c+1,0,d);var u=(0,i.getClosestAncestorBlockGroupIndex)(a,["ListItem"],["FormatContainer","TableCell"]),f=a[u];if(f){var p=u>=0?a[u+1]:null,m=p?p.blocks.indexOf(f):-1;if(m>=0&&p){var v=(0,s.createListItem)(f.levels,f.formatHolder.format);c>=0&&(v.blocks=f.blocks.splice(c+1)),m>=0&&p.blocks.splice(m+1,0,v),a[u]=v}}return e.paragraph=d,d}function m(e,t){var r=e.path,n=p(e,"Paragraph"!==t.blockType?{}:t.format),o=r[0].blocks.indexOf(n);o>=0&&r[0].blocks.splice(o,0,t)}function v(e,t,r){e.blocks.forEach((function(e){var o;switch(e.blockType){case"BlockGroup":"ListItem"==e.blockGroupType&&(e.formatHolder.format=g(r,t,e.formatHolder.format)),v(e,t,r);break;case"Table":e.rows.forEach((function(e){return e.cells.forEach((function(e){v(e,t,r)}))}));break;case"Paragraph":var a=(null===(o=e.decorator)||void 0===o?void 0:o.format)||{};e.segments.forEach((function(e){"General"==e.segmentType&&v(e,t,r),e.format=g(r,t,(0,n.__assign)((0,n.__assign)({},a),e.format))})),"keepSourceEmphasisFormat"===r&&delete e.decorator}}))}function g(e,t,r){return"mergeAll"==e?(0,n.__assign)((0,n.__assign)({},t),r):(0,n.__assign)((0,n.__assign)({},t),(a={},i=(o=r).fontWeight,l=o.italic,s=o.underline,i&&"normal"!=i&&(a.fontWeight=i),l&&(a.italic=l),s&&(a.underline=s),a));var o,a,i,l,s}t.mergeModel=function(e,t,r,o){var i,l=null!==(i=null==o?void 0:o.insertPosition)&&void 0!==i?i:(0,a.deleteSelection)(e,[],r).insertPoint;if(l){(null==o?void 0:o.mergeFormat)&&"none"!=o.mergeFormat&&v(t,(0,n.__assign)((0,n.__assign)({},e.format||{}),l.marker.format),null==o?void 0:o.mergeFormat);for(var c=0;c<t.blocks.length;c++){var p=t.blocks[c];switch(p.blockType){case"Paragraph":d(l,p,0==c,r,o);break;case"Divider":m(l,p);break;case"Entity":m(l,p),null==r||r.newEntities.push(p);break;case"Table":1==t.blocks.length&&(null==o?void 0:o.mergeTable)?u(l,p,t):m(l,p);break;case"BlockGroup":switch(p.blockGroupType){case"General":case"FormatContainer":m(l,p);break;case"ListItem":f(l,p)}}}}return(0,s.normalizeContentModel)(e),l}},3408:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergePasteContent=t.paste=void 0;var n=r(7582),o=r(4791),a=r(7610),i=r(5834),l=r(1246),s=r(2347),c={asImage:3,asPlainText:1,mergeFormat:2,normal:0},d={backgroundColor:"",fontFamily:"",fontSize:"",fontWeight:"",italic:!1,letterSpacing:"",lineHeight:"",strikethrough:!1,superOrSubScriptSequence:"",textColor:"",underline:!1};function u(e,t,r,n,o){return o?o(e,r):(0,i.mergeModel)(e,r,t,{mergeFormat:n?"keepSourceEmphasisFormat":"none",mergeTable:f(r)})}function f(e){return 2==e.blocks.length&&"Table"===e.blocks[0].blockType&&"Paragraph"===e.blocks[1].blockType&&1===e.blocks[1].segments.length&&"Br"===e.blocks[1].segments[0].segmentType&&e.blocks.splice(1),1===e.blocks.length&&"Table"===e.blocks[0].blockType}t.paste=function(e,t,r){var i;void 0===r&&(r="normal"),t.snapshotBeforePaste?e.setContent(t.snapshotBeforePaste):t.snapshotBeforePaste=e.getContent(2),e.focus(),e.formatContentModel((function(o,f){var p,m=function(e,t,r){var n=(0,s.createDefaultHtmlSanitizerOptions)();return n.cssStyleCallbacks["caret-color"]=function(){return!1},{clipboardData:t,fragment:e.getDocument().createDocumentFragment(),sanitizingOption:n,htmlBefore:"",htmlAfter:"",htmlAttributes:{},domToModelOption:{},pasteType:c[r]}}(e,t,r),v=(0,a.getSelectedSegments)(o,!0)[0],g=null!==(p=null==v?void 0:v.format)&&void 0!==p?p:{},h=g.fontFamily,b=g.fontSize,y=g.textColor,C=g.backgroundColor,S=g.letterSpacing,_=g.lineHeight,k=function(e,t,r,o,a){var i=(0,n.__assign)({eventType:10},o),c=i.fragment,d=t.rawHtml,u=t.text,f=t.imageDataUri,p=e.getTrustedHTMLHandler(),m=d?(new DOMParser).parseFromString(p(d),"text/html"):void 0;(0,s.retrieveMetadataFromClipboard)(m,i,p),"asImage"==r&&f||"asPlainText"!=r&&!u&&f?(0,s.handleImagePaste)(f,c):"asPlainText"!=r&&d&&m&&m.body?(0,l.moveChildNodes)(c,null==m?void 0:m.body):u&&(0,s.handleTextPaste)(u,null,c);var v=c.ownerDocument.createElement("span");(0,l.moveChildNodes)(v,c),c.appendChild(v),(0,l.applySegmentFormatToElement)(v,a);var g=i;return"asPlainText"!==r&&(g=e.triggerPluginEvent(10,i,!0)),(0,s.sanitizePasteContent)(i,null),g}(e,t,r,m,{fontFamily:h,fontSize:b,textColor:y,backgroundColor:C,letterSpacing:S,lineHeight:_}),P=k.domToModelOption,w=k.fragment,M=k.customizedMerge,E=u(o,f,(0,l.domToContentModel)(w,(0,l.createDomToModelContext)(void 0,P)),"mergeFormat"==r,M);return E&&(i=E.marker.format),i&&(f.newPendingFormat=(0,n.__assign)((0,n.__assign)({},d),i)),!0}),{changeSource:o.ChangeSource.Paste,getChangeData:function(){return t},apiName:"paste"})},t.mergePasteContent=u},7610:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstSelectedListItem=t.getFirstSelectedTable=t.getOperationalBlocks=t.getSelectedParagraphs=t.getSelectedSegments=t.getSelectedSegmentsAndParagraphs=void 0;var n=r(7582),o=r(2948),a=r(4518),i=r(7269);function l(e,t){var r=c(e,{includeListFormatHolder:t?"allSegments":"never"}),n=[];return r.forEach((function(e){var r=e.segments,o=e.block;r&&(t&&!o||"Paragraph"==(null==o?void 0:o.blockType))&&r.forEach((function(e){"Entity"==e.segmentType&&e.entityFormat.isReadonly||n.push([e,"Paragraph"==(null==o?void 0:o.blockType)?o:null])}))})),n}function s(e,t,r,n){var a=[],i=n?t.map((function(e){return[e]})):[t],l=c(e,{includeListFormatHolder:"never",contentUnderSelectedTableCell:"ignoreForTable"});return d(l),l.forEach((function(e){for(var t=e.path,n=e.block,l=function(e){var l=(0,o.getClosestAncestorBlockGroupIndex)(t,i[e],r);return l>=0?(a.filter((function(e){return e.block==t[l]})).length<=0&&a.push({parent:t[l+1],block:t[l]}),"break"):e==i.length-1&&n?(a.push({parent:t[0],block:n}),"break"):void 0},s=0;s<i.length&&"break"!==l(s);s++);})),a}function c(e,t){var r=[];return(0,i.iterateSelections)(e,(function(e,t,n,o){r.push({path:e,tableContext:t,block:n,segments:o})}),t),r}function d(e){e.length>1&&u(e,!1)&&e.pop(),e.length>1&&u(e,!0)&&e.shift()}function u(e,t){var r,n=e[t?0:e.length-1];if("Paragraph"==(null===(r=n.block)||void 0===r?void 0:r.blockType)&&n.segments&&n.segments.length>0){var o=n.block.segments,a=n.segments[0];return 1==n.segments.length&&"SelectionMarker"==a.segmentType&&a==o[t?o.length-1:0]}return!1}t.getSelectedSegmentsAndParagraphs=l,t.getSelectedSegments=function(e,t){return l(e,t).map((function(e){return e[0]}))},t.getSelectedParagraphs=function(e){var t=c(e,{includeListFormatHolder:"never"}),r=[];return d(t),t.forEach((function(e){var t=e.block;"Paragraph"==(null==t?void 0:t.blockType)&&r.push(t)})),r},t.getOperationalBlocks=s,t.getFirstSelectedTable=function(e){var t,r=c(e,{includeListFormatHolder:"never"}),o=[];return d(r),r.forEach((function(e){var r=e.block,a=e.tableContext,i=e.path;if(!t)if("Table"==(null==r?void 0:r.blockType))t=r,o=(0,n.__spreadArray)([],(0,n.__read)(i),!1);else if(null==a?void 0:a.table){t=a.table;var l=i.filter((function(e){return e.blocks.indexOf(a.table)>=0}))[0],s=i.indexOf(l);o=s>=0?i.slice(s):[]}})),[t,o]},t.getFirstSelectedListItem=function(e){var t;return s(e,["ListItem"],["TableCell"]).forEach((function(e){!t&&(0,a.isBlockGroupOfType)(e.block,"ListItem")&&(t=e.block)})),t}},6698:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBlock=void 0,t.deleteBlock=function(e,t,r,n,o){var a=e.indexOf(t);switch(t.blockType){case"Table":case"Divider":return r?e.splice(a,1,r):e.splice(a,1),!0;case"Entity":var i=t.isSelected?"overwrite":"forward"==o?"removeFromStart":"backward"==o?"removeFromEnd":void 0;return void 0!==i&&(r?e.splice(a,1,r):e.splice(a,1),null==n||n.deletedEntities.push({entity:t,operation:i})),!0;case"BlockGroup":switch(t.blockGroupType){case"General":return!!r&&(e.splice(a,1,r),!0);case"ListItem":case"FormatContainer":return e.splice(a,1),!0}}return!1}},3326:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSegment=void 0;var n=r(7411),o=r(1246),a=r(459);t.deleteSegment=function(e,t,r,i){var l=e.segments,s=l.indexOf(t),c=(0,o.isWhiteSpacePreserved)(e),d="forward"==i,u="backward"==i;switch(c||function(e,t){for(var r,n=t-1;"SelectionMarker"==(null===(r=e[n])||void 0===r?void 0:r.segmentType);)n--;var a=e[n];a&&(0,o.normalizeSingleSegment)(a)}(l,s),t.segmentType){case"Br":case"Image":case"SelectionMarker":return l.splice(s,1),!0;case"Entity":var f=t.isSelected?"overwrite":d?"removeFromStart":u?"removeFromEnd":void 0;return void 0!==f&&(l.splice(s,1),null==r||r.deletedEntities.push({entity:t,operation:f})),!0;case"Text":var p=t.text;return 0==p.length||t.isSelected?l.splice(s,1):i&&(p=(0,n.deleteSingleChar)(p,d),c||(p=(0,a.normalizeText)(p,d)),""==p?l.splice(s,1):t.text=p),!0;case"General":return!!t.isSelected&&(l.splice(s,1),!0)}}},2162:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSelection=void 0;var n=r(7582),o=r(2539);t.deleteSelection=function(e,t,r){void 0===t&&(t=[]);var a=(0,o.deleteExpandedSelection)(e,r);return t.forEach((function(e){e&&function(e){return!!e.insertPoint}(a)&&"notDeleted"==a.deleteResult&&e(a)})),function(e){var t,r=e.insertPoint,o=e.deleteResult,a=e.lastParagraph,i=e.lastTableContext;r&&"notDeleted"!=o&&"nothingToDelete"!=o&&a&&a!=r.paragraph&&i==r.tableContext&&((t=r.paragraph.segments).push.apply(t,(0,n.__spreadArray)([],(0,n.__read)(a.segments),!1)),a.segments=[])}(a),a}},9411:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionRootNode=void 0,t.getSelectionRootNode=function(e){return e?"range"==e.type?e.range.commonAncestorContainer:"table"==e.type?e.table:"image"==e.type?e.image:void 0:void 0}},7269:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iterateSelections=void 0;var n=r(7582);function o(e,t,r,a,i){for(var l=e[0],s=(null==r?void 0:r.includeListFormatHolder)||"allSegments",c=(null==r?void 0:r.contentUnderSelectedTableCell)||"include",d=(null==r?void 0:r.contentUnderSelectedGeneralElement)||"contentOnly",u=!1,f=!1,p=0;p<l.blocks.length;p++){var m=l.blocks[p];switch(m.blockType){case"BlockGroup":var v=(0,n.__spreadArray)([m],(0,n.__read)(e),!1);if("General"==m.blockGroupType){var g=!(O=i||m.isSelected)||"both"==d||"contentOnly"==d,h=O&&("both"==d||"generalElementOnly"==d||0==m.blocks.length);if(g&&o(v,t,r,a,O)||h&&t(e,a,m))return!0}else if(o(v,t,r,a,i))return!0;break;case"Table":var b=m.rows,y=b.every((function(e){return e.cells.every((function(e){return e.isSelected}))}));if("include"!=c&&y){if(t(e,a,m))return!0}else for(var C=0;C<b.length;C++)for(var S=b[C],_=0;_<S.cells.length;_++){var k=S.cells[_];if(k){var P={table:m,rowIndex:C,colIndex:_,isWholeTableSelected:y};if(k.isSelected&&t(e,P))return!0;if((!k.isSelected||"ignoreForTableOrCell"!=c)&&o((0,n.__spreadArray)([k],(0,n.__read)(e),!1),t,r,P,O=i||k.isSelected))return!0}}break;case"Paragraph":for(var w=[],M=0;M<m.segments.length;M++){var E=m.segments[M],O=i||E.isSelected;if("General"==E.segmentType){if(g=!O||"both"==d||"contentOnly"==d,h=O&&("both"==d||"generalElementOnly"==d||0==E.blocks.length),g&&o((0,n.__spreadArray)([E],(0,n.__read)(e),!1),t,r,a,O))return!0;h&&w.push(E)}else O&&w.push(E);O?u=!0:f=!0}if(w.length>0&&t(e,a,m,w))return!0;break;case"Divider":case"Entity":if((i||m.isSelected)&&t(e,a,m))return!0}}return!("never"==s||"ListItem"!=l.blockGroupType||!u||f&&"anySegment"!=s||!t(e,a,void 0,[l.formatHolder]))}t.iterateSelections=function(e,t,r){o([e],(function(e,r,n,o){var a;return(null===(a=n)||void 0===a?void 0:a.cachedElement)&&delete n.cachedElement,t(e,r,n,o)}),r)}},2569:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSelection=void 0;var n=r(1246);function o(e,t,r,s){return l(t,e,r,s,(function(t){return(0,n.isGeneralSegment)(e)&&i(e,t),e.blocks.forEach((function(e){t=function(e,t,r,n){switch(e.blockType){case"BlockGroup":return o(e,t,r,n);case"Table":return function(e,t,r,n){var l=a(e,r),s=n?a(e,n):l;if(t)e.rows.forEach((function(e){return e.cells.forEach((function(e){t=o(e,t,r,n)}))}));else for(var c=0;c<e.rows.length;c++)for(var d=e.rows[c],u=0;u<d.cells.length;u++){var f=e.rows[c].cells[u],p=c>=l.row&&c<=s.row&&u>=l.col&&u<=s.col;i(f,p),p||o(f,!1,r,n)}return t}(e,t,r,n);case"Divider":case"Entity":return l(t,e,r,n,(function(t){return t?e.isSelected=!0:delete e.isSelected,t}));case"Paragraph":var s=[];for(e.segments.forEach((function(e,a){t=l(t,e,r,n,(function(t){return function(e,t,r,n,a,l){switch(e.segmentType){case"SelectionMarker":return(!t||e!=n&&e!=a)&&r.push(l),t;case"General":return i(e,t),e!=n&&e!=a?o(e,t,n,a):t;case"Image":return i(e,t),e.isSelectedAsImageSelection=n==e&&(!a||a==e),t;default:return i(e,t),t}}(e,t,s,r,n,a)}))}));s.length>0;){var c=s.pop();c>=0&&e.segments.splice(c,1)}return t;default:return t}}(e,t,r,s)})),t}))}function a(e,t){var r=-1;return{row:t?e.rows.findIndex((function(e){return(r=e.cells.indexOf(t))>=0})):-1,col:r}}function i(e,t){return t?e.isSelected=!0:delete e.isSelected,t}function l(e,t,r,n,o){return(e=o(e=e||t==r))&&!!n&&t!=n}t.setSelection=function(e,t,r){o(e,!1,t||null,r||null)}},3074:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.applyTableFormat=void 0;var o=r(7582),a=r(1246),i=r(1437),l=r(9556),s=r(314),c=r(7786),d=r(6161),u={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:s.TableBorderFormat.Default,verticalAlign:null};t.applyTableFormat=function(e,t,r){var n=e.rows;(0,d.updateTableMetadata)(e,(function(s){var d=(0,o.__assign)((0,o.__assign)((0,o.__assign)({},u),s),t||{}),v=function(e,t){var r={bgColorOverrides:[],vAlignOverrides:[],borderOverrides:[]};return e.forEach((function(e){var n=[],o=[],a=[];r.bgColorOverrides.push(n),r.vAlignOverrides.push(o),r.borderOverrides.push(a),e.cells.forEach((function(e){(0,c.updateTableCellMetadata)(e,(function(e){return e&&t?(n.push(!1),delete e.bgColorOverride):n.push(!!(null==e?void 0:e.bgColorOverride)),o.push(!!(null==e?void 0:e.vAlignOverride)),a.push(!!(null==e?void 0:e.borderOverride)),e}))}))})),r}(n,!r);return delete e.cachedElement,function(e){e.forEach((function(e){e.cells.forEach((function(e){delete e.cachedElement})),delete e.cachedElement}))}(n),function(e,t,r){var n=t.hasBandedRows,o=t.hasBandedColumns,s=t.bgColorOdd,c=t.bgColorEven;e.forEach((function(d,u){d.cells.forEach((function(p,v){var g;if(!r.borderOverrides[u][v]&&"number"==typeof t.tableBorderFormat){var h=null===(g=f[t.tableBorderFormat])||void 0===g?void 0:g.call(f,{firstRow:0===u,lastRow:u===e.length-1,firstColumn:0===v,lastColumn:v===d.cells.length-1}),b=[t.topBorderColor,t.verticalBorderColor,t.bottomBorderColor,t.verticalBorderColor];null==h||h.forEach((function(e,t){var r=!e&&b[t]||"";p.format[a.BorderKeys[t]]=(0,i.combineBorderValue)({style:m(r),width:"1px",color:r})}))}if(!r.bgColorOverrides[u][v]){var y=(n||o)&&(o&&v%2!=0||n&&u%2!=0)?s:c;(0,l.setTableCellBackgroundColor)(p,y,!1,!0)}t.verticalAlign&&!r.vAlignOverrides[u][v]&&(p.format.verticalAlign=t.verticalAlign)}))}))}(n,d,v),function(e,t,r){e.forEach((function(n,o){n.cells.forEach((function(n,a){t.hasFirstColumn&&0===a?(n.isHeader=!0,0===o||r.bgColorOverrides[o][a]||(p(n.format,"borderTop"),(0,l.setTableCellBackgroundColor)(n,null,!1,!0)),o!==e.length-1&&0!==o&&p(n.format,"borderBottom")):n.isHeader=!1}))}))}(n,d,v),function(e,t,r){var n;null===(n=e[0])||void 0===n||n.cells.forEach((function(e,n){e.isHeader=t.hasHeaderRow,t.hasHeaderRow&&t.headerRowColor&&(r.bgColorOverrides[0][n]||(0,l.setTableCellBackgroundColor)(e,t.headerRowColor,!1,!0),p(e.format,"borderTop",t.headerRowColor),p(e.format,"borderRight",t.headerRowColor),p(e.format,"borderLeft",t.headerRowColor))}))}(n,d,v),d}))};var f=((n={})[s.TableBorderFormat.Default]=function(e){return[!1,!1,!1,!1]},n[s.TableBorderFormat.ListWithSideBorders]=function(e){return[!1,!e.lastColumn,!1,!e.firstColumn]},n[s.TableBorderFormat.FirstColumnHeaderExternal]=function(e){var t=e.firstColumn,r=e.firstRow;return[!r,!e.lastColumn&&!t||t&&r,!e.lastRow&&!r,!t]},n[s.TableBorderFormat.NoHeaderBorders]=function(e){var t=e.firstRow,r=e.firstColumn,n=e.lastColumn;return[t,t||n,!1,t||r]},n[s.TableBorderFormat.NoSideBorders]=function(e){var t=e.firstColumn;return[!1,e.lastColumn,!1,t]},n[s.TableBorderFormat.EspecialType1]=function(e){var t=e.firstRow,r=e.firstColumn;return[r&&!t,t,r&&!t,t&&!r]},n[s.TableBorderFormat.EspecialType2]=function(e){var t=e.firstRow,r=e.firstColumn;return[!t,t||!r,!t,!r]},n[s.TableBorderFormat.EspecialType3]=function(e){var t=e.firstColumn,r=e.firstRow;return[!0,r||!t,!r,!0]},n[s.TableBorderFormat.Clear]=function(){return[!0,!0,!0,!0]},n);function p(e,t,r){var n=(0,i.extractBorderValues)(e[t]);n.color=r||"",n.style=m(n.color),e[t]=(0,i.combineBorderValue)(n)}function m(e){return e&&"transparent"!=e?"solid":"none"}},3834:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeTable=void 0;var n=r(7582),o=r(1246);function a(e){return e<=4?120:e<=6?100:70}function i(e,t){var r;t.blocks.every((function(e){return"Paragraph"==e.blockType&&(0==(t=(t=e.segments).filter((function(e){return"SelectionMarker"!=e.segmentType}))).length||1==t.length&&"Br"==t[0].segmentType);var t}))||((r=e.blocks).push.apply(r,(0,n.__spreadArray)([],(0,n.__read)(t.blocks),!1)),t.blocks=[])}t.normalizeTable=function(e,t){var r,l=e.format;l.borderCollapse&&l.useBorderBox||(l.borderCollapse=!0,l.useBorderBox=!0),e.rows.forEach((function(e,r){e.cells.forEach((function(e,a){if(0==e.blocks.length){var i=e.format.textColor?(0,n.__assign)((0,n.__assign)({},t),{textColor:e.format.textColor}):t;(0,o.addBlock)(e,(0,o.createParagraph)(void 0,void 0,i)),(0,o.addSegment)(e,(0,o.createBr)(i))}0==r?e.spanAbove=!1:r>0&&e.isHeader&&(e.isHeader=!1,delete e.cachedElement),0==a&&(e.spanLeft=!1),e.format.useBorderBox=!0})),e.height<22&&(e.height=22)}));for(var s=Math.max.apply(Math,(0,n.__spreadArray)([],(0,n.__read)(e.rows.map((function(e){return e.cells.length}))),!1)),c=0;c<s;c++)void 0===e.widths[c]&&(e.widths[c]=a(s));for(var d=function(t){e.rows.forEach((function(e){var r=e.cells[t],n=e.cells[t-1];r&&n&&r.spanLeft&&i(n,r)})),e.rows.every((function(e){var r;return null===(r=e.cells[t])||void 0===r?void 0:r.spanLeft}))&&(e.rows.forEach((function(e){return e.cells.splice(t,1)})),e.widths.splice(t-1,2,e.widths[t-1]+e.widths[t]))},u=((null===(r=e.rows[0])||void 0===r?void 0:r.cells.length)||0)-1;u>0;u--)d(u);for(var f=function(t){var r=e.rows[t];r.cells.forEach((function(r,n){var o,a=null===(o=e.rows[t-1])||void 0===o?void 0:o.cells[n];a&&r.spanAbove&&i(a,r)})),r.cells.every((function(e){return e.spanAbove}))&&(e.rows[t-1].height+=r.height,e.rows.splice(t,1))},p=e.rows.length-1;p>0;p--)f(p)}},9556:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseColor=t.setTableCellBackgroundColor=void 0;var n=r(7582),o=r(7786);t.setTableCellBackgroundColor=function(e,t,r,a){if(t){e.format.backgroundColor=t,r&&(0,o.updateTableCellMetadata)(e,(function(e){return(e=e||{}).bgColorOverride=!0,e}));var i=function(e){var t=c(e);if(t){var r=t[0]/255,n=t[1]/255,o=t[2]/255;return 50*(Math.max(r,n,o)+Math.min(r,n,o))}return 255}(t);i<20?e.format.textColor="#ffffff":i>80?e.format.textColor="#000000":delete e.format.textColor,a&&e.format.textColor&&e.blocks.forEach((function(t){"Paragraph"==t.blockType&&(t.segmentFormat=(0,n.__assign)((0,n.__assign)({},t.segmentFormat),{textColor:e.format.textColor}),t.segments.forEach((function(t){t.format=(0,n.__assign)((0,n.__assign)({},t.format),{textColor:e.format.textColor})})))}))}else delete e.format.backgroundColor,delete e.format.textColor;delete e.cachedElement};var a=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,i=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,l=/^rgb\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,s=/^rgba\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/;function c(e){var t;return(t=(e=(e||"").trim()).match(a))?[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]:(t=e.match(i))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:(t=e.match(l)||e.match(s))?[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]:null}t.parseColor=c},3679:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultContentModelFormatMap=void 0,t.defaultContentModelFormatMap={a:{underline:!0},blockquote:{marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},code:{fontFamily:"monospace"},h1:{fontWeight:"bold",fontSize:"2em"},h2:{fontWeight:"bold",fontSize:"1.5em"},h3:{fontWeight:"bold",fontSize:"1.17em"},h4:{fontWeight:"bold",fontSize:"1em"},h5:{fontWeight:"bold",fontSize:"0.83em"},h6:{fontWeight:"bold",fontSize:"0.67em"},p:{marginTop:"1em",marginBottom:"1em"},pre:{fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"}}},1350:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultHTMLStyleMap=void 0;var r={display:"block"};t.defaultHTMLStyleMap={address:r,article:r,aside:r,b:{fontWeight:"bold"},blockquote:{display:"block",marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},br:r,center:{display:"block",textAlign:"center"},dd:r,div:r,dl:r,dt:r,em:{fontStyle:"italic"},fieldset:r,figcaption:r,figure:r,footer:r,form:r,h1:{display:"block",fontWeight:"bold",fontSize:"2em"},h2:{display:"block",fontWeight:"bold",fontSize:"1.5em"},h3:{display:"block",fontWeight:"bold",fontSize:"1.17em"},h4:{display:"block",fontWeight:"bold"},h5:{display:"block",fontWeight:"bold",fontSize:"0.83em"},h6:{display:"block",fontWeight:"bold",fontSize:"0.67em"},header:r,hr:r,i:{fontStyle:"italic"},li:{display:"list-item"},main:r,nav:r,ol:r,p:{display:"block",marginTop:"1em",marginBottom:"1em"},pre:{display:"block",fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"},s:{textDecoration:"line-through"},section:r,strike:{textDecoration:"line-through"},strong:{fontWeight:"bold"},sub:{verticalAlign:"sub",fontSize:"smaller"},sup:{verticalAlign:"super",fontSize:"smaller"},table:{display:"table",boxSizing:"border-box"},td:{display:"table-cell"},th:{display:"table-cell"},u:{textDecoration:"underline"},ul:r}},9968:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildFormatParsers=t.createDomToModelConfig=t.createDomToModelContextWithConfig=t.createDomToModelContext=void 0;var n=r(7582),o=r(3647),a=r(3871),i=r(8659);function l(e,t){return Object.assign({},t,{isInSelection:!1},{blockFormat:(null==t?void 0:t.isRootRtl)?{direction:"rtl"}:{},segmentFormat:{},listFormat:{levels:[],threadItemCounts:[]}},{link:{format:{},dataset:{}},code:{format:{}},blockDecorator:{format:{},tagName:""}},e)}function s(e){return{elementProcessors:Object.assign.apply(Object,(0,n.__spreadArray)([{},o.defaultProcessorMap],(0,n.__read)(e.map((function(e){return null==e?void 0:e.processorOverride}))),!1)),formatParsers:c(e.map((function(e){return null==e?void 0:e.formatParserOverride})),e.map((function(e){return null==e?void 0:e.additionalFormatParsers}))),defaultElementProcessors:o.defaultProcessorMap,defaultFormatParsers:i.defaultFormatParsers}}function c(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var r=Object.assign.apply(Object,(0,n.__spreadArray)([{}],(0,n.__read)(e),!1));return(0,a.getObjectKeys)(i.defaultFormatKeysPerCategory).reduce((function(e,o){var a,l=(a=i.defaultFormatKeysPerCategory[o].map((function(e){return void 0===r[e]?i.defaultFormatParsers[e]:r[e]}))).concat.apply(a,(0,n.__spreadArray)([],(0,n.__read)(t.map((function(e){var t;return null!==(t=null==e?void 0:e[o])&&void 0!==t?t:[]}))),!1));return e[o]=l,e}),{})}t.createDomToModelContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l(s(t),e)},t.createDomToModelContextWithConfig=l,t.createDomToModelConfig=s,t.buildFormatParsers=c},3647:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultProcessorMap=void 0;var n=r(2697),o=r(9384),a=r(9633),i=r(2130),l=r(7883),s=r(6905),c=r(5718),d=r(9004),u=r(1001),f=r(2625),p=r(3092),m=r(215),v=r(4748),g=r(1091),h=r(5476),b=r(2791),y=r(8191),C=r(970),S=r(9892);t.defaultProcessorMap={a:g.linkProcessor,b:v.knownElementProcessor,blockquote:v.knownElementProcessor,br:n.brProcessor,code:a.codeProcessor,div:v.knownElementProcessor,em:v.knownElementProcessor,font:c.fontProcessor,i:v.knownElementProcessor,img:m.imageProcessor,h1:f.headingProcessor,h2:f.headingProcessor,h3:f.headingProcessor,h4:f.headingProcessor,h5:f.headingProcessor,h6:f.headingProcessor,hr:p.hrProcessor,li:h.listItemProcessor,ol:b.listProcessor,p:y.pProcessor,pre:d.formatContainerProcessor,s:v.knownElementProcessor,section:v.knownElementProcessor,span:v.knownElementProcessor,strike:v.knownElementProcessor,strong:v.knownElementProcessor,sub:v.knownElementProcessor,sup:v.knownElementProcessor,table:C.tableProcessor,u:v.knownElementProcessor,ul:b.listProcessor,"*":u.generalProcessor,"#text":S.textProcessor,element:l.elementProcessor,entity:s.entityProcessor,child:o.childProcessor,delimiter:i.delimiterProcessor}},1807:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domToContentModel=void 0;var n=r(5733),o=r(8767);t.domToContentModel=function(e,t,r){var a=(0,n.createContentModelDocument)(t.defaultFormat);return t.selection=r,t.elementProcessors.child(a,e,t),(0,o.normalizeContentModel)(a),a}},7304:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blockProcessor=void 0;var n=r(7582),o=r(9275),a=r(9004),i=r(5092),l=r(9366),s=["A","CODE"];t.blockProcessor=function(e,t,r,c){var d=r.blockDecorator.tagName?r.blockDecorator:void 0,u=s.indexOf(t.tagName)>=0;(0,l.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var f=(0,n.__assign)({},r.blockFormat);if((0,l.parseFormat)(t,r.formatParsers.container,f,r),a.ContextStyles.forEach((function(e){f[e]&&(r.blockFormat[e]=f[e])})),!u){var p=(0,i.createParagraph)(!1,f,c,d);(0,o.addBlock)(e,p)}r.elementProcessors.child(e,t,r)}},2697:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.brProcessor=void 0;var n=r(8513),o=r(7826);t.brProcessor=function(e,t,r){var a,i=(0,o.createBr)(r.segmentFormat);r.isInSelection&&(i.isSelected=!0);var l=(0,n.addSegment)(e,i,r.blockFormat);null===(a=r.domIndexer)||void 0===a||a.onSegment(t,l,[i])}},9384:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleRegularSelection=t.processChildNode=t.childProcessor=void 0;var n=r(7582),o=r(9871),a=r(8063),i=r(3233);function l(e,t,r){(0,i.isNodeOfType)(t,"ELEMENT_NODE")&&"none"!=t.style.display?r.elementProcessors.element(e,t,r):(0,i.isNodeOfType)(t,"TEXT_NODE")&&r.elementProcessors["#text"](e,t,r)}function s(e,t,r,n,a){var i;e==n&&(t.isInSelection=!0,(0,o.addSelectionMarker)(r,t)),e==a&&"range"==(null===(i=t.selection)||void 0===i?void 0:i.type)&&(t.selection.range.collapsed||(0,o.addSelectionMarker)(r,t),t.isInSelection=!1)}t.childProcessor=function(e,t,r){for(var o=(0,n.__read)((0,a.getRegularSelectionOffsets)(r,t),2),i=o[0],c=o[1],d=0,u=t.firstChild;u;u=u.nextSibling)s(d,r,e,i,c),l(e,u,r),d++;s(d,r,e,i,c)},t.processChildNode=l,t.handleRegularSelection=s},9633:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codeProcessor=void 0;var n=r(4748),o=r(9366),a=r(202);t.codeProcessor=function(e,t,r){(0,a.stackFormat)(r,{code:"codeDefault"},(function(){(0,o.parseFormat)(t,r.formatParsers.code,r.code.format,r),(0,n.knownElementProcessor)(e,t,r)}))}},2130:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delimiterProcessor=void 0;var n=r(9871);t.delimiterProcessor=function(e,t,r){var o,a,i="range"==(null===(o=r.selection)||void 0===o?void 0:o.type)?r.selection.range:null;i&&(t.contains(i.startContainer)&&(r.isInSelection=!0,(0,n.addSelectionMarker)(e,r)),"range"==(null===(a=r.selection)||void 0===a?void 0:a.type)&&t.contains(i.endContainer)&&(r.selection.range.collapsed||(0,n.addSelectionMarker)(e,r),r.isInSelection=!1))}},7883:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elementProcessor=void 0;var n=r(2033);t.elementProcessor=function(e,t,r){var o=t.tagName.toLowerCase(),a=function(e,t){return(0,n.isEntityElement)(e)||"false"==e.contentEditable?t.elementProcessors.entity:null}(t,r)||function(e,t){return(0,n.isEntityDelimiter)(e)?t.elementProcessors.delimiter:null}(t,r)||r.elementProcessors[o]||o.indexOf(":")>=0&&r.elementProcessors.child||r.elementProcessors["*"];a(e,t,r)}},6905:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entityProcessor=void 0;var n=r(9275),o=r(8513),a=r(1033),i=r(2404),l=r(9366),s=r(202);t.entityProcessor=function(e,t,r){var c=(0,i.isBlockElement)(t);(0,s.stackFormat)(r,{segment:c?"empty":void 0,paragraph:"empty"},(function(){var i,s=(0,a.createEntity)(t,!0,r.segmentFormat);if((0,l.parseFormat)(t,r.formatParsers.entity,s.entityFormat,r),r.isInSelection&&(s.isSelected=!0),c)(0,n.addBlock)(e,s);else{var d=(0,o.addSegment)(e,s);null===(i=r.domIndexer)||void 0===i||i.onSegment(t,d,[s])}}))}},5718:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontProcessor=void 0;var n=r(2404),o=r(9366),a=r(202),i=["10px","13px","16px","18px","24px","32px","48px"];t.fontProcessor=function(e,t,r){(0,a.stackFormat)(r,{segment:(0,n.isBlockElement)(t)?"shallowCloneForBlock":"shallowClone"},(function(){var n,a,l=t.getAttribute("face"),s=(n=t.getAttribute("size"),a=parseInt(n||""),Number.isNaN(a)?void 0:a<1?i[0]:a>i.length?i[i.length-1]:i[a-1]),c=t.getAttribute("color"),d=r.segmentFormat;l&&(d.fontFamily=l),s&&(d.fontSize=s),c&&(d.textColor=c),(0,o.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r),r.elementProcessors.child(e,t,r)}))}},9004:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatContainerProcessor=t.ContextStyles=void 0;var n=r(7582),o=r(9275),a=r(2766),i=r(5092),l=r(3149),s=r(9366),c=r(3963),d=r(202);t.ContextStyles=["marginLeft","marginRight","paddingLeft","paddingRight"],t.formatContainerProcessor=function(e,r,u){(0,d.stackFormat)(u,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){(0,s.parseFormat)(r,u.formatParsers.block,u.blockFormat,u),(0,s.parseFormat)(r,u.formatParsers.segmentOnBlock,u.segmentFormat,u);var i=(0,n.__assign)({},u.blockFormat);(0,s.parseFormat)(r,u.formatParsers.container,i,u);var d="block"==(0,l.getDefaultStyle)(r).display?r.tagName.toLowerCase():"div",f=(0,a.createFormatContainer)(d,i);if(t.ContextStyles.forEach((function(e){delete u.blockFormat[e]})),u.elementProcessors.child(f,r,u),r.style.fontSize&&0==parseInt(r.style.fontSize)&&(f.zeroFontSize=!0),function(e){var t=e.blocks[0];return"div"==e.tagName&&1==e.blocks.length&&"Paragraph"==t.blockType&&t.isImplicit}(f)){var p=f.blocks[0];f.zeroFontSize&&(p.segmentFormat=Object.assign({},p.segmentFormat,{fontSize:"0"})),Object.assign(p.format,f.format),(0,c.setParagraphNotImplicit)(p),(0,o.addBlock)(e,p)}else(0,o.addBlock)(e,f)})),(0,o.addBlock)(e,(0,i.createParagraph)(!0,u.blockFormat))}},1001:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generalProcessor=void 0;var n=r(9275),o=r(3883),a=r(8513),i=r(9237),l=r(8885),s=r(2404),c=r(202),d=function(e,t,r){var o=(0,i.createGeneralBlock)(t),a=r.isInSelection;(0,c.stackFormat)(r,{segment:"empty",paragraph:"empty",link:"empty"},(function(){(0,n.addBlock)(e,o),r.elementProcessors.child(o,t,r)})),a&&r.isInSelection&&(o.isSelected=!0)},u=function(e,t,r){var n,i=(0,l.createGeneralSegment)(t,r.segmentFormat),s=r.isInSelection;(0,o.addDecorators)(i,r);var d=(0,a.addSegment)(e,i);null===(n=r.domIndexer)||void 0===n||n.onSegment(t,d,[i]),(0,c.stackFormat)(r,{segment:"empty"},(function(){r.elementProcessors.child(i,t,r)})),s&&r.isInSelection&&(i.isSelected=!0)};t.generalProcessor=function(e,t,r){((0,s.isBlockElement)(t)?d:u)(e,t,r)}},2625:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.headingProcessor=void 0;var n=r(9275),o=r(7304),a=r(5092),i=r(24),l=r(3871),s=r(9366),c=r(202);t.headingProcessor=function(e,t,r){(0,c.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone",blockDecorator:"empty"},(function(){var n={};(0,s.parseFormat)(t,r.formatParsers.segmentOnBlock,n,r),(0,l.getObjectKeys)(n).forEach((function(e){delete r.segmentFormat[e]})),r.blockDecorator=(0,i.createParagraphDecorator)(t.tagName,n),(0,o.blockProcessor)(e,t,r)})),(0,n.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat))}},3092:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hrProcessor=void 0;var n=r(9275),o=r(7110),a=r(9366),i=r(202);t.hrProcessor=function(e,t,r){(0,i.stackFormat)(r,{paragraph:"shallowClone"},(function(){(0,a.parseFormat)(t,r.formatParsers.divider,r.blockFormat,r);var i=(0,o.createDivider)("hr",r.blockFormat);t.size&&(i.size=t.size),r.isInSelection&&(i.isSelected=!0),(0,n.addBlock)(e,i)}))}},215:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.imageProcessor=void 0;var n=r(3883),o=r(8513),a=r(5566),i=r(9366),l=r(202);t.imageProcessor=function(e,t,r){(0,l.stackFormat)(r,{segment:"shallowClone"},(function(){var l,s,c=r.segmentFormat;(0,i.parseFormat)(t,r.formatParsers.segment,c,r),(0,i.parseFormat)(t,r.formatParsers.image,c,r),(0,i.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var d=(0,a.createImage)(t.src,c),u=t.alt,f=t.title;(0,i.parseFormat)(t,r.formatParsers.dataset,d.dataset,r),(0,n.addDecorators)(d,r),u&&(d.alt=u),f&&(d.title=f),r.isInSelection&&(d.isSelected=!0),"image"==(null===(l=r.selection)||void 0===l?void 0:l.type)&&r.selection.image==t&&(d.isSelectedAsImageSelection=!0,d.isSelected=!0);var p=(0,o.addSegment)(e,d);null===(s=r.domIndexer)||void 0===s||s.onSegment(t,p,[d])}))}},4748:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.knownElementProcessor=void 0;var n=r(9275),o=r(7304),a=r(5092),i=r(9004),l=r(3149),s=r(2404),c=r(9366),d=r(202),u=["marginBottom","marginTop","paddingBottom","paddingTop","paddingLeft","paddingRight","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","width","height","maxWidth","maxHeight","minWidth","minHeight"],f=["H1","H2","H3","H4","H5","H6","P","A"],p=["A","CODE"];t.knownElementProcessor=function(e,t,r){var m=(0,s.isBlockElement)(t);if((m||"inline-block"==t.style.display)&&function(e,t){if(f.indexOf(e.tagName)>=0)return!1;var r=e.style,n=(0,l.getDefaultStyle)(e),o=r.getPropertyValue("background-color");return!(!o||"transparent"==o)||(!!u.some((function(e){return parseInt(r[e]||n[e]||"")>0}))||("auto"==r.marginLeft||"auto"==r.marginRight||!!e.getAttribute("align")))}(t))(0,i.formatContainerProcessor)(e,t,r);else if(m){var v=r.blockDecorator.tagName?r.blockDecorator:void 0,g=p.indexOf(t.tagName)>=0;(0,d.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){var n={};(0,c.parseFormat)(t,r.formatParsers.segmentOnBlock,n,r),Object.assign(r.segmentFormat,n),(0,o.blockProcessor)(e,t,r,n)})),m&&!g&&(0,n.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat,void 0,v))}else(0,d.stackFormat)(r,{segment:"shallowClone",paragraph:"shallowClone",link:"cloneFormat"},(function(){(0,c.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r),r.link.format.href&&"A"!=t.tagName&&(0,c.parseFormat)(t,r.formatParsers.segmentUnderLink,r.link.format,r),r.elementProcessors.child(e,t,r)}))}},1091:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.linkProcessor=void 0;var n=r(4748),o=r(9366),a=r(202);t.linkProcessor=function(e,t,r){t.hasAttribute("href")?(0,a.stackFormat)(r,{link:"linkDefault"},(function(){(0,o.parseFormat)(t,r.formatParsers.link,r.link.format,r),(0,o.parseFormat)(t,r.formatParsers.dataset,r.link.dataset,r),(0,n.knownElementProcessor)(e,t,r)})):(0,n.knownElementProcessor)(e,t,r)}},5476:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listItemProcessor=void 0;var n=r(7724),o=r(9366),a=r(202);t.listItemProcessor=function(e,t,r){var i,l=r.listFormat;if(l.listParent&&l.levels.length>0)(0,a.stackFormat)(r,{segment:"shallowCloneForBlock"},(function(){(0,o.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r);var e=(0,n.createListItem)(l.levels,r.segmentFormat);(0,o.parseFormat)(t,r.formatParsers.listItemElement,e.format,r),l.listParent.blocks.push(e),(0,o.parseFormat)(t,r.formatParsers.listItemThread,e.levels[e.levels.length-1].format,r),r.elementProcessors.child(e,t,r);var a=e.blocks[0];1==e.blocks.length&&"Paragraph"==a.blockType&&a.isImplicit&&(Object.assign(e.format,a.format),a.format={})}));else{var s=null===(i=l.listParent)||void 0===i?void 0:i.blocks,c=null==s?void 0:s[(null==s?void 0:s.length)-1];r.elementProcessors["*"]("BlockGroup"==(null==c?void 0:c.blockType)?c:e,t,r)}}},2791:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listProcessor=void 0;var n=r(1285),o=r(9366),a=r(202);t.listProcessor=function(e,t,r){(0,a.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},(function(){var a=(0,n.createListLevel)(t.tagName,r.blockFormat),i=r.listFormat;(0,o.parseFormat)(t,r.formatParsers.dataset,a.dataset,r),(0,o.parseFormat)(t,r.formatParsers.listLevelThread,a.format,r),(0,o.parseFormat)(t,r.formatParsers.listLevel,a.format,r),(0,o.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r);var l=i.listParent;i.listParent=i.listParent||e,i.levels.push(a);try{r.elementProcessors.child(e,t,r)}finally{i.levels.pop(),i.listParent=l}}))}},8191:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pProcessor=void 0;var n=r(9275),o=r(7304),a=r(5092),i=r(24),l=r(9366),s=r(202);t.pProcessor=function(e,t,r){(0,s.stackFormat)(r,{blockDecorator:"empty",segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){r.blockDecorator=(0,i.createParagraphDecorator)(t.tagName);var n={};(0,l.parseFormat)(t,r.formatParsers.segmentOnBlock,n,r),Object.assign(r.segmentFormat,n),(0,o.blockProcessor)(e,t,r,n)})),(0,n.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat))}},970:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tableProcessor=void 0;var n=r(7582),o=r(9275),a=r(988),i=r(1160),l=r(3095),s=r(7960),c=r(3233),d=r(9366),u=r(202);function f(e){for(var t=[],r=e[e.length-1],n=e.length-2;n>=0;n--)void 0===e[n]?t[n]=0:(t[n]=r-e[n],r=e[n]);return t}t.tableProcessor=function(e,t,r){(0,u.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},(function(){var p,m;(0,d.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var v=(0,a.createTable)(t.rows.length,r.blockFormat),g="table"==(null===(p=r.selection)||void 0===p?void 0:p.type)?r.selection:null,h=(null==g?void 0:g.table)==t;r.allowCacheElement&&(v.cachedElement=t),null===(m=r.domIndexer)||void 0===m||m.onTable(t,v),(0,d.parseFormat)(t,r.formatParsers.table,v.format,r),(0,d.parseFormat)(t,r.formatParsers.tableBorder,v.format,r),(0,d.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r),(0,d.parseFormat)(t,r.formatParsers.dataset,v.dataset,r),(0,o.addBlock)(e,v);for(var b=[0],y=[0],C=r.zoomScale||1,S=function(e){var o=t.rows[e],a=v.rows[e],f=o.parentNode;(0,c.isNodeOfType)(f,"ELEMENT_NODE")&&((0,s.isElementOfType)(f,"tbody")||(0,s.isElementOfType)(f,"thead")||(0,s.isElementOfType)(f,"tfoot"))?(0,d.parseFormat)(f,r.formatParsers.tableRow,a.format,r):r.allowCacheElement&&(a.cachedElement=o),(0,d.parseFormat)(o,r.formatParsers.tableRow,a.format,r),(0,u.stackFormat)(r,{paragraph:"shallowClone",segment:"shallowClone"},(function(){var t=o.parentElement,s=null==t?void 0:t.tagName;!t||"TBODY"!=s&&"THEAD"!=s&&"TFOOT"!=s||((0,d.parseFormat)(t,r.formatParsers.block,r.blockFormat,r),(0,d.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r)),(0,d.parseFormat)(o,r.formatParsers.block,r.blockFormat,r),(0,d.parseFormat)(o,r.formatParsers.segmentOnBlock,r.segmentFormat,r);for(var c,f=function(t,s){for(;a.cells[s];s++);var f=o.cells[t],p=r.isInSelection,m=s+f.colSpan,S=e+f.rowSpan,_=void 0===b[m],k=void 0===y[S];if(_||k){var P=(0,l.getBoundingClientRect)(f);(P.width>0||P.height>0)&&(_&&(b[m]=b[s]+P.width/C),k&&(y[S]=y[e]+P.height/C))}(0,u.stackFormat)(r,{paragraph:"shallowClone",segment:"shallowClone"},(function(){(0,d.parseFormat)(f,r.formatParsers.block,r.blockFormat,r),(0,d.parseFormat)(f,r.formatParsers.segmentOnTableCell,r.segmentFormat,r);var t=(0,n.__assign)({},r.blockFormat),o={};(0,d.parseFormat)(f,r.formatParsers.tableCell,t,r),(0,d.parseFormat)(f,r.formatParsers.tableBorder,t,r),(0,d.parseFormat)(f,r.formatParsers.dataset,o,r);for(var a=1;a<=f.colSpan;a++,s++)for(var l=1;l<=f.rowSpan;l++){var c=1==a&&1==l,u=(0,i.createTableCell)(a>1,l>1,"TH"==f.tagName,t);u.dataset=(0,n.__assign)({},o);var m=v.rows[e+l-1];if(m&&(m.cells[s]=u),c){r.allowCacheElement&&(u.cachedElement=f);var b=r.listFormat,y=b.listParent,C=b.levels;r.listFormat.listParent=void 0,r.listFormat.levels=[];try{r.elementProcessors.child(u,f,r)}finally{r.listFormat.listParent=y,r.listFormat.levels=C}}var S=r.isInSelection;(p&&S||h&&g&&e>=g.firstRow&&e<=g.lastRow&&s>=g.firstColumn&&s<=g.lastColumn)&&(u.isSelected=!0)}})),c=s},p=0,m=0;p<o.cells.length;p++)f(p,m),m=c}));for(var p=0;p<a.cells.length;p++)a.cells[p]||(a.cells[p]=(0,i.createTableCell)(!1,!1,!1,r.blockFormat))},_=0;_<t.rows.length;_++)S(_);v.widths=f(b);var k=f(y);v.rows.forEach((function(e,t){k[t]>0&&(e.height=k[t])}))}))}},9892:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textProcessor=void 0;var n=r(3883),o=r(8513),a=r(9871),i=r(840),l=r(2101),s=r(8063),c=r(7084);t.textProcessor=function(e,t,r){var n,o=t.nodeValue||"",i=(0,s.getRegularSelectionOffsets)(r,t),c=i[0],d=i[1],f=[],p=(0,l.ensureParagraph)(e,r.blockFormat);if(c>=0){var m=o.substring(0,c);f.push(u(e,m,p,r)),r.isInSelection=!0,(0,a.addSelectionMarker)(e,r),o=o.substring(c),d-=c}d>=0&&(m=o.substring(0,d),f.push(u(e,m,p,r)),!r.selection||"range"==r.selection.type&&r.selection.range.collapsed||(0,a.addSelectionMarker)(e,r),r.isInSelection=!1,o=o.substring(d)),f.push(u(e,o,p,r)),null===(n=r.domIndexer)||void 0===n||n.onSegment(t,p,f.filter((function(e){return!!e})))};var d=["pre","pre-wrap","pre-line","break-spaces"];function u(e,t,r,a){var l,s;return t&&(!(0,c.hasSpacesOnly)(t)||(null!==(l=null==r?void 0:r.segments.length)&&void 0!==l?l:0)>0||d.indexOf((null==r?void 0:r.format.whiteSpace)||"")>=0)&&(s=(0,i.createText)(t,a.segmentFormat),a.isInSelection&&(s.isSelected=!0),(0,n.addDecorators)(s,a),(0,o.addSegment)(e,s,a.blockFormat)),s}},9871:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSelectionMarker=void 0;var n=r(3883),o=r(8513),a=r(5114);t.addSelectionMarker=function(e,t){var r=(0,a.createSelectionMarker)(t.segmentFormat);(0,n.addDecorators)(r,t),(0,o.addSegment)(e,r,t.blockFormat)}},8310:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areSameFormats=void 0;var n=r(3871);t.areSameFormats=function(e,t){if(e==t)return!0;var r=(0,n.getObjectKeys)(e),o=(0,n.getObjectKeys)(t);return r.length==o.length&&r.every((function(r){return e[r]==t[r]}))}},3095:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingClientRect=void 0,t.getBoundingClientRect=function(e){return e.getBoundingClientRect()}},3149:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultStyle=void 0;var n=r(1350);t.getDefaultStyle=function(e){var t=e.tagName.toLowerCase();return n.defaultHTMLStyleMap[t]||{}}},8063:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRegularSelectionOffsets=void 0,t.getRegularSelectionOffsets=function(e,t){var r,n="range"==(null===(r=e.selection)||void 0===r?void 0:r.type)?e.selection.range:null;return[(null==n?void 0:n.startContainer)==t?n.startOffset:-1,(null==n?void 0:n.endContainer)==t?n.endOffset:-1]}},2404:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBlockElement=void 0;var n=r(3149),o=["block","list-item","table","table-cell","flex"];t.isBlockElement=function(e){var t=e.style.display||(0,n.getDefaultStyle)(e).display||"";return o.indexOf(t)>=0}},9366:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFormat=void 0;var n=r(3149);t.parseFormat=function(e,t,r,o){var a=(0,n.getDefaultStyle)(e);t.forEach((function(t){null==t||t(r,e,o,a)}))}},202:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackFormat=void 0;var n=r(7582),o=r(3871),a=["backgroundColor"],i=["marginLeft","marginRight","paddingLeft","paddingRight"];function l(e,t){switch(t){case"empty":return{};case void 0:return e;default:var r=(0,n.__assign)({},e);return(0,o.getObjectKeys)(e).forEach((function(e){("shallowCloneForBlock"==t&&a.indexOf(e)>=0||"shallowCloneForGroup"==t&&i.indexOf(e)>=0)&&delete r[e]})),r}}t.stackFormat=function(e,t,r){var o,a=e.segmentFormat,i=e.blockFormat,s=e.link,c=e.code,d=e.blockDecorator,u=t.segment,f=t.paragraph,p=t.link,m=t.code,v=t.blockDecorator;try{e.segmentFormat=l(a,u),e.blockFormat=l(i,f),e.link=function(e,t){switch(t){case"linkDefault":return{format:{underline:!0},dataset:{}};case"empty":return{format:{},dataset:{}};default:return{dataset:e.dataset,format:(0,n.__assign)({},e.format)}}}(s,p),e.code=function(e,t){switch(t){case"codeDefault":return{format:{fontFamily:"monospace"}};case"empty":return{format:{}};default:return e}}(c,m),e.blockDecorator=(o=d,"empty"===v?{format:{},tagName:""}:o),r()}finally{e.segmentFormat=a,e.blockFormat=i,e.link=s,e.code=c,e.blockDecorator=d}}},2033:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addDelimiters=t.isEntityDelimiter=t.generateEntityClassNames=t.parseEntityClassName=t.isEntityElement=void 0;var n=r(7960),o=r(3233),a="_Entity",i="_EType_",l="_EId_",s="_EReadonly_",c="entityDelimiterBefore",d="entityDelimiterAfter";function u(e,t,r){var n,o=e.createElement("span");return o.className=r?d:c,o.appendChild(e.createTextNode("​")),null===(n=t.parentNode)||void 0===n||n.insertBefore(o,r?t.nextSibling:t),o}t.isEntityElement=function(e){return(0,o.isNodeOfType)(e,"ELEMENT_NODE")&&e.classList.contains(a)},t.parseEntityClassName=function(e,t){if(e==a)return!0;0==e.indexOf(i)?t.entityType=e.substring(7):0==e.indexOf(l)?t.id=e.substring(5):0==e.indexOf(s)&&(t.isReadonly="1"==e.substring(11))},t.generateEntityClassNames=function(e){var t;return e.isFakeEntity?"":a+" "+i+(null!==(t=e.entityType)&&void 0!==t?t:"")+" "+(e.id?""+l+e.id+" ":"")+s+(e.isReadonly?"1":"0")},t.isEntityDelimiter=function(e){return(0,n.isElementOfType)(e,"span")&&(e.classList.contains(d)||e.classList.contains(c))&&"​"===e.textContent},t.addDelimiters=function(e,t){return[u(e,t,!0),u(e,t,!1)]}},3871:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getObjectKeys=void 0,t.getObjectKeys=function(e){return Object.keys(e)}},7960:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isElementOfType=void 0,t.isElementOfType=function(e,t){var r;return(null===(r=null==e?void 0:e.tagName)||void 0===r?void 0:r.toLocaleLowerCase())==t}},3233:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeOfType=void 0,t.isNodeOfType=function(e,t){return!!e&&e.nodeType==Node[t]}},6245:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasMetadata=t.updateMetadata=void 0;var n=r(5524),o="editingInfo";t.updateMetadata=function(e,t,r){var a=e.dataset[o],i=null;try{i=JSON.parse(a)}catch(e){}return r&&!(0,n.validate)(i,r)&&(i=null),t&&((i=t(i))?r&&!(0,n.validate)(i,r)||(e.dataset[o]=JSON.stringify(i)):delete e.dataset[o]),i},t.hasMetadata=function(e){return!!e.dataset[o]}},5524:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validate=void 0;var n=r(3871);t.validate=function e(t,r){var o,a,i=!1;if(r.isOptional&&void 0===t||r.allowNull&&null===t)i=!0;else{if(!r.isOptional&&void 0===t||!r.allowNull&&null===t)return!1;switch(r.type){case"string":i="string"==typeof t&&(void 0===r.value||t===r.value);break;case"number":i="number"==typeof t&&(void 0===r.value||(o=r.value,a=t,Math.abs(o-a)<.001))&&(void 0===r.minValue||t>=r.minValue)&&(void 0===r.maxValue||t<=r.maxValue);break;case"boolean":i="boolean"==typeof t&&(void 0===r.value||t===r.value);break;case"array":i=Array.isArray(t)&&(void 0===r.minLength||t.length>=r.minLength)&&(void 0===r.maxLength||t.length<=r.maxLength)&&t.every((function(t){return e(t,r.itemDef)}));break;case"object":i="object"==typeof t&&(0,n.getObjectKeys)(r.propertyDef).every((function(n){return e(t[n],r.propertyDef[n])}))}}return i}},4478:(e,t)=>{"use strict";function r(e,t,r){if(e){for(;!r&&e.firstChild;)e.removeChild(e.firstChild);for(;null==t?void 0:t.firstChild;)e.appendChild(t.firstChild)}}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapAllChildNodes=t.moveChildNodes=void 0,t.moveChildNodes=r,t.wrapAllChildNodes=function(e,t){var n=e.ownerDocument.createElement(t);return r(n,e),e.appendChild(n),n}},6820:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return[].slice.call(e)}},9448:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=void 0,t.unwrap=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},8066:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrap=void 0,t.wrap=function(e,t,r){var n,o=e.createElement(r);return null===(n=t.parentNode)||void 0===n||n.insertBefore(o,t),o.appendChild(t),o}},9980:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.directionFormatHandler=void 0,t.directionFormatHandler={parse:function(e,t,r,n){var o=t.style.direction||t.dir||n.direction;o&&(e.direction="rtl"==o?"rtl":"ltr")},apply:function(e,t){e.direction&&(t.style.direction=e.direction)}}},1276:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayFormatHandler=void 0,t.displayFormatHandler={parse:function(e,t){var r=t.style.display;r&&(e.display=r)},apply:function(e,t){e.display&&(t.style.display=e.display)}}},7762:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.htmlAlignFormatHandler=void 0;var n=r(3612),o=r(9980);t.htmlAlignFormatHandler={parse:function(e,t,r,a){o.directionFormatHandler.parse(e,t,r,a);var i=t.getAttribute("align");i&&(e.htmlAlign=(0,n.calcAlign)(i,e.direction),delete e.textAlign,delete r.blockFormat.textAlign)},apply:function(e,t){var r="rtl"==e.direction?"rtl":"ltr";e.htmlAlign&&t.setAttribute("align",n.ResultMap[e.htmlAlign][r])}}},4652:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lineHeightFormatHandler=void 0,t.lineHeightFormatHandler={parse:function(e,t,r,n){var o=t.style.lineHeight||n.lineHeight;o&&"inherit"!=o&&(e.lineHeight=o)},apply:function(e,t){e.lineHeight&&(t.style.lineHeight=e.lineHeight)}}},4116:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.marginFormatHandler=void 0;var n=r(8704),o=["marginTop","marginRight","marginBottom","marginLeft"];t.marginFormatHandler={parse:function(e,t,r,a){o.forEach((function(r){var o=t.style[r]||a[r];if(o)switch(r){case"marginTop":case"marginBottom":e[r]=o;break;case"marginLeft":case"marginRight":e[r]=e[r]?(0,n.parseValueWithUnit)(e[r]||"",t)+(0,n.parseValueWithUnit)(o,t)+"px":o}}));var i=t.style.marginBlockStart||a.marginBlockStart,l=t.style.marginTop||a.marginTop;i&&!l&&(e.marginBlockStart=(0,n.parseValueWithUnit)(i)+"px");var s=t.style.marginBlockEnd||a.marginBlockEnd,c=t.style.marginBottom||a.marginBottom;s&&!c&&(e.marginBlockEnd=(0,n.parseValueWithUnit)(s)+"px")},apply:function(e,t,r){o.forEach((function(n){var o=e[n];o!=r.implicitFormat[n]&&(t.style[n]=o||"0")})),e.marginBlockStart&&!e.marginTop&&(t.style.marginBlockStart=e.marginBlockStart),e.marginBlockEnd&&!e.marginBottom&&(t.style.marginBlockEnd=e.marginBlockEnd)}}},632:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paddingFormatHandler=void 0;var r=["paddingTop","paddingRight","paddingBottom","paddingLeft"];t.paddingFormatHandler={parse:function(e,t){r.forEach((function(r){var n=t.style[r];n&&(e[r]=n)}))},apply:function(e,t){r.forEach((function(r){var n=e[r];n&&(t.style[r]=n)}))}}},9568:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textAlignFormatHandler=void 0;var n=r(3612),o=r(9980);t.textAlignFormatHandler={parse:function(e,t,r,a){var i;o.directionFormatHandler.parse(e,t,r,a);var l=t.style.textAlign||a.textAlign;"LI"==t.tagName&&"flex"===(null===(i=t.parentElement)||void 0===i?void 0:i.style.display)&&"column"===t.parentElement.style.flexDirection&&t.style.alignSelf&&(l=t.style.alignSelf),l&&(e.textAlign=(0,n.calcAlign)(l,e.direction))},apply:function(e,t){var r="rtl"==e.direction?"rtl":"ltr";if(e.textAlign){var o=t.parentElement,a=null==o?void 0:o.tagName;"LI"!=t.tagName||!o||"OL"!=a&&"UL"!=a?t.style.textAlign=n.ResultMap[e.textAlign][r]:(t.style.alignSelf=e.textAlign,t.parentElement.style.flexDirection="column",t.parentElement.style.display="flex")}}}},1167:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.whiteSpaceFormatHandler=void 0,t.whiteSpaceFormatHandler={parse:function(e,t,r,n){var o=t.style.whiteSpace||n.whiteSpace;o&&(e.whiteSpace=o)},apply:function(e,t,r){var n=r.implicitFormat.whiteSpace;e.whiteSpace!=n&&(t.style.whiteSpace=e.whiteSpace||"normal")}}},8891:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.backgroundColorFormatHandler=void 0;var n=r(5150);t.backgroundColorFormatHandler={parse:function(e,t,r,o){var a=(0,n.getColor)(t,!0,r.darkColorHandler,!!r.isDarkMode)||o.backgroundColor;a&&(e.backgroundColor=a)},apply:function(e,t,r){e.backgroundColor&&(0,n.setColor)(t,e.backgroundColor,!0,r.darkColorHandler,!!r.isDarkMode)}}},5930:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.borderBoxFormatHandler=void 0,t.borderBoxFormatHandler={parse:function(e,t){var r;"border-box"==(null===(r=t.style)||void 0===r?void 0:r.boxSizing)&&(e.useBorderBox=!0)},apply:function(e,t){e.useBorderBox&&(t.style.boxSizing="border-box")}}},1136:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.borderFormatHandler=t.BorderKeys=void 0,t.BorderKeys=["borderTop","borderRight","borderBottom","borderLeft","borderRadius"],t.borderFormatHandler={parse:function(e,r){t.BorderKeys.forEach((function(t){var n=r.style[t];n&&(e[t]="none"==n?"":n)}))},apply:function(e,r){t.BorderKeys.forEach((function(t){var n=e[t];n&&(r.style[t]=n)}))}}},8577:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boxShadowFormatHandler=void 0,t.boxShadowFormatHandler={parse:function(e,t){var r;(null===(r=t.style)||void 0===r?void 0:r.boxShadow)&&(e.boxShadow=t.style.boxShadow)},apply:function(e,t){e.boxShadow&&(t.style.boxShadow=e.boxShadow)}}},1453:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.datasetFormatHandler=void 0;var n=r(3871);t.datasetFormatHandler={parse:function(e,t){var r=t.dataset;(0,n.getObjectKeys)(r).forEach((function(t){e[t]=r[t]||""}))},apply:function(e,t){(0,n.getObjectKeys)(e).forEach((function(r){t.dataset[r]=e[r]}))}}},5432:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.floatFormatHandler=void 0,t.floatFormatHandler={parse:function(e,t){var r=t.style.float||t.getAttribute("align");r&&(e.float=r)},apply:function(e,t){e.float&&(t.style.float=e.float)}}},6883:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.idFormatHandler=void 0,t.idFormatHandler={parse:function(e,t){t.id&&(e.id=t.id)},apply:function(e,t){e.id&&(t.id=e.id)}}},7302:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sizeFormatHandler=void 0;var r=/[\d\.]+%/;function n(e,t){var n=e.getAttribute(t),o=parseInt(n||"");return n&&r.test(n)?n:Number.isNaN(o)?void 0:o+"px"}t.sizeFormatHandler={parse:function(e,t,r){var o=t.style.width||n(t,"width"),a=t.style.height||n(t,"height"),i=t.style.maxWidth,l=t.style.maxHeight,s=t.style.minWidth,c=t.style.minHeight;o&&(e.width=o),a&&(e.height=a),i&&(e.maxWidth=i),l&&(e.maxHeight=l),s&&(e.minWidth=s),c&&(e.minHeight=c)},apply:function(e,t){e.width&&(t.style.width=e.width),e.height&&(t.style.height=e.height),e.maxWidth&&(t.style.maxWidth=e.maxWidth),e.maxHeight&&(t.style.maxHeight=e.maxHeight),e.minWidth&&(t.style.minWidth=e.minWidth),e.minHeight&&(t.style.minHeight=e.minHeight)}}},8854:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verticalAlignFormatHandler=void 0,t.verticalAlignFormatHandler={parse:function(e,t){switch(t.style.verticalAlign||t.getAttribute("valign")){case"baseline":case"initial":case"super":case"sub":case"text-top":case"text-bottom":case"top":e.verticalAlign="top";break;case"bottom":e.verticalAlign="bottom";break;case"middle":e.verticalAlign="middle"}},apply:function(e,t){e.verticalAlign&&(t.style.verticalAlign=e.verticalAlign)}}},4258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wordBreakFormatHandler=void 0,t.wordBreakFormatHandler={parse:function(e,t,r,n){var o=t.style.wordBreak||n.wordBreak;o&&(e.wordBreak=o)},apply:function(e,t){e.wordBreak&&(t.style.wordBreak=e.wordBreak)}}},8659:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFormatAppliers=t.defaultFormatParsers=t.defaultFormatKeysPerCategory=void 0;var n=r(7582),o=r(8891),a=r(8707),i=r(5930),l=r(1136),s=r(8577),c=r(1453),d=r(9980),u=r(1276),f=r(2775),p=r(5432),m=r(7239),v=r(9101),g=r(3871),h=r(7762),b=r(6883),y=r(2647),C=r(3260),S=r(4652),_=r(7026),k=r(2128),P=r(9865),w=r(4325),M=r(4116),E=r(632),O=r(7302),T=r(6413),F=r(5855),x=r(746),D=r(461),j=r(9568),B=r(1268),A=r(5797),L=r(7506),N=r(8854),R=r(1167),I=r(4258),H={backgroundColor:o.backgroundColorFormatHandler,bold:a.boldFormatHandler,border:l.borderFormatHandler,borderBox:i.borderBoxFormatHandler,boxShadow:s.boxShadowFormatHandler,dataset:c.datasetFormatHandler,direction:d.directionFormatHandler,display:u.displayFormatHandler,float:p.floatFormatHandler,fontFamily:m.fontFamilyFormatHandler,fontSize:v.fontSizeFormatHandler,entity:f.entityFormatHandler,htmlAlign:h.htmlAlignFormatHandler,id:b.idFormatHandler,italic:y.italicFormatHandler,letterSpacing:C.letterSpacingFormatHandler,lineHeight:S.lineHeightFormatHandler,link:_.linkFormatHandler,listItemThread:k.listItemThreadFormatHandler,listLevelThread:P.listLevelThreadFormatHandler,listStyle:w.listStyleFormatHandler,margin:M.marginFormatHandler,padding:E.paddingFormatHandler,size:O.sizeFormatHandler,strike:T.strikeFormatHandler,superOrSubScript:F.superOrSubScriptFormatHandler,tableLayout:x.tableLayoutFormatHandler,tableSpacing:D.tableSpacingFormatHandler,textAlign:j.textAlignFormatHandler,textColor:B.textColorFormatHandler,textColorOnTableCell:A.textColorOnTableCellFormatHandler,underline:L.underlineFormatHandler,verticalAlign:N.verticalAlignFormatHandler,whiteSpace:R.whiteSpaceFormatHandler,wordBreak:I.wordBreakFormatHandler},z=["letterSpacing","fontFamily","fontSize"],W=["strike","underline","superOrSubScript","italic","bold"],G=["direction","textAlign","lineHeight","whiteSpace"],U=["backgroundColor","margin","padding","border"];t.defaultFormatKeysPerCategory={block:G,listItemThread:["listItemThread"],listLevelThread:["listLevelThread"],listItemElement:(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(G),!1),["direction","textAlign","lineHeight","margin","listStyle"],!1),listLevel:["direction","textAlign","margin","padding","listStyle","backgroundColor"],styleBasedSegment:(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(z),!1),["textColor","backgroundColor","lineHeight"],!1),elementBasedSegment:W,segment:(0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(z),!1),(0,n.__read)(W),!1),["textColor","backgroundColor","lineHeight"],!1),segmentOnBlock:(0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(z),!1),(0,n.__read)(W),!1),["textColor"],!1),segmentOnTableCell:(0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(z),!1),(0,n.__read)(W),!1),["textColorOnTableCell"],!1),tableCell:["border","backgroundColor","padding","verticalAlign","wordBreak","textColor","htmlAlign","size"],tableRow:["backgroundColor"],table:["id","border","backgroundColor","display","htmlAlign","margin","size","tableLayout"],tableBorder:["borderBox","tableSpacing"],tableCellBorder:["borderBox"],image:["id","size","margin","padding","borderBox","border","boxShadow","display","float","verticalAlign"],link:["link","textColor","underline","display","margin","padding","backgroundColor","border","size","textAlign"],segmentUnderLink:["textColor"],code:["fontFamily","display"],dataset:["dataset"],divider:(0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(G),!1),(0,n.__read)(U),!1),["display","size","htmlAlign"],!1),container:(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(U),!1),["htmlAlign","size","display"],!1),entity:["entity"]},t.defaultFormatParsers=(0,g.getObjectKeys)(H).reduce((function(e,t){return e[t]=H[t].parse,e}),{}),t.defaultFormatAppliers=(0,g.getObjectKeys)(H).reduce((function(e,t){return e[t]=H[t].apply,e}),{})},2775:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entityFormatHandler=void 0;var n=r(2033);t.entityFormatHandler={parse:function(e,t){var r=!1;t.classList.forEach((function(t){r=(0,n.parseEntityClassName)(t,e)||r})),r||(e.isFakeEntity=!0,e.isReadonly=!t.isContentEditable)},apply:function(e,t){e.isFakeEntity||(t.className=(0,n.generateEntityClassNames)(e)),e.isReadonly?t.contentEditable="false":t.removeAttribute("contenteditable")}}},2128:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listItemThreadFormatHandler=void 0;var n=r(7960),o=r(3233);function a(e){return(0,n.isElementOfType)(e,"li")&&(0,o.isNodeOfType)(e.parentNode,"ELEMENT_NODE")&&(0,n.isElementOfType)(e.parentNode,"ol")}t.listItemThreadFormatHandler={parse:function(e,t,r,n){var o=r.listFormat,i=o.levels.length,l=t.style.display||n.display;l&&"list-item"!=l?e.displayForDummyItem=l:a(t)&&i>0&&(o.threadItemCounts[i-1]++,o.threadItemCounts.splice(i),o.levels.forEach((function(e){delete e.format.startNumberOverride})))},apply:function(e,t,r){var n;if(e.displayForDummyItem)t.style.display=e.displayForDummyItem;else if(a(t)){var o=r.listFormat,i=o.threadItemCounts,l=o.nodeStack.length-2;l>=0&&(i.splice(l+1),i[l]=(null!==(n=i[l])&&void 0!==n?n:0)+1)}}}},9865:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listLevelThreadFormatHandler=void 0;var n=r(7960);t.listLevelThreadFormatHandler={parse:function(e,t,r){if((0,n.isElementOfType)(t,"ol")){var o=r.listFormat,a=o.threadItemCounts,i=o.levels.length;"number"==typeof a[i]&&t.start!=a[i]+1&&(e.startNumberOverride=t.start),a[i]=t.start-1}},apply:function(e,t,r){var o=r.listFormat,a=o.threadItemCounts,i=o.nodeStack.length-2;if(i>=0&&(0,n.isElementOfType)(t,"ol")){var l=e.startNumberOverride;"number"==typeof l?a[i]=l-1:"number"!=typeof a[i]&&(a[i]=0),a.splice(i+1),t.start=a[i]+1}}}},4325:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listStyleFormatHandler=void 0,t.listStyleFormatHandler={parse:function(e,t){var r=t.style.listStylePosition,n=t.style.listStyleType;r&&(e.listStylePosition=r),n&&(e.listStyleType=n)},apply:function(e,t){e.listStylePosition&&(t.style.listStylePosition=e.listStylePosition),e.listStyleType&&(t.style.listStyleType=e.listStyleType)}}},8707:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boldFormatHandler=void 0;var n=r(4478);t.boldFormatHandler={parse:function(e,t,r,n){var o=t.style.fontWeight||n.fontWeight;o&&(e.fontWeight=o)},apply:function(e,t,r){if(void 0!==e.fontWeight){var o=r.implicitFormat.fontWeight;(o&&o!=e.fontWeight||!o&&e.fontWeight&&"normal"!=e.fontWeight)&&("bold"==e.fontWeight?(0,n.wrapAllChildNodes)(t,"b"):t.style.fontWeight=e.fontWeight||"normal")}}}},7239:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontFamilyFormatHandler=void 0,t.fontFamilyFormatHandler={parse:function(e,t,r,n){var o=t.style.fontFamily||n.fontFamily;o&&"inherit"!=o&&(e.fontFamily=o)},apply:function(e,t,r){e.fontFamily&&e.fontFamily!=r.implicitFormat.fontFamily&&(t.style.fontFamily=e.fontFamily)}}},9101:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontSizeFormatHandler=void 0;var n=r(5855),o=r(8704);t.fontSizeFormatHandler={parse:function(e,t,r,i){var l=t.style.fontSize||i.fontSize,s=t.style.verticalAlign||i.verticalAlign;l&&!(0,n.isSuperOrSubScript)(l,s)&&"inherit"!=l&&(t.style.fontSize?e.fontSize=function(e,t){var r=a[e];if(r)return r;if("smaller"!=e&&"larger"!=e&&!e.endsWith("em")&&!e.endsWith("%"))return"inherit"==e||"revert"==e||"unset"==e?void 0:e;if(t){var n=(0,o.parseValueWithUnit)(t,void 0,"px");if(n)switch(e){case"smaller":return Math.round(500*n/6)/100+"px";case"larger":return Math.round(600*n/5)/100+"px";default:return(0,o.parseValueWithUnit)(e,n,"px")+"px"}}}(l,r.segmentFormat.fontSize):i.fontSize&&(e.fontSize=l))},apply:function(e,t,r){e.fontSize&&e.fontSize!=r.implicitFormat.fontSize&&(t.style.fontSize=e.fontSize)}};var a={"xx-small":"6.75pt","x-small":"7.5pt",small:"9.75pt",medium:"12pt",large:"13.5pt","x-large":"18pt","xx-large":"24pt","xxx-large":"36pt"}},2647:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.italicFormatHandler=void 0;var n=r(4478);t.italicFormatHandler={parse:function(e,t,r,n){var o=t.style.fontStyle||n.fontStyle;"italic"==o||"oblique"==o?e.italic=!0:"initial"!=o&&"normal"!=o||(e.italic=!1)},apply:function(e,t,r){void 0!==e.italic&&!!r.implicitFormat.italic!=!!e.italic&&(e.italic?(0,n.wrapAllChildNodes)(t,"i"):t.style.fontStyle="normal")}}},3260:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.letterSpacingFormatHandler=void 0,t.letterSpacingFormatHandler={parse:function(e,t,r,n){var o=t.style.letterSpacing||n.letterSpacing;o&&(e.letterSpacing=o)},apply:function(e,t,r){e.letterSpacing&&(t.style.letterSpacing=e.letterSpacing)}}},7026:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.linkFormatHandler=void 0;var n=r(7960);t.linkFormatHandler={parse:function(e,t){if((0,n.isElementOfType)(t,"a")){var r=t.name,o=t.getAttribute("href"),a=t.target,i=t.rel,l=t.id,s=t.className,c=t.title;r&&(e.name=r),o&&(e.href=o),a&&(e.target=a),l&&(e.anchorId=l),i&&(e.relationship=i),c&&(e.anchorTitle=c),s&&(e.anchorClass=s)}},apply:function(e,t){(0,n.isElementOfType)(t,"a")&&e.href&&(t.href=e.href,e.name&&(t.name=e.name),e.target&&(t.target=e.target),e.anchorId&&(t.id=e.anchorId),e.anchorClass&&(t.className=e.anchorClass),e.anchorTitle&&(t.title=e.anchorTitle),e.relationship&&(t.rel=e.relationship))}}},6413:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.strikeFormatHandler=void 0;var n=r(4478);t.strikeFormatHandler={parse:function(e,t,r,n){var o=t.style.textDecoration||n.textDecoration;(null==o?void 0:o.indexOf("line-through"))>=0&&(e.strikethrough=!0)},apply:function(e,t){e.strikethrough&&(0,n.wrapAllChildNodes)(t,"s")}}},5855:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSuperOrSubScript=t.superOrSubScriptFormatHandler=void 0;var n=r(4478);function o(e,t){return"smaller"==e&&("sub"==t||"super"==t)}t.superOrSubScriptFormatHandler={parse:function(e,t,r,n){var a=t.style.verticalAlign||n.verticalAlign;o(t.style.fontSize||n.fontSize,a)&&(e.superOrSubScriptSequence=(e.superOrSubScriptSequence||"").split(" ").concat(a).join(" ").trim())},apply:function(e,t){e.superOrSubScriptSequence&&e.superOrSubScriptSequence.split(" ").reverse().forEach((function(e){var r="super"==e?"sup":"sub"==e?"sub":null;r&&(0,n.wrapAllChildNodes)(t,r)}))}},t.isSuperOrSubScript=o},1268:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textColorFormatHandler=void 0;var n=r(5150);t.textColorFormatHandler={parse:function(e,t,r,o){var a=(0,n.getColor)(t,!1,r.darkColorHandler,!!r.isDarkMode)||o.color;a&&"inherit"!=a&&(e.textColor=a)},apply:function(e,t,r){var o=r.implicitFormat.textColor;e.textColor&&e.textColor!=o&&(0,n.setColor)(t,e.textColor,!1,r.darkColorHandler,!!r.isDarkMode)}}},7506:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.underlineFormatHandler=void 0;var n=r(4478);t.underlineFormatHandler={parse:function(e,t,r,n){var o=t.style.textDecoration||n.textDecoration;(null==o?void 0:o.indexOf("underline"))>=0?e.underline=!0:"A"==t.tagName&&"none"==o&&(e.underline=!1)},apply:function(e,t,r){void 0!==e.underline&&!!r.implicitFormat.underline!=!!e.underline&&(e.underline?(0,n.wrapAllChildNodes)(t,"u"):t.style.textDecoration="none")}}},746:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tableLayoutFormatHandler=void 0,t.tableLayoutFormatHandler={parse:function(e,t){var r=t.style.tableLayout;r&&"inherit"!=r&&(e.tableLayout=r)},apply:function(e,t){e.tableLayout&&(t.style.tableLayout=e.tableLayout)}}},461:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tableSpacingFormatHandler=void 0;var r="collapse";t.tableSpacingFormatHandler={parse:function(e,t){t.style.borderCollapse==r&&(e.borderCollapse=!0)},apply:function(e,t){e.borderCollapse&&(t.style.borderCollapse=r,t.style.borderSpacing="0",t.style.boxSizing="border-box")}}},5797:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textColorOnTableCellFormatHandler=void 0,t.textColorOnTableCellFormatHandler={parse:function(e,t){t.style.color&&delete e.textColor},apply:function(){}}},5150:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setColor=t.getColor=t.DeprecatedColors=void 0,t.DeprecatedColors=["inactiveborder","activeborder","inactivecaptiontext","inactivecaption","activecaption","appworkspace","infobackground","background","buttonhighlight","buttonshadow","captiontext","infotext","menutext","menu","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedfhadow","windowtext","windowframe","window"],t.getColor=function(e,r,n,o){var a=(r?e.style.backgroundColor:e.style.color)||e.getAttribute(r?"bgcolor":"color")||void 0;return a&&t.DeprecatedColors.indexOf(a)>-1&&(a=void 0),n&&(a=n.parseColorValue(a,o).lightModeColor),a},t.setColor=function(e,t,r,n,o){var a=n?n.registerColor(t,o):t;r?e.style.backgroundColor=a:e.style.color=a}},3612:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcAlign=t.ResultMap=void 0,t.ResultMap={start:{ltr:"left",rtl:"right"},center:{ltr:"center",rtl:"center"},end:{ltr:"right",rtl:"left"},initial:{ltr:"initial",rtl:"initial"},justify:{ltr:"justify",rtl:"justify"}},t.calcAlign=function(e,t){switch(e){case"center":return"center";case"left":return"rtl"==t?"end":"start";case"right":return"rtl"==t?"start":"end";case"start":case"end":case"justify":case"initial":return e;default:return}}},8704:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseValueWithUnit=void 0;var n=r(7582),o=/(-?\d+(\.\d+)?)([a-z]+|%)/;function a(e){var t,r;if(void 0===e)return 0;if("number"==typeof e)return e;var n=null!==(r=null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e).fontSize)&&void 0!==r?r:"";return i(parseFloat(n))}function i(e){return Math.round(4e3*e/3)/1e3}t.parseValueWithUnit=function(e,t,r){void 0===e&&(e=""),void 0===r&&(r="px");var l,s=o.exec(e),c=0;if(s){var d=(0,n.__read)(s,4),u=(d[0],d[1]),f=(d[2],d[3]),p=parseFloat(u);switch(f){case"px":c=p;break;case"pt":c=i(p);break;case"em":c=a(t)*p;break;case"ex":c=a(t)*p/2;break;case"%":c=a(t)*p/100}}return c>0&&"pt"==r&&(l=c,c=Math.round(3e3*l/4)/1e3),c}},1246:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BorderKeys=t.parseValueWithUnit=t.setParagraphNotImplicit=t.applySegmentFormatToElement=t.normalizeSingleSegment=t.isWhiteSpacePreserved=t.addSegment=t.unwrapBlock=t.isGeneralSegment=t.normalizeContentModel=t.ensureParagraph=t.addLink=t.addCode=t.addBlock=t.createListLevel=t.createDivider=t.createEntity=t.createGeneralBlock=t.createGeneralSegment=t.createParagraphDecorator=t.createContentModelDocument=t.createImage=t.createText=t.createTableCell=t.createTable=t.createSelectionMarker=t.createParagraph=t.createFormatContainer=t.createListItem=t.createBr=t.wrap=t.wrapAllChildNodes=t.moveChildNodes=t.toArray=t.getObjectKeys=t.isElementOfType=t.isNodeOfType=t.hasMetadata=t.updateMetadata=t.isBlockElement=t.areSameFormats=t.parseFormat=t.getRegularSelectionOffsets=t.tableProcessor=t.entityProcessor=t.processChildNode=t.handleRegularSelection=t.childProcessor=t.contentModelToDom=t.domToContentModel=void 0,t.createModelToDomConfig=t.createModelToDomContextWithConfig=t.createModelToDomContext=t.createDomToModelConfig=t.createDomToModelContextWithConfig=t.createDomToModelContext=t.setColor=t.getColor=t.DeprecatedColors=void 0;var n=r(1807);Object.defineProperty(t,"domToContentModel",{enumerable:!0,get:function(){return n.domToContentModel}});var o=r(4266);Object.defineProperty(t,"contentModelToDom",{enumerable:!0,get:function(){return o.contentModelToDom}});var a=r(9384);Object.defineProperty(t,"childProcessor",{enumerable:!0,get:function(){return a.childProcessor}}),Object.defineProperty(t,"handleRegularSelection",{enumerable:!0,get:function(){return a.handleRegularSelection}}),Object.defineProperty(t,"processChildNode",{enumerable:!0,get:function(){return a.processChildNode}});var i=r(6905);Object.defineProperty(t,"entityProcessor",{enumerable:!0,get:function(){return i.entityProcessor}});var l=r(970);Object.defineProperty(t,"tableProcessor",{enumerable:!0,get:function(){return l.tableProcessor}});var s=r(8063);Object.defineProperty(t,"getRegularSelectionOffsets",{enumerable:!0,get:function(){return s.getRegularSelectionOffsets}});var c=r(9366);Object.defineProperty(t,"parseFormat",{enumerable:!0,get:function(){return c.parseFormat}});var d=r(8310);Object.defineProperty(t,"areSameFormats",{enumerable:!0,get:function(){return d.areSameFormats}});var u=r(2404);Object.defineProperty(t,"isBlockElement",{enumerable:!0,get:function(){return u.isBlockElement}});var f=r(6245);Object.defineProperty(t,"updateMetadata",{enumerable:!0,get:function(){return f.updateMetadata}}),Object.defineProperty(t,"hasMetadata",{enumerable:!0,get:function(){return f.hasMetadata}});var p=r(3233);Object.defineProperty(t,"isNodeOfType",{enumerable:!0,get:function(){return p.isNodeOfType}});var m=r(7960);Object.defineProperty(t,"isElementOfType",{enumerable:!0,get:function(){return m.isElementOfType}});var v=r(3871);Object.defineProperty(t,"getObjectKeys",{enumerable:!0,get:function(){return v.getObjectKeys}});var g=r(6820);Object.defineProperty(t,"toArray",{enumerable:!0,get:function(){return g.default}});var h=r(4478);Object.defineProperty(t,"moveChildNodes",{enumerable:!0,get:function(){return h.moveChildNodes}}),Object.defineProperty(t,"wrapAllChildNodes",{enumerable:!0,get:function(){return h.wrapAllChildNodes}});var b=r(8066);Object.defineProperty(t,"wrap",{enumerable:!0,get:function(){return b.wrap}});var y=r(7826);Object.defineProperty(t,"createBr",{enumerable:!0,get:function(){return y.createBr}});var C=r(7724);Object.defineProperty(t,"createListItem",{enumerable:!0,get:function(){return C.createListItem}});var S=r(2766);Object.defineProperty(t,"createFormatContainer",{enumerable:!0,get:function(){return S.createFormatContainer}});var _=r(5092);Object.defineProperty(t,"createParagraph",{enumerable:!0,get:function(){return _.createParagraph}});var k=r(5114);Object.defineProperty(t,"createSelectionMarker",{enumerable:!0,get:function(){return k.createSelectionMarker}});var P=r(988);Object.defineProperty(t,"createTable",{enumerable:!0,get:function(){return P.createTable}});var w=r(1160);Object.defineProperty(t,"createTableCell",{enumerable:!0,get:function(){return w.createTableCell}});var M=r(840);Object.defineProperty(t,"createText",{enumerable:!0,get:function(){return M.createText}});var E=r(5566);Object.defineProperty(t,"createImage",{enumerable:!0,get:function(){return E.createImage}});var O=r(5733);Object.defineProperty(t,"createContentModelDocument",{enumerable:!0,get:function(){return O.createContentModelDocument}});var T=r(24);Object.defineProperty(t,"createParagraphDecorator",{enumerable:!0,get:function(){return T.createParagraphDecorator}});var F=r(8885);Object.defineProperty(t,"createGeneralSegment",{enumerable:!0,get:function(){return F.createGeneralSegment}});var x=r(9237);Object.defineProperty(t,"createGeneralBlock",{enumerable:!0,get:function(){return x.createGeneralBlock}});var D=r(1033);Object.defineProperty(t,"createEntity",{enumerable:!0,get:function(){return D.createEntity}});var j=r(7110);Object.defineProperty(t,"createDivider",{enumerable:!0,get:function(){return j.createDivider}});var B=r(1285);Object.defineProperty(t,"createListLevel",{enumerable:!0,get:function(){return B.createListLevel}});var A=r(9275);Object.defineProperty(t,"addBlock",{enumerable:!0,get:function(){return A.addBlock}});var L=r(3883);Object.defineProperty(t,"addCode",{enumerable:!0,get:function(){return L.addCode}});var N=r(3883);Object.defineProperty(t,"addLink",{enumerable:!0,get:function(){return N.addLink}});var R=r(2101);Object.defineProperty(t,"ensureParagraph",{enumerable:!0,get:function(){return R.ensureParagraph}});var I=r(8767);Object.defineProperty(t,"normalizeContentModel",{enumerable:!0,get:function(){return I.normalizeContentModel}});var H=r(183);Object.defineProperty(t,"isGeneralSegment",{enumerable:!0,get:function(){return H.isGeneralSegment}});var z=r(5960);Object.defineProperty(t,"unwrapBlock",{enumerable:!0,get:function(){return z.unwrapBlock}});var W=r(8513);Object.defineProperty(t,"addSegment",{enumerable:!0,get:function(){return W.addSegment}});var G=r(3897);Object.defineProperty(t,"isWhiteSpacePreserved",{enumerable:!0,get:function(){return G.isWhiteSpacePreserved}});var U=r(3393);Object.defineProperty(t,"normalizeSingleSegment",{enumerable:!0,get:function(){return U.normalizeSingleSegment}});var K=r(6195);Object.defineProperty(t,"applySegmentFormatToElement",{enumerable:!0,get:function(){return K.applySegmentFormatToElement}});var V=r(3963);Object.defineProperty(t,"setParagraphNotImplicit",{enumerable:!0,get:function(){return V.setParagraphNotImplicit}});var q=r(8704);Object.defineProperty(t,"parseValueWithUnit",{enumerable:!0,get:function(){return q.parseValueWithUnit}});var $=r(1136);Object.defineProperty(t,"BorderKeys",{enumerable:!0,get:function(){return $.BorderKeys}});var X=r(5150);Object.defineProperty(t,"DeprecatedColors",{enumerable:!0,get:function(){return X.DeprecatedColors}}),Object.defineProperty(t,"getColor",{enumerable:!0,get:function(){return X.getColor}}),Object.defineProperty(t,"setColor",{enumerable:!0,get:function(){return X.setColor}});var Y=r(9968);Object.defineProperty(t,"createDomToModelContext",{enumerable:!0,get:function(){return Y.createDomToModelContext}}),Object.defineProperty(t,"createDomToModelContextWithConfig",{enumerable:!0,get:function(){return Y.createDomToModelContextWithConfig}}),Object.defineProperty(t,"createDomToModelConfig",{enumerable:!0,get:function(){return Y.createDomToModelConfig}});var Z=r(8530);Object.defineProperty(t,"createModelToDomContext",{enumerable:!0,get:function(){return Z.createModelToDomContext}}),Object.defineProperty(t,"createModelToDomContextWithConfig",{enumerable:!0,get:function(){return Z.createModelToDomContextWithConfig}}),Object.defineProperty(t,"createModelToDomConfig",{enumerable:!0,get:function(){return Z.createModelToDomConfig}})},3963:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setParagraphNotImplicit=void 0,t.setParagraphNotImplicit=function(e){"Paragraph"==e.blockType&&e.isImplicit&&(e.isImplicit=!1)}},9275:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addBlock=void 0,t.addBlock=function(e,t){e.blocks.push(t)}},3883:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addDecorators=t.addCode=t.addLink=void 0;var n=r(7582);function o(e,t){t.format.href&&(e.link={format:(0,n.__assign)({},t.format),dataset:(0,n.__assign)({},t.dataset)})}function a(e,t){t.format.fontFamily&&(e.code={format:(0,n.__assign)({},t.format)})}t.addLink=o,t.addCode=a,t.addDecorators=function(e,t){o(e,t.link),a(e,t.code)}},8513:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSegment=void 0;var n=r(2101);t.addSegment=function(e,t,r){var o=(0,n.ensureParagraph)(e,r),a=o.segments[o.segments.length-1];return"SelectionMarker"==t.segmentType?a&&a.isSelected||o.segments.push(t):(t.isSelected&&"SelectionMarker"==(null==a?void 0:a.segmentType)&&o.segments.pop(),o.segments.push(t)),o}},6195:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applySegmentFormatToElement=void 0;var n=r(7908),o=r(8530);t.applySegmentFormatToElement=function(e,t){var r=(0,o.createModelToDomContext)();(0,n.applyFormat)(e,r.formatAppliers.segment,t,r)}},2101:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureParagraph=void 0;var n=r(9275),o=r(5092);t.ensureParagraph=function(e,t){var r=e.blocks[e.blocks.length-1];if("Paragraph"==(null==r?void 0:r.blockType))return r;var a=(0,o.createParagraph)(!0,t);return(0,n.addBlock)(e,a),a}},7084:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasSpacesOnly=void 0;var r=/^[\r\n\t ]*$/;t.hasSpacesOnly=function(e){return r.test(e)}},4451:(e,t)=>{"use strict";function r(e){switch(e.blockType){case"Paragraph":return 0==e.segments.length;case"Table":return e.rows.every((function(e){return 0==e.cells.length}));case"BlockGroup":return n(e);default:return!1}}function n(e){switch(e.blockGroupType){case"FormatContainer":return"div"!=e.tagName&&e.blocks.every(r);case"ListItem":return e.blocks.every(r);case"Document":case"General":case"TableCell":return!1;default:return!0}}function o(e){switch(e.segmentType){case"Text":return!e.text;case"Image":return!e.src;default:return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmpty=t.isSegmentEmpty=t.isBlockGroupEmpty=t.isBlockEmpty=void 0,t.isBlockEmpty=r,t.isBlockGroupEmpty=n,t.isSegmentEmpty=o,t.isEmpty=function(e){return function(e){return"string"==typeof e.blockGroupType}(e)?n(e):function(e){return"string"==typeof e.blockType}(e)?r(e):!!function(e){return"string"==typeof e.segmentType}(e)&&o(e)}},183:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeneralSegment=void 0,t.isGeneralSegment=function(e){return"General"==e.blockGroupType&&"General"==e.segmentType}},3897:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWhiteSpacePreserved=void 0;var r=["pre","pre-wrap","break-spaces"];t.isWhiteSpacePreserved=function(e){return e.format.whiteSpace&&r.indexOf(e.format.whiteSpace)>=0||!1}},8767:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeContentModel=void 0;var n=r(4451),o=r(4858),a=r(5960);t.normalizeContentModel=function e(t){for(var r=t.blocks.length-1;r>=0;r--){var i=t.blocks[r];switch(i.blockType){case"BlockGroup":"ListItem"==i.blockGroupType&&0==i.levels.length?(r+=i.blocks.length,(0,a.unwrapBlock)(t,i)):e(i);break;case"Paragraph":(0,o.normalizeParagraph)(i);break;case"Table":for(var l=0;l<i.rows.length;l++)for(var s=0;s<i.rows[l].cells.length;s++)i.rows[l].cells[s]&&e(i.rows[l].cells[s])}(0,n.isBlockEmpty)(i)&&t.blocks.splice(r,1)}}},4858:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeParagraph=void 0;var n=r(8310),o=r(7826),a=r(4451),i=r(3897),l=r(3393);t.normalizeParagraph=function(e){var t=e.segments;if(!e.isImplicit&&t.length>0){var r=t[t.length-1],s=t[t.length-2];if("SelectionMarker"!=r.segmentType||s&&"Br"!=s.segmentType){if(t.length>1&&"Br"==t[t.length-1].segmentType){var c=t.filter((function(e){return"SelectionMarker"!=e.segmentType}));c.length>1&&"Br"!=c[c.length-2].segmentType&&t.pop()}}else t.push((0,o.createBr)(r.format))}(0,i.isWhiteSpacePreserved)(e)||(0,l.normalizeAllSegments)(e),function(e){var t=e.segments.find((function(e){return"SelectionMarker"==e.segmentType}));if(t){var r=e.segments.indexOf(t),o=e.segments[r-1],a=e.segments[r+1];(o&&!o.link&&(0,n.areSameFormats)(o.format,t.format)&&(!a||!a.link&&(0,n.areSameFormats)(a.format,t.format))&&t.link||!o&&t.link&&a&&!a.link&&(0,n.areSameFormats)(a.format,t.format))&&delete t.link}}(e),function(e){for(var t=e.segments.length-1;t>=0;t--)(0,a.isSegmentEmpty)(e.segments[t])&&e.segments.splice(t,1)}(e)}},3393:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeSegment=t.createNormalizeSegmentContext=t.normalizeSingleSegment=t.normalizeAllSegments=void 0;var n=r(7084),o=" ",a=" ",i=/^\u0020+/,l=/\u0020+$/;function s(e){return Object.assign(null!=e?e:{},{textSegments:[],ignoreLeadingSpaces:!0,ignoreTrailingSpaces:!0,lastInlineSegment:void 0,lastTextSegment:void 0})}function c(e,t){switch(e.segmentType){case"Br":d(t.textSegments,t.lastInlineSegment),u(t.lastTextSegment,t.lastInlineSegment),s(t);break;case"Entity":case"General":case"Image":t.lastInlineSegment=e,t.ignoreLeadingSpaces=!1;break;case"Text":t.textSegments.push(e),t.lastInlineSegment=e,t.lastTextSegment=e;var r=e.text.substring(0,1),c=e.text.substr(-1);(0,n.hasSpacesOnly)(e.text)||(r==o&&(e.text=e.text.replace(i,t.ignoreLeadingSpaces?"":a)),c==o&&(e.text=e.text.replace(l,t.ignoreTrailingSpaces?o:a))),t.ignoreLeadingSpaces=c==o}}function d(e,t){e.forEach((function(e){if(e!=t){var r=e.text;r.substr(-1)==a&&r.length>1&&r.substr(-2,1)!=o&&(e.text=r.substring(0,r.length-1)+o)}}))}function u(e,t){e&&e==t&&(null==e?void 0:e.text.substr(-1))==o&&(e.text=e.text.replace(l,""))}t.normalizeAllSegments=function(e){var t=s();e.segments.forEach((function(e){c(e,t)})),d(t.textSegments,t.lastInlineSegment),u(t.lastTextSegment,t.lastInlineSegment)},t.normalizeSingleSegment=function(e,t){void 0===t&&(t=!1);var r=s();r.ignoreTrailingSpaces=t,c(e,r)},t.createNormalizeSegmentContext=function(){return s()},t.normalizeSegment=c},5960:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unwrapBlock=void 0;var n=r(7582),o=r(3963);t.unwrapBlock=function(e,t){var r,a,i=null!==(a=null==e?void 0:e.blocks.indexOf(t))&&void 0!==a?a:-1;i>=0&&(t.blocks.forEach(o.setParagraphNotImplicit),null==e||(r=e.blocks).splice.apply(r,(0,n.__spreadArray)([i,1],(0,n.__read)(t.blocks),!1)))}},7826:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createBr=void 0;var n=r(7582);t.createBr=function(e){return{segmentType:"Br",format:e?(0,n.__assign)({},e):{}}}},5733:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelDocument=void 0,t.createContentModelDocument=function(e){var t={blockGroupType:"Document",blocks:[]};return e&&(t.format=e),t}},7110:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDivider=void 0;var n=r(7582);t.createDivider=function(e,t){return{blockType:"Divider",tagName:e,format:t?(0,n.__assign)({},t):{}}}},1033:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEntity=void 0;var n=r(7582);t.createEntity=function(e,t,r,o,a){return void 0===t&&(t=!0),{segmentType:"Entity",blockType:"Entity",format:(0,n.__assign)({},r),entityFormat:{id:a,entityType:o,isReadonly:t},wrapper:e}}},2766:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFormatContainer=void 0;var n=r(7582);t.createFormatContainer=function(e,t){return{blockType:"BlockGroup",blockGroupType:"FormatContainer",tagName:e,blocks:[],format:(0,n.__assign)({},t||{})}}},9237:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneralBlock=void 0,t.createGeneralBlock=function(e){return{blockType:"BlockGroup",blockGroupType:"General",element:e,blocks:[],format:{}}}},8885:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneralSegment=void 0;var n=r(7582);t.createGeneralSegment=function(e,t){return{blockType:"BlockGroup",blockGroupType:"General",segmentType:"General",format:t?(0,n.__assign)({},t):{},blocks:[],element:e}}},5566:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createImage=void 0;var n=r(7582);t.createImage=function(e,t){return{segmentType:"Image",src:e,format:t?(0,n.__assign)({},t):{},dataset:{}}}},7724:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListItem=void 0;var n=r(1285),o=r(5114);t.createListItem=function(e,t){return{blockType:"BlockGroup",blockGroupType:"ListItem",blocks:[],levels:e?e.map((function(e){return(0,n.createListLevel)(e.listType,e.format,e.dataset)})):[],formatHolder:(0,o.createSelectionMarker)(t),format:{}}}},1285:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListLevel=void 0;var n=r(7582);t.createListLevel=function(e,t,r){return{listType:e,format:(0,n.__assign)({},t),dataset:(0,n.__assign)({},r)}}},5092:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParagraph=void 0;var n=r(7582);t.createParagraph=function(e,t,r,o){var a={blockType:"Paragraph",segments:[],format:t?(0,n.__assign)({},t):{}};return r&&Object.keys(r).length>0&&(a.segmentFormat=(0,n.__assign)({},r)),e&&(a.isImplicit=!0),o&&(a.decorator={tagName:o.tagName,format:(0,n.__assign)({},o.format)}),a}},24:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParagraphDecorator=void 0;var n=r(7582);t.createParagraphDecorator=function(e,t){return{tagName:e.toLocaleLowerCase(),format:(0,n.__assign)({},t||{})}}},5114:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionMarker=void 0;var n=r(7582);t.createSelectionMarker=function(e){return{segmentType:"SelectionMarker",isSelected:!0,format:e?(0,n.__assign)({},e):{}}}},988:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTable=void 0;var n=r(7582);t.createTable=function(e,t){for(var r=[],o=0;o<e;o++)r.push({height:0,format:{},cells:[]});return{blockType:"Table",rows:r,format:(0,n.__assign)({},t||{}),widths:[],dataset:{}}}},1160:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTableCell=void 0;var n=r(7582);t.createTableCell=function(e,t,r,o){var a="number"==typeof e?e>1:!!e,i="number"==typeof t?t>1:!!t;return{blockGroupType:"TableCell",blocks:[],format:o?(0,n.__assign)({},o):{},spanLeft:a,spanAbove:i,isHeader:!!r,dataset:{}}}},840:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createText=void 0;var n=r(7582),o=r(3883);t.createText=function(e,t,r,a){var i={segmentType:"Text",text:e,format:t?(0,n.__assign)({},t):{}};return r&&(0,o.addLink)(i,r),a&&(0,o.addCode)(i,a),i}},4266:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contentModelToDom=void 0;var n=r(6820),o=r(3233);function a(e){var t,r,a,i;if(e.block&&(e.segment?(0,o.isNodeOfType)(e.segment,"TEXT_NODE")?i={container:e.segment,offset:(null===(t=e.segment.nodeValue)||void 0===t?void 0:t.length)||0}:e.segment.parentNode&&(i={container:e.segment.parentNode,offset:(0,n.default)(e.segment.parentNode.childNodes).indexOf(e.segment)+1}):i={container:e.block,offset:0}),i&&(0,o.isNodeOfType)(i.container,"DOCUMENT_FRAGMENT_NODE")){var l=i.container.childNodes;if(l.length>i.offset)i={container:l[i.offset],offset:0};else if(i.container.lastChild){var s=i.container.lastChild;i={container:s,offset:(0,o.isNodeOfType)(s,"TEXT_NODE")?null!==(a=null===(r=s.nodeValue)||void 0===r?void 0:r.length)&&void 0!==a?a:0:s.childNodes.length}}else i=void 0}return i}t.contentModelToDom=function(e,t,r,n,o){n.onNodeCreated=o,n.modelHandlers.blockGroupChildren(e,t,r,n);var i=function(e,t){var r,n,o=t.regularSelection,i=o.start,l=o.end,s=t.tableSelection,c=t.imageSelection;if(c)return c;if((r=i&&a(i))&&(n=l&&a(l))){var d=e.createRange();return d.setStart(r.container,r.offset),d.setEnd(n.container,n.offset),{type:"range",range:d}}return s||null}(e,n);return t.normalize(),i}},8530:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildFormatAppliers=t.createModelToDomConfig=t.createModelToDomContextWithConfig=t.createModelToDomContext=void 0;var n=r(7582),o=r(9550),a=r(3871),i=r(8659);function l(e,t){return Object.assign({},t,{regularSelection:{current:{block:null,segment:null}}},{listFormat:{threadItemCounts:[],nodeStack:[]},implicitFormat:{}},e)}function s(e){return{modelHandlers:Object.assign.apply(Object,(0,n.__spreadArray)([{},o.defaultContentModelHandlers],(0,n.__read)(e.map((function(e){return null==e?void 0:e.modelHandlerOverride}))),!1)),formatAppliers:c(e.map((function(e){return null==e?void 0:e.formatApplierOverride})),e.map((function(e){return null==e?void 0:e.additionalFormatAppliers}))),defaultModelHandlers:o.defaultContentModelHandlers,defaultFormatAppliers:i.defaultFormatAppliers,metadataAppliers:Object.assign.apply(Object,(0,n.__spreadArray)([{}],(0,n.__read)(e.map((function(e){return null==e?void 0:e.metadataAppliers}))),!1))}}function c(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var r=Object.assign.apply(Object,(0,n.__spreadArray)([{}],(0,n.__read)(e),!1));return(0,a.getObjectKeys)(i.defaultFormatKeysPerCategory).reduce((function(e,o){var a,l=(a=i.defaultFormatKeysPerCategory[o].map((function(e){return void 0===r[e]?i.defaultFormatAppliers[e]:r[e]}))).concat.apply(a,(0,n.__spreadArray)([],(0,n.__read)(t.map((function(e){var t;return null!==(t=null==e?void 0:e[o])&&void 0!==t?t:[]}))),!1));return e[o]=l,e}),{})}t.createModelToDomContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l(s(t),e)},t.createModelToDomContextWithConfig=l,t.createModelToDomConfig=s,t.buildFormatAppliers=c},9550:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultContentModelHandlers=void 0;var n=r(3377),o=r(7352),a=r(6830),i=r(1379),l=r(736),s=r(740),c=r(3035),d=r(1920),u=r(3378),f=r(6026),p=r(1351),m=r(3913),v=r(1596),g=r(8109),h=r(8906);t.defaultContentModelHandlers={block:n.handleBlock,blockGroupChildren:o.handleBlockGroupChildren,br:a.handleBr,entityBlock:l.handleEntityBlock,entitySegment:l.handleEntitySegment,generalBlock:c.handleGeneralBlock,generalSegment:c.handleGeneralSegment,divider:i.handleDivider,image:d.handleImage,list:u.handleList,listItem:f.handleListItem,paragraph:p.handleParagraph,formatContainer:s.handleFormatContainer,segment:m.handleSegment,segmentDecorator:v.handleSegmentDecorator,table:g.handleTable,text:h.handleText}},3377:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleBlock=void 0,t.handleBlock=function(e,t,r,n,o){var a=n.modelHandlers;switch(r.blockType){case"Table":o=a.table(e,t,r,n,o);break;case"Paragraph":o=a.paragraph(e,t,r,n,o);break;case"Entity":o=a.entityBlock(e,t,r,n,o);break;case"Divider":o=a.divider(e,t,r,n,o);break;case"BlockGroup":switch(r.blockGroupType){case"General":o=a.generalBlock(e,t,r,n,o);break;case"FormatContainer":o=a.formatContainer(e,t,r,n,o);break;case"ListItem":o=a.listItem(e,t,r,n,o)}}return o}},7352:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleBlockGroupChildren=void 0,t.handleBlockGroupChildren=function(e,t,r,n){var o,a=n.listFormat,i=a.nodeStack,l=t.firstChild;try{for(r.blocks.forEach((function(r,o){0!=o&&"BlockGroup"==r.blockType&&"ListItem"==r.blockGroupType||(a.nodeStack=[]),l=n.modelHandlers.block(e,t,r,n,l)}));l;){var s=l.nextSibling;null===(o=l.parentNode)||void 0===o||o.removeChild(l),l=s}}finally{a.nodeStack=i}}},6830:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleBr=void 0;var n=r(8826);t.handleBr=function(e,t,r,o,a){var i=e.createElement("br"),l=e.createElement("span");l.appendChild(i),t.appendChild(l),(0,n.handleSegmentCommon)(e,i,l,r,o,a)}},1379:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleDivider=void 0;var n=r(7908),o=r(5381);t.handleDivider=function(e,t,r,a,i){var l,s=a.allowCacheElement?r.cachedElement:void 0;return s?i=(0,o.reuseCachedElement)(t,s,i):(s=e.createElement(r.tagName),a.allowCacheElement&&(r.cachedElement=s),t.insertBefore(s,i),(0,n.applyFormat)(s,a.formatAppliers.divider,r.format,a),r.size&&s.setAttribute("size",r.size)),null===(l=a.onNodeCreated)||void 0===l||l.call(a,r,s),i}},736:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleEntitySegment=t.handleEntityBlock=void 0;var n=r(7582),o=r(2033),a=r(7908),i=r(3871),l=r(5381),s=r(8066);t.handleEntityBlock=function(e,t,r,n,o){var i,s=r.entityFormat,c=r.wrapper;return(0,a.applyFormat)(c,n.formatAppliers.entity,s,n),o=(0,l.reuseCachedElement)(t,c,o),null===(i=n.onNodeCreated)||void 0===i||i.call(n,r,c),o},t.handleEntitySegment=function(e,t,r,l,c){var d,u=r.entityFormat,f=r.wrapper,p=r.format;if(t.appendChild(f),null==c||c.push(f),(0,i.getObjectKeys)(p).length>0){var m=(0,s.wrap)(e,f,"span");(0,a.applyFormat)(m,l.formatAppliers.segment,p,l)}if((0,a.applyFormat)(f,l.formatAppliers.entity,u,l),l.addDelimiterForEntity&&u.isReadonly){var v=(0,n.__read)((0,o.addDelimiters)(e,f),2),g=v[0],h=v[1];null==c||c.push(g,h),l.regularSelection.current.segment=g}else l.regularSelection.current.segment=f;null===(d=l.onNodeCreated)||void 0===d||d.call(l,r,f)}},740:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleFormatContainer=void 0;var n=r(7908),o=r(4451),a=r(5381),i=r(3348),l={fontFamily:"monospace",whiteSpace:"pre"};t.handleFormatContainer=function(e,t,r,s,c){var d,u=s.allowCacheElement?r.cachedElement:void 0;if(u)c=(0,a.reuseCachedElement)(t,u,c),s.modelHandlers.blockGroupChildren(e,u,r,s);else if(!(0,o.isBlockGroupEmpty)(r)){var f=e.createElement(r.tagName);s.allowCacheElement&&(r.cachedElement=f),t.insertBefore(f,c),(0,i.stackFormat)(s,r.tagName,(function(){(0,n.applyFormat)(f,s.formatAppliers.container,r.format,s),(0,n.applyFormat)(f,s.formatAppliers.segmentOnBlock,r.format,s),(0,n.applyFormat)(f,s.formatAppliers.container,r.format,s)})),"pre"==r.tagName?(0,i.stackFormat)(s,l,(function(){s.modelHandlers.blockGroupChildren(e,f,r,s)})):s.modelHandlers.blockGroupChildren(e,f,r,s),u=f}return u&&(null===(d=s.onNodeCreated)||void 0===d||d.call(s,r,u)),c}},3035:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleGeneralSegment=t.handleGeneralBlock=void 0;var n=r(8826),o=r(3233),a=r(5381),i=r(8066);t.handleGeneralBlock=function(e,t,r,n,o){var i,l=r.element;return o&&l.parentNode==t?o=(0,a.reuseCachedElement)(t,l,o):(l=l.cloneNode(),r.element=l,t.insertBefore(l,o)),null===(i=n.onNodeCreated)||void 0===i||i.call(n,r,l),n.modelHandlers.blockGroupChildren(e,l,r,n),o},t.handleGeneralSegment=function(e,t,r,a,l){var s,c=r.element.cloneNode();if(r.element=c,t.appendChild(c),(0,o.isNodeOfType)(c,"ELEMENT_NODE")){var d=(0,i.wrap)(e,c,"span");(0,n.handleSegmentCommon)(e,c,d,r,a,l),null===(s=a.onNodeCreated)||void 0===s||s.call(a,r,c)}a.modelHandlers.blockGroupChildren(e,c,r,a)}},1920:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleImage=void 0;var n=r(7908),o=r(8826),a=r(8704);t.handleImage=function(e,t,r,i,l){var s=e.createElement("img"),c=document.createElement("span");t.appendChild(c),c.appendChild(s),s.src=r.src,r.alt&&(s.alt=r.alt),r.title&&(s.title=r.title),(0,n.applyFormat)(s,i.formatAppliers.image,r.format,i),(0,n.applyFormat)(s,i.formatAppliers.dataset,r.dataset,i);var d=r.format,u=d.width,f=d.height,p=u?(0,a.parseValueWithUnit)(u):0,m=f?(0,a.parseValueWithUnit)(f):0;p>0&&(s.width=p),m>0&&(s.height=m),r.isSelectedAsImageSelection&&(i.imageSelection={type:"image",image:s}),(0,o.handleSegmentCommon)(e,s,c,r,i,l)}},3378:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleList=void 0;var n=r(7582),o=r(7908),a=r(7111);t.handleList=function(e,t,r,i,l){var s,c,d=0,u=i.listFormat.nodeStack;for(0==u.length&&u.push({node:t});d<r.levels.length&&d+1<u.length;d++){var f=u[d+1],p=r.levels[d];if(f.listType!=p.listType||(null===(s=f.dataset)||void 0===s?void 0:s.editingInfo)!=p.dataset.editingInfo||"OL"==p.listType&&"number"==typeof p.format.startNumberOverride)break}for(u.splice(d+1);d<r.levels.length;d++){var m=r.levels[d],v=e.createElement(m.listType||"UL");u[u.length-1].node.insertBefore(v,0==d?l:null),u.push((0,n.__assign)({node:v},m)),(0,o.applyFormat)(v,i.formatAppliers.listLevelThread,m.format,i),(0,a.applyMetadata)(m,i.metadataAppliers.listLevel,m.format,i),(0,o.applyFormat)(v,i.formatAppliers.listLevel,m.format,i),(0,o.applyFormat)(v,i.formatAppliers.dataset,m.dataset,i),null===(c=i.onNodeCreated)||void 0===c||c.call(i,m,v)}return l}},6026:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleListItem=void 0;var n=r(7908),o=r(7111),a=r(3963),i=r(9448);t.handleListItem=function(e,t,r,l,s){var c,d;s=l.modelHandlers.list(e,t,r,l,s);var u=l.listFormat.nodeStack,f=(null===(c=null==u?void 0:u[(null==u?void 0:u.length)-1])||void 0===c?void 0:c.node)||t,p=e.createElement("li"),m=r.levels[r.levels.length-1];return f.insertBefore(p,(null==s?void 0:s.parentNode)==f?s:null),m?((0,n.applyFormat)(p,l.formatAppliers.segment,r.formatHolder.format,l),(0,n.applyFormat)(p,l.formatAppliers.listItemThread,m.format,l),(0,o.applyMetadata)(m,l.metadataAppliers.listItem,r.format,l),(0,n.applyFormat)(p,l.formatAppliers.listItemElement,r.format,l),l.modelHandlers.blockGroupChildren(e,p,r,l)):(r.blocks.forEach(a.setParagraphNotImplicit),l.modelHandlers.blockGroupChildren(e,p,r,l),(0,i.unwrap)(p)),null===(d=l.onNodeCreated)||void 0===d||d.call(l,r,p),s}},1351:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleParagraph=void 0;var n=r(7582),o=r(7908),a=r(3871),i=r(6976),l=r(5381),s=r(3348),c=r(9448);t.handleParagraph=function(e,t,r,d,u){var f,p=d.allowCacheElement?r.cachedElement:void 0;return p?u=(0,l.reuseCachedElement)(t,p,u):(0,s.stackFormat)(d,(null===(f=r.decorator)||void 0===f?void 0:f.tagName)||null,(function(){var l,f,m,v,g=!r.isImplicit||!!r.decorator||(0,a.getObjectKeys)(r.format).length>0&&r.segments.some((function(e){return"SelectionMarker"!=e.segmentType})),h=g?(0,n.__assign)((0,n.__assign)({},(null===(l=r.decorator)||void 0===l?void 0:l.format)||{}),r.segmentFormat):{};p=e.createElement((null===(f=r.decorator)||void 0===f?void 0:f.tagName)||"div"),t.insertBefore(p,u),d.regularSelection.current={block:g?p:p.parentNode,segment:null};var b=function(){var t=p;if(t){var o=r.segments[0];"SelectionMarker"==(null==o?void 0:o.segmentType)&&d.modelHandlers.text(e,t,(0,n.__assign)((0,n.__assign)({},o),{segmentType:"Text",text:""}),d,[]),r.segments.forEach((function(n){var o=[];d.modelHandlers.segment(e,t,n,d,o),o.forEach((function(e){var t;null===(t=d.domIndexer)||void 0===t||t.onSegment(e,r,[n])}))}))}};g?((0,s.stackFormat)(d,h,b),(0,o.applyFormat)(p,d.formatAppliers.block,r.format,d),(0,o.applyFormat)(p,d.formatAppliers.container,r.format,d),(0,o.applyFormat)(p,d.formatAppliers.segmentOnBlock,h,d)):b(),(0,i.optimize)(p),u=p.nextSibling,p&&(null===(m=d.onNodeCreated)||void 0===m||m.call(d,r,p),null===(v=d.domIndexer)||void 0===v||v.onParagraph(p)),g?d.allowCacheElement&&(r.cachedElement=p):((0,c.unwrap)(p),p=void 0)})),u}},3913:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegment=void 0;var n=r(7582);t.handleSegment=function(e,t,r,o,a){var i=o.regularSelection;switch(r.isSelected&&!i.start&&(i.start=(0,n.__assign)({},i.current)),r.segmentType){case"Text":o.modelHandlers.text(e,t,r,o,a);break;case"Br":o.modelHandlers.br(e,t,r,o,a);break;case"Image":o.modelHandlers.image(e,t,r,o,a);break;case"General":o.modelHandlers.generalSegment(e,t,r,o,a);break;case"Entity":o.modelHandlers.entitySegment(e,t,r,o,a)}r.isSelected&&i.start&&(i.end=(0,n.__assign)({},i.current))}},1596:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegmentDecorator=void 0;var n=r(7908),o=r(3233),a=r(3348),i=r(4478);t.handleSegmentDecorator=function(e,t,r,l,s){var c=r.code,d=r.link;(0,o.isNodeOfType)(t,"ELEMENT_NODE")&&(d&&(0,a.stackFormat)(l,"a",(function(){var e,r=(0,i.wrapAllChildNodes)(t,"a");(0,n.applyFormat)(r,l.formatAppliers.link,d.format,l),(0,n.applyFormat)(r,l.formatAppliers.dataset,d.dataset,l),null==s||s.push(r),null===(e=l.onNodeCreated)||void 0===e||e.call(l,d,r)})),c&&(0,a.stackFormat)(l,"code",(function(){var e,r=(0,i.wrapAllChildNodes)(t,"code");(0,n.applyFormat)(r,l.formatAppliers.code,c.format,l),null==s||s.push(r),null===(e=l.onNodeCreated)||void 0===e||e.call(l,c,r)})))}},8109:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleTable=void 0;var n=r(7908),o=r(6245),a=r(4451),i=r(4478),l=r(5381);t.handleTable=function(e,t,r,s,c){var d,u,f,p,m,v,g;if((0,a.isBlockEmpty)(r))return c;var h=s.allowCacheElement?r.cachedElement:void 0;h?(c=(0,l.reuseCachedElement)(t,h,c),(0,i.moveChildNodes)(h)):(h=e.createElement("table"),s.allowCacheElement&&(r.cachedElement=h),t.insertBefore(h,c),(0,n.applyFormat)(h,s.formatAppliers.block,r.format,s),(0,n.applyFormat)(h,s.formatAppliers.table,r.format,s),(0,n.applyFormat)(h,s.formatAppliers.tableBorder,r.format,s),(0,n.applyFormat)(h,s.formatAppliers.dataset,r.dataset,s)),null===(d=s.onNodeCreated)||void 0===d||d.call(s,r,h);var b=e.createElement("tbody");h.appendChild(b);for(var y=0;y<r.rows.length;y++){var C=r.rows[y];if(0!=C.cells.length){var S=s.allowCacheElement&&C.cachedElement||e.createElement("tr");b.appendChild(S),(0,i.moveChildNodes)(S),C.cachedElement||(s.allowCacheElement&&(C.cachedElement=S),(0,n.applyFormat)(S,s.formatAppliers.tableRow,C.format,s)),null===(u=s.onNodeCreated)||void 0===u||u.call(s,C,S);for(var _=0;_<C.cells.length;_++){var k=C.cells[_];if(k.isSelected){var P=s.tableSelection||{type:"table",table:h,firstColumn:_,lastColumn:_,firstRow:y,lastRow:y};P.table==h&&(P.lastColumn=Math.max(P.lastColumn,_),P.lastRow=Math.max(P.lastRow,y)),s.tableSelection=P}if(!k.spanAbove&&!k.spanLeft){var w=s.allowCacheElement&&k.cachedElement||e.createElement(k.isHeader?"th":"td");S.appendChild(w);for(var M=1,E=1,O=r.widths[_],T=C.height;null===(p=null===(f=r.rows[y+M])||void 0===f?void 0:f.cells[_])||void 0===p?void 0:p.spanAbove;M++)T+=r.rows[y+M].height;for(;null===(m=C.cells[_+E])||void 0===m?void 0:m.spanLeft;E++)O+=r.widths[_+E];M>1&&(w.rowSpan=M),E>1&&(w.colSpan=E),(!k.cachedElement||k.format.useBorderBox&&(0,o.hasMetadata)(r))&&(O>0&&!w.style.width&&(w.style.width=O+"px"),T>0&&!w.style.height&&(w.style.height=T+"px")),k.cachedElement||(s.allowCacheElement&&(k.cachedElement=w),(0,n.applyFormat)(w,s.formatAppliers.block,k.format,s),(0,n.applyFormat)(w,s.formatAppliers.tableCell,k.format,s),(0,n.applyFormat)(w,s.formatAppliers.tableCellBorder,k.format,s),(0,n.applyFormat)(w,s.formatAppliers.dataset,k.dataset,s)),s.modelHandlers.blockGroupChildren(e,w,k,s),null===(v=s.onNodeCreated)||void 0===v||v.call(s,k,w)}}}}return null===(g=s.domIndexer)||void 0===g||g.onTable(h,r),c}},8906:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleText=void 0;var n=r(8826);t.handleText=function(e,t,r,o,a){var i=e.createTextNode(r.text),l=e.createElement("span");t.appendChild(l),l.appendChild(i),(0,n.handleSegmentCommon)(e,i,l,r,o,a)}},2920:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeNode=void 0;var n=r(3233),o=["SPAN","B","EM","I","U","SUB","SUP","STRIKE","S","A","CODE"];function a(e,t){var r=e.attributes,n=t.attributes;if(r.length!=n.length)return!1;for(var o=0;o<r.length;o++)if(r[o].name!=n[o].name||r[o].value!=n[o].value)return!1;return!0}t.mergeNode=function(e){for(var t=e.firstChild;t;){var r=t.nextSibling;if(r&&(0,n.isNodeOfType)(t,"ELEMENT_NODE")&&(0,n.isNodeOfType)(r,"ELEMENT_NODE")&&t.tagName==r.tagName&&o.indexOf(t.tagName)>=0&&a(t,r)){for(;r.firstChild;)t.appendChild(r.firstChild);r.parentNode.removeChild(r)}else t=r}}},6976:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.optimize=void 0;var n=r(2033),o=r(2920),a=r(9486);t.optimize=function e(t){if(!(0,n.isEntityElement)(t)){(0,a.removeUnnecessarySpan)(t),(0,o.mergeNode)(t);for(var r=t.firstChild;r;r=r.nextSibling)e(r)}}},9486:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeUnnecessarySpan=void 0;var n=r(3233);t.removeUnnecessarySpan=function(e){for(var t=e.firstChild;t;)if((0,n.isNodeOfType)(t,"ELEMENT_NODE")&&"SPAN"==t.tagName&&0==t.attributes.length){var r=t,o=t.nextSibling;for(t=t.nextSibling;r.lastChild;){var a=r.lastChild;e.insertBefore(a,o),o=a}e.removeChild(r)}else t=t.nextSibling}},7908:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyFormat=void 0,t.applyFormat=function(e,t,r,n){t.forEach((function(t){null==t||t(r,e,n)}))}},7111:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyMetadata=void 0;var n=r(6245);t.applyMetadata=function(e,t,r,o){t&&(0,n.updateMetadata)(e,(function(e){return t.applierFunction(e,r,o),e}),t.metadataDefinition)}},8826:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegmentCommon=void 0;var n=r(7908);t.handleSegmentCommon=function(e,t,r,o,a,i){var l;t.firstChild||(a.regularSelection.current.segment=t),(0,n.applyFormat)(r,a.formatAppliers.styleBasedSegment,o.format,a),null==i||i.push(t),a.modelHandlers.segmentDecorator(e,r,o,a,i),(0,n.applyFormat)(r,a.formatAppliers.elementBasedSegment,o.format,a),null===(l=a.onNodeCreated)||void 0===l||l.call(a,o,t)}},5381:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeNode=t.reuseCachedElement=void 0;var n=r(2033);t.reuseCachedElement=function(e,t,r){var o;if(t.parentNode==e){for(;r&&r!=t&&!(0,n.isEntityElement)(r);){var a=r.nextSibling;null===(o=r.parentNode)||void 0===o||o.removeChild(r),r=a}r&&r==t?r=r.nextSibling:e.insertBefore(t,r)}else e.insertBefore(t,r);return r},t.removeNode=function(e){var t,r=e.nextSibling;return null===(t=e.parentNode)||void 0===t||t.removeChild(e),r}},3348:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackFormat=void 0;var n=r(7582),o=r(3679);t.stackFormat=function(e,t,r){var a="string"==typeof t?o.defaultContentModelFormatMap[t]:t;if(a){var i=e.implicitFormat;try{e.implicitFormat=(0,n.__assign)((0,n.__assign)({},i),a),r()}finally{e.implicitFormat=i}}else r()}},2923:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addUndoSnapshot=void 0;var n=r(7582),o=r(2347);function a(e,t,r){var a;if(!e.lifecycle.shadowEditFragment){var i=e.api.getSelectionRangeEx(e),l=e.lifecycle.isDarkMode,s=function(e,t,r){switch(null==t?void 0:t.type){case 1:return(0,n.__assign)({type:1,tableId:t.table.id,isDarkMode:!!r},t.coordinates);case 2:return{type:2,imageId:t.image.id,isDarkMode:!!r};case 0:return(0,n.__assign)({type:0,isDarkMode:!!r,start:[],end:[]},(0,o.getSelectionPath)(e,t.ranges[0])||{})}}(e.contentDiv,i,l)||null;e.undo.snapshotsService.addSnapshot({html:e.contentDiv.innerHTML,metadata:s,knownColors:(null===(a=e.darkColorHandler)||void 0===a?void 0:a.getKnownColorsCopy())||[],entityStates:r},t),e.undo.hasNewContent=!1}}t.addUndoSnapshot=function(e,t,r,n,i){var l,s,c,d=e.undo,u=d.isNested;u||(d.isNested=!0,!e.undo.hasNewContent&&(null==i?void 0:i.getEntityState)&&t||a(e,n,null===(l=null==i?void 0:i.getEntityState)||void 0===l?void 0:l.call(i)));try{var f;t&&(c=t((f=e.api.getSelectionRange(e,!0))&&o.Position.getStart(f).normalize(),f&&o.Position.getEnd(f).normalize()),u||a(e,!1,null===(s=null==i?void 0:i.getEntityState)||void 0===s?void 0:s.call(i)))}finally{u||(d.isNested=!1)}if(t&&r){var p={eventType:7,source:r,data:c,additionalData:i};e.api.triggerEvent(e,p,!0)}n&&(f=e.api.getSelectionRange(e,!1))&&(e.undo.hasNewContent=!1,e.undo.autoCompletePosition=o.Position.getStart(f))}},2981:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachDomEvent=void 0;var n=r(2347);t.attachDomEvent=function(e,t){var r=(0,n.getObjectKeys)(t||{}).map((function(r){var n,o,a=(n=t[r],o={pluginEventType:null,beforeDispatch:null},"number"==typeof n?o.pluginEventType=n:"function"==typeof n?o.beforeDispatch=n:"object"==typeof n&&(o=n),o),i=a.pluginEventType,l=a.beforeDispatch,s=r,c=function(t){l&&l(t),null!=i&&e.api.triggerEvent(e,{eventType:i,rawEvent:t},!1)};return e.contentDiv.addEventListener(s,c),function(){e.contentDiv.removeEventListener(s,c)}}));return function(){return r.forEach((function(e){return e()}))}}},2388:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coreApiMap=void 0;var n=r(2923),o=r(2981),a=r(9083),i=r(180),l=r(9711),s=r(1162),c=r(7899),d=r(8983),u=r(6189),f=r(4035),p=r(2811),m=r(9056),v=r(2038),g=r(5561),h=r(5399),b=r(3180),y=r(8592),C=r(7622);t.coreApiMap={attachDomEvent:o.attachDomEvent,addUndoSnapshot:n.addUndoSnapshot,ensureTypeInContainer:a.ensureTypeInContainer,focus:i.focus,getContent:l.getContent,getSelectionRange:s.getSelectionRange,getSelectionRangeEx:c.getSelectionRangeEx,getStyleBasedFormatState:d.getStyleBasedFormatState,hasFocus:u.hasFocus,insertNode:f.insertNode,restoreUndoSnapshot:p.restoreUndoSnapshot,select:m.select,selectRange:g.selectRange,setContent:b.setContent,transformColor:y.transformColor,triggerEvent:C.triggerEvent,selectTable:h.selectTable,selectImage:v.selectImage}},9083:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureTypeInContainer=void 0;var n=r(2347);t.ensureTypeInContainer=function(e,t,r){var o,a=(0,n.findClosestElementAncestor)(t.node,e.contentDiv,"table");a&&(o=a.querySelector("td,th"))&&(t=new n.Position(o,0)),t=t.normalize();var i,l=(0,n.getBlockElementAtNode)(e.contentDiv,t.node);if(l){if(i=l.collapseToSingleElement(),(0,n.isNodeEmpty)(i,!1,!0)){var s=i.ownerDocument.createElement("br");i.append(s)}var c=(0,n.isNodeEmpty)(i)||r&&function(e,t){return(0,n.safeInstanceOf)(e.target,"Node")&&e.target.contains(t)&&e.key===t.innerText}(r,i);i=i&&c?i:null}else i=(0,n.createElement)(1,e.contentDiv.ownerDocument),e.api.insertNode(e,i,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t=new n.Position(i,0);r&&e.api.selectRange(e,(0,n.createRange)(new n.Position(t)))}},180:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.focus=void 0;var n=r(2347);t.focus=function(e){if(!e.lifecycle.shadowEditFragment){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.domEvent.selectionRange&&e.api.selectRange(e,e.domEvent.selectionRange,!0))){var t=(0,n.getFirstLeafNode)(e.contentDiv)||e.contentDiv;e.api.selectRange(e,(0,n.createRange)(t,0),!0)}e.domEvent.selectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus()}}},9711:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getContent=void 0;var n=r(2347);t.getContent=function(e,t){var r,o,a="",i=0==t,l=2==t,s=e.lifecycle.shadowEditFragment||e.contentDiv;if(4==t)a=s.textContent;else if(3==t)a=(0,n.getTextContent)(s);else{var c=(r=s,(0,n.safeInstanceOf)(r,"DocumentFragment")?(o=r.ownerDocument.createElement("div")).appendChild(r.cloneNode(!0)):o=r.cloneNode(!0),o);c.normalize();var d=e.api.getSelectionRange(e,!0),u=!l||e.lifecycle.shadowEditFragment?null:d?(0,n.getSelectionPath)(e.contentDiv,d):null,f=u&&(0,n.createRange)(c,u.start,u.end);e.api.transformColor(e,c,!1,null,1,!0,e.lifecycle.isDarkMode),i?(e.api.triggerEvent(e,{eventType:8,clonedRoot:c},!0),a=c.innerHTML):a=f?(0,n.getHtmlWithSelectionPath)(c,f):c.innerHTML}return null!=a?a:""}},1162:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionRange=void 0;var n=r(2347);t.getSelectionRange=function(e,t){var r,o=null;if(e.lifecycle.shadowEditFragment)return null;if(!t||e.api.hasFocus(e)){var a=null===(r=e.contentDiv.ownerDocument.defaultView)||void 0===r?void 0:r.getSelection();if(a&&a.rangeCount>0){var i=a.getRangeAt(0);(0,n.contains)(e.contentDiv,i)&&(o=i)}}return!o&&t&&(o=e.domEvent.selectionRange),o}},7899:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionRangeEx=void 0;var n=r(2347);function o(e){return{type:0,ranges:e,areAllCollapsed:a(e)}}function a(e){return e.filter((function(e){return null==e?void 0:e.collapsed})).length==e.length}t.getSelectionRangeEx=function(e){var t,r,a;if(e.lifecycle.shadowEditFragment)return o([]);if(e.api.hasFocus(e)){if(e.domEvent.tableSelectionRange)return e.domEvent.tableSelectionRange;if(e.domEvent.imageSelectionRange)return e.domEvent.imageSelectionRange;var i=null===(t=e.contentDiv.ownerDocument.defaultView)||void 0===t?void 0:t.getSelection();if(i&&i.rangeCount>0){var l=i.getRangeAt(0);if((0,n.contains)(e.contentDiv,l))return o([l])}}return null!==(a=null!==(r=e.domEvent.tableSelectionRange)&&void 0!==r?r:e.domEvent.imageSelectionRange)&&void 0!==a?a:o(e.domEvent.selectionRange?[e.domEvent.selectionRange]:[])}},8983:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStyleBasedFormatState=void 0;var n=r(2347);t.getStyleBasedFormatState=function(e,t){if(!t)return{};for(var r,o,a=t?(0,n.getComputedStyles)(t,["font-family","font-size","color","background-color","line-height","margin-top","margin-bottom","text-align","direction","font-weight"]):[],i=e.contentDiv,l=e.darkColorHandler;t&&(0,n.contains)(i,t,!0)&&(!r||!o);){if(1==t.nodeType){var s=t;r=r||s.style.getPropertyValue("color"),o=o||s.style.getPropertyValue("background-color")}t=t.parentNode}e.lifecycle.isDarkMode||t!=e.contentDiv||(r=r||a[2],o=o||a[3]);var c=l.parseColorValue(r),d=l.parseColorValue(o);return{fontName:a[0],fontSize:a[1],textColor:c.lightModeColor,backgroundColor:d.lightModeColor,textColors:c.darkModeColor?{lightModeColor:c.lightModeColor,darkModeColor:c.darkModeColor}:void 0,backgroundColors:d.darkModeColor?{lightModeColor:d.lightModeColor,darkModeColor:d.darkModeColor}:void 0,lineHeight:a[4],marginTop:a[5],marginBottom:a[6],textAlign:a[7],direction:a[8],fontWeight:a[9]}}},6189:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasFocus=void 0;var n=r(2347);t.hasFocus=function(e){var t=e.contentDiv.ownerDocument.activeElement;return!(!t||!(0,n.contains)(e.contentDiv,t,!0))}},4035:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertNode=void 0;var n=r(2347);t.insertNode=function(e,t,r){var o;r=r||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0,insertToRegionRoot:!1};var a=e.contentDiv;return r.updateCursor&&e.api.focus(e),4==r.position?(null===(o=a.parentNode)||void 0===o||o.insertBefore(t,a.nextSibling),!0):(e.api.transformColor(e,t,!0,(function(){var o,i;if(r)switch(r.position){case 0:case 1:var l,s=0==r.position,c=(0,n.getFirstLastBlockElement)(a,s);if(c){var d=s?c.getStartNode():c.getEndNode();r.insertOnNewLine||3==d.nodeType||(0,n.isVoidHtmlElement)(d)?(0,n.safeInstanceOf)(t,"DocumentFragment")?(l=(0,n.toArray)(t.childNodes),null===(o=d.parentNode)||void 0===o||o.insertBefore(t,s?d:d.nextSibling)):l=null===(i=d.parentNode)||void 0===i?void 0:i.insertBefore(t,s?d:d.nextSibling):l=d.insertBefore(t,s?d.firstChild:null)}else l=a.appendChild(t);if(l&&r.insertOnNewLine){var u=Array.isArray(l)?l:[l];(0,n.isBlockElement)(u[0])&&(0,n.isBlockElement)(u[u.length-1])||(0,n.wrap)(u)}break;case 2:var f=a.appendChild(t);f&&r.insertOnNewLine&&!(0,n.isBlockElement)(f)&&(0,n.wrap)(f);break;case 5:case 3:var p=function(e,t){var r=e.api.getSelectionRange(e,!0),n=null;return 5==t.position?(n=r,r=t.range):r&&(n=r.cloneRange()),{range:r,rangeToRestore:n}}(e,r),m=p.range,v=p.rangeToRestore;if(!m)return;r.replaceSelection&&!m.collapsed&&m.deleteContents();var g=n.Position.getStart(m),h=void 0;g=r.insertOnNewLine&&r.insertToRegionRoot?function(e,t,r){var o=(0,n.getRegionsFromRange)(e.contentDiv,t,0)[0],a=r.node;if(o){if(3!=a.nodeType||r.isAtEnd||(a=(0,n.splitTextNode)(a,r.offset,!0)),a!=o.rootNode)for(;a&&a.parentNode!=o.rootNode;)(0,n.splitParentNode)(a,!1),a=a.parentNode;a&&(r=new n.Position(a,-3))}return r}(e,m,g):r.insertOnNewLine&&(h=(0,n.getBlockElementAtNode)(a,g.normalize().node))?function(e,t,r){var o=new n.Position(e.getEndNode(),-3);if((0,n.safeInstanceOf)(o.node,"HTMLTableRowElement")){var a=t.contentDiv.ownerDocument.createElement("div");(0,n.createRange)(r).insertNode(a),o=new n.Position(a,0)}return o}(h,e,g):(0,n.adjustInsertPosition)(a,t,g,m);var b=11==t.nodeType?t.lastChild:t;(m=(0,n.createRange)(g)).insertNode(t),r.updateCursor&&b&&(v=(0,n.createRange)(new n.Position(b,-3).normalize())),v&&e.api.selectRange(e,v)}}),0),!0)}},2811:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreUndoSnapshot=void 0;var n=r(2347);t.restoreUndoSnapshot=function(e,t){var r,o;e.undo.hasNewContent&&t<0&&e.api.addUndoSnapshot(e,null,null,!1);var a=e.undo.snapshotsService.move(t);if(a&&null!=a.html)try{e.undo.isRestoring=!0,e.api.setContent(e,a.html,!0,null!==(r=a.metadata)&&void 0!==r?r:void 0);var i=e.darkColorHandler,l=e.lifecycle.isDarkMode;a.knownColors.forEach((function(e){i.registerColor(e.lightModeColor,l,e.darkModeColor)})),null===(o=a.entityStates)||void 0===o||o.forEach((function(t){var r=t.type,o=t.id,a=t.state,i=(0,n.queryElements)(e.contentDiv,(0,n.getEntitySelector)(r,o))[0],l=i&&(0,n.getEntityFromElement)(i);l&&e.api.triggerEvent(e,{eventType:15,operation:11,entity:l,state:a},!1)}))}finally{e.undo.isRestoring=!1}}},9056:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.select=void 0;var n=r(2347);t.select=function(e,t,r,o,a){var i=function(e,t,r,o,a){var i,l=null;if(function(e){var t=e;return t&&"object"==typeof t&&"number"==typeof t.type&&Array.isArray(t.ranges)}(t))l=t;else if((0,n.safeInstanceOf)(t,"HTMLTableElement")&&(null===(i=r)||i&&"object"==typeof i&&"object"==typeof i.firstCell&&"object"==typeof i.lastCell))l={type:1,ranges:[],areAllCollapsed:!1,table:t,coordinates:null!=r?r:void 0};else if((0,n.safeInstanceOf)(t,"HTMLImageElement")&&void 0===r)l={type:2,ranges:[],areAllCollapsed:!1,image:t};else{var s=t?(0,n.safeInstanceOf)(t,"Range")?t:function(e){var t=e;return t&&"object"==typeof t&&Array.isArray(t.start)&&Array.isArray(t.end)}(t)?(0,n.createRange)(e.contentDiv,t.start,t.end):function(e){var t=e;return t&&"object"==typeof t&&"object"==typeof t.node&&"number"==typeof t.offset}(t)||(0,n.safeInstanceOf)(t,"Node")?(0,n.createRange)(t,r,o,a):null:null;l=s?{type:0,ranges:[s],areAllCollapsed:s.collapsed}:null}return l}(e,t,r,o,a);if(i){var l=e.domEvent.skipReselectOnFocus;e.domEvent.skipReselectOnFocus=!0;try{!function(e,t){switch(null==t?void 0:t.type){case 1:(0,n.contains)(e.contentDiv,t.table)&&(e.domEvent.imageSelectionRange=e.api.selectImage(e,null),e.domEvent.tableSelectionRange=e.api.selectTable(e,t.table,t.coordinates),t=e.domEvent.tableSelectionRange);break;case 2:(0,n.contains)(e.contentDiv,t.image)&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,null),e.domEvent.imageSelectionRange=e.api.selectImage(e,t.image),t=e.domEvent.imageSelectionRange);break;case 0:e.domEvent.tableSelectionRange=e.api.selectTable(e,null),e.domEvent.imageSelectionRange=e.api.selectImage(e,null),(0,n.contains)(e.contentDiv,t.ranges[0])?e.api.selectRange(e,t.ranges[0]):t=null}e.api.triggerEvent(e,{eventType:22,selectionRangeEx:t},!0)}(e,i)}finally{e.domEvent.skipReselectOnFocus=l}}else e.domEvent.tableSelectionRange=e.api.selectTable(e,null),e.domEvent.imageSelectionRange=e.api.selectImage(e,null);return!!i}},2038:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectImage=void 0;var n=r(9898),o=r(2347),a="imageStyle";t.selectImage=function(e,t){s(e);var r=null;if(t){var a=(0,o.createRange)(t);(0,n.default)(t,"imageSelected"),(0,n.default)(e.contentDiv,"contentDiv_"),e.api.selectRange(e,(0,o.createRange)(new o.Position(t,-3))),i(e,t),r={type:2,ranges:[a],image:t,areAllCollapsed:a.collapsed}}return r};var i=function(e,t){(0,o.removeImportantStyleRule)(t,["border","margin"]);var r=l(e,t.id);(0,o.setGlobalCssStyles)(e.contentDiv.ownerDocument,r,a+e.contentDiv.id)},l=function(e,t){return"#"+e.contentDiv.id+" #"+t+" {outline-style: auto!important;outline-color: "+(e.imageSelectionBorderColor||"#DB626C")+"!important;caret-color: transparent!important;}"},s=function(e){var t=e.contentDiv.ownerDocument;(0,o.removeGlobalCssStyle)(t,a+e.contentDiv.id)}},5561:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectRange=void 0;var n=r(2347);t.selectRange=function(e,t,r){return!(e.lifecycle.shadowEditFragment||!(0,n.contains)(e.contentDiv,t)||((0,n.addRangeToSelection)(t,r),e.api.hasFocus(e)||(e.domEvent.selectionRange=t),0))}},5399:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectTable=void 0;var n=r(9898),o=r(2347),a="tableStyle";t.selectTable=function(e,t,r){var d;if(i(e),function(e){if(e){var t=e||{},r=t.firstCell,n=t.lastCell;if(r&&n){var o=function(e){return c(e.x)&&c(e.y)};return o(r)&&o(n)}}return!1}(r)&&t){(0,n.default)(t,"tableSelected"),(0,n.default)(e.contentDiv,"contentDiv_");var u=function(e,t,r){var n=function(e,t,r){var n,a=[],i=[],c=new o.VTable(e),d=(0,o.isWholeTableSelected)(c,t);d?function(e,t,r,n){var o=t.table,a=e+" #"+o.id;r.push(a,a+" *");var i=new Range;i.selectNode(o),n.push(i)}(r,c,i,a):function(e,t,r,n,a){var i,c=e.firstCell.y,d=e.firstCell.x,u=e.lastCell.y,f=e.lastCell.x,p=t.table,m=null,v=null,g=(0,o.toArray)(p.childNodes).filter((function(e){return["THEAD","TBODY","TFOOT"].indexOf((0,o.getTagOfNode)(e))>-1})),h=0,b=g.map((function(e){var t={el:(0,o.getTagOfNode)(e),start:h,end:e.childNodes.length+h};return h=t.end,t}));null===(i=t.cells)||void 0===i||i.forEach((function(e,t){var i=0;m=null,v=null;for(var g=b.filter((function(e){return e.start<=t&&e.end>t}))[0],h=g?">"+g.el+">":">",y=g&&t+1>=g.start?t+1-g.start:t+1,C=0;C<e.length;C++){var S=e[C].td;if(S&&(i++,t>=c&&t<=u&&C>=d&&C<=f)){s(S);var _=l(r,p.id,h,y,(0,o.getTagOfNode)(S),i),k=_+" *";n.push(_,k),m=m||p.querySelector(_),v=p.querySelector(_)}}if(m&&v){var P=new Range;P.setStartBefore(m),P.setEndAfter(v),a.push(P)}}))}(t,c,r,i,a);for(var u=[],f="";i.length>0;)((f+=(f.length>0?",":"")+i.shift()||"").length+((null===(n=i[0])||void 0===n?void 0:n.length)||0)>9e3||0==i.length)&&(u.push(f+" {background-color: rgb(198,198,198) !important; caret-color: transparent}"),f="");return{cssRules:u,ranges:a,isWholeTableSelected:d}}(t,r,"#"+e.contentDiv.id),i=n.cssRules,c=n.ranges,d=n.isWholeTableSelected;return i.forEach((function(t){return(0,o.setGlobalCssStyles)(e.contentDiv.ownerDocument,t,a+e.contentDiv.id)})),{ranges:c,isWholeTableSelected:d}}(e,t,r),f=u.ranges,p=u.isWholeTableSelected;if(!function(e,t){var r,n=t.firstCell;return!(e.rows.item(n.y)&&(null===(r=e.rows.item(n.y))||void 0===r?void 0:r.cells.item(n.x)))}(t,r)){var m=null===(d=t.rows.item(r.firstCell.y))||void 0===d?void 0:d.cells.item(r.firstCell.x);m&&e.api.selectRange(e,(0,o.createRange)(new o.Position(m,0)))}return{type:1,ranges:f,table:t,areAllCollapsed:f.filter((function(e){return null==e?void 0:e.collapsed})).length==f.length,coordinates:r,isWholeTableSelected:p}}return null};var i=function(e){var t=e.contentDiv.ownerDocument;(0,o.removeGlobalCssStyle)(t,a+e.contentDiv.id)};function l(e,t,r,n,o,a){return e+" #"+t+r+" tr:nth-child("+n+")>"+o+":nth-child("+a+")"}function s(e){e&&(0,o.removeImportantStyleRule)(e,["background-color","background"])}function c(e){return(!!e||0==e)&&e>-1}},3180:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setContent=void 0;var n=r(2347);t.setContent=function(e,t,r,o){var a,i,l=!1;if(e.contentDiv.innerHTML!=t){e.api.triggerEvent(e,{eventType:20,newContent:t},!0);var s=e.entity.entityMap,c=t||"",d=(new DOMParser).parseFromString(null!==(i=null===(a=e.trustedHTMLHandler)||void 0===a?void 0:a.call(e,c))&&void 0!==i?i:c,"text/html").body;(0,n.restoreContentWithEntityPlaceholder)(d,e.contentDiv,s);var u=(0,n.extractContentMetadata)(e.contentDiv);(function(e,t){if(!e.lifecycle.shadowEditFragment&&t)switch(e.domEvent.tableSelectionRange=null,e.domEvent.imageSelectionRange=null,e.domEvent.selectionRange=null,t.type){case 0:e.api.selectTable(e,null),e.api.selectImage(e,null);var r=(0,n.createRange)(e.contentDiv,t.start,t.end);e.api.selectRange(e,r);break;case 1:var o=(0,n.queryElements)(e.contentDiv,"#"+t.tableId)[0];o&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,o,t));break;case 2:var a=(0,n.queryElements)(e.contentDiv,"#"+t.imageId)[0];a&&(e.domEvent.imageSelectionRange=e.api.selectImage(e,a))}})(e,o=o||u),l=!0}var f=e.lifecycle.isDarkMode;(!o&&f||o&&!!o.isDarkMode!=!!f)&&(e.api.transformColor(e,e.contentDiv,!1,null,f?0:1,!0,null==o?void 0:o.isDarkMode),l=!0),r&&l&&e.api.triggerEvent(e,{eventType:7,source:"SetContent"},!1)}},8592:(e,t)=>{"use strict";function r(e,t,o){o&&n(e)&&t(e);for(var a=e.firstChild;a;a=a.nextSibling)n(a)&&t(a),r(a,t)}function n(e){var t=e;return e.nodeType==Node.ELEMENT_NODE&&!!t.style}Object.defineProperty(t,"__esModule",{value:!0}),t.transformColor=void 0,t.transformColor=function(e,t,n,o,a,i,l){void 0===l&&(l=!1);var s=e.darkColorHandler,c=e.lifecycle.onExternalContentTransform,d=0==a;t&&(i||e.lifecycle.isDarkMode)&&r(t,c?function(e){c(e,l,d,s)}:function(e){s.transformElementColor(e,l,d)},n),null==o||o()}},7622:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=void 0;var r=[11,12,8,21];t.triggerEvent=function(e,t,n){e.lifecycle.shadowEditFragment&&!(r.indexOf(t.eventType)>=0)||!n&&e.plugins.some((function(e){return function(e,t){var r;return!(!t.onPluginEvent||!(null===(r=t.willHandleEventExclusively)||void 0===r?void 0:r.call(t,e)))&&(t.onPluginEvent(e),!0)}(t,e)}))||e.plugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))}},9898:(e,t)=>{"use strict";function r(e,t,r){for(var n=0,o=function(){return r.getElementById(t+n)},a=o();a;)n++,a=o();e.id=t+n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.ownerDocument;e.id?n.querySelectorAll("#"+e.id).length>1&&(e.removeAttribute("id"),r(e,t,n)):r(e,t,n)}},5968:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditPlugin=void 0;var n=r(2347),o=function(){function e(){this.editor=null,this.state={features:{}}}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){var t,r=!1,o=null,a=!1,i=0==e.eventType;if(i){var l=e.rawEvent,s=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();r=(a=(0,n.isCtrlOrMetaPressed)(l))||l.altKey,o=this.state.features[l.which]||s&&!s.collapsed&&this.state.features[258]}else 7==e.eventType&&(o=this.state.features[257]);for(var c=0;o&&c<(null==o?void 0:o.length);c++){var d=o[c];if((d.allowFunctionKeys||!r)&&this.editor&&d.shouldHandleEvent(e,this.editor,a)){d.handleEvent(e,this.editor),i&&(e.handledByEditFeature=!0);break}}},e}();t.createEditPlugin=function(){return new o}},7145:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEntityPlugin=void 0;var n=r(5430),o=r(2347),a=/_(\d{1,8})$/,i=["^_Entity$","^_EId_","^_EType_","^_EReadonly_"],l=[6,7,4,5],s=function(){function e(){var e=this;this.editor=null,this.handleCutEvent=function(t){var r,n=null===(r=e.editor)||void 0===r?void 0:r.getSelectionRange();n&&!n.collapsed&&e.checkRemoveEntityForRange(t)},this.state={entityMap:{}}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.state.entityMap={}},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 6:this.handleMouseUpEvent(e);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:e.isCut&&this.handleCutEvent(e.rawEvent);break;case 10:this.handleBeforePasteEvent(e.sanitizingOption);break;case 7:this.handleContentChangedEvent(e);break;case 11:this.handleContentChangedEvent();break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot);break;case 16:this.handleContextMenuEvent(e.rawEvent);break;case 15:this.handleEntityOperationEvent(e)}this.editor&&(0,n.inlineEntityOnPluginEvent)(e,this.editor)},e.prototype.handleContextMenuEvent=function(e){var t,r=e.target,n=r&&(null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor((0,o.getEntitySelector)(),r));n&&(e.preventDefault(),this.triggerEvent(n,2,e))},e.prototype.handleMouseUpEvent=function(e){var t,r=e.rawEvent,n=e.isClicking,a=r.target;this.editor&&n&&a&&(t=this.editor.getElementAtCursor((0,o.getEntitySelector)(),a))&&(this.triggerEvent(t,1,r),c(this.editor))},e.prototype.handleKeyDownEvent=function(e){var t;if((0,o.isCharacterValue)(e)||8==e.which||46==e.which||13==e.which){var r=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();r&&!r.collapsed&&this.checkRemoveEntityForRange(e)}},e.prototype.handleBeforePasteEvent=function(e){var t,r=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();r&&!r.collapsed&&this.checkRemoveEntityForRange(null),e.additionalAllowedCssClasses&&(0,o.arrayPush)(e.additionalAllowedCssClasses,i)},e.prototype.handleContentChangedEvent=function(e){var t=this,r=!1;(0,o.getObjectKeys)(this.state.entityMap).forEach((function(e){var n=t.state.entityMap[e],a=n.element;!t.editor||n.isDeleted||t.editor.contains(a)||(n.isDeleted=!0,t.triggerEvent(a,6),r||a.isContentEditable||(0,o.isBlockElement)(a)||(r=!0))})),("InsertEntity"==(null==e?void 0:e.source)&&e.data?[e.data]:this.getExistingEntities().filter((function(e){var r=t.state.entityMap[e.id];return!r||r.element!=e.wrapper||r.isDeleted}))).forEach((function(e){var r=e.wrapper,n=e.type,a=e.id,i=e.isReadonly;e.id=t.ensureUniqueId(n,a,r),(0,o.commitEntity)(r,n,i,e.id),t.handleNewEntity(e)})),r&&this.editor&&(0,n.normalizeDelimitersInEditor)(this.editor)},e.prototype.handleEntityOperationEvent=function(e){if(this.editor&&l.indexOf(e.operation)>=0){var t=this.state.entityMap[e.entity.id];t&&(t.isDeleted=!0)}},e.prototype.handleExtractContentWithDomEvent=function(e){var t=this;(0,o.toArray)(e.querySelectorAll((0,o.getEntitySelector)())).forEach((function(e){e.removeAttribute("contentEditable"),t.triggerEvent(e,8)}))},e.prototype.checkRemoveEntityForRange=function(e){var t,r=this,n=[],a=(0,o.getEntitySelector)();if(null===(t=this.editor)||void 0===t||t.queryElements(a,1,(function(t){t.isContentEditable?n.push(t):r.triggerEvent(t,6,e)})),this.editor&&n.length>0){var i=this.editor.queryElements(a,2);n.forEach((function(t){var n=i.indexOf(t)>=0;r.triggerEvent(t,n?6:7,e)}))}},e.prototype.triggerEvent=function(e,t,r){var n,a=e&&(0,o.getEntityFromElement)(e);return a?null===(n=this.editor)||void 0===n?void 0:n.triggerPluginEvent(15,{operation:t,rawEvent:r,entity:a}):null},e.prototype.handleNewEntity=function(e){var t=e.wrapper,r=this.triggerEvent(t,0),n={element:e.wrapper};(null==r?void 0:r.shouldPersist)&&(n.canPersist=!0),this.state.entityMap[e.id]=n},e.prototype.getExistingEntities=function(){var e,t;return null!==(t=null===(e=this.editor)||void 0===e?void 0:e.queryElements((0,o.getEntitySelector)()).map(o.getEntityFromElement).filter((function(e){return!!e})))&&void 0!==t?t:[]},e.prototype.ensureUniqueId=function(e,t,r){for(var n=a.exec(t),o=(n?t.substr(0,t.length-n[0].length):t)||e,i="",l=n&&parseInt(n[1])||0;;l++){i=l>0?o+"_"+l:o;var s=this.state.entityMap[i];if(!s||s.element==r)break}return i},e}(),c=o.Browser.isIE?function(e){e.runAsync((function(e){var t=e.getCustomData("ENTITY_IE_FOCUS_BUTTON",(function(){var t=(0,o.createElement)({tag:"button",style:"overflow:hidden;position:fixed;width:0;height:0;top:-1000px"},e.getDocument());return t.onblur=function(){t.style.display="none"},e.insertNode(t,{position:4}),t}));t.style.display="",(0,o.addRangeToSelection)((0,o.createRange)(t,0))}))}:function(){};t.createEntityPlugin=function(){return new s}},1610:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createImageSelection=void 0;var n=r(2347),o=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"ImageSelection"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e;null===(e=this.editor)||void 0===e||e.select(null),this.editor=null},e.prototype.onPluginEvent=function(e){var t,r;if(this.editor)switch(e.eventType){case 6:var o=e.rawEvent.target;(0,n.safeInstanceOf)(o,"HTMLImageElement")&&o.isContentEditable&&1!=e.rawEvent.button&&this.editor.select(o);break;case 5:var a=e.rawEvent.target,i=this.editor.getSelectionRangeEx();i&&2===i.type&&i.image!==a&&this.editor.select(null);break;case 0:var l=e.rawEvent,s=l.key,c=this.editor.getSelectionRangeEx();if(!(l.ctrlKey||l.altKey||l.shiftKey||l.metaKey||2!==c.type)){var d=null===(t=c.image)||void 0===t?void 0:t.parentNode;"Escape"===s&&d?(this.editor.select(c.image,-2),null===(r=this.editor.getSelectionRange())||void 0===r||r.collapse(),e.rawEvent.stopPropagation()):"Delete"===s?(this.editor.deleteNode(c.image),e.rawEvent.preventDefault()):d&&this.editor.select(c.image,-2)}break;case 16:var u=e.rawEvent.target,f=this.editor.getSelectionRangeEx();!(0,n.safeInstanceOf)(u,"HTMLImageElement")||2===f.type&&f.image===u||this.editor.select(u)}},e}();t.createImageSelection=function(){return new o}},7404:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNormalizeTablePlugin=void 0;var n=r(2347),o=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"NormalizeTable"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 11:case 7:this.editor&&this.normalizeTables(this.editor.queryElements("table"));break;case 10:this.normalizeTables((0,n.toArray)(e.fragment.querySelectorAll("table")));break;case 5:this.normalizeTableFromEvent(e.rawEvent);break;case 0:e.rawEvent.shiftKey&&this.normalizeTableFromEvent(e.rawEvent);break;case 8:t=e.clonedRoot,(0,n.toArray)(t.querySelectorAll("li")).forEach((function(e){var t=e.previousSibling;"block"==e.style.display&&(0,n.safeInstanceOf)(t,"HTMLLIElement")&&(e.style.removeProperty("display"),t.appendChild((0,n.changeElementTag)(e,"div")))}))}var t},e.prototype.normalizeTableFromEvent=function(e){var t,r=null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor("table",e.target);r&&this.normalizeTables([r])},e.prototype.normalizeTables=function(e){if(this.editor&&e.length>0){var t=this.editor.getSelectionRangeEx(),r=0==(null==t?void 0:t.type)&&t.ranges[0]||{},o=r.startContainer,a=r.endContainer,i=r.startOffset,l=r.endOffset,s=function(e){var t=!1;return e.forEach((function(e){for(var r,o=null,a=e.firstChild;a;a=a.nextSibling)switch((0,n.getTagOfNode)(a)){case"TR":o||(o=e.ownerDocument.createElement("tbody"),e.insertBefore(o,a)),o.appendChild(a),a=o,t=!0;break;case"TBODY":o?((0,n.moveChildNodes)(o,a,!0),null===(r=a.parentNode)||void 0===r||r.removeChild(a),a=o,t=!0):o=a;break;default:o=null}var i=e.querySelectorAll("colgroup"),l=e.querySelector("thead");l&&i.forEach((function(e){l.contains(e)||l.appendChild(e)}))})),t}(e);s&&(o&&a&&"number"==typeof i&&"number"==typeof l?this.editor.select(o,i,a,l):1==(null==t?void 0:t.type)&&t.coordinates&&this.editor.select(t.table,t.coordinates))}},e}();t.createNormalizeTablePlugin=function(){return new o}},1730:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createUndoPlugin=void 0;var n=r(2347),o=function(){function e(e){var t;this.editor=null,this.lastKeyPress=null,this.state={snapshotsService:e.undoMetadataSnapshotService||(t=(0,n.createSnapshots)(1e7),{canMove:function(e){return(0,n.canMoveCurrentSnapshot)(t,e)},move:function(e){return(0,n.moveCurrentSnapshot)(t,e)},addSnapshot:function(e,r){return(0,n.addSnapshotV2)(t,e,r)},clearRedo:function(){return(0,n.clearProceedingSnapshotsV2)(t)},canUndoAutoComplete:function(){return(0,n.canUndoAutoComplete)(t)}}),isRestoring:!1,hasNewContent:!1,isNested:!1,autoCompletePosition:null}}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.willHandleEventExclusively=function(e){return 0==e.eventType&&8==e.rawEvent.which&&!e.rawEvent.ctrlKey&&this.canUndoAutoComplete()},e.prototype.onPluginEvent=function(e){if(this.editor&&!this.editor.isInIME())switch(e.eventType){case 11:var t=this.editor.getUndoState();t.canUndo||t.canRedo||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 4:this.clearRedoForInput(),this.addUndoSnapshot();break;case 7:this.onContentChanged(e);break;case 23:this.onBeforeKeyboardEditing(e.rawEvent)}},e.prototype.onKeyDown=function(e){var t,r;if(8==e.which&&!e.altKey||46==e.which){if(8==e.which&&!e.ctrlKey&&this.canUndoAutoComplete())e.preventDefault(),null===(t=this.editor)||void 0===t||t.undo(),this.state.autoCompletePosition=null,this.lastKeyPress=e.which;else if(!e.defaultPrevented){var o=null===(r=this.editor)||void 0===r?void 0:r.getSelectionRange();!o||o.collapsed&&this.lastKeyPress==e.which&&!(0,n.isCtrlOrMetaPressed)(e)||this.addUndoSnapshot(),this.state.hasNewContent=!0,this.lastKeyPress=e.which}}else e.which>=33&&e.which<=40?(this.state.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0):8!=this.lastKeyPress&&46!=this.lastKeyPress||this.state.hasNewContent&&this.addUndoSnapshot()},e.prototype.onKeyPress=function(e){var t;if(!e.metaKey){var r=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();r&&!r.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.state.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.onBeforeKeyboardEditing=function(e){e.which!=this.lastKeyPress&&this.addUndoSnapshot(),this.lastKeyPress=e.which,this.state.hasNewContent=!0},e.prototype.onContentChanged=function(e){this.state.isRestoring||"SwitchToDarkMode"==e.source||"SwitchToLightMode"==e.source||"Keyboard"==e.source||this.clearRedoForInput()},e.prototype.clearRedoForInput=function(){this.state.snapshotsService.clearRedo(),this.lastKeyPress=0,this.state.hasNewContent=!0},e.prototype.canUndoAutoComplete=function(){var e,t,r=null===(e=this.editor)||void 0===e?void 0:e.getFocusedPosition();return this.state.snapshotsService.canUndoAutoComplete()&&!!r&&!!(null===(t=this.state.autoCompletePosition)||void 0===t?void 0:t.equalTo(r))},e.prototype.addUndoSnapshot=function(){var e;null===(e=this.editor)||void 0===e||e.addUndoSnapshot(),this.state.autoCompletePosition=null},e}();t.createUndoPlugin=function(e){return new o(e)}},8785:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPluginState=t.createCorePlugins=void 0;var n=r(5968),o=r(7145),a=r(1610),i=r(7404),l=r(1730);t.createCorePlugins=function(e){var t=e.corePluginOverride||{};return{edit:t.edit||(0,n.createEditPlugin)(),undo:t.undo||(0,l.createUndoPlugin)(e),entity:t.entity||(0,o.createEntityPlugin)(),imageSelection:t.imageSelection||(0,a.createImageSelection)(),normalizeTable:t.normalizeTable||(0,i.createNormalizeTablePlugin)()}},t.getPluginState=function(e){return{edit:e.edit.getState(),undo:e.undo.getState(),entity:e.entity.getState()}}},5430:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeDelimitersInEditor=t.inlineEntityOnPluginEvent=void 0;var n=r(2347),o=".entityDelimiterAfter,.entityDelimiterBefore",a="​",i="span"+(0,n.getEntitySelector)();function l(e){var t,r,o,i;e.normalize();var l,s=e.firstChild,c=null!==(r=null===(t=s.nodeValue)||void 0===t?void 0:t.indexOf(a))&&void 0!==r?r:-1;if(c>=0&&((0,n.splitTextNode)(s,0==c?1:c,!1),e.childNodes.forEach((function(e){e.nodeValue!==a&&(l=e)})),l)){null===(o=e.parentElement)||void 0===o||o.insertBefore(l,"entityDelimiterBefore"==e.className?e:e.nextSibling);var d=null===(i=l.ownerDocument)||void 0===i?void 0:i.getSelection();d&&d.setPosition(l,new n.Position(l,-1).offset)}}function s(e){e.queryElements(o).forEach((function(e){if((0,n.getDelimiterFromElement)(e)){var t=e.classList.contains("entityDelimiterBefore")?e.nextElementSibling:e.previousElementSibling;(0,n.safeInstanceOf)(t,"HTMLElement")&&(0,n.getEntityFromElement)(t)||u(e)}else f(e)})),c(e.queryElements(i))}function c(e){e.forEach((function(e){d(e)&&(0,n.addDelimiters)(e)}))}function d(e){return!!(e&&(0,n.safeInstanceOf)(e,"HTMLElement")&&(t=(0,n.getEntityFromElement)(e),(null==t?void 0:t.isReadonly)&&!(0,n.isBlockElement)(t.wrapper)&&(0,n.safeInstanceOf)(t.wrapper,"HTMLElement")));var t}function u(e){var t;null===(t=null==e?void 0:e.parentElement)||void 0===t||t.removeChild(e)}function f(e,t){if(void 0===t&&(t=!0),e){var r=e.classList.contains("entityDelimiterAfter")?e.previousElementSibling:e.nextElementSibling;t&&r&&d(r)||(e.classList.remove("entityDelimiterAfter","entityDelimiterBefore"),e.normalize(),e.childNodes.forEach((function(e){var t,r,o,i=null!==(r=null===(t=e.textContent)||void 0===t?void 0:t.indexOf(a))&&void 0!==r?r:-1;i>=0&&(null===(o=(0,n.createRange)(e,i,e,i+1))||void 0===o||o.deleteContents())})))}}t.inlineEntityOnPluginEvent=function(e,t){switch(e.eventType){case 7:"SetContent"===e.source&&s(t);break;case 11:s(t);break;case 10:var r=e.fragment,a=e.sanitizingOption;c(r.querySelectorAll(i)),a.additionalAllowedCssClasses&&(0,n.arrayPush)(a.additionalAllowedCssClasses,["entityDelimiterAfter","entityDelimiterBefore"]);break;case 8:case 9:e.clonedRoot.querySelectorAll(o).forEach((function(e){(0,n.getDelimiterFromElement)(e)?u(e):f(e)}));break;case 0:!function(e,t){var r,a,i=e.getSelectionRangeEx(),s=t.rawEvent;if(0==i.type)if(i.areAllCollapsed&&((0,n.isCharacterValue)(s)||13===s.which)){var c=null===(r=e.getFocusedPosition())||void 0===r?void 0:r.normalize();if(!c)return;var u=c.element,m=u==c.node?u.childNodes.item(c.offset):u,v=e.getElementAtCursor(o,m);if(!v)return;13===s.which?function(e,t){var r=t.classList.contains("entityDelimiterAfter"),a=r?t.previousSibling:t.nextSibling,i=function(e,t){var r;if(t){for(var o=null===(r=e.getBlockElementAtNode(t))||void 0===r?void 0:r.getStartNode();o&&!(0,n.isBlockElement)(o);)o=e.contains(o.parentElement)?o.parentElement:void 0;return o}}(e,t);e.runAsync((function(){if(i){var e=r?i.nextSibling:i.previousSibling;if(e&&(0,n.safeInstanceOf)(e,"HTMLElement")){var t=e.querySelectorAll(o);f(t.item(r?0:t.length-1))}d(a)&&([a.nextElementSibling,a.previousElementSibling].forEach((function(e){e&&(0,n.matchesSelector)(e,o)&&!(0,n.getDelimiterFromElement)(e)&&f(e,!1)})),(0,n.addDelimiters)(a))}}))}(e,v):3==(null===(a=v.firstChild)||void 0===a?void 0:a.nodeType)&&e.runAsync((function(){return l(v)}))}else if(!i.areAllCollapsed&&!s.shiftKey&&16!=s.which){var g=i.ranges[0];if(!g)return;!function(e,t,r){var a=t.startContainer,i=t.endContainer,s=t.startOffset,c=t.endOffset,d=e.getElementAtCursor(o,a),u=e.getElementAtCursor(o,i),m=p(d),v=p(u);(m||v)&&e.select(null!=m?m:new n.Position(a,s),null!=v?v:new n.Position(i,c)),e.runAsync((function(e){var t=e.getElementAtCursor(o);t&&(l(t),13===r.which&&f(t))}))}(e,g,s)}}(t,e)}},t.normalizeDelimitersInEditor=s;var p=function(e){if(e&&(0,n.getDelimiterFromElement)(e)){var t=e.classList.contains("entityDelimiterAfter");return new n.Position(e,t?-3:-2)}}},6593:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentModelEditor=void 0;var n=r(7582),o=r(2114),a=r(1246),i=r(866),l=r(79),s=r(2347),c=function(){function e(e,t){var r=this;void 0===t&&(t={}),this.core=null,this.core=(0,o.createEditorCore)(e,t),this.core.plugins.forEach((function(e){return e.initialize(r)}))}return e.prototype.createContentModel=function(e,t){var r=this.getCore();return r.api.createContentModel(r,e,t)},e.prototype.setContentModel=function(e,t,r){var n=this.getCore();return n.api.setContentModel(n,e,t,r)},e.prototype.getEnvironment=function(){return this.getCore().environment},e.prototype.getDOMSelection=function(){var e=this.getCore();return e.api.getDOMSelection(e)},e.prototype.setDOMSelection=function(e){var t=this.getCore();t.api.setDOMSelection(t,e)},e.prototype.formatContentModel=function(e,t){var r=this.getCore();r.api.formatContentModel(r,e,t)},e.prototype.getPendingFormat=function(){var e,t;return null!==(t=null===(e=this.getCore().format.pendingFormat)||void 0===e?void 0:e.format)&&void 0!==t?t:null},e.prototype.dispose=function(){for(var e,t=this.getCore(),r=t.plugins.length-1;r>=0;r--){var n=t.plugins[r];try{n.dispose()}catch(r){null===(e=t.disposeErrorHandler)||void 0===e||e.call(t,n,r)}}(0,a.getObjectKeys)(t.customData).forEach((function(e){var r=t.customData[e];r&&r.disposer&&r.disposer(r.value),delete t.customData[e]})),t.darkColorHandler.reset(),this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){var r=this.getCore();return!!e&&r.api.insertNode(r,e,null!=t?t:null)},e.prototype.deleteNode=function(e){return!!(e&&this.contains(e)&&e.parentNode)&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t,r){var n=this.getCore();return!(!this.contains(e)||!t||(n.api.transformColor(n,r?t:null,!0,(function(){var r;return null===(r=e.parentNode)||void 0===r?void 0:r.replaceChild(t,e)}),0),0))},e.prototype.getBlockElementAtNode=function(e){return(0,s.getBlockElementAtNode)(this.getCore().contentDiv,e)},e.prototype.contains=function(e){return!!e&&(0,s.contains)(this.getCore().contentDiv,e)},e.prototype.queryElements=function(e,t,r){void 0===t&&(t=0);var o=this.getCore(),a=[],i=t instanceof Function?0:t;r=t instanceof Function?t:r;var l=0==i?null:this.getSelectionRangeEx();return l?(l.ranges.forEach((function(t){a.push.apply(a,(0,n.__spreadArray)([],(0,n.__read)((0,s.queryElements)(o.contentDiv,e,r,i,t)),!1))})),a):(0,s.queryElements)(o.contentDiv,e,r,i,void 0)},e.prototype.collapseNodes=function(e,t,r){return(0,s.collapseNodes)(this.getCore().contentDiv,e,t,r)},e.prototype.isEmpty=function(e){return(0,s.isNodeEmpty)(this.getCore().contentDiv,e)},e.prototype.getContent=function(e){void 0===e&&(e=0);var t=this.getCore();return t.api.getContent(t,e)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0);var r=this.getCore();r.api.setContent(r,e,t)},e.prototype.insertContent=function(e,t){var r;if(e){var n=this.getDocument(),o=null===(r=(new DOMParser).parseFromString(this.getCore().trustedHTMLHandler(e),"text/html"))||void 0===r?void 0:r.body,a=(null==o?void 0:o.childNodes)?(0,s.toArray)(o.childNodes):[];t&&t.insertOnNewLine&&a.length>1&&(a=[(0,s.wrap)(a)]);var i=n.createDocumentFragment();a.forEach((function(e){return i.appendChild(e)})),this.insertNode(i,t)}},e.prototype.deleteSelectedContent=function(){var e=this.getSelectionRange();return e&&!e.collapsed?(0,s.deleteSelectedContent)(this.getCore().contentDiv,e):null},e.prototype.paste=function(e,t,r,n){void 0===t&&(t=!1),void 0===r&&(r=!1),void 0===n&&(n=!1),(0,l.paste)(this,e,t?"asPlainText":r?"mergeFormat":n?"asImage":"normal")},e.prototype.getSelectionRange=function(e){void 0===e&&(e=!0);var t=this.getCore();return t.api.getSelectionRange(t,e)},e.prototype.getSelectionRangeEx=function(){var e=this.getCore();return e.api.getSelectionRangeEx(e)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&(0,s.getSelectionPath)(this.getCore().contentDiv,e)},e.prototype.hasFocus=function(){var e=this.getCore();return e.api.hasFocus(e)},e.prototype.focus=function(){var e=this.getCore();e.api.focus(e)},e.prototype.select=function(e,t,r,n){var o=this.getCore();return o.api.select(o,e,t,r,n)},e.prototype.getFocusedPosition=function(){var e,t=null===(e=this.getDocument().defaultView)||void 0===e?void 0:e.getSelection();if((null==t?void 0:t.focusNode)&&this.contains(t.focusNode))return new s.Position(t.focusNode,t.focusOffset);var r=this.getSelectionRange();return r?s.Position.getStart(r):null},e.prototype.getElementAtCursor=function(e,t,r){var n,o=this;return r=t?void 0:r,null!==(n=(0,s.cacheGetEventData)(null!=r?r:null,"GET_ELEMENT_AT_CURSOR_"+e,(function(){if(!t){var r=o.getFocusedPosition();t=null==r?void 0:r.node}return t&&(0,s.findClosestElementAncestor)(t,o.getCore().contentDiv,e)})))&&void 0!==n?n:null},e.prototype.isPositionAtBeginning=function(e){return(0,s.isPositionAtBeginningOf)(e,this.getCore().contentDiv)},e.prototype.getSelectedRegions=function(e){void 0===e&&(e=0);var t=this.getSelectionRangeEx(),r=[],o=this.getCore().contentDiv;return t.ranges.forEach((function(t){r.push.apply(r,(0,n.__spreadArray)([],(0,n.__read)(t?(0,s.getRegionsFromRange)(o,t,e):[]),!1))})),r.filter((function(e,t,r){return r.indexOf(e)===t}))},e.prototype.addDomEventHandler=function(e,t){var r,n="string"==typeof e?((r={})[e]=t,r):e,o=this.getCore();return o.api.attachDomEvent(o,n)},e.prototype.triggerPluginEvent=function(e,t,r){void 0===r&&(r=!1);var o=this.getCore(),a=(0,n.__assign)({eventType:e},t);return o.api.triggerEvent(o,a,r),a},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerPluginEvent(7,{source:e,data:t})},e.prototype.undo=function(){this.focus();var e=this.getCore();e.api.restoreUndoSnapshot(e,-1)},e.prototype.redo=function(){this.focus();var e=this.getCore();e.api.restoreUndoSnapshot(e,1)},e.prototype.addUndoSnapshot=function(e,t,r,n){var o=this.getCore();o.api.addUndoSnapshot(o,null!=e?e:null,null!=t?t:null,null!=r&&r,n)},e.prototype.getUndoState=function(){var e=this.getCore().undo,t=e.hasNewContent,r=e.snapshotsService;return{canUndo:t||r.canMove(-1),canRedo:r.canMove(1)}},e.prototype.getDocument=function(){return this.getCore().contentDiv.ownerDocument},e.prototype.getScrollContainer=function(){return this.getCore().domEvent.scrollContainer},e.prototype.getCustomData=function(e,t,r){var n=this.getCore();return(n.customData[e]=n.customData[e]||{value:t?t():void 0,disposer:r}).value},e.prototype.isInIME=function(){return this.getCore().domEvent.isInIME},e.prototype.getDefaultFormat=function(){var e=this.getCore().format.defaultFormat;return{bold:(0,l.isBold)(e.fontWeight),italic:e.italic,underline:e.underline,fontFamily:e.fontFamily,fontSize:e.fontSize,textColor:e.textColor,backgroundColor:e.backgroundColor}},e.prototype.getBodyTraverser=function(e){return s.ContentTraverser.createBodyTraverser(this.getCore().contentDiv,e)},e.prototype.getSelectionTraverser=function(e){var t;return(e=null!==(t=null!=e?e:this.getSelectionRange())&&void 0!==t?t:void 0)?s.ContentTraverser.createSelectionTraverser(this.getCore().contentDiv,e):null},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t?s.ContentTraverser.createBlockTraverser(this.getCore().contentDiv,t,e):null},e.prototype.getContentSearcherOfCursor=function(e){var t=this;return(0,s.cacheGetEventData)(null!=e?e:null,"ContentSearcher",(function(){var e=t.getSelectionRange();return e&&new s.PositionContentSearcher(t.getCore().contentDiv,s.Position.getStart(e))}))},e.prototype.runAsync=function(e){var t=this,r=this.getCore().contentDiv.ownerDocument.defaultView||window,n=r.requestAnimationFrame((function(){!t.isDisposed()&&e&&e(t)}));return function(){r.cancelAnimationFrame(n)}},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.getCore().contentDiv.removeAttribute(e):this.getCore().contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.getCore().contentDiv.getAttribute(e)},e.prototype.getRelativeDistanceToEditor=function(e,t){if(this.contains(e)){var r=this.getCore().contentDiv,n=r.getBoundingClientRect(),o=e.getBoundingClientRect();if(n&&o){var a=o.left-(null==n?void 0:n.left),i=o.top-(null==n?void 0:n.top);return t&&(a+=r.scrollLeft,i+=r.scrollTop),[a,i]}}return null},e.prototype.addContentEditFeature=function(e){var t=this.getCore();null==e||e.keys.forEach((function(r){var n=t.edit.features[r]||[];n.push(e),t.edit.features[r]=n}))},e.prototype.removeContentEditFeature=function(e){var t=this.getCore();null==e||e.keys.forEach((function(r){var n,o=t.edit.features[r],a=null!==(n=null==o?void 0:o.indexOf(e))&&void 0!==n?n:-1;a>=0&&(t.edit.features[r].splice(a,1),t.edit.features[r].length<1&&delete t.edit.features[r])}))},e.prototype.getStyleBasedFormatState=function(e){var t;if(!e){var r=this.getSelectionRange();e=null!==(t=r&&s.Position.getStart(r).normalize().node)&&void 0!==t?t:void 0}var n=this.getCore();return n.api.getStyleBasedFormatState(n,null!=e?e:null)},e.prototype.getPendableFormatState=function(e){void 0===e&&(e=!1);var t=this.getCore();return(0,i.getPendableFormatState)(t)},e.prototype.ensureTypeInContainer=function(e,t){var r=this.getCore();r.api.ensureTypeInContainer(r,e,t)},e.prototype.setDarkModeState=function(e){var t=this.isDarkMode();if(t!=!!e){var r=this.getCore();r.api.transformColor(r,r.contentDiv,!1,null,e?0:1,!0,t),this.triggerContentChangedEvent(e?"SwitchToDarkMode":"SwitchToLightMode")}},e.prototype.isDarkMode=function(){return this.getCore().lifecycle.isDarkMode},e.prototype.transformToDarkColor=function(e,t){void 0===t&&(t=0);var r=this.getCore();r.api.transformColor(r,e,!0,null,t)},e.prototype.getDarkColorHandler=function(){return this.getCore().darkColorHandler},e.prototype.startShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!0)},e.prototype.stopShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!1)},e.prototype.isInShadowEdit=function(){return!!this.getCore().lifecycle.shadowEditFragment},e.prototype.isFeatureEnabled=function(e){return this.getCore().experimentalFeatures.indexOf(e)>=0},e.prototype.getTrustedHTMLHandler=function(){return this.getCore().trustedHTMLHandler},e.prototype.getSizeTransformer=function(){return this.getCore().sizeTransformer},e.prototype.getZoomScale=function(){return this.getCore().zoomScale},e.prototype.setZoomScale=function(e){var t=this.getCore();if(e>0&&e<=10){var r=t.zoomScale;t.zoomScale=e,r!=e&&this.triggerPluginEvent(21,{oldZoomScale:r,newZoomScale:e},!0)}},e.prototype.getVisibleViewport=function(){var e=this.getCore();return e.api.getVisibleViewport(e)},e.prototype.getCore=function(){if(!this.core)throw new Error("Editor is already disposed");return this.core},e}();t.ContentModelEditor=c},2114:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditorCore=void 0;var n=r(7582),o=r(2388),a=r(8785),i=r(79);t.createEditorCore=function(e,t){var r,l,s,c,d=(0,a.createCorePlugins)(t),u=(0,a.getPluginState)(d),f=(0,n.__spreadArray)((0,n.__spreadArray)([d.edit],(0,n.__read)(null!==(r=t.plugins)&&void 0!==r?r:[]),!1),[d.undo,d.entity,d.imageSelection,d.normalizeTable],!1).filter((function(e){return!!e})),p=(null!==(l=t.zoomScale)&&void 0!==l?l:-1)>0?t.zoomScale:1,m=null!==(s=t.initialContent)&&void 0!==s?s:e.innerHTML;m&&!t.initialModel&&(t.initialModel=(0,i.createModelFromHtml)(m,t.defaultDomToModelOptions,t.trustedHTMLHandler));var v=(0,i.createStandaloneEditorCore)(e,t,o.coreApiMap,u,f);return(0,n.__assign)((0,n.__assign)((0,n.__assign)({},v),u),{zoomScale:p,sizeTransformer:function(e){return e/p},disposeErrorHandler:t.disposeErrorHandler,customData:{},experimentalFeatures:null!==(c=t.experimentalFeatures)&&void 0!==c?c:[]})}},1053:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isContentModelEditor=void 0,t.isContentModelEditor=function(e){return!!e.createContentModel}},866:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPendableFormatState=void 0;var n=r(2347);t.getPendableFormatState=function(e){var t=e.api.getSelectionRange(e,!0),r=t&&n.Position.getStart(t).normalize();return r?function(e,t){for(var r=t.node,i={},l=[],s=function(){var e=(0,n.getTagOfNode)(r),t=1==r.nodeType&&r.style;e&&t&&(0,n.getObjectKeys)(o).forEach((function(r){l.indexOf(r)>=0||(i[r]=i[r]||o[r](e,t),a[r](t)&&l.push(r))})),r=r.parentNode};r&&(0,n.contains)(e.contentDiv,r);)s();return i}(e,r):{}};var o={isBold:function(e,t){return"B"==e||"STRONG"==e||"H1"==e||"H2"==e||"H3"==e||"H4"==e||"H5"==e||"H6"==e||parseInt(t.fontWeight)>=700||["bold","bolder"].indexOf(t.fontWeight)>=0},isUnderline:function(e,t){return"U"==e||t.textDecoration.indexOf("underline")>=0},isItalic:function(e,t){return"I"==e||"EM"==e||"italic"===t.fontStyle},isSubscript:function(e,t){return"SUB"==e||"sub"===t.verticalAlign},isSuperscript:function(e,t){return"SUP"==e||"super"===t.verticalAlign},isStrikeThrough:function(e,t){return"S"==e||"STRIKE"==e||t.textDecoration.indexOf("line-through")>=0}},a={isBold:function(e){return""!==e.fontWeight&&parseInt(e.fontWeight)<700||"normal"===e.fontWeight},isUnderline:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("underline")<0},isItalic:function(e){return""!==e.fontStyle&&"italic"!==e.fontStyle},isSubscript:function(e){return""!==e.verticalAlign&&"sub"!==e.verticalAlign},isSuperscript:function(e){return""!==e.verticalAlign&&"super"!==e.verticalAlign},isStrikeThrough:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("line-through")<0}}},3247:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isContentModelEditor=t.ContentModelEditor=void 0;var n=r(6593);Object.defineProperty(t,"ContentModelEditor",{enumerable:!0,get:function(){return n.ContentModelEditor}});var o=r(1053);Object.defineProperty(t,"isContentModelEditor",{enumerable:!0,get:function(){return o.isContentModelEditor}})},8567:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentModelEditPlugin=void 0;var n=r(1144),o=r(122),a=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"ContentModelEdit"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){this.editor&&0===e.eventType&&this.handleKeyDownEvent(this.editor,e)},e.prototype.handleKeyDownEvent=function(e,t){var r=t.rawEvent;if(!r.defaultPrevented&&!t.handledByEditFeature)switch(r.key){case"Backspace":case"Delete":(0,n.keyboardDelete)(e,r);break;default:(0,o.keyboardInput)(e,r)}},e}();t.ContentModelEditPlugin=a},7091:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteAllSegmentBefore=void 0;var n=r(79);t.deleteAllSegmentBefore=function(e){for(var t=e.insertPoint,r=t.paragraph,o=t.marker,a=r.segments.indexOf(o)-1;a>=0;a--){var i=r.segments[a];i.isSelected=!0,(0,n.deleteSegment)(r,i,e.formatContext)&&(e.deleteResult="range")}}},3323:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.backwardDeleteCollapsedSelection=t.forwardDeleteCollapsedSelection=void 0;var n=r(79),o=r(1392),a=r(1246);function i(e){return function(t){var r,i="forward"==e,l=t.insertPoint,s=l.paragraph,c=l.marker,d=l.path,u=l.tableContext,f=s.segments;!function(e){var t,r;if("Br"==(null===(t=e[e.length-1])||void 0===t?void 0:t.segmentType)){var n=e.filter((function(e){return"SelectionMarker"!=e.segmentType}));"Br"!=(null===(r=n[n.length-2])||void 0===r?void 0:r.segmentType)&&e.pop()}}(f);var p,m=f.indexOf(c)+(i?1:-1),v=f[m];if(v)(0,n.deleteSegment)(s,v,t.formatContext,e)&&(t.deleteResult="singleChar",(0,a.setParagraphNotImplicit)(s));else if(p=(0,o.getLeafSiblingBlock)(d,s,i)){var g=p.block,h=p.path,b=p.siblingSegment;"Paragraph"==g.blockType?(b?(0,n.deleteSegment)(g,b,t.formatContext,e)&&(t.deleteResult="range"):(i?t.lastParagraph=g:("Br"==(null===(r=g.segments[g.segments.length-1])||void 0===r?void 0:r.segmentType)&&g.segments.pop(),t.insertPoint={marker:c,paragraph:g,path:h,tableContext:u},t.lastParagraph=s,delete g.cachedElement),t.deleteResult="range"),t.lastTableContext=u):(0,n.deleteBlock)(h[0].blocks,g,void 0,t.formatContext,e)&&(t.deleteResult="range")}else t.deleteResult="nothingToDelete"}}t.forwardDeleteCollapsedSelection=i("forward"),t.backwardDeleteCollapsedSelection=i("backward")},329:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.backwardDeleteWordSelection=t.forwardDeleteWordSelection=void 0;var n,o=r(7582),a=r(79),i=r(1246);function l(e){return function(t){for(var r=t.insertPoint,n=r.marker,l=r.paragraph,s=l.segments.indexOf(n),c="forward"==e,d=function(e,t,r,n){var l,s,c,d,u,f,p,m,v,g;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:l=r?1:-1,s=e.segments,c=(0,i.isWhiteSpacePreserved)(e),d=t+l,o.label=1;case 1:if(!(d>=0&&d<s.length))return[3,12];switch((u=s[d]).segmentType){case"Text":return[3,2];case"Image":return[3,7];case"SelectionMarker":return[3,9]}return[3,10];case 2:f=r?0:u.text.length-1,o.label=3;case 3:return f>=0&&f<u.text.length?(p=u.text[f],m=(0,a.isPunctuation)(p),v=(0,a.isSpace)(p),[4,{punctuation:m,space:v,text:!m&&!v}]):[3,6];case 4:if(o.sent()){if(g=(g=u.text).substring(0,f)+g.substring(f+1),c||(g=(0,a.normalizeText)(g,r)),n.deleteResult="range",!g)return s.splice(d,1),l>0&&(d-=l),[3,6];u.text=g,l>0&&(f-=l)}o.label=5;case 5:return f+=l,[3,3];case 6:return[3,11];case 7:return[4,{punctuation:!0,space:!1,text:!1}];case 8:return o.sent()&&(s.splice(d,1),l>0&&(d-=l),n.deleteResult="range"),[3,11];case 9:return[3,11];case 10:return[2,null];case 11:return d+=l,[3,1];case 12:return[2,null]}}))}(l,s,c,t),u=d.next(),f=0;5!=f&&!u.done;){var p=u.value,m=p.punctuation,v=p.space,g=p.text;switch(f){case 0:f=v?4:m?1:2,u=d.next(!0);break;case 1:c&&v?(f=3,u=d.next(!0)):m?u=d.next(!0):f=5;break;case 2:c&&v?(f=3,u=d.next(!0)):g?u=d.next(!0):f=5;break;case 3:m||!v?f=5:u=d.next(!0);break;case 4:v?u=d.next(!0):m?(f=c?3:1,u=d.next(!0)):f=c?5:2}}}}!function(e){e[e.Start=0]="Start",e[e.Punctuation=1]="Punctuation",e[e.Text=2]="Text",e[e.NonText=3]="NonText",e[e.Space=4]="Space",e[e.End=5]="End"}(n||(n={})),t.forwardDeleteWordSelection=l("forward"),t.backwardDeleteWordSelection=l("backward")},9798:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDeleteAllSegmentsBefore=t.shouldDeleteWord=t.handleKeyboardEventResult=void 0;var n=r(1246);t.handleKeyboardEventResult=function(e,t,r,o,a){switch(a.skipUndoSnapshot=!0,a.clearModelCache=!1,o){case"notDeleted":return a.clearModelCache=!0,!1;case"nothingToDelete":return r.preventDefault(),!1;case"range":case"singleChar":return r.preventDefault(),(0,n.normalizeContentModel)(t),"range"==o&&(a.skipUndoSnapshot=!1),e.triggerPluginEvent(23,{rawEvent:r}),!0}},t.shouldDeleteWord=function(e,t){return t&&e.altKey&&!e.metaKey||!t&&e.ctrlKey&&!e.altKey},t.shouldDeleteAllSegmentsBefore=function(e){return e.metaKey&&!e.altKey}},1144:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardDelete=void 0;var n=r(79),o=r(7091),a=r(1246),i=r(9798),l=r(329),s=r(3323);t.keyboardDelete=function(e,t){if(function(e,t){if(e){if("range"==e.type&&e.range.collapsed){var r=e.range;return!((0,a.isNodeOfType)(r.startContainer,"TEXT_NODE")&&!(0,n.isModifierKey)(t)&&(function(e,t){return"Backspace"==e.key&&t.startOffset>1}(t,r)||function(e,t){var r,n;return"Delete"==e.key&&t.startOffset<(null!==(n=null===(r=t.startContainer.nodeValue)||void 0===r?void 0:r.length)&&void 0!==n?n:0)-1}(t,r)))}return!0}return!1}(e.getDOMSelection(),t))return e.formatContentModel((function(r,a){var c=(0,n.deleteSelection)(r,function(e,t){var r="Delete"==e.key;return[(0,i.shouldDeleteAllSegmentsBefore)(e)&&!r?o.deleteAllSegmentBefore:null,(0,i.shouldDeleteWord)(e,t)?r?l.forwardDeleteWordSelection:l.backwardDeleteWordSelection:null,r?s.forwardDeleteCollapsedSelection:s.backwardDeleteCollapsedSelection]}(t,!!e.getEnvironment().isMac),a).deleteResult;return(0,i.handleKeyboardEventResult)(e,r,t,c,a)}),{rawEvent:t,changeSource:n.ChangeSource.Keyboard,getChangeData:function(){return t.which},apiName:"Delete"==t.key?"handleDeleteKey":"handleBackspaceKey"}),!0}},122:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardInput=void 0;var n=r(79);t.keyboardInput=function(e,t){if(function(e,t){return!(!e||(0,n.isModifierKey)(t)||"Enter"!=t.key&&"Space"!=t.key&&1!=t.key.length||"range"==e.type&&e.range.collapsed)}(e.getDOMSelection(),t))return e.addUndoSnapshot(),e.formatContentModel((function(e,t){var r=(0,n.deleteSelection)(e,[],t).deleteResult;return t.clearModelCache=!0,t.skipUndoSnapshot=!0,"range"==r}),{rawEvent:t}),!0}},1392:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLeafSiblingBlock=void 0;var n=r(7582),o=r(1246);t.getLeafSiblingBlock=function(e,t,r){for(var a,i=(0,n.__spreadArray)([],(0,n.__read)(e),!1),l=function(){var e=i[0],n=e.blocks.indexOf(t);if(n<0)return"break";var l=e.blocks[n+(r?1:-1)];if(l){for(;"BlockGroup"==l.blockType;){var s=l.blocks[r?0:l.blocks.length-1];if(!s)return{value:{block:l,path:i}};if("BlockGroup"!=s.blockType)return i.unshift(l),{value:{block:s,path:i}};i.unshift(l),l=s}return{value:{block:l,path:i}}}if((0,o.isGeneralSegment)(e)){i.shift();var c=-1,d=e,u=null===(a=i[0])||void 0===a?void 0:a.blocks.find((function(e){return"Paragraph"==e.blockType&&(c=e.segments.indexOf(d))>=0}));if(!u)return"break";var f=u.segments[c+(r?1:-1)];if(f)return{value:{block:u,path:i,siblingSegment:f}};t=u}else{if("Document"==e.blockGroupType||"TableCell"==e.blockGroupType)return"break";i.shift(),t=e}};i.length>0;){var s=l();if("object"==typeof s)return s.value;if("break"===s)break}return null}},6334:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentModelEditPlugin=t.ContentModelPastePlugin=void 0;var n=r(6300);Object.defineProperty(t,"ContentModelPastePlugin",{enumerable:!0,get:function(){return n.ContentModelPastePlugin}});var o=r(8567);Object.defineProperty(t,"ContentModelEditPlugin",{enumerable:!0,get:function(){return o.ContentModelEditPlugin}})},6300:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ContentModelPastePlugin=void 0;var o=r(2158),a=r(1246),i=r(2347),l=r(7074),s=r(2819),c=r(5703),d=r(8536),u=r(1466),f=r(8807),p=r(8633),m=((n={})[3]="asImage",n[1]="asPlainText",n[2]="mergeFormat",n[0]="normal",n),v=function(){function e(e){void 0===e&&(e="SPAN"),this.unknownTagReplacement=e,this.editor=null}return e.prototype.getName=function(){return"ContentModelPaste"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor&&10==e.eventType){var t=e;if(t.domToModelOption){var r,n=(0,s.getPasteSource)(t,!1),a=m[t.pasteType];switch(n){case"wordDesktop":(0,f.processPastedContentFromWordDesktop)(t);break;case"wacComponents":(0,p.processPastedContentWacComponents)(t);break;case"excelOnline":case"excelDesktop":"normal"!==a&&"mergeFormat"!==a||(0,d.processPastedContentFromExcel)(t,this.editor.getTrustedHTMLHandler());break;case"googleSheets":t.sanitizingOption.additionalTagReplacements["google-sheets-html-origin"]="*";break;case"powerPointDesktop":(0,u.processPastedContentFromPowerPoint)(t,this.editor.getTrustedHTMLHandler())}(0,o.default)(t.domToModelOption,"link",c.parseLink),(0,o.default)(t.domToModelOption,"tableCell",l.deprecatedBorderColorParser),(0,o.default)(t.domToModelOption,"tableCell",b),(0,o.default)(t.domToModelOption,"table",l.deprecatedBorderColorParser),r=t.sanitizingOption,(0,i.chainSanitizerCallback)(r.cssStyleCallbacks,"display",(function(e){return"flex"!=e})),"mergeFormat"===a&&((0,o.default)(t.domToModelOption,"block",g),(0,o.default)(t.domToModelOption,"listLevel",g)),t.sanitizingOption.unknownTagReplacement=this.unknownTagReplacement}}},e}();t.ContentModelPastePlugin=v;var g=function(e,t){t.style.backgroundColor&&delete e.backgroundColor},h=new Map([["borderTop",{w:"borderTopWidth",s:"borderTopStyle",c:"borderTopColor"}],["borderRight",{w:"borderRightWidth",s:"borderRightStyle",c:"borderRightColor"}],["borderBottom",{w:"borderBottomWidth",s:"borderBottomStyle",c:"borderBottomColor"}],["borderLeft",{w:"borderLeftWidth",s:"borderLeftStyle",c:"borderLeftColor"}]]);function b(e,t){a.BorderKeys.forEach((function(r){if(!e[r]){var n=h.get(r);n&&t.style[n.w]&&t.style[n.s]&&!t.style[n.c]&&(e[r]=t.style[n.w]+" "+t.style[n.s])}}))}},8536:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.excelHandler=t.processPastedContentFromExcel=void 0;var n=r(7582),o=r(2158),a=r(1246),i=r(722),l=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,s=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,c=/<tr[^>]*>[^<]*/i,d=/<table[^>]*>[^<]*/i,u="solid 1px #d4d4d4";function f(e,t){if(e.match(l)){var r=t.match(c);e=(r?r[0]:"<TR>")+e+"</TR>"}if(e.match(s)){var n=t.match(d);e=(n?n[0]:"<TABLE>")+e+"</TABLE>"}return e}t.processPastedContentFromExcel=function(e,t){var r=e.fragment,l=e.htmlBefore,s=e.clipboardData,c=s.html?f(s.html,l):void 0;if(c&&s.html!=c){var d=(new DOMParser).parseFromString(t(c),"text/html");(0,a.moveChildNodes)(r,null==d?void 0:d.body)}var p=r.firstChild;(0,a.isNodeOfType)(p,"ELEMENT_NODE")&&"div"==p.tagName&&p.firstChild&&Array.from(p.childNodes).every((function(e){var t=(0,a.isNodeOfType)(e,"ELEMENT_NODE")&&e.tagName;return"META"==t||"TABLE"==t&&e==p.lastChild}))&&p.lastChild&&e.fragment.replaceChildren(p.lastChild),(0,o.default)(e.domToModelOption,"tableCell",(function(e,t){"none"===t.style.borderStyle&&(e.borderBottom=u,e.borderLeft=u,e.borderRight=u,e.borderTop=u)})),(0,i.setProcessor)(e.domToModelOption,"child",(function(e,t,r){var o=(0,n.__assign)({},r.segmentFormat);"TableCell"===e.blockGroupType&&e.format.textColor&&(r.segmentFormat.textColor=e.format.textColor),r.defaultElementProcessors.child(e,t,r),"TableCell"===e.blockGroupType&&e.format.textColor&&(r.segmentFormat=o,delete e.format.textColor)}))},t.excelHandler=f},1466:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processPastedContentFromPowerPoint=void 0;var n=r(1246);t.processPastedContentFromPowerPoint=function(e,t){var r=e.fragment,o=e.clipboardData;if(o.html&&!o.text&&o.image){var a=(new DOMParser).parseFromString(t(o.html),"text/html");(0,n.moveChildNodes)(r,null==a?void 0:a.body)}}},8633:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processPastedContentWacComponents=void 0;var n=r(7582),o=r(2158),a=r(722),i="ListContainerWrapper",l="TableContainer",s=["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle","ListMarkerWrappingSpan"],c=(0,n.__spreadArray)((0,n.__spreadArray)(["OutlineElement","NumberListStyle","WACImageContainer","ListContainerWrapper","BulletListStyle"],(0,n.__read)(s),!1),["TableCellContent","Paragraph","WACImageContainer","WACImageBorder",l,"LineBreakBlob"],!1),d=["UL","OL","LI"],u=d.join(","),f=function(e,t){var r=t.style.verticalAlign;"super"===r&&(e.superOrSubScriptSequence="super"),"sub"===r&&(e.superOrSubScriptSequence="sub")},p=function(e,t,r){var n=t.tagName;if(t.matches('ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer,span.WACImageBorder')&&(t.style.removeProperty("display"),t.style.removeProperty("margin")),t.classList.contains(i))r.elementProcessors.child(e,t,r);else if(!s.some((function(e){return t.classList.contains(e)}))){if(function(e,t,r){return r.listFormat.levels.length>0&&d.every((function(t){return t!=e}))&&!t.closest(u)}(n,t,r)){var o=r.listFormat;o.levels=[],o.listParent=void 0}r.defaultElementProcessors.element(e,t,r)}},m=function(e,t,r){var n,o,a;null===(o=(n=r.defaultElementProcessors).li)||void 0===o||o.call(n,e,t,r);var i=r.listFormat.listParent;if(i){var l=i.blocks[i.blocks.length-1];if("BlockGroup"==l.blockType&&"ListItem"==l.blockGroupType&&r.listFormat.listParent!==l){var s=l.levels[l.levels.length-1],c=parseInt(null!==(a=t.getAttribute("data-aria-level"))&&void 0!==a?a:"");if(c>0)if(c>l.levels.length)for(;c!=l.levels.length;)l.levels.push(s);else l.levels.splice(c,l.levels.length-1),l.levels[c-1]=s}}},v=function(e,t){"block"===t.style.display&&(e.displayForDummyItem=void 0),e.marginLeft=void 0},g=function(e){e.marginLeft=void 0,e.paddingLeft=void 0};t.processPastedContentWacComponents=function(e){var t;(0,o.default)(e.domToModelOption,"segment",f),(0,o.default)(e.domToModelOption,"listItemThread",v),(0,o.default)(e.domToModelOption,"listLevel",g),(0,o.default)(e.domToModelOption,"container",b),(0,a.setProcessor)(e.domToModelOption,"element",p),(0,a.setProcessor)(e.domToModelOption,"li",m),(0,a.setProcessor)(e.domToModelOption,"ol",h),(0,a.setProcessor)(e.domToModelOption,"ul",h),(t=e.sanitizingOption.additionalAllowedCssClasses).push.apply(t,(0,n.__spreadArray)([],(0,n.__read)(c),!1))};var h=function(e,t,r){var n,o,a,l,s,c=e.blocks[e.blocks.length-1],d=t.closest("."+i);(null===(n=null==d?void 0:d.previousElementSibling)||void 0===n?void 0:n.classList.contains(i))&&"BlockGroup"===(null==c?void 0:c.blockType)&&"ListItem"==c.blockGroupType&&(r.listFormat={threadItemCounts:[],levels:c.levels,listParent:e}),"OL"===t.tagName.toUpperCase()?null===(a=(o=r.defaultElementProcessors).ol)||void 0===a||a.call(o,e,t,r):null===(s=(l=r.defaultElementProcessors).ul)||void 0===s||s.call(l,e,t,r)},b=function(e,t){t.classList.contains(l)&&t.style.marginLeft.startsWith("-")&&delete e.marginLeft}},8807:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wordDesktopElementProcessor=t.processPastedContentFromWordDesktop=void 0;var n=r(2158),o=r(2347),a=r(5098),i=r(1246),l=r(4109),s=r(2389),c=r(722),d=/%/;function u(e,t,r,n){var o;d.test(t.style.lineHeight)&&!isNaN(o=parseInt(t.style.lineHeight))&&o<120&&(e.lineHeight=n.lineHeight)}function f(e,t,r,n){""!=t.style.marginLeft&&(e.marginLeft=n.marginLeft),e.marginBottom=void 0}t.processPastedContentFromWordDesktop=function(e){(0,c.setProcessor)(e.domToModelOption,"element",t.wordDesktopElementProcessor),(0,n.default)(e.domToModelOption,"block",u),(0,n.default)(e.domToModelOption,"listLevel",f),(0,n.default)(e.domToModelOption,"listItemElement",p),(0,o.chainSanitizerCallback)(e.sanitizingOption.cssStyleCallbacks,"border",(function(e,t){return"IMG"!=t.tagName||"none"!=e})),(0,o.chainSanitizerCallback)(e.sanitizingOption.elementCallbacks,"O:P",(function(e){return(0,i.moveChildNodes)(e),e.appendChild(e.ownerDocument.createTextNode(" ")),!0}))},t.wordDesktopElementProcessor=function(e,t,r){var n=(0,a.getStyles)(t);(0,s.processWordList)(n,e,t,r)||(0,l.processWordComments)(n,t)||r.defaultElementProcessors.element(e,t,r)};var p=function(e,t){t.style.marginLeft&&(e.marginLeft=void 0),t.style.marginRight&&(e.marginRight=void 0)}},4109:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processWordComments=void 0;var n=r(1246),o=/#_msocom_/;t.processWordComments=function(e,t){return"comment"==e["mso-special-character"]||(0,n.isElementOfType)(t,"a")&&o.test(t.href)||"comment-list"==e["mso-element"]}},2389:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processWordList=void 0;var n=r(7582),o=r(5098),a=r(1246),i="mso-list",l="ignore";function s(e){return function(t,r,n){var o=n.listFormat,a=o.wordKnownLevels,i=o.wordLevel,l=o.wordList;if("number"==typeof i&&l){var s=parseInt(e);null==s||isNaN(s)||(null==a?void 0:a.has(l))||(t.startNumberOverride=s)}}}function c(e,t){var r,n,o="";t=t||5;for(var i=e.firstChild;!o&&i;)d(i)?0==(o=null!==(n=null===(r=i.textContent)||void 0===r?void 0:r.trim())&&void 0!==n?n:"").length&&(o="o"):(0,a.isNodeOfType)(i,"ELEMENT_NODE")&&t>1&&(o=c(i,t-1)),i=i.nextSibling;return o}function d(e){if((0,a.isNodeOfType)(e,"ELEMENT_NODE")){var t=(0,o.getStyles)(e)[i];if(t&&t.length>0&&t.trim().toLowerCase()==l)return!0}return!1}t.processWordList=function(e,t,r,o){var d=o.listFormat;d.wordKnownLevels||(d.wordKnownLevels=new Map);var u=e[i]||"";if(u.toLowerCase()===l)return!0;var f=u.split(" ");if(d.wordLevel=f[1]&&parseInt(f[1].substr(5)),d.wordList=f[0]||"l0",0==d.levels.length&&(d.levels=d.wordKnownLevels.get(d.wordList)||[]),u&&t&&"number"==typeof d.wordLevel){var p=d.wordLevel,m=c(r),v=function(e){return function(e){return["o","·","§","-"].indexOf(e)>=0}(e)?"UL":"OL"}(m),g=(0,a.createListLevel)(v);if((0,a.parseFormat)(r,o.formatParsers.listLevel,g.format,o),p>d.levels.length)for(;p!=d.levels.length;)d.levels.push(g);else d.levels.splice(p,d.levels.length-1),d.levels[p-1]=g;return d.listParent=t,function(e,t,r,n,o){var i=(0,a.createListItem)(e.levels,t.segmentFormat),l=i.levels[i.levels.length-1];(0,a.parseFormat)(r,t.formatParsers.segmentOnBlock,t.segmentFormat,t),(0,a.parseFormat)(r,t.formatParsers.listItemElement,i.format,t),"OL"==(null==l?void 0:l.listType)&&(0,a.parseFormat)(r,[s(o)],i.levels[i.levels.length-1].format,t),t.elementProcessors.child(i,r,t),(0,a.addBlock)(n,i)}(d,o,r,t,m),d.levels.length>0&&d.wordKnownLevels.get(d.wordList)!=d.levels&&d.wordKnownLevels.set(d.wordList,(0,n.__spreadArray)([],(0,n.__read)(d.levels),!1)),!0}return!1}},3599:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.documentContainWacElements=void 0;var r='ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer,'+["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle"].map((function(e){return'table div[class^="'+e+'"]'})).join(",");t.documentContainWacElements=function(e){return!!e.fragment.querySelector(r)}},2819:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPasteSource=void 0;var n=r(3599),o=r(8698),a=r(7089),i=r(2253),l=r(9392),s=r(5844),c=r(8662),d=new Map([["wordDesktop",s.isWordDesktopDocument],["excelDesktop",o.isExcelDesktopDocument],["excelOnline",a.isExcelOnlineDocument],["powerPointDesktop",l.isPowerPointDesktopDocument],["wacComponents",n.documentContainWacElements],["googleSheets",i.isGoogleSheetDocument],["singleImage",c.shouldConvertToSingleImage]]);t.getPasteSource=function(e,t){var r=e.htmlAttributes,n=e.clipboardData,o=e.fragment,a=null,i={htmlAttributes:r,fragment:o,shouldConvertSingleImage:t,clipboardData:n};return d.forEach((function(e,t){!a&&e(i)&&(a=t)})),null!=a?a:"default"}},8698:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isExcelDesktopDocument=void 0,t.isExcelDesktopDocument=function(e){return"urn:schemas-microsoft-com:office:excel"==e.htmlAttributes["xmlns:x"]}},7089:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isExcelOnlineDocument=void 0,t.isExcelOnlineDocument=function(e){var t=e.htmlAttributes;return"Excel.Sheet"==t.ProgId&&null==t["xmlns:x"]}},2253:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGoogleSheetDocument=void 0,t.isGoogleSheetDocument=function(e){return!!e.fragment.querySelector("google-sheets-html-origin")}},9392:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPowerPointDesktopDocument=void 0,t.isPowerPointDesktopDocument=function(e){return"PowerPoint.Slide"==e.htmlAttributes.ProgId}},5844:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWordDesktopDocument=void 0,t.isWordDesktopDocument=function(e){var t=e.htmlAttributes;return"urn:schemas-microsoft-com:office:word"==t["xmlns:w"]||"Word.Document"==t.ProgId}},8662:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldConvertToSingleImage=void 0,t.shouldConvertToSingleImage=function(e){var t,r=e.shouldConvertSingleImage,n=e.clipboardData;return r&&1==(null===(t=n.htmlFirstLevelChildTags)||void 0===t?void 0:t.length)&&"IMG"==n.htmlFirstLevelChildTags[0]}},2158:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var n;e.additionalFormatParsers||(e.additionalFormatParsers={}),e.additionalFormatParsers[t]||(e.additionalFormatParsers[t]=[]),null===(n=e.additionalFormatParsers[t])||void 0===n||n.push(r)}},7074:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deprecatedBorderColorParser=void 0;var n=r(1246);t.deprecatedBorderColorParser=function(e){n.BorderKeys.forEach((function(t){var r=e[t],o="";if(r&&n.DeprecatedColors.some((function(e){return r.indexOf(e)>-1&&(o=e)}))){var a=r.replace(o,"").trimRight();e[t]=a}}))}},5098:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStyles=void 0,t.getStyles=function(e){var t={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach((function(e){var r=e.indexOf(":"),n=e.slice(0,r),o=e.slice(r+1);n&&o&&(t[n.trim()]=o.trim())})),t}},5703:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLink=void 0;var n=r(1246),o=["http:","https:","notes:","mailto:","onenote:"],a=/^file:\/\/\/[a-zA-Z\/]/i;t.parseLink=function(e,t){if((0,n.isElementOfType)(t,"a")){var r;try{r=new URL(t.href)}catch(e){r=void 0}(r&&-1===o.indexOf(r.protocol)||a.test(t.href))&&(t.removeAttribute("href"),e.href="")}}},722:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setProcessor=void 0,t.setProcessor=function(e,t,r){e.processorOverride||(e.processorOverride={}),e.processorOverride[t]=r}},398:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1533:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelEditor=void 0;var n=r(7582),o=r(3247),a=r(6334);t.createContentModelEditor=function(e,t,r){var i=t?(0,n.__spreadArray)([],(0,n.__read)(t),!1):[];i.push(new a.ContentModelPastePlugin,new a.ContentModelEditPlugin);var l={plugins:i,initialContent:r,defaultSegmentFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new o.ContentModelEditor(e,l)}},2594:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelEditor=void 0;var n=r(7582),o=r(1533);Object.defineProperty(t,"createContentModelEditor",{enumerable:!0,get:function(){return o.createContentModelEditor}}),(0,n.__exportStar)(r(398),t),(0,n.__exportStar)(r(1246),t),(0,n.__exportStar)(r(79),t),(0,n.__exportStar)(r(5511),t),(0,n.__exportStar)(r(3247),t),(0,n.__exportStar)(r(6334),t)},2347:e=>{"use strict";e.exports=roosterjs},7582:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__assign:()=>a,__asyncDelegator:()=>w,__asyncGenerator:()=>P,__asyncValues:()=>M,__await:()=>k,__awaiter:()=>m,__classPrivateFieldGet:()=>x,__classPrivateFieldIn:()=>j,__classPrivateFieldSet:()=>D,__createBinding:()=>g,__decorate:()=>l,__esDecorate:()=>c,__exportStar:()=>h,__extends:()=>o,__generator:()=>v,__importDefault:()=>F,__importStar:()=>T,__makeTemplateObject:()=>E,__metadata:()=>p,__param:()=>s,__propKey:()=>u,__read:()=>y,__rest:()=>i,__runInitializers:()=>d,__setFunctionName:()=>f,__spread:()=>C,__spreadArray:()=>_,__spreadArrays:()=>S,__values:()=>b,default:()=>B});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function l(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function s(e,t){return function(r,n){t(r,n,e)}}function c(e,t,r,n,o,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var l,s=n.kind,c="getter"===s?"get":"setter"===s?"set":"value",d=!t&&e?n.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,n.name):{}),f=!1,p=r.length-1;p>=0;p--){var m={};for(var v in n)m[v]="access"===v?{}:n[v];for(var v in n.access)m.access[v]=n.access[v];m.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var g=(0,r[p])("accessor"===s?{get:u.get,set:u.set}:u[c],m);if("accessor"===s){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(l=i(g.get))&&(u.get=l),(l=i(g.set))&&(u.set=l),(l=i(g.init))&&o.unshift(l)}else(l=i(g))&&("field"===s?o.unshift(l):u[c]=l)}d&&Object.defineProperty(d,n.name,u),f=!0}function d(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function f(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{s(n.next(e))}catch(e){a(e)}}function l(e){try{s(n.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))}function v(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(s){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{r=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}}var g=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function h(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function S(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,l=a.length;i<l;i++,o++)n[o]=a[i];return n}function _(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function k(e){return this instanceof k?(this.v=e,this):new k(e)}function P(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||l(e,t)}))})}function l(e,t){try{(r=o[e](t)).value instanceof k?Promise.resolve(r.value.v).then(s,c):d(a[0][2],r)}catch(e){d(a[0][3],e)}var r}function s(e){l("next",e)}function c(e){l("throw",e)}function d(e,t){e(t),a.shift(),a.length&&l(a[0][0],a[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:k(e[n](t)),done:!1}:o?o(t):t}:o}}function M(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,o,(t=e[r](t)).done,t.value)}))}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var O=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return O(t,e),t}function F(e){return e&&e.__esModule?e:{default:e}}function x(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function D(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function j(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}const B={__extends:o,__assign:a,__rest:i,__decorate:l,__param:s,__metadata:p,__awaiter:m,__generator:v,__createBinding:g,__exportStar:h,__values:b,__read:y,__spread:C,__spreadArrays:S,__spreadArray:_,__await:k,__asyncGenerator:P,__asyncDelegator:w,__asyncValues:M,__makeTemplateObject:E,__importStar:T,__importDefault:F,__classPrivateFieldGet:x,__classPrivateFieldSet:D,__classPrivateFieldIn:j}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n=r(2594);roosterjsContentModel=n})();
//# sourceMappingURL=rooster-content-model-min.js.map