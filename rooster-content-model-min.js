var roosterjsContentModel;(()=>{"use strict";var e={8745:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findListItemsInSameThread=t.setListType=t.formatSegmentWithContentModel=t.formatParagraphWithContentModel=t.formatImageWithContentModel=t.formatTableWithContentModel=t.insertTableColumn=t.insertTableRow=t.insertEntity=t.toggleCode=t.setParagraphMargin=t.adjustImageSelection=t.setImageAltText=t.adjustLinkSelection=t.removeLink=t.insertLink=t.clearFormat=t.getFormatState=t.changeImage=t.setImageBoxShadow=t.setImageBorder=t.setSpacing=t.toggleBlockQuote=t.setHeadingLevel=t.setDirection=t.setAlignment=t.setIndentation=t.setListStartNumber=t.setListStyle=t.insertImage=t.changeCapitalization=t.applySegmentFormat=t.changeFontSize=t.setTextColor=t.setFontSize=t.setFontName=t.setBackgroundColor=t.toggleSuperscript=t.toggleSubscript=t.toggleStrikethrough=t.toggleUnderline=t.toggleItalic=t.toggleBold=t.toggleNumbering=t.toggleBullet=t.applyTableBorderFormat=t.editTable=t.setTableCellShade=t.formatTable=t.insertTable=void 0,t.matchLink=t.setModelIndentation=void 0;var o=r(113);Object.defineProperty(t,"insertTable",{enumerable:!0,get:function(){return o.insertTable}});var n=r(5844);Object.defineProperty(t,"formatTable",{enumerable:!0,get:function(){return n.formatTable}});var a=r(9587);Object.defineProperty(t,"setTableCellShade",{enumerable:!0,get:function(){return a.setTableCellShade}});var i=r(5325);Object.defineProperty(t,"editTable",{enumerable:!0,get:function(){return i.editTable}});var l=r(7290);Object.defineProperty(t,"applyTableBorderFormat",{enumerable:!0,get:function(){return l.applyTableBorderFormat}});var s=r(7655);Object.defineProperty(t,"toggleBullet",{enumerable:!0,get:function(){return s.toggleBullet}});var c=r(6320);Object.defineProperty(t,"toggleNumbering",{enumerable:!0,get:function(){return c.toggleNumbering}});var d=r(9176);Object.defineProperty(t,"toggleBold",{enumerable:!0,get:function(){return d.toggleBold}});var u=r(6053);Object.defineProperty(t,"toggleItalic",{enumerable:!0,get:function(){return u.toggleItalic}});var f=r(1538);Object.defineProperty(t,"toggleUnderline",{enumerable:!0,get:function(){return f.toggleUnderline}});var p=r(8398);Object.defineProperty(t,"toggleStrikethrough",{enumerable:!0,get:function(){return p.toggleStrikethrough}});var m=r(8356);Object.defineProperty(t,"toggleSubscript",{enumerable:!0,get:function(){return m.toggleSubscript}});var v=r(79);Object.defineProperty(t,"toggleSuperscript",{enumerable:!0,get:function(){return v.toggleSuperscript}});var g=r(5707);Object.defineProperty(t,"setBackgroundColor",{enumerable:!0,get:function(){return g.setBackgroundColor}});var h=r(8151);Object.defineProperty(t,"setFontName",{enumerable:!0,get:function(){return h.setFontName}});var b=r(9316);Object.defineProperty(t,"setFontSize",{enumerable:!0,get:function(){return b.setFontSize}});var y=r(6268);Object.defineProperty(t,"setTextColor",{enumerable:!0,get:function(){return y.setTextColor}});var S=r(6385);Object.defineProperty(t,"changeFontSize",{enumerable:!0,get:function(){return S.changeFontSize}});var C=r(1089);Object.defineProperty(t,"applySegmentFormat",{enumerable:!0,get:function(){return C.applySegmentFormat}});var _=r(3870);Object.defineProperty(t,"changeCapitalization",{enumerable:!0,get:function(){return _.changeCapitalization}});var T=r(2549);Object.defineProperty(t,"insertImage",{enumerable:!0,get:function(){return T.insertImage}});var E=r(8907);Object.defineProperty(t,"setListStyle",{enumerable:!0,get:function(){return E.setListStyle}});var k=r(6916);Object.defineProperty(t,"setListStartNumber",{enumerable:!0,get:function(){return k.setListStartNumber}});var M=r(8474);Object.defineProperty(t,"setIndentation",{enumerable:!0,get:function(){return M.setIndentation}});var P=r(2993);Object.defineProperty(t,"setAlignment",{enumerable:!0,get:function(){return P.setAlignment}});var O=r(6763);Object.defineProperty(t,"setDirection",{enumerable:!0,get:function(){return O.setDirection}});var w=r(9762);Object.defineProperty(t,"setHeadingLevel",{enumerable:!0,get:function(){return w.setHeadingLevel}});var x=r(2815);Object.defineProperty(t,"toggleBlockQuote",{enumerable:!0,get:function(){return x.toggleBlockQuote}});var F=r(8492);Object.defineProperty(t,"setSpacing",{enumerable:!0,get:function(){return F.setSpacing}});var D=r(9782);Object.defineProperty(t,"setImageBorder",{enumerable:!0,get:function(){return D.setImageBorder}});var L=r(7017);Object.defineProperty(t,"setImageBoxShadow",{enumerable:!0,get:function(){return L.setImageBoxShadow}});var j=r(6758);Object.defineProperty(t,"changeImage",{enumerable:!0,get:function(){return j.changeImage}});var N=r(2509);Object.defineProperty(t,"getFormatState",{enumerable:!0,get:function(){return N.getFormatState}});var I=r(7637);Object.defineProperty(t,"clearFormat",{enumerable:!0,get:function(){return I.clearFormat}});var R=r(5854);Object.defineProperty(t,"insertLink",{enumerable:!0,get:function(){return R.insertLink}});var A=r(5972);Object.defineProperty(t,"removeLink",{enumerable:!0,get:function(){return A.removeLink}});var B=r(3657);Object.defineProperty(t,"adjustLinkSelection",{enumerable:!0,get:function(){return B.adjustLinkSelection}});var H=r(5040);Object.defineProperty(t,"setImageAltText",{enumerable:!0,get:function(){return H.setImageAltText}});var z=r(3775);Object.defineProperty(t,"adjustImageSelection",{enumerable:!0,get:function(){return z.adjustImageSelection}});var W=r(5787);Object.defineProperty(t,"setParagraphMargin",{enumerable:!0,get:function(){return W.setParagraphMargin}});var G=r(7311);Object.defineProperty(t,"toggleCode",{enumerable:!0,get:function(){return G.toggleCode}});var U=r(1323);Object.defineProperty(t,"insertEntity",{enumerable:!0,get:function(){return U.insertEntity}});var K=r(3353);Object.defineProperty(t,"insertTableRow",{enumerable:!0,get:function(){return K.insertTableRow}});var V=r(9281);Object.defineProperty(t,"insertTableColumn",{enumerable:!0,get:function(){return V.insertTableColumn}});var q=r(821);Object.defineProperty(t,"formatTableWithContentModel",{enumerable:!0,get:function(){return q.formatTableWithContentModel}});var X=r(3152);Object.defineProperty(t,"formatImageWithContentModel",{enumerable:!0,get:function(){return X.formatImageWithContentModel}});var $=r(4890);Object.defineProperty(t,"formatParagraphWithContentModel",{enumerable:!0,get:function(){return $.formatParagraphWithContentModel}});var Y=r(6648);Object.defineProperty(t,"formatSegmentWithContentModel",{enumerable:!0,get:function(){return Y.formatSegmentWithContentModel}});var Z=r(9689);Object.defineProperty(t,"setListType",{enumerable:!0,get:function(){return Z.setListType}});var Q=r(4514);Object.defineProperty(t,"findListItemsInSameThread",{enumerable:!0,get:function(){return Q.findListItemsInSameThread}});var J=r(8722);Object.defineProperty(t,"setModelIndentation",{enumerable:!0,get:function(){return J.setModelIndentation}});var ee=r(6089);Object.defineProperty(t,"matchLink",{enumerable:!0,get:function(){return ee.matchLink}})},1230:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setModelAlignment=void 0;var o=r(8108),n=r(4781),a={left:{ltr:"start",rtl:"end"},center:{ltr:"center",rtl:"center"},right:{ltr:"end",rtl:"start"},justify:{ltr:"justify",rtl:"justify"}},i={left:{ltr:"alignLeft",rtl:"alignRight"},center:{ltr:"alignCenter",rtl:"alignCenter"},right:{ltr:"alignRight",rtl:"alignLeft"}};t.setModelAlignment=function(e,t){var r=(0,n.getOperationalBlocks)(e,["ListItem"],["TableCell"]);return r.forEach((function(e){var r=e.block,n=a[t]["rtl"==r.format.direction?"rtl":"ltr"];"Table"===r.blockType&&"justify"!==t?(0,o.alignTable)(r,i[t]["rtl"==r.format.direction?"rtl":"ltr"]):r&&("BlockGroup"===r.blockType&&"ListItem"===r.blockGroupType&&r.blocks.forEach((function(e){e.format.textAlign=n})),r.format.textAlign=n)})),r.length>0}},7444:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setModelDirection=void 0;var o=r(4514),n=r(4781);function a(e,t,r){if("rtl"==e.direction!=("rtl"==t)){e.direction=t;var o=e.marginLeft,a=e.paddingLeft;i(e,"marginLeft",e.marginRight),i(e,"marginRight",o),i(e,"paddingLeft",e.paddingRight),i(e,"paddingRight",a),r&&"Table"==r.blockType&&(r.rows.forEach((function(e){e.cells.forEach((function(e){(0,n.updateTableCellMetadata)(e,(function(t){if(null==t?void 0:t.borderOverride){var r=e.format.borderLeft;i(e.format,"borderLeft",e.format.borderRight),i(e.format,"borderRight",r)}return t}))}))})),(0,n.applyTableFormat)(r,void 0,!0))}}function i(e,t,r){r?e[t]=r:delete e[t]}t.setModelDirection=function(e,t){var r=(0,n.getOperationalBlocks)(e,["ListItem"],["TableCell"]);return r.forEach((function(r){var i=r.block;(0,n.isBlockGroupOfType)(i,"ListItem")?(0,o.findListItemsInSameThread)(e,i).forEach((function(e){e.levels.forEach((function(e){e.format.direction=t})),e.blocks.forEach((function(e){return a(e.format,t)}))})):i&&a(i.format,t,i)})),r.length>0}},8722:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setModelIndentation=void 0;var o=r(8871),n=r(4514),a=r(4781);function i(e){return e.blocks.some((function(e){if("Paragraph"==e.blockType)return e.segments.some((function(e){return e.isSelected}))}))}function l(e,t,r){void 0===r&&(r=40);var n=e.marginLeft,a=e.marginRight,i="rtl"==e.direction,l=(0,o.parseValueWithUnit)(i?a:n),s=(t?Math.ceil:Math.floor)(l/r)*r;return s==l&&(s=Math.max(s+r*(t?1:-1),0)),s==l?null:s}t.setModelIndentation=function(e,t,r){void 0===r&&(r=40);var s=(0,a.getOperationalBlocks)(e,["ListItem"],["TableCell"]),c="indent"==t,d=[];return s.forEach((function(t){var s=t.block,u=t.parent,f=t.path;if((0,a.isBlockGroupOfType)(s,"ListItem")){var p=(0,n.findListItemsInSameThread)(e,s)[0];if(i(p)&&1==p.levels.length){var m=s.levels[0],v=(E=m.format).marginLeft,g=E.marginRight,h=l(E,c,r),b="rtl"==E.direction,y=(0,o.parseValueWithUnit)(b?g:v);c||0!=y?null!==h&&(b?m.format.marginRight=h+"px":m.format.marginLeft=h+"px"):s.levels.pop()}else if(1==s.levels.length||!function(e,t,r){for(var o=r.blocks.indexOf(t)-1;o>=0;o--){var l=r.blocks[o];if((0,a.isBlockGroupOfType)(l,"ListItem")&&1==l.levels.length&&i(l))return i((0,n.findListItemsInSameThread)(e,l)[0]);if(!(0,a.isBlockGroupOfType)(l,"ListItem"))return!1}return!1}(e,s,u))if(c){var S=s.levels[s.levels.length-1],C=(0,o.createListLevel)((null==S?void 0:S.listType)||"UL",null==S?void 0:S.format);(0,a.updateListMetadata)(C,(function(e){return(e=e||{}).applyListStyleFromLevel=!0,e})),delete C.format.startNumberOverride,s.levels.push(C)}else s.levels.pop()}else if(s)for(var _=s,T=u;T&&d.indexOf(_)<0;){var E,k=f.indexOf(T);if(null!==(h=l(E=_.format,c,r))){(b="rtl"==E.direction)?E.marginRight=h+"px":E.marginLeft=h+"px",d.push(_);break}if(!("FormatContainer"==T.blockGroupType&&k>=0))break;delete T.cachedElement,_=T,T=f[k+1]}})),s.length>0}},9611:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleModelBlockQuote=void 0;var o=r(8871),n=r(4781),a=r(3388);function i(e){return(0,n.isBlockGroupOfType)(e,"FormatContainer")&&"blockquote"==e.tagName}t.toggleModelBlockQuote=function(e,t,r){var l=(0,n.getOperationalBlocks)(e,["FormatContainer","ListItem"],["TableCell"],!0);if(l.every((function(e){return i(e.block)})))l.forEach((function(e){var t=e.block,r=e.parent;(0,o.unwrapBlock)(r,t)}));else{var s=[],c=function(e){return(0,o.createFormatContainer)("blockquote",e?r:t)},d=function(e,n,a){return function(e,t){return i(e)&&(0,o.areSameFormats)(t,e.format)}(n,(null==a?void 0:a.format)||(e?r:t))};l.forEach((function(e){var t=e.block,r=e.parent;i(t)||(0,a.wrapBlockStep1)(s,r,t,c,d)})),(0,a.wrapBlockStep2)(s,d)}return l.length>0}},4789:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearModelFormat=void 0;var o=r(7582),n=r(2737),a=r(8871),i=r(4781);function l(e,t){var r=(0,i.getClosestAncestorBlockGroupIndex)(e,["FormatContainer"],["TableCell"]);if(r>=0&&r<e.length-1){var o=e[r],n=e[r+1].blocks.indexOf(o),l=o.blocks.indexOf(t);if(l>=0&&n>=0){var s=(0,a.createFormatContainer)(o.tagName,o.format);o.blocks.splice(l,1),s.blocks=o.blocks.splice(l),e[r+1].blocks.splice(n+1,0,t,s)}}}function s(e){var t=e[(0,i.getClosestAncestorBlockGroupIndex)(e,["ListItem"],["TableCell"])];t&&(t.levels=[])}function c(e,t){if("Divider"==t.blockType){var r=e[0].blocks.indexOf(t);r>=0&&e[0].blocks.splice(r,1)}else"Paragraph"==t.blockType&&(t.format={},delete t.decorator)}t.clearModelFormat=function(e,t,r,a){(0,i.iterateSelections)(e,(function(e,n,l,s){s&&r.push.apply(r,(0,o.__spreadArray)([],(0,o.__read)(s),!1)),l?t.push([e,l]):n&&function(e,t){if(e){var r=e.table,o=e.colIndex,n=e.rowIndex,a=e.isWholeTableSelected,l=r.rows[n].cells[o];l.isSelected&&((0,i.updateTableCellMetadata)(l,(function(){return null})),l.isHeader=!1,l.format={useBorderBox:l.format.useBorderBox}),t.find((function(e){return e[0]==r}))||t.push([r,a])}}(n,a)}),{includeListFormatHolder:e.format?"never":"anySegment"});var d=r[0];if(1==t.length&&function(e){var t="Paragraph"==e.blockType?e.segments.filter((function(e){return e.isSelected})):[];return 1==t.length&&"SelectionMarker"==t[0].segmentType}(t[0][1])&&1==t.length)r.splice.apply(r,(0,o.__spreadArray)([0,r.length],(0,o.__read)((0,n.adjustWordSelection)(e,d)),!1)),s(t[0][0]);else if(t.length>1||t.some((function(e){return function(e){return e.isSelected||"Paragraph"==e.blockType&&e.segments.every((function(e){return e.isSelected}))}(e[1])})))for(var u=t.length-1;u>=0;u--){var f=(0,o.__read)(t[u],2),p=f[0],m=f[1];c(p,m),s(p),l(p,m)}!function(e,t){e.forEach((function(e){e.format=(0,o.__assign)({},t||{}),e.link&&delete e.link.format.textColor,delete e.code}))}(r,e.format),function(e){e.forEach((function(e){var t=(0,o.__read)(e,2),r=t[0];t[1]&&(r.format={useBorderBox:r.format.useBorderBox,borderCollapse:r.format.borderCollapse},(0,i.updateTableMetadata)(r,(function(){return null}))),(0,i.applyTableFormat)(r,void 0,!0)}))}(a)}},3388:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrapBlockStep2=t.wrapBlockStep1=void 0;var o=r(7582),n=r(8871);t.wrapBlockStep1=function(e,t,r,o,a){var i,l=null!==(i=null==t?void 0:t.blocks.indexOf(r))&&void 0!==i?i:-1;if(t&&l>=0){t.blocks.splice(l,1);var s=t.blocks[l-1],c="rtl"==r.format.direction,d=a(c,s)?s:function(e,t,r,o){var n=r(o);return e.blocks.splice(t,0,n),n}(t,l,o,c);(0,n.setParagraphNotImplicit)(r),(0,n.addBlock)(d,r),e.unshift({parent:t,wrapper:d})}},t.wrapBlockStep2=function(e,t){e.forEach((function(e){var r,a=e.parent,i=e.wrapper,l=a.blocks.indexOf(i),s=a.blocks[l+1],c="rtl"==i.format.direction;l>=0&&t(c,s,i)&&(i.blocks.forEach(n.setParagraphNotImplicit),(r=i.blocks).push.apply(r,(0,o.__spreadArray)([],(0,o.__read)(s.blocks),!1)),a.blocks.splice(l+1,1))}))}},4247:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.insertEntityModel=void 0;var o=r(7582),n=r(4781),a=r(8871);t.insertEntityModel=function(e,t,r,i,l,s){var c,d,u,f,p=-1;if("begin"==r||"end"==r)u=e,p="begin"==r?0:e.blocks.length,i||Object.assign(t.format,e.format);else if((f=(0,n.deleteSelection)(e,[],s)).insertPoint){var m=f.insertPoint,v=m.marker,g=m.paragraph,h=m.path;if("range"==f.deleteResult&&(0,a.normalizeContentModel)(e),i){var b="root"==r?(0,n.getClosestAncestorBlockGroupIndex)(h,["TableCell","Document"]):0;u=h[b];var y=h[b-1],S="FormatContainer"==(null==y?void 0:y.blockGroupType)||"General"==(null==y?void 0:y.blockGroupType)||"ListItem"==(null==y?void 0:y.blockGroupType)?y:g,C=u.blocks.indexOf(S);p=C>=0?C+1:-1}else{var _=g.segments.indexOf(v);Object.assign(t.format,v.format),_>=0&&g.segments.splice(l?_:_+1,0,t)}}if(p>=0&&u){var T=[],E=void 0;if(i){var k=u.blocks[p];T.push(t),"Paragraph"==(null==k?void 0:k.blockType)?E=k:k&&"Entity"!=k.blockType&&!l||((E=(0,a.createParagraph)(!1,{},e.format)).segments.push((0,a.createBr)(e.format)),T.push(E))}else(E=(0,a.createParagraph)(!1,void 0,e.format)).segments.push(t),T.push(E);if((c=u.blocks).splice.apply(c,(0,o.__spreadArray)([p,0],(0,o.__read)(T),!1)),l&&E){v=(0,a.createSelectionMarker)((null===(d=E.segments[0])||void 0===d?void 0:d.format)||e.format);var M=E.segments;i?M.unshift(v):M.push(v),(0,n.setSelection)(e,v,v)}}}},3446:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyImageBorderFormat=void 0;var o=r(4781),n=r(8871);t.applyImageBorderFormat=function(e,t,r){if(t){var a=e.format,i=t.width,l=t.style,s=t.color,c=(0,o.extractBorderValues)(a.borderTop),d=c.color,u=c.width,f=c.style,p="";p=i?(0,n.parseValueWithUnit)(i)+"px":u||"1px",l?p=p+" "+l:f?p=p+" "+f:p+=" solid",s?p=p+" "+s:d&&(p=p+" "+d),e.format.borderLeft=p,e.format.borderTop=p,e.format.borderBottom=p,e.format.borderRight=p}else delete e.format.borderLeft,delete e.format.borderTop,delete e.format.borderBottom,delete e.format.borderRight;r&&(e.format.borderRadius=r)}},6089:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.matchLink=void 0;var o=r(7582),n=r(8871),a=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,i="[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",l="(?:"+i+"\\.)*"+i+"(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",s={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+l+"|www\\."+l,"i"),except:a,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+l,"i"),except:a},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+l+"|ftp\\."+l,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+l,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+l,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+l,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+l,"i")}};t.matchLink=function(e){var t,r;if(e)try{for(var a=(0,o.__values)((0,n.getObjectKeys)(s)),i=a.next();!i.done;i=a.next()){var l=i.value,c=s[l],d=e.match(c.match);if(d&&d[0]==e&&(!c.except||!c.except.test(e)))return{scheme:l,originalUrl:e,normalizedUrl:c.normalizeUrl?c.normalizeUrl(e):e}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return null}},4514:(e,t)=>{function r(e,t){e.blocks.forEach((function(e){switch(e.blockType){case"BlockGroup":"ListItem"==e.blockGroupType?t.push(e):(o(t),r(e,t),o(t));break;case"Paragraph":o(t),e.segments.forEach((function(e){"General"==e.segmentType&&r(e,t)})),o(t);break;case"Table":o(t),e.rows.forEach((function(e){return e.cells.forEach((function(e){r(e,t)}))})),o(t)}}))}function o(e){var t=e[e.length-1];t&&null===t||e.push(null)}function n(e,t,r){var o=e[t].levels,n=e[r].levels;return o.length<=n.length&&o.every((function(e,t){return e.listType==n[t].listType}))}function a(e,t){return e.levels.slice(0,t).some((function(e){return void 0!==e.format.startNumberOverride}))}Object.defineProperty(t,"__esModule",{value:!0}),t.findListItemsInSameThread=void 0,t.findListItemsInSameThread=function(e,t){var o=[];return r(e,o),function(e,t){var r,o=[],i=e.indexOf(t),l=t.levels.length,s="OL"==(null===(r=t.levels[l-1])||void 0===r?void 0:r.listType);if(i>=0){for(var c=i;c>=0;c--){if(!(u=e[c])){if(s)continue;break}var d=a(u,l);if(n(e,i,c)){if(o.unshift(u),s&&d)break}else if(!s||d)break}for(c=i+1;c<e.length;c++){var u;if(!(u=e[c])){if(s)continue;break}if(d=a(u,l),n(e,i,c)&&!d)o.push(u);else if(!s||d)break}}return o}(o,t)}},9689:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setListType=void 0;var o=r(4781),n=r(8871);function a(e){switch(e.blockType){case"Table":return!1;case"Paragraph":return e.segments.every((function(e){return"Br"==e.segmentType||"SelectionMarker"==e.segmentType}));default:return!0}}t.setListType=function(e,t,r){void 0===r&&(r=!1);var i=(0,o.getOperationalBlocks)(e,["ListItem"],[]),l=i.every((function(e){var r,n=e.block;return(0,o.isBlockGroupOfType)(n,"ListItem")?(null===(r=n.levels[n.levels.length-1])||void 0===r?void 0:r.listType)==t:a(n)})),s=[];return i.forEach((function(e,c){var d,u,f=e.block,p=e.parent;if((0,o.isBlockGroupOfType)(f,"ListItem")){var m=f.levels.pop();!l&&m?(m.listType=t,f.levels.push(m)):1==f.blocks.length&&(0,n.setParagraphNotImplicit)(f.blocks[0]),l&&f.blocks.forEach((function(e){f.format.marginLeft&&(e.format.marginLeft=f.format.marginLeft),f.format.marginRight&&(e.format.marginRight=f.format.marginRight),f.format.textAlign&&(e.format.textAlign=f.format.textAlign)}))}else{var v=p.blocks.indexOf(f);if(v>=0)if(1!=i.length&&a(f))s.forEach((function(e){return e.levels[0].format.marginBottom="0px"})),s=[];else{var g=p.blocks[v-1],h="Paragraph"==f.blockType&&(null===(d=f.segments[0])||void 0===d?void 0:d.format)||{},b=(0,n.createListItem)([(0,n.createListLevel)(t,{startNumberOverride:c>0||"BlockGroup"==(null==g?void 0:g.blockType)&&"ListItem"==g.blockGroupType&&"OL"==(null===(u=g.levels[0])||void 0===u?void 0:u.listType)?void 0:1,direction:f.format.direction,textAlign:f.format.textAlign,marginBottom:r?"0px":void 0,marginTop:r?"0px":void 0})],{fontFamily:h.fontFamily,fontSize:h.fontSize,textColor:h.textColor});"Paragraph"==f.blockType&&(0,n.setParagraphNotImplicit)(f),b.blocks.push(f),f.format.marginRight&&(b.format.marginRight=f.format.marginRight,f.format.marginRight=void 0),f.format.marginLeft&&(b.format.marginLeft=f.format.marginLeft,f.format.marginLeft=void 0),f.format.textAlign&&(b.format.textAlign=f.format.textAlign),p.blocks.splice(v,1,b),s.push(b)}}})),(0,n.normalizeContentModel)(e),i.length>0}},982:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adjustSegmentSelection=void 0;var o=r(4781);t.adjustSegmentSelection=function(e,t,r){var n,a,i=(0,o.getSelectedParagraphs)(e),l=!1;return i.forEach((function(e){var o=n?0:e.segments.findIndex((function(e){return t(e)})),i=e.segments;if(!n){n=i[o];for(var s=o;s>0;s--){if(!r(i[s-1],n)){l=l||!!i[s-1].isSelected;break}n=i[s-1],l=l||!i[s-1].isSelected}}if(n)for(s=o;s<e.segments.length;s++){if(s!=o&&!r(i[s],a||i[o])){l=l||!!i[s].isSelected;break}a=i[s],l=l||!i[s].isSelected}})),n&&a&&(0,o.setSelection)(e,n,a),l}},4829:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adjustTrailingSpaceSelection=void 0;var o=r(7582),n=r(8871),a=r(4781);function i(e){return e.isSelected&&(t=e.text).trimRight()!==t&&!function(e){return 0==e.trimRight().length}(e.text);var t}function l(e,t){var r,a=t.text.trimRight(),i=t.text.substring(a.length),l=(0,n.createText)(a,t.format,t.link,t.code);l.isSelected=!0;var s=t.link?(0,o.__assign)((0,o.__assign)({},t.link),{format:(0,o.__assign)((0,o.__assign)({},null===(r=t.link)||void 0===r?void 0:r.format),{underline:!1})}):void 0,c=(0,n.createText)(i,void 0,s,t.code);c.isSelected=!0;var d=e.segments.indexOf(t);e.segments.splice(d,1,l,c)}t.adjustTrailingSpaceSelection=function(e){(0,a.iterateSelections)(e,(function(e,t,r,o){if("Paragraph"===(null==r?void 0:r.blockType)&&o&&o.length>0)if(1===o.length&&"Text"===o[0].segmentType&&i(o[0]))l(r,o[0]);else{var n="SelectionMarker"===o[o.length-1].segmentType?o[o.length-2]:o[o.length-1];n&&"Text"===n.segmentType&&i(n)&&l(r,n)}return!1}))}},2737:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adjustWordSelection=void 0;var o=r(7582),n=r(8871),a=r(4781);function i(e,t){var r=e.text,o=-1;if(t)for(var n=0;n<r.length;n++){var i=r[n];if((0,a.isPunctuation)(i)||(0,a.isSpace)(i)){o=n;break}}else for(n=r.length-1;n>=0;n--)if(i=r[n],(0,a.isPunctuation)(i)||(0,a.isSpace)(i)){o=n+1;break}return o}function l(e,t,r,o){var a=t.text,i=(0,n.createText)(a.substring(0,o),t.format,t.link,t.code),l=(0,n.createText)(a.substring(o,a.length),t.format,t.link,t.code);e.splice(r,1,i,l)}t.adjustWordSelection=function(e,t){var r;(0,a.iterateSelections)(e,(function(e,o,n,a){return"Paragraph"==(null==n?void 0:n.blockType)&&1==(null==a?void 0:a.length)&&a[0]==t&&(r=n),!0}));var n=r?(0,o.__spreadArray)([],(0,o.__read)(r.segments),!1):void 0;if(n&&r){for(var s=[],c=n.indexOf(t),d=c-1;d>=0&&"Text"==(u=n[d]).segmentType;d--){if((f=i(u,!1))>-1){if(f==u.text.length)break;l(n,u,d,f),s.push(n[d+1]);break}s.push(n[d])}if(c=n.indexOf(t),s.push(t),s.length<=1)return s;for(d=c+1;d<n.length;d++){var u,f;if("Text"!=(u=n[d]).segmentType)break;if((f=i(u,!0))>-1){if(0==f)break;l(n,u,d,f),s.push(n[d]);break}s.push(n[d])}return s[s.length-1]==t?[t]:(r.segments=n,s)}return[t]}},2483:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.collapseTableSelection=void 0;var o=r(8871);t.collapseTableSelection=function(e,t){var r,n=t.firstColumn,a=null===(r=e[t.firstRow])||void 0===r?void 0:r.cells[n];a&&(0,o.addSegment)(a,(0,o.createSelectionMarker)())}},8108:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.alignTable=void 0,t.alignTable=function(e,t){e.format.marginLeft="alignLeft"==t?"":"auto",e.format.marginRight="alignRight"==t?"":"auto",delete e.cachedElement}},7298:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.alignTableCellVertically=t.alignTableCellHorizontally=void 0;var o=r(4781),n={alignCellLeft:"start",alignCellCenter:"center",alignCellRight:"end"},a={alignCellTop:"top",alignCellMiddle:"middle",alignCellBottom:"bottom"};function i(e,t){var r,n=(0,o.getSelectedCells)(e);if(n)for(var a=n.firstRow;a<=n.lastRow;a++)for(var i=n.firstColumn;i<=n.lastColumn;i++){var l=null===(r=e.rows[a])||void 0===r?void 0:r.cells[i];(null==l?void 0:l.format)&&(delete l.cachedElement,t(l),l.blocks.forEach((function(e){"Paragraph"===e.blockType&&delete e.format.textAlign})))}}t.alignTableCellHorizontally=function(e,t){i(e,(function(e){e.format.textAlign=n[t]}))},t.alignTableCellVertically=function(e,t){i(e,(function(e){e.format.verticalAlign=a[t],(0,o.updateTableCellMetadata)(e,(function(e){return(e=e||{}).vAlignOverride=!0,e}))}))}},1690:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.canMergeCells=void 0,t.canMergeCells=function(e,t,r,o,n){var a=r==n||e[t].cells.every((function(e,t){return t<r||t>n||!e.spanAbove})),i=t==o||e.every((function(e,n){return n<t||n>o||!e.cells[r].spanLeft})),l=e[o].cells.map((function(t,a){return a>=r&&a<=n?function(e,t,r){for(var o,n,a=0,i=t+1;i<e.length&&(null===(n=null===(o=e[i])||void 0===o?void 0:o.cells[r])||void 0===n?void 0:n.spanAbove);i++)a++;return a}(e,o,a):-1})).every((function(e,t,o){return e<0||e==o[r]})),s=e.map((function(r,a){return a>=t&&a<=o?function(e,t,r){for(var o,n,a,i=0,l=r+1;l<(null===(o=e[t])||void 0===o?void 0:o.cells.length)&&(null===(a=null===(n=e[t])||void 0===n?void 0:n.cells[l])||void 0===a?void 0:a.spanLeft);l++)i++;return i}(e,a,n):-1})).every((function(e,r,o){return e<0||e==o[t]}));return a&&i&&l&&s}},7140:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearSelectedCells=void 0;var o=r(4781);t.clearSelectedCells=function(e,t){if(t.firstColumn>=0&&t.firstRow>=0&&t.lastColumn<e.widths.length&&t.lastRow<e.rows.length)for(var r=t.firstRow;r<=t.lastRow;r++)for(var n=e.rows[r],a=t.firstColumn;a<=t.lastColumn;a++){var i=n.cells[a];i.isSelected=!1,(0,o.setSelection)(i)}}},8046:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTableStructure=void 0;var o=r(8871);t.createTableStructure=function(e,t,r){var n=(0,o.createTable)(r);return(0,o.addBlock)(e,n),n.rows.forEach((function(e){for(var r=0;r<t;r++){var n=(0,o.createTableCell)();e.cells.push(n)}})),n}},3465:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTable=void 0,t.deleteTable=function(e){e.rows=[],delete e.cachedElement}},4794:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTableColumn=void 0;var o=r(2483),n=r(4781);t.deleteTableColumn=function(e){var t=(0,n.getSelectedCells)(e);if(t){for(var r=0;r<e.rows.length;r++){var a=e.rows[r].cells[t.lastColumn+1];a&&(a.spanLeft=a.spanLeft&&e.rows[r].cells[t.firstColumn].spanLeft),e.rows[r].cells.splice(t.firstColumn,t.lastColumn-t.firstColumn+1)}e.widths.splice(t.firstColumn,t.lastColumn-t.firstColumn+1),(0,o.collapseTableSelection)(e.rows,t)}}},5078:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTableRow=void 0;var o=r(2483),n=r(4781);t.deleteTableRow=function(e){var t=(0,n.getSelectedCells)(e);t&&(e.rows[t.firstRow].cells.forEach((function(r,o){var n,a=null===(n=e.rows[t.lastRow+1])||void 0===n?void 0:n.cells[o];a&&(a.spanAbove=a.spanAbove&&r.spanAbove)})),e.rows.splice(t.firstRow,t.lastRow-t.firstRow+1),(0,o.collapseTableSelection)(e.rows,t))}},597:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ensureFocusableParagraphForTable=void 0;var o=r(8871);function n(e){var t=(0,o.createParagraph)(!1,void 0,e.format),r=(0,o.createBr)(e.format);return t.segments.push(r),t}t.ensureFocusableParagraphForTable=function(e,t,r){var o,a,i,l=null===(o=r.rows.filter((function(e){return e.cells.length>0}))[0])||void 0===o?void 0:o.cells[0];if(l)(i=l.blocks.filter((function(e){return"Paragraph"==e.blockType}))[0])||(i=n(e),l.blocks.push(i));else{var s,c=r;for(i=n(e);s=t.shift();){var d=null!==(a=s.blocks.indexOf(c))&&void 0!==a?a:-1;if(s&&d>=0&&s.blocks.splice(d,1,i),"FormatContainer"!=s.blockGroupType||1!=s.blocks.length||s.blocks[0]!=i)break;c=s}}return i}},9281:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.insertTableColumn=void 0;var o=r(7140),n=r(8871),a=r(4781);t.insertTableColumn=function(e,t){var r=(0,a.getSelectedCells)(e),i="insertLeft"==t;if(r){(0,o.clearSelectedCells)(e,r);for(var l=null==r?void 0:r.firstColumn;l<=r.lastColumn;l++)e.rows.forEach((function(e){var t=e.cells[i?r.firstColumn:r.lastColumn],o=(0,n.createTableCell)(t.spanLeft,t.spanAbove,t.isHeader,t.format,t.dataset);o.isSelected=!0,e.cells.splice(i?r.firstColumn:r.lastColumn+1,0,o)})),e.widths.splice(i?r.firstColumn:r.lastColumn+1,0,e.widths[i?r.firstColumn:r.lastColumn])}}},3353:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.insertTableRow=void 0;var o=r(7582),n=r(7140),a=r(8871),i=r(4781);t.insertTableRow=function(e,t){var r=(0,i.getSelectedCells)(e),l="insertAbove"==t;if(r){(0,n.clearSelectedCells)(e,r);for(var s=r.firstRow;s<=r.lastRow;s++){var c=e.rows[l?r.firstRow:r.lastRow];e.rows.splice(l?r.firstRow:r.lastRow+1,0,{format:(0,o.__assign)({},c.format),cells:c.cells.map((function(e){var t=(0,a.createTableCell)(e.spanLeft,e.spanAbove,e.isHeader,e.format,e.dataset);return t.isSelected=!0,t})),height:c.height})}}}},1254:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableCells=void 0;var o=r(1690),n=r(4781);t.mergeTableCells=function(e){var t=(0,n.getSelectedCells)(e);if(t&&(0,o.canMergeCells)(e.rows,t.firstRow,t.firstColumn,t.lastRow,t.lastColumn))for(var r=t.firstRow;r<=t.lastRow;r++){for(var a=t.firstColumn;a<=t.lastColumn;a++){var i=e.rows[r].cells[a];i&&(i.spanLeft=a>t.firstColumn,i.spanAbove=r>t.firstRow,delete i.cachedElement)}delete e.rows[r].cachedElement}}},8402:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableColumn=void 0;var o=r(1690),n=r(4781);t.mergeTableColumn=function(e,t){var r,a,i,l,s=(0,n.getSelectedCells)(e);if(s){var c="mergeLeft"==t?s.firstColumn:s.lastColumn+1;if(c>0&&c<e.rows[0].cells.length)for(var d=s.firstRow;d<=s.lastRow;d++){var u=null===(r=e.rows[d])||void 0===r?void 0:r.cells[c];if(u&&(0,o.canMergeCells)(e.rows,d,c-1,d,c)){u.spanLeft=!0;for(var f=c;null===(i=null===(a=e.rows[d])||void 0===a?void 0:a.cells[f])||void 0===i?void 0:i.spanLeft;)delete e.rows[d].cells[f].cachedElement,f--;(null===(l=e.rows[d])||void 0===l?void 0:l.cells[f])&&(e.rows[d].cells[f].isSelected=!0,delete e.rows[d].cells[f].cachedElement),delete u.cachedElement}delete e.rows[d].cachedElement}}}},2447:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableRow=void 0;var o=r(1690),n=r(4781);t.mergeTableRow=function(e,t){var r,a,i,l=(0,n.getSelectedCells)(e);if(l){var s="mergeAbove"==t?l.firstRow:l.lastRow+1;if(s>0&&s<e.rows.length)for(var c=l.firstColumn;c<=l.lastColumn;c++){var d=e.rows[s].cells[c];if(d&&(0,o.canMergeCells)(e.rows,s-1,c,s,c)){d.spanAbove=!0;for(var u=s;null===(a=null===(r=e.rows[u])||void 0===r?void 0:r.cells[c])||void 0===a?void 0:a.spanAbove;)delete e.rows[u].cells[c].cachedElement,delete e.rows[u].cachedElement,u--;(null===(i=e.rows[u])||void 0===i?void 0:i.cells[c])&&(e.rows[u].cells[c].isSelected=!0,delete e.rows[u].cells[c].cachedElement,delete e.rows[u].cachedElement),delete d.cachedElement}}}}},9052:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.splitTableCellHorizontally=void 0;var o=r(7582),n=r(8871),a=r(4781);t.splitTableCellHorizontally=function(e){var t=(0,a.getSelectedCells)(e);if(t)for(var r=function(r){if(e.rows.every((function(e,o){var n;return o<t.firstRow||o>t.lastRow||(null===(n=e.cells[r+1])||void 0===n?void 0:n.spanLeft)})))e.rows.forEach((function(e,o){delete e.cells[r].cachedElement,o>=t.firstRow&&o<=t.lastRow&&(e.cells[r+1].spanLeft=!1,delete e.cells[r+1].cachedElement)}));else{e.rows.forEach((function(e,a){var i=e.cells[r];if(i){var l=(0,n.createTableCell)(i.spanLeft,i.spanAbove,i.isHeader,i.format);l.dataset=(0,o.__assign)({},i.dataset),a<t.firstRow||a>t.lastRow?l.spanLeft=!0:l.isSelected=i.isSelected,e.cells.splice(r+1,0,l),delete e.cells[r].cachedElement}}));var a=Math.max(e.widths[r]/2,30);e.widths.splice(r,1,a,a)}},i=t.lastColumn;i>=t.firstColumn;i--)r(i)}},1286:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.splitTableCellVertically=void 0;var o=r(7582),n=r(8871),a=r(4781);t.splitTableCellVertically=function(e){var t=(0,a.getSelectedCells)(e);if(t)for(var r=t.lastRow;r>=t.firstRow;r--){var i=e.rows[r],l=e.rows[r+1];if(i.cells.forEach((function(e){delete e.cachedElement})),delete i.cachedElement,null==l?void 0:l.cells.every((function(e,r){return r<t.firstColumn||r>t.lastColumn||e.spanAbove})))l.cells.forEach((function(e,r){r>=t.firstColumn&&r<=t.lastColumn&&(e.spanAbove=!1,delete e.cachedElement)})),delete l.cachedElement;else{var s=Math.max(i.height/=2,22),c={format:(0,o.__assign)({},i.format),height:s,cells:i.cells.map((function(e,r){var a=(0,n.createTableCell)(e.spanLeft,e.spanAbove,e.isHeader,e.format);return a.dataset=(0,o.__assign)({},e.dataset),r<t.firstColumn||r>t.lastColumn?a.spanAbove=!0:a.isSelected=e.isSelected,a}))};i.height=s,e.rows.splice(r+1,0,c)}}}},2993:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setAlignment=void 0;var o=r(1230);t.setAlignment=function(e,t){e.focus(),e.formatContentModel((function(e){return(0,o.setModelAlignment)(e,t)}),{apiName:"setAlignment"})}},6763:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setDirection=void 0;var o=r(7444);t.setDirection=function(e,t){e.focus(),e.formatContentModel((function(e){return(0,o.setModelDirection)(e,t)}),{apiName:"setDirection"})}},9762:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setHeadingLevel=void 0;var o=r(4890),n={h1:"2em",h2:"1.5em",h3:"1.17em",h4:"1em",h5:"0.83em",h6:"0.67em"};t.setHeadingLevel=function(e,t){e.focus(),(0,o.formatParagraphWithContentModel)(e,"setHeadingLevel",(function(e){var r,o,a,i=t>0?"h"+t:(o=(null==(r=e.decorator)?void 0:r.tagName)||"",(a=parseInt(o.substring(1)))>=1&&a<=6?o:null);t>0?(e.decorator={tagName:i,format:i?{fontWeight:"bold",fontSize:n[i]}:{}},e.segments.forEach((function(e){delete e.format.fontSize,delete e.format.fontWeight}))):i&&delete e.decorator}))}},8474:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setIndentation=void 0;var o=r(8871),n=r(8722);t.setIndentation=function(e,t,r){e.focus(),e.formatContentModel((function(e,a){var i=(0,n.setModelIndentation)(e,t,r);return i&&(0,o.normalizeContentModel)(e),a.newPendingFormat="preserve",i}),{apiName:"setIndentation"})}},5787:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setParagraphMargin=void 0;var o=r(8871),n=r(4890);t.setParagraphMargin=function(e,t,r){e.focus(),(0,n.formatParagraphWithContentModel)(e,"setParagraphMargin",(function(e){e.decorator||(e.decorator=(0,o.createParagraphDecorator)("p")),t?e.format.marginTop=t:null===t&&delete e.format.marginTop,r?e.format.marginBottom=r:null===r&&delete e.format.marginBottom}))}},8492:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setSpacing=void 0;var o=r(4890);t.setSpacing=function(e,t){e.focus(),(0,o.formatParagraphWithContentModel)(e,"setSpacing",(function(e){e.format.lineHeight=t.toString(),e.segments.forEach((function(e){e.format.lineHeight&&delete e.format.lineHeight}))}))}},2815:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleBlockQuote=void 0;var o=r(7582),n=r(9611),a={borderLeft:"3px solid rgb(200, 200, 200)",textColor:"rgb(102, 102, 102)"},i={borderRight:"3px solid rgb(200, 200, 200)",textColor:"rgb(102, 102, 102)"},l={marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"};t.toggleBlockQuote=function(e,t,r){var s,c=(0,o.__assign)((0,o.__assign)((0,o.__assign)({},l),{paddingLeft:"10px"}),null!=t?t:a),d=(0,o.__assign)((0,o.__assign)((0,o.__assign)({},l),{paddingRight:"10px",direction:"rtl"}),null!==(s=null!=r?r:t)&&void 0!==s?s:i);e.focus(),e.formatContentModel((function(e,t){return t.newPendingFormat="preserve",(0,n.toggleModelBlockQuote)(e,c,d)}),{apiName:"toggleBlockQuote"})}},1323:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.insertEntity=void 0;var o=r(4781),n=r(4247),a=r(8871);t.insertEntity=function(e,t,r,i,l){var s=l||{},c=s.contentNode,d=s.focusAfterEntity,u=s.wrapperDisplay,f=s.skipUndoSnapshot,p=s.initialEntityState,m=e.getDocument().createElement(r?"div":"span"),v=null!=u?u:r?void 0:"inline-block";m.style.setProperty("display",v||null),null==v&&r&&(m.style.setProperty("width","100%"),m.style.setProperty("display","inline-block")),c&&m.appendChild(c);var g=(0,a.createEntity)(m,!0,void 0,t);if(f||e.takeSnapshot(),e.formatContentModel((function(e,t){return(0,n.insertEntityModel)(e,g,"string"==typeof i?i:"focus",r,d,t),(0,a.normalizeContentModel)(e),t.skipUndoSnapshot=!0,t.newEntities.push(g),!0}),{selectionOverride:"object"==typeof i?i:void 0,changeSource:o.ChangeSource.InsertEntity,getChangeData:function(){return{wrapper:m,type:t,id:"",isReadonly:!0}},apiName:"insertEntity"}),!f){var h=void 0;if(p){var b=(0,a.parseEntityFormat)(m),y=b.id,S=b.entityType;h=y&&S?{id:y,type:S,state:p}:void 0}e.takeSnapshot(h)}return g}},7637:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearFormat=void 0;var o=r(4789),n=r(8871);t.clearFormat=function(e){e.focus(),e.formatContentModel((function(e){var t=[],r=[],a=[];return(0,o.clearModelFormat)(e,t,r,a),(0,n.normalizeContentModel)(e),t.length>0||r.length>0||a.length>0}),{apiName:"clearFormat"})}},2509:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFormatState=void 0;var o=r(4781);t.getFormatState=function(e){var t=e.getPendingFormat(),r=e.getContentModelCopy("reduced"),n=e.getSnapshotsManager(),a={canUndo:n.hasNewContent||n.canMove(-1),canRedo:n.canMove(1),isDarkMode:e.isDarkMode()};return(0,o.retrieveModelFormatState)(r,t,a),a}},3775:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adjustImageSelection=void 0;var o=r(982);t.adjustImageSelection=function(e){var t=null;return e.formatContentModel((function(e){return(0,o.adjustSegmentSelection)(e,(function(e){return!(!e.isSelected||"Image"!=e.segmentType||(t=e,0))}),(function(e,t){return e==t}))}),{apiName:"adjustImageSelection"}),t}},6758:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeImage=void 0;var o=r(3152),n=r(4781);t.changeImage=function(e,t){e.focus();var r=e.getDOMSelection();(0,n.readFile)(t,(function(t){t&&!e.isDisposed()&&"image"===(null==r?void 0:r.type)&&(0,o.formatImageWithContentModel)(e,"changeImage",(function(o){var a,i,l=null!==(i=null===(a=(0,n.updateImageMetadata)(o))||void 0===a?void 0:a.src)&&void 0!==i?i:"",s=o.src;o.src=t,o.dataset={},o.format.width="",o.format.height="",o.alt="",e.triggerEvent("editImage",{image:r.image,previousSrc:s,newSrc:t,originalSrc:l})}))}))}},2549:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.insertImage=void 0;var o=r(8871),n=r(4781);function a(e,t){e.formatContentModel((function(e,r){var a=(0,o.createImage)(t,{backgroundColor:""}),i=(0,o.createContentModelDocument)();return(0,o.addSegment)(i,a),(0,n.mergeModel)(e,i,r,{mergeFormat:"mergeAll"}),!0}),{apiName:"insertImage"})}t.insertImage=function(e,t){e.focus(),"string"==typeof t?a(e,t):(0,n.readFile)(t,(function(t){t&&!e.isDisposed()&&a(e,t)}))}},5040:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setImageAltText=void 0;var o=r(3152);t.setImageAltText=function(e,t){e.focus(),(0,o.formatImageWithContentModel)(e,"setImageAltText",(function(e){e.alt=t}))}},9782:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setImageBorder=void 0;var o=r(3446),n=r(3152);t.setImageBorder=function(e,t,r){e.focus(),(0,n.formatImageWithContentModel)(e,"setImageBorder",(function(e){(0,o.applyImageBorderFormat)(e,t,r)}))}},7017:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setImageBoxShadow=void 0;var o=r(3152);t.setImageBoxShadow=function(e,t,r){e.focus(),(0,o.formatImageWithContentModel)(e,"setImageBoxShadow",(function(e){e.format.boxShadow=t,r?(e.format.marginBottom=r,e.format.marginLeft=r,e.format.marginRight=r,e.format.marginTop=r):null===r&&(delete e.format.marginBottom,delete e.format.marginLeft,delete e.format.marginRight,delete e.format.marginTop)}))}},3657:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adjustLinkSelection=void 0;var o=r(982),n=r(2737),a=r(4781);t.adjustLinkSelection=function(e){var t="",r=null;return e.formatContentModel((function(e){var i,l,s=(0,o.adjustSegmentSelection)(e,(function(e){return!!e.isSelected&&!!e.link}),(function(e,t){return!!e.link&&e.link.format.href==t.link.format.href})),c=(0,a.getSelectedSegments)(e,!1),d=c[0];return 1==c.length&&"SelectionMarker"==d.segmentType&&(c=(0,n.adjustWordSelection)(e,d)).length>1&&(s=!0,(0,a.setSelection)(e,c[0],c[c.length-1])),t=c.map((function(e){return"Text"==e.segmentType?e.text:""})).join(""),r=(null===(l=null===(i=c[0])||void 0===i?void 0:i.link)||void 0===l?void 0:l.format.href)||null,s}),{apiName:"adjustLinkSelection"}),[t,r]}},5854:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.insertLink=void 0;var o=r(7582),n=r(4829),a=r(4781),i=r(6089),l=r(8871),s=/^[a-zA-Z]+:/i,c=/^[\w.%+-]+@/i,d=/^ftp\./i;t.insertLink=function(e,t,r,f,p){e.focus();var m=(function(e){return e.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?"":e}(t)||"").trim();if(m){var v,g=(0,i.matchLink)(m),h=g?g.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(s)<0&&(t=0==e.search(c)?"mailto:":0==e.search(d)?"ftp://":"http://"),t+e}(m),b=[];e.formatContentModel((function(t,i){var s,c=(0,a.getSelectedSegments)(t,!1),d=c.map((function(e){return"Text"==e.segmentType?e.text:""})).join(""),v=f||d||"";if(c.some((function(e){return"SelectionMarker"!=e.segmentType}))&&d==v)c.forEach((function(e){var t=u(h,r,p,"Text"==e.segmentType);(0,l.addLink)(e,t),e.link&&b.push(e.link)}));else if(c.every((function(e){return"SelectionMarker"==e.segmentType}))||v&&v!=d){var y=(0,l.createText)(v||(g?g.originalUrl:m),(0,o.__assign)((0,o.__assign)({},null===(s=c[0])||void 0===s?void 0:s.format),e.getPendingFormat())),S=(0,l.createContentModelDocument)(),C=u(h,r,p);(0,l.addLink)(y,C),(0,l.addSegment)(S,y),y.link&&b.push(y.link),(0,a.mergeModel)(t,S,i,{mergeFormat:"mergeAll"})}return(0,n.adjustTrailingSpaceSelection)(t),c.length>0}),{changeSource:a.ChangeSource.CreateLink,onNodeCreated:function(e,t){!v&&b.indexOf(e)>=0&&(v=t)},getChangeData:function(){return v},apiName:"insertLink"})}};var u=function(e,t,r,o){return void 0===o&&(o=!0),{dataset:{},format:{href:e,anchorTitle:t,target:r,underline:o}}}},5972:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeLink=void 0;var o=r(982),n=r(4781);t.removeLink=function(e){e.focus(),e.formatContentModel((function(e){(0,o.adjustSegmentSelection)(e,(function(e){return!!e.isSelected&&!!e.link}),(function(e,t){return e.isSelected||!!e.link&&e.link.format.href==t.link.format.href}));var t=(0,n.getSelectedSegments)(e,!1),r=!1;return t.forEach((function(e){e.link&&(r=!0,delete e.link)})),r}),{apiName:"removeLink"})}},6916:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setListStartNumber=void 0;var o=r(4781);t.setListStartNumber=function(e,t){e.focus(),e.formatContentModel((function(e){var r=(0,o.getFirstSelectedListItem)(e),n=null==r?void 0:r.levels[(null==r?void 0:r.levels.length)-1];return!!n&&(n.format.startNumberOverride=t,!0)}),{apiName:"setListStartNumber"})}},8907:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setListStyle=void 0;var o=r(4514),n=r(4781);t.setListStyle=function(e,t){e.focus(),e.formatContentModel((function(e){var r=(0,n.getFirstSelectedListItem)(e);if(r){var a=(0,o.findListItemsInSameThread)(e,r),i=r.levels.length-1;return a.forEach((function(e){var r=e.levels[i];r&&(0,n.updateListMetadata)(r,(function(e){return Object.assign({},e,t)}))})),!0}return!1}),{apiName:"setListStyle"})}},7655:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleBullet=void 0;var o=r(9689);t.toggleBullet=function(e,t){void 0===t&&(t=!1),e.focus(),e.formatContentModel((function(e,r){return r.newPendingFormat="preserve",(0,o.setListType)(e,"UL",t)}),{apiName:"toggleBullet"})}},6320:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleNumbering=void 0;var o=r(9689);t.toggleNumbering=function(e,t){void 0===t&&(t=!1),e.focus(),e.formatContentModel((function(e,r){return r.newPendingFormat="preserve",(0,o.setListType)(e,"OL",t)}),{apiName:"toggleNumbering"})}},1089:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applySegmentFormat=void 0;var o=r(6648);t.applySegmentFormat=function(e,t){(0,o.formatSegmentWithContentModel)(e,"applySegmentFormat",(function(e){e.backgroundColor=t.backgroundColor,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontWeight=t.fontWeight,e.italic=t.italic,e.strikethrough=t.strikethrough,e.superOrSubScriptSequence=t.superOrSubScriptSequence,e.textColor=t.textColor,e.underline=t.underline}),void 0,!0)}},3870:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeCapitalization=void 0;var o=r(6648);t.changeCapitalization=function(e,t,r){e.focus(),(0,o.formatSegmentWithContentModel)(e,"changeCapitalization",(function(e,o,n){if("Text"==(null==n?void 0:n.segmentType))switch(t){case"lowerCase":n.text=n.text.toLocaleLowerCase(r);break;case"upperCase":n.text=n.text.toLocaleUpperCase(r);break;case"capitalize":for(var a=n.text.toLocaleLowerCase(r).split(" "),i=0;i<a.length;i++)a[i]=a[i].charAt(0).toLocaleUpperCase(r)+a[i].slice(1);n.text=a.join(" ");break;case"sentence":var l=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");n.text=n.text.toLocaleLowerCase(r).replace(l,(function(e){return e.toLocaleUpperCase(r)}))}}))}},6385:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeFontSize=void 0;var o=r(6648),n=r(8871),a=r(9316),i=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];t.changeFontSize=function(e,t){e.focus(),(0,o.formatSegmentWithContentModel)(e,"changeFontSize",(function(e,r,o,l){return function(e,t,r){if(t.fontSize){var o=(0,n.parseValueWithUnit)(t.fontSize,void 0,"pt");if(o>0){var l=function(e,t,r){e=1==t?Math.floor(e):Math.ceil(e);var o=r[r.length-1];if(e<=r[0])e=Math.max(e+t,1);else if(e>o||e==o&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),o),1e3);else if(1==t){for(var n=0;n<r.length;n++)if(e<r[n]){e=r[n];break}}else for(n=r.length-1;n>=0;n--)if(e>r[n]){e=r[n];break}return e}(o,"increase"==e?1:-1,i);(0,a.setFontSizeInternal)(l+"pt",t,r)}}}(t,e,l)}),void 0,!0)}},5707:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setBackgroundColor=void 0;var o=r(8871),n=r(6648),a=r(4781);t.setBackgroundColor=function(e,t){e.focus();var r=null,i=-1;(0,n.formatSegmentWithContentModel)(e,"setBackgroundColor",(function(e,o,n,a){null===t?delete e.backgroundColor:e.backgroundColor=t,n&&a&&"SelectionMarker"!=n.segmentType&&(i=(r=a).segments.indexOf(n))}),void 0,void 0,(function(e){var t;if(r&&i>=0){var n=(0,o.createSelectionMarker)(null===(t=r.segments[i])||void 0===t?void 0:t.format);r.segments.splice(i+1,0,n),(0,a.setSelection)(e,n,n)}}))}},8151:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setFontName=void 0;var o=r(6648);t.setFontName=function(e,t){e.focus(),(0,o.formatSegmentWithContentModel)(e,"setFontName",(function(e,r,o){e.fontFamily=t,(null==o?void 0:o.code)&&(o.code.format.fontFamily=t)}),void 0,!0)}},9316:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setFontSizeInternal=t.setFontSize=void 0;var o=r(6648);function n(e,t,r){var o;if(t.fontSize=e,null===(o=null==r?void 0:r.segmentFormat)||void 0===o?void 0:o.fontSize){var n=r.segmentFormat.fontSize;r.segments.forEach((function(e){e.format.fontSize||(e.format.fontSize=n)})),delete r.segmentFormat.fontSize}}t.setFontSize=function(e,t){e.focus(),(0,o.formatSegmentWithContentModel)(e,"setFontSize",(function(e,r,o,a){return n(t,e,a)}),void 0,!0)},t.setFontSizeInternal=n},6268:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setTextColor=void 0;var o=r(6648);t.setTextColor=function(e,t){e.focus(),(0,o.formatSegmentWithContentModel)(e,"setTextColor",null===t?function(e,t,r){delete e.textColor,(null==r?void 0:r.link)&&delete r.link.format.textColor}:function(e,r,o){e.textColor=t,(null==o?void 0:o.link)&&(o.link.format.textColor=t)},void 0,!0)}},9176:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleBold=void 0;var o=r(6648),n=r(4781);t.toggleBold=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleBold",(function(e,t){e.fontWeight=t?"bold":"normal"}),(function(e,t,r){var o;return(0,n.isBold)(void 0===e.fontWeight?null===(o=null==r?void 0:r.decorator)||void 0===o?void 0:o.format.fontWeight:e.fontWeight)}))}},7311:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleCode=void 0;var o=r(8871),n=r(6648),a={format:{fontFamily:"monospace"}};t.toggleCode=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleCode",(function(e,t,r){r&&(t?(0,o.addCode)(r,a):delete r.code)}),(function(e,t){return!!(null==t?void 0:t.code)}))}},6053:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleItalic=void 0;var o=r(6648);t.toggleItalic=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleItalic",(function(e,t){e.italic=!!t}),(function(e){return!!e.italic}))}},8398:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleStrikethrough=void 0;var o=r(6648);t.toggleStrikethrough=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleStrikethrough",(function(e,t){e.strikethrough=!!t}),(function(e){return!!e.strikethrough}))}},8356:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleSubscript=void 0;var o=r(6648);t.toggleSubscript=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleSubscript",(function(e,t){e.superOrSubScriptSequence=t?"sub":""}),(function(e){var t;return"sub"==(null===(t=e.superOrSubScriptSequence)||void 0===t?void 0:t.split(" ").pop())}))}},79:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleSuperscript=void 0;var o=r(6648);t.toggleSuperscript=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleSuperscript",(function(e,t){e.superOrSubScriptSequence=t?"super":""}),(function(e){var t;return"super"==(null===(t=e.superOrSubScriptSequence)||void 0===t?void 0:t.split(" ").pop())}))}},1538:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleUnderline=void 0;var o=r(4829),n=r(6648);t.toggleUnderline=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleUnderline",(function(e,t,r){e.underline=!!t,(null==r?void 0:r.link)&&(r.link.format.underline=!!t)}),(function(e,t){var r,o;return!!e.underline||!!(null===(o=null===(r=null==t?void 0:t.link)||void 0===r?void 0:r.format)||void 0===o?void 0:o.underline)}),!1,o.adjustTrailingSpaceSelection)}},7290:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyTableBorderFormat=void 0;var o=r(7582),n=r(8871),a=r(4781);function i(e,t,r){r.forEach((function(r){e.format[r]=t})),(0,a.updateTableCellMetadata)(e,(function(e){return(e=e||{}).borderOverride=!0,e})),delete e.cachedElement}t.applyTableBorderFormat=function(e,t,r){e.formatContentModel((function(e){var l=(0,o.__read)((0,a.getFirstSelectedTable)(e),1)[0];if(l){var s=(0,a.getSelectedCells)(l),c={Top:!1,Bottom:!1,Left:!1,Right:!1},d="",u=l.format,f=t.width,p=t.style,m=t.color,v=(0,a.extractBorderValues)(u.borderTop),g=v.color,h=v.width,b=v.style;d=f?(0,n.parseValueWithUnit)(f)+"px":h||"1px",p?d=d+" "+p:b?d=d+" "+b:d+=" solid",m?d=d+" "+m:g&&(d=d+" "+g);var y="rtl"==l.format.direction;if(s){for(var S=[r];S.length;)switch(S.pop()){case"noBorders":d="",S.push("allBorders");break;case"allBorders":for(var C=["borderTop","borderBottom","borderLeft","borderRight"],_=s.firstRow;_<=s.lastRow;_++)for(var T=s.firstColumn;T<=s.lastColumn;T++)i(l.rows[_].cells[T],d,C);c.Top=!0,c.Bottom=!0,c.Left=!0,c.Right=!0;break;case"leftBorders":var E=["borderLeft"];for(_=s.firstRow;_<=s.lastRow;_++)i(l.rows[_].cells[y?s.lastColumn:s.firstColumn],d,E);y?c.Right=!0:c.Left=!0;break;case"rightBorders":var k=["borderRight"];for(_=s.firstRow;_<=s.lastRow;_++)i(l.rows[_].cells[y?s.firstColumn:s.lastColumn],d,k);y?c.Left=!0:c.Right=!0;break;case"topBorders":var M=["borderTop"];for(T=s.firstColumn;T<=s.lastColumn;T++)i(l.rows[s.firstRow].cells[T],d,M);c.Top=!0;break;case"bottomBorders":var P=["borderBottom"];for(T=s.firstColumn;T<=s.lastColumn;T++)i(l.rows[s.lastRow].cells[T],d,P);c.Bottom=!0;break;case"insideBorders":var O=s.lastColumn==s.firstColumn,w=s.lastRow==s.firstRow;if(O&&w)break;if(O){for(i(l.rows[s.firstRow].cells[s.firstColumn],d,["borderBottom"]),_=s.firstRow+1;_<=s.lastRow-1;_++)i(l.rows[_].cells[s.firstColumn],d,["borderTop","borderBottom"]);i(l.rows[s.lastRow].cells[s.firstColumn],d,["borderTop"]);break}if(w){for(i(l.rows[s.firstRow].cells[y?s.lastColumn:s.firstColumn],d,["borderRight"]),T=s.firstColumn+1;T<=s.lastColumn-1;T++)i(l.rows[s.firstRow].cells[T],d,["borderLeft","borderRight"]);i(l.rows[s.firstRow].cells[y?s.firstColumn:s.lastColumn],d,["borderLeft"]);break}for(i(l.rows[s.firstRow].cells[y?s.lastColumn:s.firstColumn],d,["borderBottom","borderRight"]),i(l.rows[s.firstRow].cells[y?s.firstColumn:s.lastColumn],d,["borderBottom","borderLeft"]),i(l.rows[s.lastRow].cells[y?s.lastColumn:s.firstColumn],d,["borderTop","borderRight"]),i(l.rows[s.lastRow].cells[y?s.firstColumn:s.lastColumn],d,["borderTop","borderLeft"]),T=s.firstColumn+1;T<s.lastColumn;T++)i(l.rows[s.firstRow].cells[T],d,["borderBottom","borderLeft","borderRight"]);for(T=s.firstColumn+1;T<s.lastColumn;T++)i(l.rows[s.lastRow].cells[T],d,["borderTop","borderLeft","borderRight"]);for(_=s.firstRow+1;_<s.lastRow;_++)i(l.rows[_].cells[s.firstColumn],d,["borderTop","borderBottom",y?"borderLeft":"borderRight"]);for(_=s.firstRow+1;_<s.lastRow;_++)i(l.rows[_].cells[s.lastColumn],d,["borderTop","borderBottom",y?"borderRight":"borderLeft"]);s.firstColumn++,s.firstRow++,s.lastColumn--,s.lastRow--,S.push("allBorders");break;case"outsideBorders":S.push("topBorders"),S.push("bottomBorders"),S.push("leftBorders"),S.push("rightBorders")}!function(e,t,r,o,n){if(o.Top&&t.firstRow-1>=0)for(var a=t.firstColumn;a<=t.lastColumn;a++)i(e.rows[t.firstRow-1].cells[a],r,["borderBottom"]);if(o.Bottom&&t.lastRow+1<e.rows.length)for(a=t.firstColumn;a<=t.lastColumn;a++)i(e.rows[t.lastRow+1].cells[a],r,["borderTop"]);if(o.Left&&t.firstColumn-1>=0)for(var l=t.firstRow;l<=t.lastRow;l++)i(e.rows[l].cells[t.firstColumn-1],r,[n?"borderLeft":"borderRight"]);if(o.Right&&t.lastColumn+1<e.rows[0].cells.length)for(l=t.firstRow;l<=t.lastRow;l++)i(e.rows[l].cells[t.lastColumn+1],r,[n?"borderRight":"borderLeft"])}(l,s,d,c,y)}return!0}return!1}),{apiName:"tableBorder"})}},5325:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editTable=void 0;var o=r(8108),n=r(3465),a=r(4794),i=r(5078),l=r(821),s=r(9281),c=r(3353),d=r(1254),u=r(8402),f=r(2447),p=r(9052),m=r(1286),v=r(7298);t.editTable=function(e,t){e.focus(),(0,l.formatTableWithContentModel)(e,"editTable",(function(e){switch(t){case"alignCellLeft":case"alignCellCenter":case"alignCellRight":(0,v.alignTableCellHorizontally)(e,t);break;case"alignCellTop":case"alignCellMiddle":case"alignCellBottom":(0,v.alignTableCellVertically)(e,t);break;case"alignCenter":case"alignLeft":case"alignRight":(0,o.alignTable)(e,t);break;case"deleteColumn":(0,a.deleteTableColumn)(e);break;case"deleteRow":(0,i.deleteTableRow)(e);break;case"deleteTable":(0,n.deleteTable)(e);break;case"insertAbove":case"insertBelow":(0,c.insertTableRow)(e,t);break;case"insertLeft":case"insertRight":(0,s.insertTableColumn)(e,t);break;case"mergeAbove":case"mergeBelow":(0,f.mergeTableRow)(e,t);break;case"mergeCells":(0,d.mergeTableCells)(e);break;case"mergeLeft":case"mergeRight":(0,u.mergeTableColumn)(e,t);break;case"splitHorizontally":(0,p.splitTableCellHorizontally)(e);break;case"splitVertically":(0,m.splitTableCellVertically)(e)}}))}},5844:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatTable=void 0;var o=r(7582),n=r(4781);t.formatTable=function(e,t,r){e.focus(),e.formatContentModel((function(e){var a=(0,o.__read)((0,n.getFirstSelectedTable)(e),1)[0];return!!a&&(a.rows.forEach((function(e){e.cells.forEach((function(e){(0,n.updateTableCellMetadata)(e,(function(e){return e&&delete e.borderOverride,e}))}))})),(0,n.applyTableFormat)(a,t,r),!0)}),{apiName:"formatTable"})}},113:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.insertTable=void 0;var o=r(8871),n=r(8046),a=r(4781);t.insertTable=function(e,t,r,i){e.focus(),e.formatContentModel((function(l,s){var c,d,u,f=(0,a.deleteSelection)(l,[],s).insertPoint;if(f){var p=(0,o.createContentModelDocument)(),m=(0,n.createTableStructure)(p,t,r);(0,a.normalizeTable)(m,e.getPendingFormat()||f.marker.format),i=i||{verticalAlign:"top"},(0,a.applyTableFormat)(m,i),(0,a.mergeModel)(l,p,s,{insertPosition:f,mergeFormat:"mergeAll"});var v=null===(d=null===(c=m.rows[0])||void 0===c?void 0:c.cells[0])||void 0===d?void 0:d.blocks[0];if("Paragraph"==(null==v?void 0:v.blockType)){var g=(0,o.createSelectionMarker)(null===(u=v.segments[0])||void 0===u?void 0:u.format);v.segments.unshift(g),(0,a.setSelection)(l,g)}return!0}return!1}),{apiName:"insertTable"})}},9587:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setTableCellShade=void 0;var o=r(7582),n=r(4781);t.setTableCellShade=function(e,t){e.focus(),e.formatContentModel((function(e){var r=(0,o.__read)((0,n.getFirstSelectedTable)(e),1)[0];return!!r&&((0,n.normalizeTable)(r),r.rows.forEach((function(e){return e.cells.forEach((function(e){(0,n.hasSelectionInBlockGroup)(e)&&(0,n.setTableCellBackgroundColor)(e,t,!0)}))})),!0)}),{apiName:"setTableCellShade"})}},3152:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatImageWithContentModel=void 0;var o=r(6648);t.formatImageWithContentModel=function(e,t,r){(0,o.formatSegmentWithContentModel)(e,t,(function(e,t,o){"Image"==(null==o?void 0:o.segmentType)&&r(o)}),void 0,void 0)}},4890:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatParagraphWithContentModel=void 0;var o=r(4781);t.formatParagraphWithContentModel=function(e,t,r){e.formatContentModel((function(e,t){var n=(0,o.getSelectedParagraphs)(e);return n.forEach(r),t.newPendingFormat="preserve",n.length>0}),{apiName:t})}},6648:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatSegmentWithContentModel=void 0;var o=r(7582),n=r(2737),a=r(4781);t.formatSegmentWithContentModel=function(e,t,r,i,l,s){e.formatContentModel((function(t,c){var d=(0,a.getSelectedSegmentsAndParagraphs)(t,!!l),u=1==d.length&&"SelectionMarker"==d[0][0].segmentType;if(u){var f=d[0][1];(d=(0,n.adjustWordSelection)(t,d[0][0]).map((function(e){return[e,f]}))).length>1&&(u=!1)}var p=d.map((function(e){return[e[0].format,e[0],e[1]]})),m=!!i&&p.every((function(e){var t=(0,o.__read)(e,3),r=t[0],n=t[1],a=t[2];return i(r,n,a)}));return p.forEach((function(e){var t=(0,o.__read)(e,3),n=t[0],a=t[1],i=t[2];return r(n,!m,a,i)})),null==s||s(t),u?(c.newPendingFormat=d[0][0].format,e.focus(),!1):p.length>0}),{apiName:t})}},821:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatTableWithContentModel=void 0;var o=r(7582),n=r(597),a=r(8871),i=r(4781);t.formatTableWithContentModel=function(e,t,r,l){e.formatContentModel((function(e){var t=(0,o.__read)((0,i.getFirstSelectedTable)(e),2),l=t[0],s=t[1];if(l){if(r(l),!(0,i.hasSelectionInBlock)(l)){var c=(0,n.ensureFocusableParagraphForTable)(e,s,l);if(c){var d=(0,a.createSelectionMarker)(e.format);c.segments.unshift(d),(0,a.setParagraphNotImplicit)(c),(0,i.setSelection)(e,d)}}return(0,i.normalizeTable)(l,e.format),(0,a.hasMetadata)(l)&&(0,i.applyTableFormat)(l,void 0,!0),!0}return!1}),{apiName:t,selectionOverride:l})}},7585:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BulletListType=void 0,t.BulletListType={Min:1,Disc:1,Dash:2,Square:3,ShortArrow:4,LongArrow:5,UnfilledArrow:6,Hyphen:7,DoubleLongArrow:8,Circle:9,Max:9}},8667:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeSource=void 0,t.ChangeSource={AutoLink:"AutoLink",CreateLink:"CreateLink",Format:"Format",ImageResize:"ImageResize",Paste:"Paste",SetContent:"SetContent",Cut:"Cut",Drop:"Drop",InsertEntity:"InsertEntity",SwitchToDarkMode:"SwitchToDarkMode",SwitchToLightMode:"SwitchToLightMode",ListChain:"ListChain",Keyboard:"Keyboard"}},2948:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NumberingListType=void 0,t.NumberingListType={Min:1,Decimal:1,DecimalDash:2,DecimalParenthesis:3,DecimalDoubleParenthesis:4,LowerAlpha:5,LowerAlphaParenthesis:6,LowerAlphaDoubleParenthesis:7,LowerAlphaDash:8,UpperAlpha:9,UpperAlphaParenthesis:10,UpperAlphaDoubleParenthesis:11,UpperAlphaDash:12,LowerRoman:13,LowerRomanParenthesis:14,LowerRomanDoubleParenthesis:15,LowerRomanDash:16,UpperRoman:17,UpperRomanParenthesis:18,UpperRomanDoubleParenthesis:19,UpperRomanDash:20,Max:20}},8028:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TableBorderFormat=void 0,t.TableBorderFormat={Min:0,Default:0,ListWithSideBorders:1,NoHeaderBorders:2,NoSideBorders:3,FirstColumnHeaderExternal:4,EspecialType1:5,EspecialType2:6,EspecialType3:7,Clear:8,Max:8}},145:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addUndoSnapshot=void 0;var o=r(8871),n=r(3731),a=r(6906);t.addUndoSnapshot=function(e,t,r){var i=e.lifecycle,l=e.physicalRoot,s=e.logicalRoot,c=e.undo,d=null;if(!i.shadowEditFragment){var u=(0,n.createSnapshotSelection)(e),f=l.innerHTML;if(s!==l){var p=(0,o.findClosestEntityWrapper)(s,e.domHelper);if(!r&&p){var m=(0,o.parseEntityFormat)(p);if(m.entityType&&m.id){var v={eventType:"entityOperation",operation:"snapshotEntityState",entity:{type:m.entityType,id:m.id,wrapper:p,isReadonly:m.isReadonly},state:void 0};e.api.triggerEvent(e,v,!1),v.state&&(r=[{type:m.entityType,id:m.id,state:v.state}])}}}d={html:f,entityStates:r,isDarkMode:!!i.isDarkMode,selection:u},s!==l&&(d.logicalRootPath=(0,a.getPath)(s,0,l)),c.snapshotsManager.addSnapshot(d,!!t),c.snapshotsManager.hasNewContent=!1}return d}},3731:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSnapshotSelection=void 0;var o=r(8871),n=r(6906);function a(e,t){for(var r=e,n=!1;r&&t.contains(r);)(0,o.isNodeOfType)(r,"ELEMENT_NODE")&&(0,o.isElementOfType)(r,"table")&&(n=i(r)||n),r=r.parentNode;return n}function i(e){for(var t,r=!1,n=null,a=e.firstChild;a;a=a.nextSibling)switch((0,o.isNodeOfType)(a,"ELEMENT_NODE")?a.tagName:null){case"TR":n||(n=e.ownerDocument.createElement("tbody"),e.insertBefore(n,a)),n.appendChild(a),a=n,r=!0;break;case"TBODY":n?((0,o.moveChildNodes)(n,a,!0),null===(t=a.parentNode)||void 0===t||t.removeChild(a),a=n,r=!0):n=a;break;default:n=null}var i=e.querySelectorAll("colgroup"),l=e.querySelector("thead");return l&&i.forEach((function(e){l.contains(e)||l.appendChild(e)})),r}t.createSnapshotSelection=function(e){var t=e.physicalRoot,r=e.api,o=r.getDOMSelection(e);if("range"==(null==o?void 0:o.type)){var i=o.range,l=i.startContainer,s=i.startOffset,c=i.endContainer,d=i.endOffset,u=a(l,t);if(c!=l&&(u=a(c,t)||u),u){var f=t.ownerDocument.createRange();f.setStart(l,s),f.setEnd(c,d),r.setDOMSelection(e,{type:"range",range:f,isReverted:!!o.isReverted},!0)}}switch(null==o?void 0:o.type){case"image":return{type:"image",imageId:o.image.id};case"table":return{type:"table",tableId:o.table.id,firstColumn:o.firstColumn,lastColumn:o.lastColumn,firstRow:o.firstRow,lastRow:o.lastRow};case"range":var p=o.range;return{type:"range",start:(0,n.getPath)(p.startContainer,p.startOffset,t),end:(0,n.getPath)(p.endContainer,p.endOffset,t),isReverted:!!o.isReverted};default:return{type:"range",start:[],end:[],isReverted:!1}}}},6906:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPath=void 0;var o=r(8871);t.getPath=function(e,t,r){var n,a,i,l=[];if(!e||!r.contains(e))return l;if((0,o.isNodeOfType)(e,"TEXT_NODE")){for(i=e.parentNode;e.previousSibling&&(0,o.isNodeOfType)(e.previousSibling,"TEXT_NODE");)t+=(null===(n=e.previousSibling.nodeValue)||void 0===n?void 0:n.length)||0,e=e.previousSibling;l.unshift(t)}else i=e,e=e.childNodes[t];do{t=0;for(var s=!1,c=(null==i?void 0:i.firstChild)||null;c&&c!=e;c=c.nextSibling){if((0,o.isNodeOfType)(c,"TEXT_NODE")){if(0===(null===(a=c.nodeValue)||void 0===a?void 0:a.length)||s)continue;s=!0}else s=!1;t++}l.unshift(t),e=i,i=(null==i?void 0:i.parentNode)||null}while(e&&e!=r);return l}},8819:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.attachDomEvent=void 0;var o=r(8871);t.attachDomEvent=function(e,t){var r=(0,o.getObjectKeys)(t||{}).map((function(r){var o=t[r],n=o.pluginEventType,a=o.beforeDispatch,i=r,l=function(t){a&&a(t),null!=n&&e.api.triggerEvent(e,{eventType:n,rawEvent:t},!1)};return e.logicalRoot.addEventListener(i,l),function(){e.logicalRoot.removeEventListener(i,l)}}));return function(){return r.forEach((function(e){return e()}))}}},4810:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.coreApiMap=void 0;var o=r(145),n=r(8819),a=r(8296),i=r(9470),l=r(5090),s=r(9633),c=r(8109),d=r(8680),u=r(2394),f=r(636),p=r(6276),m=r(4368),v=r(4895),g=r(4488),h=r(1863);t.coreApiMap={createContentModel:a.createContentModel,createEditorContext:i.createEditorContext,formatContentModel:s.formatContentModel,setContentModel:f.setContentModel,setLogicalRoot:v.setLogicalRoot,getDOMSelection:c.getDOMSelection,setDOMSelection:p.setDOMSelection,focus:l.focus,addUndoSnapshot:o.addUndoSnapshot,restoreUndoSnapshot:u.restoreUndoSnapshot,attachDomEvent:n.attachDomEvent,triggerEvent:h.triggerEvent,switchShadowEdit:g.switchShadowEdit,getVisibleViewport:d.getVisibleViewport,setEditorStyle:m.setEditorStyle}},8296:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModel=void 0;var o=r(464),n=r(8871);t.createContentModel=function(e,t,r){var a;null===(a=e.cache.textMutationObserver)||void 0===a||a.flushMutations();var i=r?null:e.cache.cachedModel;if(i&&e.lifecycle.shadowEditFragment&&(i=(0,o.cloneModel)(i,{includeCachedElement:!0})),i)return i;var l="none"==r?void 0:r||e.api.getDOMSelection(e)||void 0,s=!t&&!r,c=e.api.createEditorContext(e,s),d=e.environment.domToModelSettings,u=t?(0,n.createDomToModelContext)(c,d.builtIn,d.customized,t):(0,n.createDomToModelContextWithConfig)(d.calculated,c),f=(0,n.domToContentModel)(e.logicalRoot,u,l);return s&&(e.cache.cachedModel=f,e.cache.cachedSelection=l),f}},9470:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEditorContext=void 0;var o=r(7582),n=r(4370);t.createEditorContext=function(e,t){var r,a=e.lifecycle,i=e.format,l=e.darkColorHandler,s=e.logicalRoot,c=e.cache,d=e.domHelper,u=(0,o.__assign)({isDarkMode:a.isDarkMode,defaultFormat:i.defaultFormat,pendingFormat:null!==(r=i.pendingFormat)&&void 0!==r?r:void 0,darkColorHandler:l,addDelimiterForEntity:!0,allowCacheElement:!0,domIndexer:t?c.domIndexer:void 0,zoomScale:d.calculateZoomScale()},(0,n.getRootComputedStyleForContext)(s.ownerDocument));return function(e,t){var r,o=null===(r=null==e?void 0:e.ownerDocument.defaultView)||void 0===r?void 0:r.getComputedStyle(e);"rtl"==(null==o?void 0:o.direction)&&(t.isRootRtl=!0)}(s,u),u}},4370:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRootComputedStyleForContext=void 0;var o=r(8871);t.getRootComputedStyleForContext=function(e){var t,r=null===(t=e.defaultView)||void 0===t?void 0:t.getComputedStyle(e.documentElement);return{rootFontSize:(0,o.parseValueWithUnit)(null==r?void 0:r.fontSize)||16}}},5090:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.focus=void 0,t.focus=function(e){var t;if(!e.lifecycle.shadowEditFragment){var r=e.api,o=e.domHelper,n=e.selection;o.hasFocus()||"range"!=(null===(t=n.selection)||void 0===t?void 0:t.type)||r.setDOMSelection(e,n.selection,!0),o.hasFocus()||e.logicalRoot.focus()}}},9633:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatContentModel=void 0;var o=r(7582),n=r(8667);function a(e,t,r){var n,a="preserve"==t.newPendingFormat?null===(n=e.format.pendingFormat)||void 0===n?void 0:n.format:t.newPendingFormat;a&&"range"==(null==r?void 0:r.type)&&r.range.collapsed&&(e.format.pendingFormat={format:(0,o.__assign)({},a),posContainer:r.range.startContainer,posOffset:r.range.startOffset})}function i(e,t){return e.newEntities.map((function(e){return{entity:e,operation:"newEntity",rawEvent:t}})).concat(e.deletedEntities.map((function(e){return{entity:e.entity,operation:e.operation,rawEvent:t}})))}t.formatContentModel=function(e,t,r){var o,l=r||{},s=l.apiName,c=l.onNodeCreated,d=l.getChangeData,u=l.changeSource,f=l.rawEvent,p=l.selectionOverride,m=e.api.createContentModel(e,void 0,p),v={newEntities:[],deletedEntities:[],rawEvent:f,newImages:[]},g=e.domHelper.hasFocus(),h=t(m,v),b=v.skipUndoSnapshot,y=v.clearModelCache,S=v.entityStates,C=v.canUndoByBackspace;if(h){var _=e.undo.isNested,T=!b&&!_,E=void 0;T&&(e.undo.isNested=!0,e.api.addUndoSnapshot(e,!!C,S));try{!function(e,t){if(t.newImages.length>0){var r=e.api.getVisibleViewport(e);if(r){var o=r.left,n=r.right,a=Math.max(n-o,10);t.newImages.forEach((function(e){e.format.maxWidth=a+"px"}))}}}(e,v),E=null!==(o=e.api.setContentModel(e,m,g?void 0:{ignoreSelection:!0},c))&&void 0!==o?o:void 0,a(e,v,E);var k={eventType:"contentChanged",contentModel:y?void 0:m,selection:y?void 0:E,source:u||n.ChangeSource.Format,data:null==d?void 0:d(),formatApiName:s,changedEntities:i(v,f)};e.api.triggerEvent(e,k,!0),C&&"range"==(null==E?void 0:E.type)&&(e.undo.posContainer=E.range.startContainer,e.undo.posOffset=E.range.startOffset),T?e.api.addUndoSnapshot(e,!1,S):e.undo.snapshotsManager.hasNewContent=!0}finally{_||(e.undo.isNested=!1)}}else y&&(e.cache.cachedModel=void 0,e.cache.cachedSelection=void 0),a(e,v,e.api.getDOMSelection(e))}},8109:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDOMSelection=void 0,t.getDOMSelection=function(e){if(e.lifecycle.shadowEditFragment)return null;var t=e.selection.selection;return!t||"range"==t.type&&e.domHelper.hasFocus()?function(e){var t,r=null===(t=e.logicalRoot.ownerDocument.defaultView)||void 0===t?void 0:t.getSelection(),o=r&&r.rangeCount>0?r.getRangeAt(0):null;return r&&o&&e.logicalRoot.contains(o.commonAncestorContainer)?{type:"range",range:o,isReverted:r.focusNode!=o.endContainer||r.focusOffset!=o.endOffset}:null}(e):t}},8680:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getVisibleViewport=void 0;var o=r(7582),n=r(8871);t.getVisibleViewport=function(e){var t=e.domEvent.scrollContainer;return function(e,t){void 0===t&&(t=[]);var r=e.map((function(e){return(0,n.normalizeRect)(e.getBoundingClientRect())})).concat(t).filter((function(e){return!!e})),a={top:Math.max.apply(Math,(0,o.__spreadArray)([],(0,o.__read)(r.map((function(e){return e.top}))),!1)),bottom:Math.min.apply(Math,(0,o.__spreadArray)([],(0,o.__read)(r.map((function(e){return e.bottom}))),!1)),left:Math.max.apply(Math,(0,o.__spreadArray)([],(0,o.__read)(r.map((function(e){return e.left}))),!1)),right:Math.min.apply(Math,(0,o.__spreadArray)([],(0,o.__read)(r.map((function(e){return e.right}))),!1))};return a.top<a.bottom&&a.left<a.right?a:null}(t==e.physicalRoot?[t]:[t,e.physicalRoot])}},4038:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPositionFromPath=void 0;var o=r(8871);t.getPositionFromPath=function(e,t){for(var r=0,n=0;n<t.length&&(r=t[n],n<t.length-1&&e&&(0,o.isNodeOfType)(e,"ELEMENT_NODE")&&e.childNodes.length>r);n++)e=e.childNodes[r];return{node:e,offset:r}}},5559:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.restoreSnapshotColors=void 0;var o=r(2879);t.restoreSnapshotColors=function(e,t){var r=e.lifecycle.isDarkMode;e.darkColorHandler.updateKnownColor(r),!!t.isDarkMode!=!!r&&(0,o.transformColor)(e.physicalRoot,!1,r?"lightToDark":"darkToLight",e.darkColorHandler)}},9808:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.restoreSnapshotHTML=void 0;var o=r(8871),n="_E_EBlockEntityContainer";function a(e,t){var r=null;return(0,o.isNodeOfType)(t,"ELEMENT_NODE")&&((0,o.isEntityElement)(t)?r=l(e,(0,o.parseEntityFormat)(t).id):i(t)&&(r=function(e,t){for(var r,n=e.firstChild;n;n=n.nextSibling)if((0,o.isEntityElement)(n)&&(0,o.isNodeOfType)(n,"ELEMENT_NODE")){var a=null===(r=l(t,(0,o.parseEntityFormat)(n).id))||void 0===r?void 0:r.parentElement;return(0,o.isNodeOfType)(a,"ELEMENT_NODE")&&i(a)?a:null}return null}(t,e))),r}function i(e){return e.classList.contains(n)}function l(e,t){var r=t?e[t]:void 0;return(null==r?void 0:r.canPersist)?r.element:null}t.restoreSnapshotHTML=function(e,t){for(var r,n,i,l=e.physicalRoot,s=e.entity.entityMap,c=l.firstChild,d=(new DOMParser).parseFromString(null!==(n=null===(r=e.trustedHTMLHandler)||void 0===r?void 0:r.call(e,t.html))&&void 0!==n?n:t.html,"text/html").body.firstChild;d;){var u=d.nextSibling,f=a(s,d);f?c=(0,o.reuseCachedElement)(l,f,c):(l.insertBefore(d,c),(0,o.isNodeOfType)(d,"ELEMENT_NODE")&&(0,o.getAllEntityWrappers)(d).forEach((function(e){var t,r=a(s,e);if(r){if(r==c){var o=r.cloneNode();l.insertBefore(o,c),c=o}null===(t=e.parentNode)||void 0===t||t.replaceChild(r,e)}}))),d=u}for(;c;)u=c.nextSibling,null===(i=c.parentNode)||void 0===i||i.removeChild(c),c=u}},9912:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.restoreSnapshotLogicalRoot=void 0;var o=r(4038);t.restoreSnapshotLogicalRoot=function(e,t){if(t.logicalRootPath&&t.logicalRootPath.length>0){var r=(0,o.getPositionFromPath)(e.physicalRoot,t.logicalRootPath).node;r!==e.logicalRoot&&e.api.setLogicalRoot(e,r)}else e.api.setLogicalRoot(e,null)}},7233:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.restoreSnapshotSelection=void 0;var o=r(4038);t.restoreSnapshotSelection=function(e,t){var r=t.selection,n=e.physicalRoot,a=null;try{if(r)switch(r.type){case"range":var i=(0,o.getPositionFromPath)(n,r.start),l=(0,o.getPositionFromPath)(n,r.end),s=n.ownerDocument.createRange();s.setStart(i.node,i.offset),s.setEnd(l.node,l.offset),a={type:"range",range:s,isReverted:r.isReverted};break;case"table":var c=n.querySelector("#"+r.tableId);c&&(a={type:"table",table:c,firstColumn:r.firstColumn,firstRow:r.firstRow,lastColumn:r.lastColumn,lastRow:r.lastRow});break;case"image":var d=n.querySelector("#"+r.imageId);d&&(a={type:"image",image:d})}a&&e.api.setDOMSelection(e,a)}catch(e){}}},2394:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.restoreUndoSnapshot=void 0;var o=r(8667),n=r(5559),a=r(9808),i=r(9912),l=r(7233);t.restoreUndoSnapshot=function(e,t){e.api.triggerEvent(e,{eventType:"beforeSetContent",newContent:t.html},!0);try{e.undo.isRestoring=!0,(0,a.restoreSnapshotHTML)(e,t),(0,i.restoreSnapshotLogicalRoot)(e,t),(0,l.restoreSnapshotSelection)(e,t),(0,n.restoreSnapshotColors)(e,t);var r={eventType:"contentChanged",entityStates:t.entityStates,source:o.ChangeSource.SetContent};e.api.triggerEvent(e,r,!1)}finally{e.undo.isRestoring=!1}}},636:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setContentModel=void 0;var o=r(8871);t.setContentModel=function(e,t,r,n){var a,i=e.api.createEditorContext(e,!0),l=r?(0,o.createModelToDomContext)(i,e.environment.modelToDomSettings.builtIn,e.environment.modelToDomSettings.customized,r):(0,o.createModelToDomContextWithConfig)(e.environment.modelToDomSettings.calculated,i);l.onNodeCreated=n;var s=(0,o.contentModelToDom)(e.logicalRoot.ownerDocument,e.logicalRoot,t,l);return e.lifecycle.shadowEditFragment||(e.cache.cachedSelection=s||void 0,!(null==r?void 0:r.ignoreSelection)&&s?e.api.setDOMSelection(e,s):e.selection.selection=s,null===(a=e.cache.textMutationObserver)||void 0===a||a.flushMutations(),e.cache.cachedModel=t),s}},3950:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addRangeToSelection=void 0,t.addRangeToSelection=function(e,t,r){var o;void 0===r&&(r=!1);var n=null===(o=e.defaultView)||void 0===o?void 0:o.getSelection();n&&(n.removeAllRanges(),r?n.setBaseAndExtent(t.endContainer,t.endOffset,t.startContainer,t.startOffset):n.addRange(t))}},6276:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setDOMSelection=void 0;var o=r(3950),n=r(9310),a=r(8871),i=r(4399),l="_DOMSelection",s="_DOMSelectionHideCursor",c="caret-color: transparent";function d(e,t){if(t&&e.contains(t)){var r=e.createRange();r.selectNode(t),r.collapse(),(0,o.addRangeToSelection)(e,r)}}t.setDOMSelection=function(e,t,r){var u,f,p,m=e.selection.skipReselectOnFocus,v=e.physicalRoot.ownerDocument;e.selection.skipReselectOnFocus=!0,e.api.setEditorStyle(e,l,null),e.api.setEditorStyle(e,s,null);try{switch(null==t?void 0:t.type){case"image":var g=t.image;e.selection.selection=t,e.api.setEditorStyle(e,l,"outline-style:auto!important; outline-color:"+(e.selection.imageSelectionBorderColor||"#DB626C")+"!important;",["#"+(0,n.ensureUniqueId)(g,"image")]),e.api.setEditorStyle(e,s,c),d(v,g);break;case"table":var h=t.table,b=t.firstColumn,y=t.firstRow,S=t.lastColumn,C=t.lastRow,_=(0,i.parseTableCells)(t.table),T={row:Math.min(y,C),col:Math.min(b,S),cell:null},E={row:Math.max(y,C),col:Math.max(b,S)};if(T=(0,i.findTableCellElement)(_,T)||T,E=(0,i.findLastedCoInMergedCell)(_,E)||E,isNaN(T.row)||isNaN(T.col)||isNaN(E.row)||isNaN(E.col))return;t={type:"table",table:h,firstRow:T.row,firstColumn:T.col,lastRow:E.row,lastColumn:E.col};var k=(0,n.ensureUniqueId)(h,"table"),M=0==T.row&&0==T.col&&E.row==_.length-1&&E.col==(null!==(f=null===(u=_[E.row])||void 0===u?void 0:u.length)&&void 0!==f?f:0)-1?["#"+k,"#"+k+" *"]:function(e,t,r,o,n){var i=[],l=0,s=(0,a.toArray)(r.childNodes).filter((function(e){return["THEAD","TBODY","TFOOT"].indexOf((0,a.isNodeOfType)(e,"ELEMENT_NODE")?e.tagName:"")>-1})).map((function(e){var t={el:e.tagName,start:l,end:e.childNodes.length+l};return l=t.end,t}));return e.forEach((function(e,r){for(var a=0,l=s.filter((function(e){return e.start<=r&&e.end>r}))[0],c=l?">"+l.el+">":">",d=l&&r+1>=l.start?r+1-l.start:r+1,u=0;u<e.length;u++){var f=e[u];if("object"==typeof f&&(a++,r>=o.row&&r<=n.row&&u>=o.col&&u<=n.col)){var p="#"+t+c+" tr:nth-child("+d+")>"+f.tagName+":nth-child("+a+")";i.push(p,p+" *")}}})),i}(_,k,h,T,E);e.selection.selection=t,e.api.setEditorStyle(e,l,"background-color:#C6C6C6!important;",M),e.api.setEditorStyle(e,s,c);var P=(null===(p=T.cell)||void 0===p?void 0:p.firstElementChild)||T.cell;P&&d(v,P||void 0);break;case"range":(0,o.addRangeToSelection)(v,t.range,t.isReverted),e.selection.selection=e.domHelper.hasFocus()?null:t;break;default:e.selection.selection=null}}finally{e.selection.skipReselectOnFocus=m}if(!r){var O={eventType:"selectionChanged",newSelection:t};e.api.triggerEvent(e,O,!0)}}},9310:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ensureUniqueId=void 0,t.ensureUniqueId=function(e,t){t=e.id||t;for(var r=e.ownerDocument,o=0;!e.id||r.querySelectorAll("#"+e.id).length>1;)e.id=t+"_"+o++;return e.id}},4368:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setEditorStyle=void 0;var o=r(9310);t.setEditorStyle=function(e,t,r,n,a){void 0===a&&(a=9e3);var i=e.lifecycle.styleElements[t];if(!i&&r){var l=e.physicalRoot.ownerDocument;i=l.createElement("style"),l.head.appendChild(i),i.dataset.roosterjsStyleKey=t,e.lifecycle.styleElements[t]=i}var s=null==i?void 0:i.sheet;if(s){for(var c=s.cssRules.length-1;c>=0;c--)s.deleteRule(c);if(r){var d="#"+(0,o.ensureUniqueId)(e.physicalRoot,"contentDiv"),u=n?"string"==typeof n?[d+"::"+n]:function(e,t,r){var o=[],n=[],a=0;return t.forEach((function(t){a>=r&&(o.push(n.join(",")),n=[],a=0);var i=e+" "+t;a+=i.length+1,n.push(i)})),o.push(n.join(",")),o}(d,n,a-r.length-3):[d];u.forEach((function(e){s.insertRule(e+" {"+r+"}")}))}}}},4895:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setLogicalRoot=void 0,t.setLogicalRoot=function(e,t){if(t&&!e.physicalRoot.contains(t))return null;if(t||(t=e.physicalRoot),t!==e.logicalRoot){e.logicalRoot.contentEditable="false",t.contentEditable="true",e.logicalRoot=t,e.selection.selection=null,e.cache.cachedModel=void 0,e.cache.cachedSelection=void 0;var r={eventType:"logicalRootChanged",logicalRoot:t};e.api.triggerEvent(e,r,!1)}}},4488:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.switchShadowEdit=void 0;var o=r(3193),n=r(8871);t.switchShadowEdit=function(e,t){var r=e;if(t!=!!r.lifecycle.shadowEditFragment)if(t){var a=r.cache.cachedModel?null:r.api.createContentModel(r),i=r.logicalRoot.ownerDocument.createDocumentFragment(),l=r.logicalRoot.cloneNode(!0);(0,n.moveChildNodes)(i,l),r.api.triggerEvent(r,{eventType:"enteredShadowEdit"},!1),!r.cache.cachedModel&&a&&(r.cache.cachedModel=a),r.lifecycle.shadowEditFragment=i}else r.lifecycle.shadowEditFragment=null,r.api.triggerEvent(r,{eventType:"leavingShadowEdit"},!1),r.cache.cachedModel&&((0,o.iterateSelections)(r.cache.cachedModel,(function(){})),r.api.setContentModel(r,r.cache.cachedModel,{ignoreSelection:!0}))}},1863:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=void 0;var r=["editorReady","beforeDispose","extractContentWithDom","zoomChanged"];t.triggerEvent=function(e,t,o){e.lifecycle.shadowEditFragment&&!(r.indexOf(t.eventType)>=0)||!o&&e.plugins.some((function(e){return function(e,t){var r;return!(!t.onPluginEvent||!(null===(r=t.willHandleEventExclusively)||void 0===r?void 0:r.call(t,e)))&&(t.onPluginEvent(e),!0)}(t,e)}))||e.plugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))}},4388:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createCachePlugin=void 0;var o=r(2597),n=r(7973),a=r(3680),i=function(){function e(e,t){var r=this;this.editor=null,this.onMutation=function(e){r.editor&&(e?r.updateCachedModel(r.editor,!0):r.invalidateCache())},this.onNativeSelectionChange=function(){var e;(null===(e=r.editor)||void 0===e?void 0:e.hasFocus())&&r.updateCachedModel(r.editor)},this.state=e.disableCache?{}:{domIndexer:a.domIndexerImpl,textMutationObserver:(0,n.createTextMutationObserver)(t,this.onMutation)}}return e.prototype.getName=function(){return"Cache"},e.prototype.initialize=function(e){var t;this.editor=e,this.editor.getDocument().addEventListener("selectionchange",this.onNativeSelectionChange),null===(t=this.state.textMutationObserver)||void 0===t||t.startObserving()},e.prototype.dispose=function(){var e;null===(e=this.state.textMutationObserver)||void 0===e||e.stopObserving(),this.editor&&(this.editor.getDocument().removeEventListener("selectionchange",this.onNativeSelectionChange),this.editor=null)},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"keyDown":case"input":this.state.textMutationObserver||this.invalidateCache();break;case"selectionChanged":this.updateCachedModel(this.editor);break;case"contentChanged":var t=e.contentModel,r=e.selection;t&&this.state.domIndexer?(this.state.cachedModel=t,this.state.cachedSelection=r):this.invalidateCache()}},e.prototype.invalidateCache=function(){var e;(null===(e=this.editor)||void 0===e?void 0:e.isInShadowEdit())||(this.state.cachedModel=void 0,this.state.cachedSelection=void 0)},e.prototype.updateCachedModel=function(e,t){var r,n=this.state.cachedSelection;this.state.cachedSelection=void 0;var a=e.getDOMSelection()||void 0,i=this.state.cachedModel;!t&&n&&a&&(0,o.areSameSelection)(a,n)?this.state.cachedSelection=n:i&&a&&(null===(r=this.state.domIndexer)||void 0===r?void 0:r.reconcileSelection(i,a,n))?this.state.cachedSelection=a:this.invalidateCache()},e}();t.createCachePlugin=function(e,t){return new i(e,t)}},2597:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areSameSelection=void 0,t.areSameSelection=function(e,t){if(e==t)return!0;switch(e.type){case"image":return"image"==t.type&&t.image==e.image;case"table":return"table"==t.type&&t.table==e.table&&t.firstColumn==e.firstColumn&&t.lastColumn==e.lastColumn&&t.firstRow==e.firstRow&&t.lastRow==e.lastRow;default:return"range"==t.type&&(r=t.range,o=e.range,!(!r||!o||r.startContainer!=o.startContainer||r.startOffset!=o.startOffset||r.endContainer!=o.endContainer||r.endOffset!=o.endOffset))}var r,o}},3680:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.domIndexerImpl=void 0;var o=r(7582),n=r(8871),a=r(2242);function i(e){var t,r=null!==(t=e.__roosterjsContentModel)&&void 0!==t?t:{},o=r.paragraph,n=r.segments;return o&&"Paragraph"==o.blockType&&Array.isArray(o.segments)&&Array.isArray(n)}function l(e,t,r){e.__roosterjsContentModel={paragraph:t,segments:r}}function s(e,t){return(0,n.isNodeOfType)(e,"TEXT_NODE")?i(e)?d(e,t):void 0:t>=e.childNodes.length?c(e.lastChild,!0):c(e.childNodes[t],!1)}function c(e,t){var r;if(e&&i(e)){var o=e.__roosterjsContentModel,a=o.paragraph,l=o.segments,s=a.segments.indexOf(l[0]);if(s>=0){var c=!t&&a.segments[s-1]||a.segments[s];r=(0,n.createSelectionMarker)(c.format),a.segments.splice(t?s+1:s,0,r)}}return r}function d(e,t,r){var a,i,s=e.__roosterjsContentModel,c=s.paragraph,d=s.segments,u=d[0],f=d[d.length-1];if("Text"==(null==u?void 0:u.segmentType)&&"Text"==(null==f?void 0:f.segmentType)){var p=[],m=e.nodeValue||"",v=[];if(void 0===t)u.text=m,p.push(u),v.push(u);else{if(t>0&&(u.text=m.substring(0,t),p.push(u),v.push(u)),void 0===r){var g=(0,n.createSelectionMarker)(u.format);p.push(g),i=g,r=t}else if(r>t){var h=(0,n.createText)(m.substring(t,r),u.format,u.link,u.code);h.isSelected=!0,p.push(h),v.push(h),i=h}if(r<m.length){var b=(0,n.createText)(m.substring(r),u.format,u.link,u.code);p.push(b),v.push(b)}}var y=c.segments.indexOf(u),S=c.segments.indexOf(f);if(y>=0&&S>=0){for(;y>0&&"SelectionMarker"==c.segments[y-1].segmentType;)y--;for(;S<c.segments.length-1&&"SelectionMarker"==c.segments[S+1].segmentType;)S++;(a=c.segments).splice.apply(a,(0,o.__spreadArray)([y,S-y+1],(0,o.__read)(p),!1))}l(e,c,v),delete c.cachedElement}return i}t.domIndexerImpl={onSegment:l,onParagraph:function e(t){for(var r=null,o=t.firstChild;o;o=o.nextSibling)if((0,n.isNodeOfType)(o,"TEXT_NODE"))if(r){var a=i(r)?r.__roosterjsContentModel:void 0;a&&i(o)&&(a.segments=a.segments.concat(o.__roosterjsContentModel.segments),o.__roosterjsContentModel.segments=[])}else r=o;else(0,n.isNodeOfType)(o,"ELEMENT_NODE")?(r=null,e(o)):r=null},onTable:function(e,t){e.__roosterjsContentModel={tableRows:t.rows}},reconcileSelection:function(e,t,r){switch(r&&("range"==r.type&&r.range.collapsed&&(0,n.isNodeOfType)(r.range.startContainer,"TEXT_NODE")?i(r.range.startContainer)&&d(r.range.startContainer):(0,a.setSelection)(e)),t.type){case"image":case"table":return!1;case"range":var o=t.range;if(o){var l=o.startContainer,c=o.startOffset,u=o.endContainer,f=o.endOffset;if(o.collapsed)return!!s(l,c);if(l==u&&(0,n.isNodeOfType)(l,"TEXT_NODE"))return i(l)&&!!d(l,c,f);var p=s(l,c),m=s(u,f);return!(!p||!m||((0,a.setSelection)(e,p,m),0))}}return!1}}},7973:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTextMutationObserver=void 0;var r=function(){function e(e,t){var r=this;this.contentDiv=e,this.onMutation=t,this.onMutationInternal=function(e){var t,o=null===(t=e[0])||void 0===t?void 0:t.target;if(o){var n=e.every((function(e){return"characterData"==e.type&&e.target==o}));r.onMutation(n)}},this.observer=new MutationObserver(this.onMutationInternal)}return e.prototype.startObserving=function(){this.observer.observe(this.contentDiv,{subtree:!0,childList:!0,attributes:!0,characterData:!0})},e.prototype.stopObserving=function(){this.observer.disconnect()},e.prototype.flushMutations=function(){var e=this.observer.takeRecords();this.onMutationInternal(e)},e}();t.createTextMutationObserver=function(e,t){return new r(e,t)}},6222:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createContextMenuPlugin=void 0;var o=r(7582),n=r(7309),a=function(){function e(e){var t,r=this;this.editor=null,this.disposer=null,this.onContextMenuEvent=function(e){var t;if(r.editor){var n=[],a=e,i=2==a.button?a.target:r.getFocusedNode(r.editor);i&&r.state.contextMenuProviders.forEach((function(e){var t,r=null!==(t=e.getContextMenuItems(i))&&void 0!==t?t:[];(null==r?void 0:r.length)>0&&(n.length>0&&n.push(null),n.push.apply(n,(0,o.__spreadArray)([],(0,o.__read)(r),!1)))})),null===(t=r.editor)||void 0===t||t.triggerEvent("contextMenu",{rawEvent:a,items:n})}},this.state={contextMenuProviders:(null===(t=e.plugins)||void 0===t?void 0:t.filter(i))||[]}}return e.prototype.getName=function(){return"ContextMenu"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.attachDomEvent({contextmenu:{beforeDispatch:this.onContextMenuEvent}})},e.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.getFocusedNode=function(e){var t=e.getDOMSelection();return t?("range"==t.type&&t.range.collapse(!0),(0,n.getSelectionRootNode)(t)||null):null},e}();function i(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.getContextMenuItems)}t.createContextMenuPlugin=function(e){return new a(e)}},1465:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createCopyPastePlugin=t.preprocessTable=t.onNodeCreated=t.adjustSelectionForCopyCut=void 0;var o=r(7582),n=r(3950),a=r(8667),i=r(2943),l=r(4470),s=r(230),c=r(2266),d=r(3193),u=r(3311),f=r(2717),p=r(8871),m=function(){function e(e){var t=this;this.editor=null,this.disposer=null,this.onPaste=function(e){if(t.editor&&function(e){return!!e.clipboardData}(e)){var r=t.editor,o=e.clipboardData;(null==o?void 0:o.items)&&(e.preventDefault(),(0,s.extractClipboardItems)((0,p.toArray)(o.items),t.state.allowedCustomPasteType).then((function(e){r.isDisposed()||(0,f.paste)(r,e,t.state.defaultPasteType)})))}},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[],tempDiv:null,defaultPasteType:e.defaultPasteType}}return e.prototype.getName=function(){return"CopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.attachDomEvent({paste:{beforeDispatch:function(e){return t.onPaste(e)}},copy:{beforeDispatch:function(e){return t.onCutCopy(e,!1)}},cut:{beforeDispatch:function(e){return t.onCutCopy(e,!0)}}})},e.prototype.dispose=function(){var e;this.state.tempDiv&&(null===(e=this.state.tempDiv.parentNode)||void 0===e||e.removeChild(this.state.tempDiv),this.state.tempDiv=null),this.disposer&&this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onCutCopy=function(e,r){var o,s=this;if(this.editor){var c=this.editor.getDocument(),u=this.editor.getDOMSelection();if(u&&("range"!=u.type||!u.range.collapsed)){var f=this.editor.getContentModelCopy("disconnected");"table"===u.type?(0,d.iterateSelections)(f,(function(e,t){return!!(null==t?void 0:t.table)&&(h(t.table),!0)})):"range"===u.type&&v(f);var m=this.getTempDiv(this.editor.getDocument()),b=(0,p.createModelToDomContext)();b.onNodeCreated=t.onNodeCreated;var y=(0,p.contentModelToDom)(m.ownerDocument,m,f,b),S=y?function(e,t){var r,o=null;if("table"===t.type){var n=t.table,a=1==(null===(r=n.parentElement)||void 0===r?void 0:r.childElementCount)?n.parentElement:n;(o=e.createRange()).selectNode(a)}else"image"===t.type?(o=e.createRange()).selectNode(t.image):o=t.range;return o}(c,y):null;S?((S=this.editor.triggerEvent("beforeCutCopy",{clonedRoot:m,range:S,rawEvent:e,isCut:r}).range)&&(0,n.addRangeToSelection)(c,S),null===(o=c.defaultView)||void 0===o||o.requestAnimationFrame((function(){s.editor&&(g(m),s.editor.focus(),s.editor.setDOMSelection(u),r&&s.editor.formatContentModel((function(e,t){return"range"==(0,l.deleteSelection)(e,[i.deleteEmptyList],t).deleteResult&&(0,p.normalizeContentModel)(e),!0}),{apiName:"cut",changeSource:a.ChangeSource.Cut}))}))):g(m)}}},e.prototype.getTempDiv=function(e){if(!this.state.tempDiv){var t=e.createElement("div");t.style.width="600px",t.style.height="1px",t.style.overflow="hidden",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.userSelect="text",t.contentEditable="true",e.body.appendChild(t),this.state.tempDiv=t}var r=this.state.tempDiv;return r.style.backgroundColor="white",r.style.color="black",r.childNodes.forEach((function(e){return r.removeChild(e)})),r.style.display="",r.focus(),r},e}();function v(e){var t,r,o;(0,d.iterateSelections)(e,(function(e,n,a,i){if(t)return n!=o&&(null==r?void 0:r.segments.includes(t))&&r.segments.splice(r.segments.indexOf(t),1),!0;var l=null==i?void 0:i.find((function(e){return"SelectionMarker"==e.segmentType}));return!t&&l&&(o=n,r="Paragraph"==(null==a?void 0:a.blockType)?a:void 0,t=l),!1}))}function g(e){e.style.backgroundColor="",e.style.color="",e.style.display="none",(0,p.moveChildNodes)(e)}function h(e){var t=(0,c.getSelectedCells)(e);e.rows=e.rows.map((function(e){return(0,o.__assign)((0,o.__assign)({},e),{cells:e.cells.filter((function(e){return e.isSelected}))})})).filter((function(e){return e.cells.length>0})),delete e.format.width,e.widths=t?e.widths.filter((function(e,r){return r>=(null==t?void 0:t.firstColumn)&&r<=(null==t?void 0:t.lastColumn)})):[]}t.adjustSelectionForCopyCut=v,t.onNodeCreated=function(e,t){(0,p.isNodeOfType)(t,"ELEMENT_NODE")&&(0,p.isElementOfType)(t,"table")&&(0,p.wrap)(t.ownerDocument,t,"div"),(0,p.isNodeOfType)(t,"ELEMENT_NODE")&&!t.isContentEditable&&t.removeAttribute("contenteditable"),(0,u.onCreateCopyEntityNode)(e,t)},t.preprocessTable=h,t.createCopyPastePlugin=function(e){return new m(e)}},2943:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteEmptyList=void 0;var o=r(5513),n=r(9764),a=r(4298);function i(e){return e&&"Paragraph"==e.blockType?e.segments.every((function(e){return"SelectionMarker"!==e.segmentType&&"Br"==e.segmentType})):e&&"BlockGroup"==e.blockType?e.blocks.every(i):!!e}t.deleteEmptyList=function(e){var t=e.insertPoint;if("range"==e.deleteResult&&(null==t?void 0:t.path)){var r=(0,o.getClosestAncestorBlockGroupIndex)(t.path,["ListItem"],["TableCell"]),l=t.path[r];if(r>=0&&l&&"ListItem"==l.blockGroupType){var s=t.path[r+1].blocks.indexOf(l),c=s>-1?t.path[r+1].blocks[s-1]:void 0,d=s>-1?t.path[r+1].blocks[s+1]:void 0;(0,a.hasSelectionInBlockGroup)(l)&&(!c||(0,n.hasSelectionInBlock)(c))&&d&&i(d)&&(l.levels=[])}}}},9785:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEditorCorePlugins=void 0;var o=r(4388),n=r(6222),a=r(1465),i=r(5947),l=r(9514),s=r(8283),c=r(2933),d=r(535),u=r(9465);t.createEditorCorePlugins=function(e,t){return{cache:(0,o.createCachePlugin)(e,t),format:(0,s.createFormatPlugin)(e),copyPaste:(0,a.createCopyPastePlugin)(e),domEvent:(0,i.createDOMEventPlugin)(e,t),lifecycle:(0,c.createLifecyclePlugin)(e,t),entity:(0,l.createEntityPlugin)(),selection:(0,d.createSelectionPlugin)(e),contextMenu:(0,n.createContextMenuPlugin)(e),undo:(0,u.createUndoPlugin)(e)}}},5947:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDOMEventPlugin=void 0;var o=r(8667),n=r(7416),a=r(8871),i={keydown:"keyDown",keyup:"keyUp",keypress:"keyPress"},l=function(){function e(e,t){var r=this;this.editor=null,this.disposer=null,this.onDragStart=function(e){var t=e,r=t.target,o=(0,a.isNodeOfType)(r,"ELEMENT_NODE")?r:r.parentElement;o&&!o.isContentEditable&&t.preventDefault()},this.onDrop=function(){var e,t,n=null===(e=r.editor)||void 0===e?void 0:e.getDocument();null===(t=null==n?void 0:n.defaultView)||void 0===t||t.requestAnimationFrame((function(){r.editor&&(r.editor.takeSnapshot(),r.editor.triggerEvent("contentChanged",{source:o.ChangeSource.Drop}))}))},this.onScroll=function(e){var t;null===(t=r.editor)||void 0===t||t.triggerEvent("scroll",{rawEvent:e,scrollContainer:r.state.scrollContainer})},this.keyboardEventHandler={beforeDispatch:function(e){var t=i[e.type];((0,n.isCharacterValue)(e)||(0,n.isCursorMovingKey)(e))&&e.stopPropagation(),r.editor&&t&&!e.isComposing&&!r.state.isInIME&&r.editor.triggerEvent(t,{rawEvent:e})}},this.inputEventHandler={beforeDispatch:function(e){e.stopPropagation(),!r.editor||e.isComposing||r.state.isInIME||r.editor.triggerEvent("input",{rawEvent:e})}},this.onMouseDown=function(e){r.editor&&(r.state.mouseUpEventListerAdded||(r.editor.getDocument().addEventListener("mouseup",r.onMouseUp,!0),r.state.mouseUpEventListerAdded=!0,r.state.mouseDownX=e.pageX,r.state.mouseDownY=e.pageY),r.editor.triggerEvent("mouseDown",{rawEvent:e}))},this.onMouseUp=function(e){r.editor&&(r.removeMouseUpEventListener(),r.editor.triggerEvent("mouseUp",{rawEvent:e,isClicking:r.state.mouseDownX==e.pageX&&r.state.mouseDownY==e.pageY}))},this.onCompositionStart=function(){r.state.isInIME=!0},this.onCompositionEnd=function(e){var t;r.state.isInIME=!1,null===(t=r.editor)||void 0===t||t.triggerEvent("compositionEnd",{rawEvent:e})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,mouseDownX:null,mouseDownY:null,mouseUpEventListerAdded:!1}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,r;this.editor=e;var o=this.editor.getDocument(),n={keypress:this.keyboardEventHandler,keydown:this.keyboardEventHandler,keyup:this.keyboardEventHandler,input:this.inputEventHandler,mousedown:{beforeDispatch:this.onMouseDown},compositionstart:{beforeDispatch:this.onCompositionStart},compositionend:{beforeDispatch:this.onCompositionEnd},dragstart:{beforeDispatch:this.onDragStart},drop:{beforeDispatch:this.onDrop}};this.disposer=this.editor.attachDomEvent(n),this.state.scrollContainer.addEventListener("scroll",this.onScroll),null===(t=o.defaultView)||void 0===t||t.addEventListener("scroll",this.onScroll),null===(r=o.defaultView)||void 0===r||r.addEventListener("resize",this.onScroll)},e.prototype.dispose=function(){var e,t,r,o;this.removeMouseUpEventListener();var n=null===(e=this.editor)||void 0===e?void 0:e.getDocument();null===(t=null==n?void 0:n.defaultView)||void 0===t||t.removeEventListener("resize",this.onScroll),null===(r=null==n?void 0:n.defaultView)||void 0===r||r.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),null===(o=this.disposer)||void 0===o||o.call(this),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.removeMouseUpEventListener=function(){this.editor&&this.state.mouseUpEventListerAdded&&(this.state.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.createDOMEventPlugin=function(e,t){return new l(e,t)}},9514:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEntityPlugin=void 0;var o=r(1964),n=r(2879),a=r(8871),i=r(9617),l=/_(\d{1,8})$/,s=function(){function e(){this.editor=null,this.state={entityMap:{}}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.state.entityMap={}},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"mouseUp":this.handleMouseUpEvent(this.editor,e);break;case"contentChanged":this.handleContentChangedEvent(this.editor,e);break;case"keyDown":(0,i.handleDelimiterKeyDownEvent)(this.editor,e);break;case"compositionEnd":(0,i.handleCompositionEndEvent)(this.editor,e);break;case"editorReady":this.handleContentChangedEvent(this.editor);break;case"extractContentWithDom":this.handleExtractContentWithDomEvent(this.editor,e.clonedRoot)}},e.prototype.handleMouseUpEvent=function(e,t){var r=t.rawEvent,o=t.isClicking,n=r.target;if(o&&this.editor)for(;n&&this.editor.getDOMHelper().isNodeInEditor(n);){if((0,a.isEntityElement)(n)){this.triggerEvent(e,n,"click",r);break}n=n.parentNode}},e.prototype.handleContentChangedEvent=function(e,t){var r,o=this,l=null!==(r=null==t?void 0:t.changedEntities)&&void 0!==r?r:this.getChangedEntities(e),s=null==t?void 0:t.entityStates;l.forEach((function(t){var r=t.entity,i=t.operation,l=t.rawEvent,s=r.entityFormat,c=s.id,d=s.entityType,u=s.isFakeEntity,f=r.wrapper;if(d&&!u)if("newEntity"==i){r.entityFormat.id=o.ensureUniqueId(d,null!=c?c:"",f),f.className=(0,a.generateEntityClassNames)(r.entityFormat),r.entityFormat.isReadonly&&(f.contentEditable="false");var p=o.triggerEvent(e,f,i,l);o.state.entityMap[r.entityFormat.id]={element:f,canPersist:null==p?void 0:p.shouldPersist},e.isDarkMode()&&(0,n.transformColor)(f,!0,"lightToDark",e.getColorManager())}else if(c){var m=o.state.entityMap[c];m&&(m.isDeleted=!0),o.triggerEvent(e,f,i,l)}})),null==s||s.forEach((function(t){var r,n=t.id,a=t.state,i=null===(r=o.state.entityMap[n])||void 0===r?void 0:r.element;i&&o.triggerEvent(e,i,"updateEntityState",void 0,a)})),(0,i.handleDelimiterContentChangedEvent)(e)},e.prototype.getChangedEntities=function(e){var t=this,r=[];return e.formatContentModel((function(e){return(0,o.findAllEntities)(e,r),!1})),(0,a.getObjectKeys)(this.state.entityMap).forEach((function(e){var o=t.state.entityMap[e];if(!o.isDeleted){var n=r.findIndex((function(t){return"newEntity"==t.operation&&t.entity.entityFormat.id==e&&t.entity.wrapper==o.element}));if(n>=0)r.splice(n,1);else{var i=(0,a.parseEntityFormat)(o.element);if(!i.isFakeEntity){var l=(0,a.createEntity)(o.element,i.isReadonly,{},i.entityType,i.id);r.push({entity:l,operation:"overwrite"})}}}})),r},e.prototype.handleExtractContentWithDomEvent=function(e,t){var r=this;(0,a.getAllEntityWrappers)(t).forEach((function(t){t.removeAttribute("contentEditable"),r.triggerEvent(e,t,"replaceTemporaryContent")}))},e.prototype.triggerEvent=function(e,t,r,o,n){var i=(0,a.parseEntityFormat)(t);return i.id&&i.entityType&&!i.isFakeEntity?e.triggerEvent("entityOperation",{operation:r,rawEvent:o,entity:{id:i.id,type:i.entityType,isReadonly:!!i.isReadonly,wrapper:t},state:"updateEntityState"==r?n:void 0,shouldPersist:"newEntity"==r||void 0}):null},e.prototype.ensureUniqueId=function(e,t,r){for(var o=l.exec(t),n=(o?t.substr(0,t.length-o[0].length):t)||e,a="",i=o&&parseInt(o[1])||0;;i++){a=i>0?n+"_"+i:n;var s=this.state.entityMap[a];if(!s||s.element==r)break}return a},e}();t.createEntityPlugin=function(){return new s}},9617:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleEnterInlineEntity=t.handleKeyDownInBlockDelimiter=t.handleDelimiterKeyDownEvent=t.handleCompositionEndEvent=t.handleDelimiterContentChangedEvent=t.preventTypeInDelimiter=void 0;var o=r(7582),n=r(7416),a=r(3193),i=r(2171),l=r(8871),s="entityDelimiterBefore",c="entityDelimiterAfter",d="."+c+",."+s,u="";function f(e,t){var r=e.classList.contains(c)?e.previousElementSibling:e.nextElementSibling;r&&(0,l.isEntityElement)(r)&&(p([r.previousElementSibling,r.nextElementSibling].filter((function(e){return!!e}))),t.formatContentModel((function(e,t){return(0,a.iterateSelections)(e,(function(e,t,r,o){"Paragraph"==(null==r?void 0:r.blockType)&&r.segments.forEach((function(e){"Text"==e.segmentType&&(e.text=e.text.replace(u,""))}))})),t.skipUndoSnapshot=!0,!0})))}function p(e){e.forEach((function(e){var t,r;if((0,l.isNodeOfType)(e,"ELEMENT_NODE"))if((0,l.isEntityDelimiter)(e)){var o=e.classList.contains(s)?e.nextElementSibling:e.previousElementSibling;(0,l.isNodeOfType)(o,"ELEMENT_NODE")&&(0,l.isEntityElement)(o)||null===(r=null==(t=e)?void 0:t.parentElement)||void 0===r||r.removeChild(t)}else!function(e,t){if(void 0===t&&(t=!0),e){var r=e.classList.contains(c)?e.previousElementSibling:e.nextElementSibling;t&&r&&(0,l.isEntityElement)(r)||(e.classList.remove(c,s),e.normalize(),e.childNodes.forEach((function(e){var t,r,o=null!==(r=null===(t=e.textContent)||void 0===t?void 0:t.indexOf(u))&&void 0!==r?r:-1;if(o>=0){var n=new Range;n.setStart(e,o),n.setEnd(e,o+1),n.deleteContents()}})))}}(e)}))}function m(e,t){var r,o,n,a,s,c=e.range,f=e.isReverted,p=f?c.startContainer:c.endContainer,m=f?c.startOffset:c.endOffset;if(p){var v=(0,i.normalizePos)(p,m);p=v.node,m=v.offset}if((0,l.isNodeOfType)(p,"ELEMENT_NODE"))p=p.childNodes.length==m?p:p.childNodes.item(m);else{var g=t?u+t:u;p=p.textContent!=g&&(p.textContent||"").length==m?null!==(n=null!==(r=p.nextSibling)&&void 0!==r?r:null===(o=p.parentElement)||void 0===o?void 0:o.closest(d))&&void 0!==n?n:null:null!==(s=null===(a=null==p?void 0:p.parentElement)||void 0===a?void 0:a.closest(d))&&void 0!==s?s:null}return p&&!p.hasChildNodes()&&(p=p.nextSibling),(0,l.isNodeOfType)(p,"ELEMENT_NODE")?p:null}t.preventTypeInDelimiter=f,t.handleDelimiterContentChangedEvent=function(e){var t=e.getDOMHelper();p(t.queryElements(d)),function(e,t){if(e.length>0){var r=(0,l.createModelToDomContext)();e.forEach((function(e){(0,l.isNodeOfType)(e,"ELEMENT_NODE")&&(0,l.isEntityElement)(e)&&!e.isContentEditable&&(0,l.addDelimiters)(e.ownerDocument,e,t,r)}))}}(t.queryElements("span._Entity"),e.getPendingFormat())},t.handleCompositionEndEvent=function(e,t){var r=e.getDOMSelection();if("range"==(null==r?void 0:r.type)&&r.range.collapsed){var o=m(r,t.rawEvent.data);(null==o?void 0:o.firstChild)&&(0,l.isNodeOfType)(o.firstChild,"TEXT_NODE")&&o.matches(d)&&o.textContent==u+t.rawEvent.data&&f(o,e)}},t.handleDelimiterKeyDownEvent=function(e,r){var o,a=e.getDOMSelection(),i=r.rawEvent;if(a&&"range"==a.type){var s="Enter"===i.key,d=e.getDOMHelper();if(a.range.collapsed&&((0,n.isCharacterValue)(i)||s)){var u=e.getDOMHelper(),p=m(a);if(p&&(0,l.isEntityDelimiter)(p)&&u.isNodeInEditor(p)){var g=p.closest("._E_EBlockEntityContainer");g&&u.isNodeInEditor(g)?(p.classList.contains(c)?a.range.setStartAfter(g):a.range.setStartBefore(g),a.range.collapse(!0),s&&r.rawEvent.preventDefault(),e.formatContentModel(t.handleKeyDownInBlockDelimiter,{selectionOverride:{type:"range",isReverted:!1,range:a.range}})):s?(r.rawEvent.preventDefault(),e.formatContentModel(t.handleEnterInlineEntity)):(e.takeSnapshot(),null===(o=e.getDocument().defaultView)||void 0===o||o.requestAnimationFrame((function(){return f(p,e)})))}}else if(s){var h=(0,l.findClosestEntityWrapper)(a.range.startContainer,d);h&&(0,l.isNodeOfType)(h,"ELEMENT_NODE")&&d.isNodeInEditor(h)&&v(e,h,i)}}},t.handleKeyDownInBlockDelimiter=function(e,t){return(0,a.iterateSelections)(e,(function(e,r,n){if("Paragraph"==(null==n?void 0:n.blockType)){delete n.isImplicit;var a=n.segments.find((function(e){return"SelectionMarker"==e.segmentType}));"SelectionMarker"==(null==a?void 0:a.segmentType)&&(n.segmentFormat=(0,o.__assign)({},a.format),t.newPendingFormat=(0,o.__assign)({},a.format)),n.segments.unshift((0,l.createBr)())}})),!0},t.handleEnterInlineEntity=function(e){var t,r,n;if((0,a.iterateSelections)(e,(function(e,t,o){"Paragraph"==(null==o?void 0:o.blockType)&&(r=o,n=e[e.length-1])})),r&&n){var i=r.segments.find((function(e){return"SelectionMarker"==e.segmentType}));if(i){var s=r.segments.indexOf(i),c=r.segments.splice(s),d=(0,l.createParagraph)(!1,r.format,r.segmentFormat,r.decorator);(r.segments.every((function(e){return"SelectionMarker"==e.segmentType||"Br"==e.segmentType}))||c.every((function(e){return"SelectionMarker"==e.segmentType})))&&d.segments.push((0,l.createBr)(r.format)),(t=d.segments).push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(c),!1));var u=n.blocks.indexOf(r);u>=0&&n.blocks.splice(u+1,0,d)}}return!0};var v=function(e,t,r){var o=(0,l.parseEntityFormat)(t);o.id&&o.entityType&&!o.isFakeEntity&&e.triggerEvent("entityOperation",{operation:"click",entity:{id:o.id,type:o.entityType,isReadonly:!!o.isReadonly,wrapper:t},rawEvent:r})}},1964:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findAllEntities=void 0,t.findAllEntities=function e(t,r){t.blocks.forEach((function(t){switch(t.blockType){case"BlockGroup":e(t,r);break;case"Entity":r.push({entity:t,operation:"newEntity"});break;case"Paragraph":t.segments.forEach((function(t){switch(t.segmentType){case"Entity":r.push({entity:t,operation:"newEntity"});break;case"General":e(t,r)}}));break;case"Table":t.rows.forEach((function(t){return t.cells.forEach((function(t){return e(t,r)}))}))}}))}},8283:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createFormatPlugin=void 0;var o=r(7582),n=r(1800),a=r(6668),i=r(8871),l=r(7416),s={backgroundColor:"backgroundColor",textColor:"color",fontFamily:"fontFamily",fontSize:"fontSize"},c=function(){function e(e){var t=this;this.editor=null,this.lastCheckedNode=null,this.state={defaultFormat:(0,o.__assign)({},e.defaultSegmentFormat),pendingFormat:null},this.defaultFormatKeys=new Set,(0,i.getObjectKeys)(s).forEach((function(e){t.state.defaultFormat[e]&&t.defaultFormatKeys.add(s[e])}))}return e.prototype.getName=function(){return"Format"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"input":case"compositionEnd":this.checkAndApplyPendingFormat(e.rawEvent.data);break;case"keyDown":(0,l.isCursorMovingKey)(e.rawEvent)?(this.clearPendingFormat(),this.lastCheckedNode=null):this.defaultFormatKeys.size>0&&((0,l.isCharacterValue)(e.rawEvent)||"Process"==e.rawEvent.key)&&this.shouldApplyDefaultFormat(this.editor)&&(0,n.applyDefaultFormat)(this.editor,this.state.defaultFormat);break;case"mouseUp":case"contentChanged":this.lastCheckedNode=null,this.canApplyPendingFormat()||this.clearPendingFormat()}},e.prototype.checkAndApplyPendingFormat=function(e){this.editor&&e&&this.state.pendingFormat&&((0,a.applyPendingFormat)(this.editor,e,this.state.pendingFormat.format),this.clearPendingFormat())},e.prototype.clearPendingFormat=function(){this.state.pendingFormat=null},e.prototype.canApplyPendingFormat=function(){var e=!1;if(this.state.pendingFormat&&this.editor){var t=this.editor.getDOMSelection(),r="range"==(null==t?void 0:t.type)&&t.range.collapsed?t.range:null,o=this.state.pendingFormat,n=o.posContainer,a=o.posOffset;r&&r.startContainer==n&&r.startOffset==a&&(e=!0)}return e},e.prototype.shouldApplyDefaultFormat=function(e){var t,r,o=e.getDOMSelection(),n="range"==(null==o?void 0:o.type)?o.range:null,a=null!==(t=null==n?void 0:n.startContainer)&&void 0!==t?t:null;if(a&&a!=this.lastCheckedNode){this.lastCheckedNode=a;for(var l=e.getDOMHelper(),s=(0,i.isNodeOfType)(a,"ELEMENT_NODE")?a:a.parentElement,c=new Set,d=function(){if(null===(r=s.getAttribute)||void 0===r?void 0:r.call(s,"style")){var e=s.style;if(u.defaultFormatKeys.forEach((function(t){e[t]&&c.add(t)})),c.size==u.defaultFormatKeys.size)return{value:!1}}if((0,i.isBlockElement)(s))return"break";s=s.parentElement},u=this;(null==s?void 0:s.parentElement)&&l.isNodeInEditor(s.parentElement);){var f=d();if("object"==typeof f)return f.value;if("break"===f)break}return!0}return!1},e}();t.createFormatPlugin=function(e){return new c(e)}},1800:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyDefaultFormat=void 0;var o=r(7582),n=r(4470),a=r(8871);function i(e,t,r){return(0,o.__assign)((0,o.__assign)((0,o.__assign)({},t),e.getPendingFormat()),r)}t.applyDefaultFormat=function(e,t){e.formatContentModel((function(r,o){var l=(0,n.deleteSelection)(r,[],o);if("range"==l.deleteResult)return(0,a.normalizeContentModel)(r),e.takeSnapshot(),!0;if("notDeleted"==l.deleteResult&&l.insertPoint){var s=l.insertPoint,c=s.paragraph,d=s.path,u=s.marker,f=d[0].blocks,p=f.length,m=f.indexOf(c);if(c.isImplicit&&1==c.segments.length&&c.segments[0]==u&&p>0&&m==p-1){var v=f[m-1];"Paragraph"!=(null==v?void 0:v.blockType)&&(o.newPendingFormat=i(e,t,u.format))}else c.segments.every((function(e){return"Text"!=e.segmentType}))&&(o.newPendingFormat=i(e,t,u.format))}return!1}))}},6668:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyPendingFormat=void 0;var o=r(7582),n=r(3193),a=r(8871);t.applyPendingFormat=function(e,t,r){var i=!1;e.formatContentModel((function(e,l){return(0,n.iterateSelections)(e,(function(e,n,l,s){if("Paragraph"==(null==l?void 0:l.blockType)&&1==(null==s?void 0:s.length)&&"SelectionMarker"==s[0].segmentType){var c=s[0],d=l.segments.indexOf(c),u=l.segments[d-1];if("Text"==(null==u?void 0:u.segmentType)){var f=u.text,p=f.substr(-t.length,t.length);if(p==t||" "==t&&""==p){c.format=(0,o.__assign)({},r),u.text=f.substring(0,f.length-t.length);var m=(0,a.createText)(" "==t?"":t,(0,o.__assign)((0,o.__assign)({},u.format),r));l.segments.splice(d,0,m),(0,a.setParagraphNotImplicit)(l),i=!0}}}return!0})),i&&((0,a.normalizeContentModel)(e),l.skipUndoSnapshot=!0),i}),{apiName:"applyPendingFormat"})}},2933:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLifecyclePlugin=void 0;var o=r(8667),n=r(8871),a="contenteditable",i=function(){function e(e,t){var r=this;this.editor=null,this.initializer=null,this.disposer=null,null===t.getAttribute(a)&&(this.initializer=function(){t.contentEditable="true",t.style.userSelect="text"},this.disposer=function(){t.style.userSelect="",t.removeAttribute(a)}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){r.adjustContainerColor(t)},this.state={isDarkMode:!!e.inDarkMode,shadowEditFragment:null,styleElements:{}}}return e.prototype.getName=function(){return"Lifecycle"},e.prototype.initialize=function(e){var t;this.editor=e,null===(t=this.initializer)||void 0===t||t.call(this),this.adjustColor(),this.editor.triggerEvent("editorReady",{},!0)},e.prototype.dispose=function(){var e,t=this;null===(e=this.editor)||void 0===e||e.triggerEvent("beforeDispose",{},!0),(0,n.getObjectKeys)(this.state.styleElements).forEach((function(e){var r,o=t.state.styleElements[e];null===(r=o.parentElement)||void 0===r||r.removeChild(o),delete t.state.styleElements[e]})),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){"contentChanged"!=e.eventType||e.source!=o.ChangeSource.SwitchToDarkMode&&e.source!=o.ChangeSource.SwitchToLightMode||this.adjustColor()},e.prototype.adjustContainerColor=function(e){if(this.editor){var t=this.state.isDarkMode,r=this.editor.getColorManager();(0,n.setColor)(e,"#000000",!1,t,r),(0,n.setColor)(e,"#ffffff",!0,t,r)}},e}();t.createLifecyclePlugin=function(e,t){return new i(e,t)}},535:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionPlugin=void 0;var o=r(7416),n=r(8871),a=r(2171),i=r(4399),l="ArrowUp",s="ArrowDown",c="ArrowLeft",d="ArrowRight",u=function(){function e(e){var t=this;this.editor=null,this.disposer=null,this.isSafari=!1,this.isMac=!1,this.onMouseMove=function(e){var r,o,a;if(t.editor&&t.state.tableSelection){var l=!!t.state.tableSelection.lastCo,s=e.target,c=t.editor.getDOMHelper(),d=t.editor.getDocument().createRange(),u=t.state.tableSelection.startNode,f=s.compareDocumentPosition(u)==Node.DOCUMENT_POSITION_FOLLOWING;f?(d.setStart(s,0),d.setEnd(u,(0,n.isNodeOfType)(u,"TEXT_NODE")?null!==(o=null===(r=u.nodeValue)||void 0===r?void 0:r.length)&&void 0!==o?o:0:u.childNodes.length)):(d.setStart(u,0),d.setEnd(s,0));var p=d.commonAncestorContainer,m=t.parseTableSelection(p,u,c);if(m){var v=(0,i.findCoordinate)(m.parsedTable,s,c);m.table!=t.state.tableSelection.table&&(t.state.tableSelection=m,t.state.tableSelection.lastCo=null!=v?v:void 0);var g=v&&t.updateTableSelection(v);(l||g)&&e.preventDefault()}else"table"==(null===(a=t.editor.getDOMSelection())||void 0===a?void 0:a.type)&&t.setDOMSelection({type:"range",range:d,isReverted:f},t.state.tableSelection)}},this.onDrop=function(){t.detachMouseEvent()},this.getContainedTargetImage=function(e,r){if(!t.isMac||!r||"image"!==r.type)return null;var o=e.target;return(0,n.isNodeOfType)(o,"ELEMENT_NODE")&&(0,n.isElementOfType)(o,"span")&&o.firstChild===r.image?r.image:null},this.onFocus=function(){var e;!t.state.skipReselectOnFocus&&t.state.selection&&t.setDOMSelection(t.state.selection,t.state.tableSelection),"range"!=(null===(e=t.state.selection)||void 0===e?void 0:e.type)||t.isSafari||(t.state.selection=null)},this.onBlur=function(){!t.state.selection&&t.editor&&(t.state.selection=t.editor.getDOMSelection())},this.onSelectionChangeSafari=function(){var e;if((null===(e=t.editor)||void 0===e?void 0:e.hasFocus())&&!t.editor.isInShadowEdit()){var r=t.editor.getDOMSelection();"range"==(null==r?void 0:r.type)&&(t.state.selection=r)}},this.state={selection:null,tableSelection:null,imageSelectionBorderColor:e.imageSelectionBorderColor}}return e.prototype.getName=function(){return"Selection"},e.prototype.initialize=function(e){this.editor=e;var t=this.editor.getEnvironment(),r=this.editor.getDocument();this.isSafari=!!t.isSafari,this.isMac=!!t.isMac,this.isSafari?(r.addEventListener("selectionchange",this.onSelectionChangeSafari),this.disposer=this.editor.attachDomEvent({focus:{beforeDispatch:this.onFocus},drop:{beforeDispatch:this.onDrop}})):this.disposer=this.editor.attachDomEvent({focus:{beforeDispatch:this.onFocus},blur:{beforeDispatch:this.onBlur},drop:{beforeDispatch:this.onDrop}})},e.prototype.dispose=function(){var e;null===(e=this.editor)||void 0===e||e.getDocument().removeEventListener("selectionchange",this.onSelectionChangeSafari),this.disposer&&(this.disposer(),this.disposer=null),this.detachMouseEvent(),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"mouseDown":this.onMouseDown(this.editor,e.rawEvent);break;case"mouseUp":this.onMouseUp(e);break;case"keyDown":this.onKeyDown(this.editor,e.rawEvent);break;case"contentChanged":this.state.tableSelection=null}},e.prototype.onMouseDown=function(e,t){var r,o,n=e.getDOMSelection();if(2===t.button&&(o=null!==(r=this.getClickingImage(t))&&void 0!==r?r:this.getContainedTargetImage(t,n))&&o.isContentEditable)this.selectImage(o);else if("image"!=(null==n?void 0:n.type)||n.image===t.target){var a;"table"==(null==n?void 0:n.type)&&0==t.button&&this.setDOMSelection(null,null);var l=t.target;if(l&&0==t.button&&(a=this.parseTableSelection(l,l,e.getDOMHelper()))){if(this.state.tableSelection=a,t.detail>=3){var s=(0,i.findCoordinate)(a.parsedTable,t.target,e.getDOMHelper());s&&(a.lastCo=s,this.updateTableSelection(s),t.preventDefault())}this.state.mouseDisposer=e.attachDomEvent({mousemove:{beforeDispatch:this.onMouseMove}})}}else this.selectBeforeImage(e,n.image)},e.prototype.onMouseUp=function(e){var t;(t=this.getClickingImage(e.rawEvent))&&t.isContentEditable&&1!=e.rawEvent.button&&(2==e.rawEvent.button||e.isClicking)&&this.selectImage(t),this.detachMouseEvent()},e.prototype.onKeyDown=function(e,t){var r,n=this,a=t.key,i=e.getDOMSelection(),u=e.getDocument().defaultView;switch(null==i?void 0:i.type){case"image":(0,o.isModifierKey)(t)||t.shiftKey||!i.image.parentNode||("Escape"===a?(this.selectBeforeImage(e,i.image),t.stopPropagation()):"Delete"!==a&&"Backspace"!==a&&this.selectBeforeImage(e,i.image));break;case"range":if(a==l||a==s||a==c||a==d){var f=i.range.startContainer;this.state.tableSelection=this.parseTableSelection(f,f,e.getDOMHelper()),this.state.tableSelection&&(null==u||u.requestAnimationFrame((function(){return n.handleSelectionInTable(a)})))}break;case"table":if(null===(r=this.state.tableSelection)||void 0===r?void 0:r.lastCo){var p=t.shiftKey,m=t.key;if(!p||m!=c&&m!=d)!p||m!=l&&m!=s?"Shift"==m||(0,o.isCharacterValue)(t)||m!=l&&m!=s&&m!=c&&m!=d||(this.setDOMSelection(null,this.state.tableSelection),null==u||u.requestAnimationFrame((function(){return n.handleSelectionInTable(m)}))):(this.updateTableSelectionFromKeyboard(m==l?-1:1,0),t.preventDefault());else{var v="rtl"==(null==u?void 0:u.getComputedStyle(this.state.tableSelection.table).direction);this.updateTableSelectionFromKeyboard(0,(m==c?-1:1)*(v?-1:1)),t.preventDefault()}}}},e.prototype.handleSelectionInTable=function(e){var t,r;if(this.editor&&this.state.tableSelection){var o=this.editor.getDOMSelection(),n=this.editor.getDOMHelper();if("range"==(null==o?void 0:o.type)){var c=o.range,d=c.collapsed,u=c.startContainer,f=c.endContainer,p=c.commonAncestorContainer,m=o.isReverted,v=m?f:u,g=m?u:f,h=this.parseTableSelection(p,v,n);if(!h)return;var b=(0,i.findCoordinate)(null==h?void 0:h.parsedTable,g,n),y=this.state.tableSelection,S=y.parsedTable,C=y.firstCo,_=y.table;if(b&&h.table==_&&b.col!=C.col)if(e==l||e==s){var T=e==l?-1:1,E=null===(t=(0,i.findTableCellElement)(S,C))||void 0===t?void 0:t.cell,k=null;for(b={row:C.row+T,col:C.col};b.row>=0&&b.row<S.length&&(k=(null===(r=(0,i.findTableCellElement)(S,b))||void 0===r?void 0:r.cell)||null)==E;)b.row+=T;if(d&&k){var M=(0,a.normalizePos)(k,e==l?k.childNodes.length:0),P=M.node,O=M.offset,w=this.editor.getDocument().createRange();w.setStart(P,O),w.collapse(!0),this.setDOMSelection({type:"range",range:w,isReverted:!1},null)}}else this.state.tableSelection=null;!d&&b&&(this.state.tableSelection=h,this.updateTableSelection(b))}}},e.prototype.updateTableSelectionFromKeyboard=function(e,t){var r;if((null===(r=this.state.tableSelection)||void 0===r?void 0:r.lastCo)&&this.editor){var o=this.state.tableSelection,n=o.lastCo,a=o.parsedTable,i=n.row+e,l=n.col+t;i>=0&&i<a.length&&l>=0&&l<a[i].length&&this.updateTableSelection({row:i,col:l})}},e.prototype.selectImage=function(e){this.setDOMSelection({type:"image",image:e},null)},e.prototype.selectBeforeImage=function(e,t){var r=e.getDocument(),o=t.parentNode,a=o&&(0,n.toArray)(o.childNodes).indexOf(t);if(o&&null!==a&&a>=0){var i=r.createRange();i.setStart(o,a),i.collapse(),this.setDOMSelection({type:"range",range:i,isReverted:!1},null)}},e.prototype.getClickingImage=function(e){var t=e.target;return(0,n.isNodeOfType)(t,"ELEMENT_NODE")&&(0,n.isElementOfType)(t,"img")?t:null},e.prototype.parseTableSelection=function(e,t,r){var o,n,a;return(o=r.findClosestElementAncestor(e,"table"))&&(n=(0,i.parseTableCells)(o))&&(a=(0,i.findCoordinate)(n,t,r))?{table:o,parsedTable:n,firstCo:a,startNode:t}:null},e.prototype.updateTableSelection=function(e){if(this.state.tableSelection&&this.editor){var t=this.state.tableSelection,r=t.table,o=t.firstCo,n=t.parsedTable,a=t.startNode;if(t.lastCo||o.row!=e.row||o.col!=e.col)return this.state.tableSelection.lastCo=e,this.setDOMSelection({type:"table",table:r,firstRow:o.row,firstColumn:o.col,lastRow:e.row,lastColumn:e.col},{table:r,firstCo:o,lastCo:e,parsedTable:n,startNode:a}),!0}return!1},e.prototype.setDOMSelection=function(e,t){var r;null===(r=this.editor)||void 0===r||r.setDOMSelection(e),this.state.tableSelection=t},e.prototype.detachMouseEvent=function(){this.state.mouseDisposer&&(this.state.mouseDisposer(),this.state.mouseDisposer=void 0)},e}();t.createSelectionPlugin=function(e){return new u(e)}},426:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSnapshotsManager=void 0;var r=function(){function e(e){this.hasNewContentValue=!1,this.snapshots=null!=e?e:{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:1e7}}return Object.defineProperty(e.prototype,"hasNewContent",{get:function(){return this.hasNewContentValue},set:function(e){this.hasNewContentValue=e},enumerable:!1,configurable:!0}),e.prototype.canMove=function(e){var t=this.snapshots.currentIndex+e;return t>=0&&t<this.snapshots.snapshots.length},e.prototype.move=function(e){var t,r,o=null;return this.canMove(e)&&(this.snapshots.currentIndex+=e,this.snapshots.autoCompleteIndex=-1,o=this.snapshots.snapshots[this.snapshots.currentIndex]),null===(r=(t=this.snapshots).onChanged)||void 0===r||r.call(t,"move"),o},e.prototype.addSnapshot=function(e,t){var r,o,n=this.snapshots.snapshots[this.snapshots.currentIndex],a=n&&n.html==e.html&&!n.entityStates&&!e.entityStates,i=!n||function(e,t){return e.html!==t.html||e.entityStates&&t.entityStates&&e.entityStates!==t.entityStates||!e.entityStates&&t.entityStates}(n,e);if(this.snapshots.currentIndex<0||i){this.clearRedo(),this.snapshots.snapshots.push(e),this.snapshots.currentIndex++,this.snapshots.totalSize+=this.getSnapshotLength(e);for(var l=0;l<this.snapshots.snapshots.length&&this.snapshots.totalSize>this.snapshots.maxSize;)this.snapshots.totalSize-=this.getSnapshotLength(this.snapshots.snapshots[l]),l++;l>0&&(this.snapshots.snapshots.splice(0,l),this.snapshots.currentIndex-=l,this.snapshots.autoCompleteIndex>=0&&(this.snapshots.autoCompleteIndex-=l)),t&&(this.snapshots.autoCompleteIndex=this.snapshots.currentIndex)}else a&&this.snapshots.snapshots.splice(this.snapshots.currentIndex,1,e);null===(o=(r=this.snapshots).onChanged)||void 0===o||o.call(r,"add")},e.prototype.clearRedo=function(){var e,t;if(this.canMove(1)){for(var r=0,o=this.snapshots.currentIndex+1;o<this.snapshots.snapshots.length;o++)r+=this.getSnapshotLength(this.snapshots.snapshots[o]);this.snapshots.snapshots.splice(this.snapshots.currentIndex+1),this.snapshots.totalSize-=r,this.snapshots.autoCompleteIndex=-1,null===(t=(e=this.snapshots).onChanged)||void 0===t||t.call(e,"clear")}},e.prototype.canUndoAutoComplete=function(){return this.snapshots.autoCompleteIndex>=0&&this.snapshots.currentIndex-this.snapshots.autoCompleteIndex==1},e.prototype.getSnapshotLength=function(e){var t,r;return null!==(r=null===(t=e.html)||void 0===t?void 0:t.length)&&void 0!==r?r:0},e}();t.createSnapshotsManager=function(e){return new r(e)}},9465:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createUndoPlugin=void 0;var o=r(8667),n=r(426),a=r(7416),i=r(1771),l="Backspace",s="Delete",c="Enter",d=function(){function e(e){this.editor=null,this.state={snapshotsManager:(0,n.createSnapshotsManager)(e.snapshots),isRestoring:!1,isNested:!1,posContainer:null,posOffset:null,lastKeyPress:null}}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.willHandleEventExclusively=function(e){return!!this.editor&&"keyDown"==e.eventType&&e.rawEvent.key==l&&!e.rawEvent.ctrlKey&&this.canUndoAutoComplete(this.editor)},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"editorReady":var t=this.state.snapshotsManager,r=t.hasNewContent||t.canMove(-1),o=t.canMove(1);r||o||this.addUndoSnapshot();break;case"keyDown":this.onKeyDown(this.editor,e.rawEvent);break;case"keyPress":this.onKeyPress(this.editor,e.rawEvent);break;case"compositionEnd":this.clearRedoForInput(),this.addUndoSnapshot();break;case"contentChanged":this.onContentChanged(e);break;case"beforeKeyboardEditing":this.onBeforeKeyboardEditing(e.rawEvent)}},e.prototype.onKeyDown=function(e,t){var r=this.state.snapshotsManager;if(t.key==l&&!t.altKey||t.key==s){if(t.key==l&&!t.ctrlKey&&this.canUndoAutoComplete(e))t.preventDefault(),(0,i.undo)(e),this.state.posContainer=null,this.state.posOffset=null,this.state.lastKeyPress=t.key;else if(!t.defaultPrevented){var o=e.getDOMSelection();!o||"range"==o.type&&o.range.collapsed&&this.state.lastKeyPress==t.key&&!this.isCtrlOrMetaPressed(e,t)||this.addUndoSnapshot(),r.hasNewContent=!0,this.state.lastKeyPress=t.key}}else(0,a.isCursorMovingKey)(t)?(r.hasNewContent&&this.addUndoSnapshot(),this.state.lastKeyPress=null):this.state.lastKeyPress!=l&&this.state.lastKeyPress!=s||r.hasNewContent&&this.addUndoSnapshot()},e.prototype.onKeyPress=function(e,t){if(!t.metaKey){var r=e.getDOMSelection();r&&("range"!=r.type||!r.range.collapsed)||" "==t.key&&" "!=this.state.lastKeyPress||t.key==c?(this.addUndoSnapshot(),t.key==c&&(this.state.snapshotsManager.hasNewContent=!0)):this.clearRedoForInput(),this.state.lastKeyPress=t.key}},e.prototype.onBeforeKeyboardEditing=function(e){e.key!=this.state.lastKeyPress&&this.addUndoSnapshot(),this.state.lastKeyPress=e.key,this.state.snapshotsManager.hasNewContent=!0},e.prototype.onContentChanged=function(e){this.state.isRestoring||e.source==o.ChangeSource.SwitchToDarkMode||e.source==o.ChangeSource.SwitchToLightMode||e.source==o.ChangeSource.Keyboard||this.clearRedoForInput()},e.prototype.clearRedoForInput=function(){this.state.snapshotsManager.clearRedo(),this.state.lastKeyPress=null,this.state.snapshotsManager.hasNewContent=!0},e.prototype.canUndoAutoComplete=function(e){var t=e.getDOMSelection();return this.state.snapshotsManager.canUndoAutoComplete()&&"range"==(null==t?void 0:t.type)&&t.range.collapsed&&t.range.startContainer==this.state.posContainer&&t.range.startOffset==this.state.posOffset},e.prototype.addUndoSnapshot=function(){var e;null===(e=this.editor)||void 0===e||e.takeSnapshot(),this.state.posContainer=null,this.state.posOffset=null},e.prototype.isCtrlOrMetaPressed=function(e,t){return e.getEnvironment().isMac?t.metaKey:t.ctrlKey},e}();t.createUndoPlugin=function(e){return new d(e)}},532:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Editor=void 0;var o=r(7582),n=r(8667),a=r(464),i=r(5259),l=r(8871),s=r(7666),c=r(2879),d=function(){function e(e,t){var r,o=this;void 0===t&&(t={}),this.core=null,this.cloneOptionCallback=function(e,t){if("cache"!=t){var r=e.cloneNode(!0);if(o.isDarkMode()){var n=o.getColorManager();(0,c.transformColor)(r,!0,"darkToLight",n),r.style.color=r.style.color||"inherit",r.style.backgroundColor=r.style.backgroundColor||"inherit"}return r}},this.core=(0,i.createEditorCore)(e,t);var n=null!==(r=t.initialModel)&&void 0!==r?r:(0,l.createEmptyModel)(t.defaultSegmentFormat);this.core.api.setContentModel(this.core,n,{ignoreSelection:!0}),this.core.plugins.forEach((function(e){return e.initialize(o)}))}return e.prototype.dispose=function(){for(var e,t=this.getCore(),r=t.plugins.length-1;r>=0;r--){var o=t.plugins[r];try{o.dispose()}catch(r){null===(e=t.disposeErrorHandler)||void 0===e||e.call(t,o,r)}}t.darkColorHandler.reset(),this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.getContentModelCopy=function(e){var t=this.getCore();switch(e){case"connected":return t.api.createContentModel(t,{processorOverride:{table:l.tableProcessor}});case"disconnected":case"clean":return(0,a.cloneModel)(t.api.createContentModel(t,void 0,"clean"==e?"none":void 0),{includeCachedElement:this.cloneOptionCallback});case"reduced":return t.api.createContentModel(t,{processorOverride:{child:s.reducedModelChildProcessor}})}},e.prototype.getEnvironment=function(){return this.getCore().environment},e.prototype.getDOMSelection=function(){var e=this.getCore();return e.api.getDOMSelection(e)},e.prototype.setDOMSelection=function(e){var t=this.getCore();t.api.setDOMSelection(t,e)},e.prototype.setLogicalRoot=function(e){var t=this.getCore();t.api.setLogicalRoot(t,e)},e.prototype.formatContentModel=function(e,t){var r=this.getCore();r.api.formatContentModel(r,e,t)},e.prototype.getPendingFormat=function(){var e,t;return null!==(t=null===(e=this.getCore().format.pendingFormat)||void 0===e?void 0:e.format)&&void 0!==t?t:null},e.prototype.getDOMHelper=function(){return this.getCore().domHelper},e.prototype.takeSnapshot=function(e){var t=this.getCore();return t.api.addUndoSnapshot(t,!1,e?[e]:void 0)},e.prototype.restoreSnapshot=function(e){var t=this.getCore();t.api.restoreUndoSnapshot(t,e)},e.prototype.getDocument=function(){return this.getCore().physicalRoot.ownerDocument},e.prototype.focus=function(){var e=this.getCore();e.api.focus(e)},e.prototype.hasFocus=function(){return this.getCore().domHelper.hasFocus()},e.prototype.triggerEvent=function(e,t,r){void 0===r&&(r=!1);var n=this.getCore(),a=(0,o.__assign)({eventType:e},t);return n.api.triggerEvent(n,a,r),a},e.prototype.attachDomEvent=function(e){var t=this.getCore();return t.api.attachDomEvent(t,e)},e.prototype.getSnapshotsManager=function(){return this.getCore().undo.snapshotsManager},e.prototype.isDarkMode=function(){return this.getCore().lifecycle.isDarkMode},e.prototype.setDarkModeState=function(e){var t=this.getCore();!!e!=t.lifecycle.isDarkMode&&((0,c.transformColor)(t.physicalRoot,!1,e?"lightToDark":"darkToLight",t.darkColorHandler),t.lifecycle.isDarkMode=!!e,t.api.triggerEvent(t,{eventType:"contentChanged",source:e?n.ChangeSource.SwitchToDarkMode:n.ChangeSource.SwitchToLightMode},!0))},e.prototype.isInShadowEdit=function(){return!!this.getCore().lifecycle.shadowEditFragment},e.prototype.startShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!0)},e.prototype.stopShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!1)},e.prototype.getColorManager=function(){return this.getCore().darkColorHandler},e.prototype.getTrustedHTMLHandler=function(){return this.getCore().trustedHTMLHandler},e.prototype.getScrollContainer=function(){return this.getCore().domEvent.scrollContainer},e.prototype.getVisibleViewport=function(){return this.getCore().api.getVisibleViewport(this.getCore())},e.prototype.setEditorStyle=function(e,t,r){var o=this.getCore();o.api.setEditorStyle(o,e,t,r)},e.prototype.getCore=function(){if(!this.core)throw new Error("Editor is already disposed");return this.core},e}();t.Editor=d},4021:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDOMHelper=void 0;var o=r(8871),n=function(){function e(e){this.contentDiv=e}return e.prototype.queryElements=function(e){return(0,o.toArray)(this.contentDiv.querySelectorAll(e))},e.prototype.getTextContent=function(){return this.contentDiv.textContent||""},e.prototype.isNodeInEditor=function(e){return this.contentDiv.contains(e)},e.prototype.calculateZoomScale=function(){var e,t=(null===(e=this.contentDiv.getBoundingClientRect())||void 0===e?void 0:e.width)||0,r=this.contentDiv.offsetWidth;return r>0&&t>0?Math.round(t/r*100)/100:1},e.prototype.setDomAttribute=function(e,t){null===t?this.contentDiv.removeAttribute(e):this.contentDiv.setAttribute(e,t)},e.prototype.getDomAttribute=function(e){return this.contentDiv.getAttribute(e)},e.prototype.getDomStyle=function(e){return this.contentDiv.style[e]},e.prototype.findClosestElementAncestor=function(e,t){var r=(0,o.isNodeOfType)(e,"ELEMENT_NODE")?e:e.parentElement,n=t?null==r?void 0:r.closest(t):r;return n&&this.isNodeInEditor(n)&&n!=this.contentDiv?n:null},e.prototype.hasFocus=function(){var e=this.contentDiv.ownerDocument.activeElement;return!(!e||!this.contentDiv.contains(e))},e}();t.createDOMHelper=function(e){return new n(e)}},848:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDarkColorHandler=void 0;var r=function(){function e(e,t,r){this.root=e,this.getDarkColor=t,this.knownColors=r}return e.prototype.updateKnownColor=function(e,t,r){var o=this;t&&r?(this.knownColors[t]||(this.knownColors[t]=r),e&&this.root.style.setProperty(t,r.darkModeColor)):e&&Object.keys(this.knownColors).forEach((function(e){o.root.style.setProperty(e,o.knownColors[e].darkModeColor)}))},e.prototype.reset=function(){var e=this;Object.keys(this.knownColors).forEach((function(t){e.root.style.removeProperty(t)}))},e}();t.createDarkColorHandler=function(e,t,o){return void 0===o&&(o={}),new r(e,t,o)}},5259:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkColorFallback=t.defaultTrustHtmlHandler=t.createEditorCore=void 0;var o=r(7582),n=r(4810),a=r(848),i=r(4021),l=r(7617),s=r(9785);function c(e,t){var r,o,n,a=null===(r=e.ownerDocument.defaultView)||void 0===r?void 0:r.navigator,i=null!==(o=null==a?void 0:a.userAgent)&&void 0!==o?o:"",s=null!==(n=null==a?void 0:a.appVersion)&&void 0!==n?n:"";return{domToModelSettings:(0,l.createDomToModelSettings)(t),modelToDomSettings:(0,l.createModelToDomSettings)(t),isMac:-1!=s.indexOf("Mac"),isAndroid:/android/i.test(i),isSafari:i.indexOf("Safari")>=0&&i.indexOf("Chrome")<0&&i.indexOf("Android")<0,isMobileOrTablet:d(i)}}function d(e){return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substring(0,4)))}function u(e){return e}function f(e){return e}t.createEditorCore=function(e,t){var r,l,d=(0,s.createEditorCorePlugins)(t,e);return(0,o.__assign)((0,o.__assign)({physicalRoot:e,logicalRoot:e,api:(0,o.__assign)((0,o.__assign)({},n.coreApiMap),t.coreApiOverride),originalApi:(0,o.__assign)({},n.coreApiMap),plugins:(0,o.__spreadArray)((0,o.__spreadArray)([d.cache,d.format,d.copyPaste,d.domEvent,d.selection,d.entity],(0,o.__read)((null!==(r=t.plugins)&&void 0!==r?r:[]).filter((function(e){return!!e}))),!1),[d.undo,d.contextMenu,d.lifecycle],!1),environment:c(e,t),darkColorHandler:(0,a.createDarkColorHandler)(e,null!==(l=t.getDarkColor)&&void 0!==l?l:f,t.knownColors),trustedHTMLHandler:t.trustedHTMLHandler||u,domHelper:(0,i.createDOMHelper)(e)},function(e){return{domEvent:e.domEvent.getState(),copyPaste:e.copyPaste.getState(),cache:e.cache.getState(),format:e.format.getState(),lifecycle:e.lifecycle.getState(),entity:e.entity.getState(),selection:e.selection.getState(),contextMenu:e.contextMenu.getState(),undo:e.undo.getState()}}(d)),{disposeErrorHandler:t.disposeErrorHandler})},t.defaultTrustHtmlHandler=u,t.getDarkColorFallback=f},7617:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createModelToDomSettings=t.createDomToModelSettings=void 0;var o=r(8871),n=r(2291),a=r(7364);t.createDomToModelSettings=function(e){var t,r={processorOverride:{table:n.tablePreProcessor}},a=null!==(t=e.defaultDomToModelOptions)&&void 0!==t?t:{};return{builtIn:r,customized:a,calculated:(0,o.createDomToModelConfig)([r,a])}},t.createModelToDomSettings=function(e){var t,r={metadataAppliers:{listItem:a.listItemMetadataApplier,listLevel:a.listLevelMetadataApplier}},n=null!==(t=e.defaultModelToDomOptions)&&void 0!==t?t:{};return{builtIn:r,customized:n,calculated:(0,o.createModelToDomConfig)([r,n])}}},4781:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeSource=t.getListStyleTypeFromString=t.updateListMetadata=t.updateTableMetadata=t.updateTableCellMetadata=t.updateImageMetadata=t.retrieveModelFormatState=t.transformColor=t.paste=t.redo=t.undo=t.cacheGetEventData=t.readFile=t.getSegmentTextFormat=t.createTableRanges=t.parseTableCells=t.normalizeText=t.isSpace=t.isPunctuation=t.extractBorderValues=t.combineBorderValue=t.isModifierKey=t.isCharacterValue=t.getSelectedCells=t.setTableCellBackgroundColor=t.MIN_ALLOWED_TABLE_CELL_WIDTH=t.normalizeTable=t.applyTableFormat=t.setSelection=t.getSelectedSegmentsAndParagraphs=t.getSelectedSegments=t.getSelectedParagraphs=t.getOperationalBlocks=t.getFirstSelectedTable=t.getFirstSelectedListItem=t.hasSelectionInBlockGroup=t.hasSelectionInSegment=t.hasSelectionInBlock=t.deleteBlock=t.deleteSegment=t.deleteSelection=t.getSelectionRootNode=t.iterateSelections=t.exportContent=t.createModelFromHtml=t.isBold=t.getClosestAncestorBlockGroupIndex=t.isBlockGroupOfType=t.mergeModel=t.cloneModel=void 0,t.Editor=t.extractClipboardItems=t.TableBorderFormat=t.NumberingListType=t.BulletListType=void 0;var o=r(464);Object.defineProperty(t,"cloneModel",{enumerable:!0,get:function(){return o.cloneModel}});var n=r(578);Object.defineProperty(t,"mergeModel",{enumerable:!0,get:function(){return n.mergeModel}});var a=r(5094);Object.defineProperty(t,"isBlockGroupOfType",{enumerable:!0,get:function(){return a.isBlockGroupOfType}});var i=r(5513);Object.defineProperty(t,"getClosestAncestorBlockGroupIndex",{enumerable:!0,get:function(){return i.getClosestAncestorBlockGroupIndex}});var l=r(1606);Object.defineProperty(t,"isBold",{enumerable:!0,get:function(){return l.isBold}});var s=r(6683);Object.defineProperty(t,"createModelFromHtml",{enumerable:!0,get:function(){return s.createModelFromHtml}});var c=r(2666);Object.defineProperty(t,"exportContent",{enumerable:!0,get:function(){return c.exportContent}});var d=r(3193);Object.defineProperty(t,"iterateSelections",{enumerable:!0,get:function(){return d.iterateSelections}});var u=r(7309);Object.defineProperty(t,"getSelectionRootNode",{enumerable:!0,get:function(){return u.getSelectionRootNode}});var f=r(4470);Object.defineProperty(t,"deleteSelection",{enumerable:!0,get:function(){return f.deleteSelection}});var p=r(2965);Object.defineProperty(t,"deleteSegment",{enumerable:!0,get:function(){return p.deleteSegment}});var m=r(3190);Object.defineProperty(t,"deleteBlock",{enumerable:!0,get:function(){return m.deleteBlock}});var v=r(9764);Object.defineProperty(t,"hasSelectionInBlock",{enumerable:!0,get:function(){return v.hasSelectionInBlock}});var g=r(2152);Object.defineProperty(t,"hasSelectionInSegment",{enumerable:!0,get:function(){return g.hasSelectionInSegment}});var h=r(4298);Object.defineProperty(t,"hasSelectionInBlockGroup",{enumerable:!0,get:function(){return h.hasSelectionInBlockGroup}});var b=r(4946);Object.defineProperty(t,"getFirstSelectedListItem",{enumerable:!0,get:function(){return b.getFirstSelectedListItem}}),Object.defineProperty(t,"getFirstSelectedTable",{enumerable:!0,get:function(){return b.getFirstSelectedTable}}),Object.defineProperty(t,"getOperationalBlocks",{enumerable:!0,get:function(){return b.getOperationalBlocks}}),Object.defineProperty(t,"getSelectedParagraphs",{enumerable:!0,get:function(){return b.getSelectedParagraphs}}),Object.defineProperty(t,"getSelectedSegments",{enumerable:!0,get:function(){return b.getSelectedSegments}}),Object.defineProperty(t,"getSelectedSegmentsAndParagraphs",{enumerable:!0,get:function(){return b.getSelectedSegmentsAndParagraphs}});var y=r(2242);Object.defineProperty(t,"setSelection",{enumerable:!0,get:function(){return y.setSelection}});var S=r(785);Object.defineProperty(t,"applyTableFormat",{enumerable:!0,get:function(){return S.applyTableFormat}});var C=r(7900);Object.defineProperty(t,"normalizeTable",{enumerable:!0,get:function(){return C.normalizeTable}}),Object.defineProperty(t,"MIN_ALLOWED_TABLE_CELL_WIDTH",{enumerable:!0,get:function(){return C.MIN_ALLOWED_TABLE_CELL_WIDTH}});var _=r(205);Object.defineProperty(t,"setTableCellBackgroundColor",{enumerable:!0,get:function(){return _.setTableCellBackgroundColor}});var T=r(2266);Object.defineProperty(t,"getSelectedCells",{enumerable:!0,get:function(){return T.getSelectedCells}});var E=r(7416);Object.defineProperty(t,"isCharacterValue",{enumerable:!0,get:function(){return E.isCharacterValue}}),Object.defineProperty(t,"isModifierKey",{enumerable:!0,get:function(){return E.isModifierKey}});var k=r(3811);Object.defineProperty(t,"combineBorderValue",{enumerable:!0,get:function(){return k.combineBorderValue}}),Object.defineProperty(t,"extractBorderValues",{enumerable:!0,get:function(){return k.extractBorderValues}});var M=r(9533);Object.defineProperty(t,"isPunctuation",{enumerable:!0,get:function(){return M.isPunctuation}}),Object.defineProperty(t,"isSpace",{enumerable:!0,get:function(){return M.isSpace}}),Object.defineProperty(t,"normalizeText",{enumerable:!0,get:function(){return M.normalizeText}});var P=r(4399);Object.defineProperty(t,"parseTableCells",{enumerable:!0,get:function(){return P.parseTableCells}}),Object.defineProperty(t,"createTableRanges",{enumerable:!0,get:function(){return P.createTableRanges}});var O=r(1183);Object.defineProperty(t,"getSegmentTextFormat",{enumerable:!0,get:function(){return O.getSegmentTextFormat}});var w=r(1025);Object.defineProperty(t,"readFile",{enumerable:!0,get:function(){return w.readFile}});var x=r(7293);Object.defineProperty(t,"cacheGetEventData",{enumerable:!0,get:function(){return x.cacheGetEventData}});var F=r(1771);Object.defineProperty(t,"undo",{enumerable:!0,get:function(){return F.undo}});var D=r(4898);Object.defineProperty(t,"redo",{enumerable:!0,get:function(){return D.redo}});var L=r(2717);Object.defineProperty(t,"paste",{enumerable:!0,get:function(){return L.paste}});var j=r(2879);Object.defineProperty(t,"transformColor",{enumerable:!0,get:function(){return j.transformColor}});var N=r(9417);Object.defineProperty(t,"retrieveModelFormatState",{enumerable:!0,get:function(){return N.retrieveModelFormatState}});var I=r(9087);Object.defineProperty(t,"updateImageMetadata",{enumerable:!0,get:function(){return I.updateImageMetadata}});var R=r(6759);Object.defineProperty(t,"updateTableCellMetadata",{enumerable:!0,get:function(){return R.updateTableCellMetadata}});var A=r(7647);Object.defineProperty(t,"updateTableMetadata",{enumerable:!0,get:function(){return A.updateTableMetadata}});var B=r(7364);Object.defineProperty(t,"updateListMetadata",{enumerable:!0,get:function(){return B.updateListMetadata}}),Object.defineProperty(t,"getListStyleTypeFromString",{enumerable:!0,get:function(){return B.getListStyleTypeFromString}});var H=r(8667);Object.defineProperty(t,"ChangeSource",{enumerable:!0,get:function(){return H.ChangeSource}});var z=r(7585);Object.defineProperty(t,"BulletListType",{enumerable:!0,get:function(){return z.BulletListType}});var W=r(2948);Object.defineProperty(t,"NumberingListType",{enumerable:!0,get:function(){return W.NumberingListType}});var G=r(8028);Object.defineProperty(t,"TableBorderFormat",{enumerable:!0,get:function(){return G.TableBorderFormat}});var U=r(230);Object.defineProperty(t,"extractClipboardItems",{enumerable:!0,get:function(){return U.extractClipboardItems}});var K=r(532);Object.defineProperty(t,"Editor",{enumerable:!0,get:function(){return K.Editor}})},1298:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createObjectDefinition=t.createArrayDefinition=t.createStringDefinition=t.createBooleanDefinition=t.createNumberDefinition=void 0,t.createNumberDefinition=function(e,t,r,o,n){return{type:"number",isOptional:e,value:t,maxValue:o,minValue:r,allowNull:n}},t.createBooleanDefinition=function(e,t,r){return{type:"boolean",isOptional:e,value:t,allowNull:r}},t.createStringDefinition=function(e,t,r){return{type:"string",isOptional:e,value:t,allowNull:r}},t.createArrayDefinition=function(e,t,r,o,n){return{type:"array",isOptional:t,itemDef:e,minLength:r,maxLength:o,allowNull:n}},t.createObjectDefinition=function(e,t,r){return{type:"object",isOptional:t,propertyDef:e,allowNull:r}}},9087:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateImageMetadata=void 0;var o=r(8871),n=r(1298),a=(0,n.createNumberDefinition)(),i=(0,n.createObjectDefinition)({widthPx:a,heightPx:a,leftPercent:a,rightPercent:a,topPercent:a,bottomPercent:a,angleRad:a,src:(0,n.createStringDefinition)(),naturalHeight:a,naturalWidth:a});t.updateImageMetadata=function(e,t){return(0,o.updateMetadata)(e,t,i)}},7364:(e,t,r)=>{var o,n;Object.defineProperty(t,"__esModule",{value:!0}),t.updateListMetadata=t.listLevelMetadataApplier=t.listItemMetadataApplier=t.getListStyleTypeFromString=void 0;var a=r(7582),i=r(7585),l=r(8871),s=r(2948),c=r(1298),d=["decimal","lower-alpha","lower-roman"],u=["disc","circle","square"],f=/\$\{(\w+)\}/,p={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},m=((o={})[s.NumberingListType.Decimal]="decimal",o[s.NumberingListType.DecimalDash]='"${Number}- "',o[s.NumberingListType.DecimalParenthesis]='"${Number}) "',o[s.NumberingListType.DecimalDoubleParenthesis]='"(${Number}) "',o[s.NumberingListType.LowerAlpha]="lower-alpha",o[s.NumberingListType.LowerAlphaDash]='"${LowerAlpha}- "',o[s.NumberingListType.LowerAlphaParenthesis]='"${LowerAlpha}) "',o[s.NumberingListType.LowerAlphaDoubleParenthesis]='"(${LowerAlpha}) "',o[s.NumberingListType.UpperAlpha]="upper-alpha",o[s.NumberingListType.UpperAlphaDash]='"${UpperAlpha}- "',o[s.NumberingListType.UpperAlphaParenthesis]='"${UpperAlpha}) "',o[s.NumberingListType.UpperAlphaDoubleParenthesis]='"(${UpperAlpha}) "',o[s.NumberingListType.LowerRoman]="lower-roman",o[s.NumberingListType.LowerRomanDash]='"${LowerRoman}- "',o[s.NumberingListType.LowerRomanParenthesis]='"${LowerRoman}) "',o[s.NumberingListType.LowerRomanDoubleParenthesis]='"(${LowerRoman}) "',o[s.NumberingListType.UpperRoman]="upper-roman",o[s.NumberingListType.UpperRomanDash]='"${UpperRoman}- "',o[s.NumberingListType.UpperRomanParenthesis]='"${UpperRoman}) "',o[s.NumberingListType.UpperRomanDoubleParenthesis]='"(${UpperRoman}) "',o),v=((n={})[i.BulletListType.Disc]="disc",n[i.BulletListType.Square]='" "',n[i.BulletListType.Circle]="circle",n[i.BulletListType.Dash]='"- "',n[i.BulletListType.LongArrow]='" "',n[i.BulletListType.DoubleLongArrow]='" "',n[i.BulletListType.ShortArrow]='" "',n[i.BulletListType.UnfilledArrow]='" "',n[i.BulletListType.Hyphen]='" "',n);function g(e,t){var r="";for(e--;e>=0;)r=String.fromCharCode(e%26+65)+r,e=Math.floor(e/26)-1;return t?r.toLowerCase():r}function h(e,t){var r,o,n="";try{for(var i=(0,a.__values)((0,l.getObjectKeys)(p)),s=i.next();!s.done;s=i.next()){var c=s.value,d=Math.floor(e/p[c]);e-=d*p[c],n+=c.repeat(d)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return t?n.toLocaleLowerCase():n}var b=(0,c.createObjectDefinition)({orderedStyleType:(0,c.createNumberDefinition)(!0,void 0,s.NumberingListType.Min,s.NumberingListType.Max),unorderedStyleType:(0,c.createNumberDefinition)(!0,void 0,i.BulletListType.Min,i.BulletListType.Max),applyListStyleFromLevel:(0,c.createBooleanDefinition)(!0)},!0,!0);function y(e){return e.indexOf('"')>=0}function S(e,t,r){var o=t.orderedStyleType,n=t.unorderedStyleType,a=t.applyListStyleFromLevel;return"OL"==e?"number"==typeof o?m[o]:a?d[r%d.length]:void 0:"number"==typeof n?v[n]:a?u[r%u.length]:void 0}t.getListStyleTypeFromString=function(e,t){var r="OL"==e?m:v,o=(0,l.getObjectKeys)(r).find((function(e){return r[e]==t}));return o&&"string"==typeof o?parseInt(o):o},t.listItemMetadataApplier={metadataDefinition:b,applierFunction:function(e,t,r){var o,n,a,i=r.listFormat.nodeStack.length-2;if(i>=0){var l=null!==(o=r.listFormat.nodeStack[i+1].listType)&&void 0!==o?o:"OL",s=S(l,null!=e?e:{},i);s&&(y(s)?t.listStyleType="OL"==l?(n=s,a=r.listFormat.threadItemCounts[i],n?n.replace(f,(function(e,t){switch(t){case"Number":return a+"";case"LowerAlpha":return g(a,!0);case"UpperAlpha":return g(a,!1);case"LowerRoman":return h(a,!0);case"UpperRoman":return h(a,!1)}return""})):void 0):s:delete t.listStyleType)}}},t.listLevelMetadataApplier={metadataDefinition:b,applierFunction:function(e,t,r){var o,n=r.listFormat.nodeStack.length-2;if(n>=0){var a=S(null!==(o=r.listFormat.nodeStack[n+1].listType)&&void 0!==o?o:"OL",null!=e?e:{},n);a&&(y(a)?delete t.listStyleType:t.listStyleType=a)}}},t.updateListMetadata=function(e,t){return(0,l.updateMetadata)(e,t,b)}},6759:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateTableCellMetadata=void 0;var o=r(1298),n=r(8871),a=(0,o.createObjectDefinition)({bgColorOverride:(0,o.createBooleanDefinition)(!0),vAlignOverride:(0,o.createBooleanDefinition)(!0),borderOverride:(0,o.createBooleanDefinition)(!0)},!1,!0);t.updateTableCellMetadata=function(e,t){return(0,n.updateMetadata)(e,t,a)}},7647:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateTableMetadata=void 0;var o=r(8028),n=r(8871),a=r(1298),i=(0,a.createStringDefinition)(!1,void 0,!0),l=(0,a.createBooleanDefinition)(!1),s=(0,a.createObjectDefinition)({topBorderColor:i,bottomBorderColor:i,verticalBorderColor:i,hasHeaderRow:l,headerRowColor:i,hasFirstColumn:l,hasBandedColumns:l,hasBandedRows:l,bgColorEven:i,bgColorOdd:i,tableBorderFormat:(0,a.createNumberDefinition)(!1,void 0,o.TableBorderFormat.Min,o.TableBorderFormat.Max),verticalAlign:i},!1,!0);t.updateTableMetadata=function(e,t){return(0,n.updateMetadata)(e,t,s)}},2530:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteExpandedSelection=void 0;var o=r(7582),n=r(3190),a=r(2965),i=r(1183),l=r(3193),s=r(8871),c={contentUnderSelectedTableCell:"ignoreForTableOrCell",contentUnderSelectedGeneralElement:"generalElementOnly",includeListFormatHolder:"never"};function d(e,t,r,o){return{marker:e,paragraph:t,path:r,tableContext:o}}t.deleteExpandedSelection=function(e,t){var r={deleteResult:"notDeleted",insertPoint:null,formatContext:t};return(0,l.iterateSelections)(e,(function(t,l,c,u){var f=(0,s.createParagraph)(!0,void 0,e.format),p=e.format,m=0;if(u)u[0]&&"Paragraph"==(null==c?void 0:c.blockType)&&(m=(f=c).segments.indexOf(u[0]),p=(0,i.getSegmentTextFormat)(u[0]),r.lastParagraph=f,r.lastTableContext=l,u.forEach((function(e,o){0!=o||r.insertPoint||"SelectionMarker"!=e.segmentType?(0,a.deleteSegment)(c,e,r.formatContext)&&(r.deleteResult="range"):r.insertPoint=d(e,c,t,l)})),"range"==r.deleteResult&&(0,s.setParagraphNotImplicit)(c));else if(c){var v=t[0].blocks;(0,n.deleteBlock)(v,c,f,r.formatContext)&&(r.deleteResult="range")}else if(l){var g=l.table,h=l.colIndex,b=l.rowIndex,y=g.rows[b],S=y.cells[h];t=(0,o.__spreadArray)([S],(0,o.__read)(t),!1),f.segments.push((0,s.createBr)(e.format)),S.blocks=[f],delete S.cachedElement,delete y.cachedElement,r.deleteResult="range"}if(!r.insertPoint){var C=(0,s.createSelectionMarker)(p);(0,s.setParagraphNotImplicit)(f),f.segments.splice(m,0,C),r.insertPoint=d(C,f,t,l)}}),c),r}},3830:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSingleChar=void 0;var o=r(7582);t.deleteSingleChar=function(e,t){for(var r=(0,o.__spreadArray)([],(0,o.__read)(e),!1),n=0,a=t?0:r.length-1,i="notDeleted";a>=0&&a<r.length&&"done"!=i;a+=t?1:-1)switch(r[a]){case"":case"":case"":case"":i="notDeleted",n++;break;default:"notDeleted"==i?(i="waiting",n++):"waiting"==i&&(i="done")}return r.splice(t?0:r.length-n,n),r.join("")}},351:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.containerSizeFormatParser=void 0,t.containerSizeFormatParser=function(e,t){"DIV"==t.tagName&&(delete e.width,delete e.height)}},3311:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pasteBlockEntityParser=t.onCreateCopyEntityNode=void 0;var o=r(8871),n="_EBlock",a="100%",i="inline-block";t.onCreateCopyEntityNode=function(e,t){var r=e;r&&r.wrapper&&"Entity"==r.blockType&&(0,o.isNodeOfType)(t,"ELEMENT_NODE")&&(0,o.isElementOfType)(t,"div")&&!(0,o.isBlockElement)(r.wrapper)&&r.wrapper.style.display==i&&r.wrapper.style.width==a&&(t.classList.add(n),t.style.display="block",t.style.width="")},t.pasteBlockEntityParser=function(e,t){t.classList.contains(n)&&(t.classList.remove(n),t.style.display=i,t.style.width=a)}},5452:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pasteDisplayFormatParser=void 0,t.pasteDisplayFormatParser=function(e,t){var r=t.style.display;r&&"flex"!=r&&(e.display=r)}},59:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPasteEntityProcessor=void 0;var o=r(6291),n={position:!1};t.createPasteEntityProcessor=function(e){var t=o.AllowedTags.concat(e.additionalAllowedTags),r=o.DisallowedTags.concat(e.additionalDisallowedTags),a=Object.assign({},n,e.styleSanitizers),i=e.attributeSanitizers;return function(e,n,l){var s=(0,o.sanitizeElement)(n,t,r,a,i);s&&l.defaultElementProcessors.entity(e,s,l)}}},612:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPasteGeneralProcessor=t.removeDisplayFlex=void 0;var o=r(6291),n=r(8871);t.removeDisplayFlex=function(e){return"flex"==e?null:e};var a={position:!1,display:t.removeDisplayFlex};t.createPasteGeneralProcessor=function(e){var t=o.AllowedTags.concat(e.additionalAllowedTags),r=o.DisallowedTags.concat(e.additionalDisallowedTags),i=Object.assign({},a,e.styleSanitizers),l=e.attributeSanitizers;return function(e,a,s){var c=a.tagName.toLowerCase(),d=t.indexOf(c)>=0?function(e,t,r){var a,s,c=(0,o.createSanitizedElement)(t.ownerDocument,t.tagName,t.attributes,i,l);(0,n.moveChildNodes)(c,t),null===(s=(a=r.defaultElementProcessors)["*"])||void 0===s||s.call(a,e,c,r)}:r.indexOf(c)>=0?void 0:s.defaultElementProcessors.span;null==d||d(e,a,s)}}},3046:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pasteTextProcessor=void 0;var o=r(8871);t.pasteTextProcessor=function(e,t,r){var n,a,i=r.blockFormat.whiteSpace;(0,o.isWhiteSpacePreserved)(i)&&(t.nodeValue=null!==(a=null===(n=t.nodeValue)||void 0===n?void 0:n.replace(/\u0020\u0020/g," "))&&void 0!==a?a:""),r.defaultElementProcessors["#text"](e,t,r)}},7666:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reducedModelChildProcessor=void 0;var o=r(7582),n=r(7309),a=r(8871);t.reducedModelChildProcessor=function(e,t,r){if(!r.nodeStack){var i=(0,n.getSelectionRootNode)(r.selection);r.nodeStack=i?function(e,t){for(var r=[],o=t;o&&e!=o&&e.contains(o);)(0,a.isNodeOfType)(o,"ELEMENT_NODE")&&"TABLE"==o.tagName?r.splice(0,r.length,o):r.push(o),o=o.parentNode;return r}(t,i):[]}var l=r.nodeStack.pop();if(l){var s=(0,o.__read)((0,a.getRegularSelectionOffsets)(r,t),2),c=s[0],d=s[1],u=c>=0||d>=0?function(e,t){for(var r=0,o=e.firstChild;o&&o!=t;)r++,o=o.nextSibling;return r}(t,l):-1;u>=0&&(0,a.handleRegularSelection)(u,r,e,c,d),(0,a.processChildNode)(e,l,r),u>=0&&(0,a.handleRegularSelection)(u+1,r,e,c,d)}else r.defaultElementProcessors.child(e,t,r)}},2291:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tablePreProcessor=void 0;var o=r(8871),n=r(7309);t.tablePreProcessor=function(e,t,r){var a=function(e,t){var r=(0,n.getSelectionRootNode)(t.selection);return(0,o.hasMetadata)(e)||t.isInSelection||r&&e.contains(r)}(t,r)?o.tableProcessor:o.entityProcessor;a(e,t,r)}},2879:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.transformColor=void 0;var o=r(8871);function n(e,t,r){r&&a(e)&&t(e);for(var o=e.firstChild;o;o=o.nextSibling)a(o)&&t(o),n(o,t)}function a(e){var t=e;return e.nodeType==Node.ELEMENT_NODE&&!!t.style}t.transformColor=function(e,t,r,a){var i="lightToDark"==r;n(e,(function(e){var t=(0,o.getColor)(e,!1,!i,a),r=(0,o.getColor)(e,!0,!i,a);(0,o.setColor)(e,t,!1,i,a),(0,o.setColor)(e,r,!0,i,a)}),t)}},3811:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.combineBorderValue=t.extractBorderValues=void 0;var r=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"],o=/^(thin|medium|thick|[\d\.]+\w*)$/;t.extractBorderValues=function(e){var t={};return(e||"").replace(/, /g,",").split(" ").forEach((function(e){r.indexOf(e)>=0&&!t.style?t.style=e:o.test(e)&&!t.width?t.width=e:e&&!t.color&&(t.color=e)})),t},t.combineBorderValue=function(e){return[e.width||"",e.style||"",e.color||""].join(" ").trim()||"none"}},7293:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cacheGetEventData=void 0,t.cacheGetEventData=function(e,t,r){var o=e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:r(e);return e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=o,o}},7416:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCursorMovingKey=t.isCharacterValue=t.isModifierKey=void 0;var r=new Set(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"]);function o(e){var t=e.ctrlKey||"Control"===e.key,r=e.altKey||"Alt"===e.key,o=e.metaKey||"Meta"===e.key;return t||r||o}t.isModifierKey=o,t.isCharacterValue=function(e){return!o(e)&&!!e.key&&1==e.key.length},t.isCursorMovingKey=function(e){return r.has(e.key)}},1183:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSegmentTextFormat=void 0,t.getSegmentTextFormat=function(e){var t,o=null!==(t=null==e?void 0:e.format)&&void 0!==t?t:{},n=o.fontFamily,a=o.fontSize,i=o.textColor,l=o.backgroundColor,s=o.letterSpacing,c=o.lineHeight;return r({fontFamily:n,fontSize:a,textColor:i,backgroundColor:l,letterSpacing:s,lineHeight:c})};var r=function(e){var t={};return Object.keys(e).filter((function(r){var o=e[r];void 0!==o&&(t[r]=o)})),t}},2171:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizePos=void 0;var o=r(8871);t.normalizePos=function(e,t){var r,n,a,i,l=(0,o.isNodeOfType)(e,"TEXT_NODE")?null!==(n=null===(r=e.nodeValue)||void 0===r?void 0:r.length)&&void 0!==n?n:0:e.childNodes.length;for(t=Math.max(Math.min(t,l),0);null==e?void 0:e.lastChild;)t>=e.childNodes.length?(e=e.lastChild,t=(0,o.isNodeOfType)(e,"TEXT_NODE")?null!==(i=null===(a=e.nodeValue)||void 0===a?void 0:a.length)&&void 0!==i?i:0:e.childNodes.length):(e=e.childNodes[t],t=0);return{node:e,offset:t}}},1025:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.readFile=void 0,t.readFile=function(e,t){if(e){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=function(){t(null)},r.readAsDataURL(e)}}},9533:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeText=t.isSpace=t.isPunctuation=void 0;var r=/[\u2000\u2009\u200a\u200b\u202f\u205f\u3000\s\t\r\n]/gm;t.isPunctuation=function(e){return'.,?!:"()[]\\/'.indexOf(e)>=0},t.isSpace=function(e){var t,o=null!==(t=null==e?void 0:e.charCodeAt(0))&&void 0!==t?t:0;return 160==o||32==o||r.test(e)},t.normalizeText=function(e,t){return e.replace(t?/^\u0020+/:/\u0020+$/,"")}},4399:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTableRanges=t.findCoordinate=t.findLastedCoInMergedCell=t.findTableCellElement=t.parseTableCells=void 0;var o=r(8871);function n(e){var t=(0,o.toArray)(e.rows),r=t.map((function(e){return[]}));return t.forEach((function(e,t){for(var o=0,n=0;o<e.cells.length;o++){for(;void 0!==r[t][n];n++);for(var a=e.cells[o],i=0;i<a.colSpan;i++,n++)for(var l=0;l<a.rowSpan;l++)r[t+l]&&(r[t+l][n]=0==i?0==l?a:"spanTop":0==l?"spanLeft":"spanBoth")}for(var s=0;s<r[t].length;s++)r[t][s]=r[t][s]||null})),r}t.parseTableCells=n,t.findTableCellElement=function(e,t){for(var r,o,n,a=t.row,i=t.col;a>=0&&i>=0&&a<e.length&&i<(null!==(o=null===(r=e[a])||void 0===r?void 0:r.length)&&void 0!==o?o:0);){var l=null===(n=e[a])||void 0===n?void 0:n[i];if(!l)break;if("object"==typeof l)return{cell:l,row:a,col:i};"spanLeft"==l||"spanBoth"==l?i--:a--}return null},t.findLastedCoInMergedCell=function(e,t){for(var r,o,n,a,i=t.row,l=t.col;i>=0&&l>=0&&i<e.length&&l<(null!==(o=null===(r=e[i])||void 0===r?void 0:r.length)&&void 0!==o?o:0);){var s=null===(n=e[i])||void 0===n?void 0:n[l+1],c=null===(a=e[i+1])||void 0===a?void 0:a[l];if("spanLeft"==s||"spanBoth"==s)l++;else{if("spanTop"!=c&&"spanBoth"!=c)return{row:i,col:l};i++}}return null},t.findCoordinate=function(e,t,r){var o=r.findClosestElementAncestor(t,"TH,TD"),n=null;return o&&e.some((function(e,t){var r=o?e.indexOf(o):-1;return n=r>=0?{row:t,col:r}:null})),n||e.some((function(e,r){var o=e.findIndex((function(e){return"object"==typeof e&&e.contains(t)}));return n=o>=0?{row:r,col:o}:null})),n},t.createTableRanges=function(e){for(var t,r=[],o=e.table,a=e.firstColumn,i=e.firstRow,l=e.lastColumn,s=e.lastRow,c=n(o),d=i;d<=s;d++)for(var u=a;u<=l;u++){var f=null===(t=c[d])||void 0===t?void 0:t[u];if("object"==typeof f){var p=o.ownerDocument.createRange();p.selectNode(f),r.push(p)}}return r}},9417:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveModelFormatState=void 0;var o=r(3811),n=r(5513),a=r(1606),i=r(3193),l=r(8871),s=r(7647);function c(e,t,r,o,n){void 0===n&&(n=function(e){return e}),o?void 0!==r&&(e[t]=r):n(r)!==n(e[t])&&delete e[t]}t.retrieveModelFormatState=function(e,t,r){var d,u,f,p=!0,m=!0,v=!0;(0,i.iterateSelections)(e,(function(i,f,g,h){if(function(e,t,r){var o,a,i=(0,n.getClosestAncestorBlockGroupIndex)(t,["ListItem"],[]),l=(0,n.getClosestAncestorBlockGroupIndex)(t,["FormatContainer"],[]);if(i>=0){var s=t[i],d=null===(o=null==s?void 0:s.levels[s.levels.length-1])||void 0===o?void 0:o.listType;c(e,"isBullet","UL"==d,r),c(e,"isNumbering","OL"==d,r)}c(e,"isBlockQuote",l>=0&&"blockquote"==(null===(a=t[l])||void 0===a?void 0:a.tagName),r)}(r,i,p),g&&(u?r.isMultilineSelection=!0:u=g),"Paragraph"==(null==g?void 0:g.blockType)&&(function(e,t,r){var o,n=parseInt(((null===(o=t.decorator)||void 0===o?void 0:o.tagName)||"").substring(1)),a=n>=1&&n<=6?n:void 0;c(e,"marginBottom",t.format.marginBottom,r),c(e,"marginTop",t.format.marginTop,r),c(e,"headingLevel",a,r),c(e,"textAlign",t.format.textAlign,r),c(e,"direction",t.format.direction,r)}(r,g,p),null==h||h.forEach((function(n){var i,s,d,u,f,b,y,S,C;if(v||"SelectionMarker"!=n.segmentType){var _=Object.assign({},e.format);null==_||delete _.italic,null==_||delete _.underline,null==_||delete _.fontWeight,function(e,t,r){var o,n,i=null===(n=null===(o=r.superOrSubScriptSequence)||void 0===o?void 0:o.split(" "))||void 0===n?void 0:n.pop();c(e,"isBold",(0,a.isBold)(r.fontWeight),t),c(e,"isItalic",r.italic,t),c(e,"isUnderline",r.underline,t),c(e,"isStrikeThrough",r.strikethrough,t),c(e,"isSuperscript","super"==i,t),c(e,"isSubscript","sub"==i,t),c(e,"letterSpacing",r.letterSpacing,t),c(e,"fontName",r.fontFamily,t),c(e,"fontSize",r.fontSize,t,(function(e){return(0,l.parseValueWithUnit)(e,void 0,"pt")+"pt"})),c(e,"backgroundColor",r.backgroundColor,t),c(e,"textColor",r.textColor,t),c(e,"fontWeight",r.fontWeight,t),c(e,"lineHeight",r.lineHeight,t)}(r,p,Object.assign({},_,g.format,null===(i=g.decorator)||void 0===i?void 0:i.format,n.format,null===(s=n.code)||void 0===s?void 0:s.format,null===(d=n.link)||void 0===d?void 0:d.format,t)),c(r,"isCodeInline",!!(null==n?void 0:n.code),p)}v=!1,r.canUnlink=r.canUnlink||!!n.link,r.canAddImageAltText=r.canAddImageAltText||h.some((function(e){return"Image"==e.segmentType})),p=!1,"Image"===n.segmentType&&(m?(u=r,f=n.format,"borderTop",y=(b=(0,o.extractBorderValues)(f.borderTop)).color,S=b.width,C=b.style,u.imageFormat={borderColor:y,borderWidth:S,borderStyle:C,boxShadow:f.boxShadow,borderRadius:f.borderRadius},m=!1):r.imageFormat=void 0)})),p=!1),f)if(d){var b=d.table,y=d.colIndex,S=d.rowIndex;f.table!=b||f.colIndex==y&&f.rowIndex==S||(r.canMergeTableCell=!0,r.isMultilineSelection=!0)}else!function(e,t){var r=(0,s.updateTableMetadata)(e.table);t.isInTable=!0,t.tableHasHeader=e.table.rows.some((function(e){return e.cells.some((function(e){return e.isHeader}))})),r&&(t.tableFormat=r)}(f,r),d=f}),{includeListFormatHolder:"never"}),r.fontSize&&(r.fontSize=(f=r.fontSize)&&f.indexOf("px")==f.length-2?Math.round(75*parseFloat(f)+.05)/100+"pt":f)}},464:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cloneModel=void 0;var o=r(7582);function n(e){return{format:Object.assign({},e.format)}}function a(e){return{dataset:Object.assign({},e.dataset)}}function i(e){var t=e.blockType;return Object.assign({blockType:t},n(e))}function l(e,t){return{blockGroupType:e.blockGroupType,blocks:e.blocks.map((function(e){return function(e,t){switch(e.blockType){case"BlockGroup":switch(e.blockGroupType){case"FormatContainer":return function(e,t){var r=e.tagName,o=e.cachedElement,n=Object.assign({tagName:r,cachedElement:p(o,"cache",t)},i(e),l(e,t));return e.zeroFontSize&&(n.zeroFontSize=!0),n}(e,t);case"General":return u(e,t);case"ListItem":return function(e,t){var r=e.formatHolder,o=e.levels;return Object.assign({formatHolder:f(r),levels:o.map(d)},i(e),l(e,t))}(e,t)}break;case"Divider":return function(e,t){var r=e.tagName,o=e.isSelected,n=e.cachedElement;return Object.assign({isSelected:o,tagName:r,cachedElement:p(n,"cache",t)},i(e))}(e,t);case"Entity":return c(e,t);case"Paragraph":return function(e,t){var r=e.cachedElement,l=e.segments,d=e.isImplicit,m=e.decorator,v=e.segmentFormat,g=Object.assign({cachedElement:p(r,"cache",t),isImplicit:d,segments:l.map((function(e){return function(e,t){switch(e.segmentType){case"Br":return s(e);case"Entity":return c(e,t);case"General":return function(e,t){return Object.assign(u(e,t),s(e))}(e,t);case"Image":return i=(n=e).src,l=n.alt,d=n.title,p=n.isSelectedAsImageSelection,Object.assign({src:i,alt:l,title:d,isSelectedAsImageSelection:p},s(n),a(n));case"SelectionMarker":return f(e);case"Text":return o=(r=e).text,Object.assign({text:o},s(r))}var r,o,n,i,l,d,p}(e,t)})),segmentFormat:v?(0,o.__assign)({},v):void 0},i(e),n(e));return m&&(g.decorator=Object.assign({tagName:m.tagName},n(m))),g}(e,t);case"Table":return function(e,t){var r=e.cachedElement,o=e.widths,s=e.rows;return Object.assign({cachedElement:p(r,"cache",t),widths:Array.from(o),rows:s.map((function(e){return function(e,t){var r=e.height,o=e.cells,i=e.cachedElement;return Object.assign({height:r,cachedElement:p(i,"cache",t),cells:o.map((function(e){return function(e,t){var r=e.cachedElement,o=e.isSelected,i=e.spanAbove,s=e.spanLeft,c=e.isHeader;return Object.assign({cachedElement:p(r,"cache",t),isSelected:o,spanAbove:i,spanLeft:s,isHeader:c},l(e,t),n(e),a(e))}(e,t)}))},n(e))}(e,t)}))},i(e),a(e))}(e,t)}}(e,t)}))}}function s(e){var t=e.segmentType,r=e.isSelected,o=e.code,i=e.link,l=Object.assign({segmentType:t,isSelected:r},n(e));return o&&(l.code=n(o)),i&&(l.link=Object.assign(n(i),a(i))),l}function c(e,t){var r=e.wrapper,n=e.entityFormat;return Object.assign({wrapper:p(r,"entity",t),entityFormat:(0,o.__assign)({},n)},i(e),s(e))}function d(e){var t=e.listType;return Object.assign({listType:t},n(e),a(e))}function u(e,t){var r=e.element;return Object.assign({element:p(r,"general",t)},i(e),l(e,t))}function f(e){return Object.assign({isSelected:e.isSelected},s(e))}function p(e,t,r){var o=r.includeCachedElement;if(e){if(o){if(!0===o)return e;var n=o(e,t);if(("general"==t||"entity"==t)&&!n)throw new Error("Entity and General Model must has wrapper element");return n}return"cache"==t?void 0:e.cloneNode(!0)}}t.cloneModel=function(e,t){var r=l(e,t||{});return e.format&&(r.format=Object.assign({},e.format)),r}},6683:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createModelFromHtml=void 0;var o=r(8317),n=r(1424),a=r(8871);t.createModelFromHtml=function(e,t,r,i){var l,s=e?(new DOMParser).parseFromString(null!==(l=null==r?void 0:r(e))&&void 0!==l?l:e,"text/html"):null;if(null==s?void 0:s.body){var c=(0,n.createDomToModelContextForSanitizing)(s,i,t),d=s?(0,o.retrieveCssRules)(s):[];return(0,o.convertInlineCss)(s,d),(0,a.parseFormat)(s.body,c.formatParsers.segmentOnBlock,c.segmentFormat,c),(0,a.domToContentModel)(s.body,c)}return(0,a.createEmptyModel)(i)}},2666:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.exportContent=void 0;var o=r(8871);t.exportContent=function(e,t,r){if(void 0===t&&(t="HTML"),"PlainTextFast"==t)return e.getDOMHelper().getTextContent();var n=e.getContentModelCopy("clean");if("PlainText"==t)return(0,o.contentModelToText)(n);var a=e.getDocument(),i=a.createElement("div");return(0,o.contentModelToDom)(a,i,n,(0,o.createModelToDomContext)(void 0,r)),e.triggerEvent("extractContentWithDom",{clonedRoot:i},!0),i.innerHTML}},5513:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getClosestAncestorBlockGroupIndex=void 0,t.getClosestAncestorBlockGroupIndex=function(e,t,r){void 0===r&&(r=[]);for(var o=0;o<e.length;o++){var n=e[o];if(t.indexOf(n.blockGroupType)>=0)return o;if(r.indexOf(n.blockGroupType)>=0)return-1}return-1}},5094:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBlockGroupOfType=void 0,t.isBlockGroupOfType=function(e,t){return(null==e?void 0:e.blockGroupType)==t}},1606:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBold=void 0,t.isBold=function(e){return!!e&&("bold"==e||"bolder"==e||parseInt(e)>=600)}},578:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeModel=void 0;var o=r(7582),n=r(785),a=r(4470),i=r(5513),l=r(7900),s=r(8871),c=["h1","h2","h3","h4","h5","h6"];function d(e,t,r,n,a){var i=e.paragraph,l=e.marker,d=r?i:p(e,t.format),u=d.segments.indexOf(l);if("none"==(null==a?void 0:a.mergeFormat)&&r&&(d.segments.forEach((function(e){e.format=(0,o.__assign)((0,o.__assign)({},d.segmentFormat||{}),e.format)})),delete d.segmentFormat),u>=0)for(var f=0;f<t.segments.length;f++){var m=t.segments[f];d.segments.splice(u+f,0,m),n&&("Entity"==m.segmentType&&n.newEntities.push(m),"Image"==m.segmentType&&n.newImages.push(m))}if(t.decorator&&(d.decorator=(0,o.__assign)({},t.decorator),c.indexOf(d.decorator.tagName)>-1)){var v=(0,s.getObjectKeys)(d.decorator.format),g=(0,s.getObjectKeys)(d.segmentFormat||{});v.forEach((function(e){var t;g.indexOf(e)>-1&&(null===(t=d.segmentFormat)||void 0===t||delete t[e])}))}d.format=r?(0,o.__assign)((0,o.__assign)({},d.format),t.format):t.format}function u(e,t,r){var o,a,i=e.tableContext,c=e.marker;if(i&&1==r.blocks.length&&r.blocks[0]==t){for(var d=i.table,u=i.colIndex,f=i.rowIndex,p=0;p<t.rows.length;p++)for(var v=0;v<t.rows[p].cells.length;v++){var g=t.rows[p].cells[v];if(0==p&&u+v>=d.rows[0].cells.length)for(var h=0;h<d.rows.length;h++){var b=null===(o=d.rows[h])||void 0===o?void 0:o.cells[u+v-1];d.rows[h].cells[u+v]=(0,s.createTableCell)(!1,!1,null==b?void 0:b.isHeader,null==b?void 0:b.format)}if(0==v&&f+p>=d.rows.length)for(d.rows[f+p]||(d.rows[f+p]={cells:[],format:{},height:0}),h=0;h<d.rows[f].cells.length;h++){var y=null===(a=d.rows[f+p-1])||void 0===a?void 0:a.cells[h];d.rows[f+p].cells[h]=(0,s.createTableCell)(!1,!1,!1,null==y?void 0:y.format)}var S=d.rows[f+p].cells[u+v];if(d.rows[f+p].cells[u+v]=g,0==p&&0==v){var C=(0,s.createSelectionMarker)(c.format),_=(0,s.addSegment)(g,C);e.path[0]==S&&(e.path[0]=g,e.marker=C,e.paragraph=_)}}(0,l.normalizeTable)(d,e.marker.format),(0,n.applyTableFormat)(d,void 0,!0)}else m(e,t)}function f(e,t){p(e,t.format);var r=e.path,n=e.paragraph,a=(0,i.getClosestAncestorBlockGroupIndex)(r,["ListItem"]),l=r[a],s=r[a+1],c=s.blocks.indexOf(l||n);c>=0&&s.blocks.splice(c,0,t),l&&(null==l||l.levels.forEach((function(e,r){t.levels[r]=(0,o.__assign)({},e)})))}function p(e,t){var r=e.paragraph,n=e.marker,a=e.path,l=r.segments.indexOf(n),c=a[0].blocks.indexOf(r),d=(0,s.createParagraph)(!1,(0,o.__assign)((0,o.__assign)({},r.format),t),r.segmentFormat);l>=0&&(d.segments=r.segments.splice(l)),c>=0&&a[0].blocks.splice(c+1,0,d);var u=(0,i.getClosestAncestorBlockGroupIndex)(a,["ListItem"],["FormatContainer","TableCell"]),f=a[u];if(f){var p=u>=0?a[u+1]:null,m=p?p.blocks.indexOf(f):-1;if(m>=0&&p){var v=(0,s.createListItem)(f.levels,f.formatHolder.format);c>=0&&(v.blocks=f.blocks.splice(c+1)),m>=0&&p.blocks.splice(m+1,0,v),a[u]=v}}return e.paragraph=d,d}function m(e,t){var r=e.path,o=p(e,"Paragraph"!==t.blockType?{}:t.format),n=r[0].blocks.indexOf(o);n>=0&&r[0].blocks.splice(n,0,t)}function v(e,t,r){e.blocks.forEach((function(e){var n;switch(function(e,t){"keepSourceEmphasisFormat"==e&&t.format.backgroundColor&&delete t.format.backgroundColor}(r,e),e.blockType){case"BlockGroup":"ListItem"==e.blockGroupType&&(e.formatHolder.format=g(r,t,e.formatHolder.format)),v(e,t,r);break;case"Table":e.rows.forEach((function(e){return e.cells.forEach((function(e){v(e,t,r)}))}));break;case"Paragraph":var a=(null===(n=e.decorator)||void 0===n?void 0:n.format)||{};e.segments.forEach((function(e){"General"==e.segmentType&&v(e,t,r),e.format=g(r,t,(0,o.__assign)((0,o.__assign)({},a),e.format))})),"keepSourceEmphasisFormat"===r&&delete e.decorator}}))}function g(e,t,r){return"mergeAll"==e?(0,o.__assign)((0,o.__assign)({},t),r):(0,o.__assign)((0,o.__assign)({},t),(a={},i=(n=r).fontWeight,l=n.italic,s=n.underline,i&&"normal"!=i&&(a.fontWeight=i),l&&(a.italic=l),s&&(a.underline=s),a));var n,a,i,l,s}t.mergeModel=function(e,t,r,n){var i,l=null!==(i=null==n?void 0:n.insertPosition)&&void 0!==i?i:(0,a.deleteSelection)(e,[],r).insertPoint;if(l){(null==n?void 0:n.mergeFormat)&&"none"!=n.mergeFormat&&v(t,(0,o.__assign)((0,o.__assign)({},e.format||{}),l.marker.format),null==n?void 0:n.mergeFormat);for(var c=0;c<t.blocks.length;c++){var p=t.blocks[c];switch(p.blockType){case"Paragraph":d(l,p,0==c,r,n);break;case"Divider":m(l,p);break;case"Entity":m(l,p),null==r||r.newEntities.push(p);break;case"Table":1==t.blocks.length&&(null==n?void 0:n.mergeTable)?u(l,p,t):m(l,p);break;case"BlockGroup":switch(p.blockGroupType){case"General":case"FormatContainer":m(l,p);break;case"ListItem":f(l,p)}}}}return(0,s.normalizeContentModel)(e),l}},2717:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.paste=void 0;var o=r(3232),n=r(8317),a=r(654),i=r(4101),l=r(534);function s(e,t){return e?(new DOMParser).parseFromString(t(e),"text/html"):null}t.paste=function(e,t,r){var c;void 0===r&&(r="normal"),e.focus();var d=e.getTrustedHTMLHandler();t.modelBeforePaste||(t.modelBeforePaste=(0,o.cloneModelForPaste)(e.getContentModelCopy("connected")));var u=s(t.rawHtml,d),f=(0,l.retrieveHtmlInfo)(u,t),p=(0,a.createPasteFragment)(e.getDocument(),t,r,null===(c=t.rawHtml==t.html?u:s(t.html,d))||void 0===c?void 0:c.body),m=(0,i.generatePasteOptionFromPlugins)(e,t,p,f,r);(0,n.convertInlineCss)(m.fragment,f.globalCssRules),(0,o.mergePasteContent)(e,m,t)}},4946:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstSelectedListItem=t.getFirstSelectedTable=t.getOperationalBlocks=t.getSelectedParagraphs=t.getSelectedSegments=t.getSelectedSegmentsAndParagraphs=void 0;var o=r(7582),n=r(5513),a=r(5094),i=r(3193);function l(e,t){var r=c(e,{includeListFormatHolder:t?"allSegments":"never"}),o=[];return r.forEach((function(e){var r=e.segments,n=e.block;r&&(t&&!n||"Paragraph"==(null==n?void 0:n.blockType))&&r.forEach((function(e){"Entity"==e.segmentType&&e.entityFormat.isReadonly||o.push([e,"Paragraph"==(null==n?void 0:n.blockType)?n:null])}))})),o}function s(e,t,r,o){var a=[],i=o?t.map((function(e){return[e]})):[t],l=c(e,{includeListFormatHolder:"never",contentUnderSelectedTableCell:"ignoreForTable"});return d(l),l.forEach((function(e){for(var t=e.path,o=e.block,l=function(e){var l=(0,n.getClosestAncestorBlockGroupIndex)(t,i[e],r);return l>=0?(a.filter((function(e){return e.block==t[l]})).length<=0&&a.push({parent:t[l+1],block:t[l],path:t.slice(l+1)}),"break"):e==i.length-1&&o?(a.push({parent:t[0],block:o,path:t}),"break"):void 0},s=0;s<i.length&&"break"!==l(s);s++);})),a}function c(e,t){var r=[];return(0,i.iterateSelections)(e,(function(e,t,o,n){r.push({path:e,tableContext:t,block:o,segments:n})}),t),r}function d(e){e.length>1&&u(e,!1)&&e.pop(),e.length>1&&u(e,!0)&&e.shift()}function u(e,t){var r,o=e[t?0:e.length-1];if("Paragraph"==(null===(r=o.block)||void 0===r?void 0:r.blockType)&&o.segments&&o.segments.length>0){var n=o.block.segments,a=o.segments[0];return 1==o.segments.length&&"SelectionMarker"==a.segmentType&&a==n[t?n.length-1:0]}return!1}t.getSelectedSegmentsAndParagraphs=l,t.getSelectedSegments=function(e,t){return l(e,t).map((function(e){return e[0]}))},t.getSelectedParagraphs=function(e){var t=c(e,{includeListFormatHolder:"never"}),r=[];return d(t),t.forEach((function(e){var t=e.block;"Paragraph"==(null==t?void 0:t.blockType)&&r.push(t)})),r},t.getOperationalBlocks=s,t.getFirstSelectedTable=function(e){var t,r=c(e,{includeListFormatHolder:"never"}),n=[];return d(r),r.forEach((function(e){var r=e.block,a=e.tableContext,i=e.path;if(!t)if("Table"==(null==r?void 0:r.blockType))t=r,n=(0,o.__spreadArray)([],(0,o.__read)(i),!1);else if(null==a?void 0:a.table){t=a.table;var l=i.filter((function(e){return e.blocks.indexOf(a.table)>=0}))[0],s=i.indexOf(l);n=s>=0?i.slice(s):[]}})),[t,n]},t.getFirstSelectedListItem=function(e){var t;return s(e,["ListItem"],["TableCell"]).forEach((function(e){!t&&(0,a.isBlockGroupOfType)(e.block,"ListItem")&&(t=e.block)})),t}},3190:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBlock=void 0,t.deleteBlock=function(e,t,r,o,n){var a=e.indexOf(t);switch(t.blockType){case"Table":case"Divider":return r?e.splice(a,1,r):e.splice(a,1),!0;case"Entity":var i=t.isSelected?"overwrite":"forward"==n?"removeFromStart":"backward"==n?"removeFromEnd":void 0;return void 0!==i&&(r?e.splice(a,1,r):e.splice(a,1),null==o||o.deletedEntities.push({entity:t,operation:i})),!0;case"BlockGroup":switch(t.blockGroupType){case"General":return!!r&&(e.splice(a,1,r),!0);case"ListItem":case"FormatContainer":return e.splice(a,1),!0}}return!1}},2965:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSegment=void 0;var o=r(3830),n=r(8871),a=r(9533);t.deleteSegment=function(e,t,r,i){var l=e.segments,s=l.indexOf(t),c=(0,n.isWhiteSpacePreserved)(e.format.whiteSpace),d="forward"==i,u="backward"==i;switch(c||function(e,t){for(var r,o=t-1;"SelectionMarker"==(null===(r=e[o])||void 0===r?void 0:r.segmentType);)o--;var a=e[o];a&&(0,n.normalizeSingleSegment)(a)}(l,s),t.segmentType){case"Br":case"Image":case"SelectionMarker":return l.splice(s,1),!0;case"Entity":var f=t.isSelected?"overwrite":d?"removeFromStart":u?"removeFromEnd":void 0;return void 0!==f&&(l.splice(s,1),null==r||r.deletedEntities.push({entity:t,operation:f})),!0;case"Text":var p=t.text;return 0==p.length||t.isSelected?l.splice(s,1):i&&(p=(0,o.deleteSingleChar)(p,d),c||(p=(0,a.normalizeText)(p,d)),""==p?l.splice(s,1):t.text=p),!0;case"General":return!!t.isSelected&&(l.splice(s,1),!0)}}},4470:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSelection=void 0;var o=r(7582),n=r(2530);t.deleteSelection=function(e,t,r){void 0===t&&(t=[]);var a=(0,n.deleteExpandedSelection)(e,r);return t.forEach((function(e){e&&function(e){return!!e.insertPoint}(a)&&e(a)})),function(e){var t,r=e.insertPoint,n=e.deleteResult,a=e.lastParagraph,i=e.lastTableContext;r&&"notDeleted"!=n&&"nothingToDelete"!=n&&a&&a!=r.paragraph&&i==r.tableContext&&((t=r.paragraph.segments).push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(a.segments),!1)),a.segments=[])}(a),a}},7309:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionRootNode=void 0,t.getSelectionRootNode=function(e){return e?"range"==e.type?e.range.commonAncestorContainer:"table"==e.type?e.table:"image"==e.type?e.image:void 0:void 0}},9764:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasSelectionInBlock=void 0;var o=r(4298),n=r(2152);t.hasSelectionInBlock=function(e){switch(e.blockType){case"Paragraph":return e.segments.some(n.hasSelectionInSegment);case"Table":return e.rows.some((function(e){return e.cells.some(o.hasSelectionInBlockGroup)}));case"BlockGroup":return(0,o.hasSelectionInBlockGroup)(e);case"Divider":case"Entity":return!!e.isSelected;default:return!1}}},4298:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasSelectionInBlockGroup=void 0;var o=r(9764);t.hasSelectionInBlockGroup=function(e){return!("TableCell"!=e.blockGroupType||!e.isSelected)||!!e.blocks.some(o.hasSelectionInBlock)}},2152:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasSelectionInSegment=void 0;var o=r(9764);t.hasSelectionInSegment=function(e){return e.isSelected||"General"==e.segmentType&&e.blocks.some(o.hasSelectionInBlock)}},3193:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.iterateSelections=void 0;var o=r(7582);function n(e,t,r,a,i){for(var l=e[0],s=(null==r?void 0:r.includeListFormatHolder)||"allSegments",c=(null==r?void 0:r.contentUnderSelectedTableCell)||"include",d=(null==r?void 0:r.contentUnderSelectedGeneralElement)||"contentOnly",u=!1,f=!1,p=0;p<l.blocks.length;p++){var m=l.blocks[p];switch(m.blockType){case"BlockGroup":var v=(0,o.__spreadArray)([m],(0,o.__read)(e),!1);if("General"==m.blockGroupType){var g=!(O=i||m.isSelected)||"both"==d||"contentOnly"==d,h=O&&("both"==d||"generalElementOnly"==d||0==m.blocks.length);if(g&&n(v,t,r,a,O)||h&&t(e,a,m))return!0}else if(n(v,t,r,a,i))return!0;break;case"Table":var b=m.rows,y=b.every((function(e){return e.cells.every((function(e){return e.isSelected}))}));if("include"!=c&&y){if(t(e,a,m))return!0}else for(var S=0;S<b.length;S++)for(var C=b[S],_=0;_<C.cells.length;_++){var T=C.cells[_];if(T){var E={table:m,rowIndex:S,colIndex:_,isWholeTableSelected:y};if(T.isSelected&&t(e,E))return!0;if((!T.isSelected||"ignoreForTableOrCell"!=c)&&n((0,o.__spreadArray)([T],(0,o.__read)(e),!1),t,r,E,O=i||T.isSelected))return!0}}break;case"Paragraph":for(var k=[],M=0;M<m.segments.length;M++){var P=m.segments[M],O=i||P.isSelected;if("General"==P.segmentType){if(g=!O||"both"==d||"contentOnly"==d,h=O&&("both"==d||"generalElementOnly"==d||0==P.blocks.length),g&&n((0,o.__spreadArray)([P],(0,o.__read)(e),!1),t,r,a,O))return!0;h&&k.push(P)}else O&&k.push(P);O?u=!0:f=!0}if(k.length>0&&t(e,a,m,k))return!0;break;case"Divider":case"Entity":if((i||m.isSelected)&&t(e,a,m))return!0}}return!("never"==s||"ListItem"!=l.blockGroupType||!u||f&&"anySegment"!=s||!t(e,a,void 0,[l.formatHolder]))}t.iterateSelections=function(e,t,r){n([e],(function(e,r,o,n){var a;return(null===(a=o)||void 0===a?void 0:a.cachedElement)&&delete o.cachedElement,t(e,r,o,n)}),r)}},2242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setSelection=void 0;var o=r(8871);function n(e,t,r,s){return l(t,e,r,s,(function(t){return(0,o.isGeneralSegment)(e)&&i(e,t),e.blocks.forEach((function(e){t=function(e,t,r,o){switch(e.blockType){case"BlockGroup":return n(e,t,r,o);case"Table":return function(e,t,r,o){var l=a(e,r),s=o?a(e,o):l;if(t)e.rows.forEach((function(e){return e.cells.forEach((function(e){t=n(e,t,r,o)}))}));else for(var c=0;c<e.rows.length;c++)for(var d=e.rows[c],u=0;u<d.cells.length;u++){var f=e.rows[c].cells[u],p=c>=l.row&&c<=s.row&&u>=l.col&&u<=s.col;i(f,p),p||n(f,!1,r,o)}return t}(e,t,r,o);case"Divider":case"Entity":return l(t,e,r,o,(function(t){return t?e.isSelected=!0:delete e.isSelected,t}));case"Paragraph":var s=[];for(e.segments.forEach((function(e,a){t=l(t,e,r,o,(function(t){return function(e,t,r,o,a,l){switch(e.segmentType){case"SelectionMarker":return(!t||e!=o&&e!=a)&&r.push(l),t;case"General":return i(e,t),e!=o&&e!=a?n(e,t,o,a):t;case"Image":return i(e,t),e.isSelectedAsImageSelection=o==e&&(!a||a==e),t;default:return i(e,t),t}}(e,t,s,r,o,a)}))}));s.length>0;){var c=s.pop();c>=0&&e.segments.splice(c,1)}return t;default:return t}}(e,t,r,s)})),t}))}function a(e,t){var r=-1;return{row:t?e.rows.findIndex((function(e){return(r=e.cells.indexOf(t))>=0})):-1,col:r}}function i(e,t){return t?e.isSelected=!0:delete e.isSelected,t}function l(e,t,r,o,n){return(e=n(e=e||t==r))&&!!o&&t!=o}t.setSelection=function(e,t,r){n(e,!1,t||null,r||null)}},785:(e,t,r)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.applyTableFormat=void 0;var n=r(7582),a=r(8871),i=r(3811),l=r(205),s=r(8028),c=r(6759),d=r(7647),u={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:s.TableBorderFormat.Default,verticalAlign:null};t.applyTableFormat=function(e,t,r){var o=e.rows;(0,d.updateTableMetadata)(e,(function(s){var d=(0,n.__assign)((0,n.__assign)((0,n.__assign)({},u),s),t||{}),v=function(e,t){var r={bgColorOverrides:[],vAlignOverrides:[],borderOverrides:[]};return e.forEach((function(e){var o=[],n=[],a=[];r.bgColorOverrides.push(o),r.vAlignOverrides.push(n),r.borderOverrides.push(a),e.cells.forEach((function(e){(0,c.updateTableCellMetadata)(e,(function(e){return e&&t?(o.push(!1),delete e.bgColorOverride):o.push(!!(null==e?void 0:e.bgColorOverride)),n.push(!!(null==e?void 0:e.vAlignOverride)),a.push(!!(null==e?void 0:e.borderOverride)),e}))}))})),r}(o,!r);return delete e.cachedElement,function(e){e.forEach((function(e){e.cells.forEach((function(e){delete e.cachedElement})),delete e.cachedElement}))}(o),function(e,t,r){var o=t.hasBandedRows,n=t.hasBandedColumns,s=t.bgColorOdd,c=t.bgColorEven;e.forEach((function(d,u){d.cells.forEach((function(p,v){var g;if(!r.borderOverrides[u][v]&&"number"==typeof t.tableBorderFormat){var h=null===(g=f[t.tableBorderFormat])||void 0===g?void 0:g.call(f,{firstRow:0===u,lastRow:u===e.length-1,firstColumn:0===v,lastColumn:v===d.cells.length-1}),b=[t.topBorderColor,t.verticalBorderColor,t.bottomBorderColor,t.verticalBorderColor];null==h||h.forEach((function(e,t){var r=!e&&b[t]||"";p.format[a.BorderKeys[t]]=(0,i.combineBorderValue)({style:m(r),width:"1px",color:r})}))}if(!r.bgColorOverrides[u][v]){var y=(o||n)&&(n&&v%2!=0||o&&u%2!=0)?s:c;(0,l.setTableCellBackgroundColor)(p,y,!1,!0)}t.verticalAlign&&!r.vAlignOverrides[u][v]&&(p.format.verticalAlign=t.verticalAlign)}))}))}(o,d,v),function(e,t,r){e.forEach((function(o,n){o.cells.forEach((function(o,a){t.hasFirstColumn&&0===a?(o.isHeader=!0,0===n||r.bgColorOverrides[n][a]||(p(o.format,"borderTop"),(0,l.setTableCellBackgroundColor)(o,null,!1,!0)),n!==e.length-1&&0!==n&&p(o.format,"borderBottom")):o.isHeader=!1}))}))}(o,d,v),function(e,t,r){var o;null===(o=e[0])||void 0===o||o.cells.forEach((function(e,o){e.isHeader=t.hasHeaderRow,t.hasHeaderRow&&t.headerRowColor&&(r.bgColorOverrides[0][o]||(0,l.setTableCellBackgroundColor)(e,t.headerRowColor,!1,!0),p(e.format,"borderTop",t.headerRowColor),p(e.format,"borderRight",t.headerRowColor),p(e.format,"borderLeft",t.headerRowColor))}))}(o,d,v),d}))};var f=((o={})[s.TableBorderFormat.Default]=function(e){return[!1,!1,!1,!1]},o[s.TableBorderFormat.ListWithSideBorders]=function(e){return[!1,!e.lastColumn,!1,!e.firstColumn]},o[s.TableBorderFormat.FirstColumnHeaderExternal]=function(e){var t=e.firstColumn,r=e.firstRow;return[!r,!e.lastColumn&&!t||t&&r,!e.lastRow&&!r,!t]},o[s.TableBorderFormat.NoHeaderBorders]=function(e){var t=e.firstRow,r=e.firstColumn,o=e.lastColumn;return[t,t||o,!1,t||r]},o[s.TableBorderFormat.NoSideBorders]=function(e){var t=e.firstColumn;return[!1,e.lastColumn,!1,t]},o[s.TableBorderFormat.EspecialType1]=function(e){var t=e.firstRow,r=e.firstColumn;return[r&&!t,t,r&&!t,t&&!r]},o[s.TableBorderFormat.EspecialType2]=function(e){var t=e.firstRow,r=e.firstColumn;return[!t,t||!r,!t,!r]},o[s.TableBorderFormat.EspecialType3]=function(e){var t=e.firstColumn,r=e.firstRow;return[!0,r||!t,!r,!0]},o[s.TableBorderFormat.Clear]=function(){return[!0,!0,!0,!0]},o);function p(e,t,r){var o=(0,i.extractBorderValues)(e[t]);o.color=r||"",o.style=m(o.color),e[t]=(0,i.combineBorderValue)(o)}function m(e){return e&&"transparent"!=e?"solid":"none"}},2266:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectedCells=void 0;var o=r(4298);t.getSelectedCells=function(e){var t=-1,r=-1,n=-1,a=-1,i=!1;return e.rows.forEach((function(e,l){return e.cells.forEach((function(e,s){(0,o.hasSelectionInBlockGroup)(e)&&(i=!0,t<0&&(t=l),r<0&&(r=s),n=Math.max(n,l),a=Math.max(a,s))}))})),i?{firstRow:t,firstColumn:r,lastRow:n,lastColumn:a}:null}},7900:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeTable=t.MIN_ALLOWED_TABLE_CELL_WIDTH=void 0;var o=r(7582),n=r(8871);function a(e){return e<=4?120:e<=6?100:70}function i(e,t){var r;t.blocks.every((function(e){return"Paragraph"==e.blockType&&(0==(t=(t=e.segments).filter((function(e){return"SelectionMarker"!=e.segmentType}))).length||1==t.length&&"Br"==t[0].segmentType);var t}))||((r=e.blocks).push.apply(r,(0,o.__spreadArray)([],(0,o.__read)(t.blocks),!1)),t.blocks=[])}t.MIN_ALLOWED_TABLE_CELL_WIDTH=30,t.normalizeTable=function(e,r){var l,s=e.format;s.borderCollapse&&s.useBorderBox||(s.borderCollapse=!0,s.useBorderBox=!0),e.rows.forEach((function(e,t){e.cells.forEach((function(e,a){if(0==e.blocks.length){var i=e.format.textColor?(0,o.__assign)((0,o.__assign)({},r),{textColor:e.format.textColor}):r;(0,n.addBlock)(e,(0,n.createParagraph)(void 0,void 0,i)),(0,n.addSegment)(e,(0,n.createBr)(i))}0==t?e.spanAbove=!1:t>0&&e.isHeader&&(e.isHeader=!1,delete e.cachedElement),0==a&&(e.spanLeft=!1),e.format.useBorderBox=!0})),e.height<22&&(e.height=22)}));for(var c=Math.max.apply(Math,(0,o.__spreadArray)([],(0,o.__read)(e.rows.map((function(e){return e.cells.length}))),!1)),d=0;d<c;d++)void 0===e.widths[d]?e.widths[d]=a(c):e.widths[d]<t.MIN_ALLOWED_TABLE_CELL_WIDTH&&(e.widths[d]=t.MIN_ALLOWED_TABLE_CELL_WIDTH);for(var u=function(t){e.rows.forEach((function(e){var r=e.cells[t],o=e.cells[t-1];r&&o&&r.spanLeft&&i(o,r)})),e.rows.every((function(e){var r;return null===(r=e.cells[t])||void 0===r?void 0:r.spanLeft}))&&(e.rows.forEach((function(e){return e.cells.splice(t,1)})),e.widths.splice(t-1,2,e.widths[t-1]+e.widths[t]))},f=((null===(l=e.rows[0])||void 0===l?void 0:l.cells.length)||0)-1;f>0;f--)u(f);for(var p=function(t){var r=e.rows[t];r.cells.forEach((function(r,o){var n,a=null===(n=e.rows[t-1])||void 0===n?void 0:n.cells[o];a&&r.spanAbove&&i(a,r)})),r.cells.every((function(e){return e.spanAbove}))&&(e.rows[t-1].height+=r.height,e.rows.splice(t,1))},m=e.rows.length-1;m>0;m--)p(m)}},205:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setTableCellBackgroundColor=void 0;var o=r(7582),n=r(8871),a=r(6759),i="#ffffff",l="#000000";function s(e,t){var r=c(t);return[i,"rgb(255,255,255)"].indexOf(e)>-1&&(r>80||""==t)||[l,"rgb(0,0,0)"].indexOf(e)>-1&&(r<20||""==t)}function c(e){var t=(0,n.parseColor)(e);if(t){var r=t[0]/255,o=t[1]/255,a=t[2]/255;return 50*(Math.max(r,o,a)+Math.min(r,o,a))}return 255}t.setTableCellBackgroundColor=function(e,t,r,n){if(t){e.format.backgroundColor=t,r&&(0,a.updateTableCellMetadata)(e,(function(e){return(e=e||{}).bgColorOverride=!0,e}));var d=c(t);d<20?e.format.textColor=i:d>80?e.format.textColor=l:delete e.format.textColor,n&&function(e){e.format.textColor&&e.blocks.forEach((function(t){var r;"Paragraph"==t.blockType&&((null===(r=t.segmentFormat)||void 0===r?void 0:r.textColor)||(t.segmentFormat=(0,o.__assign)((0,o.__assign)({},t.segmentFormat),{textColor:e.format.textColor})),t.segments.forEach((function(t){var r;(null===(r=t.format)||void 0===r?void 0:r.textColor)||(t.format=(0,o.__assign)((0,o.__assign)({},t.format),{textColor:e.format.textColor}))})))}))}(e)}else delete e.format.backgroundColor,delete e.format.textColor,n&&function(e){e.blocks.forEach((function(t){var r,o;"Paragraph"==t.blockType&&((null===(r=t.segmentFormat)||void 0===r?void 0:r.textColor)&&s(null===(o=t.segmentFormat)||void 0===o?void 0:o.textColor,e.format.backgroundColor||"")&&delete t.segmentFormat.textColor,t.segments.forEach((function(t){t.format.textColor&&s(t.format.textColor,e.format.backgroundColor||"")&&delete t.format.textColor})))}))}(e);delete e.cachedElement}},4898:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.redo=void 0,t.redo=function(e){e.focus();var t=e.getSnapshotsManager().move(1);t&&e.restoreSnapshot(t)}},1771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.undo=void 0,t.undo=function(e){e.focus();var t=e.getSnapshotsManager();t.hasNewContent&&e.takeSnapshot();var r=t.move(-1);r&&e.restoreSnapshot(r)}},8317:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertInlineCss=t.retrieveCssRules=void 0;var o=r(7582),n=r(8871);t.retrieveCssRules=function(e){var t=(0,n.toArray)(e.querySelectorAll("style")),r=[];return t.forEach((function(e){for(var t,o,n=e.sheet,a=0;a<n.cssRules.length;a++){var i=n.cssRules[a];i.type==CSSRule.STYLE_RULE&&i.selectorText&&r.push({selectors:(o=i.selectorText,o.split(/(?![^(]*\)),/).map((function(e){return e.trim()}))),text:i.style.cssText})}null===(t=e.parentNode)||void 0===t||t.removeChild(e)})),r},t.convertInlineCss=function(e,t){for(var r=function(r){var a,i,l=t[r],s=l.selectors,c=l.text;try{for(var d=(a=void 0,(0,o.__values)(s)),u=d.next();!u.done;u=d.next()){var f=u.value;f&&f.trim()&&(0,n.toArray)(e.querySelectorAll(f)).forEach((function(e){return e.setAttribute("style",c+(e.getAttribute("style")||""))}))}}catch(e){a={error:e}}finally{try{u&&!u.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}},a=t.length-1;a>=0;a--)r(a)}},1424:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDomToModelContextForSanitizing=void 0;var o=r(7582),n=r(351),a=r(8871),i=r(59),l=r(612),s=r(4370),c=r(3311),d=r(5452),u=r(3046),f={processorOverride:{},formatParserOverride:{},additionalFormatParsers:{},additionalAllowedTags:[],additionalDisallowedTags:[],styleSanitizers:{},attributeSanitizers:{}};t.createDomToModelContextForSanitizing=function(e,t,r,p){var m=(0,o.__assign)((0,o.__assign)({},f),p);return(0,a.createDomToModelContext)((0,o.__assign)({defaultFormat:t},(0,s.getRootComputedStyleForContext)(e)),r,{processorOverride:{"#text":u.pasteTextProcessor,entity:(0,i.createPasteEntityProcessor)(m),"*":(0,l.createPasteGeneralProcessor)(m)},formatParserOverride:{display:d.pasteDisplayFormatParser},additionalFormatParsers:{container:[n.containerSizeFormatParser],entity:[c.pasteBlockEntityParser]}},m)}},230:(e,t,r)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.extractClipboardItems=void 0;var n=r(1025),a=((o={})["text/html"]=function(e,t){return e.rawHtml=t},o["text/plain"]=function(e,t){return e.text=t},o["text/*"]=function(e,t,r){return!!r&&(e.customValues[r]=t)},o["text/link-preview"]=function(e,t){try{e.customValues["link-preview"]=t,e.linkPreview=JSON.parse(t)}catch(e){}},o);t.extractClipboardItems=function(e,t){var r={types:[],text:"",image:null,files:[],rawHtml:null,customValues:{},pasteNativeEvent:!0};return Promise.all((e||[]).map((function(e){var o=e.type;if(0!=o.indexOf("image/")||r.image||"file"!=e.kind){if("file"==e.kind)return new Promise((function(t){var n=e.getAsFile();n&&(r.types.push(o),r.files.push(n)),t()}));var i=function(e,t){var r=0==e.indexOf("text/")?e.substring(5):null,o=t&&r?t.indexOf(r):-1;return r&&o>=0?r:void 0}(o,t),l=a[o]||(i?a["text/*"]:null);return new Promise((function(t){return l?e.getAsString((function(e){r.types.push(o),l(r,e,i),t()})):t()}))}return r.types.push(o),r.image=e.getAsFile(),new Promise((function(e){r.image?(0,n.readFile)(r.image,(function(t){r.imageDataUri=t,e()})):e()}))}))).then((function(){return r}))}},654:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPasteFragment=void 0;var o=r(8871);t.createPasteFragment=function(e,t,r,n){var a=t.imageDataUri,i=t.text,l=e.createDocumentFragment();if("asImage"==r&&a||"asPlainText"!=r&&!i&&a){var s=e.createElement("img");s.style.maxWidth="100%",s.src=a,l.appendChild(s)}else"asPlainText"!=r&&n?(0,o.moveChildNodes)(l,n):i&&i.split("\n").forEach((function(t,r,n){(t=t.replace(/^ /g,"").replace(/ $/g,"").replace(/\r/g,"").replace(/ {2}/g," ")).includes("\t")&&(t=function(e,t){void 0===t&&(t=0);for(var r,o=e;-1!=(r=o.indexOf("\t"));){var n=o.slice(0,r),a=o.slice(r+1),i=6-(n.length+t)%6;o=n+Array(i).fill("").join("")+a}return o}(t));var a=e.createTextNode(t);2==n.length&&0==r?(l.appendChild(a),l.appendChild(e.createElement("br"))):r>0&&r<n.length-1?l.appendChild((0,o.wrap)(e,""==t?e.createElement("br"):a,"div")):l.appendChild(a)}));return l}},4101:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generatePasteOptionFromPlugins=void 0,t.generatePasteOptionFromPlugins=function(e,t,r,o,n){var a,i,l={eventType:"beforePaste",clipboardData:t,fragment:r,htmlBefore:null!==(a=o.htmlBefore)&&void 0!==a?a:"",htmlAfter:null!==(i=o.htmlAfter)&&void 0!==i?i:"",htmlAttributes:o.metadata,pasteType:n,domToModelOption:{additionalAllowedTags:[],additionalDisallowedTags:[],additionalFormatParsers:{},formatParserOverride:{},processorOverride:{},styleSanitizers:{},attributeSanitizers:{}}};return"asPlainText"==n?l:e.triggerEvent("beforePaste",l,!0)}},3232:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergePasteContent=t.cloneModelForPaste=void 0;var o=r(7582),n=r(8667),a=r(464),i=r(1424),l=r(8871),s=r(1183),c=r(4946),d=r(578),u={backgroundColor:"",fontFamily:"",fontSize:"",fontWeight:"",italic:!1,letterSpacing:"",lineHeight:"",strikethrough:!1,superOrSubScriptSequence:"",textColor:"",underline:!1},f={includeCachedElement:function(e,t){return"cache"==t?void 0:e}};function p(e){return(0,a.cloneModel)(e,f)}function m(e){return 2==e.blocks.length&&"Table"===e.blocks[0].blockType&&"Paragraph"===e.blocks[1].blockType&&1===e.blocks[1].segments.length&&"Br"===e.blocks[1].segments[0].segmentType&&e.blocks.splice(1),1===e.blocks.length&&"Table"===e.blocks[0].blockType}t.cloneModelForPaste=p,t.mergePasteContent=function(e,t,r){var a=t.fragment,f=t.domToModelOption,v=t.customizedMerge,g=t.pasteType;e.formatContentModel((function(t,n){if(r.modelBeforePaste){var h=p(r.modelBeforePaste);t.blocks=h.blocks}var b=(0,c.getSelectedSegments)(t,!0)[0],y=(0,i.createDomToModelContextForSanitizing)(e.getDocument(),void 0,e.getEnvironment().domToModelSettings.customized,f);y.segmentFormat=b?(0,s.getSegmentTextFormat)(b):{};var S=(0,l.domToContentModel)(a,y),C={mergeFormat:"mergeFormat"==g?"keepSourceEmphasisFormat":"none",mergeTable:m(S)},_=v?v(t,S):(0,d.mergeModel)(t,S,n,C);return _&&(n.newPendingFormat=(0,o.__assign)((0,o.__assign)((0,o.__assign)({},u),t.format),_.marker.format)),!0}),{changeSource:n.ChangeSource.Paste,getChangeData:function(){return r},apiName:"paste"})}},534:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveHtmlInfo=void 0;var o=r(7582),n=r(8871),a=r(8317),i="\x3c!--StartFragment--\x3e",l="\x3c!--EndFragment--\x3e";function s(e){var t,r={},o=null===(t=e.querySelector("html"))||void 0===t?void 0:t.attributes;return(o?(0,n.toArray)(o):[]).forEach((function(e){r[e.name]=e.value})),(0,n.toArray)(e.querySelectorAll("meta")).forEach((function(e){r[e.name]=e.content})),r}t.retrieveHtmlInfo=function(e,t){var r={metadata:{},globalCssRules:[]};return e&&(r=(0,o.__assign)((0,o.__assign)({},function(e){var t,r=null!==(t=e.rawHtml)&&void 0!==t?t:"",o=r.indexOf(i),n=r.lastIndexOf(l),a="",s="";return o>=0&&n>=o+20?(a=r.substring(0,o),s=r.substring(n+18),e.html=r.substring(o+20,n)):e.html=r,{htmlBefore:a,htmlAfter:s}}(t)),{globalCssRules:(0,a.retrieveCssRules)(e),metadata:s(e)}),t.htmlFirstLevelChildTags=function(e){for(var t,r=[],o=e.body.firstChild;o;o=o.nextSibling)(0,n.isNodeOfType)(o,"TEXT_NODE")?(null===(t=o.nodeValue)||void 0===t?void 0:t.replace(/(\r\n|\r|\n)/gm,"").trim())&&r.push(""):(0,n.isNodeOfType)(o,"ELEMENT_NODE")&&r.push(o.tagName);return r}(e)),r}},6291:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSanitizedElement=t.sanitizeElement=t.DisallowedTags=t.AllowedTags=void 0;var o=r(8871);t.AllowedTags=["a","abbr","address","area","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","fieldset","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","menu","menuitem","meter","nav","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","small","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","tt","u","ul","var","wbr","xmp"],t.DisallowedTags=["applet","audio","base","basefont","embed","frame","frameset","iframe","link","meta","noscript","object","param","script","slot","source","style","template","title","track","video"];var n=/^\s*var\(\s*[a-zA-Z0-9-_]+\s*(,\s*(.*))?\)\s*$/,a="var(",i=["accept","align","alt","checked","cite","class","color","cols","colspan","contextmenu","coords","datetime","default","dir","dirname","disabled","download","face","headers","height","hidden","high","href","hreflang","ismap","kind","label","lang","list","low","max","maxlength","media","min","multiple","open","optimum","pattern","placeholder","readonly","rel","required","reversed","rows","rowspan","scope","selected","shape","size","sizes","span","spellcheck","src","srclang","srcset","start","step","style","tabindex","target","title","translate","type","usemap","valign","value","width","wrap","bgColor"],l={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none","font-style":"normal","font-variant-ligatures":"normal","font-variant-caps":"normal","font-weight":"400","letter-spacing":"normal",orphans:"2","text-align":"start","text-indent":"0px","text-transform":"none",widows:"2","word-spacing":"0px","white-space":"normal"};function s(e,t,r,o,n){for(var a=e.createElement(t),l=0;l<r.length;l++){var s=r[l],d=s.name.toLowerCase().trim(),u=s.value,f=null==n?void 0:n[d],p="style"==d?c(t,u,o):"function"==typeof f?f(u,t):"boolean"==typeof f?f?u:null:i.indexOf(d)>=0||0==d.indexOf("data-")?u:null;null==p||p.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)||a.setAttribute(d,p)}return a}function c(e,t,r){var o=t.split(";"),i=[];return o.forEach((function(t){var o=t.indexOf(":"),s=t.slice(0,o).trim(),c=t.slice(o+1).trim();if(s&&c){(function(e){return 0==e.indexOf(a)})(c)&&(c=function(e){var t=n.exec(e);return(null==t?void 0:t[2])||""}(c));var d=null==r?void 0:r[s],u="function"==typeof d?d(c,e):!1===d?null:c;u&&"inherit"!=u&&"initial"!=u&&u.indexOf("expression")<0&&!s.startsWith("-")&&l[s]!=u&&i.push(s+":"+u)}})),i.join(";")}t.sanitizeElement=function e(t,r,n,a,i){var l=t.tagName.toLowerCase(),c=n.indexOf(l)>=0?null:s(t.ownerDocument,r.indexOf(l)>=0?l:"span",t.attributes,a,i);if(c)for(var d=t.firstChild;d;d=d.nextSibling){var u=(0,o.isNodeOfType)(d,"ELEMENT_NODE")?e(d,r,n,a,i):(0,o.isNodeOfType)(d,"TEXT_NODE")?d.cloneNode():null;u&&(null==c||c.appendChild(u))}return c},t.createSanitizedElement=s},1105:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultContentModelFormatMap=void 0,t.defaultContentModelFormatMap={a:{underline:!0},blockquote:{marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},code:{fontFamily:"monospace"},h1:{fontWeight:"bold",fontSize:"2em"},h2:{fontWeight:"bold",fontSize:"1.5em"},h3:{fontWeight:"bold",fontSize:"1.17em"},h4:{fontWeight:"bold",fontSize:"1em"},h5:{fontWeight:"bold",fontSize:"0.83em"},h6:{fontWeight:"bold",fontSize:"0.67em"},p:{marginTop:"1em",marginBottom:"1em"},pre:{fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"}}},3413:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultHTMLStyleMap=void 0;var o=r(7582),n={display:"block"};t.defaultHTMLStyleMap={address:n,article:n,aside:n,b:{fontWeight:"bold"},blockquote:{display:"block",marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},br:n,center:{display:"block",textAlign:"center"},dd:n,div:n,dl:n,dt:n,em:{fontStyle:"italic"},fieldset:n,figcaption:n,figure:n,footer:n,form:n,h1:{display:"block",fontWeight:"bold",fontSize:"2em"},h2:{display:"block",fontWeight:"bold",fontSize:"1.5em"},h3:{display:"block",fontWeight:"bold",fontSize:"1.17em"},h4:{display:"block",fontWeight:"bold"},h5:{display:"block",fontWeight:"bold",fontSize:"0.83em"},h6:{display:"block",fontWeight:"bold",fontSize:"0.67em"},header:n,hr:n,i:{fontStyle:"italic"},li:{display:"list-item"},main:n,nav:n,ol:(0,o.__assign)((0,o.__assign)({},n),{paddingInlineStart:"40px"}),p:{display:"block",marginTop:"1em",marginBottom:"1em"},pre:{display:"block",fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"},s:{textDecoration:"line-through"},section:n,strike:{textDecoration:"line-through"},strong:{fontWeight:"bold"},sub:{verticalAlign:"sub",fontSize:"smaller"},sup:{verticalAlign:"super",fontSize:"smaller"},table:{display:"table",boxSizing:"border-box"},td:{display:"table-cell"},th:{display:"table-cell"},u:{textDecoration:"underline"},ul:(0,o.__assign)((0,o.__assign)({},n),{paddingInlineStart:"40px"})}},5953:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildFormatParsers=t.createDomToModelConfig=t.createDomToModelContextWithConfig=t.createDomToModelContext=void 0;var o=r(7582),n=r(4153),a=r(546),i=r(5606);function l(e,t){return Object.assign({},t,{isInSelection:!1},{blockFormat:(null==t?void 0:t.isRootRtl)?{direction:"rtl"}:{},segmentFormat:{},listFormat:{levels:[],threadItemCounts:[]}},{link:{format:{},dataset:{}},code:{format:{}},blockDecorator:{format:{},tagName:""}},e)}function s(e){return{elementProcessors:Object.assign.apply(Object,(0,o.__spreadArray)([{},n.defaultProcessorMap],(0,o.__read)(e.map((function(e){return null==e?void 0:e.processorOverride}))),!1)),formatParsers:c(e.map((function(e){return null==e?void 0:e.formatParserOverride})),e.map((function(e){return null==e?void 0:e.additionalFormatParsers}))),defaultElementProcessors:n.defaultProcessorMap,defaultFormatParsers:i.defaultFormatParsers}}function c(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var r=Object.assign.apply(Object,(0,o.__spreadArray)([{}],(0,o.__read)(e),!1)),n=(0,a.getObjectKeys)(i.defaultFormatKeysPerCategory).reduce((function(e,n){var a,l=(a=i.defaultFormatKeysPerCategory[n].map((function(e){return void 0===r[e]?i.defaultFormatParsers[e]:r[e]}))).concat.apply(a,(0,o.__spreadArray)([],(0,o.__read)(t.map((function(e){var t;return null!==(t=null==e?void 0:e[n])&&void 0!==t?t:[]}))),!1));return e[n]=l,e}),{text:[]});return t.forEach((function(e){(null==e?void 0:e.text)&&(n.text=n.text.concat(e.text))})),n}t.createDomToModelContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l(s(t),e)},t.createDomToModelContextWithConfig=l,t.createDomToModelConfig=s,t.buildFormatParsers=c},4153:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultProcessorMap=void 0;var o=r(6861),n=r(1438),a=r(5035),i=r(2162),l=r(84),s=r(1447),c=r(8167),d=r(1291),u=r(6779),f=r(9750),p=r(4551),m=r(2395),v=r(3780),g=r(7659),h=r(4030),b=r(8604),y=r(3919),S=r(793),C=r(6214);t.defaultProcessorMap={a:g.linkProcessor,b:v.knownElementProcessor,blockquote:v.knownElementProcessor,br:o.brProcessor,code:a.codeProcessor,div:v.knownElementProcessor,em:v.knownElementProcessor,font:c.fontProcessor,i:v.knownElementProcessor,img:m.imageProcessor,h1:f.headingProcessor,h2:f.headingProcessor,h3:f.headingProcessor,h4:f.headingProcessor,h5:f.headingProcessor,h6:f.headingProcessor,hr:p.hrProcessor,li:h.listItemProcessor,ol:b.listProcessor,p:y.pProcessor,pre:d.formatContainerProcessor,s:v.knownElementProcessor,section:v.knownElementProcessor,span:v.knownElementProcessor,strike:v.knownElementProcessor,strong:v.knownElementProcessor,sub:v.knownElementProcessor,sup:v.knownElementProcessor,table:S.tableProcessor,u:v.knownElementProcessor,ul:b.listProcessor,"*":u.generalProcessor,"#text":C.textProcessor,element:l.elementProcessor,entity:s.entityProcessor,child:n.childProcessor,delimiter:i.delimiterProcessor}},6373:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.domToContentModel=void 0;var o=r(2178),n=r(4527);t.domToContentModel=function(e,t,r){var a=(0,o.createContentModelDocument)(t.defaultFormat);return t.selection=r,t.elementProcessors.child(a,e,t),(0,n.normalizeContentModel)(a),a}},7665:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.blockProcessor=void 0;var o=r(7582),n=r(6954),a=r(1291),i=r(673),l=r(2487),s=["A","CODE"];t.blockProcessor=function(e,t,r,c){var d=r.blockDecorator.tagName?r.blockDecorator:void 0,u=s.indexOf(t.tagName)>=0;(0,l.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var f=(0,o.__assign)({},r.blockFormat);if((0,l.parseFormat)(t,r.formatParsers.container,f,r),a.ContextStyles.forEach((function(e){f[e]&&(r.blockFormat[e]=f[e])})),!u){var p=(0,i.createParagraph)(!1,f,c,d);(0,n.addBlock)(e,p)}r.elementProcessors.child(e,t,r)}},6861:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.brProcessor=void 0;var o=r(8613),n=r(5713);t.brProcessor=function(e,t,r){var a,i=(0,n.createBr)(r.segmentFormat);r.isInSelection&&(i.isSelected=!0);var l=(0,o.addSegment)(e,i,r.blockFormat);null===(a=r.domIndexer)||void 0===a||a.onSegment(t,l,[i])}},1438:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleRegularSelection=t.processChildNode=t.childProcessor=void 0;var o=r(7582),n=r(3344),a=r(4714),i=r(8882);function l(e,t,r){(0,i.isNodeOfType)(t,"ELEMENT_NODE")&&"none"!=t.style.display?r.elementProcessors.element(e,t,r):(0,i.isNodeOfType)(t,"TEXT_NODE")&&r.elementProcessors["#text"](e,t,r)}function s(e,t,r,o,a,i){var l;e==o&&(t.isInSelection=!0,(0,n.addSelectionMarker)(r,t,i,e)),e==a&&"range"==(null===(l=t.selection)||void 0===l?void 0:l.type)&&(t.selection.range.collapsed||(0,n.addSelectionMarker)(r,t,i,e),t.isInSelection=!1)}t.childProcessor=function(e,t,r){for(var n=(0,o.__read)((0,a.getRegularSelectionOffsets)(r,t),2),i=n[0],c=n[1],d=0,u=t.firstChild;u;u=u.nextSibling)s(d,r,e,i,c,t),l(e,u,r),d++;s(d,r,e,i,c,t)},t.processChildNode=l,t.handleRegularSelection=s},5035:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.codeProcessor=void 0;var o=r(3780),n=r(2487),a=r(4968);t.codeProcessor=function(e,t,r){(0,a.stackFormat)(r,{code:"codeDefault"},(function(){(0,n.parseFormat)(t,r.formatParsers.code,r.code.format,r),(0,o.knownElementProcessor)(e,t,r)}))}},2162:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.delimiterProcessor=void 0;var o=r(3344);t.delimiterProcessor=function(e,t,r){var n,a,i="range"==(null===(n=r.selection)||void 0===n?void 0:n.type)?r.selection.range:null;i&&(t.contains(i.startContainer)&&(r.isInSelection=!0,(0,o.addSelectionMarker)(e,r)),"range"==(null===(a=r.selection)||void 0===a?void 0:a.type)&&t.contains(i.endContainer)&&(r.selection.range.collapsed||(0,o.addSelectionMarker)(e,r),r.isInSelection=!1))}},84:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.elementProcessor=void 0;var o=r(3566);t.elementProcessor=function(e,t,r){var n=t.tagName.toLowerCase(),a=function(e,t){return(0,o.isEntityElement)(e)||"false"==e.contentEditable?t.elementProcessors.entity:null}(t,r)||function(e,t){return(0,o.isEntityDelimiter)(e)?t.elementProcessors.delimiter:null}(t,r)||r.elementProcessors[n]||n.indexOf(":")>=0&&r.elementProcessors.child||r.elementProcessors["*"];a(e,t,r)}},1447:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.entityProcessor=void 0;var o=r(6954),n=r(8613),a=r(7974),i=r(9630),l=r(2487),s=r(4968);t.entityProcessor=function(e,t,r){var c=(0,i.isBlockElement)(t)||"inline-block"==t.style.display&&"100%"==t.style.width;(0,s.stackFormat)(r,{segment:c?"empty":void 0,paragraph:"empty"},(function(){var i,s=(0,a.createEntity)(t,!0,r.segmentFormat);if((0,l.parseFormat)(t,r.formatParsers.entity,s.entityFormat,r),r.isInSelection&&(s.isSelected=!0),c)(0,o.addBlock)(e,s);else{var d=(0,n.addSegment)(e,s);null===(i=r.domIndexer)||void 0===i||i.onSegment(t,d,[s])}}))}},8167:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fontProcessor=void 0;var o=r(9630),n=r(2487),a=r(4968),i=["10px","13px","16px","18px","24px","32px","48px"];t.fontProcessor=function(e,t,r){(0,a.stackFormat)(r,{segment:(0,o.isBlockElement)(t)?"shallowCloneForBlock":"shallowClone"},(function(){var o,a,l=t.getAttribute("face"),s=(o=t.getAttribute("size"),a=parseInt(o||""),Number.isNaN(a)?void 0:a<1?i[0]:a>i.length?i[i.length-1]:i[a-1]),c=t.getAttribute("color"),d=r.segmentFormat;l&&(d.fontFamily=l),s&&(d.fontSize=s),c&&(d.textColor=c),(0,n.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r),r.elementProcessors.child(e,t,r)}))}},1291:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatContainerProcessor=t.ContextStyles=void 0;var o=r(7582),n=r(6954),a=r(1096),i=r(673),l=r(9408),s=r(2487),c=r(1966),d=r(4968);t.ContextStyles=["marginLeft","marginRight","paddingLeft","paddingRight"],t.formatContainerProcessor=function(e,r,u){(0,d.stackFormat)(u,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){(0,s.parseFormat)(r,u.formatParsers.block,u.blockFormat,u),(0,s.parseFormat)(r,u.formatParsers.segmentOnBlock,u.segmentFormat,u);var i=(0,o.__assign)({},u.blockFormat);(0,s.parseFormat)(r,u.formatParsers.container,i,u);var d="block"==(0,l.getDefaultStyle)(r).display?r.tagName.toLowerCase():"div",f=(0,a.createFormatContainer)(d,i);if(t.ContextStyles.forEach((function(e){delete u.blockFormat[e]})),u.elementProcessors.child(f,r,u),r.style.fontSize&&0==parseInt(r.style.fontSize)&&(f.zeroFontSize=!0),function(e){var t=e.blocks[0];return"div"==e.tagName&&1==e.blocks.length&&"Paragraph"==t.blockType&&t.isImplicit}(f)){var p=f.blocks[0];f.zeroFontSize&&(p.segmentFormat=Object.assign({},p.segmentFormat,{fontSize:"0"})),Object.assign(p.format,f.format),(0,c.setParagraphNotImplicit)(p),(0,n.addBlock)(e,p)}else(0,n.addBlock)(e,f)})),(0,n.addBlock)(e,(0,i.createParagraph)(!0,u.blockFormat))}},6779:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generalProcessor=void 0;var o=r(6954),n=r(6630),a=r(8613),i=r(513),l=r(8465),s=r(9630),c=r(2487),d=r(4968),u=function(e,t,r){var n=(0,i.createGeneralBlock)(t),a=r.isInSelection;(0,d.stackFormat)(r,{segment:"empty",paragraph:"empty",link:"empty"},(function(){(0,o.addBlock)(e,n),(0,c.parseFormat)(t,r.formatParsers.general,n.format,r),r.elementProcessors.child(n,t,r)})),a&&r.isInSelection&&(n.isSelected=!0)},f=function(e,t,r){var o,i=(0,l.createGeneralSegment)(t,r.segmentFormat),s=r.isInSelection;(0,n.addDecorators)(i,r);var u=(0,a.addSegment)(e,i);null===(o=r.domIndexer)||void 0===o||o.onSegment(t,u,[i]),(0,d.stackFormat)(r,{segment:"empty"},(function(){(0,c.parseFormat)(t,r.formatParsers.general,i.format,r),r.elementProcessors.child(i,t,r)})),s&&r.isInSelection&&(i.isSelected=!0)};t.generalProcessor=function(e,t,r){((0,s.isBlockElement)(t)?u:f)(e,t,r)}},9750:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.headingProcessor=void 0;var o=r(6954),n=r(7665),a=r(673),i=r(4002),l=r(546),s=r(2487),c=r(4968);t.headingProcessor=function(e,t,r){(0,c.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone",blockDecorator:"empty"},(function(){var o={};(0,s.parseFormat)(t,r.formatParsers.segmentOnBlock,o,r),(0,l.getObjectKeys)(o).forEach((function(e){delete r.segmentFormat[e]})),r.blockDecorator=(0,i.createParagraphDecorator)(t.tagName,o),(0,n.blockProcessor)(e,t,r)})),(0,o.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat))}},4551:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hrProcessor=void 0;var o=r(6954),n=r(9002),a=r(2487),i=r(4968);t.hrProcessor=function(e,t,r){(0,i.stackFormat)(r,{paragraph:"shallowClone"},(function(){(0,a.parseFormat)(t,r.formatParsers.divider,r.blockFormat,r);var i=(0,n.createDivider)("hr",r.blockFormat);t.size&&(i.size=t.size),r.isInSelection&&(i.isSelected=!0),(0,o.addBlock)(e,i)}))}},2395:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.imageProcessor=void 0;var o=r(6630),n=r(8613),a=r(1143),i=r(2487),l=r(4968);t.imageProcessor=function(e,t,r){(0,l.stackFormat)(r,{segment:"shallowClone"},(function(){var l,s,c,d=r.segmentFormat,u=null!==(l=t.getAttribute("src"))&&void 0!==l?l:"";(0,i.parseFormat)(t,r.formatParsers.segment,d,r),(0,i.parseFormat)(t,r.formatParsers.image,d,r),(0,i.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var f=(0,a.createImage)(u,d),p=t.alt,m=t.title;(0,i.parseFormat)(t,r.formatParsers.dataset,f.dataset,r),(0,o.addDecorators)(f,r),p&&(f.alt=p),m&&(f.title=m),r.isInSelection&&(f.isSelected=!0),"image"==(null===(s=r.selection)||void 0===s?void 0:s.type)&&r.selection.image==t&&(f.isSelectedAsImageSelection=!0,f.isSelected=!0);var v=(0,n.addSegment)(e,f);null===(c=r.domIndexer)||void 0===c||c.onSegment(t,v,[f])}))}},3780:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.knownElementProcessor=void 0;var o=r(6954),n=r(7665),a=r(673),i=r(1291),l=r(9408),s=r(9630),c=r(2487),d=r(4968),u=["marginBottom","marginTop","paddingBottom","paddingTop","paddingLeft","paddingRight","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","width","height","maxWidth","maxHeight","minWidth","minHeight"],f=["H1","H2","H3","H4","H5","H6","P","A"],p=["A","CODE"];t.knownElementProcessor=function(e,t,r){var m=(0,s.isBlockElement)(t);if((m||"inline-block"==t.style.display)&&function(e,t){if(f.indexOf(e.tagName)>=0)return!1;var r=e.style,o=(0,l.getDefaultStyle)(e),n=r.getPropertyValue("background-color");return!(!n||"transparent"==n)||(!!u.some((function(e){return parseInt(r[e]||o[e]||"")>0}))||("auto"==r.marginLeft||"auto"==r.marginRight||!!e.getAttribute("align")))}(t))(0,i.formatContainerProcessor)(e,t,r);else if(m){var v=r.blockDecorator.tagName?r.blockDecorator:void 0,g=p.indexOf(t.tagName)>=0;(0,d.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){var o={};(0,c.parseFormat)(t,r.formatParsers.segmentOnBlock,o,r),Object.assign(r.segmentFormat,o),(0,n.blockProcessor)(e,t,r,o)})),m&&!g&&(0,o.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat,void 0,v))}else(0,d.stackFormat)(r,{segment:"shallowClone",paragraph:"shallowClone",link:"cloneFormat"},(function(){(0,c.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r),r.link.format.href&&"A"!=t.tagName&&(0,c.parseFormat)(t,r.formatParsers.segmentUnderLink,r.link.format,r),r.elementProcessors.child(e,t,r)}))}},7659:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.linkProcessor=void 0;var o=r(3780),n=r(2487),a=r(4968);t.linkProcessor=function(e,t,r){t.hasAttribute("href")?(0,a.stackFormat)(r,{link:"linkDefault"},(function(){(0,n.parseFormat)(t,r.formatParsers.link,r.link.format,r),(0,n.parseFormat)(t,r.formatParsers.dataset,r.link.dataset,r),(0,o.knownElementProcessor)(e,t,r)})):(0,o.knownElementProcessor)(e,t,r)}},4030:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listItemProcessor=void 0;var o=r(5297),n=r(2487),a=r(4968);t.listItemProcessor=function(e,t,r){var i,l=r.listFormat;if(l.listParent&&l.levels.length>0)(0,a.stackFormat)(r,{segment:"shallowCloneForBlock"},(function(){(0,n.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r);var e=(0,o.createListItem)(l.levels,r.segmentFormat);(0,n.parseFormat)(t,r.formatParsers.listItemElement,e.format,r),l.listParent.blocks.push(e),(0,n.parseFormat)(t,r.formatParsers.listItemThread,e.levels[e.levels.length-1].format,r),r.elementProcessors.child(e,t,r);var a=e.blocks[0];1==e.blocks.length&&"Paragraph"==a.blockType&&a.isImplicit&&(Object.assign(e.format,a.format),a.format={})}));else{var s=null===(i=l.listParent)||void 0===i?void 0:i.blocks,c=null==s?void 0:s[(null==s?void 0:s.length)-1];r.elementProcessors["*"]("BlockGroup"==(null==c?void 0:c.blockType)?c:e,t,r)}}},8604:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listProcessor=void 0;var o=r(6549),n=r(2487),a=r(4968);t.listProcessor=function(e,t,r){(0,a.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},(function(){var a=(0,o.createListLevel)(t.tagName,r.blockFormat),i=r.listFormat;(0,n.parseFormat)(t,r.formatParsers.dataset,a.dataset,r),(0,n.parseFormat)(t,r.formatParsers.listLevelThread,a.format,r),(0,n.parseFormat)(t,r.formatParsers.listLevel,a.format,r),(0,n.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r);var l=i.listParent;i.listParent=i.listParent||e,i.levels.push(a);try{r.elementProcessors.child(e,t,r)}finally{i.levels.pop(),i.listParent=l}}))}},3919:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pProcessor=void 0;var o=r(6954),n=r(7665),a=r(673),i=r(4002),l=r(2487),s=r(4968);t.pProcessor=function(e,t,r){(0,s.stackFormat)(r,{blockDecorator:"empty",segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){r.blockDecorator=(0,i.createParagraphDecorator)(t.tagName);var o={};(0,l.parseFormat)(t,r.formatParsers.segmentOnBlock,o,r),Object.assign(r.segmentFormat,o),(0,n.blockProcessor)(e,t,r,o)})),(0,o.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat))}},793:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tableProcessor=void 0;var o=r(7582),n=r(6954),a=r(711),i=r(804),l=r(5627),s=r(6714),c=r(8882),d=r(2487),u=r(4406),f=r(4968);function p(e){for(var t=[],r=0,o=e.length-1;o>=0;o--)if("number"==typeof(n=e[o])){r=n;break}for(o=e.length-2;o>=0;o--){var n;void 0===(n=e[o])?t[o]=0:(t[o]=r-n,r=n)}return t}t.tableProcessor=function(e,t,r){(0,f.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},(function(){var m,v;(0,d.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var g=(0,a.createTable)(t.rows.length,r.blockFormat),h="table"==(null===(m=r.selection)||void 0===m?void 0:m.type)?r.selection:null,b=(null==h?void 0:h.table)==t;r.allowCacheElement&&(g.cachedElement=t),null===(v=r.domIndexer)||void 0===v||v.onTable(t,g),(0,d.parseFormat)(t,r.formatParsers.table,g.format,r),(0,d.parseFormat)(t,r.formatParsers.tableBorder,g.format,r),(0,d.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r),(0,d.parseFormat)(t,r.formatParsers.dataset,g.dataset,r),(0,n.addBlock)(e,g);for(var y=[0],S=function(e,t,r){for(var o,n,a=0,i=!1,l=e.firstChild;l;l=l.nextSibling)if((0,c.isNodeOfType)(l,"ELEMENT_NODE")&&"COLGROUP"==l.tagName){i=!0;for(var s=l.firstChild;s;s=s.nextSibling)if((0,c.isNodeOfType)(s,"ELEMENT_NODE")&&"COL"==s.tagName){var f={};(0,d.parseFormat)(s,t.formatParsers.tableColumn,f,t);for(var p=0;p<parseInt(null!==(o=s.getAttribute("span"))&&void 0!==o?o:"1");p++)if(void 0===f.width)r.push(void 0);else{var m=(0,u.parseValueWithUnit)(null!==(n=f.width)&&void 0!==n?n:"",void 0,"px");r.push(m+a),a+=m}}}return i}(t,r,y),C=[0],_=r.zoomScale||1,T=function(e){var n=t.rows[e],a=g.rows[e],u=n.parentNode;(0,c.isNodeOfType)(u,"ELEMENT_NODE")&&((0,s.isElementOfType)(u,"tbody")||(0,s.isElementOfType)(u,"thead")||(0,s.isElementOfType)(u,"tfoot"))?(0,d.parseFormat)(u,r.formatParsers.tableRow,a.format,r):r.allowCacheElement&&(a.cachedElement=n),(0,d.parseFormat)(n,r.formatParsers.tableRow,a.format,r),(0,f.stackFormat)(r,{paragraph:"shallowClone",segment:"shallowClone"},(function(){var t=n.parentElement,s=null==t?void 0:t.tagName;!t||"TBODY"!=s&&"THEAD"!=s&&"TFOOT"!=s||((0,d.parseFormat)(t,r.formatParsers.block,r.blockFormat,r),(0,d.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r)),(0,d.parseFormat)(n,r.formatParsers.block,r.blockFormat,r),(0,d.parseFormat)(n,r.formatParsers.segmentOnBlock,r.segmentFormat,r);for(var c,u=function(t,s){for(;a.cells[s];s++);var u=n.cells[t],p=r.isInSelection,m=s+u.colSpan,v=e+u.rowSpan,T=void 0===y[m],E=void 0===C[v];if(T||E){var k=(0,l.getBoundingClientRect)(u);if(k.width>0||k.height>0){if(T){var M=y[s];y[m]=("number"==typeof M?M:0)+k.width/_}E&&(C[v]=C[e]+k.height/_)}}(0,f.stackFormat)(r,{paragraph:"shallowClone",segment:"shallowClone"},(function(){(0,d.parseFormat)(u,r.formatParsers.block,r.blockFormat,r),(0,d.parseFormat)(u,r.formatParsers.segmentOnTableCell,r.segmentFormat,r);var t=(0,o.__assign)({},r.blockFormat),n={};(0,d.parseFormat)(u,r.formatParsers.tableCell,t,r),(0,d.parseFormat)(u,r.formatParsers.tableBorder,t,r),(0,d.parseFormat)(u,r.formatParsers.dataset,n,r);for(var a=1;a<=u.colSpan;a++,s++)for(var l=1;l<=u.rowSpan;l++){var c=1==a&&1==l,f=(0,i.createTableCell)(a>1,l>1,"TH"==u.tagName,t);f.dataset=(0,o.__assign)({},n);var m=g.rows[e+l-1];if(m&&(m.cells[s]=f),c){r.allowCacheElement&&!S&&(f.cachedElement=u);var v=r.listFormat,y=v.listParent,C=v.levels;r.listFormat.listParent=void 0,r.listFormat.levels=[];try{r.elementProcessors.child(f,u,r)}finally{r.listFormat.listParent=y,r.listFormat.levels=C}}var _=r.isInSelection;(p&&_||b&&h&&e>=h.firstRow&&e<=h.lastRow&&s>=h.firstColumn&&s<=h.lastColumn)&&(f.isSelected=!0)}})),c=s},p=0,m=0;p<n.cells.length;p++)u(p,m),m=c}));for(var p=0;p<a.cells.length;p++)a.cells[p]||(a.cells[p]=(0,i.createTableCell)(!1,!1,!1,r.blockFormat))},E=0;E<t.rows.length;E++)T(E);g.widths=p(y);var k=p(C);g.rows.forEach((function(e,t){k[t]>0&&(e.height=k[t])}))}))}},6214:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textProcessor=void 0;var o=r(6630),n=r(8613),a=r(3344),i=r(2362),l=r(2452),s=r(4714),c=r(75),d=r(7509),u=r(4968);function f(e,t,r){var o,n=t.nodeValue||"",i=(0,s.getRegularSelectionOffsets)(r,t),c=i[0],d=i[1],u=[],f=(0,l.ensureParagraph)(e,r.blockFormat);if(c>=0){var m=n.substring(0,c);u.push(p(e,m,f,r)),r.isInSelection=!0,(0,a.addSelectionMarker)(e,r,t,c),n=n.substring(c),d-=c}d>=0&&(m=n.substring(0,d),u.push(p(e,m,f,r)),!r.selection||"range"==r.selection.type&&r.selection.range.collapsed||(0,a.addSelectionMarker)(e,r,t,i[1]),r.isInSelection=!1,n=n.substring(d)),u.push(p(e,n,f,r)),null===(o=r.domIndexer)||void 0===o||o.onSegment(t,f,u.filter((function(e){return!!e})))}function p(e,t,r,a){var l,s;return t&&(!(0,c.hasSpacesOnly)(t)||(null!==(l=null==r?void 0:r.segments.length)&&void 0!==l?l:0)>0||(0,d.isWhiteSpacePreserved)(null==r?void 0:r.format.whiteSpace))&&(s=(0,i.createText)(t,a.segmentFormat),a.isInSelection&&(s.isSelected=!0),(0,o.addDecorators)(s,a),(0,n.addSegment)(e,s,a.blockFormat)),s}t.textProcessor=function(e,t,r){r.formatParsers.text.length>0?(0,u.stackFormat)(r,{segment:"shallowClone"},(function(){r.formatParsers.text.forEach((function(o){o(r.segmentFormat,t,r),f(e,t,r)}))})):f(e,t,r)}},3344:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSelectionMarker=void 0;var o=r(7582),n=r(6630),a=r(8613),i=r(9804);t.addSelectionMarker=function(e,t,r,l){var s=e.blocks[e.blocks.length-1],c=s&&"Paragraph"==s.blockType?s.decorator?{fontFamily:s.decorator.format.fontFamily,fontSize:s.decorator.format.fontSize}:s.segmentFormat?{fontFamily:s.segmentFormat.fontFamily,fontSize:s.segmentFormat.fontSize}:{}:{},d=t.pendingFormat&&t.pendingFormat.posContainer===r&&t.pendingFormat.posOffset===l?t.pendingFormat.format:void 0,u=(0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)({},t.defaultFormat),c),t.segmentFormat),d),f=(0,i.createSelectionMarker)(u);(0,n.addDecorators)(f,t),(0,a.addSegment)(e,f,t.blockFormat,u)}},7866:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areSameFormats=void 0;var o=r(546);t.areSameFormats=function(e,t){if(e==t)return!0;var r=(0,o.getObjectKeys)(e),n=(0,o.getObjectKeys)(t);return r.length==n.length&&r.every((function(r){return e[r]==t[r]}))}},5627:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingClientRect=void 0,t.getBoundingClientRect=function(e){return e.getBoundingClientRect()}},9408:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultStyle=void 0;var o=r(3413);t.getDefaultStyle=function(e){var t=e.tagName.toLowerCase();return o.defaultHTMLStyleMap[t]||{}}},4714:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRegularSelectionOffsets=void 0,t.getRegularSelectionOffsets=function(e,t){var r,o="range"==(null===(r=e.selection)||void 0===r?void 0:r.type)?e.selection.range:null;return[(null==o?void 0:o.startContainer)==t?o.startOffset:-1,(null==o?void 0:o.endContainer)==t?o.endOffset:-1]}},9630:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBlockElement=void 0;var o=r(9408),n=["block","list-item","table","table-cell","flex"];t.isBlockElement=function(e){var t=e.style.display||(0,o.getDefaultStyle)(e).display||"";return n.indexOf(t)>=0}},2487:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseFormat=void 0;var o=r(9408);t.parseFormat=function(e,t,r,n){var a=(0,o.getDefaultStyle)(e);t.forEach((function(t){null==t||t(r,e,n,a)}))}},4968:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stackFormat=void 0;var o=r(7582),n=r(546),a=["backgroundColor"],i=["marginLeft","marginRight","paddingLeft","paddingRight"];function l(e,t){switch(t){case"empty":return{};case void 0:return e;default:var r=(0,o.__assign)({},e);if((0,n.getObjectKeys)(e).forEach((function(e){("shallowCloneForBlock"==t&&a.indexOf(e)>=0||"shallowCloneForGroup"==t&&i.indexOf(e)>=0)&&delete r[e]})),"shallowClone"==t||"shallowCloneForGroup"==t){var l=e;l.textIndent&&(delete r.isTextIndentApplied,l.isTextIndentApplied=!0)}return r}}t.stackFormat=function(e,t,r){var n,a=e.segmentFormat,i=e.blockFormat,s=e.link,c=e.code,d=e.blockDecorator,u=t.segment,f=t.paragraph,p=t.link,m=t.code,v=t.blockDecorator;try{e.segmentFormat=l(a,u),e.blockFormat=l(i,f),e.link=function(e,t){switch(t){case"linkDefault":return{format:{underline:!0},dataset:{}};case"empty":return{format:{},dataset:{}};default:return{dataset:e.dataset,format:(0,o.__assign)({},e.format)}}}(s,p),e.code=function(e,t){switch(t){case"codeDefault":return{format:{fontFamily:"monospace"}};case"empty":return{format:{}};default:return e}}(c,m),e.blockDecorator=(n=d,"empty"===v?{format:{},tagName:""}:n),r()}finally{e.segmentFormat=a,e.blockFormat=i,e.link=s,e.code=c,e.blockDecorator=d}}},3566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDelimiters=t.isEntityDelimiter=t.generateEntityClassNames=t.parseEntityFormat=t.getAllEntityWrappers=t.findClosestEntityWrapper=t.isEntityElement=void 0;var o=r(7582),n=r(4043),a=r(6714),i=r(8882),l=r(7834),s="_Entity",c="_EType_",d="_EId_",u="_EReadonly_",f="entityDelimiterBefore",p="entityDelimiterAfter";function m(e,t){return(null==e?void 0:e.classList.contains(t))&&""==e.textContent?e:void 0}function v(e,t,r){var o,n=e.createElement("span");return n.className=r?p:f,n.appendChild(e.createTextNode("")),null===(o=t.parentNode)||void 0===o||o.insertBefore(n,r?t.nextSibling:t),n}t.isEntityElement=function(e){return(0,i.isNodeOfType)(e,"ELEMENT_NODE")&&e.classList.contains(s)},t.findClosestEntityWrapper=function(e,t){return t.findClosestElementAncestor(e,"."+s)},t.getAllEntityWrappers=function(e){return(0,l.toArray)(e.querySelectorAll("."+s))},t.parseEntityFormat=function(e){var t=!1,r={};return e.classList.forEach((function(e){t=function(e,t){if(e==s)return!0;0==e.indexOf(c)?t.entityType=e.substring(7):0==e.indexOf(d)?t.id=e.substring(5):0==e.indexOf(u)&&(t.isReadonly="1"==e.substring(11))}(e,r)||t})),t||(r.isFakeEntity=!0,r.isReadonly=!e.isContentEditable),r},t.generateEntityClassNames=function(e){var t;return e.isFakeEntity?"":s+" "+c+(null!==(t=e.entityType)&&void 0!==t?t:"")+" "+(e.id?""+d+e.id+" ":"")+u+(e.isReadonly?"1":"0")},t.isEntityDelimiter=function(e){return(0,a.isElementOfType)(e,"span")&&(e.classList.contains(p)||e.classList.contains(f))&&""===e.textContent},t.addDelimiters=function(e,t,r,a){var i,l,s,c,d=(0,o.__read)((l=[],s=(i=t).nextElementSibling,c=i.previousElementSibling,l.push(m(s,p),m(c,f)),l),2),u=d[0],g=d[1];return u||(u=v(e,t,!0),a&&r&&(0,n.applyFormat)(u,a.formatAppliers.segment,r,a)),g||(g=v(e,t,!1),a&&r&&(0,n.applyFormat)(g,a.formatAppliers.segment,r,a)),[u,g]}},546:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getObjectKeys=void 0,t.getObjectKeys=function(e){return Object.keys(e)}},6714:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isElementOfType=void 0,t.isElementOfType=function(e,t){var r;return(null===(r=null==e?void 0:e.tagName)||void 0===r?void 0:r.toLocaleLowerCase())==t}},8882:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeOfType=void 0,t.isNodeOfType=function(e,t){return!!e&&e.nodeType==Node[t]}},7509:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isWhiteSpacePreserved=void 0;var r=["pre","pre-wrap","break-spaces"];t.isWhiteSpacePreserved=function(e){return!!e&&r.indexOf(e)>=0}},4231:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasMetadata=t.updateMetadata=void 0;var o=r(5775),n="editingInfo";t.updateMetadata=function(e,t,r){var a=e.dataset[n],i=null;try{i=JSON.parse(a)}catch(e){}return r&&!(0,o.validate)(i,r)&&(i=null),t&&((i=t(i))?r&&!(0,o.validate)(i,r)||(e.dataset[n]=JSON.stringify(i)):delete e.dataset[n]),i},t.hasMetadata=function(e){return!!e.dataset[n]}},5775:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validate=void 0;var o=r(546);t.validate=function e(t,r){var n,a,i=!1;if(r.isOptional&&void 0===t||r.allowNull&&null===t)i=!0;else{if(!r.isOptional&&void 0===t||!r.allowNull&&null===t)return!1;switch(r.type){case"string":i="string"==typeof t&&(void 0===r.value||t===r.value);break;case"number":i="number"==typeof t&&(void 0===r.value||(n=r.value,a=t,Math.abs(n-a)<.001))&&(void 0===r.minValue||t>=r.minValue)&&(void 0===r.maxValue||t<=r.maxValue);break;case"boolean":i="boolean"==typeof t&&(void 0===r.value||t===r.value);break;case"array":i=Array.isArray(t)&&(void 0===r.minLength||t.length>=r.minLength)&&(void 0===r.maxLength||t.length<=r.maxLength)&&t.every((function(t){return e(t,r.itemDef)}));break;case"object":i="object"==typeof t&&(0,o.getObjectKeys)(r.propertyDef).every((function(o){return e(t[o],r.propertyDef[o])}))}}return i}},973:(e,t)=>{function r(e,t,r){if(e){for(;!r&&e.firstChild;)e.removeChild(e.firstChild);for(;null==t?void 0:t.firstChild;)e.appendChild(t.firstChild)}}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapAllChildNodes=t.moveChildNodes=void 0,t.moveChildNodes=r,t.wrapAllChildNodes=function(e,t){var o=e.ownerDocument.createElement(t);return r(o,e),e.appendChild(o),o}},5077:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeRect=void 0,t.normalizeRect=function(e){var t=e||{left:0,right:0,top:0,bottom:0},r=t.left,o=t.right,n=t.top,a=t.bottom;return 0===r&&0===o&&0===n&&0===a?null:{left:Math.round(r),right:Math.round(o),top:Math.round(n),bottom:Math.round(a)}}},5345:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeNode=t.reuseCachedElement=void 0;var o=r(3566);t.reuseCachedElement=function(e,t,r){var n;if(t.parentNode==e){for(var a=(0,o.isEntityElement)(t);r&&r!=t&&(a||!(0,o.isEntityElement)(r));){var i=r.nextSibling;null===(n=r.parentNode)||void 0===n||n.removeChild(r),r=i}r&&r==t?r=r.nextSibling:e.insertBefore(t,r)}else e.insertBefore(t,r);return r},t.removeNode=function(e){var t,r=e.nextSibling;return null===(t=e.parentNode)||void 0===t||t.removeChild(e),r}},7834:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toArray=void 0,t.toArray=function(e){return[].slice.call(e)}},3242:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=void 0,t.unwrap=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},3168:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrap=void 0,t.wrap=function(e,t,r){var o,n=e.createElement(r);return null===(o=t.parentNode)||void 0===o||o.insertBefore(n,t),n.appendChild(t),n}},5729:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.directionFormatHandler=void 0,t.directionFormatHandler={parse:function(e,t,r,o){var n=t.style.direction||t.dir||o.direction;n&&(e.direction="rtl"==n?"rtl":"ltr")},apply:function(e,t){e.direction&&(t.style.direction=e.direction)}}},1051:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.displayFormatHandler=void 0,t.displayFormatHandler={parse:function(e,t){var r=t.style.display;r&&(e.display=r)},apply:function(e,t){e.display&&(t.style.display=e.display)}}},292:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.htmlAlignFormatHandler=void 0;var o=r(73),n=r(5729);t.htmlAlignFormatHandler={parse:function(e,t,r,a){n.directionFormatHandler.parse(e,t,r,a);var i=t.getAttribute("align");i&&(e.htmlAlign=(0,o.calcAlign)(i,e.direction),delete e.textAlign,delete r.blockFormat.textAlign)},apply:function(e,t){var r="rtl"==e.direction?"rtl":"ltr";e.htmlAlign&&t.setAttribute("align",o.ResultMap[e.htmlAlign][r])}}},2962:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lineHeightFormatHandler=void 0,t.lineHeightFormatHandler={parse:function(e,t,r,o){var n=t.style.lineHeight||o.lineHeight;n&&"inherit"!=n&&(e.lineHeight=n)},apply:function(e,t){e.lineHeight&&(t.style.lineHeight=e.lineHeight)}}},9084:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.marginFormatHandler=void 0;var o=r(4406),n=["marginTop","marginRight","marginBottom","marginLeft"];t.marginFormatHandler={parse:function(e,t,r,a){n.forEach((function(r){var n=t.style[r]||a[r];if(n)switch(r){case"marginTop":case"marginBottom":e[r]=n;break;case"marginLeft":case"marginRight":e[r]=e[r]?(0,o.parseValueWithUnit)(e[r]||"",t)+(0,o.parseValueWithUnit)(n,t)+"px":n}}))},apply:function(e,t,r){n.forEach((function(o){var n=e[o];n!=r.implicitFormat[o]&&(t.style[o]=n||"0")}))}}},9:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.paddingFormatHandler=void 0;var o=r(5729),n=["paddingTop","paddingRight","paddingBottom","paddingLeft"],a={paddingLeft:"paddingInlineStart"},i={paddingRight:"paddingInlineStart"};t.paddingFormatHandler={parse:function(e,t,r,l){o.directionFormatHandler.parse(e,t,r,l),n.forEach((function(r){var o,n,s=t.style[r],c=("rtl"==e.direction?i:a)[r],d=(null!==(n=null!==(o=l[r])&&void 0!==o?o:c?l[c]:void 0)&&void 0!==n?n:"0px")+"";s||(s=d),s&&"0"!=s||(s="0px"),s&&s!=d&&(e[r]=s)}))},apply:function(e,t,r){n.forEach((function(r){var o=e[r],n=void 0;"OL"!=t.tagName&&"UL"!=t.tagName||("rtl"==e.direction&&"paddingRight"==r||"rtl"!=e.direction&&"paddingLeft"==r)&&(n="40px"),o&&o!=n&&(t.style[r]=o)}))}}},6135:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textAlignFormatHandler=void 0;var o=r(73),n=r(5729);t.textAlignFormatHandler={parse:function(e,t,r,a){var i;n.directionFormatHandler.parse(e,t,r,a);var l=t.style.textAlign||a.textAlign;"LI"==t.tagName&&"flex"===(null===(i=t.parentElement)||void 0===i?void 0:i.style.display)&&"column"===t.parentElement.style.flexDirection&&t.style.alignSelf&&(l=t.style.alignSelf),l&&(e.textAlign=(0,o.calcAlign)(l,e.direction))},apply:function(e,t){var r="rtl"==e.direction?"rtl":"ltr";if(e.textAlign){var n=t.parentElement,a=null==n?void 0:n.tagName;"LI"!=t.tagName||!n||"OL"!=a&&"UL"!=a?t.style.textAlign=o.ResultMap[e.textAlign][r]:(t.style.alignSelf=e.textAlign,t.parentElement.style.flexDirection="column",t.parentElement.style.display="flex")}}}},990:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textIndentFormatHandler=void 0,t.textIndentFormatHandler={parse:function(e,t){var r=t.style.textIndent;r&&(e.textIndent=r)},apply:function(e,t){e.textIndent&&(t.style.textIndent=e.textIndent)}}},3743:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.whiteSpaceFormatHandler=void 0;var o=r(539);t.whiteSpaceFormatHandler={parse:function(e,t,r,n){var a=t.style.whiteSpace||n.whiteSpace;(0,o.shouldSetValue)(a,"normal",e.whiteSpace,n.whiteSpace)&&(e.whiteSpace=a)},apply:function(e,t,r){var o=r.implicitFormat.whiteSpace;e.whiteSpace!=o&&(t.style.whiteSpace=e.whiteSpace||"normal")}}},5687:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backgroundColorFormatHandler=void 0;var o=r(1410),n=r(539);t.backgroundColorFormatHandler={parse:function(e,t,r,a){var i=(0,o.getColor)(t,!0,!!r.isDarkMode,r.darkColorHandler)||a.backgroundColor;(0,n.shouldSetValue)(i,"transparent",void 0,a.backgroundColor)&&(e.backgroundColor=i)},apply:function(e,t,r){e.backgroundColor&&(0,o.setColor)(t,e.backgroundColor,!0,!!r.isDarkMode,r.darkColorHandler)}}},6027:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.borderBoxFormatHandler=void 0,t.borderBoxFormatHandler={parse:function(e,t){var r;"border-box"==(null===(r=t.style)||void 0===r?void 0:r.boxSizing)&&(e.useBorderBox=!0)},apply:function(e,t){e.useBorderBox&&(t.style.boxSizing="border-box")}}},5493:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.borderFormatHandler=t.BorderKeys=void 0,t.BorderKeys=["borderTop","borderRight","borderBottom","borderLeft"];var r=["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"],o=["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"],n=t.BorderKeys.concat(o);t.borderFormatHandler={parse:function(e,n,a,i){t.BorderKeys.forEach((function(t,o){var a,l=n.style[t],s=null!==(a=i[r[o]])&&void 0!==a?a:"0px",c=n.style[r[o]];"0"==c&&(c="0px"),l&&c!=s&&(e[t]="none"==l?"":l)}));var l=n.style.borderRadius;l?e.borderRadius=l:o.forEach((function(t){var r=n.style[t];r&&(e[t]=r)}))},apply:function(e,t){n.forEach((function(r){var o=e[r];o&&(t.style[r]=o)})),e.borderRadius&&(t.style.borderRadius=e.borderRadius)}}},705:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.boxShadowFormatHandler=void 0,t.boxShadowFormatHandler={parse:function(e,t){var r;(null===(r=t.style)||void 0===r?void 0:r.boxShadow)&&(e.boxShadow=t.style.boxShadow)},apply:function(e,t){e.boxShadow&&(t.style.boxShadow=e.boxShadow)}}},938:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.datasetFormatHandler=void 0;var o=r(546);t.datasetFormatHandler={parse:function(e,t){var r=t.dataset;(0,o.getObjectKeys)(r).forEach((function(t){e[t]=r[t]||""}))},apply:function(e,t){(0,o.getObjectKeys)(e).forEach((function(r){t.dataset[r]=e[r]}))}}},6586:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.floatFormatHandler=void 0,t.floatFormatHandler={parse:function(e,t){var r=t.style.float||t.getAttribute("align");r&&(e.float=r)},apply:function(e,t){e.float&&(t.style.float=e.float)}}},5965:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.idFormatHandler=void 0,t.idFormatHandler={parse:function(e,t){t.id&&(e.id=t.id)},apply:function(e,t){e.id&&(t.id=e.id)}}},1481:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sizeFormatHandler=void 0;var r=/[\d\.]+%/;function o(e,t){var o=e.getAttribute(t),n=parseInt(o||"");return o&&r.test(o)?o:Number.isNaN(n)||0==n?void 0:n+"px"}t.sizeFormatHandler={parse:function(e,t,r){var n=t.style.width||o(t,"width"),a=t.style.height||o(t,"height"),i=t.style.maxWidth,l=t.style.maxHeight,s=t.style.minWidth,c=t.style.minHeight;n&&(e.width=n),a&&(e.height=a),i&&(e.maxWidth=i),l&&(e.maxHeight=l),s&&(e.minWidth=s),c&&(e.minHeight=c)},apply:function(e,t){e.width&&(t.style.width=e.width),e.height&&(t.style.height=e.height),e.maxWidth&&(t.style.maxWidth=e.maxWidth),e.maxHeight&&(t.style.maxHeight=e.maxHeight),e.minWidth&&(t.style.minWidth=e.minWidth),e.minHeight&&(t.style.minHeight=e.minHeight)}}},3634:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.verticalAlignFormatHandler=void 0,t.verticalAlignFormatHandler={parse:function(e,t){switch(t.style.verticalAlign||t.getAttribute("valign")){case"baseline":case"initial":case"super":case"sub":case"text-top":case"text-bottom":case"top":e.verticalAlign="top";break;case"bottom":e.verticalAlign="bottom";break;case"middle":e.verticalAlign="middle"}},apply:function(e,t){e.verticalAlign&&(t.style.verticalAlign=e.verticalAlign)}}},5565:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wordBreakFormatHandler=void 0,t.wordBreakFormatHandler={parse:function(e,t,r,o){var n=t.style.wordBreak||o.wordBreak;n&&(e.wordBreak=n)},apply:function(e,t){e.wordBreak&&(t.style.wordBreak=e.wordBreak)}}},5606:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFormatAppliers=t.defaultFormatParsers=t.defaultFormatKeysPerCategory=void 0;var o=r(7582),n=r(5687),a=r(3489),i=r(6027),l=r(5493),s=r(705),c=r(938),d=r(5729),u=r(1051),f=r(1443),p=r(6586),m=r(6092),v=r(9115),g=r(546),h=r(292),b=r(5965),y=r(6533),S=r(6031),C=r(2962),_=r(9424),T=r(3749),E=r(7089),k=r(5280),M=r(9084),P=r(9),O=r(1481),w=r(8626),x=r(4110),F=r(2941),D=r(5253),L=r(6135),j=r(389),N=r(3231),I=r(990),R=r(1026),A=r(3634),B=r(3743),H=r(5565),z={backgroundColor:n.backgroundColorFormatHandler,bold:a.boldFormatHandler,border:l.borderFormatHandler,borderBox:i.borderBoxFormatHandler,boxShadow:s.boxShadowFormatHandler,dataset:c.datasetFormatHandler,direction:d.directionFormatHandler,display:u.displayFormatHandler,float:p.floatFormatHandler,fontFamily:m.fontFamilyFormatHandler,fontSize:v.fontSizeFormatHandler,entity:f.entityFormatHandler,htmlAlign:h.htmlAlignFormatHandler,id:b.idFormatHandler,italic:y.italicFormatHandler,letterSpacing:S.letterSpacingFormatHandler,lineHeight:C.lineHeightFormatHandler,link:_.linkFormatHandler,listItemThread:T.listItemThreadFormatHandler,listLevelThread:E.listLevelThreadFormatHandler,listStyle:k.listStyleFormatHandler,margin:M.marginFormatHandler,padding:P.paddingFormatHandler,size:O.sizeFormatHandler,strike:w.strikeFormatHandler,superOrSubScript:x.superOrSubScriptFormatHandler,tableLayout:F.tableLayoutFormatHandler,tableSpacing:D.tableSpacingFormatHandler,textAlign:L.textAlignFormatHandler,textColor:j.textColorFormatHandler,textColorOnTableCell:N.textColorOnTableCellFormatHandler,textIndent:I.textIndentFormatHandler,underline:R.underlineFormatHandler,verticalAlign:A.verticalAlignFormatHandler,whiteSpace:B.whiteSpaceFormatHandler,wordBreak:H.wordBreakFormatHandler},W=["letterSpacing","fontFamily","fontSize"],G=["strike","underline","superOrSubScript","italic","bold"],U=["direction","textAlign","textIndent","lineHeight","whiteSpace"],K=["backgroundColor","margin","padding","border"];t.defaultFormatKeysPerCategory={block:U,listItemThread:["listItemThread"],listLevelThread:["listLevelThread"],listItemElement:(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(U),!1),["direction","textAlign","lineHeight","margin","listStyle"],!1),listLevel:["direction","textAlign","margin","padding","listStyle","backgroundColor"],styleBasedSegment:(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(W),!1),["textColor","backgroundColor","lineHeight"],!1),elementBasedSegment:G,segment:(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(W),!1),(0,o.__read)(G),!1),["textColor","backgroundColor","lineHeight"],!1),segmentOnBlock:(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(W),!1),(0,o.__read)(G),!1),["textColor"],!1),segmentOnTableCell:(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(W),!1),(0,o.__read)(G),!1),["textColorOnTableCell"],!1),tableCell:["border","backgroundColor","padding","verticalAlign","wordBreak","textColor","htmlAlign","size"],tableRow:["backgroundColor"],tableColumn:["size"],table:["id","border","backgroundColor","display","htmlAlign","margin","size","tableLayout","textColor"],tableBorder:["borderBox","tableSpacing"],tableCellBorder:["borderBox"],image:["id","size","margin","padding","borderBox","border","boxShadow","display","float","verticalAlign"],link:["link","textColor","underline","display","margin","padding","backgroundColor","border","size","textAlign"],segmentUnderLink:["textColor"],code:["fontFamily","display"],dataset:["dataset"],divider:(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(U),!1),(0,o.__read)(K),!1),["display","size","htmlAlign"],!1),container:(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(K),!1),["htmlAlign","size","display"],!1),entity:["entity"],general:["textColor","backgroundColor"]},t.defaultFormatParsers=(0,g.getObjectKeys)(z).reduce((function(e,t){return e[t]=z[t].parse,e}),{}),t.defaultFormatAppliers=(0,g.getObjectKeys)(z).reduce((function(e,t){return e[t]=z[t].apply,e}),{})},1443:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.entityFormatHandler=void 0;var o=r(3566);t.entityFormatHandler={parse:function(e,t){Object.assign(e,(0,o.parseEntityFormat)(t))},apply:function(e,t){e.isFakeEntity||(t.className=(0,o.generateEntityClassNames)(e)),e.isReadonly?t.contentEditable="false":t.removeAttribute("contenteditable")}}},3749:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listItemThreadFormatHandler=void 0;var o=r(6714),n=r(8882);function a(e){return(0,o.isElementOfType)(e,"li")&&(0,n.isNodeOfType)(e.parentNode,"ELEMENT_NODE")&&(0,o.isElementOfType)(e.parentNode,"ol")}t.listItemThreadFormatHandler={parse:function(e,t,r,o){var n=r.listFormat,i=n.levels.length,l=t.style.display||o.display;l&&"list-item"!=l?e.displayForDummyItem=l:a(t)&&i>0&&(n.threadItemCounts[i-1]++,n.threadItemCounts.splice(i),n.levels.forEach((function(e){delete e.format.startNumberOverride})))},apply:function(e,t,r){var o;if(e.displayForDummyItem)t.style.display=e.displayForDummyItem;else if(a(t)){var n=r.listFormat,i=n.threadItemCounts,l=n.nodeStack.length-2;l>=0&&(i.splice(l+1),i[l]=(null!==(o=i[l])&&void 0!==o?o:0)+1)}}}},7089:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listLevelThreadFormatHandler=void 0;var o=r(6714);t.listLevelThreadFormatHandler={parse:function(e,t,r){if((0,o.isElementOfType)(t,"ol")){var n=r.listFormat,a=n.threadItemCounts,i=n.levels.length;"number"==typeof a[i]&&t.start!=a[i]+1&&(e.startNumberOverride=t.start),a[i]=t.start-1}},apply:function(e,t,r){var n=r.listFormat,a=n.threadItemCounts,i=n.nodeStack.length-2;if(i>=0&&(0,o.isElementOfType)(t,"ol")){var l=e.startNumberOverride;"number"==typeof l?a[i]=l-1:"number"!=typeof a[i]&&(a[i]=0),a.splice(i+1),t.start=a[i]+1}}}},5280:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listStyleFormatHandler=void 0,t.listStyleFormatHandler={parse:function(e,t){var r=t.style.listStylePosition,o=t.style.listStyleType;r&&(e.listStylePosition=r),o&&(e.listStyleType=o)},apply:function(e,t){e.listStylePosition&&(t.style.listStylePosition=e.listStylePosition),e.listStyleType&&(t.style.listStyleType=e.listStyleType)}}},3489:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.boldFormatHandler=void 0;var o=r(539),n=r(973);t.boldFormatHandler={parse:function(e,t,r,n){var a=t.style.fontWeight||n.fontWeight;(0,o.shouldSetValue)(a,"400",e.fontWeight,n.fontWeight)&&(e.fontWeight=a)},apply:function(e,t,r){if(void 0!==e.fontWeight){var o=r.implicitFormat.fontWeight;(o&&o!=e.fontWeight||!o&&e.fontWeight&&"normal"!=e.fontWeight)&&("bold"==e.fontWeight?(0,n.wrapAllChildNodes)(t,"b"):t.style.fontWeight=e.fontWeight||"normal")}}}},6092:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fontFamilyFormatHandler=void 0,t.fontFamilyFormatHandler={parse:function(e,t,r,o){var n=t.style.fontFamily||o.fontFamily;n&&"inherit"!=n&&(e.fontFamily=n)},apply:function(e,t,r){e.fontFamily&&e.fontFamily!=r.implicitFormat.fontFamily&&(t.style.fontFamily=e.fontFamily)}}},9115:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fontSizeFormatHandler=void 0;var o=r(4110),n=r(4406);t.fontSizeFormatHandler={parse:function(e,t,r,i){var l=t.style.fontSize||i.fontSize,s=t.style.verticalAlign||i.verticalAlign;l&&!(0,o.isSuperOrSubScript)(l,s)&&"inherit"!=l&&(t.style.fontSize?e.fontSize=function(e,t,r){var o=a[e],i=e.endsWith("rem");if(o)return o;if(!("smaller"==e||"larger"==e||e.endsWith("em")||e.endsWith("%")||i))return"inherit"==e||"revert"==e||"unset"==e?void 0:e;if(t||i){var l=i?r.rootFontSize:(0,n.parseValueWithUnit)(t);if(l)switch(e){case"smaller":return Math.round(500*l/6)/100+"px";case"larger":return Math.round(600*l/5)/100+"px";default:return(0,n.parseValueWithUnit)(e,l,"px")+"px"}}}(l,r.segmentFormat.fontSize,r):i.fontSize&&(e.fontSize=l))},apply:function(e,t,r){e.fontSize&&e.fontSize!=r.implicitFormat.fontSize&&(t.style.fontSize=e.fontSize)}};var a={"xx-small":"6.75pt","x-small":"7.5pt",small:"9.75pt",medium:"12pt",large:"13.5pt","x-large":"18pt","xx-large":"24pt","xxx-large":"36pt"}},6533:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.italicFormatHandler=void 0;var o=r(973);t.italicFormatHandler={parse:function(e,t,r,o){var n=t.style.fontStyle||o.fontStyle;"italic"==n||"oblique"==n?e.italic=!0:"initial"!=n&&"normal"!=n||(e.italic=!1)},apply:function(e,t,r){void 0!==e.italic&&!!r.implicitFormat.italic!=!!e.italic&&(e.italic?(0,o.wrapAllChildNodes)(t,"i"):t.style.fontStyle="normal")}}},6031:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.letterSpacingFormatHandler=void 0;var o=r(539);t.letterSpacingFormatHandler={parse:function(e,t,r,n){var a=t.style.letterSpacing||n.letterSpacing;(0,o.shouldSetValue)(a,"normal",e.letterSpacing,n.letterSpacing)&&(e.letterSpacing=a)},apply:function(e,t){e.letterSpacing&&(t.style.letterSpacing=e.letterSpacing)}}},9424:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.linkFormatHandler=void 0;var o=r(6714);t.linkFormatHandler={parse:function(e,t){if((0,o.isElementOfType)(t,"a")){var r=t.name,n=t.getAttribute("href"),a=t.target,i=t.rel,l=t.id,s=t.className,c=t.title;r&&(e.name=r),n&&(e.href=n),a&&(e.target=a),l&&(e.anchorId=l),i&&(e.relationship=i),c&&(e.anchorTitle=c),s&&(e.anchorClass=s)}},apply:function(e,t){(0,o.isElementOfType)(t,"a")&&e.href&&(t.href=e.href,e.name&&(t.name=e.name),e.target&&(t.target=e.target),e.anchorId&&(t.id=e.anchorId),e.anchorClass&&(t.className=e.anchorClass),e.anchorTitle&&(t.title=e.anchorTitle),e.relationship&&(t.rel=e.relationship))}}},8626:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.strikeFormatHandler=void 0;var o=r(973);t.strikeFormatHandler={parse:function(e,t,r,o){var n=t.style.textDecoration||o.textDecoration;(null==n?void 0:n.indexOf("line-through"))>=0&&(e.strikethrough=!0)},apply:function(e,t){e.strikethrough&&(0,o.wrapAllChildNodes)(t,"s")}}},4110:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSuperOrSubScript=t.superOrSubScriptFormatHandler=void 0;var o=r(973);function n(e,t){return"smaller"==e&&("sub"==t||"super"==t)}t.superOrSubScriptFormatHandler={parse:function(e,t,r,o){var a=t.style.verticalAlign||o.verticalAlign;n(t.style.fontSize||o.fontSize,a)&&(e.superOrSubScriptSequence=(e.superOrSubScriptSequence||"").split(" ").concat(a).join(" ").trim())},apply:function(e,t){e.superOrSubScriptSequence&&e.superOrSubScriptSequence.split(" ").reverse().forEach((function(e){var r="super"==e?"sup":"sub"==e?"sub":null;r&&(0,o.wrapAllChildNodes)(t,r)}))}},t.isSuperOrSubScript=n},389:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textColorFormatHandler=void 0;var o=r(1410);t.textColorFormatHandler={parse:function(e,t,r,n){var a=(0,o.getColor)(t,!1,!!r.isDarkMode,r.darkColorHandler)||n.color;a&&"inherit"!=a&&(e.textColor=a)},apply:function(e,t,r){var n=r.implicitFormat.textColor;e.textColor&&e.textColor!=n&&(0,o.setColor)(t,e.textColor,!1,!!r.isDarkMode,r.darkColorHandler)}}},1026:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.underlineFormatHandler=void 0;var o=r(973);t.underlineFormatHandler={parse:function(e,t,r,o){var n=t.style.textDecoration||o.textDecoration;(null==n?void 0:n.indexOf("underline"))>=0?e.underline=!0:"A"==t.tagName&&"none"==n&&(e.underline=!1)},apply:function(e,t,r){void 0!==e.underline&&!!r.implicitFormat.underline!=!!e.underline&&(e.underline?(0,o.wrapAllChildNodes)(t,"u"):t.style.textDecoration="none")}}},2941:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tableLayoutFormatHandler=void 0,t.tableLayoutFormatHandler={parse:function(e,t){var r=t.style.tableLayout;r&&"inherit"!=r&&(e.tableLayout=r)},apply:function(e,t){e.tableLayout&&(t.style.tableLayout=e.tableLayout)}}},5253:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tableSpacingFormatHandler=void 0;var r="collapse",o="separate";t.tableSpacingFormatHandler={parse:function(e,t){(t.style.borderCollapse==r||t.getAttribute("cellPadding"))&&(e.borderCollapse=!0),t.style.borderCollapse==o&&(e.borderSeparate=!0)},apply:function(e,t){e.borderCollapse?(t.style.borderCollapse=r,t.style.borderSpacing="0",t.style.boxSizing="border-box"):e.borderSeparate&&(t.style.borderCollapse=o,t.style.borderSpacing="0",t.style.boxSizing="border-box")}}},3231:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textColorOnTableCellFormatHandler=void 0,t.textColorOnTableCellFormatHandler={parse:function(e,t){t.style.color&&delete e.textColor},apply:function(){}}},1410:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseColor=t.setColor=t.getColor=t.DeprecatedColors=void 0;var o=r(7582),n=r(546);t.DeprecatedColors=["inactiveborder","activeborder","inactivecaptiontext","inactivecaption","activecaption","appworkspace","infobackground","background","buttonhighlight","buttonshadow","captiontext","infotext","menutext","menu","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedfhadow","windowtext","windowframe","window"];var a=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,i=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,l=/^rgb\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,s=/^rgba\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,c=/^\s*var\(\s*(\-\-[a-zA-Z0-9\-_]+)\s*(?:,\s*(.*))?\)\s*$/,d="var(";function u(e){var t;return(t=(e=(e||"").trim()).match(a))?[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]:(t=e.match(i))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:(t=e.match(l)||e.match(s))?[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]:null}t.getColor=function(e,r,o,a){var i=(r?e.style.backgroundColor:e.style.color)||e.getAttribute(r?"bgcolor":"color")||void 0;if(i&&t.DeprecatedColors.indexOf(i)>-1)i=r?void 0:"rgb(0, 0, 0)";else if(a&&i){var l=i.startsWith(d)?c.exec(i):null;l?i=l[2]||"":o&&(i=function(e,t){var r=u(e);if(r&&t){var o=(0,n.getObjectKeys)(t).find((function(e){var o=u(t[e].darkModeColor);return o&&o[0]==r[0]&&o[1]==r[1]&&o[2]==r[2]}));if(o)return t[o].lightModeColor}return null}(i,a.knownColors)||"")}return i},t.setColor=function(e,t,r,n,a){var i,l,s=t&&t.startsWith(d)?c.exec(t):null,u=(0,o.__read)(null!=s?s:[],3),f=(u[0],u[1]),p=u[2];if(t=null!=p?p:t,a&&t){var m=f||"--darkColor_"+t.replace(/[^\d\w]/g,"_"),v=(null===(l=null===(i=a.knownColors)||void 0===i?void 0:i[m])||void 0===l?void 0:l.darkModeColor)||a.getDarkColor(t,void 0,r?"background":"text",e);a.updateKnownColor(n,m,{lightModeColor:t,darkModeColor:v}),t=n?""+d+m+", "+t+")":t}e.removeAttribute(r?"bgcolor":"color"),e.style.setProperty(r?"background-color":"color",t||null)},t.parseColor=u},73:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calcAlign=t.ResultMap=void 0,t.ResultMap={start:{ltr:"left",rtl:"right"},center:{ltr:"center",rtl:"center"},end:{ltr:"right",rtl:"left"},initial:{ltr:"initial",rtl:"initial"},justify:{ltr:"justify",rtl:"justify"}},t.calcAlign=function(e,t){switch(e){case"center":return"center";case"left":return"rtl"==t?"end":"start";case"right":return"rtl"==t?"start":"end";case"start":case"end":case"justify":case"initial":return e;default:return}}},4406:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseValueWithUnit=void 0;var o=r(7582),n=/(-?\d+(\.\d+)?)([a-z]+|%)/;function a(e){var t,r;if(void 0===e)return 0;if("number"==typeof e)return e;var o=null!==(r=null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e).fontSize)&&void 0!==r?r:"";return i(parseFloat(o))}function i(e){return Math.round(4e3*e/3)/1e3}t.parseValueWithUnit=function(e,t,r){void 0===e&&(e=""),void 0===r&&(r="px");var l,s=n.exec(e),c=0;if(s){var d=(0,o.__read)(s,4),u=(d[0],d[1]),f=(d[2],d[3]),p=parseFloat(u);switch(f){case"px":c=p;break;case"pt":c=i(p);break;case"em":c=a(t)*p;break;case"ex":c=a(t)*p/2;break;case"%":c=a(t)*p/100;break;case"in":c=96*p;break;case"rem":c=(a(t)||16)*p}}return c>0&&"pt"==r&&(l=c,c=Math.round(3e3*l/4)/1e3),c}},539:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shouldSetValue=void 0,t.shouldSetValue=function(e,t,r,o){return!!e&&"inherit"!=e&&!!(e!=t||r||o&&e!=o)}},8871:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addCode=t.addBlock=t.createEmptyModel=t.createListLevel=t.createDivider=t.createEntity=t.createGeneralBlock=t.createGeneralSegment=t.createParagraphDecorator=t.createContentModelDocument=t.createImage=t.createText=t.createTableCell=t.createTable=t.createSelectionMarker=t.createParagraph=t.createFormatContainer=t.createListItem=t.createBr=t.normalizeRect=t.isWhiteSpacePreserved=t.reuseCachedElement=t.isEntityDelimiter=t.addDelimiters=t.generateEntityClassNames=t.parseEntityFormat=t.getAllEntityWrappers=t.findClosestEntityWrapper=t.isEntityElement=t.wrap=t.wrapAllChildNodes=t.moveChildNodes=t.toArray=t.getObjectKeys=t.isElementOfType=t.isNodeOfType=t.hasMetadata=t.updateMetadata=t.isBlockElement=t.areSameFormats=t.parseFormat=t.getRegularSelectionOffsets=t.tableProcessor=t.entityProcessor=t.processChildNode=t.handleRegularSelection=t.childProcessor=t.contentModelToText=t.contentModelToDom=t.domToContentModel=void 0,t.createModelToDomConfig=t.createModelToDomContextWithConfig=t.createModelToDomContext=t.createDomToModelConfig=t.createDomToModelContextWithConfig=t.createDomToModelContext=t.parseColor=t.setColor=t.getColor=t.DeprecatedColors=t.BorderKeys=t.parseValueWithUnit=t.setParagraphNotImplicit=t.normalizeSingleSegment=t.isEmpty=t.addSegment=t.unwrapBlock=t.isGeneralSegment=t.normalizeContentModel=t.normalizeParagraph=t.addLink=void 0;var o=r(6373);Object.defineProperty(t,"domToContentModel",{enumerable:!0,get:function(){return o.domToContentModel}});var n=r(7802);Object.defineProperty(t,"contentModelToDom",{enumerable:!0,get:function(){return n.contentModelToDom}});var a=r(3348);Object.defineProperty(t,"contentModelToText",{enumerable:!0,get:function(){return a.contentModelToText}});var i=r(1438);Object.defineProperty(t,"childProcessor",{enumerable:!0,get:function(){return i.childProcessor}}),Object.defineProperty(t,"handleRegularSelection",{enumerable:!0,get:function(){return i.handleRegularSelection}}),Object.defineProperty(t,"processChildNode",{enumerable:!0,get:function(){return i.processChildNode}});var l=r(1447);Object.defineProperty(t,"entityProcessor",{enumerable:!0,get:function(){return l.entityProcessor}});var s=r(793);Object.defineProperty(t,"tableProcessor",{enumerable:!0,get:function(){return s.tableProcessor}});var c=r(4714);Object.defineProperty(t,"getRegularSelectionOffsets",{enumerable:!0,get:function(){return c.getRegularSelectionOffsets}});var d=r(2487);Object.defineProperty(t,"parseFormat",{enumerable:!0,get:function(){return d.parseFormat}});var u=r(7866);Object.defineProperty(t,"areSameFormats",{enumerable:!0,get:function(){return u.areSameFormats}});var f=r(9630);Object.defineProperty(t,"isBlockElement",{enumerable:!0,get:function(){return f.isBlockElement}});var p=r(4231);Object.defineProperty(t,"updateMetadata",{enumerable:!0,get:function(){return p.updateMetadata}}),Object.defineProperty(t,"hasMetadata",{enumerable:!0,get:function(){return p.hasMetadata}});var m=r(8882);Object.defineProperty(t,"isNodeOfType",{enumerable:!0,get:function(){return m.isNodeOfType}});var v=r(6714);Object.defineProperty(t,"isElementOfType",{enumerable:!0,get:function(){return v.isElementOfType}});var g=r(546);Object.defineProperty(t,"getObjectKeys",{enumerable:!0,get:function(){return g.getObjectKeys}});var h=r(7834);Object.defineProperty(t,"toArray",{enumerable:!0,get:function(){return h.toArray}});var b=r(973);Object.defineProperty(t,"moveChildNodes",{enumerable:!0,get:function(){return b.moveChildNodes}}),Object.defineProperty(t,"wrapAllChildNodes",{enumerable:!0,get:function(){return b.wrapAllChildNodes}});var y=r(3168);Object.defineProperty(t,"wrap",{enumerable:!0,get:function(){return y.wrap}});var S=r(3566);Object.defineProperty(t,"isEntityElement",{enumerable:!0,get:function(){return S.isEntityElement}}),Object.defineProperty(t,"findClosestEntityWrapper",{enumerable:!0,get:function(){return S.findClosestEntityWrapper}}),Object.defineProperty(t,"getAllEntityWrappers",{enumerable:!0,get:function(){return S.getAllEntityWrappers}}),Object.defineProperty(t,"parseEntityFormat",{enumerable:!0,get:function(){return S.parseEntityFormat}}),Object.defineProperty(t,"generateEntityClassNames",{enumerable:!0,get:function(){return S.generateEntityClassNames}}),Object.defineProperty(t,"addDelimiters",{enumerable:!0,get:function(){return S.addDelimiters}}),Object.defineProperty(t,"isEntityDelimiter",{enumerable:!0,get:function(){return S.isEntityDelimiter}});var C=r(5345);Object.defineProperty(t,"reuseCachedElement",{enumerable:!0,get:function(){return C.reuseCachedElement}});var _=r(7509);Object.defineProperty(t,"isWhiteSpacePreserved",{enumerable:!0,get:function(){return _.isWhiteSpacePreserved}});var T=r(5077);Object.defineProperty(t,"normalizeRect",{enumerable:!0,get:function(){return T.normalizeRect}});var E=r(5713);Object.defineProperty(t,"createBr",{enumerable:!0,get:function(){return E.createBr}});var k=r(5297);Object.defineProperty(t,"createListItem",{enumerable:!0,get:function(){return k.createListItem}});var M=r(1096);Object.defineProperty(t,"createFormatContainer",{enumerable:!0,get:function(){return M.createFormatContainer}});var P=r(673);Object.defineProperty(t,"createParagraph",{enumerable:!0,get:function(){return P.createParagraph}});var O=r(9804);Object.defineProperty(t,"createSelectionMarker",{enumerable:!0,get:function(){return O.createSelectionMarker}});var w=r(711);Object.defineProperty(t,"createTable",{enumerable:!0,get:function(){return w.createTable}});var x=r(804);Object.defineProperty(t,"createTableCell",{enumerable:!0,get:function(){return x.createTableCell}});var F=r(2362);Object.defineProperty(t,"createText",{enumerable:!0,get:function(){return F.createText}});var D=r(1143);Object.defineProperty(t,"createImage",{enumerable:!0,get:function(){return D.createImage}});var L=r(2178);Object.defineProperty(t,"createContentModelDocument",{enumerable:!0,get:function(){return L.createContentModelDocument}});var j=r(4002);Object.defineProperty(t,"createParagraphDecorator",{enumerable:!0,get:function(){return j.createParagraphDecorator}});var N=r(8465);Object.defineProperty(t,"createGeneralSegment",{enumerable:!0,get:function(){return N.createGeneralSegment}});var I=r(513);Object.defineProperty(t,"createGeneralBlock",{enumerable:!0,get:function(){return I.createGeneralBlock}});var R=r(7974);Object.defineProperty(t,"createEntity",{enumerable:!0,get:function(){return R.createEntity}});var A=r(9002);Object.defineProperty(t,"createDivider",{enumerable:!0,get:function(){return A.createDivider}});var B=r(6549);Object.defineProperty(t,"createListLevel",{enumerable:!0,get:function(){return B.createListLevel}});var H=r(1434);Object.defineProperty(t,"createEmptyModel",{enumerable:!0,get:function(){return H.createEmptyModel}});var z=r(6954);Object.defineProperty(t,"addBlock",{enumerable:!0,get:function(){return z.addBlock}});var W=r(6630);Object.defineProperty(t,"addCode",{enumerable:!0,get:function(){return W.addCode}});var G=r(6630);Object.defineProperty(t,"addLink",{enumerable:!0,get:function(){return G.addLink}});var U=r(7589);Object.defineProperty(t,"normalizeParagraph",{enumerable:!0,get:function(){return U.normalizeParagraph}});var K=r(4527);Object.defineProperty(t,"normalizeContentModel",{enumerable:!0,get:function(){return K.normalizeContentModel}});var V=r(3379);Object.defineProperty(t,"isGeneralSegment",{enumerable:!0,get:function(){return V.isGeneralSegment}});var q=r(1123);Object.defineProperty(t,"unwrapBlock",{enumerable:!0,get:function(){return q.unwrapBlock}});var X=r(8613);Object.defineProperty(t,"addSegment",{enumerable:!0,get:function(){return X.addSegment}});var $=r(9929);Object.defineProperty(t,"isEmpty",{enumerable:!0,get:function(){return $.isEmpty}});var Y=r(2025);Object.defineProperty(t,"normalizeSingleSegment",{enumerable:!0,get:function(){return Y.normalizeSingleSegment}});var Z=r(1966);Object.defineProperty(t,"setParagraphNotImplicit",{enumerable:!0,get:function(){return Z.setParagraphNotImplicit}});var Q=r(4406);Object.defineProperty(t,"parseValueWithUnit",{enumerable:!0,get:function(){return Q.parseValueWithUnit}});var J=r(5493);Object.defineProperty(t,"BorderKeys",{enumerable:!0,get:function(){return J.BorderKeys}});var ee=r(1410);Object.defineProperty(t,"DeprecatedColors",{enumerable:!0,get:function(){return ee.DeprecatedColors}}),Object.defineProperty(t,"getColor",{enumerable:!0,get:function(){return ee.getColor}}),Object.defineProperty(t,"setColor",{enumerable:!0,get:function(){return ee.setColor}}),Object.defineProperty(t,"parseColor",{enumerable:!0,get:function(){return ee.parseColor}});var te=r(5953);Object.defineProperty(t,"createDomToModelContext",{enumerable:!0,get:function(){return te.createDomToModelContext}}),Object.defineProperty(t,"createDomToModelContextWithConfig",{enumerable:!0,get:function(){return te.createDomToModelContextWithConfig}}),Object.defineProperty(t,"createDomToModelConfig",{enumerable:!0,get:function(){return te.createDomToModelConfig}});var re=r(4051);Object.defineProperty(t,"createModelToDomContext",{enumerable:!0,get:function(){return re.createModelToDomContext}}),Object.defineProperty(t,"createModelToDomContextWithConfig",{enumerable:!0,get:function(){return re.createModelToDomContextWithConfig}}),Object.defineProperty(t,"createModelToDomConfig",{enumerable:!0,get:function(){return re.createModelToDomConfig}})},1966:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setParagraphNotImplicit=void 0,t.setParagraphNotImplicit=function(e){"Paragraph"==e.blockType&&e.isImplicit&&(e.isImplicit=!1)}},6954:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addBlock=void 0,t.addBlock=function(e,t){e.blocks.push(t)}},6630:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDecorators=t.addCode=t.addLink=void 0;var o=r(7582);function n(e,t){t.format.href&&(e.link={format:(0,o.__assign)({},t.format),dataset:(0,o.__assign)({},t.dataset)})}function a(e,t){t.format.fontFamily&&(e.code={format:(0,o.__assign)({},t.format)})}t.addLink=n,t.addCode=a,t.addDecorators=function(e,t){n(e,t.link),a(e,t.code)}},8613:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSegment=void 0;var o=r(2452);t.addSegment=function(e,t,r,n){var a=(0,o.ensureParagraph)(e,r,n),i=a.segments[a.segments.length-1];return(null==r?void 0:r.textIndent)&&(r.isTextIndentApplied&&0==a.segments.length?delete a.format.textIndent:r.isTextIndentApplied=!0,delete a.format.isTextIndentApplied),"SelectionMarker"==t.segmentType?i&&i.isSelected||a.segments.push(t):(t.isSelected&&"SelectionMarker"==(null==i?void 0:i.segmentType)&&a.segments.pop(),a.segments.push(t)),a}},2452:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ensureParagraph=void 0;var o=r(6954),n=r(673);t.ensureParagraph=function(e,t,r){var a=e.blocks[e.blocks.length-1];if("Paragraph"==(null==a?void 0:a.blockType))return a;var i=(0,n.createParagraph)(!0,t,r);return(0,o.addBlock)(e,i),i}},75:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasSpacesOnly=void 0;var r=/^[\r\n\t ]*$/;t.hasSpacesOnly=function(e){return r.test(e)}},9929:(e,t)=>{function r(e){switch(e.blockType){case"Paragraph":return 0==e.segments.length;case"Table":return e.rows.every((function(e){return 0==e.cells.length}));case"BlockGroup":return o(e);default:return!1}}function o(e){switch(e.blockGroupType){case"FormatContainer":return"div"!=e.tagName&&e.blocks.every(r);case"ListItem":return e.blocks.every(r);case"Document":case"General":case"TableCell":return!1;default:return!0}}function n(e){switch(e.segmentType){case"Text":return!e.text;case"Image":return!e.src;default:return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmpty=t.isSegmentEmpty=t.isBlockGroupEmpty=t.isBlockEmpty=void 0,t.isBlockEmpty=r,t.isBlockGroupEmpty=o,t.isSegmentEmpty=n,t.isEmpty=function(e){return function(e){return"string"==typeof e.blockGroupType}(e)?o(e):function(e){return"string"==typeof e.blockType}(e)?r(e):!!function(e){return"string"==typeof e.segmentType}(e)&&n(e)}},3379:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isGeneralSegment=void 0,t.isGeneralSegment=function(e){return"General"==e.blockGroupType&&"General"==e.segmentType}},4527:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeContentModel=void 0;var o=r(9929),n=r(7589),a=r(1123);t.normalizeContentModel=function e(t){for(var r=t.blocks.length-1;r>=0;r--){var i=t.blocks[r];switch(i.blockType){case"BlockGroup":"ListItem"==i.blockGroupType&&0==i.levels.length?(r+=i.blocks.length,(0,a.unwrapBlock)(t,i)):e(i);break;case"Paragraph":(0,n.normalizeParagraph)(i);break;case"Table":for(var l=0;l<i.rows.length;l++)for(var s=0;s<i.rows[l].cells.length;s++)i.rows[l].cells[s]&&e(i.rows[l].cells[s])}(0,o.isBlockEmpty)(i)&&t.blocks.splice(r,1)}}},7589:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeParagraph=void 0;var o=r(7866),n=r(5713),a=r(9929),i=r(7509),l=r(2025);t.normalizeParagraph=function(e){var t=e.segments;if(!e.isImplicit&&t.length>0){var r=t[t.length-1],c=t[t.length-2];if("SelectionMarker"!=r.segmentType||c&&"Br"!=c.segmentType){if(t.length>1&&"Br"==t[t.length-1].segmentType){var d=t.filter((function(e){return"SelectionMarker"!=e.segmentType}));d.length>1&&"Br"!=d[d.length-2].segmentType&&t.pop()}}else t.push((0,n.createBr)(r.format))}(0,i.isWhiteSpacePreserved)(e.format.whiteSpace)||(0,l.normalizeAllSegments)(e),function(e){var t=e.segments.find((function(e){return"SelectionMarker"==e.segmentType}));if(t){var r=e.segments.indexOf(t),n=e.segments[r-1],a=e.segments[r+1];(n&&!n.link&&(0,o.areSameFormats)(n.format,t.format)&&(!a||!a.link&&(0,o.areSameFormats)(a.format,t.format))&&t.link||!n&&t.link&&a&&!a.link&&(0,o.areSameFormats)(a.format,t.format))&&delete t.link}}(e),function(e){for(var t=e.segments.length-1;t>=0;t--)(0,a.isSegmentEmpty)(e.segments[t])&&e.segments.splice(t,1)}(e),function(e){if(!e.decorator){var t=e.segments.filter((function(e){return"SelectionMarker"!=e.segmentType})),r=e.segmentFormat||{},o=!1;s.forEach((function(e){o=function(e,t,r){var o,n=null===(o=e[0])||void 0===o?void 0:o.format;return!(!(null==n?void 0:n[r])||!e.every((function(e){return e.format[r]==n[r]}))||(t[r]=n[r],0))}(t,r,e)||o})),o&&(e.segmentFormat=r)}}(e)};var s=["fontFamily","fontSize","textColor"]},2025:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeSegment=t.createNormalizeSegmentContext=t.normalizeSingleSegment=t.normalizeAllSegments=void 0;var o=r(75),n=" ",a="",i=/^\u0020+/,l=/\u0020+$/;function s(e){return Object.assign(null!=e?e:{},{textSegments:[],ignoreLeadingSpaces:!0,ignoreTrailingSpaces:!0,lastInlineSegment:void 0,lastTextSegment:void 0})}function c(e,t){switch(e.segmentType){case"Br":d(t.textSegments,t.lastInlineSegment),u(t.lastTextSegment,t.lastInlineSegment),s(t);break;case"Entity":case"General":case"Image":t.lastInlineSegment=e,t.ignoreLeadingSpaces=!1;break;case"Text":t.textSegments.push(e),t.lastInlineSegment=e,t.lastTextSegment=e;var r=e.text.substring(0,1),c=e.text.substr(-1);(0,o.hasSpacesOnly)(e.text)||(r==n&&(e.text=e.text.replace(i,t.ignoreLeadingSpaces?"":a)),c==n&&(e.text=e.text.replace(l,t.ignoreTrailingSpaces?n:a))),t.ignoreLeadingSpaces=c==n}}function d(e,t){e.forEach((function(e){if(e!=t){var r=e.text;r.substr(-1)==a&&r.length>1&&r.substr(-2,1)!=n&&(e.text=r.substring(0,r.length-1)+n)}}))}function u(e,t){e&&e==t&&(null==e?void 0:e.text.substr(-1))==n&&(e.text=e.text.replace(l,""))}t.normalizeAllSegments=function(e){var t=s();e.segments.forEach((function(e){c(e,t)})),d(t.textSegments,t.lastInlineSegment),u(t.lastTextSegment,t.lastInlineSegment)},t.normalizeSingleSegment=function(e,t){void 0===t&&(t=!1);var r=s();r.ignoreTrailingSpaces=t,c(e,r)},t.createNormalizeSegmentContext=function(){return s()},t.normalizeSegment=c},1123:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unwrapBlock=void 0;var o=r(7582),n=r(1966);t.unwrapBlock=function(e,t){var r,a,i=null!==(a=null==e?void 0:e.blocks.indexOf(t))&&void 0!==a?a:-1;i>=0&&(t.blocks.forEach(n.setParagraphNotImplicit),null==e||(r=e.blocks).splice.apply(r,(0,o.__spreadArray)([i,1],(0,o.__read)(t.blocks),!1)))}},5713:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createBr=void 0;var o=r(7582);t.createBr=function(e){return{segmentType:"Br",format:e?(0,o.__assign)({},e):{}}}},2178:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelDocument=void 0,t.createContentModelDocument=function(e){var t={blockGroupType:"Document",blocks:[]};return e&&(t.format=e),t}},9002:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDivider=void 0;var o=r(7582);t.createDivider=function(e,t){return{blockType:"Divider",tagName:e,format:t?(0,o.__assign)({},t):{}}}},1434:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEmptyModel=void 0;var o=r(5713),n=r(2178),a=r(673),i=r(9804);t.createEmptyModel=function(e){var t=(0,n.createContentModelDocument)(e),r=(0,a.createParagraph)(!1,void 0,e);return r.segments.push((0,i.createSelectionMarker)(e),(0,o.createBr)(e)),t.blocks.push(r),t}},7974:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEntity=void 0;var o=r(7582);t.createEntity=function(e,t,r,n,a){return void 0===t&&(t=!0),{segmentType:"Entity",blockType:"Entity",format:(0,o.__assign)({},r),entityFormat:{id:a,entityType:n,isReadonly:t},wrapper:e}}},1096:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createFormatContainer=void 0;var o=r(7582);t.createFormatContainer=function(e,t){return{blockType:"BlockGroup",blockGroupType:"FormatContainer",tagName:e,blocks:[],format:(0,o.__assign)({},t||{})}}},513:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneralBlock=void 0,t.createGeneralBlock=function(e){return{blockType:"BlockGroup",blockGroupType:"General",element:e,blocks:[],format:{}}}},8465:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneralSegment=void 0;var o=r(7582);t.createGeneralSegment=function(e,t){return{blockType:"BlockGroup",blockGroupType:"General",segmentType:"General",format:t?(0,o.__assign)({},t):{},blocks:[],element:e}}},1143:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createImage=void 0;var o=r(7582);t.createImage=function(e,t){return{segmentType:"Image",src:e,format:t?(0,o.__assign)({},t):{},dataset:{}}}},5297:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createListItem=void 0;var o=r(6549),n=r(9804);t.createListItem=function(e,t){return{blockType:"BlockGroup",blockGroupType:"ListItem",blocks:[],levels:e?e.map((function(e){return(0,o.createListLevel)(e.listType,e.format,e.dataset)})):[],formatHolder:(0,n.createSelectionMarker)(t),format:{}}}},6549:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createListLevel=void 0;var o=r(7582);t.createListLevel=function(e,t,r){return{listType:e,format:(0,o.__assign)({},t),dataset:(0,o.__assign)({},r)}}},673:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createParagraph=void 0;var o=r(7582);t.createParagraph=function(e,t,r,n){var a={blockType:"Paragraph",segments:[],format:t?(0,o.__assign)({},t):{}};return r&&Object.keys(r).length>0&&(a.segmentFormat=(0,o.__assign)({},r)),e&&(a.isImplicit=!0),n&&(a.decorator={tagName:n.tagName,format:(0,o.__assign)({},n.format)}),a}},4002:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createParagraphDecorator=void 0;var o=r(7582);t.createParagraphDecorator=function(e,t){return{tagName:e.toLocaleLowerCase(),format:(0,o.__assign)({},t||{})}}},9804:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionMarker=void 0;var o=r(7582);t.createSelectionMarker=function(e){return{segmentType:"SelectionMarker",isSelected:!0,format:e?(0,o.__assign)({},e):{}}}},711:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTable=void 0;var o=r(7582);t.createTable=function(e,t){for(var r=[],n=0;n<e;n++)r.push({height:0,format:{},cells:[]});return{blockType:"Table",rows:r,format:(0,o.__assign)({},t||{}),widths:[],dataset:{}}}},804:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTableCell=void 0;var o=r(7582);t.createTableCell=function(e,t,r,n,a){var i="number"==typeof e?e>1:!!e,l="number"==typeof t?t>1:!!t;return{blockGroupType:"TableCell",blocks:[],format:n?(0,o.__assign)({},n):{},spanLeft:i,spanAbove:l,isHeader:!!r,dataset:(0,o.__assign)({},a)}}},2362:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createText=void 0;var o=r(7582),n=r(6630);t.createText=function(e,t,r,a){var i={segmentType:"Text",text:e,format:t?(0,o.__assign)({},t):{}};return r&&(0,n.addLink)(i,r),a&&(0,n.addCode)(i,a),i}},7802:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contentModelToDom=void 0;var o=r(8882),n=r(7834);function a(e){var t,r,a,i;if(e.block&&(e.segment?(0,o.isNodeOfType)(e.segment,"TEXT_NODE")?i={container:e.segment,offset:(null===(t=e.segment.nodeValue)||void 0===t?void 0:t.length)||0}:e.segment.parentNode&&(i={container:e.segment.parentNode,offset:(0,n.toArray)(e.segment.parentNode.childNodes).indexOf(e.segment)+1}):i={container:e.block,offset:0}),i&&(0,o.isNodeOfType)(i.container,"DOCUMENT_FRAGMENT_NODE")){var l=i.container.childNodes;if(l.length>i.offset)i={container:l[i.offset],offset:0};else if(i.container.lastChild){var s=i.container.lastChild;i={container:s,offset:(0,o.isNodeOfType)(s,"TEXT_NODE")?null!==(a=null===(r=s.nodeValue)||void 0===r?void 0:r.length)&&void 0!==a?a:0:s.childNodes.length}}else i=void 0}return i}t.contentModelToDom=function(e,t,r,o){o.modelHandlers.blockGroupChildren(e,t,r,o);var n=function(e,t){var r,o,n=t.regularSelection,i=n.start,l=n.end,s=t.tableSelection,c=t.imageSelection;if(c)return c;if((r=i&&a(i))&&(o=l&&a(l))){var d=e.createRange();return d.setStart(r.container,r.offset),d.setEnd(o.container,o.offset),{type:"range",range:d,isReverted:!1}}return s||null}(e,o);return t.normalize(),n}},4051:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildFormatAppliers=t.createModelToDomConfig=t.createModelToDomContextWithConfig=t.createModelToDomContext=void 0;var o=r(7582),n=r(8203),a=r(546),i=r(5606);function l(e,t){return Object.assign({},t,{regularSelection:{current:{block:null,segment:null}}},{listFormat:{threadItemCounts:[],nodeStack:[]},implicitFormat:{}},e)}function s(e){return{modelHandlers:Object.assign.apply(Object,(0,o.__spreadArray)([{},n.defaultContentModelHandlers],(0,o.__read)(e.map((function(e){return null==e?void 0:e.modelHandlerOverride}))),!1)),formatAppliers:c(e.map((function(e){return null==e?void 0:e.formatApplierOverride})),e.map((function(e){return null==e?void 0:e.additionalFormatAppliers}))),defaultModelHandlers:n.defaultContentModelHandlers,defaultFormatAppliers:i.defaultFormatAppliers,metadataAppliers:Object.assign.apply(Object,(0,o.__spreadArray)([{}],(0,o.__read)(e.map((function(e){return null==e?void 0:e.metadataAppliers}))),!1))}}function c(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var r=Object.assign.apply(Object,(0,o.__spreadArray)([{}],(0,o.__read)(e),!1)),n=(0,a.getObjectKeys)(i.defaultFormatKeysPerCategory).reduce((function(e,n){var a,l=(a=i.defaultFormatKeysPerCategory[n].map((function(e){return void 0===r[e]?i.defaultFormatAppliers[e]:r[e]}))).concat.apply(a,(0,o.__spreadArray)([],(0,o.__read)(t.map((function(e){var t;return null!==(t=null==e?void 0:e[n])&&void 0!==t?t:[]}))),!1));return e[n]=l,e}),{text:[]});return t.forEach((function(e){(null==e?void 0:e.text)&&(n.text=n.text.concat(e.text))})),n}t.createModelToDomContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l(s(t),e)},t.createModelToDomContextWithConfig=l,t.createModelToDomConfig=s,t.buildFormatAppliers=c},8203:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultContentModelHandlers=void 0;var o=r(5388),n=r(4392),a=r(2799),i=r(3433),l=r(4242),s=r(2058),c=r(8197),d=r(7262),u=r(5288),f=r(3169),p=r(4232),m=r(6850),v=r(3577),g=r(5849),h=r(6809);t.defaultContentModelHandlers={block:o.handleBlock,blockGroupChildren:n.handleBlockGroupChildren,br:a.handleBr,entityBlock:l.handleEntityBlock,entitySegment:l.handleEntitySegment,generalBlock:c.handleGeneralBlock,generalSegment:c.handleGeneralSegment,divider:i.handleDivider,image:d.handleImage,list:u.handleList,listItem:f.handleListItem,paragraph:p.handleParagraph,formatContainer:s.handleFormatContainer,segment:m.handleSegment,segmentDecorator:v.handleSegmentDecorator,table:g.handleTable,text:h.handleText}},5388:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleBlock=void 0,t.handleBlock=function(e,t,r,o,n){var a=o.modelHandlers;switch(r.blockType){case"Table":n=a.table(e,t,r,o,n);break;case"Paragraph":n=a.paragraph(e,t,r,o,n);break;case"Entity":n=a.entityBlock(e,t,r,o,n);break;case"Divider":n=a.divider(e,t,r,o,n);break;case"BlockGroup":switch(r.blockGroupType){case"General":n=a.generalBlock(e,t,r,o,n);break;case"FormatContainer":n=a.formatContainer(e,t,r,o,n);break;case"ListItem":n=a.listItem(e,t,r,o,n)}}return n}},4392:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleBlockGroupChildren=void 0,t.handleBlockGroupChildren=function(e,t,r,o){var n,a=o.listFormat,i=a.nodeStack,l=t.firstChild;try{for(r.blocks.forEach((function(r,n){0!=n&&"BlockGroup"==r.blockType&&"ListItem"==r.blockGroupType||(a.nodeStack=[]),l=o.modelHandlers.block(e,t,r,o,l)}));l;){var s=l.nextSibling;null===(n=l.parentNode)||void 0===n||n.removeChild(l),l=s}}finally{a.nodeStack=i}}},2799:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleBr=void 0;var o=r(3249);t.handleBr=function(e,t,r,n,a){var i=e.createElement("br"),l=e.createElement("span");l.appendChild(i),t.appendChild(l),(0,o.handleSegmentCommon)(e,i,l,r,n,a)}},3433:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleDivider=void 0;var o=r(4043),n=r(5345);t.handleDivider=function(e,t,r,a,i){var l,s=a.allowCacheElement?r.cachedElement:void 0;return s?i=(0,n.reuseCachedElement)(t,s,i):(s=e.createElement(r.tagName),a.allowCacheElement&&(r.cachedElement=s),t.insertBefore(s,i),(0,o.applyFormat)(s,a.formatAppliers.divider,r.format,a),r.size&&s.setAttribute("size",r.size)),null===(l=a.onNodeCreated)||void 0===l||l.call(a,r,s),i}},4242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleEntitySegment=t.handleEntityBlock=void 0;var o=r(7582),n=r(3566),a=r(4043),i=r(546),l=r(5345),s=r(3168),c="_E_EBlockEntityContainer";function d(e){var t;return(0,o.__assign)((0,o.__assign)({},null===(t=e.pendingFormat)||void 0===t?void 0:t.format),e.defaultFormat)}t.handleEntityBlock=function(e,t,r,o,i){var u,f,p=r.entityFormat,m=r.wrapper;(0,a.applyFormat)(m,o.formatAppliers.entity,p,o);var v=o.addDelimiterForEntity&&"inline-block"==m.style.display&&"100%"==m.style.width,g=null===(u=m.parentElement)||void 0===u?void 0:u.classList.contains(c),h=g&&v?m.parentElement:m;return i=(0,l.reuseCachedElement)(t,h,i),v&&(g||(0,s.wrap)(e,m,"div").classList.add(c),(0,n.addDelimiters)(e,m,d(o),o)),null===(f=o.onNodeCreated)||void 0===f||f.call(o,r,m),i},t.handleEntitySegment=function(e,t,r,l,c){var u,f=r.entityFormat,p=r.wrapper,m=r.format;if(t.appendChild(p),null==c||c.push(p),(0,i.getObjectKeys)(m).length>0){var v=(0,s.wrap)(e,p,"span");(0,a.applyFormat)(v,l.formatAppliers.segment,m,l)}if((0,a.applyFormat)(p,l.formatAppliers.entity,f,l),l.addDelimiterForEntity&&f.isReadonly){var g=(0,o.__read)((0,n.addDelimiters)(e,p,d(l),l),2),h=g[0],b=g[1];null==c||c.push(h,b),l.regularSelection.current.segment=h}else l.regularSelection.current.segment=p;null===(u=l.onNodeCreated)||void 0===u||u.call(l,r,p)}},2058:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleFormatContainer=void 0;var o=r(4043),n=r(9929),a=r(5345),i=r(1498),l={fontFamily:"monospace",whiteSpace:"pre"};t.handleFormatContainer=function(e,t,r,s,c){var d,u=s.allowCacheElement?r.cachedElement:void 0;if(u)c=(0,a.reuseCachedElement)(t,u,c),s.modelHandlers.blockGroupChildren(e,u,r,s);else if(!(0,n.isBlockGroupEmpty)(r)){var f=e.createElement(r.tagName);s.allowCacheElement&&(r.cachedElement=f),t.insertBefore(f,c),(0,i.stackFormat)(s,r.tagName,(function(){(0,o.applyFormat)(f,s.formatAppliers.container,r.format,s),(0,o.applyFormat)(f,s.formatAppliers.segmentOnBlock,r.format,s),(0,o.applyFormat)(f,s.formatAppliers.container,r.format,s)})),"pre"==r.tagName?(0,i.stackFormat)(s,l,(function(){s.modelHandlers.blockGroupChildren(e,f,r,s)})):s.modelHandlers.blockGroupChildren(e,f,r,s),u=f}return u&&(null===(d=s.onNodeCreated)||void 0===d||d.call(s,r,u)),c}},8197:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleGeneralSegment=t.handleGeneralBlock=void 0;var o=r(4043),n=r(3249),a=r(8882),i=r(5345),l=r(3168);t.handleGeneralBlock=function(e,t,r,n,a){var l,s=r.element;return a&&s.parentNode==t?a=(0,i.reuseCachedElement)(t,s,a):(s=s.cloneNode(),r.element=s,(0,o.applyFormat)(s,n.formatAppliers.general,r.format,n),t.insertBefore(s,a)),null===(l=n.onNodeCreated)||void 0===l||l.call(n,r,s),n.modelHandlers.blockGroupChildren(e,s,r,n),a},t.handleGeneralSegment=function(e,t,r,i,s){var c,d=r.element.cloneNode();if(r.element=d,t.appendChild(d),(0,a.isNodeOfType)(d,"ELEMENT_NODE")){var u=(0,l.wrap)(e,d,"span");(0,n.handleSegmentCommon)(e,d,u,r,i,s),(0,o.applyFormat)(d,i.formatAppliers.general,r.format,i),null===(c=i.onNodeCreated)||void 0===c||c.call(i,r,d)}i.modelHandlers.blockGroupChildren(e,d,r,i)}},7262:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleImage=void 0;var o=r(4043),n=r(3249),a=r(4406);t.handleImage=function(e,t,r,i,l){var s=e.createElement("img"),c=document.createElement("span");t.appendChild(c),c.appendChild(s),s.src=r.src,r.alt&&(s.alt=r.alt),r.title&&(s.title=r.title),(0,o.applyFormat)(s,i.formatAppliers.image,r.format,i),(0,o.applyFormat)(s,i.formatAppliers.dataset,r.dataset,i);var d=r.format,u=d.width,f=d.height,p=u?(0,a.parseValueWithUnit)(u):0,m=f?(0,a.parseValueWithUnit)(f):0;p>0&&(s.width=p),m>0&&(s.height=m),r.isSelectedAsImageSelection&&(i.imageSelection={type:"image",image:s}),(0,n.handleSegmentCommon)(e,s,c,r,i,l)}},5288:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleList=void 0;var o=r(7582),n=r(4043),a=r(669);t.handleList=function(e,t,r,i,l){var s,c,d=0,u=i.listFormat.nodeStack;for(0==u.length&&u.push({node:t});d<r.levels.length&&d+1<u.length;d++){var f=u[d+1],p=r.levels[d];if(f.listType!=p.listType||(null===(s=f.dataset)||void 0===s?void 0:s.editingInfo)!=p.dataset.editingInfo||"OL"==p.listType&&"number"==typeof p.format.startNumberOverride)break}for(u.splice(d+1);d<r.levels.length;d++){var m=r.levels[d],v=e.createElement(m.listType||"UL");u[u.length-1].node.insertBefore(v,0==d?l:null),u.push((0,o.__assign)({node:v},m)),(0,n.applyFormat)(v,i.formatAppliers.listLevelThread,m.format,i),(0,a.applyMetadata)(m,i.metadataAppliers.listLevel,m.format,i),(0,n.applyFormat)(v,i.formatAppliers.listLevel,m.format,i),(0,n.applyFormat)(v,i.formatAppliers.dataset,m.dataset,i),null===(c=i.onNodeCreated)||void 0===c||c.call(i,m,v)}return l}},3169:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleListItem=void 0;var o=r(4043),n=r(669),a=r(1966),i=r(3242);t.handleListItem=function(e,t,r,l,s){var c,d;s=l.modelHandlers.list(e,t,r,l,s);var u=l.listFormat.nodeStack,f=(null===(c=null==u?void 0:u[(null==u?void 0:u.length)-1])||void 0===c?void 0:c.node)||t,p=e.createElement("li"),m=r.levels[r.levels.length-1];return f.insertBefore(p,(null==s?void 0:s.parentNode)==f?s:null),m?((0,o.applyFormat)(p,l.formatAppliers.segment,r.formatHolder.format,l),(0,o.applyFormat)(p,l.formatAppliers.listItemThread,m.format,l),(0,n.applyMetadata)(m,l.metadataAppliers.listItem,r.format,l),(0,o.applyFormat)(p,l.formatAppliers.listItemElement,r.format,l),l.modelHandlers.blockGroupChildren(e,p,r,l)):(r.blocks.forEach(a.setParagraphNotImplicit),l.modelHandlers.blockGroupChildren(e,p,r,l),(0,i.unwrap)(p)),null===(d=l.onNodeCreated)||void 0===d||d.call(l,r,p),s}},4232:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleParagraph=void 0;var o=r(7582),n=r(4043),a=r(546),i=r(8588),l=r(5345),s=r(1498),c=r(3242);t.handleParagraph=function(e,t,r,d,u){var f,p=d.allowCacheElement?r.cachedElement:void 0;return p?u=(0,l.reuseCachedElement)(t,p,u):(0,s.stackFormat)(d,(null===(f=r.decorator)||void 0===f?void 0:f.tagName)||null,(function(){var l,f,m,v,g=!r.isImplicit||!!r.decorator||(0,a.getObjectKeys)(r.format).length>0&&r.segments.some((function(e){return"SelectionMarker"!=e.segmentType})),h=g?(0,o.__assign)((0,o.__assign)({},(null===(l=r.decorator)||void 0===l?void 0:l.format)||{}),r.segmentFormat):{};p=e.createElement((null===(f=r.decorator)||void 0===f?void 0:f.tagName)||"div"),t.insertBefore(p,u),d.regularSelection.current={block:g?p:p.parentNode,segment:null};var b=function(){var t=p;if(t){var n=r.segments[0];"SelectionMarker"==(null==n?void 0:n.segmentType)&&d.modelHandlers.text(e,t,(0,o.__assign)((0,o.__assign)({},n),{segmentType:"Text",text:""}),d,[]),r.segments.forEach((function(o){var n=[];d.modelHandlers.segment(e,t,o,d,n),n.forEach((function(e){var t;null===(t=d.domIndexer)||void 0===t||t.onSegment(e,r,[o])}))}))}};g?((0,s.stackFormat)(d,h,b),(0,n.applyFormat)(p,d.formatAppliers.block,r.format,d),(0,n.applyFormat)(p,d.formatAppliers.container,r.format,d),(0,n.applyFormat)(p,d.formatAppliers.segmentOnBlock,h,d)):b(),(0,i.optimize)(p),u=p.nextSibling,p&&(null===(m=d.onNodeCreated)||void 0===m||m.call(d,r,p),null===(v=d.domIndexer)||void 0===v||v.onParagraph(p)),g?d.allowCacheElement&&(r.cachedElement=p):((0,c.unwrap)(p),p=void 0)})),u}},6850:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegment=void 0;var o=r(7582);t.handleSegment=function(e,t,r,n,a){var i=n.regularSelection;switch(r.isSelected&&!i.start&&(i.start=(0,o.__assign)({},i.current)),r.segmentType){case"Text":n.modelHandlers.text(e,t,r,n,a);break;case"Br":n.modelHandlers.br(e,t,r,n,a);break;case"Image":n.modelHandlers.image(e,t,r,n,a);break;case"General":n.modelHandlers.generalSegment(e,t,r,n,a);break;case"Entity":n.modelHandlers.entitySegment(e,t,r,n,a)}r.isSelected&&i.start&&(i.end=(0,o.__assign)({},i.current))}},3577:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegmentDecorator=void 0;var o=r(4043),n=r(8882),a=r(1498),i=r(973);t.handleSegmentDecorator=function(e,t,r,l,s){var c=r.code,d=r.link;(0,n.isNodeOfType)(t,"ELEMENT_NODE")&&(d&&(0,a.stackFormat)(l,"a",(function(){var e,r=(0,i.wrapAllChildNodes)(t,"a");(0,o.applyFormat)(r,l.formatAppliers.link,d.format,l),(0,o.applyFormat)(r,l.formatAppliers.dataset,d.dataset,l),null==s||s.push(r),null===(e=l.onNodeCreated)||void 0===e||e.call(l,d,r)})),c&&(0,a.stackFormat)(l,"code",(function(){var e,r=(0,i.wrapAllChildNodes)(t,"code");(0,o.applyFormat)(r,l.formatAppliers.code,c.format,l),null==s||s.push(r),null===(e=l.onNodeCreated)||void 0===e||e.call(l,c,r)})))}},5849:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleTable=void 0;var o=r(4043),n=r(4231),a=r(9929),i=r(973),l=r(5345);t.handleTable=function(e,t,r,s,c){var d,u,f,p,m,v,g;if((0,a.isBlockEmpty)(r))return c;var h=s.allowCacheElement?r.cachedElement:void 0;h?(c=(0,l.reuseCachedElement)(t,h,c),(0,i.moveChildNodes)(h)):(h=e.createElement("table"),s.allowCacheElement&&(r.cachedElement=h),t.insertBefore(h,c),(0,o.applyFormat)(h,s.formatAppliers.block,r.format,s),(0,o.applyFormat)(h,s.formatAppliers.table,r.format,s),(0,o.applyFormat)(h,s.formatAppliers.tableBorder,r.format,s),(0,o.applyFormat)(h,s.formatAppliers.dataset,r.dataset,s)),null===(d=s.onNodeCreated)||void 0===d||d.call(s,r,h);var b=e.createElement("tbody");h.appendChild(b);for(var y=0;y<r.rows.length;y++){var S=r.rows[y];if(0!=S.cells.length){var C=s.allowCacheElement&&S.cachedElement||e.createElement("tr");b.appendChild(C),(0,i.moveChildNodes)(C),S.cachedElement||(s.allowCacheElement&&(S.cachedElement=C),(0,o.applyFormat)(C,s.formatAppliers.tableRow,S.format,s)),null===(u=s.onNodeCreated)||void 0===u||u.call(s,S,C);for(var _=0;_<S.cells.length;_++){var T=S.cells[_];if(T.isSelected){var E=s.tableSelection||{type:"table",table:h,firstColumn:_,lastColumn:_,firstRow:y,lastRow:y};E.table==h&&(E.lastColumn=Math.max(E.lastColumn,_),E.lastRow=Math.max(E.lastRow,y)),s.tableSelection=E}if(!T.spanAbove&&!T.spanLeft){var k=s.allowCacheElement&&T.cachedElement||e.createElement(T.isHeader?"th":"td");C.appendChild(k);for(var M=1,P=1,O=r.widths[_],w=S.height;null===(p=null===(f=r.rows[y+M])||void 0===f?void 0:f.cells[_])||void 0===p?void 0:p.spanAbove;M++)w+=r.rows[y+M].height;for(;null===(m=S.cells[_+P])||void 0===m?void 0:m.spanLeft;P++)O+=r.widths[_+P];M>1&&(k.rowSpan=M),P>1&&(k.colSpan=P),(!T.cachedElement||T.format.useBorderBox&&(0,n.hasMetadata)(r))&&(O>0&&!k.style.width&&(k.style.width=O+"px"),w>0&&!k.style.height&&(k.style.height=w+"px")),T.cachedElement||(s.allowCacheElement&&(T.cachedElement=k),(0,o.applyFormat)(k,s.formatAppliers.block,T.format,s),(0,o.applyFormat)(k,s.formatAppliers.tableCell,T.format,s),(0,o.applyFormat)(k,s.formatAppliers.tableCellBorder,T.format,s),(0,o.applyFormat)(k,s.formatAppliers.dataset,T.dataset,s)),s.modelHandlers.blockGroupChildren(e,k,T,s),null===(v=s.onNodeCreated)||void 0===v||v.call(s,T,k)}}}}return null===(g=s.domIndexer)||void 0===g||g.onTable(h,r),c}},6809:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleText=void 0;var o=r(3249);t.handleText=function(e,t,r,n,a){var i=e.createTextNode(r.text),l=e.createElement("span");t.appendChild(l),l.appendChild(i),n.formatAppliers.text.forEach((function(e){return e(r.format,i,n)})),(0,o.handleSegmentCommon)(e,i,l,r,n,a)}},972:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeNode=void 0;var o=r(8882),n=["SPAN","B","EM","I","U","SUB","SUP","STRIKE","S","A","CODE"];function a(e,t){var r=e.attributes,o=t.attributes;if(r.length!=o.length)return!1;for(var n=0;n<r.length;n++)if(r[n].name!=o[n].name||r[n].value!=o[n].value)return!1;return!0}t.mergeNode=function(e){for(var t=e.firstChild;t;){var r=t.nextSibling;if(r&&(0,o.isNodeOfType)(t,"ELEMENT_NODE")&&(0,o.isNodeOfType)(r,"ELEMENT_NODE")&&t.tagName==r.tagName&&n.indexOf(t.tagName)>=0&&a(t,r)){for(;r.firstChild;)t.appendChild(r.firstChild);r.parentNode.removeChild(r)}else t=r}}},8588:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.optimize=void 0;var o=r(3566),n=r(972),a=r(6507);t.optimize=function e(t){if(!(0,o.isEntityElement)(t)){(0,a.removeUnnecessarySpan)(t),(0,n.mergeNode)(t);for(var r=t.firstChild;r;r=r.nextSibling)e(r)}}},6507:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeUnnecessarySpan=void 0;var o=r(8882);t.removeUnnecessarySpan=function(e){for(var t=e.firstChild;t;)if((0,o.isNodeOfType)(t,"ELEMENT_NODE")&&"SPAN"==t.tagName&&0==t.attributes.length){var r=t,n=t.nextSibling;for(t=t.nextSibling;r.lastChild;){var a=r.lastChild;e.insertBefore(a,n),n=a}e.removeChild(r)}else t=t.nextSibling}},4043:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyFormat=void 0,t.applyFormat=function(e,t,r,o){t.forEach((function(t){null==t||t(r,e,o)}))}},669:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyMetadata=void 0;var o=r(4231);t.applyMetadata=function(e,t,r,n){t&&(0,o.updateMetadata)(e,(function(e){return t.applierFunction(e,r,n),e}),t.metadataDefinition)}},3249:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegmentCommon=void 0;var o=r(4043);t.handleSegmentCommon=function(e,t,r,n,a,i){var l;t.firstChild||(a.regularSelection.current.segment=t),(0,o.applyFormat)(r,a.formatAppliers.styleBasedSegment,n.format,a),null==i||i.push(t),a.modelHandlers.segmentDecorator(e,r,n,a,i),(0,o.applyFormat)(r,a.formatAppliers.elementBasedSegment,n.format,a),null===(l=a.onNodeCreated)||void 0===l||l.call(a,n,t)}},1498:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stackFormat=void 0;var o=r(7582),n=r(1105);t.stackFormat=function(e,t,r){var a="string"==typeof t?n.defaultContentModelFormatMap[t]:t;if(a){var i=e.implicitFormat;try{e.implicitFormat=(0,o.__assign)((0,o.__assign)({},i),a),r()}finally{e.implicitFormat=i}}else r()}},3348:(e,t)=>{function r(e,t){e.blocks.forEach((function(e){switch(e.blockType){case"Paragraph":var o="";e.segments.forEach((function(e){switch(e.segmentType){case"Br":t.push(o),o="";break;case"Entity":o+=e.wrapper.textContent||"";break;case"General":o+=e.element.textContent||"";break;case"Text":o+=e.text;break;case"Image":o+=" "}})),t.push(o);break;case"Divider":case"Entity":t.push("");break;case"Table":e.rows.forEach((function(e){return e.cells.forEach((function(e){r(e,t)}))}));break;case"BlockGroup":r(e,t)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.contentModelToText=void 0,t.contentModelToText=function(e,t){void 0===t&&(t="\r\n");var o=[];return r(e,o),o.join(t)}},6582:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AutoFormatPlugin=void 0;var o=r(4744),n=r(8316),a=r(918),i=r(4422),l={autoBullet:!0,autoNumbering:!0,autoUnlink:!1,autoLink:!0},s=function(){function e(e){void 0===e&&(e=l),this.options=e,this.editor=null}return e.prototype.getName=function(){return"AutoFormat"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"keyDown":this.handleKeyDownEvent(this.editor,e);break;case"contentChanged":this.handleContentChangedEvent(this.editor,e)}},e.prototype.handleKeyDownEvent=function(e,t){var r=t.rawEvent;if(!r.defaultPrevented&&!t.handledByEditFeature){var o=this.options,l=o.autoBullet,s=o.autoNumbering,c=o.autoUnlink,d=o.autoLink;switch(r.key){case" ":(0,a.keyboardListTrigger)(e,r,l,s),d&&(0,n.createLinkAfterSpace)(e);break;case"Backspace":c&&(0,i.unlink)(e,r)}}},e.prototype.handleContentChangedEvent=function(e,t){var r=this.options.autoLink;"Paste"==t.source&&r&&(0,o.createLink)(e)},e}();t.AutoFormatPlugin=s},4744:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLink=void 0;var o=r(8871),n=r(3272);t.createLink=function(e){e.formatContentModel((function(e){var t=(0,n.getLinkSegment)(e);return!(!t||t.link||((0,o.addLink)(t,{format:{href:t.text,underline:!0},dataset:{}}),0))}))}},8316:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLinkAfterSpace=void 0;var o=r(8871),n=r(4781),a=r(8745);t.createLinkAfterSpace=function(e){e.formatContentModel((function(e){var t=(0,n.getSelectedSegmentsAndParagraphs)(e,!1);if(t[0]&&t[0][1]){var r=t[0][1].segments.length,i=t[0][1].segments[r-1],l=t[0][1].segments[r-2];if("SelectionMarker"==i.segmentType&&"Text"==l.segmentType&&!l.link){var s=l.text.split(" ").pop();if(s&&(0,a.matchLink)(s)){l.text=l.text.replace(s,"");var c=(0,o.createText)(s,i.format,{format:{href:s,underline:!0},dataset:{}});return t[0][1].segments.splice(r-1,0,c),!0}}}return!1}))}},3272:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLinkSegment=void 0;var o=r(4781),n=r(8745);t.getLinkSegment=function(e){var t=(0,o.getSelectedSegmentsAndParagraphs)(e,!1);if(1==t.length&&t[0][1]){var r=t[0][1],a=r.segments[r.segments.length-1],i=r.segments[r.segments.length-2];if(a&&i&&"SelectionMarker"===a.segmentType&&a.isSelected&&"Text"===i.segmentType&&((0,n.matchLink)(i.text)||i.link))return i}}},4422:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unlink=void 0;var o=r(3272);t.unlink=function(e,t){e.formatContentModel((function(e){var r=(0,o.getLinkSegment)(e);return!!(null==r?void 0:r.link)&&(r.link=void 0,t.preventDefault(),!0)}))}},3520:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertAlphaToDecimals=void 0,t.convertAlphaToDecimals=function(e){var t=e.toUpperCase();if(t){for(var r=0,o=0;o<t.length;o++)r=26*r+(t.charCodeAt(o)-65+1);return r}}},2407:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIndex=void 0;var o=r(3520);t.getIndex=function(e){var t=e.replace(/[^a-zA-Z0-9 ]/g,""),r=parseInt(t);return isNaN(r)?(0,o.convertAlphaToDecimals)(t):r}},5593:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getListTypeStyle=void 0;var o=r(8745),n=r(5911),a=r(4781);t.getListTypeStyle=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0);var o=(0,a.getSelectedSegmentsAndParagraphs)(e,!0);if(o[0]){var u=o[0][0],f=o[0][1],p=null==f?void 0:f.segments[0];if(u&&"SelectionMarker"==u.segmentType&&p&&"Text"==p.segmentType){var m=p.text,v=c[m];if(v&&t)return{listType:"UL",styleType:v};if(r){var g=l(e,f),h=i(e,g),b=s(g),y=(0,n.getNumberingListStyle)(m,h,b);if(y)return{listType:"OL",styleType:y,index:!d(m)&&b===y&&h?h+1:void 0}}}}};var i=function(e,t){return t?(0,o.findListItemsInSameThread)(e,t).length:void 0},l=function(e,t){var r=(0,a.getOperationalBlocks)(e,["ListItem"],["TableCell"])[0],o=void 0;if(r){var n=r.parent.blocks.indexOf(t);if(n>-1)for(var i=n-1;i>-1;i--){var l=r.parent.blocks[i];if((0,a.isBlockGroupOfType)(l,"ListItem")){o=l;break}}}return o},s=function(e){var t;if(null==e?void 0:e.levels[0].dataset)return null===(t=(0,a.updateListMetadata)(e.levels[0]))||void 0===t?void 0:t.orderedStyleType},c={"*":a.BulletListType.Disc,"-":a.BulletListType.Dash,"--":a.BulletListType.Square,"->":a.BulletListType.LongArrow,"--\x3e":a.BulletListType.DoubleLongArrow,"=>":a.BulletListType.UnfilledArrow,">":a.BulletListType.ShortArrow,"":a.BulletListType.Hyphen},d=function(e){var t=e.replace(/[^\w\s]/g,"");return/^[1aAiI]$/.test(t)}},5911:(e,t,r)=>{var o,n,a,i,l,s;Object.defineProperty(t,"__esModule",{value:!0}),t.getNumberingListStyle=void 0;var c,d,u=r(2407),f=r(4781);!function(e){e[e.Decimal=1]="Decimal",e[e.LowerAlpha=2]="LowerAlpha",e[e.UpperAlpha=3]="UpperAlpha",e[e.LowerRoman=4]="LowerRoman",e[e.UpperRoman=5]="UpperRoman"}(c||(c={})),function(e){e[e.Dot=1]="Dot",e[e.Dash=2]="Dash",e[e.Parenthesis=3]="Parenthesis",e[e.DoubleParenthesis=4]="DoubleParenthesis"}(d||(d={}));var p={".":1,"-":2,")":3},m=[f.NumberingListType.LowerRoman,f.NumberingListType.LowerRomanDash,f.NumberingListType.LowerRomanDoubleParenthesis,f.NumberingListType.LowerRomanParenthesis],v=[f.NumberingListType.UpperRoman,f.NumberingListType.UpperRomanDash,f.NumberingListType.UpperRomanDoubleParenthesis,f.NumberingListType.UpperRomanParenthesis],g=["1","a","A","I","i"],h=["i","v","x","l","c","d","m"],b=["I","V","X","L","C","D","M"],y=((o={})[1]=function(e){return E[e]||void 0},o[2]=function(e){return T[e]||void 0},o[3]=function(e){return _[e]||void 0},o[4]=function(e){return C[e]||void 0},o[5]=function(e){return S[e]||void 0},o),S=((n={})[1]=f.NumberingListType.UpperRoman,n[2]=f.NumberingListType.UpperRomanDash,n[3]=f.NumberingListType.UpperRomanParenthesis,n[4]=f.NumberingListType.UpperRomanDoubleParenthesis,n),C=((a={})[1]=f.NumberingListType.LowerRoman,a[2]=f.NumberingListType.LowerRomanDash,a[3]=f.NumberingListType.LowerRomanParenthesis,a[4]=f.NumberingListType.LowerRomanDoubleParenthesis,a),_=((i={})[1]=f.NumberingListType.UpperAlpha,i[2]=f.NumberingListType.UpperAlphaDash,i[3]=f.NumberingListType.UpperAlphaParenthesis,i[4]=f.NumberingListType.UpperAlphaDoubleParenthesis,i),T=((l={})[1]=f.NumberingListType.LowerAlpha,l[2]=f.NumberingListType.LowerAlphaDash,l[3]=f.NumberingListType.LowerAlphaParenthesis,l[4]=f.NumberingListType.LowerAlphaDoubleParenthesis,l),E=((s={})[1]=f.NumberingListType.Decimal,s[2]=f.NumberingListType.DecimalDash,s[3]=f.NumberingListType.DecimalParenthesis,s[4]=f.NumberingListType.DecimalDoubleParenthesis,s);t.getNumberingListStyle=function(e,t,r){var o=e.trim(),n="("===o[0]&&")"===o[o.length-1],a=n?o.slice(1,-1):o.slice(0,-1),i=(0,u.getIndex)(a),l=g.indexOf(a)<0;if(!(!i||i<1||!t&&l||t&&l&&!function(e,t){return t&&e&&t+1===e}(i,t))){var s=function(e){return Number(e)||/^[A-Za-z\s]*$/.test(e)}(a)?function(e,t,r){var o=t?4:p[e[e.length-1]];if(o){var n=function(e,t){if(!isNaN(parseInt(e)))return 1;if(/[a-z]+/g.test(e)){if(4===t&&m.indexOf(t)>-1&&h.indexOf(e[0])>-1||!t&&"i"===e)return 4;if(2===t||!t&&"a"===e)return 2}else if(/[A-Z]+/g.test(e)){if(5==t&&v.indexOf(t)>-1&&b.indexOf(e[0])>-1||!t&&"I"===e)return 5;if(3==t||!t&&"A"===e)return 3}}(t?e.slice(1,-1):e.slice(0,-1),r);return n?y[n](o):void 0}}(o,n,l?r:void 0):void 0;return s}}},918:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardListTrigger=void 0;var o=r(5593),n=r(4781),a=r(8871),i=r(8745);t.keyboardListTrigger=function(e,t,r,i){void 0===r&&(r=!0),void 0===i&&(i=!0),(r||i)&&e.formatContentModel((function(s,c){var d=(0,o.getListTypeStyle)(s,r,i);if(d){var u=(0,n.getSelectedSegmentsAndParagraphs)(s,!1);u[0]&&u[0][1]&&u[0][1].segments.splice(0,1);var f=d.listType,p=d.styleType,m=d.index;return l(e,s,f,p,m),t.preventDefault(),(0,a.normalizeContentModel)(s),!0}return!1}))};var l=function(e,t,r,o,n){(0,i.setListType)(t,r);var a="OL"==r;n&&n>1&&a&&(0,i.setListStartNumber)(e,n),(0,i.setListStyle)(e,a?{orderedStyleType:o}:{unorderedStyleType:o})}},8189:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMenuPluginBase=void 0;var r=function(){function e(e){var t=this;this.options=e,this.container=null,this.editor=null,this.isMenuShowing=!1,this.onDismiss=function(){var e,r;t.container&&t.isMenuShowing&&(null===(r=(e=t.options).dismiss)||void 0===r||r.call(e,t.container),t.isMenuShowing=!1)}}return e.prototype.getName=function(){return"ContextMenu"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e;this.onDismiss(),(null===(e=this.container)||void 0===e?void 0:e.parentNode)&&(this.container.parentNode.removeChild(this.container),this.container=null),this.editor=null},e.prototype.onPluginEvent=function(e){if("contextMenu"==e.eventType&&e.items.length>0){var t=e.rawEvent,r=e.items;this.onDismiss(),this.options.allowDefaultMenu||t.preventDefault(),this.initContainer(t.pageX,t.pageY)&&(this.options.render(this.container,r,this.onDismiss),this.isMenuShowing=!0)}},e.prototype.initContainer=function(e,t){var r,o;return!this.container&&this.editor&&(this.container=this.editor.getDocument().createElement("div"),this.container.style.position="fixed",this.container.style.width="0",this.container.style.height="0",this.editor.getDocument().body.appendChild(this.container)),null===(r=this.container)||void 0===r||r.style.setProperty("left",e+"px"),null===(o=this.container)||void 0===o||o.style.setProperty("top",t+"px"),!!this.container},e}();t.ContextMenuPluginBase=r},958:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EditPlugin=void 0;var o=r(3467),n=r(6076),a=r(6414),i=function(){function e(){this.editor=null,this.disposer=null,this.shouldHandleNextInputEvent=!1}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){var t=this;this.editor=e,e.getEnvironment().isAndroid&&(this.disposer=this.editor.attachDomEvent({beforeinput:{beforeDispatch:function(r){return t.handleBeforeInputEvent(e,r)}}}))},e.prototype.dispose=function(){var e;this.editor=null,null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null},e.prototype.onPluginEvent=function(e){this.editor&&"keyDown"===e.eventType&&this.handleKeyDownEvent(this.editor,e)},e.prototype.handleKeyDownEvent=function(e,t){var r=t.rawEvent;if(!r.defaultPrevented&&!t.handledByEditFeature)switch(r.key){case"Backspace":case"Delete":(0,o.keyboardDelete)(e,r);break;case"Tab":(0,a.keyboardTab)(e,r);break;case"Unidentified":e.getEnvironment().isAndroid&&(this.shouldHandleNextInputEvent=!0);break;default:(0,n.keyboardInput)(e,r)}},e.prototype.handleBeforeInputEvent=function(e,t){if(this.shouldHandleNextInputEvent&&t instanceof InputEvent&&!t.defaultPrevented){this.shouldHandleNextInputEvent=!1;var r=!1;switch(t.inputType){case"deleteContentBackward":r=(0,o.keyboardDelete)(e,new KeyboardEvent("keydown",{key:"Backspace",keyCode:8,which:8}));break;case"deleteContentForward":r=(0,o.keyboardDelete)(e,new KeyboardEvent("keydown",{key:"Delete",keyCode:46,which:46}))}r&&t.preventDefault()}},e}();t.EditPlugin=i},8562:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteAllSegmentBefore=void 0;var o=r(4781);t.deleteAllSegmentBefore=function(e){if("notDeleted"==e.deleteResult)for(var t=e.insertPoint,r=t.paragraph,n=t.marker,a=r.segments.indexOf(n)-1;a>=0;a--){var i=r.segments[a];i.isSelected=!0,(0,o.deleteSegment)(r,i,e.formatContext)&&(e.deleteResult="range")}}},6274:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backwardDeleteCollapsedSelection=t.forwardDeleteCollapsedSelection=void 0;var o=r(7457),n=r(8745),a=r(8871),i=r(4781);function l(e){return function(t){var r;if("notDeleted"==t.deleteResult){var l="forward"==e,s=t.insertPoint,c=s.paragraph,d=s.marker,u=s.path,f=s.tableContext,p=c.segments;!function(e){var t,r;if("Br"==(null===(t=e[e.length-1])||void 0===t?void 0:t.segmentType)){var o=e.filter((function(e){return"SelectionMarker"!=e.segmentType}));"Br"!=(null===(r=o[o.length-2])||void 0===r?void 0:r.segmentType)&&e.pop()}}(p);var m,v,g=p.indexOf(d)+(l?1:-1),h=p[g];if(h)(0,i.deleteSegment)(c,h,t.formatContext,e)&&(t.deleteResult="singleChar",(0,a.setParagraphNotImplicit)(c));else if(function(e,t,r,o){return!e&&1==t.length&&"SelectionMarker"==t[0].segmentType&&r.format.marginLeft&&parseInt(r.format.marginLeft)&&(0,i.getClosestAncestorBlockGroupIndex)(o,["Document","TableCell"],["ListItem"])>-1}(l,p,c,u)&&(v=function(e){var t=e[e.length-1];return"Document"==t.blockGroupType?t:null}(u)))(0,n.setModelIndentation)(v,"outdent"),t.deleteResult="range";else if(m=(0,o.getLeafSiblingBlock)(u,c,l)){var b=m.block,y=m.path,S=m.siblingSegment;"Paragraph"==b.blockType?(S?(0,i.deleteSegment)(b,S,t.formatContext,e)&&(t.deleteResult="range"):(l?t.lastParagraph=b:("Br"==(null===(r=b.segments[b.segments.length-1])||void 0===r?void 0:r.segmentType)&&b.segments.pop(),t.insertPoint={marker:d,paragraph:b,path:y,tableContext:f},t.lastParagraph=c,delete b.cachedElement),t.deleteResult="range"),t.lastTableContext=f):(0,i.deleteBlock)(y[0].blocks,b,void 0,t.formatContext,e)&&(t.deleteResult="range")}else t.deleteResult="nothingToDelete"}}}t.forwardDeleteCollapsedSelection=l("forward"),t.backwardDeleteCollapsedSelection=l("backward")},5718:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteEmptyQuote=void 0;var o=r(8871),n=r(4781);t.deleteEmptyQuote=function(e){var t=e.deleteResult;if("nothingToDelete"==t||"notDeleted"==t||"range"==t){var r=e.insertPoint,s=e.formatContext,c=r.path,d=null==s?void 0:s.rawEvent,u=(0,n.getClosestAncestorBlockGroupIndex)(c,["FormatContainer","ListItem"],["TableCell"]),f=c[u];if(f&&"FormatContainer"===f.blockGroupType&&"blockquote"==f.tagName){var p=c[u+1],m=p.blocks.indexOf(f),v=p.blocks[m];(0,n.isBlockGroupOfType)(v,"FormatContainer")&&"blockquote"===v.tagName&&(a(v)?((0,o.unwrapBlock)(p,v),null==d||d.preventDefault(),e.deleteResult="range"):i(v)&&"Enter"===(null==d?void 0:d.key)&&(l(v,p,m),null==d||d.preventDefault(),e.deleteResult="range"))}}};var a=function(e){return 1===e.blocks.length&&"Paragraph"===e.blocks[0].blockType&&e.blocks[0].segments.every((function(e){return"SelectionMarker"===e.segmentType||"Br"===e.segmentType}))},i=function(e){var t=e.blocks.length,r=e.blocks[t-1];if(r&&"Paragraph"===r.blockType)return r.segments.every((function(e){return"SelectionMarker"===e.segmentType||"Br"===e.segmentType}))},l=function(e,t,r){var n=e.blocks.length;e.blocks.splice(n-1,1);var a=(0,o.createSelectionMarker)(),i=(0,o.createParagraph)(!1);i.segments.push(a),t.blocks.splice(r+1,0,i)}},1365:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteList=void 0;var o=r(4781);t.deleteList=function(e){var t=e.insertPoint,r=t.paragraph,n=t.marker,a=t.path;if("nothingToDelete"==e.deleteResult||"notDeleted"==e.deleteResult){var i=(0,o.getClosestAncestorBlockGroupIndex)(a,["ListItem","TableCell"]),l=a[i];l&&i>=0&&r.segments[0]==n&&"ListItem"==l.blockGroupType&&(1==r.segments.length||2==r.segments.length&&"Br"==r.segments[1].segmentType)&&(l.levels=[],e.deleteResult="range")}}},9120:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backwardDeleteWordSelection=t.forwardDeleteWordSelection=void 0;var o,n=r(7582),a=r(4781),i=r(8871);function l(e){return function(t){if("notDeleted"==t.deleteResult)for(var r=t.insertPoint,o=r.marker,l=r.paragraph,s=l.segments.indexOf(o),c="forward"==e,d=function(e,t,r,o){var l,s,c,d,u,f,p,m,v,g;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:l=r?1:-1,s=e.segments,c=(0,i.isWhiteSpacePreserved)(e.format.whiteSpace),d=t+l,n.label=1;case 1:if(!(d>=0&&d<s.length))return[3,12];switch((u=s[d]).segmentType){case"Text":return[3,2];case"Image":return[3,7];case"SelectionMarker":return[3,9]}return[3,10];case 2:f=r?0:u.text.length-1,n.label=3;case 3:return f>=0&&f<u.text.length?(p=u.text[f],m=(0,a.isPunctuation)(p),v=(0,a.isSpace)(p),[4,{punctuation:m,space:v,text:!m&&!v}]):[3,6];case 4:if(n.sent()){if(g=(g=u.text).substring(0,f)+g.substring(f+1),c||(g=(0,a.normalizeText)(g,r)),o.deleteResult="range",!g)return s.splice(d,1),l>0&&(d-=l),[3,6];u.text=g,l>0&&(f-=l)}n.label=5;case 5:return f+=l,[3,3];case 6:return[3,11];case 7:return[4,{punctuation:!0,space:!1,text:!1}];case 8:return n.sent()&&(s.splice(d,1),l>0&&(d-=l),o.deleteResult="range"),[3,11];case 9:return[3,11];case 10:return[2,null];case 11:return d+=l,[3,1];case 12:return[2,null]}}))}(l,s,c,t),u=d.next(),f=0;5!=f&&!u.done;){var p=u.value,m=p.punctuation,v=p.space,g=p.text;switch(f){case 0:f=v?4:m?1:2,u=d.next(!0);break;case 1:c&&v?(f=3,u=d.next(!0)):m?u=d.next(!0):f=5;break;case 2:c&&v?(f=3,u=d.next(!0)):g?u=d.next(!0):f=5;break;case 3:m||!v?f=5:u=d.next(!0);break;case 4:v?u=d.next(!0):m?(f=c?3:1,u=d.next(!0)):f=c?5:2}}}}!function(e){e[e.Start=0]="Start",e[e.Punctuation=1]="Punctuation",e[e.Text=2]="Text",e[e.NonText=3]="NonText",e[e.Space=4]="Space",e[e.End=5]="End"}(o||(o={})),t.forwardDeleteWordSelection=l("forward"),t.backwardDeleteWordSelection=l("backward")},824:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDeleteAllSegmentsBefore=t.shouldDeleteWord=t.handleKeyboardEventResult=void 0;var o=r(8871);t.handleKeyboardEventResult=function(e,t,r,n,a){switch(a.skipUndoSnapshot=!0,a.clearModelCache=!1,n){case"notDeleted":return a.clearModelCache=!0,!1;case"nothingToDelete":return r.preventDefault(),!1;case"range":case"singleChar":return r.preventDefault(),(0,o.normalizeContentModel)(t),"range"==n&&(a.skipUndoSnapshot=!1),e.triggerEvent("beforeKeyboardEditing",{rawEvent:r}),!0}},t.shouldDeleteWord=function(e,t){return t&&e.altKey&&!e.metaKey||!t&&e.ctrlKey&&!e.altKey},t.shouldDeleteAllSegmentsBefore=function(e){return e.metaKey&&!e.altKey}},1850:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleEnterOnList=void 0;var o=r(7582),n=r(4781),a=r(8871);t.handleEnterOnList=function(e){var t=e.deleteResult;if("nothingToDelete"==t||"notDeleted"==t||"range"==t){var r=e.insertPoint,o=e.formatContext,s=r.path,c=null==o?void 0:o.rawEvent,d=(0,n.getClosestAncestorBlockGroupIndex)(s,["ListItem"],["TableCell"]),u=s[d],f=s[d+1];if(u&&"ListItem"===u.blockGroupType&&f){var p=f.blocks.indexOf(u),m=f.blocks[p+1];if("range"==t&&m){(0,a.normalizeContentModel)(f);var v=f.blocks[p+1];if((0,n.isBlockGroupOfType)(v,"ListItem")&&v.levels[0]){v.levels.forEach((function(e,t){e.format.startNumberOverride=void 0,e.dataset=u.levels[t]?u.levels[t].dataset:{}}));var g=u.blocks[u.blocks.length-1],h=v.blocks[0];"Paragraph"===h.blockType&&"Paragraph"===g.blockType&&"SelectionMarker"===g.segments[g.segments.length-1].segmentType&&(g.segments.pop(),h.segments.unshift((0,a.createSelectionMarker)(r.marker.format))),e.lastParagraph=void 0}}else"range"!==t&&(i(u)?u.levels.pop():l(e,u,f));null==c||c.preventDefault(),e.deleteResult="range"}}};var i=function(e){return 1===e.blocks.length&&"Paragraph"===e.blocks[0].blockType&&2===e.blocks[0].segments.length&&"SelectionMarker"===e.blocks[0].segments[0].segmentType&&"Br"===e.blocks[0].segments[1].segmentType},l=function(e,t,r){var o=e.insertPoint,n=r.blocks.indexOf(t),i=c(o),l=s(t),d=(0,a.createListItem)(l,o.marker.format);d.blocks.push(i),o.paragraph=i,e.lastParagraph=i,r.blocks.splice(n+1,0,d)},s=function(e){return e.levels.map((function(e){return(0,a.createListLevel)(e.listType,(0,o.__assign)((0,o.__assign)({},e.format),{startNumberOverride:void 0}),e.dataset)}))},c=function(e){var t,r=e.paragraph,n=e.marker,i=(0,a.createParagraph)(!1,r.format,r.segmentFormat),l=r.segments.indexOf(n),s=r.segments.splice(l,r.segments.length-l);return(t=i.segments).push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(s),!1)),(0,a.setParagraphNotImplicit)(r),r.segments.every((function(e){return"SelectionMarker"==e.segmentType}))&&r.segments.push((0,a.createBr)(n.format)),(0,a.normalizeParagraph)(i),i}},3467:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardDelete=void 0;var o=r(4781),n=r(8562),a=r(5718),i=r(1365),l=r(8871),s=r(824),c=r(9120),d=r(6274);t.keyboardDelete=function(e,t){var r=!1;return function(e,t){if(e){if("range"==e.type&&e.range.collapsed){var r=e.range;return!((0,l.isNodeOfType)(r.startContainer,"TEXT_NODE")&&!(0,o.isModifierKey)(t)&&(function(e,t){return"Backspace"==e.key&&t.startOffset>1}(t,r)||function(e,t){var r,o;return"Delete"==e.key&&t.startOffset<(null!==(o=null===(r=t.startContainer.nodeValue)||void 0===r?void 0:r.length)&&void 0!==o?o:0)-1}(t,r)))}return!0}return!1}(e.getDOMSelection(),t)&&e.formatContentModel((function(l,u){var f=(0,o.deleteSelection)(l,function(e,t){var r="Delete"==e.key,o=(0,s.shouldDeleteAllSegmentsBefore)(e)&&!r?n.deleteAllSegmentBefore:null,l=(0,s.shouldDeleteWord)(e,t)?r?c.forwardDeleteWordSelection:c.backwardDeleteWordSelection:null,u=r?d.forwardDeleteCollapsedSelection:d.backwardDeleteCollapsedSelection,f=r?null:a.deleteEmptyQuote;return[o,l,u,i.deleteList,f]}(t,!!e.getEnvironment().isMac),u).deleteResult;return r=(0,s.handleKeyboardEventResult)(e,l,t,f,u)}),{rawEvent:t,changeSource:o.ChangeSource.Keyboard,getChangeData:function(){return t.which},apiName:"Delete"==t.key?"handleDeleteKey":"handleBackspaceKey"}),r}},6076:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardInput=void 0;var o=r(5718),n=r(4781),a=r(1850),i=r(8871);t.keyboardInput=function(e,t){var r=e.getDOMSelection();if(function(e,t){return!!e&&!((0,n.isModifierKey)(t)||"Enter"!=t.key&&"Space"!=t.key&&1!=t.key.length)&&("range"!=e.type||!e.range.collapsed||l(e,t))}(r,t))return e.takeSnapshot(),e.formatContentModel((function(e,s){var c,d=(0,n.deleteSelection)(e,function(e,t){return l(e,t)?[a.handleEnterOnList,o.deleteEmptyQuote]:[]}(r,t),s);return s.clearModelCache=!0,s.skipUndoSnapshot=!0,"range"==d.deleteResult&&(s.newPendingFormat=null===(c=d.insertPoint)||void 0===c?void 0:c.marker.format,(0,i.normalizeContentModel)(e),!0)}),{rawEvent:t}),!0};var l=function(e,t){return e&&"range"==e.type&&"Enter"==t.key&&!t.shiftKey}},6414:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardTab=void 0;var o=r(4781),n=r(6299),a=r(5126),i=r(8745);t.keyboardTab=function(e,t){var r=e.getDOMSelection();if("range"==(null==r?void 0:r.type))return e.formatContentModel((function(e){return function(e,t){var r=(0,o.getOperationalBlocks)(e,["ListItem"],["TableCell"]),l=r.length>0?r[0].block:void 0;return r.length>1?((0,i.setModelIndentation)(e,t.shiftKey?"outdent":"indent"),t.preventDefault(),!0):"Paragraph"===(null==l?void 0:l.blockType)?(0,a.handleTabOnParagraph)(e,l,t):!!(0,o.isBlockGroupOfType)(l,"ListItem")&&(0,n.handleTabOnList)(e,l,t)}(e,t)}),{apiName:"handleTabKey"}),!0}},6299:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleTabOnList=void 0;var o=r(5126),n=r(8745);t.handleTabOnList=function(e,t,r){var a=function(e){return e.blocks.filter((function(e){return"Paragraph"==e.blockType&&e.segments.some((function(e){return e.isSelected}))}))}(t);return function(e){return"Paragraph"==e.blocks[0].blockType&&"SelectionMarker"==e.blocks[0].segments[0].segmentType}(t)||1!=a.length||"Paragraph"!==a[0].blockType?((0,n.setModelIndentation)(e,r.shiftKey?"outdent":"indent"),r.preventDefault(),!0):(0,o.handleTabOnParagraph)(e,a[0],r)}},5126:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleTabOnParagraph=void 0;var o=r(8871),n=r(8745),a="";t.handleTabOnParagraph=function(e,t,r){var i=t.segments.filter((function(e){return e.isSelected})),l=1===i.length&&"SelectionMarker"===i[0].segmentType,s=t.segments.every((function(e){return e.isSelected}));if("SelectionMarker"===t.segments[0].segmentType&&l||s){var c=t.format,d=c.marginLeft,u=c.marginRight,f="rtl"===c.direction;if(r.shiftKey&&(!f&&(!d||"0px"==d)||f&&(!u||"0px"==u)))return!1;(0,n.setModelIndentation)(e,r.shiftKey?"outdent":"indent")}else if(l){var p=t.segments.findIndex((function(e){return"SelectionMarker"===e.segmentType}));if(r.shiftKey){if("Text"==(g=t.segments[p-1]).segmentType){var m=g.text.length-4;if(g.text===a)t.segments.splice(p-1,1);else{if(g.text.substring(m)!==a)return!1;g.text=g.text.substring(0,m)}}}else{var v=t.segments[p].format,g=(0,o.createText)(a,v);t.segments.splice(p,0,g)}}else{var h=void 0,b=void 0;if(t.segments.forEach((function(e,t){e.isSelected&&(h||(h=t),b=t)})),!h||!b)return!1;var y=t.segments[h],S=(0,o.createText)(r.shiftKey?a:"",y.format),C=(0,o.createSelectionMarker)(y.format);t.segments.splice(h,b-h+1,S,C)}return r.preventDefault(),!0}},7457:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLeafSiblingBlock=void 0;var o=r(7582),n=r(8871);t.getLeafSiblingBlock=function(e,t,r){for(var a,i=(0,o.__spreadArray)([],(0,o.__read)(e),!1),l=function(){var e=i[0],o=e.blocks.indexOf(t);if(o<0)return"break";var l=e.blocks[o+(r?1:-1)];if(l){for(;"BlockGroup"==l.blockType;){var s=l.blocks[r?0:l.blocks.length-1];if(!s)return{value:{block:l,path:i}};if("BlockGroup"!=s.blockType)return i.unshift(l),{value:{block:s,path:i}};i.unshift(l),l=s}return{value:{block:l,path:i}}}if((0,n.isGeneralSegment)(e)){i.shift();var c=-1,d=e,u=null===(a=i[0])||void 0===a?void 0:a.blocks.find((function(e){return"Paragraph"==e.blockType&&(c=e.segments.indexOf(d))>=0}));if(!u)return"break";var f=u.segments[c+(r?1:-1)];if(f)return{value:{block:u,path:i,siblingSegment:f}};t=u}else{if("Document"==e.blockGroupType||"TableCell"==e.blockGroupType)return"break";i.shift(),t=e}};i.length>0;){var s=l();if("object"==typeof s)return s.value;if("break"===s)break}return null}},1297:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WatermarkPlugin=t.ContextMenuPluginBase=t.ShortcutPlugin=t.ShortcutOutdentList=t.ShortcutIndentList=t.ShortcutDecreaseFont=t.ShortcutIncreaseFont=t.ShortcutNumbering=t.ShortcutBullet=t.ShortcutRedoMacOS=t.ShortcutRedo=t.ShortcutUndo2=t.ShortcutUndo=t.ShortcutClearFormat=t.ShortcutUnderline=t.ShortcutItalic=t.ShortcutBold=t.AutoFormatPlugin=t.EditPlugin=t.PastePlugin=t.TableEditPlugin=void 0;var o=r(7237);Object.defineProperty(t,"TableEditPlugin",{enumerable:!0,get:function(){return o.TableEditPlugin}});var n=r(2502);Object.defineProperty(t,"PastePlugin",{enumerable:!0,get:function(){return n.PastePlugin}});var a=r(958);Object.defineProperty(t,"EditPlugin",{enumerable:!0,get:function(){return a.EditPlugin}});var i=r(6582);Object.defineProperty(t,"AutoFormatPlugin",{enumerable:!0,get:function(){return i.AutoFormatPlugin}});var l=r(312);Object.defineProperty(t,"ShortcutBold",{enumerable:!0,get:function(){return l.ShortcutBold}}),Object.defineProperty(t,"ShortcutItalic",{enumerable:!0,get:function(){return l.ShortcutItalic}}),Object.defineProperty(t,"ShortcutUnderline",{enumerable:!0,get:function(){return l.ShortcutUnderline}}),Object.defineProperty(t,"ShortcutClearFormat",{enumerable:!0,get:function(){return l.ShortcutClearFormat}}),Object.defineProperty(t,"ShortcutUndo",{enumerable:!0,get:function(){return l.ShortcutUndo}}),Object.defineProperty(t,"ShortcutUndo2",{enumerable:!0,get:function(){return l.ShortcutUndo2}}),Object.defineProperty(t,"ShortcutRedo",{enumerable:!0,get:function(){return l.ShortcutRedo}}),Object.defineProperty(t,"ShortcutRedoMacOS",{enumerable:!0,get:function(){return l.ShortcutRedoMacOS}}),Object.defineProperty(t,"ShortcutBullet",{enumerable:!0,get:function(){return l.ShortcutBullet}}),Object.defineProperty(t,"ShortcutNumbering",{enumerable:!0,get:function(){return l.ShortcutNumbering}}),Object.defineProperty(t,"ShortcutIncreaseFont",{enumerable:!0,get:function(){return l.ShortcutIncreaseFont}}),Object.defineProperty(t,"ShortcutDecreaseFont",{enumerable:!0,get:function(){return l.ShortcutDecreaseFont}}),Object.defineProperty(t,"ShortcutIndentList",{enumerable:!0,get:function(){return l.ShortcutIndentList}}),Object.defineProperty(t,"ShortcutOutdentList",{enumerable:!0,get:function(){return l.ShortcutOutdentList}});var s=r(7049);Object.defineProperty(t,"ShortcutPlugin",{enumerable:!0,get:function(){return s.ShortcutPlugin}});var c=r(8189);Object.defineProperty(t,"ContextMenuPluginBase",{enumerable:!0,get:function(){return c.ContextMenuPluginBase}});var d=r(8185);Object.defineProperty(t,"WatermarkPlugin",{enumerable:!0,get:function(){return d.WatermarkPlugin}})},3342:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.excelHandler=t.processPastedContentFromExcel=void 0;var o=r(7582),n=r(3521),a=r(8871),i=r(3315),l=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,s=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,c=/<tr[^>]*>[^<]*/i,d=/<table[^>]*>[^<]*/i,u="solid 1px #d4d4d4";function f(e,t){if(e.match(l)){var r=t.match(c);e=(r?r[0]:"<TR>")+e+"</TR>"}if(e.match(s)){var o=t.match(d);e=(o?o[0]:"<TABLE>")+e+"</TABLE>"}return e}t.processPastedContentFromExcel=function(e,t,r){var l=e.fragment,s=e.htmlBefore,c=e.clipboardData,d=c.html?f(c.html,s):void 0;if(d&&c.html!=d){var p=(new DOMParser).parseFromString(t(d),"text/html");(0,a.moveChildNodes)(l,null==p?void 0:p.body)}var m=l.firstChild;(0,a.isNodeOfType)(m,"ELEMENT_NODE")&&"div"==m.tagName&&m.firstChild&&Array.from(m.childNodes).every((function(e){var t=(0,a.isNodeOfType)(e,"ELEMENT_NODE")&&e.tagName;return"META"==t||"TABLE"==t&&e==m.lastChild}))&&m.lastChild&&e.fragment.replaceChildren(m.lastChild),(0,n.addParser)(e.domToModelOption,"tableCell",(function(e,t){r||"none"!==t.style.borderStyle||(e.borderBottom=u,e.borderLeft=u,e.borderRight=u,e.borderTop=u)})),(0,i.setProcessor)(e.domToModelOption,"child",(function(e,t,r){var n=(0,o.__assign)({},r.segmentFormat);"TableCell"===e.blockGroupType&&e.format.textColor&&(r.segmentFormat.textColor=e.format.textColor),r.defaultElementProcessors.child(e,t,r),"TableCell"===e.blockGroupType&&e.format.textColor&&(r.segmentFormat=n,delete e.format.textColor)}))},t.excelHandler=f},2502:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PastePlugin=void 0;var o=r(3521),n=r(8871),a=r(1920),i=r(5247),l=r(4382),s=r(1738),c=r(3342),d=r(6635),u=r(5934),f=r(2843),p=function(){function e(e){this.allowExcelNoBorderTable=e,this.editor=null}return e.prototype.getName=function(){return"Paste"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor&&"beforePaste"==e.eventType&&e.domToModelOption){var t=(0,i.getPasteSource)(e,!1),r=e.pasteType;switch(t){case"wordDesktop":(0,u.processPastedContentFromWordDesktop)(e,this.editor.getTrustedHTMLHandler());break;case"wacComponents":(0,f.processPastedContentWacComponents)(e);break;case"excelOnline":case"excelDesktop":"normal"!==r&&"mergeFormat"!==r||(0,c.processPastedContentFromExcel)(e,this.editor.getTrustedHTMLHandler(),this.allowExcelNoBorderTable);break;case"googleSheets":e.domToModelOption.additionalAllowedTags.push(s.PastePropertyNames.GOOGLE_SHEET_NODE_NAME);break;case"powerPointDesktop":(0,d.processPastedContentFromPowerPoint)(e,this.editor.getTrustedHTMLHandler())}(0,o.addParser)(e.domToModelOption,"link",l.parseLink),(0,o.addParser)(e.domToModelOption,"tableCell",a.deprecatedBorderColorParser),(0,o.addParser)(e.domToModelOption,"tableCell",g),(0,o.addParser)(e.domToModelOption,"table",a.deprecatedBorderColorParser),"mergeFormat"===r&&((0,o.addParser)(e.domToModelOption,"block",m),(0,o.addParser)(e.domToModelOption,"listLevel",m))}},e}();t.PastePlugin=p;var m=function(e,t){t.style.backgroundColor&&delete e.backgroundColor},v=new Map([["borderTop",{w:"borderTopWidth",s:"borderTopStyle",c:"borderTopColor"}],["borderRight",{w:"borderRightWidth",s:"borderRightStyle",c:"borderRightColor"}],["borderBottom",{w:"borderBottomWidth",s:"borderBottomStyle",c:"borderBottomColor"}],["borderLeft",{w:"borderLeftWidth",s:"borderLeftStyle",c:"borderLeftColor"}]]);function g(e,t){n.BorderKeys.forEach((function(r){if(!e[r]){var o=v.get(r);o&&t.style[o.w]&&t.style[o.s]&&!t.style[o.c]&&(e[r]=t.style[o.w]+" "+t.style[o.s])}}))}},6635:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processPastedContentFromPowerPoint=void 0;var o=r(8871);t.processPastedContentFromPowerPoint=function(e,t){var r=e.fragment,n=e.clipboardData;if(n.html&&!n.text&&n.image){var a=(new DOMParser).parseFromString(t(n.html),"text/html");(0,o.moveChildNodes)(r,null==a?void 0:a.body)}}},7341:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WAC_IDENTIFY_SELECTOR=t.TEMP_ELEMENTS_CLASSES=t.COMMENT_HIGHLIGHT_CLICKED_CLASS=t.COMMENT_HIGHLIGHT_CLASS=t.LIST_CONTAINER_ELEMENT_CLASS_NAME=t.PARAGRAPH=t.OUTLINE_ELEMENT=t.IMAGE_CONTAINER=t.IMAGE_BORDER=t.NUMBER_LIST_STYLE=t.BULLET_LIST_STYLE=t.WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES=void 0;var o=r(7582);t.WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES=["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle"],t.BULLET_LIST_STYLE="BulletListStyle",t.NUMBER_LIST_STYLE="NumberListStyle",t.IMAGE_BORDER="WACImageBorder",t.IMAGE_CONTAINER="WACImageContainer",t.OUTLINE_ELEMENT="OutlineElement",t.PARAGRAPH="Paragraph",t.LIST_CONTAINER_ELEMENT_CLASS_NAME="ListContainerWrapper",t.COMMENT_HIGHLIGHT_CLASS="CommentHighlightRest",t.COMMENT_HIGHLIGHT_CLICKED_CLASS="CommentHighlightClicked",t.TEMP_ELEMENTS_CLASSES=(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(t.WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES),!1),["ListMarkerWrappingSpan"],!1),t.WAC_IDENTIFY_SELECTOR='ul[class^="'+t.BULLET_LIST_STYLE+'"]>.'+t.OUTLINE_ELEMENT+',ol[class^="'+t.NUMBER_LIST_STYLE+'"]>.'+t.OUTLINE_ELEMENT+",span."+t.IMAGE_CONTAINER+",span."+t.IMAGE_BORDER+",."+t.COMMENT_HIGHLIGHT_CLASS+",."+t.COMMENT_HIGHLIGHT_CLICKED_CLASS+","+t.WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES.map((function(e){return'table div[class^="'+e+'"]'})).join(",")},2843:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processPastedContentWacComponents=void 0;var o=r(7582),n=r(3521),a=r(8871),i=r(3315),l=r(7341),s=["UL","OL","LI"],c=s.join(","),d=function(e,t){var r=t.style.verticalAlign;"super"===r&&(e.superOrSubScriptSequence="super"),"sub"===r&&(e.superOrSubScriptSequence="sub")},u=function(e,t,r){var o=t.tagName;if(t.matches(l.WAC_IDENTIFY_SELECTOR)&&(t.style.removeProperty("display"),t.style.removeProperty("margin")),t.classList.contains(l.LIST_CONTAINER_ELEMENT_CLASS_NAME))r.elementProcessors.child(e,t,r);else if(!l.TEMP_ELEMENTS_CLASSES.some((function(e){return t.classList.contains(e)}))){if(function(e,t,r){return r.listFormat.levels.length>0&&s.every((function(t){return t!=e}))&&!t.closest(c)}(o,t,r)){var n=r.listFormat;n.levels=[],n.listParent=void 0}r.defaultElementProcessors.element(e,t,r)}},f=function(e,t,r){var n,i,l,s,c,d=parseInt(null!==(n=t.getAttribute("data-aria-level"))&&void 0!==n?n:""),u=r.listFormat,f=(null===(i=u.levels[r.listFormat.levels.length-1])||void 0===i?void 0:i.listType)||(null===(l=t.closest("ol,ul"))||void 0===l?void 0:l.tagName.toUpperCase()),p=(0,a.createListLevel)(f,r.blockFormat);if((0,a.parseFormat)(t,r.formatParsers.listLevelThread,p.format,r),(0,a.parseFormat)(t,r.formatParsers.listLevel,p.format,r),r.listFormat.levels=u.currentListLevels||r.listFormat.levels,d>0)if(d>r.listFormat.levels.length)for(;d!=r.listFormat.levels.length;)r.listFormat.levels.push(p);else r.listFormat.levels.splice(d,r.listFormat.levels.length-1),r.listFormat.levels[d-1]=p;null===(c=(s=r.defaultElementProcessors).li)||void 0===c||c.call(s,e,t,r);var m=u.listParent;if(m){var v=m.blocks[m.blocks.length-1];"BlockGroup"==v.blockType&&"ListItem"==v.blockGroupType&&function(e,t,r){if(e&&"UL"!=e.listType){var n=t.closest("ol"),a=r.listFormat,i=(0,o.__read)(function(e,t){var r=t&&Array.from((null==e?void 0:e.querySelectorAll("li"))||[]).indexOf(t);return[parseInt((null==e?void 0:e.getAttribute("start"))||"1")+(r&&r>0?r:0),parseInt((null==t?void 0:t.getAttribute("data-aria-level"))||"")]}(n,t),2),l=i[0],s=i[1];a.listItemThread||(a.listItemThread=[]);var c=a.listItemThread[s];c&&l-c!=1&&(e.format.startNumberOverride=l),a.listItemThread[s]=l}}(v.levels[v.levels.length-1],t,r)}var g=[];u.levels.forEach((function(e){var t={dataset:(0,o.__assign)({},e.dataset),format:(0,o.__assign)({},e.format),listType:e.listType};g.push(t)})),u.currentListLevels=g,u.levels=[]},p=function(e,t){"block"===t.style.display&&(e.displayForDummyItem=void 0),e.marginLeft=void 0},m=function(e){e.marginLeft=void 0,e.paddingLeft=void 0},v=function(e,t){(t.className.includes(l.COMMENT_HIGHLIGHT_CLASS)||t.className.includes(l.COMMENT_HIGHLIGHT_CLICKED_CLASS))&&delete e.backgroundColor};t.processPastedContentWacComponents=function(e){(0,n.addParser)(e.domToModelOption,"segment",d),(0,n.addParser)(e.domToModelOption,"listItemThread",p),(0,n.addParser)(e.domToModelOption,"listLevel",m),(0,n.addParser)(e.domToModelOption,"container",g),(0,n.addParser)(e.domToModelOption,"table",g),(0,n.addParser)(e.domToModelOption,"segment",v),(0,i.setProcessor)(e.domToModelOption,"element",u),(0,i.setProcessor)(e.domToModelOption,"li",f)};var g=function(e,t){t.style.marginLeft.startsWith("-")&&delete e.marginLeft}},6559:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getStyleMetadata=void 0;var o=r(7582),n=r(8871),a=/[\n\t'{}"]+/g;t.getStyleMetadata=function(e,t){var r=new Map;return(new DOMParser).parseFromString(t(e.htmlBefore),"text/html").querySelectorAll("style").forEach((function(e){for(var t=(null==e?void 0:e.innerHTML.trim())||"",i=0,l=function(){var e=t.indexOf("@",i+1),l=t.indexOf("}",e),s=t.indexOf("{",e);i=e;var c=t.substring(e+1,s).replace(a,"").replace("list","").trimRight().trimLeft(),d=t.substring(s,l+1).trimLeft().trimRight(),u={};d.split(";").forEach((function(e){var t=(0,o.__read)(e.split(":"),2),r=t[0],n=t[1];if(r&&n){var i=r.replace(a,"").trimRight().trimLeft(),l=n.replace(a,"").trimRight().trimLeft();u[i]=l}}));var f={"mso-level-number-format":u["mso-level-number-format"],"mso-level-start-at":u["mso-level-start-at"]||"1","mso-level-text":u["mso-level-text"]};(0,n.getObjectKeys)(f).some((function(e){return!!f[e]}))&&r.set(c,f)};i>=0;)l()})),r}},5934:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processPastedContentFromWordDesktop=void 0;var o=r(3521),n=r(6559),a=r(4103),i=r(1671),l=r(5776),s=r(1615),c=r(3315);t.processPastedContentFromWordDesktop=function(e,t){var r=(0,n.getStyleMetadata)(e,t);(0,c.setProcessor)(e.domToModelOption,"element",d(r)),(0,o.addParser)(e.domToModelOption,"block",s.removeNegativeTextIndentParser),(0,o.addParser)(e.domToModelOption,"listLevel",u),(0,o.addParser)(e.domToModelOption,"container",f),(0,o.addParser)(e.domToModelOption,"table",f)};var d=function(e){return function(t,r,o){var n=(0,a.getStyles)(r);(0,l.processWordList)(n,t,r,o,e)||(0,i.processWordComments)(n,r)||o.defaultElementProcessors.element(t,r,o)}};function u(e,t,r,o){""!=t.style.marginLeft&&(e.marginLeft=o.marginLeft),e.marginBottom=void 0}var f=function(e){var t;(null===(t=e.marginLeft)||void 0===t?void 0:t.startsWith("-"))&&delete e.marginLeft}},1671:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processWordComments=void 0;var o=r(8871),n=/#_msocom_/;t.processWordComments=function(e,t){return"comment"==e["mso-special-character"]||(0,o.isElementOfType)(t,"a")&&n.test(t.href)||"comment-list"==e["mso-element"]}},5776:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processWordList=void 0;var o=r(7582),n=r(4781),a=r(1615),i=r(8871),l=/%[0-9a-zA-Z]+/g;function s(e,t){t.style.marginLeft&&"0in"!=t.style.marginLeft&&(e.paddingLeft="0px"),t.style.marginRight&&"0in"!=t.style.marginRight&&(e.paddingRight="0px")}t.processWordList=function(e,t,r,c,d){var u,f=c.listFormat;f.wordKnownLevels||(f.wordKnownLevels=new Map);var p=e["mso-list"]||"";if("ignore"===p.toLowerCase())return!0;var m=(0,o.__read)(p.split(" "),2),v=m[0],g=m[1];if(f.wordLevel=g&&parseInt(g.substr(5)),f.wordList=v||"l0",0==f.levels.length&&(f.levels=f.wordList&&f.wordKnownLevels.get(f.wordList)||[]),p&&t&&"number"==typeof f.wordLevel){var h=f.wordLevel,b=f.wordList,y=d.get(v+":"+g),S="bullet"!=(null===(u=null==y?void 0:y["mso-level-number-format"])||void 0===u?void 0:u.toLowerCase())?"OL":"UL",C=(0,i.createListLevel)(S);if((0,i.parseFormat)(r,(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(c.formatParsers.listLevel),!1),[s],!1),C.format,c),h>f.levels.length)for(;h!=f.levels.length;)f.levels.push(C);else f.levels.splice(h,f.levels.length-1),f.levels[h-1]=C;return f.levels[f.levels.length-1].format.wordList=b,f.listParent=t,function(e,t,r,o,s){var c=e.levels[e.levels.length-1].listType,d=function(e,t){var r,o=(null==e?void 0:e["mso-level-number-format"])||"decimal";if(null==e?void 0:e["mso-level-text"]){var a="";switch(o){case"alpha-upper":a="UpperAlpha";break;case"alpha-lower":a="LowerAlpha";break;case"roman-lower":a="LowerRoman";break;case"roman-upper":a="UpperRoman";break;default:a="Number"}r='"'+(e["mso-level-text"]||"").replace("\\","").replace('"',"").replace(l,"${"+a+"}")+' "'}else switch(o){case"alpha-lower":r="lower-alpha";break;case"roman-lower":r="lower-roman";break;case"roman-upper":r="upper-roman";break;default:r="decimal"}return(0,n.getListStyleTypeFromString)(t,r)}(s,c);d&&(0,n.updateListMetadata)(e.levels[e.levels.length-1],(function(e){return Object.assign({},e,{unorderedStyleType:"UL"==c?d:void 0,orderedStyleType:"OL"==c?d:void 0})}));var u=(0,i.createListItem)(e.levels,t.segmentFormat);(0,i.parseFormat)(r,t.formatParsers.segmentOnBlock,t.segmentFormat,t),(0,i.parseFormat)(r,t.formatParsers.listItemElement,u.format,t),(0,i.parseFormat)(r,[a.removeNegativeTextIndentParser],u.format,t),"OL"==c&&function(e,t,r){var o,n,a=t.listFormat,l=a.listParent,s=a.wordList,c=a.wordKnownLevels,d=a.wordLevel,u=a.levels,f=function(e){for(var t=((null==e?void 0:e.blocks.length)||0)-1;t>0;t--){var r=null==e?void 0:e.blocks[t];if(r&&!(0,i.isEmpty)(r))return r}}(l);if(("BlockGroup"!=(null==f?void 0:f.blockType)||"ListItem"!=f.blockGroupType||d&&(null===(n=null===(o=f.levels[d])||void 0===o?void 0:o.format)||void 0===n?void 0:n.wordList)!=s)&&s){var p=(null==r?void 0:r["mso-level-start-at"])?parseInt(r["mso-level-start-at"]):NaN,m=(null==c?void 0:c.get(s))||[];null==p||isNaN(p)||m.length==u.length||(e.levels[e.levels.length-1].format.startNumberOverride=p)}}(u,t,s),t.elementProcessors.child(u,r,t),(0,i.addBlock)(o,u)}(f,c,r,t,y),f.levels.length>0&&f.wordKnownLevels.get(b)!=f.levels&&f.wordKnownLevels.set(b,(0,o.__spreadArray)([],(0,o.__read)(f.levels),!1)),!0}return!1}},1615:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeNegativeTextIndentParser=void 0,t.removeNegativeTextIndentParser=function(e,t){var r;(null===(r=e.textIndent)||void 0===r?void 0:r.startsWith("-"))&&delete e.textIndent}},1738:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PastePropertyNames=void 0,t.PastePropertyNames={GOOGLE_SHEET_NODE_NAME:"google-sheets-html-origin",PROG_ID_NAME:"ProgId",EXCEL_DESKTOP_ATTRIBUTE_NAME:"xmlns:x"}},60:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.documentContainWacElements=void 0;var o=r(7341);t.documentContainWacElements=function(e){return!!e.fragment.querySelector(o.WAC_IDENTIFY_SELECTOR)}},5247:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasteSource=void 0;var o=r(60),n=r(524),a=r(2816),i=r(377),l=r(2929),s=r(4936),c=r(3048),d=new Map([["wordDesktop",s.isWordDesktopDocument],["excelDesktop",n.isExcelDesktopDocument],["excelOnline",a.isExcelOnlineDocument],["powerPointDesktop",l.isPowerPointDesktopDocument],["wacComponents",o.documentContainWacElements],["googleSheets",i.isGoogleSheetDocument],["singleImage",c.shouldConvertToSingleImage]]);t.getPasteSource=function(e,t){var r=e.htmlAttributes,o=e.clipboardData,n=e.fragment,a=null,i={htmlAttributes:r,fragment:n,shouldConvertSingleImage:t,clipboardData:o};return d.forEach((function(e,t){!a&&e(i)&&(a=t)})),null!=a?a:"default"}},524:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isExcelDesktopDocument=void 0;var o=r(1738);t.isExcelDesktopDocument=function(e){return"urn:schemas-microsoft-com:office:excel"==e.htmlAttributes[o.PastePropertyNames.EXCEL_DESKTOP_ATTRIBUTE_NAME]}},2816:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isExcelOnlineDocument=void 0;var o=r(1738);t.isExcelOnlineDocument=function(e){var t=e.htmlAttributes;return"Excel.Sheet"==t[o.PastePropertyNames.PROG_ID_NAME]&&null==t[o.PastePropertyNames.EXCEL_DESKTOP_ATTRIBUTE_NAME]}},377:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isGoogleSheetDocument=void 0;var o=r(1738);t.isGoogleSheetDocument=function(e){return!!e.fragment.querySelector(o.PastePropertyNames.GOOGLE_SHEET_NODE_NAME)}},2929:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPowerPointDesktopDocument=void 0;var o=r(1738);t.isPowerPointDesktopDocument=function(e){return"PowerPoint.Slide"==e.htmlAttributes[o.PastePropertyNames.PROG_ID_NAME]}},4936:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isWordDesktopDocument=void 0;var o=r(1738);t.isWordDesktopDocument=function(e){var t=e.htmlAttributes;return"urn:schemas-microsoft-com:office:word"==t["xmlns:w"]||"Word.Document"==t[o.PastePropertyNames.PROG_ID_NAME]}},3048:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shouldConvertToSingleImage=void 0,t.shouldConvertToSingleImage=function(e){var t,r=e.shouldConvertSingleImage,o=e.clipboardData;return r&&1==(null===(t=o.htmlFirstLevelChildTags)||void 0===t?void 0:t.length)&&"IMG"==o.htmlFirstLevelChildTags[0]}},3521:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addParser=void 0,t.addParser=function(e,t,r){var o;e.additionalFormatParsers||(e.additionalFormatParsers={}),e.additionalFormatParsers[t]||(e.additionalFormatParsers[t]=[]),null===(o=e.additionalFormatParsers[t])||void 0===o||o.push(r)}},1920:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deprecatedBorderColorParser=void 0;var o=r(8871);t.deprecatedBorderColorParser=function(e){o.BorderKeys.forEach((function(t){var r=e[t],n="";if(r&&o.DeprecatedColors.some((function(e){return r.indexOf(e)>-1&&(n=e)}))){var a=r.replace(n,"").trimRight();e[t]=a}}))}},4103:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getStyles=void 0,t.getStyles=function(e){var t={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach((function(e){var r=e.indexOf(":"),o=e.slice(0,r),n=e.slice(r+1);o&&n&&(t[o.trim()]=n.trim())})),t}},4382:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseLink=void 0;var o=r(8871),n=["http:","https:","notes:","mailto:","onenote:"],a=/^file:\/\/\/[a-zA-Z\/]/i;t.parseLink=function(e,t){if((0,o.isElementOfType)(t,"a")){var r;try{r=new URL(t.href)}catch(e){r=void 0}(r&&-1===n.indexOf(r.protocol)||a.test(t.href))&&(t.removeAttribute("href"),e.href="")}}},3315:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setProcessor=void 0,t.setProcessor=function(e,t,r){e.processorOverride||(e.processorOverride={}),e.processorOverride[t]=r}},7270:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createElement=void 0;var o=r(8871);t.createElement=function e(t,r){if(!t||!t.tag)return null;var n=t.tag,a=t.namespace,i=t.className,l=t.style,s=t.dataset,c=t.attributes,d=t.children,u=a?r.createElementNS(a,n):r.createElement(n);return l&&u.setAttribute("style",l),i&&(u.className=i),s&&(0,o.isNodeOfType)(u,"ELEMENT_NODE")&&(0,o.getObjectKeys)(s).forEach((function(e){u.dataset[e]=s[e]})),c&&(0,o.getObjectKeys)(c).forEach((function(e){u.setAttribute(e,c[e])})),d&&d.forEach((function(t){if("string"==typeof t)u.appendChild(r.createTextNode(t));else if(t){var o=e(t,r);o&&u.appendChild(o)}})),u}},5043:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DragAndDropHelper=void 0;var o=r(7582),n={MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEUP:"mouseup",getPageXY:function(e){return[e.pageX,e.pageY]}},a={MOUSEDOWN:"touchstart",MOUSEMOVE:"touchmove",MOUSEUP:"touchend",getPageXY:function(e){var t=0,r=0;if(e.targetTouches&&e.targetTouches.length>0){var o=e.targetTouches[0];t=o.pageX,r=o.pageY}return[t,r]}};var i=function(){function e(e,t,r,i,l,s){var c=this;this.trigger=e,this.context=t,this.onSubmit=r,this.handler=i,this.zoomScale=l,this.initX=0,this.initY=0,this.initValue=void 0,this.onMouseDown=function(e){var t,r,n;e.preventDefault(),e.stopPropagation(),c.addDocumentEvents(),t=(0,o.__read)(c.dndMouse.getPageXY(e),2),c.initX=t[0],c.initY=t[1],c.initValue=null===(n=(r=c.handler).onDragStart)||void 0===n?void 0:n.call(r,c.context,e)},this.onMouseMove=function(e){var t,r,n;e.preventDefault();var a=(0,o.__read)(c.dndMouse.getPageXY(e),2),i=a[0],l=a[1],s=(i-c.initX)/c.zoomScale,d=(l-c.initY)/c.zoomScale;c.initValue&&(null===(r=(t=c.handler).onDragging)||void 0===r?void 0:r.call(t,c.context,e,c.initValue,s,d))&&(null===(n=c.onSubmit)||void 0===n||n.call(c,c.context,c.trigger))},this.onMouseUp=function(e){var t,r,o;e.preventDefault(),c.removeDocumentEvents(),(null===(r=(t=c.handler).onDragEnd)||void 0===r?void 0:r.call(t,c.context,e,c.initValue))&&(null===(o=c.onSubmit)||void 0===o||o.call(c,c.context,c.trigger))},this.dndMouse=s?a:n,e.addEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown)}return e.prototype.dispose=function(){this.trigger.removeEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown),this.removeDocumentEvents()},Object.defineProperty(e.prototype,"mouseType",{get:function(){return this.dndMouse==a?"touch":"mouse"},enumerable:!1,configurable:!0}),e.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.addEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},e.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.removeEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},e}();t.DragAndDropHelper=i},6690:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIntersectedRect=void 0;var o=r(7582),n=r(8871);t.getIntersectedRect=function(e,t){void 0===t&&(t=[]);var r=e.map((function(e){return(0,n.normalizeRect)(e.getBoundingClientRect())})).concat(t).filter((function(e){return!!e})),a={top:Math.max.apply(Math,(0,o.__spreadArray)([],(0,o.__read)(r.map((function(e){return e.top}))),!1)),bottom:Math.min.apply(Math,(0,o.__spreadArray)([],(0,o.__read)(r.map((function(e){return e.bottom}))),!1)),left:Math.max.apply(Math,(0,o.__spreadArray)([],(0,o.__read)(r.map((function(e){return e.left}))),!1)),right:Math.min.apply(Math,(0,o.__spreadArray)([],(0,o.__read)(r.map((function(e){return e.right}))),!1))};return a.top<a.bottom&&a.left<a.right?a:null}},7049:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShortcutPlugin=void 0;var o=r(4781),n=r(312),a=[n.ShortcutBold,n.ShortcutItalic,n.ShortcutUnderline,n.ShortcutClearFormat,n.ShortcutUndo,n.ShortcutUndo2,n.ShortcutRedo,n.ShortcutRedoMacOS,n.ShortcutBullet,n.ShortcutNumbering,n.ShortcutIncreaseFont,n.ShortcutDecreaseFont,n.ShortcutIndentList,n.ShortcutOutdentList],i=function(){function e(e){void 0===e&&(e=a),this.shortcuts=e,this.editor=null,this.isMac=!1}return e.prototype.getName=function(){return"Shortcut"},e.prototype.initialize=function(e){this.editor=e,this.isMac=!!this.editor.getEnvironment().isMac},e.prototype.dispose=function(){this.editor=null},e.prototype.willHandleEventExclusively=function(e){return"keyDown"==e.eventType&&(e.rawEvent.ctrlKey||e.rawEvent.altKey||e.rawEvent.metaKey)&&!!this.cacheGetCommand(e)},e.prototype.onPluginEvent=function(e){if(this.editor&&"keyDown"==e.eventType){var t=this.cacheGetCommand(e);t&&(t.onClick(this.editor),e.rawEvent.preventDefault())}},e.prototype.cacheGetCommand=function(e){var t=this;return(0,o.cacheGetEventData)(e,"__ShortcutCommandCache",(function(e){return t.editor&&t.shortcuts.filter((function(r){return t.matchOS(r.environment)&&t.matchShortcut(r.shortcutKey,e.rawEvent)}))[0]}))},e.prototype.matchOS=function(e){switch(e){case"mac":return this.isMac;case"nonMac":return!this.isMac;default:return!0}},e.prototype.matchShortcut=function(e,t){var r=t.ctrlKey,o=t.altKey,n=t.shiftKey,a=t.which,i=t.metaKey,l=this.isMac?i:r;return("ctrl"==e.modifierKey&&l&&!o||"alt"==e.modifierKey&&o&&!l)&&n==e.shiftKey&&e.which==a},e}();t.ShortcutPlugin=i},312:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShortcutOutdentList=t.ShortcutIndentList=t.ShortcutDecreaseFont=t.ShortcutIncreaseFont=t.ShortcutNumbering=t.ShortcutBullet=t.ShortcutRedoMacOS=t.ShortcutRedo=t.ShortcutUndo2=t.ShortcutUndo=t.ShortcutClearFormat=t.ShortcutUnderline=t.ShortcutItalic=t.ShortcutBold=void 0;var o,n=r(4781),a=r(7192),i=r(8745);!function(e){e[e.BACKSPACE=8]="BACKSPACE",e[e.SPACE=32]="SPACE",e[e.B=66]="B",e[e.I=73]="I",e[e.U=85]="U",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.ArrowRight=39]="ArrowRight",e[e.ArrowLeft=37]="ArrowLeft"}(o||(o={})),t.ShortcutBold={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:66},onClick:function(e){return(0,i.toggleBold)(e)}},t.ShortcutItalic={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:73},onClick:function(e){return(0,i.toggleItalic)(e)}},t.ShortcutUnderline={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:85},onClick:function(e){return(0,i.toggleUnderline)(e)}},t.ShortcutClearFormat={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:32},onClick:function(e){return(0,i.clearFormat)(e)}},t.ShortcutUndo={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:90},onClick:function(e){return(0,n.undo)(e)}},t.ShortcutUndo2={shortcutKey:{modifierKey:"alt",shiftKey:!1,which:8},onClick:function(e){return(0,n.undo)(e)},environment:"nonMac"},t.ShortcutRedo={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:89},onClick:function(e){return(0,n.redo)(e)},environment:"nonMac"},t.ShortcutRedoMacOS={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:90},onClick:function(e){return(0,n.redo)(e)},environment:"mac"},t.ShortcutBullet={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:190},onClick:function(e){return(0,i.toggleBullet)(e)}},t.ShortcutNumbering={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:191},onClick:function(e){return(0,i.toggleNumbering)(e)}},t.ShortcutIncreaseFont={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:190},onClick:function(e){return(0,i.changeFontSize)(e,"increase")}},t.ShortcutDecreaseFont={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:188},onClick:function(e){return(0,i.changeFontSize)(e,"decrease")}},t.ShortcutIndentList={shortcutKey:{modifierKey:"alt",shiftKey:!0,which:39},onClick:function(e){(0,a.setShortcutIndentationCommand)(e,"indent")}},t.ShortcutOutdentList={shortcutKey:{modifierKey:"alt",shiftKey:!0,which:37},onClick:function(e){(0,a.setShortcutIndentationCommand)(e,"outdent")}}},7192:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setShortcutIndentationCommand=void 0;var o=r(4781),n=r(8745);t.setShortcutIndentationCommand=function(e,t){e.formatContentModel((function(e){var r=(0,o.getFirstSelectedListItem)(e);return!(!r||"Paragraph"!=r.blocks[0].blockType||"SelectionMarker"!=r.blocks[0].segments[0].segmentType||((0,n.setModelIndentation)(e,t),0))}))}},7237:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TableEditPlugin=void 0;var o=r(8871),n=r(2789),a=function(){function e(e){var t=this;this.anchorContainerSelector=e,this.editor=null,this.onMouseMoveDisposer=null,this.tableRectMap=null,this.tableEditor=null,this.onMouseOut=function(e){var r=e.relatedTarget,n=e.currentTarget;(0,o.isNodeOfType)(r,"ELEMENT_NODE")&&(0,o.isNodeOfType)(n,"ELEMENT_NODE")&&t.tableEditor&&!t.tableEditor.isOwnedElement(r)&&!n.contains(r)&&t.setTableEditor(null)},this.onMouseMove=function(e){var r,o=e;if(!(o.buttons>0)&&t.editor){t.ensureTableRects();var n=t.editor.getDocument().defaultView||window,a=o.pageX-n.scrollX,i=o.pageY-n.scrollY,l=null;if(t.tableRectMap)for(var s=t.tableRectMap.length-1;s>=0;s--){var c=t.tableRectMap[s],d=c.table,u=c.rect;if(a>=u.left-12&&a<=u.right+12&&i>=u.top-12&&i<=u.bottom+12){l=d;break}}t.setTableEditor(l,o),null===(r=t.tableEditor)||void 0===r||r.onMouseMove(a,i)}},this.invalidateTableRects=function(){t.tableRectMap=null}}return e.prototype.getName=function(){return"TableEdit"},e.prototype.initialize=function(e){this.editor=e,this.onMouseMoveDisposer=this.editor.attachDomEvent({mousemove:{beforeDispatch:this.onMouseMove}}),this.editor.getScrollContainer().addEventListener("mouseout",this.onMouseOut)},e.prototype.dispose=function(){var e,t,r=null===(e=this.editor)||void 0===e?void 0:e.getScrollContainer();null==r||r.removeEventListener("mouseout",this.onMouseOut),null===(t=this.onMouseMoveDisposer)||void 0===t||t.call(this),this.invalidateTableRects(),this.disposeTableEditor(),this.editor=null,this.onMouseMoveDisposer=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case"input":case"contentChanged":case"scroll":case"zoomChanged":this.setTableEditor(null),this.invalidateTableRects()}},e.prototype.setTableEditor=function(e,t){if(this.tableEditor&&!this.tableEditor.isEditing()&&e!=this.tableEditor.table&&this.disposeTableEditor(),!this.tableEditor&&e&&this.editor&&e.rows.length>0){var r=this.anchorContainerSelector?this.editor.getDocument().querySelector(this.anchorContainerSelector):void 0;this.tableEditor=new n.TableEditor(this.editor,e,this.invalidateTableRects,(0,o.isNodeOfType)(r,"ELEMENT_NODE")?r:void 0,null==t?void 0:t.currentTarget)}},e.prototype.disposeTableEditor=function(){var e;null===(e=this.tableEditor)||void 0===e||e.dispose(),this.tableEditor=null},e.prototype.ensureTableRects=function(){var e=this;!this.tableRectMap&&this.editor&&(this.tableRectMap=[],this.editor.getDOMHelper().queryElements("table").forEach((function(t){if(t.isContentEditable){var r=(0,o.normalizeRect)(t.getBoundingClientRect());r&&e.tableRectMap&&e.tableRectMap.push({table:t,rect:r})}})))},e}();t.TableEditPlugin=a},2789:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TableEditor=void 0;var o,n=r(9395),a=r(125),i=r(1037),l=r(1523),s=r(7571),c=r(8871);!function(e){e[e.top=0]="top",e[e.side=1]="side"}(o||(o={}));var d=function(){function e(e,t,r,o,n){var a,i=this;this.editor=e,this.table=t,this.onChanged=r,this.anchorContainer=o,this.contentDiv=n,this.horizontalInserter=null,this.verticalInserter=null,this.horizontalResizer=null,this.verticalResizer=null,this.tableResizer=null,this.tableMover=null,this.range=null,this.onFinishEditing=function(){return i.editor.focus(),i.range&&i.editor.setDOMSelection({type:"range",range:i.range,isReverted:!1}),i.editor.takeSnapshot(),i.onChanged(),i.isCurrentlyEditing=!1,!1},this.onStartTableResize=function(){i.isCurrentlyEditing=!0,i.onStartResize()},this.onStartCellResize=function(){i.isCurrentlyEditing=!0,i.disposeTableResizer(),i.onStartResize()},this.onInserted=function(){i.disposeTableResizer(),i.onFinishEditing()},this.onSelect=function(e){if(i.editor.focus(),e){var t={table:e,firstRow:0,firstColumn:0,lastRow:e.rows.length-1,lastColumn:e.rows[e.rows.length-1].cells.length-1,type:"table"};i.editor.setDOMSelection(t)}},this.getOnMouseOut=function(e){return function(t){e&&t.relatedTarget!=e&&(0,c.isNodeOfType)(i.contentDiv,"ELEMENT_NODE")&&(0,c.isNodeOfType)(t.relatedTarget,"ELEMENT_NODE")&&i.contentDiv!=t.relatedTarget&&i.dispose()}},this.isRTL="rtl"==(null===(a=e.getDocument().defaultView)||void 0===a?void 0:a.getComputedStyle(t).direction),this.setEditorFeatures(),this.isCurrentlyEditing=!1}return e.prototype.dispose=function(){this.disposeTableResizer(),this.disposeCellResizers(),this.disposeTableInserter(),this.disposeTableMover()},e.prototype.isEditing=function(){return this.isCurrentlyEditing},e.prototype.isOwnedElement=function(e){return[this.tableResizer,this.tableMover,this.horizontalInserter,this.verticalInserter,this.horizontalResizer,this.verticalResizer].filter((function(e){return!!(null==e?void 0:e.div)})).some((function(t){return(null==t?void 0:t.div)==e}))},e.prototype.onMouseMove=function(e,t){var r,o=(0,c.normalizeRect)(this.table.getBoundingClientRect());if(o){for(var n=t<=o.top+6?0:this.isRTL?e>=o.right-6?1:void 0:e<=o.left+6?1:void 0,a=n?1:0,i=0;i<this.table.rows.length;i++){for(var l=this.table.rows[i],s=0;s<l.cells.length;s++){var d=l.cells[s],u=(0,c.normalizeRect)(d.getBoundingClientRect());if(u&&o){var f=t<=u.bottom,p=this.isRTL?e<=u.right+6*a:e<=u.right,m=this.isRTL?e>=u.left:e>=u.left-6*a;if(f&&p&&m){if(0===i&&0==n){var v=(u.left+u.right)/2,g=this.isRTL?e<v:e>v;this.setInserterTd(g?d:l.cells[s-1],!1)}else if(0===s&&1==n){var h=null===(r=this.table.rows[i-1])||void 0===r?void 0:r.cells[0],b=h?(0,c.normalizeRect)(h.getBoundingClientRect()):null,y=b?this.isRTL?b.right===u.right:b.left===u.left:null;this.setInserterTd(t<(u.top+u.bottom)/2&&y?h:d,!0)}else this.setInserterTd(null);this.setResizingTd(d);break}}}if(s<l.cells.length)break}this.setEditorFeatures()}},e.prototype.setEditorFeatures=function(){this.tableMover||(this.tableMover=(0,i.createTableMover)(this.table,this.editor,this.isRTL,this.onSelect,this.getOnMouseOut,this.contentDiv,this.anchorContainer)),this.tableResizer||(this.tableResizer=(0,l.createTableResizer)(this.table,this.editor,this.isRTL,this.onStartTableResize,this.onFinishEditing,this.contentDiv,this.anchorContainer))},e.prototype.setResizingTd=function(e){this.horizontalResizer&&this.horizontalResizer.node!=e&&this.disposeCellResizers(),!this.horizontalResizer&&e&&(this.horizontalResizer=(0,n.createCellResizer)(this.editor,e,this.table,this.isRTL,!0,this.onStartCellResize,this.onFinishEditing,this.anchorContainer),this.verticalResizer=(0,n.createCellResizer)(this.editor,e,this.table,this.isRTL,!1,this.onStartCellResize,this.onFinishEditing,this.anchorContainer))},e.prototype.setInserterTd=function(e,t){var r=t?this.horizontalInserter:this.verticalInserter;if((null===e||r&&r.node!=e)&&this.disposeTableInserter(),!this.horizontalInserter&&!this.verticalInserter&&e){var o=(0,a.createTableInserter)(this.editor,e,this.table,this.isRTL,!!t,this.onInserted,this.getOnMouseOut,this.anchorContainer);t?this.horizontalInserter=o:this.verticalInserter=o}},e.prototype.disposeTableResizer=function(){this.tableResizer&&((0,s.disposeTableEditFeature)(this.tableResizer),this.tableResizer=null)},e.prototype.disposeTableInserter=function(){this.horizontalInserter&&((0,s.disposeTableEditFeature)(this.horizontalInserter),this.horizontalInserter=null),this.verticalInserter&&((0,s.disposeTableEditFeature)(this.verticalInserter),this.verticalInserter=null)},e.prototype.disposeCellResizers=function(){this.horizontalResizer&&((0,s.disposeTableEditFeature)(this.horizontalResizer),this.horizontalResizer=null),this.verticalResizer&&((0,s.disposeTableEditFeature)(this.verticalResizer),this.verticalResizer=null)},e.prototype.disposeTableMover=function(){this.tableMover&&((0,s.disposeTableEditFeature)(this.tableMover),this.tableMover=null)},e.prototype.onStartResize=function(){this.isCurrentlyEditing=!0;var e=this.editor.getDOMSelection();e&&"range"==e.type&&(this.range=e.range),this.editor.takeSnapshot()},e}();t.TableEditor=d},9395:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createCellResizer=void 0;var o=r(7582),n=r(7270),a=r(5043),i=r(8871),l=r(4781);function s(e,t){var r=e.td,n=e.onStart,a=(0,i.normalizeRect)(r.getBoundingClientRect()),s=r.cellIndex,c=r.parentElement&&(0,i.isElementOfType)(r.parentElement,"tr")?r.parentElement:void 0,d=null==c?void 0:c.rowIndex;if(null==d)return{cmTable:void 0,anchorColumn:void 0,anchorRow:void 0,anchorRowHeight:-1,allWidths:[]};var u=e.editor,f=e.table,p=u.getDOMSelection();u.setDOMSelection({type:"table",firstColumn:0,firstRow:0,lastColumn:0,lastRow:0,table:f});var m=(0,l.getFirstSelectedTable)(u.getContentModelCopy("disconnected"))[0];return u.setDOMSelection(p),a&&m?(n(),{cmTable:m,anchorColumn:s,anchorRow:d,anchorRowHeight:m.rows[d].height,allWidths:(0,o.__spreadArray)([],(0,o.__read)(m.widths),!1)}):{cmTable:m,anchorColumn:void 0,anchorRow:void 0,anchorRowHeight:-1,allWidths:[]}}function c(e,t,r,o,n){var a=e.table,i=r.cmTable,s=r.anchorRow,c=r.anchorRowHeight;if(i&&null!=s){i.rows[s].height=(null!=c?c:0)+n,(0,l.normalizeTable)(i);for(var d=a.rows[s],u=0;u<d.cells.length;u++)d.cells[u].style.height=i.rows[s].height+"px";return!0}return!1}function d(e,t,r,o){var n=e.table,a=e.isRTL,i=r.cmTable,s=r.anchorColumn,c=r.allWidths;if(i&&null!=s){var d=o*(a?-1:1);if(s==i.widths.length-1)i.widths[s]=c[s]+d;else{var u=c[s]+d,f=c[s+1]-d;if(u<l.MIN_ALLOWED_TABLE_CELL_WIDTH||f<l.MIN_ALLOWED_TABLE_CELL_WIDTH)return!1;i.widths[s]=u,i.widths[s+1]=f}(0,l.normalizeTable)(i);for(var p=0;p<n.rows.length;p++)for(var m=n.rows[p],v=0;v<m.cells.length;v++)m.cells[v].style.width=i.widths[v]+"px";return!0}return!1}function u(e,t){var r=e.td,o=(0,i.normalizeRect)(r.getBoundingClientRect());o&&(t.id="horizontalResizer",t.style.top=o.bottom-4+"px",t.style.left=o.left+"px",t.style.width=o.right-o.left+"px",t.style.height="4px")}function f(e,t){var r=e.td,o=e.isRTL,n=(0,i.normalizeRect)(r.getBoundingClientRect());n&&(t.id="verticalResizer",t.style.top=n.top+"px",t.style.left=(o?n.left:n.right)-4+1+"px",t.style.width="4px",t.style.height=n.bottom-n.top+"px")}t.createCellResizer=function(e,t,r,o,i,l,p,m){var v=t.ownerDocument,g={tag:"div",style:"position: fixed; cursor: "+(i?"row":"col")+"-resize; user-select: none"},h=e.getDOMHelper().calculateZoomScale(),b=(0,n.createElement)(g,v);(m||v.body).appendChild(b);var y={editor:e,td:t,table:r,isRTL:o,zoomScale:h,onStart:l},S=i?u:f;S(y,b);var C={onDragStart:s,onDragging:i?c:d,onDragEnd:p};return{node:t,div:b,featureHandler:new a.DragAndDropHelper(b,y,S,C,h,e.getEnvironment().isMobileOrTablet)}}},7571:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disposeTableEditFeature=void 0,t.disposeTableEditFeature=function(e){var t,r,o;e&&(null===(r=null===(t=e.div)||void 0===t?void 0:t.parentNode)||void 0===r||r.removeChild(e.div),e.div=null,null===(o=e.featureHandler)||void 0===o||o.dispose(),e.featureHandler=null)}},125:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTableInserter=void 0;var o=r(7270),n=r(6690),a=r(8871),i=r(8745);t.createTableInserter=function(e,t,r,i,s,c,d,u){var f=(0,a.normalizeRect)(t.getBoundingClientRect()),p=e.getVisibleViewport(),m=r&&p?(0,n.getIntersectedRect)([r],[p]):null;if(f&&m){var v=t.ownerDocument,g=function(e,t,r,o){var n=t?"white":"#4A4A4A";return{tag:"div",style:"position: fixed; width: 12px; height: 12px; font-size: 16px; color: black; line-height: 8px; vertical-align: middle; text-align: center; cursor: pointer; border: solid 1px "+n+"; border-radius: 50%; background-color: "+o,children:[{tag:"div",style:"position: absolute; box-sizing: border-box; background-color: "+o+";"+(e?(r?"right":"left")+": 12px; top: 5px; height: 3px; border-top: 1px solid "+n+"; border-bottom: 1px solid "+n+"; border-right: 1px solid "+n+"; border-left: 0px;":"left: 5px; top: 12px; width: 3px; border-left: 1px solid "+n+"; border-right: 1px solid "+n+"; border-bottom: 1px solid "+n+"; border-top: 0px;")},"+"]}}(s,e.isDarkMode(),i,e.getDOMHelper().getDomStyle("backgroundColor")||"white"),h=(0,o.createElement)(g,v);return s?(h.id="horizontalInserter",h.style.left=(i?m.right:m.left-13)+"px",h.style.top=f.bottom-8+"px",h.firstChild.style.width=m.right-m.left+"px"):(h.id="verticalInserter",h.style.left=(i?f.left-8:f.right-8)+"px",h.style.top=m.top-13+"px",h.firstChild.style.height=m.bottom-m.top+"px"),(u||v.body).appendChild(h),{div:h,featureHandler:new l(h,t,r,s,e,c,d),node:t}}return null};var l=function(){function e(e,t,r,o,n,l,s){var c=this;this.div=e,this.td=t,this.table=r,this.isHorizontal=o,this.editor=n,this.onInsert=l,this.insertTd=function(){var e=c.td.cellIndex,t=c.td.parentElement&&(0,a.isElementOfType)(c.td.parentElement,"tr")?c.td.parentElement:void 0,r=t&&t.rowIndex;null!=(null==t?void 0:t.cells)&&null!=r&&((0,i.formatTableWithContentModel)(c.editor,"editTablePlugin",(function(e){c.isHorizontal?(0,i.insertTableRow)(e,"insertBelow"):(0,i.insertTableColumn)(e,"insertRight")}),{type:"table",firstColumn:e,firstRow:r,lastColumn:e,lastRow:r,table:c.table}),c.onInsert())},this.div.addEventListener("click",this.insertTd),this.onMouseOutEvent=s(e),this.div.addEventListener("mouseout",this.onMouseOutEvent)}return e.prototype.dispose=function(){this.div.removeEventListener("click",this.insertTd),this.onMouseOutEvent&&this.div.removeEventListener("mouseout",this.onMouseOutEvent),this.onMouseOutEvent=null},e}()},1037:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTableMover=void 0;var o=r(7582),n=r(7270),a=r(5043),i=r(8871);t.createTableMover=function(e,t,r,o,a,c,d){var u=(0,i.normalizeRect)(e.getBoundingClientRect());if(!function(e,t,r){var o=e.getVisibleViewport();if((0,i.isNodeOfType)(r,"ELEMENT_NODE")&&o&&t){var n=(0,i.normalizeRect)(r.getBoundingClientRect());return!!n&&n.top<=t.top&&o.top<=t.top}return!0}(t,u,c))return null;var f=t.getDOMHelper().calculateZoomScale(),p=e.ownerDocument,m=(0,n.createElement)({tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"},p);m.id="_Table_Mover",m.style.width="12px",m.style.height="12px",(d||p.body).appendChild(m);var v={table:e,zoomScale:f,rect:u,isRTL:r};s(v,m);var g=new l(m,v,s,{onDragEnd:function(e,t){return t.target==m&&o(e.table),!1}},v.zoomScale,a);return{div:m,featureHandler:g,node:e}};var l=function(e){function t(t,r,o,n,a,i,l,s){var c=e.call(this,t,r,o,n,a,l)||this;return c.div=t,c.onMouseOut=i(t),t.addEventListener("mouseout",c.onMouseOut),c}return(0,o.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onMouseOut&&this.div.removeEventListener("mouseout",this.onMouseOut),this.onMouseOut=null},t}(a.DragAndDropHelper);function s(e,t){var r=e.rect;r&&(t.style.top=r.top-12+"px",t.style.left=r.left-12-2+"px")}},1523:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTableResizer=void 0;var o=r(7270),n=r(5043),a=r(4781),i=r(8871),l=12;function s(e,t){e.onStart();var r=e.editor,o=e.table,n=r.getDOMSelection();r.setDOMSelection({type:"table",firstColumn:0,firstRow:0,lastColumn:0,lastRow:0,table:o});var i=(0,a.getFirstSelectedTable)(r.getContentModelCopy("disconnected"))[0];r.setDOMSelection(n);var l=[];null==i||i.rows.forEach((function(e){l.push(e.height)}));var s=[];return null==i||i.widths.forEach((function(e){s.push(e)})),{originalRect:o.getBoundingClientRect(),cmTable:i,originalHeights:null!=l?l:[],originalWidths:null!=s?s:[]}}function c(e,t,r,o,n){var i,l,s=e.isRTL,c=e.zoomScale,d=e.table,u=r.originalRect,f=r.originalHeights,p=r.originalWidths,m=r.cmTable,v=1+o/u.width*c*(s?-1:1),g=1+n/u.height*c,h=Math.abs(v-1)>.001,b=Math.abs(g-1)>.001;if(d.style.setProperty("width",null),d.style.setProperty("height",null),m&&m.rows&&(h||b)){for(var y=0;y<m.rows.length;y++)for(var S=0;S<m.rows[y].cells.length;S++)m.rows[y].cells[S]&&(h&&0==y&&(m.widths[S]=(null!==(i=p[S])&&void 0!==i?i:0)*v),b&&0==S&&(m.rows[y].height=(null!==(l=f[y])&&void 0!==l?l:0)*g));(0,a.normalizeTable)(m);for(var C=0;C<d.rows.length;C++){var _=d.rows[C];if(0!=_.cells.length)for(var T=0;T<_.cells.length;T++){var E=_.cells[T];E.style.width=m.widths[T]+"px",E.style.height=m.rows[C].height+"px"}}return!0}return!1}function d(e,t,r){return e.editor.isDisposed()||(p(e.editor,(0,i.normalizeRect)(e.table.getBoundingClientRect()),e.contentDiv)&&(e.div.style.visibility="visible",u(e,e.div)),e.onEnd()),!1}function u(e,t){var r=e.table,o=e.isRTL,n=(0,i.normalizeRect)(r.getBoundingClientRect());n&&(t.style.top=n.bottom+"px",t.style.left=o?n.left-l-2+"px":n.right+"px")}function f(e,t){t.style.visibility="hidden"}function p(e,t,r){var o=e.getVisibleViewport();if((0,i.isNodeOfType)(r,"ELEMENT_NODE")&&o&&t){var n=(0,i.normalizeRect)(r.getBoundingClientRect());return!!n&&n.bottom>=t.bottom&&o.bottom>=t.bottom}return!0}t.createTableResizer=function(e,t,r,a,m,v,g){if(!p(t,(0,i.normalizeRect)(e.getBoundingClientRect()),v))return null;var h=e.ownerDocument,b=t.getDOMHelper().calculateZoomScale(),y={tag:"div",style:"position: fixed; cursor: "+(r?"ne":"nw")+"-resize; user-select: none; border: 1px solid #808080"},S=(0,o.createElement)(y,h);S.id="_Table_Resizer",S.style.width=l+"px",S.style.height=l+"px",(g||h.body).appendChild(S);var C={isRTL:r,table:e,zoomScale:b,onStart:a,onEnd:m,div:S,editor:t,contentDiv:v};return u(C,S),{node:e,div:S,featureHandler:new n.DragAndDropHelper(S,C,f,{onDragStart:s,onDragging:c,onDragEnd:d},b,t.getEnvironment().isMobileOrTablet)}}},8185:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WatermarkPlugin=void 0;var o=r(8871),n=r(5269),a="_WatermarkContent",i={fontFamily:"font-family",fontSize:"font-size",textColor:"color"},l=function(){function e(e,t){this.watermark=e,this.editor=null,this.isShowing=!1,this.format=t||{fontSize:"14px",textColor:"#AAAAAA"}}return e.prototype.getName=function(){return"Watermark"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=this,r=this.editor;!r||"editorReady"!=e.eventType&&"contentChanged"!=e.eventType&&"input"!=e.eventType&&"beforeDispose"!=e.eventType||r.formatContentModel((function(e){var o=(0,n.isModelEmptyFast)(e);return t.isShowing&&!o?t.hide(r):!t.isShowing&&o&&t.show(r),!1}))},e.prototype.show=function(e){var t=this,r='position: absolute; pointer-events: none; content: "'+this.watermark+'";';(0,o.getObjectKeys)(i).forEach((function(e){t.format[e]&&(r+=i[e]+": "+t.format[e]+"!important;")})),e.setEditorStyle(a,r,"before"),this.isShowing=!0},e.prototype.hide=function(e){e.setEditorStyle(a,null),this.isShowing=!1},e}();t.WatermarkPlugin=l},5269:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isModelEmptyFast=void 0,t.isModelEmptyFast=function(e){var t=e.blocks[0];return!(e.blocks.length>1)&&(!t||"Paragraph"==t.blockType&&(0==t.segments.length||!t.segments.some((function(e){return"Entity"==e.segmentType||"Image"==e.segmentType||"General"==e.segmentType||"Text"==e.segmentType&&e.text}))&&t.segments.filter((function(e){return"Br"==e.segmentType})).length<=1))}},8234:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1880:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEditor=void 0;var o=r(7582),n=r(4781),a=r(1297);t.createEditor=function(e,t,r){var i={plugins:(0,o.__spreadArray)([new a.PastePlugin,new a.EditPlugin],(0,o.__read)(null!=t?t:[]),!1),initialModel:r,defaultSegmentFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new n.Editor(e,i)}},5803:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEditor=void 0;var o=r(7582),n=r(1880);Object.defineProperty(t,"createEditor",{enumerable:!0,get:function(){return n.createEditor}}),(0,o.__exportStar)(r(8234),t),(0,o.__exportStar)(r(8871),t),(0,o.__exportStar)(r(4781),t),(0,o.__exportStar)(r(8745),t),(0,o.__exportStar)(r(1297),t)},7582:(e,t,r)=>{r.r(t),r.d(t,{__assign:()=>a,__asyncDelegator:()=>k,__asyncGenerator:()=>E,__asyncValues:()=>M,__await:()=>T,__awaiter:()=>m,__classPrivateFieldGet:()=>F,__classPrivateFieldIn:()=>L,__classPrivateFieldSet:()=>D,__createBinding:()=>g,__decorate:()=>l,__esDecorate:()=>c,__exportStar:()=>h,__extends:()=>n,__generator:()=>v,__importDefault:()=>x,__importStar:()=>w,__makeTemplateObject:()=>P,__metadata:()=>p,__param:()=>s,__propKey:()=>u,__read:()=>y,__rest:()=>i,__runInitializers:()=>d,__setFunctionName:()=>f,__spread:()=>S,__spreadArray:()=>_,__spreadArrays:()=>C,__values:()=>b,default:()=>j});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function l(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function s(e,t){return function(r,o){t(r,o,e)}}function c(e,t,r,o,n,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var l,s=o.kind,c="getter"===s?"get":"setter"===s?"set":"value",d=!t&&e?o.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,o.name):{}),f=!1,p=r.length-1;p>=0;p--){var m={};for(var v in o)m[v]="access"===v?{}:o[v];for(var v in o.access)m.access[v]=o.access[v];m.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var g=(0,r[p])("accessor"===s?{get:u.get,set:u.set}:u[c],m);if("accessor"===s){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(l=i(g.get))&&(u.get=l),(l=i(g.set))&&(u.set=l),(l=i(g.init))&&n.unshift(l)}else(l=i(g))&&("field"===s?n.unshift(l):u[c]=l)}d&&Object.defineProperty(d,o.name,u),f=!0}function d(e,t,r){for(var o=arguments.length>2,n=0;n<t.length;n++)r=o?t[n].call(e,r):t[n].call(e);return o?r:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function f(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t,r,o){return new(r||(r=Promise))((function(n,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function l(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,l)}s((o=o.apply(e,t||[])).next())}))}function v(e,t){var r,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(s){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(r=1,o&&(n=2&l[0]?o.return:l[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,l[1])).done)return n;switch(o=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((n=(n=i.trys).length>0&&n[n.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!n||l[1]>n[0]&&l[1]<n[3])){i.label=l[1];break}if(6===l[0]&&i.label<n[1]){i.label=n[1],n=l;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(l);break}n[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],o=0}finally{r=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}}var g=Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function h(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,l=a.length;i<l;i++,n++)o[n]=a[i];return o}function _(e,t,r){if(r||2===arguments.length)for(var o,n=0,a=t.length;n<a;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function T(e){return this instanceof T?(this.v=e,this):new T(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),a=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){n[e]&&(o[e]=function(t){return new Promise((function(r,o){a.push([e,t,r,o])>1||l(e,t)}))})}function l(e,t){try{(r=n[e](t)).value instanceof T?Promise.resolve(r.value.v).then(s,c):d(a[0][2],r)}catch(e){d(a[0][3],e)}var r}function s(e){l("next",e)}function c(e){l("throw",e)}function d(e,t){e(t),a.shift(),a.length&&l(a[0][0],a[0][1])}}function k(e){var t,r;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:T(e[o](t)),done:!1}:n?n(t):t}:n}}function M(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(o,n){!function(e,t,r,o){Promise.resolve(o).then((function(t){e({value:t,done:r})}),t)}(o,n,(t=e[r](t)).done,t.value)}))}}}function P(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var O=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return O(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function F(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function D(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}function L(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}const j={__extends:n,__assign:a,__rest:i,__decorate:l,__param:s,__metadata:p,__awaiter:m,__generator:v,__createBinding:g,__exportStar:h,__values:b,__read:y,__spread:S,__spreadArrays:C,__spreadArray:_,__await:T,__asyncGenerator:E,__asyncDelegator:k,__asyncValues:M,__makeTemplateObject:P,__importStar:w,__importDefault:x,__classPrivateFieldGet:F,__classPrivateFieldSet:D,__classPrivateFieldIn:L}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o=r(5803);roosterjsContentModel=o})();
//# sourceMappingURL=rooster-content-model-min.js.map