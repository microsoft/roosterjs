var roosterjsContentModel;(()=>{"use strict";var e={3679:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultContentModelFormatMap=void 0,t.defaultContentModelFormatMap={a:{underline:!0},blockquote:{marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},code:{fontFamily:"monospace"},h1:{fontWeight:"bold",fontSize:"2em"},h2:{fontWeight:"bold",fontSize:"1.5em"},h3:{fontWeight:"bold",fontSize:"1.17em"},h4:{fontWeight:"bold",fontSize:"1em"},h5:{fontWeight:"bold",fontSize:"0.83em"},h6:{fontWeight:"bold",fontSize:"0.67em"},p:{marginTop:"1em",marginBottom:"1em"},pre:{fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"}}},1350:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultHTMLStyleMap=void 0;var r={display:"block"};t.defaultHTMLStyleMap={address:r,article:r,aside:r,b:{fontWeight:"bold"},blockquote:{display:"block",marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},br:r,center:{display:"block",textAlign:"center"},dd:r,div:r,dl:r,dt:r,em:{fontStyle:"italic"},fieldset:r,figcaption:r,figure:r,footer:r,form:r,h1:{display:"block",fontWeight:"bold",fontSize:"2em"},h2:{display:"block",fontWeight:"bold",fontSize:"1.5em"},h3:{display:"block",fontWeight:"bold",fontSize:"1.17em"},h4:{display:"block",fontWeight:"bold"},h5:{display:"block",fontWeight:"bold",fontSize:"0.83em"},h6:{display:"block",fontWeight:"bold",fontSize:"0.67em"},header:r,hr:r,i:{fontStyle:"italic"},li:{display:"list-item"},main:r,nav:r,ol:r,p:{display:"block",marginTop:"1em",marginBottom:"1em"},pre:{display:"block",fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"},s:{textDecoration:"line-through"},section:r,strike:{textDecoration:"line-through"},strong:{fontWeight:"bold"},sub:{verticalAlign:"sub",fontSize:"smaller"},sup:{verticalAlign:"super",fontSize:"smaller"},table:{display:"table",boxSizing:"border-box"},td:{display:"table-cell"},th:{display:"table-cell"},u:{textDecoration:"underline"},ul:r}},9968:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildFormatParsers=t.createDomToModelConfig=t.createDomToModelContextWithConfig=t.createDomToModelContext=void 0;var o=r(7582),n=r(3647),a=r(3871),l=r(8659);function i(e,t){return Object.assign({},t,{isInSelection:!1},{blockFormat:(null==t?void 0:t.isRootRtl)?{direction:"rtl"}:{},segmentFormat:{},listFormat:{levels:[],threadItemCounts:[]}},{link:{format:{},dataset:{}},code:{format:{}},blockDecorator:{format:{},tagName:""}},e)}function s(e){return{elementProcessors:Object.assign.apply(Object,(0,o.__spreadArray)([{},n.defaultProcessorMap],(0,o.__read)(e.map((function(e){return null==e?void 0:e.processorOverride}))),!1)),formatParsers:c(e.map((function(e){return null==e?void 0:e.formatParserOverride})),e.map((function(e){return null==e?void 0:e.additionalFormatParsers}))),defaultElementProcessors:n.defaultProcessorMap,defaultFormatParsers:l.defaultFormatParsers}}function c(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var r=Object.assign.apply(Object,(0,o.__spreadArray)([{}],(0,o.__read)(e),!1));return(0,a.getObjectKeys)(l.defaultFormatKeysPerCategory).reduce((function(e,n){var a,i=(a=l.defaultFormatKeysPerCategory[n].map((function(e){return void 0===r[e]?l.defaultFormatParsers[e]:r[e]}))).concat.apply(a,(0,o.__spreadArray)([],(0,o.__read)(t.map((function(e){var t;return null!==(t=null==e?void 0:e[n])&&void 0!==t?t:[]}))),!1));return e[n]=i,e}),{})}t.createDomToModelContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return i(s(t),e)},t.createDomToModelContextWithConfig=i,t.createDomToModelConfig=s,t.buildFormatParsers=c},3647:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultProcessorMap=void 0;var o=r(2697),n=r(9384),a=r(9633),l=r(2130),i=r(7883),s=r(6905),c=r(5718),d=r(9004),u=r(1001),f=r(2625),m=r(3092),p=r(215),v=r(4748),g=r(1091),h=r(5476),b=r(2791),y=r(8191),_=r(970),C=r(9892);t.defaultProcessorMap={a:g.linkProcessor,b:v.knownElementProcessor,blockquote:v.knownElementProcessor,br:o.brProcessor,code:a.codeProcessor,div:v.knownElementProcessor,em:v.knownElementProcessor,font:c.fontProcessor,i:v.knownElementProcessor,img:p.imageProcessor,h1:f.headingProcessor,h2:f.headingProcessor,h3:f.headingProcessor,h4:f.headingProcessor,h5:f.headingProcessor,h6:f.headingProcessor,hr:m.hrProcessor,li:h.listItemProcessor,ol:b.listProcessor,p:y.pProcessor,pre:d.formatContainerProcessor,s:v.knownElementProcessor,section:v.knownElementProcessor,span:v.knownElementProcessor,strike:v.knownElementProcessor,strong:v.knownElementProcessor,sub:v.knownElementProcessor,sup:v.knownElementProcessor,table:_.tableProcessor,u:v.knownElementProcessor,ul:b.listProcessor,"*":u.generalProcessor,"#text":C.textProcessor,element:i.elementProcessor,entity:s.entityProcessor,child:n.childProcessor,delimiter:l.delimiterProcessor}},1807:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.domToContentModel=void 0;var o=r(5733),n=r(8767);t.domToContentModel=function(e,t,r){var a=(0,o.createContentModelDocument)(t.defaultFormat);return t.selection=r,t.elementProcessors.child(a,e,t),(0,n.normalizeContentModel)(a),a}},7304:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.blockProcessor=void 0;var o=r(7582),n=r(9275),a=r(9004),l=r(5092),i=r(9366),s=["A","CODE"];t.blockProcessor=function(e,t,r,c){var d=r.blockDecorator.tagName?r.blockDecorator:void 0,u=s.indexOf(t.tagName)>=0;(0,i.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var f=(0,o.__assign)({},r.blockFormat);if((0,i.parseFormat)(t,r.formatParsers.container,f,r),a.ContextStyles.forEach((function(e){f[e]&&(r.blockFormat[e]=f[e])})),!u){var m=(0,l.createParagraph)(!1,f,c,d);(0,n.addBlock)(e,m)}r.elementProcessors.child(e,t,r)}},2697:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.brProcessor=void 0;var o=r(8513),n=r(7826);t.brProcessor=function(e,t,r){var a,l=(0,n.createBr)(r.segmentFormat);r.isInSelection&&(l.isSelected=!0);var i=(0,o.addSegment)(e,l,r.blockFormat);null===(a=r.domIndexer)||void 0===a||a.onSegment(t,i,[l])}},9384:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleRegularSelection=t.processChildNode=t.childProcessor=void 0;var o=r(7582),n=r(9871),a=r(8063),l=r(3233);function i(e,t,r){(0,l.isNodeOfType)(t,"ELEMENT_NODE")&&"none"!=t.style.display?r.elementProcessors.element(e,t,r):(0,l.isNodeOfType)(t,"TEXT_NODE")&&r.elementProcessors["#text"](e,t,r)}function s(e,t,r,o,a){var l;e==o&&(t.isInSelection=!0,(0,n.addSelectionMarker)(r,t)),e==a&&"range"==(null===(l=t.selection)||void 0===l?void 0:l.type)&&(t.selection.range.collapsed||(0,n.addSelectionMarker)(r,t),t.isInSelection=!1)}t.childProcessor=function(e,t,r){for(var n=(0,o.__read)((0,a.getRegularSelectionOffsets)(r,t),2),l=n[0],c=n[1],d=0,u=t.firstChild;u;u=u.nextSibling)s(d,r,e,l,c),i(e,u,r),d++;s(d,r,e,l,c)},t.processChildNode=i,t.handleRegularSelection=s},9633:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.codeProcessor=void 0;var o=r(4748),n=r(9366),a=r(202);t.codeProcessor=function(e,t,r){(0,a.stackFormat)(r,{code:"codeDefault"},(function(){(0,n.parseFormat)(t,r.formatParsers.code,r.code.format,r),(0,o.knownElementProcessor)(e,t,r)}))}},2130:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.delimiterProcessor=void 0;var o=r(9871);t.delimiterProcessor=function(e,t,r){var n,a,l="range"==(null===(n=r.selection)||void 0===n?void 0:n.type)?r.selection.range:null;l&&(t.contains(l.startContainer)&&(r.isInSelection=!0,(0,o.addSelectionMarker)(e,r)),"range"==(null===(a=r.selection)||void 0===a?void 0:a.type)&&t.contains(l.endContainer)&&(r.selection.range.collapsed||(0,o.addSelectionMarker)(e,r),r.isInSelection=!1))}},7883:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.elementProcessor=void 0;var o=r(2033);t.elementProcessor=function(e,t,r){var n=t.tagName.toLowerCase(),a=function(e,t){return(0,o.isEntityElement)(e)||"false"==e.contentEditable?t.elementProcessors.entity:null}(t,r)||function(e,t){return(0,o.isEntityDelimiter)(e)?t.elementProcessors.delimiter:null}(t,r)||r.elementProcessors[n]||n.indexOf(":")>=0&&r.elementProcessors.child||r.elementProcessors["*"];a(e,t,r)}},6905:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.entityProcessor=void 0;var o=r(9275),n=r(8513),a=r(1033),l=r(2404),i=r(9366),s=r(202);t.entityProcessor=function(e,t,r){var c=(0,l.isBlockElement)(t);(0,s.stackFormat)(r,{segment:c?"empty":void 0,paragraph:"empty"},(function(){var l,s=(0,a.createEntity)(t,!0,r.segmentFormat);if((0,i.parseFormat)(t,r.formatParsers.entity,s.entityFormat,r),r.isInSelection&&(s.isSelected=!0),c)(0,o.addBlock)(e,s);else{var d=(0,n.addSegment)(e,s);null===(l=r.domIndexer)||void 0===l||l.onSegment(t,d,[s])}}))}},5718:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fontProcessor=void 0;var o=r(2404),n=r(9366),a=r(202),l=["10px","13px","16px","18px","24px","32px","48px"];t.fontProcessor=function(e,t,r){(0,a.stackFormat)(r,{segment:(0,o.isBlockElement)(t)?"shallowCloneForBlock":"shallowClone"},(function(){var o,a,i=t.getAttribute("face"),s=(o=t.getAttribute("size"),a=parseInt(o||""),Number.isNaN(a)?void 0:a<1?l[0]:a>l.length?l[l.length-1]:l[a-1]),c=t.getAttribute("color"),d=r.segmentFormat;i&&(d.fontFamily=i),s&&(d.fontSize=s),c&&(d.textColor=c),(0,n.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r),r.elementProcessors.child(e,t,r)}))}},9004:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatContainerProcessor=t.ContextStyles=void 0;var o=r(7582),n=r(9275),a=r(2766),l=r(5092),i=r(3149),s=r(9366),c=r(3963),d=r(202);t.ContextStyles=["marginLeft","marginRight","paddingLeft","paddingRight"],t.formatContainerProcessor=function(e,r,u){(0,d.stackFormat)(u,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){(0,s.parseFormat)(r,u.formatParsers.block,u.blockFormat,u),(0,s.parseFormat)(r,u.formatParsers.segmentOnBlock,u.segmentFormat,u);var l=(0,o.__assign)({},u.blockFormat);(0,s.parseFormat)(r,u.formatParsers.container,l,u);var d="block"==(0,i.getDefaultStyle)(r).display?r.tagName.toLowerCase():"div",f=(0,a.createFormatContainer)(d,l);if(t.ContextStyles.forEach((function(e){delete u.blockFormat[e]})),u.elementProcessors.child(f,r,u),r.style.fontSize&&0==parseInt(r.style.fontSize)&&(f.zeroFontSize=!0),function(e){var t=e.blocks[0];return"div"==e.tagName&&1==e.blocks.length&&"Paragraph"==t.blockType&&t.isImplicit}(f)){var m=f.blocks[0];f.zeroFontSize&&(m.segmentFormat=Object.assign({},m.segmentFormat,{fontSize:"0"})),Object.assign(m.format,f.format),(0,c.setParagraphNotImplicit)(m),(0,n.addBlock)(e,m)}else(0,n.addBlock)(e,f)})),(0,n.addBlock)(e,(0,l.createParagraph)(!0,u.blockFormat))}},1001:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generalProcessor=void 0;var o=r(9275),n=r(3883),a=r(8513),l=r(9237),i=r(8885),s=r(2404),c=r(202),d=function(e,t,r){var n=(0,l.createGeneralBlock)(t),a=r.isInSelection;(0,c.stackFormat)(r,{segment:"empty",paragraph:"empty",link:"empty"},(function(){(0,o.addBlock)(e,n),r.elementProcessors.child(n,t,r)})),a&&r.isInSelection&&(n.isSelected=!0)},u=function(e,t,r){var o,l=(0,i.createGeneralSegment)(t,r.segmentFormat),s=r.isInSelection;(0,n.addDecorators)(l,r);var d=(0,a.addSegment)(e,l);null===(o=r.domIndexer)||void 0===o||o.onSegment(t,d,[l]),(0,c.stackFormat)(r,{segment:"empty"},(function(){r.elementProcessors.child(l,t,r)})),s&&r.isInSelection&&(l.isSelected=!0)};t.generalProcessor=function(e,t,r){((0,s.isBlockElement)(t)?d:u)(e,t,r)}},2625:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.headingProcessor=void 0;var o=r(9275),n=r(7304),a=r(5092),l=r(24),i=r(3871),s=r(9366),c=r(202);t.headingProcessor=function(e,t,r){(0,c.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone",blockDecorator:"empty"},(function(){var o={};(0,s.parseFormat)(t,r.formatParsers.segmentOnBlock,o,r),(0,i.getObjectKeys)(o).forEach((function(e){delete r.segmentFormat[e]})),r.blockDecorator=(0,l.createParagraphDecorator)(t.tagName,o),(0,n.blockProcessor)(e,t,r)})),(0,o.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat))}},3092:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hrProcessor=void 0;var o=r(9275),n=r(7110),a=r(9366),l=r(202);t.hrProcessor=function(e,t,r){(0,l.stackFormat)(r,{paragraph:"shallowClone"},(function(){(0,a.parseFormat)(t,r.formatParsers.divider,r.blockFormat,r);var l=(0,n.createDivider)("hr",r.blockFormat);t.size&&(l.size=t.size),r.isInSelection&&(l.isSelected=!0),(0,o.addBlock)(e,l)}))}},215:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.imageProcessor=void 0;var o=r(3883),n=r(8513),a=r(5566),l=r(9366),i=r(202);t.imageProcessor=function(e,t,r){(0,i.stackFormat)(r,{segment:"shallowClone"},(function(){var i,s,c=r.segmentFormat;(0,l.parseFormat)(t,r.formatParsers.segment,c,r),(0,l.parseFormat)(t,r.formatParsers.image,c,r),(0,l.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var d=(0,a.createImage)(t.src,c),u=t.alt,f=t.title;(0,l.parseFormat)(t,r.formatParsers.dataset,d.dataset,r),(0,o.addDecorators)(d,r),u&&(d.alt=u),f&&(d.title=f),r.isInSelection&&(d.isSelected=!0),"image"==(null===(i=r.selection)||void 0===i?void 0:i.type)&&r.selection.image==t&&(d.isSelectedAsImageSelection=!0,d.isSelected=!0);var m=(0,n.addSegment)(e,d);null===(s=r.domIndexer)||void 0===s||s.onSegment(t,m,[d])}))}},4748:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.knownElementProcessor=void 0;var o=r(9275),n=r(7304),a=r(5092),l=r(9004),i=r(3149),s=r(2404),c=r(9366),d=r(202),u=["marginBottom","marginTop","paddingBottom","paddingTop","paddingLeft","paddingRight","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","width","height","maxWidth","maxHeight","minWidth","minHeight"],f=["H1","H2","H3","H4","H5","H6","P","A"],m=["A","CODE"];t.knownElementProcessor=function(e,t,r){var p=(0,s.isBlockElement)(t);if((p||"inline-block"==t.style.display)&&function(e,t){if(f.indexOf(e.tagName)>=0)return!1;var r=e.style,o=(0,i.getDefaultStyle)(e),n=r.getPropertyValue("background-color");return!(!n||"transparent"==n)||(!!u.some((function(e){return parseInt(r[e]||o[e]||"")>0}))||("auto"==r.marginLeft||"auto"==r.marginRight||!!e.getAttribute("align")))}(t))(0,l.formatContainerProcessor)(e,t,r);else if(p){var v=r.blockDecorator.tagName?r.blockDecorator:void 0,g=m.indexOf(t.tagName)>=0;(0,d.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){var o={};(0,c.parseFormat)(t,r.formatParsers.segmentOnBlock,o,r),Object.assign(r.segmentFormat,o),(0,n.blockProcessor)(e,t,r,o)})),p&&!g&&(0,o.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat,void 0,v))}else(0,d.stackFormat)(r,{segment:"shallowClone",paragraph:"shallowClone",link:"cloneFormat"},(function(){(0,c.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r),r.link.format.href&&"A"!=t.tagName&&(0,c.parseFormat)(t,r.formatParsers.segmentUnderLink,r.link.format,r),r.elementProcessors.child(e,t,r)}))}},1091:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.linkProcessor=void 0;var o=r(4748),n=r(9366),a=r(202);t.linkProcessor=function(e,t,r){t.hasAttribute("href")?(0,a.stackFormat)(r,{link:"linkDefault"},(function(){(0,n.parseFormat)(t,r.formatParsers.link,r.link.format,r),(0,n.parseFormat)(t,r.formatParsers.dataset,r.link.dataset,r),(0,o.knownElementProcessor)(e,t,r)})):(0,o.knownElementProcessor)(e,t,r)}},5476:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listItemProcessor=void 0;var o=r(7724),n=r(9366),a=r(202);t.listItemProcessor=function(e,t,r){var l,i=r.listFormat;if(i.listParent&&i.levels.length>0)(0,a.stackFormat)(r,{segment:"shallowCloneForBlock"},(function(){(0,n.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r);var e=(0,o.createListItem)(i.levels,r.segmentFormat);(0,n.parseFormat)(t,r.formatParsers.listItemElement,e.format,r),i.listParent.blocks.push(e),(0,n.parseFormat)(t,r.formatParsers.listItemThread,e.levels[e.levels.length-1].format,r),r.elementProcessors.child(e,t,r);var a=e.blocks[0];1==e.blocks.length&&"Paragraph"==a.blockType&&a.isImplicit&&(Object.assign(e.format,a.format),a.format={})}));else{var s=null===(l=i.listParent)||void 0===l?void 0:l.blocks,c=null==s?void 0:s[(null==s?void 0:s.length)-1];r.elementProcessors["*"]("BlockGroup"==(null==c?void 0:c.blockType)?c:e,t,r)}}},2791:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listProcessor=void 0;var o=r(1285),n=r(9366),a=r(202);t.listProcessor=function(e,t,r){(0,a.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},(function(){var a=(0,o.createListLevel)(t.tagName,r.blockFormat),l=r.listFormat;(0,n.parseFormat)(t,r.formatParsers.dataset,a.dataset,r),(0,n.parseFormat)(t,r.formatParsers.listLevelThread,a.format,r),(0,n.parseFormat)(t,r.formatParsers.listLevel,a.format,r),(0,n.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r);var i=l.listParent;l.listParent=l.listParent||e,l.levels.push(a);try{r.elementProcessors.child(e,t,r)}finally{l.levels.pop(),l.listParent=i}}))}},8191:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pProcessor=void 0;var o=r(9275),n=r(7304),a=r(5092),l=r(24),i=r(9366),s=r(202);t.pProcessor=function(e,t,r){(0,s.stackFormat)(r,{blockDecorator:"empty",segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){r.blockDecorator=(0,l.createParagraphDecorator)(t.tagName);var o={};(0,i.parseFormat)(t,r.formatParsers.segmentOnBlock,o,r),Object.assign(r.segmentFormat,o),(0,n.blockProcessor)(e,t,r,o)})),(0,o.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat))}},970:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tableProcessor=void 0;var o=r(7582),n=r(9275),a=r(988),l=r(1160),i=r(3095),s=r(7960),c=r(3233),d=r(9366),u=r(202);function f(e){for(var t=[],r=e[e.length-1],o=e.length-2;o>=0;o--)void 0===e[o]?t[o]=0:(t[o]=r-e[o],r=e[o]);return t}t.tableProcessor=function(e,t,r){(0,u.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},(function(){var m,p;(0,d.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var v=(0,a.createTable)(t.rows.length,r.blockFormat),g="table"==(null===(m=r.selection)||void 0===m?void 0:m.type)?r.selection:null,h=(null==g?void 0:g.table)==t;r.allowCacheElement&&(v.cachedElement=t),null===(p=r.domIndexer)||void 0===p||p.onTable(t,v),(0,d.parseFormat)(t,r.formatParsers.table,v.format,r),(0,d.parseFormat)(t,r.formatParsers.tableBorder,v.format,r),(0,d.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r),(0,d.parseFormat)(t,r.formatParsers.dataset,v.dataset,r),(0,n.addBlock)(e,v);for(var b=[0],y=[0],_=r.zoomScale||1,C=function(e){var n=t.rows[e],a=v.rows[e],f=n.parentNode;(0,c.isNodeOfType)(f,"ELEMENT_NODE")&&((0,s.isElementOfType)(f,"tbody")||(0,s.isElementOfType)(f,"thead")||(0,s.isElementOfType)(f,"tfoot"))?(0,d.parseFormat)(f,r.formatParsers.tableRow,a.format,r):r.allowCacheElement&&(a.cachedElement=n),(0,d.parseFormat)(n,r.formatParsers.tableRow,a.format,r),(0,u.stackFormat)(r,{paragraph:"shallowClone",segment:"shallowClone"},(function(){var t=n.parentElement,s=null==t?void 0:t.tagName;!t||"TBODY"!=s&&"THEAD"!=s&&"TFOOT"!=s||((0,d.parseFormat)(t,r.formatParsers.block,r.blockFormat,r),(0,d.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r)),(0,d.parseFormat)(n,r.formatParsers.block,r.blockFormat,r),(0,d.parseFormat)(n,r.formatParsers.segmentOnBlock,r.segmentFormat,r);for(var c,f=function(t,s){for(;a.cells[s];s++);var f=n.cells[t],m=r.isInSelection,p=s+f.colSpan,C=e+f.rowSpan,P=void 0===b[p],S=void 0===y[C];if(P||S){var k=(0,i.getBoundingClientRect)(f);(k.width>0||k.height>0)&&(P&&(b[p]=b[s]+k.width/_),S&&(y[C]=y[e]+k.height/_))}(0,u.stackFormat)(r,{paragraph:"shallowClone",segment:"shallowClone"},(function(){(0,d.parseFormat)(f,r.formatParsers.block,r.blockFormat,r),(0,d.parseFormat)(f,r.formatParsers.segmentOnTableCell,r.segmentFormat,r);var t=(0,o.__assign)({},r.blockFormat),n={};(0,d.parseFormat)(f,r.formatParsers.tableCell,t,r),(0,d.parseFormat)(f,r.formatParsers.tableBorder,t,r),(0,d.parseFormat)(f,r.formatParsers.dataset,n,r);for(var a=1;a<=f.colSpan;a++,s++)for(var i=1;i<=f.rowSpan;i++){var c=1==a&&1==i,u=(0,l.createTableCell)(a>1,i>1,"TH"==f.tagName,t);u.dataset=(0,o.__assign)({},n);var p=v.rows[e+i-1];if(p&&(p.cells[s]=u),c){r.allowCacheElement&&(u.cachedElement=f);var b=r.listFormat,y=b.listParent,_=b.levels;r.listFormat.listParent=void 0,r.listFormat.levels=[];try{r.elementProcessors.child(u,f,r)}finally{r.listFormat.listParent=y,r.listFormat.levels=_}}var C=r.isInSelection;(m&&C||h&&g&&e>=g.firstRow&&e<=g.lastRow&&s>=g.firstColumn&&s<=g.lastColumn)&&(u.isSelected=!0)}})),c=s},m=0,p=0;m<n.cells.length;m++)f(m,p),p=c}));for(var m=0;m<a.cells.length;m++)a.cells[m]||(a.cells[m]=(0,l.createTableCell)(!1,!1,!1,r.blockFormat))},P=0;P<t.rows.length;P++)C(P);v.widths=f(b);var S=f(y);v.rows.forEach((function(e,t){S[t]>0&&(e.height=S[t])}))}))}},9892:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textProcessor=void 0;var o=r(3883),n=r(8513),a=r(9871),l=r(840),i=r(2101),s=r(8063),c=r(7084);t.textProcessor=function(e,t,r){var o,n=t.nodeValue||"",l=(0,s.getRegularSelectionOffsets)(r,t),c=l[0],d=l[1],f=[],m=(0,i.ensureParagraph)(e,r.blockFormat);if(c>=0){var p=n.substring(0,c);f.push(u(e,p,m,r)),r.isInSelection=!0,(0,a.addSelectionMarker)(e,r),n=n.substring(c),d-=c}d>=0&&(p=n.substring(0,d),f.push(u(e,p,m,r)),!r.selection||"range"==r.selection.type&&r.selection.range.collapsed||(0,a.addSelectionMarker)(e,r),r.isInSelection=!1,n=n.substring(d)),f.push(u(e,n,m,r)),null===(o=r.domIndexer)||void 0===o||o.onSegment(t,m,f.filter((function(e){return!!e})))};var d=["pre","pre-wrap","pre-line","break-spaces"];function u(e,t,r,a){var i,s;return t&&(!(0,c.hasSpacesOnly)(t)||(null!==(i=null==r?void 0:r.segments.length)&&void 0!==i?i:0)>0||d.indexOf((null==r?void 0:r.format.whiteSpace)||"")>=0)&&(s=(0,l.createText)(t,a.segmentFormat),a.isInSelection&&(s.isSelected=!0),(0,o.addDecorators)(s,a),(0,n.addSegment)(e,s,a.blockFormat)),s}},9871:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSelectionMarker=void 0;var o=r(3883),n=r(8513),a=r(5114);t.addSelectionMarker=function(e,t){var r=(0,a.createSelectionMarker)(t.segmentFormat);(0,o.addDecorators)(r,t),(0,n.addSegment)(e,r,t.blockFormat)}},8310:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areSameFormats=void 0;var o=r(3871);t.areSameFormats=function(e,t){if(e==t)return!0;var r=(0,o.getObjectKeys)(e),n=(0,o.getObjectKeys)(t);return r.length==n.length&&r.every((function(r){return e[r]==t[r]}))}},3095:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingClientRect=void 0,t.getBoundingClientRect=function(e){return e.getBoundingClientRect()}},3149:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultStyle=void 0;var o=r(1350);t.getDefaultStyle=function(e){var t=e.tagName.toLowerCase();return o.defaultHTMLStyleMap[t]||{}}},8063:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRegularSelectionOffsets=void 0,t.getRegularSelectionOffsets=function(e,t){var r,o="range"==(null===(r=e.selection)||void 0===r?void 0:r.type)?e.selection.range:null;return[(null==o?void 0:o.startContainer)==t?o.startOffset:-1,(null==o?void 0:o.endContainer)==t?o.endOffset:-1]}},2404:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBlockElement=void 0;var o=r(3149),n=["block","list-item","table","table-cell","flex"];t.isBlockElement=function(e){var t=e.style.display||(0,o.getDefaultStyle)(e).display||"";return n.indexOf(t)>=0}},9366:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseFormat=void 0;var o=r(3149);t.parseFormat=function(e,t,r,n){var a=(0,o.getDefaultStyle)(e);t.forEach((function(t){null==t||t(r,e,n,a)}))}},202:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stackFormat=void 0;var o=r(7582),n=r(3871),a=["backgroundColor"],l=["marginLeft","marginRight","paddingLeft","paddingRight"];function i(e,t){switch(t){case"empty":return{};case void 0:return e;default:var r=(0,o.__assign)({},e);return(0,n.getObjectKeys)(e).forEach((function(e){("shallowCloneForBlock"==t&&a.indexOf(e)>=0||"shallowCloneForGroup"==t&&l.indexOf(e)>=0)&&delete r[e]})),r}}t.stackFormat=function(e,t,r){var n,a=e.segmentFormat,l=e.blockFormat,s=e.link,c=e.code,d=e.blockDecorator,u=t.segment,f=t.paragraph,m=t.link,p=t.code,v=t.blockDecorator;try{e.segmentFormat=i(a,u),e.blockFormat=i(l,f),e.link=function(e,t){switch(t){case"linkDefault":return{format:{underline:!0},dataset:{}};case"empty":return{format:{},dataset:{}};default:return{dataset:e.dataset,format:(0,o.__assign)({},e.format)}}}(s,m),e.code=function(e,t){switch(t){case"codeDefault":return{format:{fontFamily:"monospace"}};case"empty":return{format:{}};default:return e}}(c,p),e.blockDecorator=(n=d,"empty"===v?{format:{},tagName:""}:n),r()}finally{e.segmentFormat=a,e.blockFormat=l,e.link=s,e.code=c,e.blockDecorator=d}}},2033:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDelimiters=t.isEntityDelimiter=t.generateEntityClassNames=t.parseEntityClassName=t.isEntityElement=void 0;var o=r(7960),n=r(3233),a="_Entity",l="_EType_",i="_EId_",s="_EReadonly_",c="entityDelimiterBefore",d="entityDelimiterAfter";function u(e,t,r){var o,n=e.createElement("span");return n.className=r?d:c,n.appendChild(e.createTextNode("​")),null===(o=t.parentNode)||void 0===o||o.insertBefore(n,r?t.nextSibling:t),n}t.isEntityElement=function(e){return(0,n.isNodeOfType)(e,"ELEMENT_NODE")&&e.classList.contains(a)},t.parseEntityClassName=function(e,t){if(e==a)return!0;0==e.indexOf(l)?t.entityType=e.substring(7):0==e.indexOf(i)?t.id=e.substring(5):0==e.indexOf(s)&&(t.isReadonly="1"==e.substring(11))},t.generateEntityClassNames=function(e){var t;return e.isFakeEntity?"":a+" "+l+(null!==(t=e.entityType)&&void 0!==t?t:"")+" "+(e.id?""+i+e.id+" ":"")+s+(e.isReadonly?"1":"0")},t.isEntityDelimiter=function(e){return(0,o.isElementOfType)(e,"span")&&(e.classList.contains(d)||e.classList.contains(c))&&"​"===e.textContent},t.addDelimiters=function(e,t){return[u(e,t,!0),u(e,t,!1)]}},3871:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getObjectKeys=void 0,t.getObjectKeys=function(e){return Object.keys(e)}},7960:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isElementOfType=void 0,t.isElementOfType=function(e,t){var r;return(null===(r=null==e?void 0:e.tagName)||void 0===r?void 0:r.toLocaleLowerCase())==t}},3233:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeOfType=void 0,t.isNodeOfType=function(e,t){return!!e&&e.nodeType==Node[t]}},6245:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasMetadata=t.updateMetadata=void 0;var o=r(5524),n="editingInfo";t.updateMetadata=function(e,t,r){var a=e.dataset[n],l=null;try{l=JSON.parse(a)}catch(e){}return r&&!(0,o.validate)(l,r)&&(l=null),t&&((l=t(l))?r&&!(0,o.validate)(l,r)||(e.dataset[n]=JSON.stringify(l)):delete e.dataset[n]),l},t.hasMetadata=function(e){return!!e.dataset[n]}},5524:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validate=void 0;var o=r(3871);t.validate=function e(t,r){var n,a,l=!1;if(r.isOptional&&void 0===t||r.allowNull&&null===t)l=!0;else{if(!r.isOptional&&void 0===t||!r.allowNull&&null===t)return!1;switch(r.type){case"string":l="string"==typeof t&&(void 0===r.value||t===r.value);break;case"number":l="number"==typeof t&&(void 0===r.value||(n=r.value,a=t,Math.abs(n-a)<.001))&&(void 0===r.minValue||t>=r.minValue)&&(void 0===r.maxValue||t<=r.maxValue);break;case"boolean":l="boolean"==typeof t&&(void 0===r.value||t===r.value);break;case"array":l=Array.isArray(t)&&(void 0===r.minLength||t.length>=r.minLength)&&(void 0===r.maxLength||t.length<=r.maxLength)&&t.every((function(t){return e(t,r.itemDef)}));break;case"object":l="object"==typeof t&&(0,o.getObjectKeys)(r.propertyDef).every((function(o){return e(t[o],r.propertyDef[o])}))}}return l}},4478:(e,t)=>{function r(e,t,r){if(e){for(;!r&&e.firstChild;)e.removeChild(e.firstChild);for(;null==t?void 0:t.firstChild;)e.appendChild(t.firstChild)}}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapAllChildNodes=t.moveChildNodes=void 0,t.moveChildNodes=r,t.wrapAllChildNodes=function(e,t){var o=e.ownerDocument.createElement(t);return r(o,e),e.appendChild(o),o}},6820:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return[].slice.call(e)}},9448:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=void 0,t.unwrap=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},8066:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrap=void 0,t.wrap=function(e,t,r){var o,n=e.createElement(r);return null===(o=t.parentNode)||void 0===o||o.insertBefore(n,t),n.appendChild(t),n}},9980:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.directionFormatHandler=void 0,t.directionFormatHandler={parse:function(e,t,r,o){var n=t.style.direction||t.dir||o.direction;n&&(e.direction="rtl"==n?"rtl":"ltr")},apply:function(e,t){e.direction&&(t.style.direction=e.direction)}}},1276:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.displayFormatHandler=void 0,t.displayFormatHandler={parse:function(e,t){var r=t.style.display;r&&(e.display=r)},apply:function(e,t){e.display&&(t.style.display=e.display)}}},7762:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.htmlAlignFormatHandler=void 0;var o=r(3612),n=r(9980);t.htmlAlignFormatHandler={parse:function(e,t,r,a){n.directionFormatHandler.parse(e,t,r,a);var l=t.getAttribute("align");l&&(e.htmlAlign=(0,o.calcAlign)(l,e.direction),delete e.textAlign,delete r.blockFormat.textAlign)},apply:function(e,t){var r="rtl"==e.direction?"rtl":"ltr";e.htmlAlign&&t.setAttribute("align",o.ResultMap[e.htmlAlign][r])}}},4652:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lineHeightFormatHandler=void 0,t.lineHeightFormatHandler={parse:function(e,t,r,o){var n=t.style.lineHeight||o.lineHeight;n&&"inherit"!=n&&(e.lineHeight=n)},apply:function(e,t){e.lineHeight&&(t.style.lineHeight=e.lineHeight)}}},4116:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.marginFormatHandler=void 0;var o=r(8704),n=["marginTop","marginRight","marginBottom","marginLeft"];t.marginFormatHandler={parse:function(e,t,r,a){n.forEach((function(r){var n=t.style[r]||a[r];if(n)switch(r){case"marginTop":case"marginBottom":e[r]=n;break;case"marginLeft":case"marginRight":e[r]=e[r]?(0,o.parseValueWithUnit)(e[r]||"",t)+(0,o.parseValueWithUnit)(n,t)+"px":n}}))},apply:function(e,t,r){n.forEach((function(o){var n=e[o];n!=r.implicitFormat[o]&&(t.style[o]=n||"0")}))}}},632:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.paddingFormatHandler=void 0;var r=["paddingTop","paddingRight","paddingBottom","paddingLeft"];t.paddingFormatHandler={parse:function(e,t){r.forEach((function(r){var o=t.style[r];o&&(e[r]=o)}))},apply:function(e,t){r.forEach((function(r){var o=e[r];o&&(t.style[r]=o)}))}}},9568:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textAlignFormatHandler=void 0;var o=r(3612),n=r(9980);t.textAlignFormatHandler={parse:function(e,t,r,a){var l;n.directionFormatHandler.parse(e,t,r,a);var i=t.style.textAlign||a.textAlign;"LI"==t.tagName&&"flex"===(null===(l=t.parentElement)||void 0===l?void 0:l.style.display)&&"column"===t.parentElement.style.flexDirection&&t.style.alignSelf&&(i=t.style.alignSelf),i&&(e.textAlign=(0,o.calcAlign)(i,e.direction))},apply:function(e,t){var r="rtl"==e.direction?"rtl":"ltr";if(e.textAlign){var n=t.parentElement,a=null==n?void 0:n.tagName;"LI"!=t.tagName||!n||"OL"!=a&&"UL"!=a?t.style.textAlign=o.ResultMap[e.textAlign][r]:(t.style.alignSelf=e.textAlign,t.parentElement.style.flexDirection="column",t.parentElement.style.display="flex")}}}},1167:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.whiteSpaceFormatHandler=void 0,t.whiteSpaceFormatHandler={parse:function(e,t,r,o){var n=t.style.whiteSpace||o.whiteSpace;n&&(e.whiteSpace=n)},apply:function(e,t,r){var o=r.implicitFormat.whiteSpace;e.whiteSpace!=o&&(t.style.whiteSpace=e.whiteSpace||"normal")}}},8891:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backgroundColorFormatHandler=void 0;var o=r(5150);t.backgroundColorFormatHandler={parse:function(e,t,r,n){var a=(0,o.getColor)(t,!0,r.darkColorHandler,!!r.isDarkMode)||n.backgroundColor;a&&(e.backgroundColor=a)},apply:function(e,t,r){e.backgroundColor&&(0,o.setColor)(t,e.backgroundColor,!0,r.darkColorHandler,!!r.isDarkMode)}}},5930:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.borderBoxFormatHandler=void 0,t.borderBoxFormatHandler={parse:function(e,t){var r;"border-box"==(null===(r=t.style)||void 0===r?void 0:r.boxSizing)&&(e.useBorderBox=!0)},apply:function(e,t){e.useBorderBox&&(t.style.boxSizing="border-box")}}},1136:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.borderFormatHandler=t.BorderKeys=void 0,t.BorderKeys=["borderTop","borderRight","borderBottom","borderLeft","borderRadius"],t.borderFormatHandler={parse:function(e,r){t.BorderKeys.forEach((function(t){var o=r.style[t];o&&(e[t]="none"==o?"":o)}))},apply:function(e,r){t.BorderKeys.forEach((function(t){var o=e[t];o&&(r.style[t]=o)}))}}},8577:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.boxShadowFormatHandler=void 0,t.boxShadowFormatHandler={parse:function(e,t){var r;(null===(r=t.style)||void 0===r?void 0:r.boxShadow)&&(e.boxShadow=t.style.boxShadow)},apply:function(e,t){e.boxShadow&&(t.style.boxShadow=e.boxShadow)}}},1453:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.datasetFormatHandler=void 0;var o=r(3871);t.datasetFormatHandler={parse:function(e,t){var r=t.dataset;(0,o.getObjectKeys)(r).forEach((function(t){e[t]=r[t]||""}))},apply:function(e,t){(0,o.getObjectKeys)(e).forEach((function(r){t.dataset[r]=e[r]}))}}},5432:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.floatFormatHandler=void 0,t.floatFormatHandler={parse:function(e,t){var r=t.style.float||t.getAttribute("align");r&&(e.float=r)},apply:function(e,t){e.float&&(t.style.float=e.float)}}},6883:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.idFormatHandler=void 0,t.idFormatHandler={parse:function(e,t){t.id&&(e.id=t.id)},apply:function(e,t){e.id&&(t.id=e.id)}}},7302:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sizeFormatHandler=void 0;var r=/[\d\.]+%/;function o(e,t){var o=e.getAttribute(t),n=parseInt(o||"");return o&&r.test(o)?o:Number.isNaN(n)?void 0:n+"px"}t.sizeFormatHandler={parse:function(e,t,r){var n=t.style.width||o(t,"width"),a=t.style.height||o(t,"height"),l=t.style.maxWidth,i=t.style.maxHeight,s=t.style.minWidth,c=t.style.minHeight;n&&(e.width=n),a&&(e.height=a),l&&(e.maxWidth=l),i&&(e.maxHeight=i),s&&(e.minWidth=s),c&&(e.minHeight=c)},apply:function(e,t){e.width&&(t.style.width=e.width),e.height&&(t.style.height=e.height),e.maxWidth&&(t.style.maxWidth=e.maxWidth),e.maxHeight&&(t.style.maxHeight=e.maxHeight),e.minWidth&&(t.style.minWidth=e.minWidth),e.minHeight&&(t.style.minHeight=e.minHeight)}}},8854:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.verticalAlignFormatHandler=void 0,t.verticalAlignFormatHandler={parse:function(e,t){switch(t.style.verticalAlign||t.getAttribute("valign")){case"baseline":case"initial":case"super":case"sub":case"text-top":case"text-bottom":case"top":e.verticalAlign="top";break;case"bottom":e.verticalAlign="bottom";break;case"middle":e.verticalAlign="middle"}},apply:function(e,t){e.verticalAlign&&(t.style.verticalAlign=e.verticalAlign)}}},4258:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wordBreakFormatHandler=void 0,t.wordBreakFormatHandler={parse:function(e,t,r,o){var n=t.style.wordBreak||o.wordBreak;n&&(e.wordBreak=n)},apply:function(e,t){e.wordBreak&&(t.style.wordBreak=e.wordBreak)}}},8659:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFormatAppliers=t.defaultFormatParsers=t.defaultFormatKeysPerCategory=void 0;var o=r(7582),n=r(8891),a=r(8707),l=r(5930),i=r(1136),s=r(8577),c=r(1453),d=r(9980),u=r(1276),f=r(2775),m=r(5432),p=r(7239),v=r(9101),g=r(3871),h=r(7762),b=r(6883),y=r(2647),_=r(3260),C=r(4652),P=r(7026),S=r(2128),k=r(9865),O=r(4325),T=r(4116),M=r(632),w=r(7302),E=r(6413),F=r(5855),x=r(746),j=r(461),B=r(9568),L=r(1268),D=r(5797),A=r(7506),I=r(8854),N=r(1167),R=r(4258),H={backgroundColor:n.backgroundColorFormatHandler,bold:a.boldFormatHandler,border:i.borderFormatHandler,borderBox:l.borderBoxFormatHandler,boxShadow:s.boxShadowFormatHandler,dataset:c.datasetFormatHandler,direction:d.directionFormatHandler,display:u.displayFormatHandler,float:m.floatFormatHandler,fontFamily:p.fontFamilyFormatHandler,fontSize:v.fontSizeFormatHandler,entity:f.entityFormatHandler,htmlAlign:h.htmlAlignFormatHandler,id:b.idFormatHandler,italic:y.italicFormatHandler,letterSpacing:_.letterSpacingFormatHandler,lineHeight:C.lineHeightFormatHandler,link:P.linkFormatHandler,listItemThread:S.listItemThreadFormatHandler,listLevelThread:k.listLevelThreadFormatHandler,listStyle:O.listStyleFormatHandler,margin:T.marginFormatHandler,padding:M.paddingFormatHandler,size:w.sizeFormatHandler,strike:E.strikeFormatHandler,superOrSubScript:F.superOrSubScriptFormatHandler,tableLayout:x.tableLayoutFormatHandler,tableSpacing:j.tableSpacingFormatHandler,textAlign:B.textAlignFormatHandler,textColor:L.textColorFormatHandler,textColorOnTableCell:D.textColorOnTableCellFormatHandler,underline:A.underlineFormatHandler,verticalAlign:I.verticalAlignFormatHandler,whiteSpace:N.whiteSpaceFormatHandler,wordBreak:R.wordBreakFormatHandler},W=["letterSpacing","fontFamily","fontSize"],z=["strike","underline","superOrSubScript","italic","bold"],G=["direction","textAlign","lineHeight","whiteSpace"],U=["backgroundColor","margin","padding","border"];t.defaultFormatKeysPerCategory={block:G,listItemThread:["listItemThread"],listLevelThread:["listLevelThread"],listItemElement:(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(G),!1),["direction","textAlign","lineHeight","margin","listStyle"],!1),listLevel:["direction","textAlign","margin","padding","listStyle","backgroundColor"],styleBasedSegment:(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(W),!1),["textColor","backgroundColor","lineHeight"],!1),elementBasedSegment:z,segment:(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(W),!1),(0,o.__read)(z),!1),["textColor","backgroundColor","lineHeight"],!1),segmentOnBlock:(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(W),!1),(0,o.__read)(z),!1),["textColor"],!1),segmentOnTableCell:(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(W),!1),(0,o.__read)(z),!1),["textColorOnTableCell"],!1),tableCell:["border","backgroundColor","padding","verticalAlign","wordBreak","textColor","htmlAlign","size"],tableRow:["backgroundColor"],table:["id","border","backgroundColor","display","htmlAlign","margin","size","tableLayout"],tableBorder:["borderBox","tableSpacing"],tableCellBorder:["borderBox"],image:["id","size","margin","padding","borderBox","border","boxShadow","display","float","verticalAlign"],link:["link","textColor","underline","display","margin","padding","backgroundColor","border","size","textAlign"],segmentUnderLink:["textColor"],code:["fontFamily","display"],dataset:["dataset"],divider:(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(G),!1),(0,o.__read)(U),!1),["display","size","htmlAlign"],!1),container:(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(U),!1),["htmlAlign","size","display"],!1),entity:["entity"]},t.defaultFormatParsers=(0,g.getObjectKeys)(H).reduce((function(e,t){return e[t]=H[t].parse,e}),{}),t.defaultFormatAppliers=(0,g.getObjectKeys)(H).reduce((function(e,t){return e[t]=H[t].apply,e}),{})},2775:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.entityFormatHandler=void 0;var o=r(2033);t.entityFormatHandler={parse:function(e,t){var r=!1;t.classList.forEach((function(t){r=(0,o.parseEntityClassName)(t,e)||r})),r||(e.isFakeEntity=!0,e.isReadonly=!t.isContentEditable)},apply:function(e,t){e.isFakeEntity||(t.className=(0,o.generateEntityClassNames)(e)),e.isReadonly?t.contentEditable="false":t.removeAttribute("contenteditable")}}},2128:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listItemThreadFormatHandler=void 0;var o=r(7960),n=r(3233);function a(e){return(0,o.isElementOfType)(e,"li")&&(0,n.isNodeOfType)(e.parentNode,"ELEMENT_NODE")&&(0,o.isElementOfType)(e.parentNode,"ol")}t.listItemThreadFormatHandler={parse:function(e,t,r,o){var n=r.listFormat,l=n.levels.length,i=t.style.display||o.display;i&&"list-item"!=i?e.displayForDummyItem=i:a(t)&&l>0&&(n.threadItemCounts[l-1]++,n.threadItemCounts.splice(l),n.levels.forEach((function(e){delete e.format.startNumberOverride})))},apply:function(e,t,r){var o;if(e.displayForDummyItem)t.style.display=e.displayForDummyItem;else if(a(t)){var n=r.listFormat,l=n.threadItemCounts,i=n.nodeStack.length-2;i>=0&&(l.splice(i+1),l[i]=(null!==(o=l[i])&&void 0!==o?o:0)+1)}}}},9865:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listLevelThreadFormatHandler=void 0;var o=r(7960);t.listLevelThreadFormatHandler={parse:function(e,t,r){if((0,o.isElementOfType)(t,"ol")){var n=r.listFormat,a=n.threadItemCounts,l=n.levels.length;"number"==typeof a[l]&&t.start!=a[l]+1&&(e.startNumberOverride=t.start),a[l]=t.start-1}},apply:function(e,t,r){var n=r.listFormat,a=n.threadItemCounts,l=n.nodeStack.length-2;if(l>=0&&(0,o.isElementOfType)(t,"ol")){var i=e.startNumberOverride;"number"==typeof i?a[l]=i-1:"number"!=typeof a[l]&&(a[l]=0),a.splice(l+1),t.start=a[l]+1}}}},4325:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listStyleFormatHandler=void 0,t.listStyleFormatHandler={parse:function(e,t){var r=t.style.listStylePosition,o=t.style.listStyleType;r&&(e.listStylePosition=r),o&&(e.listStyleType=o)},apply:function(e,t){e.listStylePosition&&(t.style.listStylePosition=e.listStylePosition),e.listStyleType&&(t.style.listStyleType=e.listStyleType)}}},8707:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.boldFormatHandler=void 0;var o=r(4478);t.boldFormatHandler={parse:function(e,t,r,o){var n=t.style.fontWeight||o.fontWeight;n&&(e.fontWeight=n)},apply:function(e,t,r){if(void 0!==e.fontWeight){var n=r.implicitFormat.fontWeight;(n&&n!=e.fontWeight||!n&&e.fontWeight&&"normal"!=e.fontWeight)&&("bold"==e.fontWeight?(0,o.wrapAllChildNodes)(t,"b"):t.style.fontWeight=e.fontWeight||"normal")}}}},7239:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fontFamilyFormatHandler=void 0,t.fontFamilyFormatHandler={parse:function(e,t,r,o){var n=t.style.fontFamily||o.fontFamily;n&&"inherit"!=n&&(e.fontFamily=n)},apply:function(e,t,r){e.fontFamily&&e.fontFamily!=r.implicitFormat.fontFamily&&(t.style.fontFamily=e.fontFamily)}}},9101:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fontSizeFormatHandler=void 0;var o=r(5855),n=r(8704);t.fontSizeFormatHandler={parse:function(e,t,r,l){var i=t.style.fontSize||l.fontSize,s=t.style.verticalAlign||l.verticalAlign;i&&!(0,o.isSuperOrSubScript)(i,s)&&"inherit"!=i&&(t.style.fontSize?e.fontSize=function(e,t){var r=a[e];if(r)return r;if("smaller"!=e&&"larger"!=e&&!e.endsWith("em")&&!e.endsWith("%"))return"inherit"==e||"revert"==e||"unset"==e?void 0:e;if(t){var o=(0,n.parseValueWithUnit)(t,void 0,"px");if(o)switch(e){case"smaller":return Math.round(500*o/6)/100+"px";case"larger":return Math.round(600*o/5)/100+"px";default:return(0,n.parseValueWithUnit)(e,o,"px")+"px"}}}(i,r.segmentFormat.fontSize):l.fontSize&&(e.fontSize=i))},apply:function(e,t,r){e.fontSize&&e.fontSize!=r.implicitFormat.fontSize&&(t.style.fontSize=e.fontSize)}};var a={"xx-small":"6.75pt","x-small":"7.5pt",small:"9.75pt",medium:"12pt",large:"13.5pt","x-large":"18pt","xx-large":"24pt","xxx-large":"36pt"}},2647:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.italicFormatHandler=void 0;var o=r(4478);t.italicFormatHandler={parse:function(e,t,r,o){var n=t.style.fontStyle||o.fontStyle;"italic"==n||"oblique"==n?e.italic=!0:"initial"!=n&&"normal"!=n||(e.italic=!1)},apply:function(e,t,r){void 0!==e.italic&&!!r.implicitFormat.italic!=!!e.italic&&(e.italic?(0,o.wrapAllChildNodes)(t,"i"):t.style.fontStyle="normal")}}},3260:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.letterSpacingFormatHandler=void 0,t.letterSpacingFormatHandler={parse:function(e,t,r,o){var n=t.style.letterSpacing||o.letterSpacing;n&&(e.letterSpacing=n)},apply:function(e,t,r){e.letterSpacing&&(t.style.letterSpacing=e.letterSpacing)}}},7026:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.linkFormatHandler=void 0;var o=r(7960);t.linkFormatHandler={parse:function(e,t){if((0,o.isElementOfType)(t,"a")){var r=t.name,n=t.getAttribute("href"),a=t.target,l=t.rel,i=t.id,s=t.className,c=t.title;r&&(e.name=r),n&&(e.href=n),a&&(e.target=a),i&&(e.anchorId=i),l&&(e.relationship=l),c&&(e.anchorTitle=c),s&&(e.anchorClass=s)}},apply:function(e,t){(0,o.isElementOfType)(t,"a")&&e.href&&(t.href=e.href,e.name&&(t.name=e.name),e.target&&(t.target=e.target),e.anchorId&&(t.id=e.anchorId),e.anchorClass&&(t.className=e.anchorClass),e.anchorTitle&&(t.title=e.anchorTitle),e.relationship&&(t.rel=e.relationship))}}},6413:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.strikeFormatHandler=void 0;var o=r(4478);t.strikeFormatHandler={parse:function(e,t,r,o){var n=t.style.textDecoration||o.textDecoration;(null==n?void 0:n.indexOf("line-through"))>=0&&(e.strikethrough=!0)},apply:function(e,t){e.strikethrough&&(0,o.wrapAllChildNodes)(t,"s")}}},5855:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSuperOrSubScript=t.superOrSubScriptFormatHandler=void 0;var o=r(4478);function n(e,t){return"smaller"==e&&("sub"==t||"super"==t)}t.superOrSubScriptFormatHandler={parse:function(e,t,r,o){var a=t.style.verticalAlign||o.verticalAlign;n(t.style.fontSize||o.fontSize,a)&&(e.superOrSubScriptSequence=(e.superOrSubScriptSequence||"").split(" ").concat(a).join(" ").trim())},apply:function(e,t){e.superOrSubScriptSequence&&e.superOrSubScriptSequence.split(" ").reverse().forEach((function(e){var r="super"==e?"sup":"sub"==e?"sub":null;r&&(0,o.wrapAllChildNodes)(t,r)}))}},t.isSuperOrSubScript=n},1268:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textColorFormatHandler=void 0;var o=r(5150);t.textColorFormatHandler={parse:function(e,t,r,n){var a=(0,o.getColor)(t,!1,r.darkColorHandler,!!r.isDarkMode)||n.color;a&&"inherit"!=a&&(e.textColor=a)},apply:function(e,t,r){var n=r.implicitFormat.textColor;e.textColor&&e.textColor!=n&&(0,o.setColor)(t,e.textColor,!1,r.darkColorHandler,!!r.isDarkMode)}}},7506:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.underlineFormatHandler=void 0;var o=r(4478);t.underlineFormatHandler={parse:function(e,t,r,o){var n=t.style.textDecoration||o.textDecoration;(null==n?void 0:n.indexOf("underline"))>=0?e.underline=!0:"A"==t.tagName&&"none"==n&&(e.underline=!1)},apply:function(e,t,r){void 0!==e.underline&&!!r.implicitFormat.underline!=!!e.underline&&(e.underline?(0,o.wrapAllChildNodes)(t,"u"):t.style.textDecoration="none")}}},746:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tableLayoutFormatHandler=void 0,t.tableLayoutFormatHandler={parse:function(e,t){var r=t.style.tableLayout;r&&"inherit"!=r&&(e.tableLayout=r)},apply:function(e,t){e.tableLayout&&(t.style.tableLayout=e.tableLayout)}}},461:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tableSpacingFormatHandler=void 0;var r="collapse";t.tableSpacingFormatHandler={parse:function(e,t){t.style.borderCollapse==r&&(e.borderCollapse=!0)},apply:function(e,t){e.borderCollapse&&(t.style.borderCollapse=r,t.style.borderSpacing="0",t.style.boxSizing="border-box")}}},5797:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textColorOnTableCellFormatHandler=void 0,t.textColorOnTableCellFormatHandler={parse:function(e,t){t.style.color&&delete e.textColor},apply:function(){}}},5150:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setColor=t.getColor=t.DeprecatedColors=void 0,t.DeprecatedColors=["inactiveborder","activeborder","inactivecaptiontext","inactivecaption","activecaption","appworkspace","infobackground","background","buttonhighlight","buttonshadow","captiontext","infotext","menutext","menu","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedfhadow","windowtext","windowframe","window"],t.getColor=function(e,r,o,n){var a=(r?e.style.backgroundColor:e.style.color)||e.getAttribute(r?"bgcolor":"color")||void 0;return a&&t.DeprecatedColors.indexOf(a)>-1&&(a=void 0),o&&(a=o.parseColorValue(a,n).lightModeColor),a},t.setColor=function(e,t,r,o,n){var a=o?o.registerColor(t,n):t;r?e.style.backgroundColor=a:e.style.color=a}},3612:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calcAlign=t.ResultMap=void 0,t.ResultMap={start:{ltr:"left",rtl:"right"},center:{ltr:"center",rtl:"center"},end:{ltr:"right",rtl:"left"},initial:{ltr:"initial",rtl:"initial"},justify:{ltr:"justify",rtl:"justify"}},t.calcAlign=function(e,t){switch(e){case"center":return"center";case"left":return"rtl"==t?"end":"start";case"right":return"rtl"==t?"start":"end";case"start":case"end":case"justify":case"initial":return e;default:return}}},8704:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseValueWithUnit=void 0;var o=r(7582),n=/(-?\d+(\.\d+)?)([a-z]+|%)/;function a(e){var t,r;if(void 0===e)return 0;if("number"==typeof e)return e;var o=null!==(r=null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e).fontSize)&&void 0!==r?r:"";return l(parseFloat(o))}function l(e){return Math.round(4e3*e/3)/1e3}t.parseValueWithUnit=function(e,t,r){void 0===e&&(e=""),void 0===r&&(r="px");var i,s=n.exec(e),c=0;if(s){var d=(0,o.__read)(s,4),u=(d[0],d[1]),f=(d[2],d[3]),m=parseFloat(u);switch(f){case"px":c=m;break;case"pt":c=l(m);break;case"em":c=a(t)*m;break;case"ex":c=a(t)*m/2;break;case"%":c=a(t)*m/100}}return c>0&&"pt"==r&&(i=c,c=Math.round(3e3*i/4)/1e3),c}},1246:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BorderKeys=t.parseValueWithUnit=t.setParagraphNotImplicit=t.applySegmentFormatToElement=t.normalizeSingleSegment=t.isWhiteSpacePreserved=t.addSegment=t.unwrapBlock=t.isGeneralSegment=t.normalizeContentModel=t.ensureParagraph=t.addLink=t.addCode=t.addBlock=t.createListLevel=t.createDivider=t.createEntity=t.createGeneralBlock=t.createGeneralSegment=t.createParagraphDecorator=t.createContentModelDocument=t.createImage=t.createText=t.createTableCell=t.createTable=t.createSelectionMarker=t.createParagraph=t.createFormatContainer=t.createListItem=t.createBr=t.wrap=t.wrapAllChildNodes=t.moveChildNodes=t.toArray=t.getObjectKeys=t.isElementOfType=t.isNodeOfType=t.hasMetadata=t.updateMetadata=t.isBlockElement=t.areSameFormats=t.parseFormat=t.getRegularSelectionOffsets=t.tableProcessor=t.entityProcessor=t.processChildNode=t.handleRegularSelection=t.childProcessor=t.contentModelToDom=t.domToContentModel=void 0,t.createModelToDomConfig=t.createModelToDomContextWithConfig=t.createModelToDomContext=t.createDomToModelConfig=t.createDomToModelContextWithConfig=t.createDomToModelContext=t.DeprecatedColors=void 0;var o=r(1807);Object.defineProperty(t,"domToContentModel",{enumerable:!0,get:function(){return o.domToContentModel}});var n=r(4266);Object.defineProperty(t,"contentModelToDom",{enumerable:!0,get:function(){return n.contentModelToDom}});var a=r(9384);Object.defineProperty(t,"childProcessor",{enumerable:!0,get:function(){return a.childProcessor}}),Object.defineProperty(t,"handleRegularSelection",{enumerable:!0,get:function(){return a.handleRegularSelection}}),Object.defineProperty(t,"processChildNode",{enumerable:!0,get:function(){return a.processChildNode}});var l=r(6905);Object.defineProperty(t,"entityProcessor",{enumerable:!0,get:function(){return l.entityProcessor}});var i=r(970);Object.defineProperty(t,"tableProcessor",{enumerable:!0,get:function(){return i.tableProcessor}});var s=r(8063);Object.defineProperty(t,"getRegularSelectionOffsets",{enumerable:!0,get:function(){return s.getRegularSelectionOffsets}});var c=r(9366);Object.defineProperty(t,"parseFormat",{enumerable:!0,get:function(){return c.parseFormat}});var d=r(8310);Object.defineProperty(t,"areSameFormats",{enumerable:!0,get:function(){return d.areSameFormats}});var u=r(2404);Object.defineProperty(t,"isBlockElement",{enumerable:!0,get:function(){return u.isBlockElement}});var f=r(6245);Object.defineProperty(t,"updateMetadata",{enumerable:!0,get:function(){return f.updateMetadata}}),Object.defineProperty(t,"hasMetadata",{enumerable:!0,get:function(){return f.hasMetadata}});var m=r(3233);Object.defineProperty(t,"isNodeOfType",{enumerable:!0,get:function(){return m.isNodeOfType}});var p=r(7960);Object.defineProperty(t,"isElementOfType",{enumerable:!0,get:function(){return p.isElementOfType}});var v=r(3871);Object.defineProperty(t,"getObjectKeys",{enumerable:!0,get:function(){return v.getObjectKeys}});var g=r(6820);Object.defineProperty(t,"toArray",{enumerable:!0,get:function(){return g.default}});var h=r(4478);Object.defineProperty(t,"moveChildNodes",{enumerable:!0,get:function(){return h.moveChildNodes}}),Object.defineProperty(t,"wrapAllChildNodes",{enumerable:!0,get:function(){return h.wrapAllChildNodes}});var b=r(8066);Object.defineProperty(t,"wrap",{enumerable:!0,get:function(){return b.wrap}});var y=r(7826);Object.defineProperty(t,"createBr",{enumerable:!0,get:function(){return y.createBr}});var _=r(7724);Object.defineProperty(t,"createListItem",{enumerable:!0,get:function(){return _.createListItem}});var C=r(2766);Object.defineProperty(t,"createFormatContainer",{enumerable:!0,get:function(){return C.createFormatContainer}});var P=r(5092);Object.defineProperty(t,"createParagraph",{enumerable:!0,get:function(){return P.createParagraph}});var S=r(5114);Object.defineProperty(t,"createSelectionMarker",{enumerable:!0,get:function(){return S.createSelectionMarker}});var k=r(988);Object.defineProperty(t,"createTable",{enumerable:!0,get:function(){return k.createTable}});var O=r(1160);Object.defineProperty(t,"createTableCell",{enumerable:!0,get:function(){return O.createTableCell}});var T=r(840);Object.defineProperty(t,"createText",{enumerable:!0,get:function(){return T.createText}});var M=r(5566);Object.defineProperty(t,"createImage",{enumerable:!0,get:function(){return M.createImage}});var w=r(5733);Object.defineProperty(t,"createContentModelDocument",{enumerable:!0,get:function(){return w.createContentModelDocument}});var E=r(24);Object.defineProperty(t,"createParagraphDecorator",{enumerable:!0,get:function(){return E.createParagraphDecorator}});var F=r(8885);Object.defineProperty(t,"createGeneralSegment",{enumerable:!0,get:function(){return F.createGeneralSegment}});var x=r(9237);Object.defineProperty(t,"createGeneralBlock",{enumerable:!0,get:function(){return x.createGeneralBlock}});var j=r(1033);Object.defineProperty(t,"createEntity",{enumerable:!0,get:function(){return j.createEntity}});var B=r(7110);Object.defineProperty(t,"createDivider",{enumerable:!0,get:function(){return B.createDivider}});var L=r(1285);Object.defineProperty(t,"createListLevel",{enumerable:!0,get:function(){return L.createListLevel}});var D=r(9275);Object.defineProperty(t,"addBlock",{enumerable:!0,get:function(){return D.addBlock}});var A=r(3883);Object.defineProperty(t,"addCode",{enumerable:!0,get:function(){return A.addCode}});var I=r(3883);Object.defineProperty(t,"addLink",{enumerable:!0,get:function(){return I.addLink}});var N=r(2101);Object.defineProperty(t,"ensureParagraph",{enumerable:!0,get:function(){return N.ensureParagraph}});var R=r(8767);Object.defineProperty(t,"normalizeContentModel",{enumerable:!0,get:function(){return R.normalizeContentModel}});var H=r(183);Object.defineProperty(t,"isGeneralSegment",{enumerable:!0,get:function(){return H.isGeneralSegment}});var W=r(5960);Object.defineProperty(t,"unwrapBlock",{enumerable:!0,get:function(){return W.unwrapBlock}});var z=r(8513);Object.defineProperty(t,"addSegment",{enumerable:!0,get:function(){return z.addSegment}});var G=r(3897);Object.defineProperty(t,"isWhiteSpacePreserved",{enumerable:!0,get:function(){return G.isWhiteSpacePreserved}});var U=r(3393);Object.defineProperty(t,"normalizeSingleSegment",{enumerable:!0,get:function(){return U.normalizeSingleSegment}});var K=r(6195);Object.defineProperty(t,"applySegmentFormatToElement",{enumerable:!0,get:function(){return K.applySegmentFormatToElement}});var V=r(3963);Object.defineProperty(t,"setParagraphNotImplicit",{enumerable:!0,get:function(){return V.setParagraphNotImplicit}});var q=r(8704);Object.defineProperty(t,"parseValueWithUnit",{enumerable:!0,get:function(){return q.parseValueWithUnit}});var $=r(1136);Object.defineProperty(t,"BorderKeys",{enumerable:!0,get:function(){return $.BorderKeys}});var X=r(5150);Object.defineProperty(t,"DeprecatedColors",{enumerable:!0,get:function(){return X.DeprecatedColors}});var Y=r(9968);Object.defineProperty(t,"createDomToModelContext",{enumerable:!0,get:function(){return Y.createDomToModelContext}}),Object.defineProperty(t,"createDomToModelContextWithConfig",{enumerable:!0,get:function(){return Y.createDomToModelContextWithConfig}}),Object.defineProperty(t,"createDomToModelConfig",{enumerable:!0,get:function(){return Y.createDomToModelConfig}});var Q=r(8530);Object.defineProperty(t,"createModelToDomContext",{enumerable:!0,get:function(){return Q.createModelToDomContext}}),Object.defineProperty(t,"createModelToDomContextWithConfig",{enumerable:!0,get:function(){return Q.createModelToDomContextWithConfig}}),Object.defineProperty(t,"createModelToDomConfig",{enumerable:!0,get:function(){return Q.createModelToDomConfig}})},3963:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setParagraphNotImplicit=void 0,t.setParagraphNotImplicit=function(e){"Paragraph"==e.blockType&&e.isImplicit&&(e.isImplicit=!1)}},9275:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addBlock=void 0,t.addBlock=function(e,t){e.blocks.push(t)}},3883:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDecorators=t.addCode=t.addLink=void 0;var o=r(7582);function n(e,t){t.format.href&&(e.link={format:(0,o.__assign)({},t.format),dataset:(0,o.__assign)({},t.dataset)})}function a(e,t){t.format.fontFamily&&(e.code={format:(0,o.__assign)({},t.format)})}t.addLink=n,t.addCode=a,t.addDecorators=function(e,t){n(e,t.link),a(e,t.code)}},8513:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSegment=void 0;var o=r(2101);t.addSegment=function(e,t,r){var n=(0,o.ensureParagraph)(e,r),a=n.segments[n.segments.length-1];return"SelectionMarker"==t.segmentType?a&&a.isSelected||n.segments.push(t):(t.isSelected&&"SelectionMarker"==(null==a?void 0:a.segmentType)&&n.segments.pop(),n.segments.push(t)),n}},6195:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applySegmentFormatToElement=void 0;var o=r(7908),n=r(8530);t.applySegmentFormatToElement=function(e,t){var r=(0,n.createModelToDomContext)();(0,o.applyFormat)(e,r.formatAppliers.segment,t,r)}},2101:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ensureParagraph=void 0;var o=r(9275),n=r(5092);t.ensureParagraph=function(e,t){var r=e.blocks[e.blocks.length-1];if("Paragraph"==(null==r?void 0:r.blockType))return r;var a=(0,n.createParagraph)(!0,t);return(0,o.addBlock)(e,a),a}},7084:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasSpacesOnly=void 0;var r=/^[\r\n\t ]*$/;t.hasSpacesOnly=function(e){return r.test(e)}},4451:(e,t)=>{function r(e){switch(e.blockType){case"Paragraph":return 0==e.segments.length;case"Table":return e.rows.every((function(e){return 0==e.cells.length}));case"BlockGroup":return o(e);default:return!1}}function o(e){switch(e.blockGroupType){case"FormatContainer":return"div"!=e.tagName&&e.blocks.every(r);case"ListItem":return e.blocks.every(r);case"Document":case"General":case"TableCell":return!1;default:return!0}}function n(e){switch(e.segmentType){case"Text":return!e.text;case"Image":return!e.src;default:return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmpty=t.isSegmentEmpty=t.isBlockGroupEmpty=t.isBlockEmpty=void 0,t.isBlockEmpty=r,t.isBlockGroupEmpty=o,t.isSegmentEmpty=n,t.isEmpty=function(e){return function(e){return"string"==typeof e.blockGroupType}(e)?o(e):function(e){return"string"==typeof e.blockType}(e)?r(e):!!function(e){return"string"==typeof e.segmentType}(e)&&n(e)}},183:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isGeneralSegment=void 0,t.isGeneralSegment=function(e){return"General"==e.blockGroupType&&"General"==e.segmentType}},3897:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isWhiteSpacePreserved=void 0;var r=["pre","pre-wrap","break-spaces"];t.isWhiteSpacePreserved=function(e){return e.format.whiteSpace&&r.indexOf(e.format.whiteSpace)>=0||!1}},8767:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeContentModel=void 0;var o=r(4451),n=r(4858),a=r(5960);t.normalizeContentModel=function e(t){for(var r=t.blocks.length-1;r>=0;r--){var l=t.blocks[r];switch(l.blockType){case"BlockGroup":"ListItem"==l.blockGroupType&&0==l.levels.length?(r+=l.blocks.length,(0,a.unwrapBlock)(t,l)):e(l);break;case"Paragraph":(0,n.normalizeParagraph)(l);break;case"Table":for(var i=0;i<l.rows.length;i++)for(var s=0;s<l.rows[i].cells.length;s++)l.rows[i].cells[s]&&e(l.rows[i].cells[s])}(0,o.isBlockEmpty)(l)&&t.blocks.splice(r,1)}}},4858:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeParagraph=void 0;var o=r(8310),n=r(7826),a=r(4451),l=r(3897),i=r(3393);t.normalizeParagraph=function(e){var t=e.segments;if(!e.isImplicit&&t.length>0){var r=t[t.length-1],s=t[t.length-2];if("SelectionMarker"!=r.segmentType||s&&"Br"!=s.segmentType){if(t.length>1&&"Br"==t[t.length-1].segmentType){var c=t.filter((function(e){return"SelectionMarker"!=e.segmentType}));c.length>1&&"Br"!=c[c.length-2].segmentType&&t.pop()}}else t.push((0,n.createBr)(r.format))}(0,l.isWhiteSpacePreserved)(e)||(0,i.normalizeAllSegments)(e),function(e){var t=e.segments.find((function(e){return"SelectionMarker"==e.segmentType}));if(t){var r=e.segments.indexOf(t),n=e.segments[r-1],a=e.segments[r+1];(n&&!n.link&&(0,o.areSameFormats)(n.format,t.format)&&(!a||!a.link&&(0,o.areSameFormats)(a.format,t.format))&&t.link||!n&&t.link&&a&&!a.link&&(0,o.areSameFormats)(a.format,t.format))&&delete t.link}}(e),function(e){for(var t=e.segments.length-1;t>=0;t--)(0,a.isSegmentEmpty)(e.segments[t])&&e.segments.splice(t,1)}(e)}},3393:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeSegment=t.createNormalizeSegmentContext=t.normalizeSingleSegment=t.normalizeAllSegments=void 0;var o=r(7084),n=" ",a=" ",l=/^\u0020+/,i=/\u0020+$/;function s(e){return Object.assign(null!=e?e:{},{textSegments:[],ignoreLeadingSpaces:!0,ignoreTrailingSpaces:!0,lastInlineSegment:void 0,lastTextSegment:void 0})}function c(e,t){switch(e.segmentType){case"Br":d(t.textSegments,t.lastInlineSegment),u(t.lastTextSegment,t.lastInlineSegment),s(t);break;case"Entity":case"General":case"Image":t.lastInlineSegment=e,t.ignoreLeadingSpaces=!1;break;case"Text":t.textSegments.push(e),t.lastInlineSegment=e,t.lastTextSegment=e;var r=e.text.substring(0,1),c=e.text.substr(-1);(0,o.hasSpacesOnly)(e.text)||(r==n&&(e.text=e.text.replace(l,t.ignoreLeadingSpaces?"":a)),c==n&&(e.text=e.text.replace(i,t.ignoreTrailingSpaces?n:a))),t.ignoreLeadingSpaces=c==n}}function d(e,t){e.forEach((function(e){if(e!=t){var r=e.text;r.substr(-1)==a&&r.length>1&&r.substr(-2,1)!=n&&(e.text=r.substring(0,r.length-1)+n)}}))}function u(e,t){e&&e==t&&(null==e?void 0:e.text.substr(-1))==n&&(e.text=e.text.replace(i,""))}t.normalizeAllSegments=function(e){var t=s();e.segments.forEach((function(e){c(e,t)})),d(t.textSegments,t.lastInlineSegment),u(t.lastTextSegment,t.lastInlineSegment)},t.normalizeSingleSegment=function(e,t){void 0===t&&(t=!1);var r=s();r.ignoreTrailingSpaces=t,c(e,r)},t.createNormalizeSegmentContext=function(){return s()},t.normalizeSegment=c},5960:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unwrapBlock=void 0;var o=r(7582),n=r(3963);t.unwrapBlock=function(e,t){var r,a,l=null!==(a=null==e?void 0:e.blocks.indexOf(t))&&void 0!==a?a:-1;l>=0&&(t.blocks.forEach(n.setParagraphNotImplicit),null==e||(r=e.blocks).splice.apply(r,(0,o.__spreadArray)([l,1],(0,o.__read)(t.blocks),!1)))}},7826:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createBr=void 0;var o=r(7582);t.createBr=function(e){return{segmentType:"Br",format:e?(0,o.__assign)({},e):{}}}},5733:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelDocument=void 0,t.createContentModelDocument=function(e){var t={blockGroupType:"Document",blocks:[]};return e&&(t.format=e),t}},7110:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDivider=void 0;var o=r(7582);t.createDivider=function(e,t){return{blockType:"Divider",tagName:e,format:t?(0,o.__assign)({},t):{}}}},1033:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEntity=void 0;var o=r(7582);t.createEntity=function(e,t,r,n,a){return void 0===t&&(t=!0),{segmentType:"Entity",blockType:"Entity",format:(0,o.__assign)({},r),entityFormat:{id:a,entityType:n,isReadonly:t},wrapper:e}}},2766:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createFormatContainer=void 0;var o=r(7582);t.createFormatContainer=function(e,t){return{blockType:"BlockGroup",blockGroupType:"FormatContainer",tagName:e,blocks:[],format:(0,o.__assign)({},t||{})}}},9237:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneralBlock=void 0,t.createGeneralBlock=function(e){return{blockType:"BlockGroup",blockGroupType:"General",element:e,blocks:[],format:{}}}},8885:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneralSegment=void 0;var o=r(7582);t.createGeneralSegment=function(e,t){return{blockType:"BlockGroup",blockGroupType:"General",segmentType:"General",format:t?(0,o.__assign)({},t):{},blocks:[],element:e}}},5566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createImage=void 0;var o=r(7582);t.createImage=function(e,t){return{segmentType:"Image",src:e,format:t?(0,o.__assign)({},t):{},dataset:{}}}},7724:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createListItem=void 0;var o=r(1285),n=r(5114);t.createListItem=function(e,t){return{blockType:"BlockGroup",blockGroupType:"ListItem",blocks:[],levels:e?e.map((function(e){return(0,o.createListLevel)(e.listType,e.format,e.dataset)})):[],formatHolder:(0,n.createSelectionMarker)(t),format:{}}}},1285:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createListLevel=void 0;var o=r(7582);t.createListLevel=function(e,t,r){return{listType:e,format:(0,o.__assign)({},t),dataset:(0,o.__assign)({},r)}}},5092:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createParagraph=void 0;var o=r(7582);t.createParagraph=function(e,t,r,n){var a={blockType:"Paragraph",segments:[],format:t?(0,o.__assign)({},t):{}};return r&&Object.keys(r).length>0&&(a.segmentFormat=(0,o.__assign)({},r)),e&&(a.isImplicit=!0),n&&(a.decorator={tagName:n.tagName,format:(0,o.__assign)({},n.format)}),a}},24:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createParagraphDecorator=void 0;var o=r(7582);t.createParagraphDecorator=function(e,t){return{tagName:e.toLocaleLowerCase(),format:(0,o.__assign)({},t||{})}}},5114:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionMarker=void 0;var o=r(7582);t.createSelectionMarker=function(e){return{segmentType:"SelectionMarker",isSelected:!0,format:e?(0,o.__assign)({},e):{}}}},988:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTable=void 0;var o=r(7582);t.createTable=function(e,t){for(var r=[],n=0;n<e;n++)r.push({height:0,format:{},cells:[]});return{blockType:"Table",rows:r,format:(0,o.__assign)({},t||{}),widths:[],dataset:{}}}},1160:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTableCell=void 0;var o=r(7582);t.createTableCell=function(e,t,r,n){var a="number"==typeof e?e>1:!!e,l="number"==typeof t?t>1:!!t;return{blockGroupType:"TableCell",blocks:[],format:n?(0,o.__assign)({},n):{},spanLeft:a,spanAbove:l,isHeader:!!r,dataset:{}}}},840:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createText=void 0;var o=r(7582),n=r(3883);t.createText=function(e,t,r,a){var l={segmentType:"Text",text:e,format:t?(0,o.__assign)({},t):{}};return r&&(0,n.addLink)(l,r),a&&(0,n.addCode)(l,a),l}},4266:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contentModelToDom=void 0;var o=r(6820),n=r(3233);function a(e){var t,r,a,l;if(e.block&&(e.segment?(0,n.isNodeOfType)(e.segment,"TEXT_NODE")?l={container:e.segment,offset:(null===(t=e.segment.nodeValue)||void 0===t?void 0:t.length)||0}:e.segment.parentNode&&(l={container:e.segment.parentNode,offset:(0,o.default)(e.segment.parentNode.childNodes).indexOf(e.segment)+1}):l={container:e.block,offset:0}),l&&(0,n.isNodeOfType)(l.container,"DOCUMENT_FRAGMENT_NODE")){var i=l.container.childNodes;if(i.length>l.offset)l={container:i[l.offset],offset:0};else if(l.container.lastChild){var s=l.container.lastChild;l={container:s,offset:(0,n.isNodeOfType)(s,"TEXT_NODE")?null!==(a=null===(r=s.nodeValue)||void 0===r?void 0:r.length)&&void 0!==a?a:0:s.childNodes.length}}else l=void 0}return l}t.contentModelToDom=function(e,t,r,o,n){o.onNodeCreated=n,o.modelHandlers.blockGroupChildren(e,t,r,o);var l=function(e,t){var r,o,n=t.regularSelection,l=n.start,i=n.end,s=t.tableSelection,c=t.imageSelection;if(c)return c;if((r=l&&a(l))&&(o=i&&a(i))){var d=e.createRange();return d.setStart(r.container,r.offset),d.setEnd(o.container,o.offset),{type:"range",range:d}}return s||null}(e,o);return t.normalize(),l}},8530:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildFormatAppliers=t.createModelToDomConfig=t.createModelToDomContextWithConfig=t.createModelToDomContext=void 0;var o=r(7582),n=r(9550),a=r(3871),l=r(8659);function i(e,t){return Object.assign({},t,{regularSelection:{current:{block:null,segment:null}}},{listFormat:{threadItemCounts:[],nodeStack:[]},implicitFormat:{}},e)}function s(e){return{modelHandlers:Object.assign.apply(Object,(0,o.__spreadArray)([{},n.defaultContentModelHandlers],(0,o.__read)(e.map((function(e){return null==e?void 0:e.modelHandlerOverride}))),!1)),formatAppliers:c(e.map((function(e){return null==e?void 0:e.formatApplierOverride})),e.map((function(e){return null==e?void 0:e.additionalFormatAppliers}))),defaultModelHandlers:n.defaultContentModelHandlers,defaultFormatAppliers:l.defaultFormatAppliers,metadataAppliers:Object.assign.apply(Object,(0,o.__spreadArray)([{}],(0,o.__read)(e.map((function(e){return null==e?void 0:e.metadataAppliers}))),!1))}}function c(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var r=Object.assign.apply(Object,(0,o.__spreadArray)([{}],(0,o.__read)(e),!1));return(0,a.getObjectKeys)(l.defaultFormatKeysPerCategory).reduce((function(e,n){var a,i=(a=l.defaultFormatKeysPerCategory[n].map((function(e){return void 0===r[e]?l.defaultFormatAppliers[e]:r[e]}))).concat.apply(a,(0,o.__spreadArray)([],(0,o.__read)(t.map((function(e){var t;return null!==(t=null==e?void 0:e[n])&&void 0!==t?t:[]}))),!1));return e[n]=i,e}),{})}t.createModelToDomContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return i(s(t),e)},t.createModelToDomContextWithConfig=i,t.createModelToDomConfig=s,t.buildFormatAppliers=c},9550:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultContentModelHandlers=void 0;var o=r(3377),n=r(7352),a=r(6830),l=r(1379),i=r(736),s=r(740),c=r(3035),d=r(1920),u=r(3378),f=r(6026),m=r(1351),p=r(3913),v=r(1596),g=r(8109),h=r(8906);t.defaultContentModelHandlers={block:o.handleBlock,blockGroupChildren:n.handleBlockGroupChildren,br:a.handleBr,entityBlock:i.handleEntityBlock,entitySegment:i.handleEntitySegment,generalBlock:c.handleGeneralBlock,generalSegment:c.handleGeneralSegment,divider:l.handleDivider,image:d.handleImage,list:u.handleList,listItem:f.handleListItem,paragraph:m.handleParagraph,formatContainer:s.handleFormatContainer,segment:p.handleSegment,segmentDecorator:v.handleSegmentDecorator,table:g.handleTable,text:h.handleText}},3377:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleBlock=void 0,t.handleBlock=function(e,t,r,o,n){var a=o.modelHandlers;switch(r.blockType){case"Table":n=a.table(e,t,r,o,n);break;case"Paragraph":n=a.paragraph(e,t,r,o,n);break;case"Entity":n=a.entityBlock(e,t,r,o,n);break;case"Divider":n=a.divider(e,t,r,o,n);break;case"BlockGroup":switch(r.blockGroupType){case"General":n=a.generalBlock(e,t,r,o,n);break;case"FormatContainer":n=a.formatContainer(e,t,r,o,n);break;case"ListItem":n=a.listItem(e,t,r,o,n)}}return n}},7352:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleBlockGroupChildren=void 0,t.handleBlockGroupChildren=function(e,t,r,o){var n,a=o.listFormat,l=a.nodeStack,i=t.firstChild;try{for(r.blocks.forEach((function(r,n){0!=n&&"BlockGroup"==r.blockType&&"ListItem"==r.blockGroupType||(a.nodeStack=[]),i=o.modelHandlers.block(e,t,r,o,i)}));i;){var s=i.nextSibling;null===(n=i.parentNode)||void 0===n||n.removeChild(i),i=s}}finally{a.nodeStack=l}}},6830:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleBr=void 0;var o=r(8826);t.handleBr=function(e,t,r,n,a){var l=e.createElement("br"),i=e.createElement("span");i.appendChild(l),t.appendChild(i),(0,o.handleSegmentCommon)(e,l,i,r,n,a)}},1379:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleDivider=void 0;var o=r(7908),n=r(5381);t.handleDivider=function(e,t,r,a,l){var i,s=a.allowCacheElement?r.cachedElement:void 0;return s?l=(0,n.reuseCachedElement)(t,s,l):(s=e.createElement(r.tagName),a.allowCacheElement&&(r.cachedElement=s),t.insertBefore(s,l),(0,o.applyFormat)(s,a.formatAppliers.divider,r.format,a),r.size&&s.setAttribute("size",r.size)),null===(i=a.onNodeCreated)||void 0===i||i.call(a,r,s),l}},736:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleEntitySegment=t.handleEntityBlock=void 0;var o=r(7582),n=r(2033),a=r(7908),l=r(3871),i=r(5381),s=r(8066);t.handleEntityBlock=function(e,t,r,o,n){var l,s=r.entityFormat,c=r.wrapper;return(0,a.applyFormat)(c,o.formatAppliers.entity,s,o),n=(0,i.reuseCachedElement)(t,c,n),null===(l=o.onNodeCreated)||void 0===l||l.call(o,r,c),n},t.handleEntitySegment=function(e,t,r,i,c){var d,u=r.entityFormat,f=r.wrapper,m=r.format;if(t.appendChild(f),null==c||c.push(f),(0,l.getObjectKeys)(m).length>0){var p=(0,s.wrap)(e,f,"span");(0,a.applyFormat)(p,i.formatAppliers.segment,m,i)}if((0,a.applyFormat)(f,i.formatAppliers.entity,u,i),i.addDelimiterForEntity&&u.isReadonly){var v=(0,o.__read)((0,n.addDelimiters)(e,f),2),g=v[0],h=v[1];null==c||c.push(g,h),i.regularSelection.current.segment=g}else i.regularSelection.current.segment=f;null===(d=i.onNodeCreated)||void 0===d||d.call(i,r,f)}},740:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleFormatContainer=void 0;var o=r(7908),n=r(4451),a=r(5381),l=r(3348),i={fontFamily:"monospace",whiteSpace:"pre"};t.handleFormatContainer=function(e,t,r,s,c){var d,u=s.allowCacheElement?r.cachedElement:void 0;if(u)c=(0,a.reuseCachedElement)(t,u,c),s.modelHandlers.blockGroupChildren(e,u,r,s);else if(!(0,n.isBlockGroupEmpty)(r)){var f=e.createElement(r.tagName);s.allowCacheElement&&(r.cachedElement=f),t.insertBefore(f,c),(0,l.stackFormat)(s,r.tagName,(function(){(0,o.applyFormat)(f,s.formatAppliers.container,r.format,s),(0,o.applyFormat)(f,s.formatAppliers.segmentOnBlock,r.format,s),(0,o.applyFormat)(f,s.formatAppliers.container,r.format,s)})),"pre"==r.tagName?(0,l.stackFormat)(s,i,(function(){s.modelHandlers.blockGroupChildren(e,f,r,s)})):s.modelHandlers.blockGroupChildren(e,f,r,s),u=f}return u&&(null===(d=s.onNodeCreated)||void 0===d||d.call(s,r,u)),c}},3035:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleGeneralSegment=t.handleGeneralBlock=void 0;var o=r(8826),n=r(3233),a=r(5381),l=r(8066);t.handleGeneralBlock=function(e,t,r,o,n){var l,i=r.element;return n&&i.parentNode==t?n=(0,a.reuseCachedElement)(t,i,n):(i=i.cloneNode(),r.element=i,t.insertBefore(i,n)),null===(l=o.onNodeCreated)||void 0===l||l.call(o,r,i),o.modelHandlers.blockGroupChildren(e,i,r,o),n},t.handleGeneralSegment=function(e,t,r,a,i){var s,c=r.element.cloneNode();if(r.element=c,t.appendChild(c),(0,n.isNodeOfType)(c,"ELEMENT_NODE")){var d=(0,l.wrap)(e,c,"span");(0,o.handleSegmentCommon)(e,c,d,r,a,i),null===(s=a.onNodeCreated)||void 0===s||s.call(a,r,c)}a.modelHandlers.blockGroupChildren(e,c,r,a)}},1920:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleImage=void 0;var o=r(7908),n=r(8826),a=r(8704);t.handleImage=function(e,t,r,l,i){var s=e.createElement("img"),c=document.createElement("span");t.appendChild(c),c.appendChild(s),s.src=r.src,r.alt&&(s.alt=r.alt),r.title&&(s.title=r.title),(0,o.applyFormat)(s,l.formatAppliers.image,r.format,l),(0,o.applyFormat)(s,l.formatAppliers.dataset,r.dataset,l);var d=r.format,u=d.width,f=d.height,m=u?(0,a.parseValueWithUnit)(u):0,p=f?(0,a.parseValueWithUnit)(f):0;m>0&&(s.width=m),p>0&&(s.height=p),r.isSelectedAsImageSelection&&(l.imageSelection={type:"image",image:s}),(0,n.handleSegmentCommon)(e,s,c,r,l,i)}},3378:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleList=void 0;var o=r(7582),n=r(7908),a=r(7111);t.handleList=function(e,t,r,l,i){var s,c,d=0,u=l.listFormat.nodeStack;for(0==u.length&&u.push({node:t});d<r.levels.length&&d+1<u.length;d++){var f=u[d+1],m=r.levels[d];if(f.listType!=m.listType||(null===(s=f.dataset)||void 0===s?void 0:s.editingInfo)!=m.dataset.editingInfo||"OL"==m.listType&&"number"==typeof m.format.startNumberOverride)break}for(u.splice(d+1);d<r.levels.length;d++){var p=r.levels[d],v=e.createElement(p.listType||"UL");u[u.length-1].node.insertBefore(v,0==d?i:null),u.push((0,o.__assign)({node:v},p)),(0,n.applyFormat)(v,l.formatAppliers.listLevelThread,p.format,l),(0,a.applyMetadata)(p,l.metadataAppliers.listLevel,p.format,l),(0,n.applyFormat)(v,l.formatAppliers.listLevel,p.format,l),(0,n.applyFormat)(v,l.formatAppliers.dataset,p.dataset,l),null===(c=l.onNodeCreated)||void 0===c||c.call(l,p,v)}return i}},6026:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleListItem=void 0;var o=r(7908),n=r(7111),a=r(3963),l=r(9448);t.handleListItem=function(e,t,r,i,s){var c,d;s=i.modelHandlers.list(e,t,r,i,s);var u=i.listFormat.nodeStack,f=(null===(c=null==u?void 0:u[(null==u?void 0:u.length)-1])||void 0===c?void 0:c.node)||t,m=e.createElement("li"),p=r.levels[r.levels.length-1];return f.insertBefore(m,(null==s?void 0:s.parentNode)==f?s:null),p?((0,o.applyFormat)(m,i.formatAppliers.segment,r.formatHolder.format,i),(0,o.applyFormat)(m,i.formatAppliers.listItemThread,p.format,i),(0,n.applyMetadata)(p,i.metadataAppliers.listItem,r.format,i),(0,o.applyFormat)(m,i.formatAppliers.listItemElement,r.format,i),i.modelHandlers.blockGroupChildren(e,m,r,i)):(r.blocks.forEach(a.setParagraphNotImplicit),i.modelHandlers.blockGroupChildren(e,m,r,i),(0,l.unwrap)(m)),null===(d=i.onNodeCreated)||void 0===d||d.call(i,r,m),s}},1351:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleParagraph=void 0;var o=r(7582),n=r(7908),a=r(3871),l=r(6976),i=r(5381),s=r(3348),c=r(9448);t.handleParagraph=function(e,t,r,d,u){var f,m=d.allowCacheElement?r.cachedElement:void 0;return m?u=(0,i.reuseCachedElement)(t,m,u):(0,s.stackFormat)(d,(null===(f=r.decorator)||void 0===f?void 0:f.tagName)||null,(function(){var i,f,p,v,g=!r.isImplicit||!!r.decorator||(0,a.getObjectKeys)(r.format).length>0&&r.segments.some((function(e){return"SelectionMarker"!=e.segmentType})),h=g?(0,o.__assign)((0,o.__assign)({},(null===(i=r.decorator)||void 0===i?void 0:i.format)||{}),r.segmentFormat):{};m=e.createElement((null===(f=r.decorator)||void 0===f?void 0:f.tagName)||"div"),t.insertBefore(m,u),d.regularSelection.current={block:g?m:m.parentNode,segment:null};var b=function(){var t=m;if(t){var n=r.segments[0];"SelectionMarker"==(null==n?void 0:n.segmentType)&&d.modelHandlers.text(e,t,(0,o.__assign)((0,o.__assign)({},n),{segmentType:"Text",text:""}),d,[]),r.segments.forEach((function(o){var n=[];d.modelHandlers.segment(e,t,o,d,n),n.forEach((function(e){var t;null===(t=d.domIndexer)||void 0===t||t.onSegment(e,r,[o])}))}))}};g?((0,s.stackFormat)(d,h,b),(0,n.applyFormat)(m,d.formatAppliers.block,r.format,d),(0,n.applyFormat)(m,d.formatAppliers.container,r.format,d),(0,n.applyFormat)(m,d.formatAppliers.segmentOnBlock,h,d)):b(),(0,l.optimize)(m),u=m.nextSibling,m&&(null===(p=d.onNodeCreated)||void 0===p||p.call(d,r,m),null===(v=d.domIndexer)||void 0===v||v.onParagraph(m)),g?d.allowCacheElement&&(r.cachedElement=m):((0,c.unwrap)(m),m=void 0)})),u}},3913:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegment=void 0;var o=r(7582);t.handleSegment=function(e,t,r,n,a){var l=n.regularSelection;switch(r.isSelected&&!l.start&&(l.start=(0,o.__assign)({},l.current)),r.segmentType){case"Text":n.modelHandlers.text(e,t,r,n,a);break;case"Br":n.modelHandlers.br(e,t,r,n,a);break;case"Image":n.modelHandlers.image(e,t,r,n,a);break;case"General":n.modelHandlers.generalSegment(e,t,r,n,a);break;case"Entity":n.modelHandlers.entitySegment(e,t,r,n,a)}r.isSelected&&l.start&&(l.end=(0,o.__assign)({},l.current))}},1596:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegmentDecorator=void 0;var o=r(7908),n=r(3233),a=r(3348),l=r(4478);t.handleSegmentDecorator=function(e,t,r,i,s){var c=r.code,d=r.link;(0,n.isNodeOfType)(t,"ELEMENT_NODE")&&(d&&(0,a.stackFormat)(i,"a",(function(){var e,r=(0,l.wrapAllChildNodes)(t,"a");(0,o.applyFormat)(r,i.formatAppliers.link,d.format,i),(0,o.applyFormat)(r,i.formatAppliers.dataset,d.dataset,i),null==s||s.push(r),null===(e=i.onNodeCreated)||void 0===e||e.call(i,d,r)})),c&&(0,a.stackFormat)(i,"code",(function(){var e,r=(0,l.wrapAllChildNodes)(t,"code");(0,o.applyFormat)(r,i.formatAppliers.code,c.format,i),null==s||s.push(r),null===(e=i.onNodeCreated)||void 0===e||e.call(i,c,r)})))}},8109:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleTable=void 0;var o=r(7908),n=r(6245),a=r(4451),l=r(4478),i=r(5381);t.handleTable=function(e,t,r,s,c){var d,u,f,m,p,v,g;if((0,a.isBlockEmpty)(r))return c;var h=s.allowCacheElement?r.cachedElement:void 0;h?(c=(0,i.reuseCachedElement)(t,h,c),(0,l.moveChildNodes)(h)):(h=e.createElement("table"),s.allowCacheElement&&(r.cachedElement=h),t.insertBefore(h,c),(0,o.applyFormat)(h,s.formatAppliers.block,r.format,s),(0,o.applyFormat)(h,s.formatAppliers.table,r.format,s),(0,o.applyFormat)(h,s.formatAppliers.tableBorder,r.format,s),(0,o.applyFormat)(h,s.formatAppliers.dataset,r.dataset,s)),null===(d=s.onNodeCreated)||void 0===d||d.call(s,r,h);var b=e.createElement("tbody");h.appendChild(b);for(var y=0;y<r.rows.length;y++){var _=r.rows[y];if(0!=_.cells.length){var C=s.allowCacheElement&&_.cachedElement||e.createElement("tr");b.appendChild(C),(0,l.moveChildNodes)(C),_.cachedElement||(s.allowCacheElement&&(_.cachedElement=C),(0,o.applyFormat)(C,s.formatAppliers.tableRow,_.format,s)),null===(u=s.onNodeCreated)||void 0===u||u.call(s,_,C);for(var P=0;P<_.cells.length;P++){var S=_.cells[P];if(S.isSelected){var k=s.tableSelection||{type:"table",table:h,firstColumn:P,lastColumn:P,firstRow:y,lastRow:y};k.table==h&&(k.lastColumn=Math.max(k.lastColumn,P),k.lastRow=Math.max(k.lastRow,y)),s.tableSelection=k}if(!S.spanAbove&&!S.spanLeft){var O=s.allowCacheElement&&S.cachedElement||e.createElement(S.isHeader?"th":"td");C.appendChild(O);for(var T=1,M=1,w=r.widths[P],E=_.height;null===(m=null===(f=r.rows[y+T])||void 0===f?void 0:f.cells[P])||void 0===m?void 0:m.spanAbove;T++)E+=r.rows[y+T].height;for(;null===(p=_.cells[P+M])||void 0===p?void 0:p.spanLeft;M++)w+=r.widths[P+M];T>1&&(O.rowSpan=T),M>1&&(O.colSpan=M),(!S.cachedElement||S.format.useBorderBox&&(0,n.hasMetadata)(r))&&(w>0&&!O.style.width&&(O.style.width=w+"px"),E>0&&!O.style.height&&(O.style.height=E+"px")),S.cachedElement||(s.allowCacheElement&&(S.cachedElement=O),(0,o.applyFormat)(O,s.formatAppliers.block,S.format,s),(0,o.applyFormat)(O,s.formatAppliers.tableCell,S.format,s),(0,o.applyFormat)(O,s.formatAppliers.tableCellBorder,S.format,s),(0,o.applyFormat)(O,s.formatAppliers.dataset,S.dataset,s)),s.modelHandlers.blockGroupChildren(e,O,S,s),null===(v=s.onNodeCreated)||void 0===v||v.call(s,S,O)}}}}return null===(g=s.domIndexer)||void 0===g||g.onTable(h,r),c}},8906:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleText=void 0;var o=r(8826);t.handleText=function(e,t,r,n,a){var l=e.createTextNode(r.text),i=e.createElement("span");t.appendChild(i),i.appendChild(l),(0,o.handleSegmentCommon)(e,l,i,r,n,a)}},2920:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeNode=void 0;var o=r(3233),n=["SPAN","B","EM","I","U","SUB","SUP","STRIKE","S","A","CODE"];function a(e,t){var r=e.attributes,o=t.attributes;if(r.length!=o.length)return!1;for(var n=0;n<r.length;n++)if(r[n].name!=o[n].name||r[n].value!=o[n].value)return!1;return!0}t.mergeNode=function(e){for(var t=e.firstChild;t;){var r=t.nextSibling;if(r&&(0,o.isNodeOfType)(t,"ELEMENT_NODE")&&(0,o.isNodeOfType)(r,"ELEMENT_NODE")&&t.tagName==r.tagName&&n.indexOf(t.tagName)>=0&&a(t,r)){for(;r.firstChild;)t.appendChild(r.firstChild);r.parentNode.removeChild(r)}else t=r}}},6976:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.optimize=void 0;var o=r(2033),n=r(2920),a=r(9486);t.optimize=function e(t){if(!(0,o.isEntityElement)(t)){(0,a.removeUnnecessarySpan)(t),(0,n.mergeNode)(t);for(var r=t.firstChild;r;r=r.nextSibling)e(r)}}},9486:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeUnnecessarySpan=void 0;var o=r(3233);t.removeUnnecessarySpan=function(e){for(var t=e.firstChild;t;)if((0,o.isNodeOfType)(t,"ELEMENT_NODE")&&"SPAN"==t.tagName&&0==t.attributes.length){var r=t,n=t.nextSibling;for(t=t.nextSibling;r.lastChild;){var a=r.lastChild;e.insertBefore(a,n),n=a}e.removeChild(r)}else t=t.nextSibling}},7908:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyFormat=void 0,t.applyFormat=function(e,t,r,o){t.forEach((function(t){null==t||t(r,e,o)}))}},7111:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyMetadata=void 0;var o=r(6245);t.applyMetadata=function(e,t,r,n){t&&(0,o.updateMetadata)(e,(function(e){return t.applierFunction(e,r,n),e}),t.metadataDefinition)}},8826:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegmentCommon=void 0;var o=r(7908);t.handleSegmentCommon=function(e,t,r,n,a,l){var i;t.firstChild||(a.regularSelection.current.segment=t),(0,o.applyFormat)(r,a.formatAppliers.styleBasedSegment,n.format,a),null==l||l.push(t),a.modelHandlers.segmentDecorator(e,r,n,a,l),(0,o.applyFormat)(r,a.formatAppliers.elementBasedSegment,n.format,a),null===(i=a.onNodeCreated)||void 0===i||i.call(a,n,t)}},5381:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeNode=t.reuseCachedElement=void 0;var o=r(2033);t.reuseCachedElement=function(e,t,r){var n;if(t.parentNode==e){for(;r&&r!=t&&!(0,o.isEntityElement)(r);){var a=r.nextSibling;null===(n=r.parentNode)||void 0===n||n.removeChild(r),r=a}r&&r==t?r=r.nextSibling:e.insertBefore(t,r)}else e.insertBefore(t,r);return r},t.removeNode=function(e){var t,r=e.nextSibling;return null===(t=e.parentNode)||void 0===t||t.removeChild(e),r}},3348:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stackFormat=void 0;var o=r(7582),n=r(3679);t.stackFormat=function(e,t,r){var a="string"==typeof t?n.defaultContentModelFormatMap[t]:t;if(a){var l=e.implicitFormat;try{e.implicitFormat=(0,o.__assign)((0,o.__assign)({},l),a),r()}finally{e.implicitFormat=l}}else r()}},6724:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addRangeToSelection=void 0,t.addRangeToSelection=function(e,t){var r,o=null===(r=e.defaultView)||void 0===r?void 0:r.getSelection();o&&(o.removeAllRanges(),o.addRange(t))}},9843:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.combineBorderValue=t.extractBorderValues=void 0;var r=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"],o=/^(thin|medium|thick|[\d\.]+\w*)$/;t.extractBorderValues=function(e){var t={};return(e||"").replace(/, /g,",").split(" ").forEach((function(e){r.indexOf(e)>=0&&!t.style?t.style=e:o.test(e)&&!t.width?t.width=e:e&&!t.color&&(t.color=e)})),t},t.combineBorderValue=function(e){return[e.width||"",e.style||"",e.color||""].join(" ").trim()||"none"}},1020:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCharacterValue=t.isModifierKey=void 0;function r(e){var t=e.ctrlKey||"Control"===e.key,r=e.altKey||"Alt"===e.key,o=e.metaKey||"Meta"===e.key;return t||r||o}t.isModifierKey=r,t.isCharacterValue=function(e){return!r(e)&&!!e.key&&1==e.key.length}},6030:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createObjectDefinition=t.createArrayDefinition=t.createStringDefinition=t.createBooleanDefinition=t.createNumberDefinition=void 0,t.createNumberDefinition=function(e,t,r,o,n){return{type:"number",isOptional:e,value:t,maxValue:o,minValue:r,allowNull:n}},t.createBooleanDefinition=function(e,t,r){return{type:"boolean",isOptional:e,value:t,allowNull:r}},t.createStringDefinition=function(e,t,r){return{type:"string",isOptional:e,value:t,allowNull:r}},t.createArrayDefinition=function(e,t,r,o,n){return{type:"array",isOptional:t,itemDef:e,minLength:r,maxLength:o,allowNull:n}},t.createObjectDefinition=function(e,t,r){return{type:"object",isOptional:t,propertyDef:e,allowNull:r}}},5866:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateImageMetadata=void 0;var o=r(1246),n=r(6030),a=(0,n.createNumberDefinition)(),l=(0,n.createObjectDefinition)({widthPx:a,heightPx:a,leftPercent:a,rightPercent:a,topPercent:a,bottomPercent:a,angleRad:a,src:(0,n.createStringDefinition)(),naturalHeight:a,naturalWidth:a});t.updateImageMetadata=function(e,t){return(0,o.updateMetadata)(e,t,l)}},7410:(e,t,r)=>{var o,n;Object.defineProperty(t,"__esModule",{value:!0}),t.updateListMetadata=t.listLevelMetadataApplier=t.listItemMetadataApplier=void 0;var a=r(7582),l=r(398),i=r(6030),s=r(1246),c=["decimal","lower-alpha","lower-roman"],d=["disc","circle","square"],u=/\$\{(\w+)\}/,f={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},m=((o={})[l.NumberingListType.Decimal]="decimal",o[l.NumberingListType.DecimalDash]='"${Number}- "',o[l.NumberingListType.DecimalParenthesis]='"${Number}) "',o[l.NumberingListType.DecimalDoubleParenthesis]='"(${Number}) "',o[l.NumberingListType.LowerAlpha]="lower-alpha",o[l.NumberingListType.LowerAlphaDash]='"${LowerAlpha}- "',o[l.NumberingListType.LowerAlphaParenthesis]='"${LowerAlpha}) "',o[l.NumberingListType.LowerAlphaDoubleParenthesis]='"(${LowerAlpha}) "',o[l.NumberingListType.UpperAlpha]="upper-alpha",o[l.NumberingListType.UpperAlphaDash]='"${UpperAlpha}- "',o[l.NumberingListType.UpperAlphaParenthesis]='"${UpperAlpha}) "',o[l.NumberingListType.UpperAlphaDoubleParenthesis]='"(${UpperAlpha}) "',o[l.NumberingListType.LowerRoman]="lower-roman",o[l.NumberingListType.LowerRomanDash]='"${LowerRoman}- "',o[l.NumberingListType.LowerRomanParenthesis]='"${LowerRoman}) "',o[l.NumberingListType.LowerRomanDoubleParenthesis]='"(${LowerRoman}) "',o[l.NumberingListType.UpperRoman]="upper-roman",o[l.NumberingListType.UpperRomanDash]='"${UpperRoman}- "',o[l.NumberingListType.UpperRomanParenthesis]='"${UpperRoman}) "',o[l.NumberingListType.UpperRomanDoubleParenthesis]='"(${UpperRoman}) "',o),p=((n={})[l.BulletListType.Disc]="disc",n[l.BulletListType.Square]='"∎ "',n[l.BulletListType.Circle]="circle",n[l.BulletListType.Dash]='"- "',n[l.BulletListType.LongArrow]='"➔ "',n[l.BulletListType.DoubleLongArrow]='"➔ "',n[l.BulletListType.ShortArrow]='"➢ "',n[l.BulletListType.UnfilledArrow]='"➪ "',n[l.BulletListType.Hyphen]='"— "',n);function v(e,t){var r="";for(e--;e>=0;)r=String.fromCharCode(e%26+65)+r,e=Math.floor(e/26)-1;return t?r.toLowerCase():r}function g(e,t){var r,o,n="";try{for(var l=(0,a.__values)((0,s.getObjectKeys)(f)),i=l.next();!i.done;i=l.next()){var c=i.value,d=Math.floor(e/f[c]);e-=d*f[c],n+=c.repeat(d)}}catch(e){r={error:e}}finally{try{i&&!i.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}return t?n.toLocaleLowerCase():n}var h=(0,i.createObjectDefinition)({orderedStyleType:(0,i.createNumberDefinition)(!0,void 0,l.NumberingListType.Min,l.NumberingListType.Max),unorderedStyleType:(0,i.createNumberDefinition)(!0,void 0,l.BulletListType.Min,l.BulletListType.Max)},!0,!0);function b(e){return e.indexOf('"')>=0}function y(e,t,r){var o=t.orderedStyleType,n=t.unorderedStyleType;return"OL"==e?void 0===o?c[r%c.length]:m[o]:void 0===n?d[r%d.length]:p[n]}t.listItemMetadataApplier={metadataDefinition:h,applierFunction:function(e,t,r){var o,n,a,l=r.listFormat.nodeStack.length-2;if(l>=0){var i=null!==(o=r.listFormat.nodeStack[l+1].listType)&&void 0!==o?o:"OL",s=y(i,null!=e?e:{},l);s&&b(s)?t.listStyleType="OL"==i?(n=s,a=r.listFormat.threadItemCounts[l],n?n.replace(u,(function(e,t){switch(t){case"Number":return a+"";case"LowerAlpha":return v(a,!0);case"UpperAlpha":return v(a,!1);case"LowerRoman":return g(a,!0);case"UpperRoman":return g(a,!1)}return""})):void 0):s:delete t.listStyleType}}},t.listLevelMetadataApplier={metadataDefinition:h,applierFunction:function(e,t,r){var o,n=r.listFormat.nodeStack.length-2;if(n>=0){var a=y(null!==(o=r.listFormat.nodeStack[n+1].listType)&&void 0!==o?o:"OL",null!=e?e:{},n);a&&!b(a)?t.listStyleType=a:delete t.listStyleType}}},t.updateListMetadata=function(e,t){return(0,s.updateMetadata)(e,t,h)}},860:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateTableCellMetadata=void 0;var o=r(6030),n=r(1246),a=(0,o.createObjectDefinition)({bgColorOverride:(0,o.createBooleanDefinition)(!0),vAlignOverride:(0,o.createBooleanDefinition)(!0),borderOverride:(0,o.createBooleanDefinition)(!0)},!1,!0);t.updateTableCellMetadata=function(e,t){return(0,n.updateMetadata)(e,t,a)}},5165:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateTableMetadata=void 0;var o=r(398),n=r(1246),a=r(6030),l=(0,a.createStringDefinition)(!1,void 0,!0),i=(0,a.createBooleanDefinition)(!1),s=(0,a.createObjectDefinition)({topBorderColor:l,bottomBorderColor:l,verticalBorderColor:l,hasHeaderRow:i,headerRowColor:l,hasFirstColumn:i,hasBandedColumns:i,hasBandedRows:i,bgColorEven:l,bgColorOdd:l,tableBorderFormat:(0,a.createNumberDefinition)(!1,void 0,o.TableBorderFormat.DEFAULT,o.TableBorderFormat.CLEAR),verticalAlign:l},!1,!0);t.updateTableMetadata=function(e,t){return(0,n.updateMetadata)(e,t,s)}},4051:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.readFile=void 0,t.readFile=function(e,t){if(e){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=function(){t(null)},r.readAsDataURL(e)}}},8778:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeText=t.isSpace=t.isPunctuation=void 0;var r=/[\u2000\u2009\u200a​\u200b​\u202f\u205f​\u3000\s\t\r\n]/gm;t.isPunctuation=function(e){return'.,?!:"()[]\\/'.indexOf(e)>=0},t.isSpace=function(e){var t,o=null!==(t=null==e?void 0:e.charCodeAt(0))&&void 0!==t?t:0;return 160==o||32==o||r.test(e)},t.normalizeText=function(e,t){return e.replace(t?/^\u0020+/:/\u0020+$/," ")}},6593:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(8974),a=function(e){function t(t,r){void 0===r&&(r={});var o=e.call(this,t,r,n.createContentModelEditorCore)||this;return r.cacheModel&&o.createContentModel(),o}return(0,o.__extends)(t,e),t.prototype.createContentModel=function(e,t){var r=this.getCore();return r.api.createContentModel(r,e,t)},t.prototype.setContentModel=function(e,t,r){var o=this.getCore();return o.api.setContentModel(o,e,t,r)},t.prototype.getEnvironment=function(){return this.getCore().environment},t.prototype.getDOMSelection=function(){var e=this.getCore();return e.api.getDOMSelection(e)},t.prototype.setDOMSelection=function(e){var t=this.getCore();t.api.setDOMSelection(t,e)},t}(r(2347).EditorBase);t.default=a},5427:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModel=void 0;var o=r(7582),n=r(1690),a=r(1246);t.createContentModel=function(e,t,r){var l=r?null:e.cache.cachedModel;if(l&&e.lifecycle.shadowEditFragment&&(l=(0,n.cloneModel)(l,{includeCachedElement:!0})),l)return l;var i=r||e.api.getDOMSelection(e)||void 0,s=function(e,t,r){var n=e.api.createEditorContext(e),l=r?a.createDomToModelContext.apply(void 0,(0,o.__spreadArray)((0,o.__spreadArray)([n],(0,o.__read)(e.defaultDomToModelOptions||[]),!1),[r],!1)):(0,a.createDomToModelContextWithConfig)(e.defaultDomToModelConfig,n);return(0,a.domToContentModel)(e.contentDiv,l,t)}(e,i,t);return t||r||(e.cache.cachedModel=s,e.cache.cachedSelection=i),s}},7832:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEditorContext=void 0,t.createEditorContext=function(e){var t=e.lifecycle,r=e.format,o=e.darkColorHandler,n=e.contentDiv,a=e.cache,l={isDarkMode:t.isDarkMode,defaultFormat:r.defaultFormat,darkColorHandler:o,addDelimiterForEntity:!0,allowCacheElement:!0,domIndexer:a.domIndexer};return function(e,t){var r,o=null===(r=null==e?void 0:e.ownerDocument.defaultView)||void 0===r?void 0:r.getComputedStyle(e);"rtl"==(null==o?void 0:o.direction)&&(t.isRootRtl=!0)}(n,l),function(e,t){var r,o=(null===(r=null==e?void 0:e.getBoundingClientRect())||void 0===r?void 0:r.width)||0,n=e.offsetWidth;n>0&&o>0&&(t.zoomScale=Math.round(o/n*100)/100)}(n,l),l}},3240:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDOMSelection=void 0,t.getDOMSelection=function(e){var t;return null!==(t=e.cache.cachedSelection)&&void 0!==t?t:function(e){var t=e.api.getSelectionRangeEx(e);return 0==t.type&&t.ranges[0]?{type:"range",range:t.ranges[0]}:1==t.type&&t.coordinates?{type:"table",table:t.table,firstColumn:t.coordinates.firstCell.x,lastColumn:t.coordinates.lastCell.x,firstRow:t.coordinates.firstCell.y,lastRow:t.coordinates.lastCell.y}:2==t.type?{type:"image",image:t.image}:null}(e)}},7934:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setContentModel=void 0;var o=r(7582),n=r(1246);t.setContentModel=function(e,t,r,a){var l=e.api.createEditorContext(e),i=r?n.createModelToDomContext.apply(void 0,(0,o.__spreadArray)((0,o.__spreadArray)([l],(0,o.__read)(e.defaultModelToDomOptions||[]),!1),[r],!1)):(0,n.createModelToDomContextWithConfig)(e.defaultModelToDomConfig,l),s=(0,n.contentModelToDom)(e.contentDiv.ownerDocument,e.contentDiv,t,i,a);return e.lifecycle.shadowEditFragment||(e.cache.cachedSelection=s||void 0,s&&((null==r?void 0:r.ignoreSelection)?"range"==s.type&&(e.domEvent.selectionRange=s.range):e.api.setDOMSelection(e,s)),e.cache.cachedModel=t),s}},9336:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setDOMSelection=void 0,t.setDOMSelection=function(e,t){var r="range"==t.type?{type:0,ranges:[t.range],areAllCollapsed:t.range.collapsed}:"image"==t.type?{type:2,ranges:[],areAllCollapsed:!1,image:t.image}:{type:1,ranges:[],areAllCollapsed:!1,table:t.table,coordinates:{firstCell:{x:t.firstColumn,y:t.firstRow},lastCell:{x:t.lastColumn,y:t.lastRow}}};e.api.select(e,r)}},3515:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.switchShadowEdit=void 0;var o=r(2347),n=r(5098);t.switchShadowEdit=function(e,t){var r=e;if(t!=!!r.lifecycle.shadowEditFragment)if(t){var a=r.cache.cachedModel?null:r.api.createContentModel(r),l=r.api.getSelectionRange(r,!0),i=r.contentDiv.ownerDocument.createDocumentFragment(),s=l&&(0,o.getSelectionPath)(r.contentDiv,l);r.api.triggerEvent(r,{eventType:17,fragment:i,selectionPath:s},!1),!r.cache.cachedModel&&a&&(r.cache.cachedModel=a),r.lifecycle.shadowEditSelectionPath=s,r.lifecycle.shadowEditFragment=i}else r.lifecycle.shadowEditFragment=null,r.lifecycle.shadowEditSelectionPath=null,r.api.triggerEvent(r,{eventType:18},!1),r.cache.cachedModel&&((0,n.iterateSelections)([r.cache.cachedModel],(function(){})),r.api.setContentModel(r,r.cache.cachedModel,{ignoreSelection:!0}))}},1940:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelCachePlugin=void 0;var o=r(8154),n=r(1020),a=function(){function e(e){var t=this;this.state=e,this.editor=null,this.onNativeSelectionChange=function(){var e;(null===(e=t.editor)||void 0===e?void 0:e.hasFocus())&&t.updateCachedModel(t.editor)}}return e.prototype.getName=function(){return"ContentModelCache"},e.prototype.initialize=function(e){this.editor=e,this.editor.getDocument().addEventListener("selectionchange",this.onNativeSelectionChange)},e.prototype.dispose=function(){this.editor&&(this.editor.getDocument().removeEventListener("selectionchange",this.onNativeSelectionChange),this.editor=null)},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case 0:this.shouldClearCache(e)&&this.invalidateCache();break;case 3:this.updateCachedModel(this.editor,!0);break;case 22:this.updateCachedModel(this.editor);break;case 7:var t=e,r=t.contentModel,o=t.selection;r&&this.state.domIndexer?(this.state.cachedModel=r,this.state.cachedSelection=o):this.invalidateCache()}},e.prototype.invalidateCache=function(){var e;(null===(e=this.editor)||void 0===e?void 0:e.isInShadowEdit())||(this.state.cachedModel=void 0,this.state.cachedSelection=void 0)},e.prototype.updateCachedModel=function(e,t){var r,n=this.state.cachedSelection;this.state.cachedSelection=void 0;var a=e.getDOMSelection()||void 0,l=this.state.cachedModel;!t&&n&&a&&(0,o.areSameRangeEx)(a,n)?this.state.cachedSelection=n:l&&a&&(null===(r=this.state.domIndexer)||void 0===r?void 0:r.reconcileSelection(l,a,n))?this.state.cachedSelection=a:this.invalidateCache()},e.prototype.shouldClearCache=function(e){var t,r=e.rawEvent;return!!e.handledByEditFeature||!!r.defaultPrevented||"Enter"==r.key||!("range"==(null===(t=this.state.cachedSelection)||void 0===t?void 0:t.type)&&this.state.cachedSelection.range.collapsed||!(0,n.isCharacterValue)(r))},e}();t.default=a,t.createContentModelCachePlugin=function(e){return new a(e)}},6093:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.onNodeCreated=void 0;var o=r(7582),n=r(5915),a=r(6724),l=r(436),i=r(1690),s=r(473),c=r(2347),d=r(2511),u=r(5098),f=r(1246),m=function(){function e(e){var t=this;this.state=e,this.editor=null,this.disposer=null,this.onPaste=function(e){if(t.editor&&function(e){return!!e.clipboardData}(e)){var r=t.editor,o=e.clipboardData;(null==o?void 0:o.items)&&(e.preventDefault(),(0,c.extractClipboardItems)((0,f.toArray)(o.items),{allowedCustomPasteType:t.state.allowedCustomPasteType},!0).then((function(e){r.isDisposed()||(0,n.default)(r,e)})))}}}return e.prototype.getName=function(){return"ContentModelCopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:function(e){return t.onPaste(e)},copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},e.prototype.dispose=function(){this.disposer&&this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onCutCopy=function(e,r){var n=this;if(this.editor){var c=this.editor.getDocument(),m=this.editor.getDOMSelection();if(m&&("range"!=m.type||!m.range.collapsed)){var v=this.editor.createContentModel(),g=(0,i.cloneModel)(v,{includeCachedElement:!!this.editor.isDarkMode()&&function(e,t){var r;if("cache"!=t){var o=e.cloneNode(!0);return null===(r=n.editor)||void 0===r||r.transformToDarkColor(o,1),o.style.color=o.style.color||"inherit",o.style.backgroundColor=o.style.backgroundColor||"inherit",o}}});"table"===m.type&&(0,u.iterateSelections)([g],(function(e,t){if(null==t?void 0:t.table){var r=null==t?void 0:t.table;return r.rows=r.rows.map((function(e){return(0,o.__assign)((0,o.__assign)({},e),{cells:e.cells.filter((function(e){return e.isSelected}))})})).filter((function(e){return e.cells.length>0})),!0}return!1}));var h=this.getTempDiv(this.editor),b=(0,f.contentModelToDom)(h.ownerDocument,h,g,(0,f.createModelToDomContext)(),t.onNodeCreated),y=b?function(e,t,r){var o,n=null;if("table"===t.type){var a=r.querySelector("#"+t.table.id),l=1==(null===(o=a.parentElement)||void 0===o?void 0:o.childElementCount)?a.parentElement:a;(n=e.createRange()).selectNode(l)}else if("image"===t.type){var i=r.querySelector("#"+t.image.id);i&&(n=e.createRange()).selectNode(i)}else n=t.range;return n}(c,b,h):null;y?((y=this.editor.triggerPluginEvent(9,{clonedRoot:h,range:y,rawEvent:e,isCut:r}).range)&&(0,a.addRangeToSelection)(c,y),this.editor.runAsync((function(e){p(h),e.focus(),e.setDOMSelection(m),r&&(0,d.formatWithContentModel)(e,"cut",(function(e,t){return 2==(0,s.deleteSelection)(e,[],t).deleteResult&&(0,f.normalizeContentModel)(e),!0}),{changeSource:l.ChangeSource.Cut})}))):p(h)}}},e.prototype.getTempDiv=function(e){var t=e.getCustomData("CopyPasteTempDiv",(function(){var t=e.getDocument().createElement("div");return t.style.width="600px",t.style.height="1px",t.style.overflow="hidden",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.userSelect="text",t.contentEditable="true",e.getDocument().body.appendChild(t),t}),(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}));return t.style.backgroundColor="white",t.style.color="black",t.childNodes.forEach((function(e){return t.removeChild(e)})),t.style.display="",t.focus(),t},e}();function p(e){e.style.backgroundColor="",e.style.color="",e.style.display="none",(0,f.moveChildNodes)(e)}t.default=m,t.onNodeCreated=function(e,t){(0,f.isNodeOfType)(t,"ELEMENT_NODE")&&(0,f.isElementOfType)(t,"table")&&(0,f.wrap)(t.ownerDocument,t,"div"),(0,f.isNodeOfType)(t,"ELEMENT_NODE")&&!t.isContentEditable&&t.removeAttribute("contenteditable")}},9647:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelEditPlugin=void 0;var o=r(1990),n=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"ContentModelEdit"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){this.editor&&0===e.eventType&&this.handleKeyDownEvent(this.editor,e)},e.prototype.handleKeyDownEvent=function(e,t){var r=t.rawEvent;if(!r.defaultPrevented&&!t.handledByEditFeature)switch(r.key){case"Backspace":case"Delete":(0,o.default)(e,r)}},e}();t.default=n,t.createContentModelEditPlugin=function(){return new n}},4607:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelFormatPlugin=void 0;var o=r(7992),n=r(1576),a=r(2976),l=r(1246),i=r(1020),s=new Set(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"]),c=function(){function e(e){this.state=e,this.editor=null,this.hasDefaultFormat=!1}return e.prototype.getName=function(){return"ContentModelFormat"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.hasDefaultFormat=(0,l.getObjectKeys)(this.state.defaultFormat).filter((function(e){return void 0!==t.state.defaultFormat[e]})).length>0},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case 3:e.rawEvent.isComposing||this.editor.isInIME()||this.checkAndApplyPendingFormat(e.rawEvent.data);break;case 4:this.checkAndApplyPendingFormat(e.rawEvent.data);break;case 0:s.has(e.rawEvent.key)?(0,a.clearPendingFormat)(this.editor):this.hasDefaultFormat&&((0,i.isCharacterValue)(e.rawEvent)||"Process"==e.rawEvent.key)&&(0,o.default)(this.editor,this.state.defaultFormat);break;case 6:case 7:(0,a.canApplyPendingFormat)(this.editor)||(0,a.clearPendingFormat)(this.editor)}},e.prototype.checkAndApplyPendingFormat=function(e){this.editor&&e&&((0,n.default)(this.editor,e),(0,a.clearPendingFormat)(this.editor))},e}();t.default=c,t.createContentModelFormatPlugin=function(e){return new c(e)}},2517:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.getName=function(){return"ContentModelTypeInContainer"},e.prototype.initialize=function(){},e.prototype.dispose=function(){},e}();t.default=r},8974:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.promoteToContentModelEditorCore=t.createContentModelEditorCore=void 0;var o=r(7582),n=r(6093),a=r(2517),l=r(1863),i=r(5427),s=r(1940),c=r(9647),d=r(4607),u=r(1246),f=r(7832),m=r(2347),p=r(3240),v=r(7934),g=r(9336),h=r(3515),b=r(9778),y=r(7410);function _(e,t,r){var o=e;!function(e,t){Object.assign(e,t)}(o,r),function(e,t){e.defaultDomToModelOptions=[{processorOverride:{table:b.tablePreProcessor}},t.defaultDomToModelOptions],e.defaultModelToDomOptions=[{metadataAppliers:{listItem:y.listItemMetadataApplier,listLevel:y.listLevelMetadataApplier}},t.defaultModelToDomOptions],e.defaultDomToModelConfig=(0,u.createDomToModelConfig)(e.defaultDomToModelOptions),e.defaultModelToDomConfig=(0,u.createModelToDomConfig)(e.defaultModelToDomOptions)}(o,t),function(e){e.api.createEditorContext=f.createEditorContext,e.api.createContentModel=i.createContentModel,e.api.setContentModel=v.setContentModel,e.api.switchShadowEdit=h.switchShadowEdit,e.api.getDOMSelection=p.getDOMSelection,e.api.setDOMSelection=g.setDOMSelection,e.originalApi.createEditorContext=f.createEditorContext,e.originalApi.createContentModel=i.createContentModel,e.originalApi.setContentModel=v.setContentModel,e.originalApi.getDOMSelection=p.getDOMSelection,e.originalApi.setDOMSelection=g.setDOMSelection}(o),function(e){e.environment.isMac=-1!=window.navigator.appVersion.indexOf("Mac")}(o)}t.createContentModelEditorCore=function(e,t){var r=function(e){var t,r,o=e.defaultFormat||{};return{cache:{domIndexer:e.cacheModel?l.contentModelDomIndexer:void 0},copyPaste:{allowedCustomPasteType:e.allowedCustomPasteType||[]},format:{defaultFormat:{fontWeight:o.bold?"bold":void 0,italic:o.italic||void 0,underline:o.underline||void 0,fontFamily:o.fontFamily||void 0,fontSize:o.fontSize||void 0,textColor:(null===(t=o.textColors)||void 0===t?void 0:t.lightModeColor)||o.textColor||void 0,backgroundColor:(null===(r=o.backgroundColors)||void 0===r?void 0:r.lightModeColor)||o.backgroundColor||void 0}}}}(t),i=(0,o.__assign)((0,o.__assign)({},t),{plugins:(0,o.__spreadArray)((0,o.__spreadArray)([(0,s.createContentModelCachePlugin)(r.cache)],(0,o.__read)(t.plugins||[]),!1),[(0,d.createContentModelFormatPlugin)(r.format),(0,c.createContentModelEditPlugin)()],!1),corePluginOverride:(0,o.__assign)({typeInContainer:new a.default,copyPaste:new n.default(r.copyPaste)},t.corePluginOverride)}),u=(0,m.createEditorCore)(e,i);return u.environment={},_(u,i,r),u},t.promoteToContentModelEditorCore=_},1053:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return!!e.createContentModel}},9778:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tablePreProcessor=void 0;var o=r(1246),n=r(2812);t.tablePreProcessor=function(e,t,r){var a=function(e,t){var r=(0,n.getSelectionRootNode)(t.selection);return(0,o.hasMetadata)(e)||t.isInSelection||r&&e.contains(r)}(t,r)?o.tableProcessor:o.entityProcessor;a(e,t,r)}},1021:(e,t,r)=>{var o;Object.defineProperty(t,"__esModule",{value:!0});var n=r(9079),a=r(1246),l=r(2347),i=r(251),s=r(5579),c=r(1152),d=r(1082),u=r(5459),f=r(22),m=r(2389),p=((o={})[3]="asImage",o[1]="asPlainText",o[2]="mergeFormat",o[0]="normal",o),v=function(){function e(e){void 0===e&&(e="SPAN"),this.unknownTagReplacement=e,this.editor=null}return e.prototype.getName=function(){return"ContentModelPaste"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor&&10==e.eventType){var t=e;if(t.domToModelOption){var r,o=(0,s.getPasteSource)(t,!1),a=p[t.pasteType];switch(o){case"wordDesktop":(0,f.processPastedContentFromWordDesktop)(t);break;case"wacComponents":(0,m.processPastedContentWacComponents)(t);break;case"excelOnline":case"excelDesktop":"normal"!==a&&"mergeFormat"!==a||(0,d.processPastedContentFromExcel)(t,this.editor.getTrustedHTMLHandler());break;case"googleSheets":t.sanitizingOption.additionalTagReplacements["google-sheets-html-origin"]="*";break;case"powerPointDesktop":(0,u.processPastedContentFromPowerPoint)(t,this.editor.getTrustedHTMLHandler())}(0,n.default)(t.domToModelOption,"link",c.parseLink),(0,n.default)(t.domToModelOption,"tableCell",i.deprecatedBorderColorParser),(0,n.default)(t.domToModelOption,"tableCell",b),(0,n.default)(t.domToModelOption,"table",i.deprecatedBorderColorParser),r=t.sanitizingOption,(0,l.chainSanitizerCallback)(r.cssStyleCallbacks,"display",(function(e){return"flex"!=e})),"mergeFormat"===a&&((0,n.default)(t.domToModelOption,"block",g),(0,n.default)(t.domToModelOption,"listLevel",g)),t.sanitizingOption.unknownTagReplacement=this.unknownTagReplacement}}},e}();t.default=v;var g=function(e,t){t.style.backgroundColor&&delete e.backgroundColor},h=new Map([["borderTop",{w:"borderTopWidth",s:"borderTopStyle",c:"borderTopColor"}],["borderRight",{w:"borderRightWidth",s:"borderRightStyle",c:"borderRightColor"}],["borderBottom",{w:"borderBottomWidth",s:"borderBottomStyle",c:"borderBottomColor"}],["borderLeft",{w:"borderLeftWidth",s:"borderLeftStyle",c:"borderLeftColor"}]]);function b(e,t){a.BorderKeys.forEach((function(r){if(!e[r]){var o=h.get(r);o&&t.style[o.w]&&t.style[o.s]&&!t.style[o.c]&&(e[r]=t.style[o.w]+" "+t.style[o.s])}}))}},1082:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.excelHandler=t.processPastedContentFromExcel=void 0;var o=r(7582),n=r(9079),a=r(1246),l=r(9263),i=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,s=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,c=/<tr[^>]*>[^<]*/i,d=/<table[^>]*>[^<]*/i,u="solid 1px #d4d4d4";function f(e,t){if(e.match(i)){var r=t.match(c);e=(r?r[0]:"<TR>")+e+"</TR>"}if(e.match(s)){var o=t.match(d);e=(o?o[0]:"<TABLE>")+e+"</TABLE>"}return e}t.processPastedContentFromExcel=function(e,t){var r=e.fragment,i=e.htmlBefore,s=e.clipboardData,c=s.html?f(s.html,i):void 0;if(c&&s.html!=c){var d=(new DOMParser).parseFromString(t(c),"text/html");(0,a.moveChildNodes)(r,null==d?void 0:d.body)}var m=r.firstChild;(0,a.isNodeOfType)(m,"ELEMENT_NODE")&&"div"==m.tagName&&m.firstChild&&Array.from(m.childNodes).every((function(e){var t=(0,a.isNodeOfType)(e,"ELEMENT_NODE")&&e.tagName;return"META"==t||"TABLE"==t&&e==m.lastChild}))&&m.lastChild&&e.fragment.replaceChildren(m.lastChild),(0,n.default)(e.domToModelOption,"tableCell",(function(e,t){"none"===t.style.borderStyle&&(e.borderBottom=u,e.borderLeft=u,e.borderRight=u,e.borderTop=u)})),(0,l.setProcessor)(e.domToModelOption,"child",(function(e,t,r){var n=(0,o.__assign)({},r.segmentFormat);"TableCell"===e.blockGroupType&&e.format.textColor&&(r.segmentFormat.textColor=e.format.textColor),r.defaultElementProcessors.child(e,t,r),"TableCell"===e.blockGroupType&&e.format.textColor&&(r.segmentFormat=n,delete e.format.textColor)}))},t.excelHandler=f},5459:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processPastedContentFromPowerPoint=void 0;var o=r(1246);t.processPastedContentFromPowerPoint=function(e,t){var r=e.fragment,n=e.clipboardData;if(n.html&&!n.text&&n.image){var a=(new DOMParser).parseFromString(t(n.html),"text/html");(0,o.moveChildNodes)(r,null==a?void 0:a.body)}}},2389:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processPastedContentWacComponents=void 0;var o=r(7582),n=r(9079),a=r(9263),l="ListContainerWrapper",i="TableContainer",s=["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle","ListMarkerWrappingSpan"],c=(0,o.__spreadArray)((0,o.__spreadArray)(["OutlineElement","NumberListStyle","WACImageContainer","ListContainerWrapper","BulletListStyle"],(0,o.__read)(s),!1),["TableCellContent","Paragraph","WACImageContainer","WACImageBorder",i,"LineBreakBlob"],!1),d=["UL","OL","LI"],u=d.join(","),f=function(e,t){var r=t.style.verticalAlign;"super"===r&&(e.superOrSubScriptSequence="super"),"sub"===r&&(e.superOrSubScriptSequence="sub")},m=function(e,t,r){var o=t.tagName;if(t.matches('ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer,span.WACImageBorder')&&(t.style.removeProperty("display"),t.style.removeProperty("margin")),t.classList.contains(l))r.elementProcessors.child(e,t,r);else if(!s.some((function(e){return t.classList.contains(e)}))){if(function(e,t,r){return r.listFormat.levels.length>0&&d.every((function(t){return t!=e}))&&!t.closest(u)}(o,t,r)){var n=r.listFormat;n.levels=[],n.listParent=void 0}r.defaultElementProcessors.element(e,t,r)}},p=function(e,t,r){var o,n,a;null===(n=(o=r.defaultElementProcessors).li)||void 0===n||n.call(o,e,t,r);var l=r.listFormat.listParent;if(l){var i=l.blocks[l.blocks.length-1];if("BlockGroup"==i.blockType&&"ListItem"==i.blockGroupType&&r.listFormat.listParent!==i){var s=i.levels[i.levels.length-1],c=parseInt(null!==(a=t.getAttribute("data-aria-level"))&&void 0!==a?a:"");if(c>0)if(c>i.levels.length)for(;c!=i.levels.length;)i.levels.push(s);else i.levels.splice(c,i.levels.length-1),i.levels[c-1]=s}}},v=function(e,t){"block"===t.style.display&&(e.displayForDummyItem=void 0),e.marginLeft=void 0},g=function(e){e.marginLeft=void 0,e.paddingLeft=void 0};t.processPastedContentWacComponents=function(e){var t;(0,n.default)(e.domToModelOption,"segment",f),(0,n.default)(e.domToModelOption,"listItemThread",v),(0,n.default)(e.domToModelOption,"listLevel",g),(0,n.default)(e.domToModelOption,"container",b),(0,a.setProcessor)(e.domToModelOption,"element",m),(0,a.setProcessor)(e.domToModelOption,"li",p),(0,a.setProcessor)(e.domToModelOption,"ol",h),(0,a.setProcessor)(e.domToModelOption,"ul",h),(t=e.sanitizingOption.additionalAllowedCssClasses).push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(c),!1))};var h=function(e,t,r){var o,n,a,i,s,c=e.blocks[e.blocks.length-1],d=t.closest("."+l);(null===(o=null==d?void 0:d.previousElementSibling)||void 0===o?void 0:o.classList.contains(l))&&"BlockGroup"===(null==c?void 0:c.blockType)&&"ListItem"==c.blockGroupType&&(r.listFormat={threadItemCounts:[],levels:c.levels,listParent:e}),"OL"===t.tagName.toUpperCase()?null===(a=(n=r.defaultElementProcessors).ol)||void 0===a||a.call(n,e,t,r):null===(s=(i=r.defaultElementProcessors).ul)||void 0===s||s.call(i,e,t,r)},b=function(e,t){t.classList.contains(i)&&t.style.marginLeft.startsWith("-")&&delete e.marginLeft}},22:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wordDesktopElementProcessor=t.processPastedContentFromWordDesktop=void 0;var o=r(9079),n=r(2347),a=r(5745),l=r(1246),i=r(9526),s=r(9541),c=r(9263),d=/%/;function u(e,t,r,o){var n;d.test(t.style.lineHeight)&&!isNaN(n=parseInt(t.style.lineHeight))&&n<120&&(e.lineHeight=o.lineHeight)}function f(e,t,r,o){""!=t.style.marginLeft&&(e.marginLeft=o.marginLeft),e.marginBottom=void 0}t.processPastedContentFromWordDesktop=function(e){(0,c.setProcessor)(e.domToModelOption,"element",t.wordDesktopElementProcessor),(0,o.default)(e.domToModelOption,"block",u),(0,o.default)(e.domToModelOption,"listLevel",f),(0,o.default)(e.domToModelOption,"listItemElement",m),(0,n.chainSanitizerCallback)(e.sanitizingOption.cssStyleCallbacks,"border",(function(e,t){return"IMG"!=t.tagName||"none"!=e})),(0,n.chainSanitizerCallback)(e.sanitizingOption.elementCallbacks,"O:P",(function(e){return(0,l.moveChildNodes)(e),e.appendChild(e.ownerDocument.createTextNode(" ")),!0}))},t.wordDesktopElementProcessor=function(e,t,r){var o=(0,a.getStyles)(t);(0,s.processWordList)(o,e,t,r)||(0,i.processWordComments)(o,t)||r.defaultElementProcessors.element(e,t,r)};var m=function(e,t){t.style.marginLeft&&(e.marginLeft=void 0),t.style.marginRight&&(e.marginRight=void 0)}},9526:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processWordComments=void 0;var o=r(1246),n=/#_msocom_/;t.processWordComments=function(e,t){return"comment"==e["mso-special-character"]||(0,o.isElementOfType)(t,"a")&&n.test(t.href)||"comment-list"==e["mso-element"]}},9541:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processWordList=void 0;var o=r(7582),n=r(5745),a=r(1246),l="mso-list",i="ignore";function s(e){return function(t,r,o){var n=o.listFormat,a=n.wordKnownLevels,l=n.wordLevel,i=n.wordList;if("number"==typeof l&&i){var s=parseInt(e);null==s||isNaN(s)||(null==a?void 0:a.has(i))||(t.startNumberOverride=s)}}}function c(e,t){var r,o,n="";t=t||5;for(var l=e.firstChild;!n&&l;)d(l)?0==(n=null!==(o=null===(r=l.textContent)||void 0===r?void 0:r.trim())&&void 0!==o?o:"").length&&(n="o"):(0,a.isNodeOfType)(l,"ELEMENT_NODE")&&t>1&&(n=c(l,t-1)),l=l.nextSibling;return n}function d(e){if((0,a.isNodeOfType)(e,"ELEMENT_NODE")){var t=(0,n.getStyles)(e)[l];if(t&&t.length>0&&t.trim().toLowerCase()==i)return!0}return!1}t.processWordList=function(e,t,r,n){var d=n.listFormat;d.wordKnownLevels||(d.wordKnownLevels=new Map);var u=e[l]||"";if(u.toLowerCase()===i)return!0;var f=u.split(" ");if(d.wordLevel=f[1]&&parseInt(f[1].substr(5)),d.wordList=f[0]||"l0",0==d.levels.length&&(d.levels=d.wordKnownLevels.get(d.wordList)||[]),u&&t&&"number"==typeof d.wordLevel){var m=d.wordLevel,p=c(r),v=function(e){return function(e){return["o","·","§","-"].indexOf(e)>=0}(e)?"UL":"OL"}(p),g=(0,a.createListLevel)(v);if((0,a.parseFormat)(r,n.formatParsers.listLevel,g.format,n),m>d.levels.length)for(;m!=d.levels.length;)d.levels.push(g);else d.levels.splice(m,d.levels.length-1),d.levels[m-1]=g;return d.listParent=t,function(e,t,r,o,n){var l=(0,a.createListItem)(e.levels,t.segmentFormat),i=l.levels[l.levels.length-1];(0,a.parseFormat)(r,t.formatParsers.segmentOnBlock,t.segmentFormat,t),(0,a.parseFormat)(r,t.formatParsers.listItemElement,l.format,t),"OL"==(null==i?void 0:i.listType)&&(0,a.parseFormat)(r,[s(n)],l.levels[l.levels.length-1].format,t),t.elementProcessors.child(l,r,t),(0,a.addBlock)(o,l)}(d,n,r,t,p),d.levels.length>0&&d.wordKnownLevels.get(d.wordList)!=d.levels&&d.wordKnownLevels.set(d.wordList,(0,o.__spreadArray)([],(0,o.__read)(d.levels),!1)),!0}return!1}},5955:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.documentContainWacElements=void 0;var r='ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer,'+["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle"].map((function(e){return'table div[class^="'+e+'"]'})).join(",");t.documentContainWacElements=function(e){return!!e.fragment.querySelector(r)}},5579:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasteSource=void 0;var o=r(5955),n=r(4102),a=r(8954),l=r(7621),i=r(5868),s=r(4555),c=r(5141),d=new Map([["wordDesktop",s.isWordDesktopDocument],["excelDesktop",n.isExcelDesktopDocument],["excelOnline",a.isExcelOnlineDocument],["powerPointDesktop",i.isPowerPointDesktopDocument],["wacComponents",o.documentContainWacElements],["googleSheets",l.isGoogleSheetDocument],["singleImage",c.shouldConvertToSingleImage]]);t.getPasteSource=function(e,t){var r=e.htmlAttributes,o=e.clipboardData,n=e.fragment,a=null,l={htmlAttributes:r,fragment:n,shouldConvertSingleImage:t,clipboardData:o};return d.forEach((function(e,t){!a&&e(l)&&(a=t)})),null!=a?a:"default"}},4102:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isExcelDesktopDocument=void 0,t.isExcelDesktopDocument=function(e){return"urn:schemas-microsoft-com:office:excel"==e.htmlAttributes["xmlns:x"]}},8954:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isExcelOnlineDocument=void 0,t.isExcelOnlineDocument=function(e){var t=e.htmlAttributes;return"Excel.Sheet"==t.ProgId&&null==t["xmlns:x"]}},7621:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isGoogleSheetDocument=void 0,t.isGoogleSheetDocument=function(e){return!!e.fragment.querySelector("google-sheets-html-origin")}},5868:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPowerPointDesktopDocument=void 0,t.isPowerPointDesktopDocument=function(e){return"PowerPoint.Slide"==e.htmlAttributes.ProgId}},4555:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isWordDesktopDocument=void 0,t.isWordDesktopDocument=function(e){var t=e.htmlAttributes;return"urn:schemas-microsoft-com:office:word"==t["xmlns:w"]||"Word.Document"==t.ProgId}},5141:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shouldConvertToSingleImage=void 0,t.shouldConvertToSingleImage=function(e){var t,r=e.shouldConvertSingleImage,o=e.clipboardData;return r&&1==(null===(t=o.htmlFirstLevelChildTags)||void 0===t?void 0:t.length)&&"IMG"==o.htmlFirstLevelChildTags[0]}},9079:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var o;e.additionalFormatParsers||(e.additionalFormatParsers={}),e.additionalFormatParsers[t]||(e.additionalFormatParsers[t]=[]),null===(o=e.additionalFormatParsers[t])||void 0===o||o.push(r)}},251:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deprecatedBorderColorParser=void 0;var o=r(1246);t.deprecatedBorderColorParser=function(e){o.BorderKeys.forEach((function(t){var r=e[t],n="";if(r&&o.DeprecatedColors.some((function(e){return r.indexOf(e)>-1&&(n=e)}))){var a=r.replace(n,"").trimRight();e[t]=a}}))}},5745:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getStyles=void 0,t.getStyles=function(e){var t={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach((function(e){var r=e.indexOf(":"),o=e.slice(0,r),n=e.slice(r+1);o&&n&&(t[o.trim()]=n.trim())})),t}},1152:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseLink=void 0;var o=r(1246),n=["http:","https:","notes:","mailto:","onenote:"],a=/^file:\/\/\/[a-zA-Z\/]/i;t.parseLink=function(e,t){if((0,o.isElementOfType)(t,"a")){var r;try{r=new URL(t.href)}catch(e){r=void 0}(r&&-1===n.indexOf(r.protocol)||a.test(t.href))&&(t.removeAttribute("href"),e.href="")}}},9263:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setProcessor=void 0,t.setProcessor=function(e,t,r){e.processorOverride||(e.processorOverride={}),e.processorOverride[t]=r}},1863:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contentModelDomIndexer=void 0;var o=r(7582),n=r(1246),a=r(5736);function l(e){var t,r=null!==(t=e.__roosterjsContentModel)&&void 0!==t?t:{},o=r.paragraph,n=r.segments;return o&&"Paragraph"==o.blockType&&Array.isArray(o.segments)&&Array.isArray(n)}function i(e,t,r){e.__roosterjsContentModel={paragraph:t,segments:r}}function s(e,t){return(0,n.isNodeOfType)(e,"TEXT_NODE")?l(e)?d(e,t):void 0:t>=e.childNodes.length?c(e.lastChild,!0):c(e.childNodes[t],!1)}function c(e,t){var r;if(e&&l(e)){var o=e.__roosterjsContentModel,a=o.paragraph,i=o.segments,s=a.segments.indexOf(i[0]);if(s>=0){var c=!t&&a.segments[s-1]||a.segments[s];r=(0,n.createSelectionMarker)(c.format),a.segments.splice(t?s+1:s,0,r)}}return r}function d(e,t,r){var a,l,s=e.__roosterjsContentModel,c=s.paragraph,d=s.segments,u=d[0],f=d[d.length-1];if("Text"==(null==u?void 0:u.segmentType)&&"Text"==(null==f?void 0:f.segmentType)){var m=[],p=e.nodeValue||"",v=[];if(void 0===t)u.text=p,m.push(u),v.push(u);else{if(t>0&&(u.text=p.substring(0,t),m.push(u),v.push(u)),void 0===r){var g=(0,n.createSelectionMarker)(u.format);m.push(g),l=g,r=t}else if(r>t){var h=(0,n.createText)(p.substring(t,r),u.format,u.link,u.code);h.isSelected=!0,m.push(h),v.push(h),l=h}if(r<p.length){var b=(0,n.createText)(p.substring(r),u.format,u.link,u.code);m.push(b),v.push(b)}}var y=c.segments.indexOf(u),_=c.segments.indexOf(f);if(y>=0&&_>=0){for(;y>0&&"SelectionMarker"==c.segments[y-1].segmentType;)y--;for(;_<c.segments.length-1&&"SelectionMarker"==c.segments[_+1].segmentType;)_++;(a=c.segments).splice.apply(a,(0,o.__spreadArray)([y,_-y+1],(0,o.__read)(m),!1))}i(e,c,v),delete c.cachedElement}return l}t.contentModelDomIndexer={onSegment:i,onParagraph:function e(t){for(var r=null,o=t.firstChild;o;o=o.nextSibling)if((0,n.isNodeOfType)(o,"TEXT_NODE"))if(r){var a=l(r)?r.__roosterjsContentModel:void 0;a&&l(o)&&(a.segments=a.segments.concat(o.__roosterjsContentModel.segments),o.__roosterjsContentModel.segments=[])}else r=o;else(0,n.isNodeOfType)(o,"ELEMENT_NODE")?(r=null,e(o)):r=null},onTable:function(e,t){e.__roosterjsContentModel={tableRows:t.rows}},reconcileSelection:function(e,t,r){switch(r&&("range"==r.type&&r.range.collapsed&&(0,n.isNodeOfType)(r.range.startContainer,"TEXT_NODE")?l(r.range.startContainer)&&d(r.range.startContainer):(0,a.setSelection)(e)),t.type){case"image":case"table":return!1;case"range":var o=t.range;if(o){var i=o.startContainer,c=o.startOffset,u=o.endContainer,f=o.endOffset;if(o.collapsed)return!!s(i,c);if(i==u&&(0,n.isNodeOfType)(i,"TEXT_NODE"))return l(i)&&!!d(i,c,f);var m=s(i,c),p=s(u,f);return!(!m||!p||((0,a.setSelection)(e,m,p),0))}}return!1}}},4040:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDeleteAllSegmentsBefore=t.shouldDeleteWord=t.handleKeyboardEventResult=void 0;var o=r(1246);t.handleKeyboardEventResult=function(e,t,r,n,a){switch(a.skipUndoSnapshot=!0,n){case 0:return!1;case 3:return r.preventDefault(),!1;case 2:case 1:return r.preventDefault(),(0,o.normalizeContentModel)(t),2==n&&(a.skipUndoSnapshot=!1),e.triggerPluginEvent(23,{rawEvent:r}),!0}},t.shouldDeleteWord=function(e,t){return t&&e.altKey&&!e.metaKey||!t&&e.ctrlKey&&!e.altKey},t.shouldDeleteAllSegmentsBefore=function(e){return e.metaKey&&!e.altKey}},3247:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatWithContentModel=t.insertEntity=t.paste=t.toggleCode=t.setParagraphMargin=t.adjustImageSelection=t.setImageAltText=t.adjustLinkSelection=t.removeLink=t.insertLink=t.clearFormat=t.applyPendingFormat=t.getFormatState=t.changeImage=t.setImageBoxShadow=t.setImageBorder=t.setSpacing=t.toggleBlockQuote=t.setHeadingLevel=t.setDirection=t.setAlignment=t.setIndentation=t.getSelectedSegments=t.hasSelectionInBlockGroup=t.hasSelectionInSegment=t.hasSelectionInBlock=t.setListStartNumber=t.setListStyle=t.insertImage=t.changeCapitalization=t.applySegmentFormat=t.changeFontSize=t.setTextColor=t.setFontSize=t.setFontName=t.setBackgroundColor=t.toggleSuperscript=t.toggleSubscript=t.toggleStrikethrough=t.toggleUnderline=t.toggleItalic=t.toggleBold=t.toggleNumbering=t.toggleBullet=t.applyTableBorderFormat=t.editTable=t.setTableCellShade=t.formatTable=t.insertTable=t.ChangeSource=void 0,t.updateListMetadata=t.updateTableMetadata=t.updateTableCellMetadata=t.updateImageMetadata=t.extractBorderValues=t.combineBorderValue=t.promoteToContentModelEditorCore=t.createContentModelEditorCore=t.ContentModelCachePlugin=t.ContentModelCopyPastePlugin=t.ContentModelTypeInContainerPlugin=t.ContentModelEditPlugin=t.ContentModelFormatPlugin=t.ContentModelPastePlugin=t.isContentModelEditor=t.ContentModelEditor=void 0;var o=r(436);Object.defineProperty(t,"ChangeSource",{enumerable:!0,get:function(){return o.ChangeSource}});var n=r(6901);Object.defineProperty(t,"insertTable",{enumerable:!0,get:function(){return n.default}});var a=r(2435);Object.defineProperty(t,"formatTable",{enumerable:!0,get:function(){return a.default}});var l=r(7783);Object.defineProperty(t,"setTableCellShade",{enumerable:!0,get:function(){return l.default}});var i=r(959);Object.defineProperty(t,"editTable",{enumerable:!0,get:function(){return i.default}});var s=r(2535);Object.defineProperty(t,"applyTableBorderFormat",{enumerable:!0,get:function(){return s.default}});var c=r(58);Object.defineProperty(t,"toggleBullet",{enumerable:!0,get:function(){return c.default}});var d=r(4505);Object.defineProperty(t,"toggleNumbering",{enumerable:!0,get:function(){return d.default}});var u=r(5539);Object.defineProperty(t,"toggleBold",{enumerable:!0,get:function(){return u.default}});var f=r(3462);Object.defineProperty(t,"toggleItalic",{enumerable:!0,get:function(){return f.default}});var m=r(5212);Object.defineProperty(t,"toggleUnderline",{enumerable:!0,get:function(){return m.default}});var p=r(5602);Object.defineProperty(t,"toggleStrikethrough",{enumerable:!0,get:function(){return p.default}});var v=r(2494);Object.defineProperty(t,"toggleSubscript",{enumerable:!0,get:function(){return v.default}});var g=r(1308);Object.defineProperty(t,"toggleSuperscript",{enumerable:!0,get:function(){return g.default}});var h=r(5253);Object.defineProperty(t,"setBackgroundColor",{enumerable:!0,get:function(){return h.default}});var b=r(1250);Object.defineProperty(t,"setFontName",{enumerable:!0,get:function(){return b.default}});var y=r(5442);Object.defineProperty(t,"setFontSize",{enumerable:!0,get:function(){return y.default}});var _=r(9715);Object.defineProperty(t,"setTextColor",{enumerable:!0,get:function(){return _.default}});var C=r(7451);Object.defineProperty(t,"changeFontSize",{enumerable:!0,get:function(){return C.default}});var P=r(4847);Object.defineProperty(t,"applySegmentFormat",{enumerable:!0,get:function(){return P.default}});var S=r(5284);Object.defineProperty(t,"changeCapitalization",{enumerable:!0,get:function(){return S.default}});var k=r(2930);Object.defineProperty(t,"insertImage",{enumerable:!0,get:function(){return k.default}});var O=r(3e3);Object.defineProperty(t,"setListStyle",{enumerable:!0,get:function(){return O.default}});var T=r(1123);Object.defineProperty(t,"setListStartNumber",{enumerable:!0,get:function(){return T.default}});var M=r(6516);Object.defineProperty(t,"hasSelectionInBlock",{enumerable:!0,get:function(){return M.default}});var w=r(5676);Object.defineProperty(t,"hasSelectionInSegment",{enumerable:!0,get:function(){return w.default}});var E=r(7536);Object.defineProperty(t,"hasSelectionInBlockGroup",{enumerable:!0,get:function(){return E.default}});var F=r(6331);Object.defineProperty(t,"getSelectedSegments",{enumerable:!0,get:function(){return F.default}});var x=r(3721);Object.defineProperty(t,"setIndentation",{enumerable:!0,get:function(){return x.default}});var j=r(5149);Object.defineProperty(t,"setAlignment",{enumerable:!0,get:function(){return j.default}});var B=r(8365);Object.defineProperty(t,"setDirection",{enumerable:!0,get:function(){return B.default}});var L=r(2923);Object.defineProperty(t,"setHeadingLevel",{enumerable:!0,get:function(){return L.default}});var D=r(1977);Object.defineProperty(t,"toggleBlockQuote",{enumerable:!0,get:function(){return D.default}});var A=r(9294);Object.defineProperty(t,"setSpacing",{enumerable:!0,get:function(){return A.default}});var I=r(4653);Object.defineProperty(t,"setImageBorder",{enumerable:!0,get:function(){return I.default}});var N=r(4735);Object.defineProperty(t,"setImageBoxShadow",{enumerable:!0,get:function(){return N.default}});var R=r(8401);Object.defineProperty(t,"changeImage",{enumerable:!0,get:function(){return R.default}});var H=r(7950);Object.defineProperty(t,"getFormatState",{enumerable:!0,get:function(){return H.default}});var W=r(1576);Object.defineProperty(t,"applyPendingFormat",{enumerable:!0,get:function(){return W.default}});var z=r(2313);Object.defineProperty(t,"clearFormat",{enumerable:!0,get:function(){return z.default}});var G=r(7058);Object.defineProperty(t,"insertLink",{enumerable:!0,get:function(){return G.default}});var U=r(3932);Object.defineProperty(t,"removeLink",{enumerable:!0,get:function(){return U.default}});var K=r(1270);Object.defineProperty(t,"adjustLinkSelection",{enumerable:!0,get:function(){return K.default}});var V=r(2063);Object.defineProperty(t,"setImageAltText",{enumerable:!0,get:function(){return V.default}});var q=r(6623);Object.defineProperty(t,"adjustImageSelection",{enumerable:!0,get:function(){return q.default}});var $=r(7339);Object.defineProperty(t,"setParagraphMargin",{enumerable:!0,get:function(){return $.default}});var X=r(1340);Object.defineProperty(t,"toggleCode",{enumerable:!0,get:function(){return X.default}});var Y=r(5915);Object.defineProperty(t,"paste",{enumerable:!0,get:function(){return Y.default}});var Q=r(9894);Object.defineProperty(t,"insertEntity",{enumerable:!0,get:function(){return Q.default}});var Z=r(2511);Object.defineProperty(t,"formatWithContentModel",{enumerable:!0,get:function(){return Z.formatWithContentModel}});var J=r(6593);Object.defineProperty(t,"ContentModelEditor",{enumerable:!0,get:function(){return J.default}});var ee=r(1053);Object.defineProperty(t,"isContentModelEditor",{enumerable:!0,get:function(){return ee.default}});var te=r(1021);Object.defineProperty(t,"ContentModelPastePlugin",{enumerable:!0,get:function(){return te.default}});var re=r(4607);Object.defineProperty(t,"ContentModelFormatPlugin",{enumerable:!0,get:function(){return re.default}});var oe=r(9647);Object.defineProperty(t,"ContentModelEditPlugin",{enumerable:!0,get:function(){return oe.default}});var ne=r(2517);Object.defineProperty(t,"ContentModelTypeInContainerPlugin",{enumerable:!0,get:function(){return ne.default}});var ae=r(6093);Object.defineProperty(t,"ContentModelCopyPastePlugin",{enumerable:!0,get:function(){return ae.default}});var le=r(1940);Object.defineProperty(t,"ContentModelCachePlugin",{enumerable:!0,get:function(){return le.default}});var ie=r(8974);Object.defineProperty(t,"createContentModelEditorCore",{enumerable:!0,get:function(){return ie.createContentModelEditorCore}}),Object.defineProperty(t,"promoteToContentModelEditorCore",{enumerable:!0,get:function(){return ie.promoteToContentModelEditorCore}});var se=r(9843);Object.defineProperty(t,"combineBorderValue",{enumerable:!0,get:function(){return se.combineBorderValue}}),Object.defineProperty(t,"extractBorderValues",{enumerable:!0,get:function(){return se.extractBorderValues}});var ce=r(5866);Object.defineProperty(t,"updateImageMetadata",{enumerable:!0,get:function(){return ce.updateImageMetadata}});var de=r(860);Object.defineProperty(t,"updateTableCellMetadata",{enumerable:!0,get:function(){return de.updateTableCellMetadata}});var ue=r(5165);Object.defineProperty(t,"updateTableMetadata",{enumerable:!0,get:function(){return ue.updateTableMetadata}});var fe=r(7410);Object.defineProperty(t,"updateListMetadata",{enumerable:!0,get:function(){return fe.updateListMetadata}})},5567:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLeafSiblingBlock=void 0;var o=r(7582),n=r(1246);t.getLeafSiblingBlock=function(e,t,r){for(var a,l=(0,o.__spreadArray)([],(0,o.__read)(e),!1),i=function(){var e=l[0],o=e.blocks.indexOf(t);if(o<0)return"break";var i=e.blocks[o+(r?1:-1)];if(i){for(;"BlockGroup"==i.blockType;){var s=i.blocks[r?0:i.blocks.length-1];if(!s)return{value:{block:i,path:l}};if("BlockGroup"!=s.blockType)return l.unshift(i),{value:{block:s,path:l}};l.unshift(i),i=s}return{value:{block:i,path:l}}}if((0,n.isGeneralSegment)(e)){l.shift();var c=-1,d=e,u=null===(a=l[0])||void 0===a?void 0:a.blocks.find((function(e){return"Paragraph"==e.blockType&&(c=e.segments.indexOf(d))>=0}));if(!u)return"break";var f=u.segments[c+(r?1:-1)];if(f)return{value:{block:u,path:l,siblingSegment:f}};t=u}else{if("Document"==e.blockGroupType||"TableCell"==e.blockGroupType)return"break";l.shift(),t=e}};l.length>0;){var s=i();if("object"==typeof s)return s.value;if("break"===s)break}return null}},9842:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setModelAlignment=void 0;var o=r(6682),n=r(5544),a={left:{ltr:"start",rtl:"end"},center:{ltr:"center",rtl:"center"},right:{ltr:"end",rtl:"start"}},l={left:{ltr:"alignLeft",rtl:"alignRight"},center:{ltr:"alignCenter",rtl:"alignCenter"},right:{ltr:"alignRight",rtl:"alignLeft"}};t.setModelAlignment=function(e,t){var r=(0,n.getOperationalBlocks)(e,["ListItem"],["TableCell"]);return r.forEach((function(e){var r=e.block,n=a[t]["rtl"==r.format.direction?"rtl":"ltr"];"Table"===r.blockType?(0,o.alignTable)(r,l[t]["rtl"==r.format.direction?"rtl":"ltr"]):r&&(r.format.textAlign=n)})),r.length>0}},5078:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setModelDirection=void 0;var o=r(2874),n=r(5544),a=r(4979);function l(e,t){if("rtl"==e.direction!=("rtl"==t)){e.direction=t;var r=e.marginLeft,o=e.paddingLeft;i(e,"marginLeft",e.marginRight),i(e,"marginRight",r),i(e,"paddingLeft",e.paddingRight),i(e,"paddingRight",o)}}function i(e,t,r){r?e[t]=r:delete e[t]}t.setModelDirection=function(e,t){var r=(0,n.getOperationalBlocks)(e,["ListItem"],["TableCell"]);return r.forEach((function(r){var n=r.block;(0,a.isBlockGroupOfType)(n,"ListItem")?(0,o.findListItemsInSameThread)(e,n).forEach((function(e){e.levels.forEach((function(e){e.format.direction=t})),e.blocks.forEach((function(e){return l(e.format,t)}))})):n&&l(n.format,t)})),r.length>0}},687:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setModelIndentation=void 0;var o=r(1246),n=r(5544),a=r(4979);t.setModelIndentation=function(e,t,r){void 0===r&&(r=40);var l=(0,n.getOperationalBlocks)(e,["ListItem"],["TableCell"]),i="indent"==t;return l.forEach((function(e){var t=e.block;if((0,a.isBlockGroupOfType)(t,"ListItem"))if(i){var n=t.levels[t.levels.length-1],l=(0,o.createListLevel)((null==n?void 0:n.listType)||"UL",null==n?void 0:n.format);delete l.format.startNumberOverride,t.levels.push(l)}else t.levels.pop();else if(t){var s=t.format,c=s.marginLeft,d=s.marginRight,u="rtl"==s.direction,f=(0,o.parseValueWithUnit)(u?d:c),m=(i?Math.ceil:Math.floor)(f/r)*r;m==f&&(m=Math.max(m+r*(i?1:-1),0)),u?s.marginRight=m+"px":s.marginLeft=m+"px"}})),l.length>0}},6162:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleModelBlockQuote=void 0;var o=r(1246),n=r(5544),a=r(4979),l=r(1953);function i(e){return(0,a.isBlockGroupOfType)(e,"FormatContainer")&&"blockquote"==e.tagName}t.toggleModelBlockQuote=function(e,t){var r=(0,n.getOperationalBlocks)(e,["FormatContainer","ListItem"],["TableCell"],!0);if(r.every((function(e){return i(e.block)})))r.forEach((function(e){var t=e.block,r=e.parent;(0,o.unwrapBlock)(r,t)}));else{var a=[],s=function(){return(0,o.createFormatContainer)("blockquote",t)},c=function(e,r){return function(e,t){return i(e)&&(0,o.areSameFormats)(t,e.format)}(e,(null==r?void 0:r.format)||t)};r.forEach((function(e){var t=e.block,r=e.parent;i(t)||(0,l.wrapBlockStep1)(a,r,t,s,c)})),(0,l.wrapBlockStep2)(a,c)}return r.length>0}},512:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearModelFormat=void 0;var o=r(7582),n=r(5294),a=r(4158),l=r(1246),i=r(4829),s=r(5098),c=r(860),d=r(5165);function u(e,t){var r=(0,i.getClosestAncestorBlockGroupIndex)(e,["FormatContainer"],["TableCell"]);if(r>=0&&r<e.length-1){var o=e[r],n=e[r+1].blocks.indexOf(o),a=o.blocks.indexOf(t);if(a>=0&&n>=0){var s=(0,l.createFormatContainer)(o.tagName,o.format);o.blocks.splice(a,1),s.blocks=o.blocks.splice(a),e[r+1].blocks.splice(n+1,0,t,s)}}}function f(e){var t=e[(0,i.getClosestAncestorBlockGroupIndex)(e,["ListItem"],["TableCell"])];t&&(t.levels=[])}function m(e,t){if("Divider"==t.blockType){var r=e[0].blocks.indexOf(t);r>=0&&e[0].blocks.splice(r,1)}else"Paragraph"==t.blockType&&(t.format={},delete t.decorator)}t.clearModelFormat=function(e,t,r,l){(0,s.iterateSelections)([e],(function(e,n,a,i){i&&r.push.apply(r,(0,o.__spreadArray)([],(0,o.__read)(i),!1)),a?t.push([e,a]):n&&function(e,t){if(e){var r=e.table,o=e.colIndex,n=e.rowIndex,a=e.isWholeTableSelected,l=r.rows[n].cells[o];l.isSelected&&((0,c.updateTableCellMetadata)(l,(function(){return null})),l.isHeader=!1,l.format={useBorderBox:l.format.useBorderBox}),t.find((function(e){return e[0]==r}))||t.push([r,a])}}(n,l)}),{includeListFormatHolder:e.format?"never":"anySegment"});var i=r[0];if(1==t.length&&function(e){var t="Paragraph"==e.blockType?e.segments.filter((function(e){return e.isSelected})):[];return 1==t.length&&"SelectionMarker"==t[0].segmentType}(t[0][1])&&1==t.length)r.splice.apply(r,(0,o.__spreadArray)([0,r.length],(0,o.__read)((0,n.adjustWordSelection)(e,i)),!1)),f(t[0][0]);else if(t.length>1||t.some((function(e){return function(e){return e.isSelected||"Paragraph"==e.blockType&&e.segments.every((function(e){return e.isSelected}))}(e[1])})))for(var p=t.length-1;p>=0;p--){var v=(0,o.__read)(t[p],2),g=v[0],h=v[1];m(g,h),f(g),u(g,h)}!function(e,t){e.forEach((function(e){e.format=(0,o.__assign)({},t||{}),e.link&&delete e.link.format.textColor,delete e.code}))}(r,e.format),function(e){e.forEach((function(e){var t=(0,o.__read)(e,2),r=t[0];t[1]&&(r.format={useBorderBox:r.format.useBorderBox,borderCollapse:r.format.borderCollapse},(0,d.updateTableMetadata)(r,(function(){return null}))),(0,a.applyTableFormat)(r,void 0,!0)}))}(l)}},1690:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cloneModel=void 0;var o=r(7582);function n(e){return{format:Object.assign({},e.format)}}function a(e){return{dataset:Object.assign({},e.dataset)}}function l(e){var t=e.blockType;return Object.assign({blockType:t},n(e))}function i(e,t){return{blockGroupType:e.blockGroupType,blocks:e.blocks.map((function(e){return function(e,t){switch(e.blockType){case"BlockGroup":switch(e.blockGroupType){case"FormatContainer":return function(e,t){var r=e.tagName,o=e.cachedElement,n=Object.assign({tagName:r,cachedElement:m(o,"cache",t)},l(e),i(e,t));return e.zeroFontSize&&(n.zeroFontSize=!0),n}(e,t);case"General":return u(e,t);case"ListItem":return function(e,t){var r=e.formatHolder,o=e.levels;return Object.assign({formatHolder:f(r),levels:o.map(d)},l(e),i(e,t))}(e,t)}break;case"Divider":return function(e,t){var r=e.tagName,o=e.isSelected,n=e.cachedElement;return Object.assign({isSelected:o,tagName:r,cachedElement:m(n,"cache",t)},l(e))}(e,t);case"Entity":return c(e,t);case"Paragraph":return function(e,t){var r=e.cachedElement,i=e.segments,d=e.isImplicit,p=e.decorator,v=e.segmentFormat,g=Object.assign({cachedElement:m(r,"cache",t),isImplicit:d,segments:i.map((function(e){return function(e,t){switch(e.segmentType){case"Br":return s(e);case"Entity":return c(e,t);case"General":return function(e,t){return Object.assign(u(e,t),s(e))}(e,t);case"Image":return l=(n=e).src,i=n.alt,d=n.title,m=n.isSelectedAsImageSelection,Object.assign({src:l,alt:i,title:d,isSelectedAsImageSelection:m},s(n),a(n));case"SelectionMarker":return f(e);case"Text":return o=(r=e).text,Object.assign({text:o},s(r))}var r,o,n,l,i,d,m}(e,t)})),segmentFormat:v?(0,o.__assign)({},v):void 0},l(e),n(e));return p&&(g.decorator=Object.assign({tagName:p.tagName},n(p))),g}(e,t);case"Table":return function(e,t){var r=e.cachedElement,o=e.widths,s=e.rows;return Object.assign({cachedElement:m(r,"cache",t),widths:Array.from(o),rows:s.map((function(e){return function(e,t){var r=e.height,o=e.cells,l=e.cachedElement;return Object.assign({height:r,cachedElement:m(l,"cache",t),cells:o.map((function(e){return function(e,t){var r=e.cachedElement,o=e.isSelected,l=e.spanAbove,s=e.spanLeft,c=e.isHeader;return Object.assign({cachedElement:m(r,"cache",t),isSelected:o,spanAbove:l,spanLeft:s,isHeader:c},i(e,t),n(e),a(e))}(e,t)}))},n(e))}(e,t)}))},l(e),a(e))}(e,t)}}(e,t)}))}}function s(e){var t=e.segmentType,r=e.isSelected,o=e.code,l=e.link,i=Object.assign({segmentType:t,isSelected:r},n(e));return o&&(i.code=n(o)),l&&(i.link=Object.assign(n(l),a(l))),i}function c(e,t){var r=e.wrapper,n=e.entityFormat;return Object.assign({wrapper:m(r,"entity",t),entityFormat:(0,o.__assign)({},n)},l(e),s(e))}function d(e){var t=e.listType;return Object.assign({listType:t},n(e),a(e))}function u(e,t){var r=e.element;return Object.assign({element:m(r,"general",t)},l(e),i(e,t))}function f(e){return Object.assign({isSelected:e.isSelected},s(e))}function m(e,t,r){var o=r.includeCachedElement;if(e){if(o){if(!0===o)return e;var n=o(e,t);if(("general"==t||"entity"==t)&&!n)throw new Error("Entity and General Model must has wrapper element");return n}return"cache"==t?void 0:e.cloneNode(!0)}}t.cloneModel=function(e,t){var r=i(e,t||{});return e.format&&(r.format=Object.assign({},e.format)),r}},4829:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getClosestAncestorBlockGroupIndex=void 0,t.getClosestAncestorBlockGroupIndex=function(e,t,r){void 0===r&&(r=[]);for(var o=0;o<e.length;o++){var n=e[o];if(t.indexOf(n.blockGroupType)>=0)return o;if(r.indexOf(n.blockGroupType)>=0)return-1}return-1}},4979:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBlockGroupOfType=void 0,t.isBlockGroupOfType=function(e,t){return(null==e?void 0:e.blockGroupType)==t}},485:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeModel=void 0;var o=r(7582),n=r(4158),a=r(473),l=r(4829),i=r(1303),s=r(1246),c=["h1","h2","h3","h4","h5","h6"];function d(e,t,r,n,a){var l=e.paragraph,i=e.marker,d=r?l:m(e,t.format),u=d.segments.indexOf(i);if("none"==(null==a?void 0:a.mergeFormat)&&r&&(d.segments.forEach((function(e){e.format=(0,o.__assign)((0,o.__assign)({},d.segmentFormat||{}),e.format)})),delete d.segmentFormat),u>=0)for(var f=0;f<t.segments.length;f++){var p=t.segments[f];d.segments.splice(u+f,0,p),n&&("Entity"==p.segmentType&&n.newEntities.push(p),"Image"==p.segmentType&&n.newImages.push(p))}if(t.decorator&&(d.decorator=(0,o.__assign)({},t.decorator),c.indexOf(d.decorator.tagName)>-1)){var v=(0,s.getObjectKeys)(d.decorator.format),g=(0,s.getObjectKeys)(d.segmentFormat||{});v.forEach((function(e){var t;g.indexOf(e)>-1&&(null===(t=d.segmentFormat)||void 0===t||delete t[e])}))}r||(d.format=t.format)}function u(e,t,r){var o,a,l=e.tableContext,c=e.marker;if(l&&1==r.blocks.length&&r.blocks[0]==t){for(var d=l.table,u=l.colIndex,f=l.rowIndex,m=0;m<t.rows.length;m++)for(var v=0;v<t.rows[m].cells.length;v++){var g=t.rows[m].cells[v];if(0==m&&u+v>=d.rows[0].cells.length)for(var h=0;h<d.rows.length;h++){var b=null===(o=d.rows[h])||void 0===o?void 0:o.cells[u+v-1];d.rows[h].cells[u+v]=(0,s.createTableCell)(!1,!1,null==b?void 0:b.isHeader,null==b?void 0:b.format)}if(0==v&&f+m>=d.rows.length)for(d.rows[f+m]||(d.rows[f+m]={cells:[],format:{},height:0}),h=0;h<d.rows[f].cells.length;h++){var y=null===(a=d.rows[f+m-1])||void 0===a?void 0:a.cells[h];d.rows[f+m].cells[h]=(0,s.createTableCell)(!1,!1,!1,null==y?void 0:y.format)}var _=d.rows[f+m].cells[u+v];if(d.rows[f+m].cells[u+v]=g,0==m&&0==v){var C=(0,s.createSelectionMarker)(c.format),P=(0,s.addSegment)(g,C);e.path[0]==_&&(e.path[0]=g,e.marker=C,e.paragraph=P)}}(0,i.normalizeTable)(d,e.marker.format),(0,n.applyTableFormat)(d,void 0,!0)}else p(e,t)}function f(e,t){m(e,t.format);var r=e.path,n=e.paragraph,a=(0,l.getClosestAncestorBlockGroupIndex)(r,["ListItem"]),i=r[a],s=r[a+1],c=s.blocks.indexOf(i||n);c>=0&&s.blocks.splice(c,0,t),i&&(null==i||i.levels.forEach((function(e,r){t.levels[r]=(0,o.__assign)({},e)})))}function m(e,t){var r=e.paragraph,n=e.marker,a=e.path,i=r.segments.indexOf(n),c=a[0].blocks.indexOf(r),d=(0,s.createParagraph)(!1,(0,o.__assign)((0,o.__assign)({},r.format),t),r.segmentFormat);i>=0&&(d.segments=r.segments.splice(i)),c>=0&&a[0].blocks.splice(c+1,0,d);var u=(0,l.getClosestAncestorBlockGroupIndex)(a,["ListItem"],["FormatContainer","TableCell"]),f=a[u];if(f){var m=u>=0?a[u+1]:null,p=m?m.blocks.indexOf(f):-1;if(p>=0&&m){var v=(0,s.createListItem)(f.levels,f.formatHolder.format);c>=0&&(v.blocks=f.blocks.splice(c+1)),p>=0&&m.blocks.splice(p+1,0,v),a[u]=v}}return e.paragraph=d,d}function p(e,t){var r=e.path,o=m(e,"Paragraph"!==t.blockType?{}:t.format),n=r[0].blocks.indexOf(o);n>=0&&r[0].blocks.splice(n,0,t)}function v(e,t,r){e.blocks.forEach((function(e){var n;switch(e.blockType){case"BlockGroup":"ListItem"==e.blockGroupType&&(e.formatHolder.format=g(r,t,e.formatHolder.format)),v(e,t,r);break;case"Table":e.rows.forEach((function(e){return e.cells.forEach((function(e){v(e,t,r)}))}));break;case"Paragraph":var a=(null===(n=e.decorator)||void 0===n?void 0:n.format)||{};e.segments.forEach((function(e){"General"==e.segmentType&&v(e,t,r),e.format=g(r,t,(0,o.__assign)((0,o.__assign)({},a),e.format))})),"keepSourceEmphasisFormat"===r&&delete e.decorator}}))}function g(e,t,r){return"mergeAll"==e?(0,o.__assign)((0,o.__assign)({},t),r):(0,o.__assign)((0,o.__assign)({},t),(a={},l=(n=r).fontWeight,i=n.italic,s=n.underline,l&&"normal"!=l&&(a.fontWeight=l),i&&(a.italic=i),s&&(a.underline=s),a));var n,a,l,i,s}t.mergeModel=function(e,t,r,n){var l,i=null!==(l=null==n?void 0:n.insertPosition)&&void 0!==l?l:(0,a.deleteSelection)(e,[],r).insertPoint;if(i){(null==n?void 0:n.mergeFormat)&&"none"!=n.mergeFormat&&v(t,(0,o.__assign)((0,o.__assign)({},e.format||{}),i.marker.format),null==n?void 0:n.mergeFormat);for(var c=0;c<t.blocks.length;c++){var m=t.blocks[c];switch(m.blockType){case"Paragraph":d(i,m,0==c,r,n);break;case"Divider":p(i,m);break;case"Entity":p(i,m),null==r||r.newEntities.push(m);break;case"Table":1==t.blocks.length&&(null==n?void 0:n.mergeTable)?u(i,m,t):p(i,m);break;case"BlockGroup":switch(m.blockGroupType){case"General":case"FormatContainer":p(i,m);break;case"ListItem":f(i,m)}}}}return(0,s.normalizeContentModel)(e),i}},2229:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveModelFormatState=void 0;var o=r(9843),n=r(4829),a=r(5539),l=r(5098),i=r(5165);function s(e,t,r,o){o?void 0!==r&&(e[t]=r):r!==e[t]&&delete e[t]}t.retrieveModelFormatState=function(e,t,r){var c,d,u,f=!0,m=!0,p=!0;(0,l.iterateSelections)([e],(function(l,u,v,g){if(function(e,t,r){var o,a,l=(0,n.getClosestAncestorBlockGroupIndex)(t,["ListItem"],[]),i=(0,n.getClosestAncestorBlockGroupIndex)(t,["FormatContainer"],[]);if(l>=0){var c=t[l],d=null===(o=null==c?void 0:c.levels[c.levels.length-1])||void 0===o?void 0:o.listType;s(e,"isBullet","UL"==d,r),s(e,"isNumbering","OL"==d,r)}s(e,"isBlockQuote",i>=0&&"blockquote"==(null===(a=t[i])||void 0===a?void 0:a.tagName),r)}(r,l,f),v&&(d?r.isMultilineSelection=!0:d=v),"Paragraph"==(null==v?void 0:v.blockType)&&(function(e,t,r){var o,n=parseInt(((null===(o=t.decorator)||void 0===o?void 0:o.tagName)||"").substring(1)),a=n>=1&&n<=6?n:void 0;s(e,"marginBottom",t.format.marginBottom,r),s(e,"marginTop",t.format.marginTop,r),s(e,"headingLevel",a,r),s(e,"textAlign",t.format.textAlign,r),s(e,"direction",t.format.direction,r)}(r,v,f),null==g||g.forEach((function(n){var l,i,c,d,u,h,b,y,_;if(p||"SelectionMarker"!=n.segmentType){var C=Object.assign({},e.format);null==C||delete C.italic,null==C||delete C.underline,null==C||delete C.fontWeight,function(e,t,r){var o,n,l=null===(n=null===(o=r.superOrSubScriptSequence)||void 0===o?void 0:o.split(" "))||void 0===n?void 0:n.pop();s(e,"isBold",(0,a.isBold)(r.fontWeight),t),s(e,"isItalic",r.italic,t),s(e,"isUnderline",r.underline,t),s(e,"isStrikeThrough",r.strikethrough,t),s(e,"isSuperscript","super"==l,t),s(e,"isSubscript","sub"==l,t),s(e,"letterSpacing",r.letterSpacing,t),s(e,"fontName",r.fontFamily,t),s(e,"fontSize",r.fontSize,t),s(e,"backgroundColor",r.backgroundColor,t),s(e,"textColor",r.textColor,t),s(e,"fontWeight",r.fontWeight,t),s(e,"lineHeight",r.lineHeight,t)}(r,f,Object.assign({},C,v.format,null===(l=v.decorator)||void 0===l?void 0:l.format,n.format,null===(i=n.code)||void 0===i?void 0:i.format,null===(c=n.link)||void 0===c?void 0:c.format,t)),s(r,"isCodeInline",!!(null==n?void 0:n.code),f)}p=!1,r.canUnlink=r.canUnlink||!!n.link,r.canAddImageAltText=r.canAddImageAltText||g.some((function(e){return"Image"==e.segmentType})),f=!1,"Image"===n.segmentType&&(m?(d=r,u=n.format,"borderTop",b=(h=(0,o.extractBorderValues)(u.borderTop)).color,y=h.width,_=h.style,d.imageFormat={borderColor:b,borderWidth:y,borderStyle:_,boxShadow:u.boxShadow,borderRadius:u.borderRadius},m=!1):r.imageFormat=void 0)})),f=!1),u)if(c){var h=c.table,b=c.colIndex,y=c.rowIndex;u.table!=h||u.colIndex==b&&u.rowIndex==y||(r.canMergeTableCell=!0,r.isMultilineSelection=!0)}else!function(e,t){var r=(0,i.updateTableMetadata)(e.table);t.isInTable=!0,t.tableHasHeader=e.table.rows.some((function(e){return e.cells.some((function(e){return e.isHeader}))})),r&&(t.tableFormat=r)}(u,r),c=u}),{includeListFormatHolder:"never"}),r.fontSize&&(r.fontSize=(u=r.fontSize)&&u.indexOf("px")==u.length-2?Math.round(75*parseFloat(u)+.05)/100+"pt":u)}},1953:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrapBlockStep2=t.wrapBlockStep1=void 0;var o=r(7582),n=r(1246);t.wrapBlockStep1=function(e,t,r,o,a){var l,i=null!==(l=null==t?void 0:t.blocks.indexOf(r))&&void 0!==l?l:-1;if(t&&i>=0){t.blocks.splice(i,1);var s=t.blocks[i-1],c=a(s)?s:function(e,t,r){var o=r();return e.blocks.splice(t,0,o),o}(t,i,o);(0,n.setParagraphNotImplicit)(r),(0,n.addBlock)(c,r),e.unshift({parent:t,wrapper:c})}},t.wrapBlockStep2=function(e,t){e.forEach((function(e){var r,a=e.parent,l=e.wrapper,i=a.blocks.indexOf(l),s=a.blocks[i+1];i>=0&&t(s,l)&&(l.blocks.forEach(n.setParagraphNotImplicit),(r=l.blocks).push.apply(r,(0,o.__spreadArray)([],(0,o.__read)(s.blocks),!1)),a.blocks.splice(i+1,1))}))}},473:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSelection=void 0;var o=r(7582),n=r(2650);t.deleteSelection=function(e,t,r){void 0===t&&(t=[]);var a=(0,n.deleteExpandedSelection)(e,r);return t.forEach((function(e){e&&function(e){return!!e.insertPoint}(a)&&0==a.deleteResult&&e(a)})),function(e){var t,r=e.insertPoint,n=e.deleteResult,a=e.lastParagraph,l=e.lastTableContext;r&&0!=n&&3!=n&&a&&a!=r.paragraph&&l==r.tableContext&&((t=r.paragraph.segments).push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(a.segments),!1)),a.segments=[])}(a),a}},1685:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteAllSegmentBefore=void 0;var o=r(7483);t.deleteAllSegmentBefore=function(e){for(var t=e.insertPoint,r=t.paragraph,n=t.marker,a=r.segments.indexOf(n)-1;a>=0;a--){var l=r.segments[a];l.isSelected=!0,(0,o.deleteSegment)(r,l,e.formatContext)&&(e.deleteResult=2)}}},8689:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backwardDeleteCollapsedSelection=t.forwardDeleteCollapsedSelection=void 0;var o=r(1647),n=r(5911),a=r(7483),l=r(5567),i=r(1246);function s(e){return function(t){var r,s="forward"==e,c=t.insertPoint,d=c.paragraph,u=c.marker,f=c.path,m=c.tableContext,p=d.segments;!function(e){var t,r;if("Br"==(null===(t=e[e.length-1])||void 0===t?void 0:t.segmentType)){var o=e.filter((function(e){return"SelectionMarker"!=e.segmentType}));"Br"!=(null===(r=o[o.length-2])||void 0===r?void 0:r.segmentType)&&e.pop()}}(p);var v,g=p.indexOf(u)+(s?1:-1),h=p[g];if(h)(0,a.deleteSegment)(d,h,t.formatContext,e)&&(t.deleteResult=1,(0,i.setParagraphNotImplicit)(d));else if(v=(0,l.getLeafSiblingBlock)(f,d,s)){var b=v.block,y=v.path,_=v.siblingSegment;"Paragraph"==b.blockType?(_?(0,a.deleteSegment)(b,_,t.formatContext,e)&&(t.deleteResult=2):(s?t.lastParagraph=b:("Br"==(null===(r=b.segments[b.segments.length-1])||void 0===r?void 0:r.segmentType)&&b.segments.pop(),t.insertPoint=(0,o.createInsertPoint)(u,b,y,m),t.lastParagraph=d,delete b.cachedElement),t.deleteResult=2),t.lastTableContext=m):(0,n.deleteBlock)(y[0].blocks,b,void 0,t.formatContext,e)&&(t.deleteResult=2)}else t.deleteResult=3}}t.forwardDeleteCollapsedSelection=s("forward"),t.backwardDeleteCollapsedSelection=s("backward")},3731:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backwardDeleteWordSelection=t.forwardDeleteWordSelection=void 0;var o,n=r(7582),a=r(8778),l=r(1246);function i(e){return function(t){for(var r=t.insertPoint,o=r.marker,i=r.paragraph,s=i.segments.indexOf(o),c="forward"==e,d=function(e,t,r,o){var i,s,c,d,u,f,m,p,v,g;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:i=r?1:-1,s=e.segments,c=(0,l.isWhiteSpacePreserved)(e),d=t+i,n.label=1;case 1:if(!(d>=0&&d<s.length))return[3,12];switch((u=s[d]).segmentType){case"Text":return[3,2];case"Image":return[3,7];case"SelectionMarker":return[3,9]}return[3,10];case 2:f=r?0:u.text.length-1,n.label=3;case 3:return f>=0&&f<u.text.length?(m=u.text[f],p=(0,a.isPunctuation)(m),v=(0,a.isSpace)(m),[4,{punctuation:p,space:v,text:!p&&!v}]):[3,6];case 4:if(n.sent()){if(g=(g=u.text).substring(0,f)+g.substring(f+1),c||(g=(0,a.normalizeText)(g,r)),o.deleteResult=2,!g)return s.splice(d,1),i>0&&(d-=i),[3,6];u.text=g,i>0&&(f-=i)}n.label=5;case 5:return f+=i,[3,3];case 6:return[3,11];case 7:return[4,{punctuation:!0,space:!1,text:!1}];case 8:return n.sent()&&(s.splice(d,1),i>0&&(d-=i),o.deleteResult=2),[3,11];case 9:return[3,11];case 10:return[2,null];case 11:return d+=i,[3,1];case 12:return[2,null]}}))}(i,s,c,t),u=d.next(),f=0;5!=f&&!u.done;){var m=u.value,p=m.punctuation,v=m.space,g=m.text;switch(f){case 0:f=v?4:p?1:2,u=d.next(!0);break;case 1:c&&v?(f=3,u=d.next(!0)):p?u=d.next(!0):f=5;break;case 2:c&&v?(f=3,u=d.next(!0)):g?u=d.next(!0):f=5;break;case 3:p||!v?f=5:u=d.next(!0);break;case 4:v?u=d.next(!0):p?(f=c?3:1,u=d.next(!0)):f=c?5:2}}}}!function(e){e[e.Start=0]="Start",e[e.Punctuation=1]="Punctuation",e[e.Text=2]="Text",e[e.NonText=3]="NonText",e[e.Space=4]="Space",e[e.End=5]="End"}(o||(o={})),t.forwardDeleteWordSelection=i("forward"),t.backwardDeleteWordSelection=i("backward")},1647:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createInsertPoint=void 0,t.createInsertPoint=function(e,t,r,o){return{marker:e,paragraph:t,path:r,tableContext:o}}},5911:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBlock=void 0,t.deleteBlock=function(e,t,r,o,n){var a=e.indexOf(t);switch(t.blockType){case"Table":case"Divider":return r?e.splice(a,1,r):e.splice(a,1),!0;case"Entity":var l=t.isSelected?"overwrite":"forward"==n?"removeFromStart":"backward"==n?"removeFromEnd":void 0;return void 0!==l&&(r?e.splice(a,1,r):e.splice(a,1),null==o||o.deletedEntities.push({entity:t,operation:l})),!0;case"BlockGroup":switch(t.blockGroupType){case"General":return!!r&&(e.splice(a,1,r),!0);case"ListItem":case"FormatContainer":return e.splice(a,1),!0}}return!1}},2650:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteExpandedSelection=void 0;var o=r(7582),n=r(1647),a=r(5911),l=r(7483),i=r(5098),s=r(1246),c={contentUnderSelectedTableCell:"ignoreForTableOrCell",contentUnderSelectedGeneralElement:"generalElementOnly",includeListFormatHolder:"never"};t.deleteExpandedSelection=function(e,t){var r={deleteResult:0,insertPoint:null,formatContext:t};return(0,i.iterateSelections)([e],(function(t,i,c,d){var u=(0,s.createParagraph)(!0,void 0,e.format),f=e.format,m=0;if(d)d[0]&&"Paragraph"==(null==c?void 0:c.blockType)&&(m=(u=c).segments.indexOf(d[0]),f=d[0].format,r.lastParagraph=u,r.lastTableContext=i,d.forEach((function(e,o){0!=o||r.insertPoint||"SelectionMarker"!=e.segmentType?(0,l.deleteSegment)(c,e,r.formatContext)&&(r.deleteResult=2):r.insertPoint=(0,n.createInsertPoint)(e,c,t,i)})),2==r.deleteResult&&(0,s.setParagraphNotImplicit)(c));else if(c){var p=t[0].blocks;(0,a.deleteBlock)(p,c,u,r.formatContext)&&(r.deleteResult=2)}else if(i){var v=i.table,g=i.colIndex,h=i.rowIndex,b=v.rows[h],y=b.cells[g];t=(0,o.__spreadArray)([y],(0,o.__read)(t),!1),u.segments.push((0,s.createBr)(e.format)),y.blocks=[u],delete y.cachedElement,delete b.cachedElement,r.deleteResult=2}if(!r.insertPoint){var _=(0,s.createSelectionMarker)(f);(0,s.setParagraphNotImplicit)(u),u.segments.splice(m,0,_),r.insertPoint=(0,n.createInsertPoint)(_,u,t,i)}}),c),r}},7483:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSegment=void 0;var o=r(4486),n=r(1246),a=r(8778);t.deleteSegment=function(e,t,r,l){var i=e.segments,s=i.indexOf(t),c=(0,n.isWhiteSpacePreserved)(e),d="forward"==l,u="backward"==l;switch(c||function(e,t){for(var r,o=t-1;"SelectionMarker"==(null===(r=e[o])||void 0===r?void 0:r.segmentType);)o--;var a=e[o];a&&(0,n.normalizeSingleSegment)(a)}(i,s),t.segmentType){case"Br":case"Image":case"SelectionMarker":return i.splice(s,1),!0;case"Entity":var f=t.isSelected?"overwrite":d?"removeFromStart":u?"removeFromEnd":void 0;return void 0!==f&&(i.splice(s,1),null==r||r.deletedEntities.push({entity:t,operation:f})),!0;case"Text":var m=t.text;return 0==m.length||t.isSelected?i.splice(s,1):l&&(m=(0,o.deleteSingleChar)(m,d),c||(m=(0,a.normalizeText)(m,d)),""==m?i.splice(s,1):t.text=m),!0;case"General":return!!t.isSelected&&(i.splice(s,1),!0)}}},4486:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSingleChar=void 0;var o=r(7582);t.deleteSingleChar=function(e,t){for(var r=(0,o.__spreadArray)([],(0,o.__read)(e),!1),n=0,a=t?0:r.length-1,l="notDeleted";a>=0&&a<r.length&&"done"!=l;a+=t?1:-1)switch(r[a]){case"‍":case"⃣":case"︎":case"️":l="notDeleted",n++;break;default:"notDeleted"==l?(l="waiting",n++):"waiting"==l&&(l="done")}return r.splice(t?0:r.length-n,n),r.join("")}},9119:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.insertEntityModel=void 0;var o=r(7582),n=r(473),a=r(4829),l=r(5736),i=r(1246);t.insertEntityModel=function(e,t,r,s,c,d){var u,f,m,p,v=-1;if("begin"==r||"end"==r)m=e,v="begin"==r?0:e.blocks.length;else if((p=(0,n.deleteSelection)(e,[],d)).insertPoint){var g=p.insertPoint,h=g.marker,b=g.paragraph,y=g.path;if(2==p.deleteResult&&(0,i.normalizeContentModel)(e),s){var _="root"==r?(0,a.getClosestAncestorBlockGroupIndex)(y,["TableCell","Document"]):0;m=y[_];var C=y[_-1],P="FormatContainer"==(null==C?void 0:C.blockGroupType)||"General"==(null==C?void 0:C.blockGroupType)||"ListItem"==(null==C?void 0:C.blockGroupType)?C:b,S=m.blocks.indexOf(P);v=S>=0?S+1:-1}else{var k=b.segments.indexOf(h);k>=0&&b.segments.splice(c?k:k+1,0,t)}}if(v>=0&&m){var O=[],T=void 0;if(s){var M=m.blocks[v];O.push(t),"Paragraph"==(null==M?void 0:M.blockType)?T=M:M&&"Entity"!=M.blockType&&!c||((T=(0,i.createParagraph)(!1,{},e.format)).segments.push((0,i.createBr)(e.format)),O.push(T))}else(T=(0,i.createParagraph)(!1,void 0,e.format)).segments.push(t),O.push(T);if((u=m.blocks).splice.apply(u,(0,o.__spreadArray)([v,0],(0,o.__read)(O),!1)),c&&T){h=(0,i.createSelectionMarker)((null===(f=T.segments[0])||void 0===f?void 0:f.format)||e.format);var w=T.segments;s?w.unshift(h):w.push(h),(0,l.setSelection)(e,h,h)}}}},2976:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.canApplyPendingFormat=t.clearPendingFormat=t.setPendingFormat=t.getPendingFormat=void 0,t.getPendingFormat=function(e){return o(e).format},t.setPendingFormat=function(e,t,r,n){var a=o(e);a.format=t,a.posContainer=r,a.posOffset=n},t.clearPendingFormat=function(e){var t=o(e);t.format=null,t.posContainer=null,t.posOffset=null},t.canApplyPendingFormat=function(e){var t=o(e),r=!1;if(t.format&&t.posContainer&&null!==t.posOffset){var n=e.getFocusedPosition();(null==n?void 0:n.node)==t.posContainer&&(null==n?void 0:n.offset)==t.posOffset&&(r=!0)}return r};var r="__ContentModelPendingFormat";function o(e){return e.getCustomData(r,(function(){return{format:null,posContainer:null,posOffset:null}}))}},1354:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(9843),n=r(1246);t.default=function(e,t,r){if(t){var a=e.format,l=t.width,i=t.style,s=t.color,c=(0,o.extractBorderValues)(a.borderTop),d=c.color,u=c.width,f=c.style,m="";m=l?(0,n.parseValueWithUnit)(l)+"px":u||"1px",i?m=m+" "+i:f?m=m+" "+f:m+=" solid",s?m=m+" "+s:d&&(m=m+" "+d),e.format.borderLeft=m,e.format.borderTop=m,e.format.borderBottom=m,e.format.borderRight=m}else delete e.format.borderLeft,delete e.format.borderTop,delete e.format.borderBottom,delete e.format.borderRight;r&&(e.format.borderRadius=r)}},2874:(e,t)=>{function r(e,t){e.blocks.forEach((function(e){switch(e.blockType){case"BlockGroup":"ListItem"==e.blockGroupType?t.push(e):(o(t),r(e,t),o(t));break;case"Paragraph":o(t),e.segments.forEach((function(e){"General"==e.segmentType&&r(e,t)})),o(t);break;case"Table":o(t),e.rows.forEach((function(e){return e.cells.forEach((function(e){r(e,t)}))})),o(t)}}))}function o(e){var t=e[e.length-1];t&&null===t||e.push(null)}function n(e,t,r){var o=e[t].levels,n=e[r].levels;return o.length<=n.length&&o.every((function(e,t){return e.listType==n[t].listType}))}function a(e,t){return e.levels.slice(0,t).some((function(e){return void 0!==e.format.startNumberOverride}))}Object.defineProperty(t,"__esModule",{value:!0}),t.findListItemsInSameThread=void 0,t.findListItemsInSameThread=function(e,t){var o=[];return r(e,o),function(e,t){var r,o=[],l=e.indexOf(t),i=t.levels.length,s="OL"==(null===(r=t.levels[i-1])||void 0===r?void 0:r.listType);if(l>=0){for(var c=l;c>=0;c--){if(!(u=e[c])){if(s)continue;break}var d=a(u,i);if(n(e,l,c)){if(o.unshift(u),s&&d)break}else if(!s||d)break}for(c=l+1;c<e.length;c++){var u;if(!(u=e[c])){if(s)continue;break}if(d=a(u,i),n(e,l,c)&&!d)o.push(u);else if(!s||d)break}}return o}(o,t)}},1567:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setListType=void 0;var o=r(5544),n=r(4979),a=r(1246);function l(e){switch(e.blockType){case"Table":return!1;case"Paragraph":return e.segments.every((function(e){return"Br"==e.segmentType||"SelectionMarker"==e.segmentType}));default:return!0}}t.setListType=function(e,t){var r=(0,o.getOperationalBlocks)(e,["ListItem"],[]),i=r.every((function(e){var r,o=e.block;return(0,n.isBlockGroupOfType)(o,"ListItem")?(null===(r=o.levels[o.levels.length-1])||void 0===r?void 0:r.listType)==t:l(o)})),s=[],c=!1;return r.forEach((function(e,o){var d,u,f=e.block,m=e.parent;if((0,n.isBlockGroupOfType)(f,"ListItem")){var p=f.levels.pop();!i&&p?(p.listType=t,f.levels.push(p)):1==f.blocks.length&&(0,a.setParagraphNotImplicit)(f.blocks[0])}else{var v=m.blocks.indexOf(f);if(v>=0)if(1!=r.length&&l(f))c=!0,s.forEach((function(e){return e.levels[0].format.marginBottom="0"})),s=[];else{var g=m.blocks[v-1],h="Paragraph"==f.blockType&&(null===(d=f.segments[0])||void 0===d?void 0:d.format)||{},b=(0,a.createListItem)([(0,a.createListLevel)(t,{startNumberOverride:o>0||"BlockGroup"==(null==g?void 0:g.blockType)&&"ListItem"==g.blockGroupType&&"OL"==(null===(u=g.levels[0])||void 0===u?void 0:u.listType)?void 0:1,direction:f.format.direction,textAlign:f.format.textAlign,marginTop:c?"0":void 0})],{fontFamily:h.fontFamily,fontSize:h.fontSize,textColor:h.textColor});"Paragraph"==f.blockType&&(f.isImplicit=!0),b.blocks.push(f),m.blocks.splice(v,1,b),s.push(b)}}})),(0,a.normalizeContentModel)(e),r.length>0}},5113:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adjustSegmentSelection=void 0;var o=r(5544),n=r(5736);t.adjustSegmentSelection=function(e,t,r){var a,l,i=(0,o.getSelectedParagraphs)(e),s=!1;return i.forEach((function(e){var o=a?0:e.segments.findIndex((function(e){return t(e)})),n=e.segments;if(!a){a=n[o];for(var i=o;i>0;i--){if(!r(n[i-1],a)){s=s||!!n[i-1].isSelected;break}a=n[i-1],s=s||!n[i-1].isSelected}}if(a)for(i=o;i<e.segments.length;i++){if(i!=o&&!r(n[i],l||n[o])){s=s||!!n[i].isSelected;break}l=n[i],s=s||!n[i].isSelected}})),a&&l&&(0,n.setSelection)(e,a,l),s}},5294:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adjustWordSelection=void 0;var o=r(7582),n=r(1246),a=r(8778),l=r(5098);function i(e,t){var r=e.text,o=-1;if(t)for(var n=0;n<r.length;n++){var l=r[n];if((0,a.isPunctuation)(l)||(0,a.isSpace)(l)){o=n;break}}else for(n=r.length-1;n>=0;n--)if(l=r[n],(0,a.isPunctuation)(l)||(0,a.isSpace)(l)){o=n+1;break}return o}function s(e,t,r,o){var a=t.text,l=(0,n.createText)(a.substring(0,o),t.format,t.link,t.code),i=(0,n.createText)(a.substring(o,a.length),t.format,t.link,t.code);e.splice(r,1,l,i)}t.adjustWordSelection=function(e,t){var r;(0,l.iterateSelections)([e],(function(e,o,n,a){return"Paragraph"==(null==n?void 0:n.blockType)&&1==(null==a?void 0:a.length)&&a[0]==t&&(r=n),!0}));var n=r?(0,o.__spreadArray)([],(0,o.__read)(r.segments),!1):void 0;if(n&&r){for(var a=[],c=n.indexOf(t),d=c-1;d>=0&&"Text"==(u=n[d]).segmentType;d--){if((f=i(u,!1))>-1){if(f==u.text.length)break;s(n,u,d,f),a.push(n[d+1]);break}a.push(n[d])}if(c=n.indexOf(t),a.push(t),a.length<=1)return a;for(d=c+1;d<n.length;d++){var u,f;if("Text"!=(u=n[d]).segmentType)break;if((f=i(u,!0))>-1){if(0==f)break;s(n,u,d,f),a.push(n[d]);break}a.push(n[d])}return a[a.length-1]==t?[t]:(r.segments=n,a)}return[t]}},8154:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areSameRangeEx=void 0,t.areSameRangeEx=function(e,t){if(e==t)return!0;switch(e.type){case"image":return"image"==t.type&&t.image==e.image;case"table":return"table"==t.type&&t.table==e.table&&t.firstColumn==e.firstColumn&&t.lastColumn==e.lastColumn&&t.firstRow==e.firstRow&&t.lastRow==e.lastRow;default:return"range"==t.type&&(r=t.range,o=e.range,!(!r||!o||r.startContainer!=o.startContainer||r.startOffset!=o.startOffset||r.endContainer!=o.endContainer||r.endOffset!=o.endOffset))}var r,o}},981:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.collapseTableSelection=void 0;var o=r(1246);t.collapseTableSelection=function(e,t){var r,n=t.firstCol,a=null===(r=e[t.firstRow])||void 0===r?void 0:r.cells[n];a&&(0,o.addSegment)(a,(0,o.createSelectionMarker)())}},5544:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstSelectedListItem=t.getFirstSelectedTable=t.getOperationalBlocks=t.getSelectedParagraphs=t.getSelectedSegmentsAndParagraphs=void 0;var o=r(7582),n=r(4829),a=r(4979),l=r(5098);function i(e,t,r,o){var a=[],l=o?t.map((function(e){return[e]})):[t],i=s(e,{includeListFormatHolder:"never",contentUnderSelectedTableCell:"ignoreForTable"});return c(i),i.forEach((function(e){for(var t=e.path,o=e.block,i=function(e){var i=(0,n.getClosestAncestorBlockGroupIndex)(t,l[e],r);return i>=0?(a.filter((function(e){return e.block==t[i]})).length<=0&&a.push({parent:t[i+1],block:t[i]}),"break"):e==l.length-1&&o?(a.push({parent:t[0],block:o}),"break"):void 0},s=0;s<l.length&&"break"!==i(s);s++);})),a}function s(e,t){var r=[];return(0,l.iterateSelections)([e],(function(e,t,o,n){r.push({path:e,tableContext:t,block:o,segments:n})}),t),r}function c(e){e.length>1&&d(e,!1)&&e.pop(),e.length>1&&d(e,!0)&&e.shift()}function d(e,t){var r,o=e[t?0:e.length-1];if("Paragraph"==(null===(r=o.block)||void 0===r?void 0:r.blockType)&&o.segments&&o.segments.length>0){var n=o.block.segments,a=o.segments[0];return 1==o.segments.length&&"SelectionMarker"==a.segmentType&&a==n[t?n.length-1:0]}return!1}t.getSelectedSegmentsAndParagraphs=function(e,t){var r=s(e,{includeListFormatHolder:t?"allSegments":"never"}),o=[];return r.forEach((function(e){var r=e.segments,n=e.block;r&&(t&&!n||"Paragraph"==(null==n?void 0:n.blockType))&&r.forEach((function(e){"Entity"==e.segmentType&&e.entityFormat.isReadonly||o.push([e,"Paragraph"==(null==n?void 0:n.blockType)?n:null])}))})),o},t.getSelectedParagraphs=function(e){var t=s(e,{includeListFormatHolder:"never"}),r=[];return c(t),t.forEach((function(e){var t=e.block;"Paragraph"==(null==t?void 0:t.blockType)&&r.push(t)})),r},t.getOperationalBlocks=i,t.getFirstSelectedTable=function(e){var t,r=s(e,{includeListFormatHolder:"never"}),n=[];return c(r),r.forEach((function(e){var r=e.block,a=e.tableContext,l=e.path;if(!t)if("Table"==(null==r?void 0:r.blockType))t=r,n=(0,o.__spreadArray)([],(0,o.__read)(l),!1);else if(null==a?void 0:a.table){t=a.table;var i=l.filter((function(e){return e.blocks.indexOf(a.table)>=0}))[0],s=l.indexOf(i);n=s>=0?l.slice(s):[]}})),[t,n]},t.getFirstSelectedListItem=function(e){var t;return i(e,["ListItem"],["TableCell"]).forEach((function(e){!t&&(0,a.isBlockGroupOfType)(e.block,"ListItem")&&(t=e.block)})),t}},2812:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionRootNode=void 0,t.getSelectionRootNode=function(e){return e?"range"==e.type?e.range.commonAncestorContainer:"table"==e.type?e.table:"image"==e.type?e.image:void 0:void 0}},5098:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.iterateSelections=void 0;var o=r(7582);function n(e,t,r,a,l){for(var i=e[0],s=(null==r?void 0:r.includeListFormatHolder)||"allSegments",c=(null==r?void 0:r.contentUnderSelectedTableCell)||"include",d=(null==r?void 0:r.contentUnderSelectedGeneralElement)||"contentOnly",u=!1,f=!1,m=0;m<i.blocks.length;m++){var p=i.blocks[m];switch(p.blockType){case"BlockGroup":var v=(0,o.__spreadArray)([p],(0,o.__read)(e),!1);if("General"==p.blockGroupType){var g=!(w=l||p.isSelected)||"both"==d||"contentOnly"==d,h=w&&("both"==d||"generalElementOnly"==d||0==p.blocks.length);if(g&&n(v,t,r,a,w)||h&&t(e,a,p))return!0}else if(n(v,t,r,a,l))return!0;break;case"Table":var b=p.rows,y=b.every((function(e){return e.cells.every((function(e){return e.isSelected}))}));if("include"!=c&&y){if(t(e,a,p))return!0}else for(var _=0;_<b.length;_++)for(var C=b[_],P=0;P<C.cells.length;P++){var S=C.cells[P];if(S){var k={table:p,rowIndex:_,colIndex:P,isWholeTableSelected:y};if(S.isSelected&&t(e,k))return!0;if((!S.isSelected||"ignoreForTableOrCell"!=c)&&n((0,o.__spreadArray)([S],(0,o.__read)(e),!1),t,r,k,w=l||S.isSelected))return!0}}break;case"Paragraph":for(var O=[],T=0;T<p.segments.length;T++){var M=p.segments[T],w=l||M.isSelected;if("General"==M.segmentType){if(g=!w||"both"==d||"contentOnly"==d,h=w&&("both"==d||"generalElementOnly"==d||0==M.blocks.length),g&&n((0,o.__spreadArray)([M],(0,o.__read)(e),!1),t,r,a,w))return!0;h&&O.push(M)}else w&&O.push(M);w?u=!0:f=!0}if(O.length>0&&t(e,a,p,O))return!0;break;case"Divider":case"Entity":if((l||p.isSelected)&&t(e,a,p))return!0}}return!("never"==s||"ListItem"!=i.blockGroupType||!u||f&&"anySegment"!=s||!t(e,a,void 0,[i.formatHolder]))}t.iterateSelections=function(e,t,r,o,a){n(e,(function(e,r,o,n){var a;return(null===(a=o)||void 0===a?void 0:a.cachedElement)&&delete o.cachedElement,t(e,r,o,n)}),r,o,a)}},5736:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setSelection=void 0;var o=r(1246);function n(e,t,r,s){return i(t,e,r,s,(function(t){return(0,o.isGeneralSegment)(e)&&l(e,t),e.blocks.forEach((function(e){t=function(e,t,r,o){switch(e.blockType){case"BlockGroup":return n(e,t,r,o);case"Table":return function(e,t,r,o){var i=a(e,r),s=o?a(e,o):i;if(t)e.rows.forEach((function(e){return e.cells.forEach((function(e){t=n(e,t,r,o)}))}));else for(var c=0;c<e.rows.length;c++)for(var d=e.rows[c],u=0;u<d.cells.length;u++){var f=e.rows[c].cells[u],m=c>=i.row&&c<=s.row&&u>=i.col&&u<=s.col;l(f,m),m||n(f,!1,r,o)}return t}(e,t,r,o);case"Divider":case"Entity":return i(t,e,r,o,(function(t){return t?e.isSelected=!0:delete e.isSelected,t}));case"Paragraph":var s=[];for(e.segments.forEach((function(e,a){t=i(t,e,r,o,(function(t){return function(e,t,r,o,a,i){switch(e.segmentType){case"SelectionMarker":return(!t||e!=o&&e!=a)&&r.push(i),t;case"General":return l(e,t),e!=o&&e!=a?n(e,t,o,a):t;case"Image":return l(e,t),e.isSelectedAsImageSelection=o==e&&(!a||a==e),t;default:return l(e,t),t}}(e,t,s,r,o,a)}))}));s.length>0;){var c=s.pop();c>=0&&e.segments.splice(c,1)}return t;default:return t}}(e,t,r,s)})),t}))}function a(e,t){var r=-1;return{row:t?e.rows.findIndex((function(e){return(r=e.cells.indexOf(t))>=0})):-1,col:r}}function l(e,t){return t?e.isSelected=!0:delete e.isSelected,t}function i(e,t,r,o,n){return(e=n(e=e||t==r))&&!!o&&t!=o}t.setSelection=function(e,t,r){n(e,!1,t||null,r||null)}},6682:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.alignTable=void 0,t.alignTable=function(e,t){e.format.marginLeft="alignLeft"==t?"":"auto",e.format.marginRight="alignRight"==t?"":"auto",delete e.cachedElement}},7691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.alignTableCellVertically=t.alignTableCellHorizontally=void 0;var o=r(5226),n=r(860),a={alignCellLeft:"start",alignCellCenter:"center",alignCellRight:"end"},l={alignCellTop:"top",alignCellMiddle:"middle",alignCellBottom:"bottom"};function i(e,t){var r,n=(0,o.getSelectedCells)(e);if(n)for(var a=n.firstRow;a<=n.lastRow;a++)for(var l=n.firstCol;l<=n.lastCol;l++){var i=null===(r=e.rows[a])||void 0===r?void 0:r.cells[l];(null==i?void 0:i.format)&&(delete i.cachedElement,t(i),i.blocks.forEach((function(e){"Paragraph"===e.blockType&&delete e.format.textAlign})))}}t.alignTableCellHorizontally=function(e,t){i(e,(function(e){e.format.textAlign=a[t]}))},t.alignTableCellVertically=function(e,t){i(e,(function(e){e.format.verticalAlign=l[t],(0,n.updateTableCellMetadata)(e,(function(e){return(e=e||{}).vAlignOverride=!0,e}))}))}},4158:(e,t,r)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.applyTableFormat=void 0;var n=r(7582),a=r(1246),l=r(9843),i=r(3684),s=r(398),c=r(860),d=r(5165),u={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:s.TableBorderFormat.DEFAULT,verticalAlign:null};t.applyTableFormat=function(e,t,r){var o=e.rows;(0,d.updateTableMetadata)(e,(function(s){var d=(0,n.__assign)((0,n.__assign)((0,n.__assign)({},u),s),t||{}),v=function(e,t){var r={bgColorOverrides:[],vAlignOverrides:[],borderOverrides:[]};return e.forEach((function(e){var o=[],n=[],a=[];r.bgColorOverrides.push(o),r.vAlignOverrides.push(n),r.borderOverrides.push(a),e.cells.forEach((function(e){(0,c.updateTableCellMetadata)(e,(function(e){return e&&t?(o.push(!1),delete e.bgColorOverride):o.push(!!(null==e?void 0:e.bgColorOverride)),n.push(!!(null==e?void 0:e.vAlignOverride)),a.push(!!(null==e?void 0:e.borderOverride)),e}))}))})),r}(o,!r);return delete e.cachedElement,function(e){e.forEach((function(e){e.cells.forEach((function(e){delete e.cachedElement})),delete e.cachedElement}))}(o),function(e,t,r){var o=t.hasBandedRows,n=t.hasBandedColumns,s=t.bgColorOdd,c=t.bgColorEven;e.forEach((function(d,u){d.cells.forEach((function(m,v){if(!r.borderOverrides[u][v]){var g=f[t.tableBorderFormat]({firstRow:0===u,lastRow:u===e.length-1,firstColumn:0===v,lastColumn:v===d.cells.length-1}),h=[t.topBorderColor,t.verticalBorderColor,t.bottomBorderColor,t.verticalBorderColor];g.forEach((function(e,t){var r=!e&&h[t]||"";m.format[a.BorderKeys[t]]=(0,l.combineBorderValue)({style:p(r),width:"1px",color:r})}))}if(!r.bgColorOverrides[u][v]){var b=(o||n)&&(n&&v%2!=0||o&&u%2!=0)?s:c;(0,i.setTableCellBackgroundColor)(m,b,!1,!0)}t.verticalAlign&&!r.vAlignOverrides[u][v]&&(m.format.verticalAlign=t.verticalAlign)}))}))}(o,d,v),function(e,t,r){e.forEach((function(o,n){o.cells.forEach((function(o,a){t.hasFirstColumn&&0===a?(o.isHeader=!0,0===n||r.bgColorOverrides[n][a]||(m(o.format,"borderTop"),(0,i.setTableCellBackgroundColor)(o,null,!1,!0)),n!==e.length-1&&0!==n&&m(o.format,"borderBottom")):o.isHeader=!1}))}))}(o,d,v),function(e,t,r){var o;null===(o=e[0])||void 0===o||o.cells.forEach((function(e,o){e.isHeader=t.hasHeaderRow,t.hasHeaderRow&&t.headerRowColor&&(r.bgColorOverrides[0][o]||(0,i.setTableCellBackgroundColor)(e,t.headerRowColor,!1,!0),m(e.format,"borderTop",t.headerRowColor),m(e.format,"borderRight",t.headerRowColor),m(e.format,"borderLeft",t.headerRowColor))}))}(o,d,v),d}))};var f=((o={})[s.TableBorderFormat.DEFAULT]=function(e){return[!1,!1,!1,!1]},o[s.TableBorderFormat.LIST_WITH_SIDE_BORDERS]=function(e){return[!1,!e.lastColumn,!1,!e.firstColumn]},o[s.TableBorderFormat.FIRST_COLUMN_HEADER_EXTERNAL]=function(e){var t=e.firstColumn,r=e.firstRow;return[!r,!e.lastColumn&&!t||t&&r,!e.lastRow&&!r,!t]},o[s.TableBorderFormat.NO_HEADER_BORDERS]=function(e){var t=e.firstRow,r=e.firstColumn,o=e.lastColumn;return[t,t||o,!1,t||r]},o[s.TableBorderFormat.NO_SIDE_BORDERS]=function(e){var t=e.firstColumn;return[!1,e.lastColumn,!1,t]},o[s.TableBorderFormat.ESPECIAL_TYPE_1]=function(e){var t=e.firstRow,r=e.firstColumn;return[r&&!t,t,r&&!t,t&&!r]},o[s.TableBorderFormat.ESPECIAL_TYPE_2]=function(e){var t=e.firstRow,r=e.firstColumn;return[!t,t||!r,!t,!r]},o[s.TableBorderFormat.ESPECIAL_TYPE_3]=function(e){var t=e.firstColumn,r=e.firstRow;return[!0,r||!t,!r,!0]},o[s.TableBorderFormat.CLEAR]=function(){return[!0,!0,!0,!0]},o);function m(e,t,r){var o=(0,l.extractBorderValues)(e[t]);o.color=r||"",o.style=p(o.color),e[t]=(0,l.combineBorderValue)(o)}function p(e){return e&&"transparent"!=e?"solid":"none"}},5788:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.canMergeCells=void 0,t.canMergeCells=function(e,t,r,o,n){var a=r==n||e[t].cells.every((function(e,t){return t<r||t>n||!e.spanAbove})),l=t==o||e.every((function(e,n){return n<t||n>o||!e.cells[r].spanLeft})),i=e[o].cells.map((function(t,a){return a>=r&&a<=n?function(e,t,r){for(var o,n,a=0,l=t+1;l<e.length&&(null===(n=null===(o=e[l])||void 0===o?void 0:o.cells[r])||void 0===n?void 0:n.spanAbove);l++)a++;return a}(e,o,a):-1})).every((function(e,t,o){return e<0||e==o[r]})),s=e.map((function(r,a){return a>=t&&a<=o?function(e,t,r){for(var o,n,a,l=0,i=r+1;i<(null===(o=e[t])||void 0===o?void 0:o.cells.length)&&(null===(a=null===(n=e[t])||void 0===n?void 0:n.cells[i])||void 0===a?void 0:a.spanLeft);i++)l++;return l}(e,a,n):-1})).every((function(e,r,o){return e<0||e==o[t]}));return a&&l&&i&&s}},2969:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTableStructure=void 0;var o=r(1246);t.createTableStructure=function(e,t,r){var n=(0,o.createTable)(r);return(0,o.addBlock)(e,n),n.rows.forEach((function(e){for(var r=0;r<t;r++){var n=(0,o.createTableCell)();e.cells.push(n)}})),n}},6893:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTable=void 0,t.deleteTable=function(e){e.rows=[],delete e.cachedElement}},629:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTableColumn=void 0;var o=r(981),n=r(5226);t.deleteTableColumn=function(e){var t=(0,n.getSelectedCells)(e);if(t){for(var r=0;r<e.rows.length;r++){var a=e.rows[r].cells[t.lastCol+1];a&&(a.spanLeft=a.spanLeft&&e.rows[r].cells[t.firstCol].spanLeft),e.rows[r].cells.splice(t.firstCol,t.lastCol-t.firstCol+1)}e.widths.splice(t.firstCol,t.lastCol-t.firstCol+1),(0,o.collapseTableSelection)(e.rows,t)}}},4054:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTableRow=void 0;var o=r(981),n=r(5226);t.deleteTableRow=function(e){var t=(0,n.getSelectedCells)(e);t&&(e.rows[t.firstRow].cells.forEach((function(r,o){var n,a=null===(n=e.rows[t.lastRow+1])||void 0===n?void 0:n.cells[o];a&&(a.spanAbove=a.spanAbove&&r.spanAbove)})),e.rows.splice(t.firstRow,t.lastRow-t.firstRow+1),(0,o.collapseTableSelection)(e.rows,t))}},9073:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ensureFocusableParagraphForTable=void 0;var o=r(1246);function n(e){var t=(0,o.createParagraph)(!1,void 0,e.format),r=(0,o.createBr)(e.format);return t.segments.push(r),t}t.ensureFocusableParagraphForTable=function(e,t,r){var o,a,l,i=null===(o=r.rows.filter((function(e){return e.cells.length>0}))[0])||void 0===o?void 0:o.cells[0];if(i)(l=i.blocks.filter((function(e){return"Paragraph"==e.blockType}))[0])||(l=n(e),i.blocks.push(l));else{var s,c=r;for(l=n(e);s=t.shift();){var d=null!==(a=s.blocks.indexOf(c))&&void 0!==a?a:-1;if(s&&d>=0&&s.blocks.splice(d,1,l),"FormatContainer"!=s.blockGroupType||1!=s.blocks.length||s.blocks[0]!=l)break;c=s}}return l}},5226:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectedCells=void 0;var o=r(7536);t.getSelectedCells=function(e){var t=-1,r=-1,n=-1,a=-1,l=!1;return e.rows.forEach((function(e,i){return e.cells.forEach((function(e,s){(0,o.default)(e)&&(l=!0,t<0&&(t=i),r<0&&(r=s),n=Math.max(n,i),a=Math.max(a,s))}))})),l?{firstRow:t,firstCol:r,lastRow:n,lastCol:a}:null}},7350:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.insertTableColumn=void 0;var o=r(1246),n=r(5226);t.insertTableColumn=function(e,t){var r=(0,n.getSelectedCells)(e),a="insertLeft"==t;if(r)for(var l=null==r?void 0:r.firstCol;l<=r.lastCol;l++)e.rows.forEach((function(e){var t=e.cells[a?r.firstCol:r.lastCol];e.cells.splice(a?r.firstCol:r.lastCol+1,0,(0,o.createTableCell)(t.spanLeft,t.spanAbove,t.isHeader,t.format))})),e.widths.splice(a?r.firstCol:r.lastCol+1,0,e.widths[a?r.firstCol:r.lastCol])}},9457:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.insertTableRow=void 0;var o=r(7582),n=r(1246),a=r(5226);t.insertTableRow=function(e,t){var r=(0,a.getSelectedCells)(e),l="insertAbove"==t;if(r)for(var i=r.firstRow;i<=r.lastRow;i++){var s=e.rows[l?r.firstRow:r.lastRow];e.rows.splice(l?r.firstRow:r.lastRow+1,0,{format:(0,o.__assign)({},s.format),cells:s.cells.map((function(e){return(0,n.createTableCell)(e.spanLeft,e.spanAbove,e.isHeader,e.format)})),height:s.height})}}},8509:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableCells=void 0;var o=r(5788),n=r(5226);t.mergeTableCells=function(e){var t=(0,n.getSelectedCells)(e);if(t&&(0,o.canMergeCells)(e.rows,t.firstRow,t.firstCol,t.lastRow,t.lastCol))for(var r=t.firstRow;r<=t.lastRow;r++){for(var a=t.firstCol;a<=t.lastCol;a++){var l=e.rows[r].cells[a];l&&(l.spanLeft=a>t.firstCol,l.spanAbove=r>t.firstRow,delete l.cachedElement)}delete e.rows[r].cachedElement}}},4765:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableColumn=void 0;var o=r(5788),n=r(5226);t.mergeTableColumn=function(e,t){var r,a,l,i,s=(0,n.getSelectedCells)(e);if(s){var c="mergeLeft"==t?s.firstCol:s.lastCol+1;if(c>0&&c<e.rows[0].cells.length)for(var d=s.firstRow;d<=s.lastRow;d++){var u=null===(r=e.rows[d])||void 0===r?void 0:r.cells[c];if(u&&(0,o.canMergeCells)(e.rows,d,c-1,d,c)){u.spanLeft=!0;for(var f=c;null===(l=null===(a=e.rows[d])||void 0===a?void 0:a.cells[f])||void 0===l?void 0:l.spanLeft;)delete e.rows[d].cells[f].cachedElement,f--;(null===(i=e.rows[d])||void 0===i?void 0:i.cells[f])&&(e.rows[d].cells[f].isSelected=!0,delete e.rows[d].cells[f].cachedElement),delete u.cachedElement}delete e.rows[d].cachedElement}}}},2806:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableRow=void 0;var o=r(5788),n=r(5226);t.mergeTableRow=function(e,t){var r,a,l,i=(0,n.getSelectedCells)(e);if(i){var s="mergeAbove"==t?i.firstRow:i.lastRow+1;if(s>0&&s<e.rows.length)for(var c=i.firstCol;c<=i.lastCol;c++){var d=e.rows[s].cells[c];if(d&&(0,o.canMergeCells)(e.rows,s-1,c,s,c)){d.spanAbove=!0;for(var u=s;null===(a=null===(r=e.rows[u])||void 0===r?void 0:r.cells[c])||void 0===a?void 0:a.spanAbove;)delete e.rows[u].cells[c].cachedElement,delete e.rows[u].cachedElement,u--;(null===(l=e.rows[u])||void 0===l?void 0:l.cells[c])&&(e.rows[u].cells[c].isSelected=!0,delete e.rows[u].cells[c].cachedElement,delete e.rows[u].cachedElement),delete d.cachedElement}}}}},1303:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeTable=void 0;var o=r(7582),n=r(1246);function a(e){return e<=4?120:e<=6?100:70}function l(e,t){var r;t.blocks.every((function(e){return"Paragraph"==e.blockType&&(0==(t=(t=e.segments).filter((function(e){return"SelectionMarker"!=e.segmentType}))).length||1==t.length&&"Br"==t[0].segmentType);var t}))||((r=e.blocks).push.apply(r,(0,o.__spreadArray)([],(0,o.__read)(t.blocks),!1)),t.blocks=[])}t.normalizeTable=function(e,t){var r,i=e.format;i.borderCollapse&&i.useBorderBox||(i.borderCollapse=!0,i.useBorderBox=!0),e.rows.forEach((function(e,r){e.cells.forEach((function(e,a){if(0==e.blocks.length){var l=e.format.textColor?(0,o.__assign)((0,o.__assign)({},t),{textColor:e.format.textColor}):t;(0,n.addBlock)(e,(0,n.createParagraph)(void 0,void 0,l)),(0,n.addSegment)(e,(0,n.createBr)(l))}0==r?e.spanAbove=!1:r>0&&e.isHeader&&(e.isHeader=!1,delete e.cachedElement),0==a&&(e.spanLeft=!1),e.format.useBorderBox=!0})),e.height<22&&(e.height=22)}));for(var s=Math.max.apply(Math,(0,o.__spreadArray)([],(0,o.__read)(e.rows.map((function(e){return e.cells.length}))),!1)),c=0;c<s;c++)void 0===e.widths[c]&&(e.widths[c]=a(s));for(var d=function(t){e.rows.forEach((function(e){var r=e.cells[t],o=e.cells[t-1];r&&o&&r.spanLeft&&l(o,r)})),e.rows.every((function(e){var r;return null===(r=e.cells[t])||void 0===r?void 0:r.spanLeft}))&&(e.rows.forEach((function(e){return e.cells.splice(t,1)})),e.widths.splice(t-1,2,e.widths[t-1]+e.widths[t]))},u=((null===(r=e.rows[0])||void 0===r?void 0:r.cells.length)||0)-1;u>0;u--)d(u);for(var f=function(t){var r=e.rows[t];r.cells.forEach((function(r,o){var n,a=null===(n=e.rows[t-1])||void 0===n?void 0:n.cells[o];a&&r.spanAbove&&l(a,r)})),r.cells.every((function(e){return e.spanAbove}))&&(e.rows[t-1].height+=r.height,e.rows.splice(t,1))},m=e.rows.length-1;m>0;m--)f(m)}},3684:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseColor=t.setTableCellBackgroundColor=void 0;var o=r(7582),n=r(860);t.setTableCellBackgroundColor=function(e,t,r,a){if(t){e.format.backgroundColor=t,r&&(0,n.updateTableCellMetadata)(e,(function(e){return(e=e||{}).bgColorOverride=!0,e}));var l=function(e){var t=c(e);if(t){var r=t[0]/255,o=t[1]/255,n=t[2]/255;return 50*(Math.max(r,o,n)+Math.min(r,o,n))}return 255}(t);l<20?e.format.textColor="#ffffff":l>80?e.format.textColor="#000000":delete e.format.textColor,a&&e.format.textColor&&e.blocks.forEach((function(t){"Paragraph"==t.blockType&&(t.segmentFormat=(0,o.__assign)((0,o.__assign)({},t.segmentFormat),{textColor:e.format.textColor}),t.segments.forEach((function(t){t.format=(0,o.__assign)((0,o.__assign)({},t.format),{textColor:e.format.textColor})})))}))}else delete e.format.backgroundColor,delete e.format.textColor;delete e.cachedElement};var a=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,l=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,i=/^rgb\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,s=/^rgba\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/;function c(e){var t;return(t=(e=(e||"").trim()).match(a))?[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]:(t=e.match(l))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:(t=e.match(i)||e.match(s))?[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]:null}t.parseColor=c},3618:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.splitTableCellHorizontally=void 0;var o=r(7582),n=r(1246),a=r(5226);t.splitTableCellHorizontally=function(e){var t=(0,a.getSelectedCells)(e);if(t)for(var r=function(r){if(e.rows.every((function(e,o){var n;return o<t.firstRow||o>t.lastRow||(null===(n=e.cells[r+1])||void 0===n?void 0:n.spanLeft)})))e.rows.forEach((function(e,o){delete e.cells[r].cachedElement,o>=t.firstRow&&o<=t.lastRow&&(e.cells[r+1].spanLeft=!1,delete e.cells[r+1].cachedElement)}));else{e.rows.forEach((function(e,a){var l=e.cells[r];if(l){var i=(0,n.createTableCell)(l.spanLeft,l.spanAbove,l.isHeader,l.format);i.dataset=(0,o.__assign)({},l.dataset),a<t.firstRow||a>t.lastRow?i.spanLeft=!0:i.isSelected=l.isSelected,e.cells.splice(r+1,0,i),delete e.cells[r].cachedElement}}));var a=Math.max(e.widths[r]/2,30);e.widths.splice(r,1,a,a)}},l=t.lastCol;l>=t.firstCol;l--)r(l)}},2242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.splitTableCellVertically=void 0;var o=r(7582),n=r(1246),a=r(5226);t.splitTableCellVertically=function(e){var t=(0,a.getSelectedCells)(e);if(t)for(var r=t.lastRow;r>=t.firstRow;r--){var l=e.rows[r],i=e.rows[r+1];if(l.cells.forEach((function(e){delete e.cachedElement})),delete l.cachedElement,null==i?void 0:i.cells.every((function(e,r){return r<t.firstCol||r>t.lastCol||e.spanAbove})))i.cells.forEach((function(e,r){r>=t.firstCol&&r<=t.lastCol&&(e.spanAbove=!1,delete e.cachedElement)})),delete i.cachedElement;else{var s=Math.max(l.height/=2,22),c={format:(0,o.__assign)({},l.format),height:s,cells:l.cells.map((function(e,r){var a=(0,n.createTableCell)(e.spanLeft,e.spanAbove,e.isHeader,e.format);return a.dataset=(0,o.__assign)({},e.dataset),r<t.firstCol||r>t.lastCol?a.spanAbove=!0:a.isSelected=e.isSelected,a}))};l.height=s,e.rows.splice(r+1,0,c)}}}},5149:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(2511),n=r(9842);t.default=function(e,t){e.focus(),(0,o.formatWithContentModel)(e,"setAlignment",(function(e){return(0,n.setModelAlignment)(e,t)}))}},8365:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(2511),n=r(5078);t.default=function(e,t){e.focus(),(0,o.formatWithContentModel)(e,"setDirection",(function(e){return(0,n.setModelDirection)(e,t)}))}},2923:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(9139),n={h1:"2em",h2:"1.5em",h3:"1.17em",h4:"1em",h5:"0.83em",h6:"0.67em"};t.default=function(e,t){e.focus(),(0,o.formatParagraphWithContentModel)(e,"setHeadingLevel",(function(e){var r,o,a,l=t>0?"h"+t:(o=(null==(r=e.decorator)?void 0:r.tagName)||"",(a=parseInt(o.substring(1)))>=1&&a<=6?o:null);t>0?(e.decorator={tagName:l,format:l?{fontWeight:"bold",fontSize:n[l]}:{}},e.segments.forEach((function(e){delete e.format.fontSize,delete e.format.fontWeight}))):l&&delete e.decorator}))}},3721:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(2511),n=r(1246),a=r(687);t.default=function(e,t,r){e.focus(),(0,o.formatWithContentModel)(e,"setIndentation",(function(e){var o=(0,a.setModelIndentation)(e,t,r);return o&&(0,n.normalizeContentModel)(e),o}),{preservePendingFormat:!0})}},7339:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1246),n=r(9139);t.default=function(e,t,r){e.focus(),(0,n.formatParagraphWithContentModel)(e,"setParagraphMargin",(function(e){e.decorator||(e.decorator=(0,o.createParagraphDecorator)("p")),t?e.format.marginTop=t:null===t&&delete e.format.marginTop,r?e.format.marginBottom=r:null===r&&delete e.format.marginBottom}))}},9294:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(9139);t.default=function(e,t){e.focus(),(0,o.formatParagraphWithContentModel)(e,"setSpacing",(function(e){e.format.lineHeight=t.toString(),e.segments.forEach((function(e){e.format.lineHeight&&delete e.format.lineHeight}))}))}},1977:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(2511),a=r(6162),l={borderLeft:"3px solid rgb(200, 200, 200)",textColor:"rgb(102, 102, 102)"},i={marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px",paddingLeft:"10px"};t.default=function(e,t){void 0===t&&(t=l);var r=(0,o.__assign)((0,o.__assign)({},i),t);e.focus(),(0,n.formatWithContentModel)(e,"toggleBlockQuote",(function(e){return(0,a.toggleModelBlockQuote)(e,r)}),{preservePendingFormat:!0})}},1990:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(436),n=r(1685),a=r(473),l=r(2511),i=r(1020),s=r(1246),c=r(4040),d=r(3731),u=r(8689);t.default=function(e,t){var r=e.getDOMSelection(),f="range"==(null==r?void 0:r.type)?r.range:null,m=!1;return function(e,t){return!((null==e?void 0:e.collapsed)&&(0,s.isNodeOfType)(e.startContainer,"TEXT_NODE")&&!(0,i.isModifierKey)(t)&&(function(e,t){return"Backspace"==e.key&&t.startOffset>1}(t,e)||function(e,t){var r,o;return"Delete"==e.key&&t.startOffset<(null!==(o=null===(r=t.startContainer.nodeValue)||void 0===r?void 0:r.length)&&void 0!==o?o:0)-1}(t,e)))}(f,t)?((0,l.formatWithContentModel)(e,"Delete"==t.key?"handleDeleteKey":"handleBackspaceKey",(function(r,o){var l=(0,a.deleteSelection)(r,function(e,t){var r="Delete"==e.key;return[(0,c.shouldDeleteAllSegmentsBefore)(e)&&!r?n.deleteAllSegmentBefore:null,(0,c.shouldDeleteWord)(e,t)?r?d.forwardDeleteWordSelection:d.backwardDeleteWordSelection:null,r?u.forwardDeleteCollapsedSelection:u.backwardDeleteCollapsedSelection]}(t,!!e.getEnvironment().isMac),o).deleteResult;return m=0!=l,(0,c.handleKeyboardEventResult)(e,r,t,l,o)}),{rawEvent:t,changeSource:o.ChangeSource.Keyboard,getChangeData:function(){return t.which}}),!0):m}},9894:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(436),n=r(1246),a=r(2511),l=r(9119);t.default=function(e,t,r,i,s){var c=s||{},d=c.contentNode,u=c.focusAfterEntity,f=c.wrapperDisplay,m=c.skipUndoSnapshot,p=e.getDocument().createElement(r?"div":"span"),v=null!=f?f:r?void 0:"inline-block";p.style.setProperty("display",v||null),d&&p.appendChild(d);var g=(0,n.createEntity)(p,!0,void 0,t);return(0,a.formatWithContentModel)(e,"insertEntity",(function(e,t){return(0,l.insertEntityModel)(e,g,"string"==typeof i?i:"focus",r,u,t),(0,n.normalizeContentModel)(e),t.skipUndoSnapshot=m,t.newEntities.push(g),!0}),{selectionOverride:"object"==typeof i?i:void 0,changeSource:o.ChangeSource.InsertEntity,getChangeData:function(){return{wrapper:p,type:t,id:"",isReadonly:!0}}}),g}},7992:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(473),a=r(2511),l=r(2976),i=r(1246);function s(e,t,r,n,a){var i=(0,l.getPendingFormat)(e)||{},s=(0,o.__assign)((0,o.__assign)((0,o.__assign)({},t),i),r);(0,l.setPendingFormat)(e,s,n,a)}t.default=function(e,t){for(var r,o,l,c=e.getDOMSelection(),d="range"==(null==c?void 0:c.type)?c.range:null,u=null!==(r=null==d?void 0:d.startContainer)&&void 0!==r?r:null,f=null!==(o=null==d?void 0:d.startOffset)&&void 0!==o?o:null,m=u;m&&e.contains(m);){if((0,i.isNodeOfType)(m,"ELEMENT_NODE")){if(null===(l=m.getAttribute)||void 0===l?void 0:l.call(m,"style"))return;if((0,i.isBlockElement)(m))break}m=m.parentNode}(0,a.formatWithContentModel)(e,"input",(function(r,o){var a=(0,n.deleteSelection)(r,[],o);if(2==a.deleteResult)return(0,i.normalizeContentModel)(r),e.addUndoSnapshot(),!0;if(0==a.deleteResult&&a.insertPoint&&u&&null!==f){var l=a.insertPoint,c=l.paragraph,d=l.path,m=l.marker,p=d[0].blocks,v=p.length,g=p.indexOf(c);if(c.isImplicit&&1==c.segments.length&&c.segments[0]==m&&v>0&&g==v-1){var h=p[g-1];"Paragraph"!=(null==h?void 0:h.blockType)&&s(e,t,m.format,u,f)}else c.segments.every((function(e){return"Text"!=e.segmentType}))&&s(e,t,m.format,u,f);return!1}return!1}))}},1576:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(2511),a=r(2976),l=r(5098),i=r(1246);t.default=function(e,t){var r=(0,a.getPendingFormat)(e);if(r){var s=!1;(0,n.formatWithContentModel)(e,"applyPendingFormat",(function(e,n){return(0,l.iterateSelections)([e],(function(e,n,a,l){if("Paragraph"==(null==a?void 0:a.blockType)&&1==(null==l?void 0:l.length)&&"SelectionMarker"==l[0].segmentType){var c=l[0],d=a.segments.indexOf(c),u=a.segments[d-1];if("Text"==(null==u?void 0:u.segmentType)){var f=u.text,m=f.substr(-t.length,t.length);if(m==t||" "==t&&" "==m){c.format=(0,o.__assign)({},r),u.text=f.substring(0,f.length-t.length);var p=(0,i.createText)(" "==t?" ":t,(0,o.__assign)((0,o.__assign)({},u.format),r));a.segments.splice(d,0,p),(0,i.setParagraphNotImplicit)(a),s=!0}}}return!0})),s&&((0,i.normalizeContentModel)(e),n.skipUndoSnapshot=!0),s}))}}},2313:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(512),n=r(2511),a=r(1246);t.default=function(e){e.focus(),(0,n.formatWithContentModel)(e,"clearFormat",(function(e){var t=[],r=[],n=[];return(0,o.clearModelFormat)(e,t,r,n),(0,a.normalizeContentModel)(e),t.length>0||r.length>0||n.length>0}))}},7950:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reducedModelChildProcessor=void 0;var o=r(7582),n=r(2976),a=r(2812),l=r(2229),i=r(1246);function s(e,t,r){var n=(0,a.getSelectionRootNode)(r.selection);if(n){r.nodeStack||(r.nodeStack=function(e,t){for(var r=[],o=t;o&&e!=o&&e.contains(o);)(0,i.isNodeOfType)(o,"ELEMENT_NODE")&&"TABLE"==o.tagName?r.splice(0,r.length,o):r.push(o),o=o.parentNode;return r}(t,n));var l=r.nodeStack.pop();if(l){var s=(0,o.__read)((0,i.getRegularSelectionOffsets)(r,t),2),c=s[0],d=s[1],u=c>=0||d>=0?function(e,t){for(var r=0,o=e.firstChild;o&&o!=t;)r++,o=o.nextSibling;return r}(t,l):-1;u>=0&&(0,i.handleRegularSelection)(u,r,e,c,d),(0,i.processChildNode)(e,l,r),u>=0&&(0,i.handleRegularSelection)(u+1,r,e,c,d)}else r.defaultElementProcessors.child(e,t,r)}}t.default=function(e){var t=(0,n.getPendingFormat)(e),r=e.createContentModel({processorOverride:{child:s}}),a=(0,o.__assign)((0,o.__assign)({},e.getUndoState()),{isDarkMode:e.isDarkMode(),zoomScale:e.getZoomScale()});return(0,l.retrieveModelFormatState)(r,t,a),a},t.reducedModelChildProcessor=s},6623:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(5113),n=r(2511);t.default=function(e){var t=null;return(0,n.formatWithContentModel)(e,"adjustImageSelection",(function(e){return(0,o.adjustSegmentSelection)(e,(function(e){return!(!e.isSelected||"Image"!=e.segmentType||(t=e,0))}),(function(e,t){return e==t}))})),t}},8401:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(6154),n=r(4051),a=r(5866);t.default=function(e,t){e.focus();var r=e.getDOMSelection();(0,n.readFile)(t,(function(t){t&&!e.isDisposed()&&"image"===(null==r?void 0:r.type)&&(0,o.default)(e,"changeImage",(function(o){var n,l,i=null!==(l=null===(n=(0,a.updateImageMetadata)(o))||void 0===n?void 0:n.src)&&void 0!==l?l:"",s=o.src;o.src=t,o.dataset={},o.format.width="",o.format.height="",o.alt="",e.triggerPluginEvent(19,{image:r.image,previousSrc:s,newSrc:t,originalSrc:i})}))}))}},2930:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1246),n=r(2511),a=r(485),l=r(4051);function i(e,t){(0,n.formatWithContentModel)(e,"insertImage",(function(e,r){var n=(0,o.createImage)(t,{backgroundColor:""}),l=(0,o.createContentModelDocument)();return(0,o.addSegment)(l,n),(0,a.mergeModel)(e,l,r,{mergeFormat:"mergeAll"}),!0}))}t.default=function(e,t){e.focus(),"string"==typeof t?i(e,t):(0,l.readFile)(t,(function(t){t&&!e.isDisposed()&&i(e,t)}))}},2063:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(6154);t.default=function(e,t){e.focus(),(0,o.default)(e,"setImageAltText",(function(e){e.alt=t}))}},4653:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1354),n=r(6154);t.default=function(e,t,r){e.focus(),(0,n.default)(e,"setImageBorder",(function(e){(0,o.default)(e,t,r)}))}},4735:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(6154);t.default=function(e,t,r){e.focus(),(0,o.default)(e,"setImageBoxShadow",(function(e){e.format.boxShadow=t,r?(e.format.marginBottom=r,e.format.marginLeft=r,e.format.marginRight=r,e.format.marginTop=r):null===r&&(delete e.format.marginBottom,delete e.format.marginLeft,delete e.format.marginRight,delete e.format.marginTop)}))}},1270:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(6331),n=r(5113),a=r(5294),l=r(2511),i=r(5736);t.default=function(e){var t="",r=null;return(0,l.formatWithContentModel)(e,"adjustLinkSelection",(function(e){var l,s,c=(0,n.adjustSegmentSelection)(e,(function(e){return!!e.isSelected&&!!e.link}),(function(e,t){return!!e.link&&e.link.format.href==t.link.format.href})),d=(0,o.default)(e,!1),u=d[0];return 1==d.length&&"SelectionMarker"==u.segmentType&&(d=(0,a.adjustWordSelection)(e,u)).length>1&&(c=!0,(0,i.setSelection)(e,d[0],d[d.length-1])),t=d.map((function(e){return"Text"==e.segmentType?e.text:""})).join(""),r=(null===(s=null===(l=d[0])||void 0===l?void 0:l.link)||void 0===s?void 0:s.format.href)||null,c})),[t,r]}},7058:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(6331),a=r(436),l=r(2511),i=r(2976),s=r(2347),c=r(485),d=r(1246),u=/^[a-zA-Z]+:/i,f=/^[\w.%+-]+@/i,m=/^ftp\./i;t.default=function(e,t,r,v,g){e.focus();var h=(function(e){var t=new s.HtmlSanitizer,r=document.createElement("a");return r.href=e||"",t.sanitize(r),r.getAttribute("href")||""}(t)||"").trim();if(h){var b,y=(0,s.matchLink)(h),_=y?y.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(u)<0&&(t=0==e.search(f)?"mailto:":0==e.search(m)?"ftp://":"http://"),t+e}(h),C=[];(0,l.formatWithContentModel)(e,"insertLink",(function(t,a){var l,s=(0,n.default)(t,!1),u=s.map((function(e){return"Text"==e.segmentType?e.text:""})).join(""),f=v||u||"";if(s.some((function(e){return"SelectionMarker"!=e.segmentType}))&&u==f)s.forEach((function(e){var t=p(_,r,g,"Text"==e.segmentType);(0,d.addLink)(e,t),e.link&&C.push(e.link)}));else if(s.every((function(e){return"SelectionMarker"==e.segmentType}))||f&&f!=u){var m=(0,d.createText)(f||(y?y.originalUrl:h),(0,o.__assign)((0,o.__assign)({},(null===(l=s[0])||void 0===l?void 0:l.format)||{}),(0,i.getPendingFormat)(e)||{})),b=(0,d.createContentModelDocument)(),P=p(_,r,g);(0,d.addLink)(m,P),(0,d.addSegment)(b,m),m.link&&C.push(m.link),(0,c.mergeModel)(t,b,a,{mergeFormat:"mergeAll"})}return s.length>0}),{changeSource:a.ChangeSource.CreateLink,onNodeCreated:function(e,t){!b&&C.indexOf(e)>=0&&(b=t)},getChangeData:function(){return b}})}};var p=function(e,t,r,o){return void 0===o&&(o=!0),{dataset:{},format:{href:e,anchorTitle:t,target:r,underline:o}}}},3932:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(6331),n=r(5113),a=r(2511);t.default=function(e){e.focus(),(0,a.formatWithContentModel)(e,"removeLink",(function(e){(0,n.adjustSegmentSelection)(e,(function(e){return!!e.isSelected&&!!e.link}),(function(e,t){return e.isSelected||!!e.link&&e.link.format.href==t.link.format.href}));var t=(0,o.default)(e,!1),r=!1;return t.forEach((function(e){e.link&&(r=!0,delete e.link)})),r}))}},1123:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(2511),n=r(5544);t.default=function(e,t){e.focus(),(0,o.formatWithContentModel)(e,"setListStartNumber",(function(e){var r=(0,n.getFirstSelectedListItem)(e),o=null==r?void 0:r.levels[(null==r?void 0:r.levels.length)-1];return!!o&&(o.format.startNumberOverride=t,!0)}))}},3e3:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(2874),n=r(2511),a=r(5544),l=r(7410);t.default=function(e,t){e.focus(),(0,n.formatWithContentModel)(e,"setListStyle",(function(e){var r=(0,a.getFirstSelectedListItem)(e);if(r){var n=(0,o.findListItemsInSameThread)(e,r),i=r.levels.length-1;return n.forEach((function(e){var r=e.levels[i];r&&(0,l.updateListMetadata)(r,(function(e){return Object.assign({},e,t)}))})),!0}return!1}))}},58:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(2511),n=r(1567);t.default=function(e){e.focus(),(0,o.formatWithContentModel)(e,"toggleBullet",(function(e){return(0,n.setListType)(e,"UL")}),{preservePendingFormat:!0})}},4505:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(2511),n=r(1567);t.default=function(e){e.focus(),(0,o.formatWithContentModel)(e,"toggleNumbering",(function(e){return(0,n.setListType)(e,"OL")}),{preservePendingFormat:!0})}},4847:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1741);t.default=function(e,t){(0,o.formatSegmentWithContentModel)(e,"applySegmentFormat",(function(e){e.backgroundColor=t.backgroundColor,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontWeight=t.fontWeight,e.italic=t.italic,e.strikethrough=t.strikethrough,e.superOrSubScriptSequence=t.superOrSubScriptSequence,e.textColor=t.textColor,e.underline=t.underline}),void 0,!0)}},5284:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1741);t.default=function(e,t,r){e.focus(),(0,o.formatSegmentWithContentModel)(e,"changeCapitalization",(function(e,o,n){if("Text"==(null==n?void 0:n.segmentType))switch(t){case"lowerCase":n.text=n.text.toLocaleLowerCase(r);break;case"upperCase":n.text=n.text.toLocaleUpperCase(r);break;case"capitalize":for(var a=n.text.toLocaleLowerCase(r).split(" "),l=0;l<a.length;l++)a[l]=a[l].charAt(0).toLocaleUpperCase(r)+a[l].slice(1);n.text=a.join(" ");break;case"sentence":var i=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");n.text=n.text.toLocaleLowerCase(r).replace(i,(function(e){return e.toLocaleUpperCase(r)}))}}))}},7451:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1741),n=r(1246),a=r(5442),l=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];t.default=function(e,t){e.focus(),(0,o.formatSegmentWithContentModel)(e,"changeFontSize",(function(e,r,o,i){return function(e,t,r){if(t.fontSize){var o=(0,n.parseValueWithUnit)(t.fontSize,void 0,"pt");if(o>0){var i=function(e,t,r){e=1==t?Math.floor(e):Math.ceil(e);var o=r[r.length-1];if(e<=r[0])e=Math.max(e+t,1);else if(e>o||e==o&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),o),1e3);else if(1==t){for(var n=0;n<r.length;n++)if(e<r[n]){e=r[n];break}}else for(n=r.length-1;n>=0;n--)if(e>r[n]){e=r[n];break}return e}(o,"increase"==e?1:-1,l);(0,a.setFontSizeInternal)(i+"pt",t,r)}}}(t,e,i)}),void 0,!0)}},5253:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1246),n=r(1741),a=r(5736);t.default=function(e,t){e.focus();var r=null,l=-1;(0,n.formatSegmentWithContentModel)(e,"setBackgroundColor",(function(e,o,n,a){null===t?delete e.backgroundColor:e.backgroundColor=t,n&&a&&"SelectionMarker"!=n.segmentType&&(l=(r=a).segments.indexOf(n))}),void 0,void 0,(function(e){var t;if(r&&l>=0){var n=(0,o.createSelectionMarker)(null===(t=r.segments[l])||void 0===t?void 0:t.format);r.segments.splice(l+1,0,n),(0,a.setSelection)(e,n,n)}}))}},1250:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1741);t.default=function(e,t){e.focus(),(0,o.formatSegmentWithContentModel)(e,"setFontName",(function(e,r,o){e.fontFamily=t,(null==o?void 0:o.code)&&(o.code.format.fontFamily=t)}),void 0,!0)}},5442:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setFontSizeInternal=void 0;var o=r(1741);function n(e,t,r){var o;if(t.fontSize=e,null===(o=null==r?void 0:r.segmentFormat)||void 0===o?void 0:o.fontSize){var n=r.segmentFormat.fontSize;r.segments.forEach((function(e){e.format.fontSize||(e.format.fontSize=n)})),delete r.segmentFormat.fontSize}}t.default=function(e,t){e.focus(),(0,o.formatSegmentWithContentModel)(e,"setFontSize",(function(e,r,o,a){return n(t,e,a)}),void 0,!0)},t.setFontSizeInternal=n},9715:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1741);t.default=function(e,t){e.focus(),(0,o.formatSegmentWithContentModel)(e,"setTextColor",null===t?function(e,t,r){delete e.textColor,(null==r?void 0:r.link)&&delete r.link.format.textColor}:function(e,r,o){e.textColor=t,(null==o?void 0:o.link)&&(o.link.format.textColor=t)},void 0,!0)}},5539:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBold=void 0;var o=r(1741);function n(e){return!!e&&("bold"==e||"bolder"==e||parseInt(e)>=600)}t.default=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleBold",(function(e,t){e.fontWeight=t?"bold":"normal"}),(function(e,t,r){var o;return n(void 0===e.fontWeight?null===(o=null==r?void 0:r.decorator)||void 0===o?void 0:o.format.fontWeight:e.fontWeight)}))},t.isBold=n},1340:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1246),n=r(1741),a={format:{fontFamily:"monospace"}};t.default=function(e){e.focus(),(0,n.formatSegmentWithContentModel)(e,"toggleCode",(function(e,t,r){r&&(t?(0,o.addCode)(r,a):delete r.code)}),(function(e,t){return!!(null==t?void 0:t.code)}))}},3462:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1741);t.default=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleItalic",(function(e,t){e.italic=!!t}),(function(e){return!!e.italic}))}},5602:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1741);t.default=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleStrikethrough",(function(e,t){e.strikethrough=!!t}),(function(e){return!!e.strikethrough}))}},2494:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1741);t.default=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleSubscript",(function(e,t){e.superOrSubScriptSequence=t?"sub":""}),(function(e){var t;return"sub"==(null===(t=e.superOrSubScriptSequence)||void 0===t?void 0:t.split(" ").pop())}))}},1308:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1741);t.default=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleSuperscript",(function(e,t){e.superOrSubScriptSequence=t?"super":""}),(function(e){var t;return"super"==(null===(t=e.superOrSubScriptSequence)||void 0===t?void 0:t.split(" ").pop())}))}},5212:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1741);t.default=function(e){e.focus(),(0,o.formatSegmentWithContentModel)(e,"toggleUnderline",(function(e,t,r){e.underline=!!t,(null==r?void 0:r.link)&&(r.link.format.underline=!!t)}),(function(e,t){var r,o;return!!e.underline||!!(null===(o=null===(r=null==t?void 0:t.link)||void 0===r?void 0:r.format)||void 0===o?void 0:o.underline)}))}},6331:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(5544);t.default=function(e,t){return(0,o.getSelectedSegmentsAndParagraphs)(e,t).map((function(e){return e[0]}))}},6516:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7536),n=r(5676);t.default=function(e){switch(e.blockType){case"Paragraph":return e.segments.some(n.default);case"Table":return e.rows.some((function(e){return e.cells.some(o.default)}));case"BlockGroup":return(0,o.default)(e);case"Divider":case"Entity":return!!e.isSelected;default:return!1}}},7536:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(6516);t.default=function(e){return!("TableCell"!=e.blockGroupType||!e.isSelected)||!!e.blocks.some(o.default)}},5676:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(6516);t.default=function(e){return e.isSelected||"General"==e.segmentType&&e.blocks.some(o.default)}},2535:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(9843),a=r(2511),l=r(5544),i=r(5226),s=r(1246),c=r(860);function d(e,t,r){r.forEach((function(r){e.format[r]=t})),(0,c.updateTableCellMetadata)(e,(function(e){return(e=e||{}).borderOverride=!0,e})),delete e.cachedElement}t.default=function(e,t,r){(0,a.formatWithContentModel)(e,"tableBorder",(function(e){var a=(0,o.__read)((0,l.getFirstSelectedTable)(e),1)[0];if(a){var c=(0,i.getSelectedCells)(a),u={Top:!1,Bottom:!1,Left:!1,Right:!1},f="",m=a.format,p=t.width,v=t.style,g=t.color,h=(0,n.extractBorderValues)(m.borderTop),b=h.color,y=h.width,_=h.style;if(f=p?(0,s.parseValueWithUnit)(p)+"px":y||"1px",v?f=f+" "+v:_?f=f+" "+_:f+=" solid",g?f=f+" "+g:b&&(f=f+" "+b),c){for(var C=[r];C.length;)switch(C.pop()){case"noBorders":f="",C.push("allBorders");break;case"allBorders":for(var P=["borderTop","borderBottom","borderLeft","borderRight"],S=c.firstRow;S<=c.lastRow;S++)for(var k=c.firstCol;k<=c.lastCol;k++)d(a.rows[S].cells[k],f,P);u.Top=!0,u.Bottom=!0,u.Left=!0,u.Right=!0;break;case"leftBorders":var O=["borderLeft"];for(S=c.firstRow;S<=c.lastRow;S++)d(a.rows[S].cells[c.firstCol],f,O);u.Left=!0;break;case"rightBorders":var T=["borderRight"];for(S=c.firstRow;S<=c.lastRow;S++)d(a.rows[S].cells[c.lastCol],f,T);u.Right=!0;break;case"topBorders":var M=["borderTop"];for(k=c.firstCol;k<=c.lastCol;k++)d(a.rows[c.firstRow].cells[k],f,M);u.Top=!0;break;case"bottomBorders":var w=["borderBottom"];for(k=c.firstCol;k<=c.lastCol;k++)d(a.rows[c.lastRow].cells[k],f,w);u.Bottom=!0;break;case"insideBorders":for(d(a.rows[c.firstRow].cells[c.firstCol],f,["borderBottom","borderRight"]),d(a.rows[c.firstRow].cells[c.lastCol],f,["borderBottom","borderLeft"]),d(a.rows[c.lastRow].cells[c.firstCol],f,["borderTop","borderRight"]),d(a.rows[c.lastRow].cells[c.lastCol],f,["borderTop","borderLeft"]),k=c.firstCol+1;k<c.lastCol;k++)d(a.rows[c.firstRow].cells[k],f,["borderBottom","borderLeft","borderRight"]);for(k=c.firstCol+1;k<c.lastCol;k++)d(a.rows[c.lastRow].cells[k],f,["borderTop","borderLeft","borderRight"]);for(S=c.firstRow+1;S<c.lastRow;S++)d(a.rows[S].cells[c.firstCol],f,["borderTop","borderBottom","borderRight"]);for(S=c.firstRow+1;S<c.lastRow;S++)d(a.rows[S].cells[c.lastCol],f,["borderTop","borderBottom","borderLeft"]);c.firstCol++,c.firstRow++,c.lastCol--,c.lastRow--,C.push("allBorders");break;case"outsideBorders":C.push("topBorders"),C.push("bottomBorders"),C.push("leftBorders"),C.push("rightBorders")}!function(e,t,r,o){if(o.Top&&t.firstRow-1>=0)for(var n=t.firstCol;n<=t.lastCol;n++)d(e.rows[t.firstRow-1].cells[n],r,["borderBottom"]);if(o.Bottom&&t.lastRow+1<e.rows.length)for(n=t.firstCol;n<=t.lastCol;n++)d(e.rows[t.lastRow+1].cells[n],r,["borderTop"]);if(o.Left&&t.firstCol-1>=0)for(var a=t.firstRow;a<=t.lastRow;a++)d(e.rows[a].cells[t.firstCol-1],r,["borderRight"]);if(o.Right&&t.lastCol+1<e.rows[0].cells.length)for(a=t.firstRow;a<=t.lastRow;a++)d(e.rows[a].cells[t.lastCol+1],r,["borderLeft"])}(a,c,f,u)}return!0}return!1}))}},959:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(6516),a=r(6682),l=r(4158),i=r(6893),s=r(629),c=r(4054),d=r(9073),u=r(2511),f=r(5544),m=r(7350),p=r(9457),v=r(8509),g=r(4765),h=r(2806),b=r(1303),y=r(5736),_=r(3618),C=r(2242),P=r(7691),S=r(1246);t.default=function(e,t){e.focus(),(0,u.formatWithContentModel)(e,"editTable",(function(e){var r=(0,o.__read)((0,f.getFirstSelectedTable)(e),2),u=r[0],k=r[1];if(u){switch(t){case"alignCellLeft":case"alignCellCenter":case"alignCellRight":(0,P.alignTableCellHorizontally)(u,t);break;case"alignCellTop":case"alignCellMiddle":case"alignCellBottom":(0,P.alignTableCellVertically)(u,t);break;case"alignCenter":case"alignLeft":case"alignRight":(0,a.alignTable)(u,t);break;case"deleteColumn":(0,s.deleteTableColumn)(u);break;case"deleteRow":(0,c.deleteTableRow)(u);break;case"deleteTable":(0,i.deleteTable)(u);break;case"insertAbove":case"insertBelow":(0,p.insertTableRow)(u,t);break;case"insertLeft":case"insertRight":(0,m.insertTableColumn)(u,t);break;case"mergeAbove":case"mergeBelow":(0,h.mergeTableRow)(u,t);break;case"mergeCells":(0,v.mergeTableCells)(u);break;case"mergeLeft":case"mergeRight":(0,g.mergeTableColumn)(u,t);break;case"splitHorizontally":(0,_.splitTableCellHorizontally)(u);break;case"splitVertically":(0,C.splitTableCellVertically)(u)}if(!(0,n.default)(u)){var O=(0,d.ensureFocusableParagraphForTable)(e,k,u);if(O){var T=(0,S.createSelectionMarker)(e.format);O.segments.unshift(T),(0,S.setParagraphNotImplicit)(O),(0,y.setSelection)(e,T)}}return(0,b.normalizeTable)(u,e.format),(0,S.hasMetadata)(u)&&(0,l.applyTableFormat)(u,void 0,!0),!0}return!1}))}},2435:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(4158),a=r(2511),l=r(5544),i=r(860);t.default=function(e,t,r){e.focus(),(0,a.formatWithContentModel)(e,"formatTable",(function(e){var a=(0,o.__read)((0,l.getFirstSelectedTable)(e),1)[0];return!!a&&(a.rows.forEach((function(e){e.cells.forEach((function(e){(0,i.updateTableCellMetadata)(e,(function(e){return e&&delete e.borderOverride,e}))}))})),(0,n.applyTableFormat)(a,t,r),!0)}))}},6901:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4158),n=r(1246),a=r(2969),l=r(473),i=r(2511),s=r(2976),c=r(485),d=r(1303),u=r(5736);t.default=function(e,t,r,f){e.focus(),(0,i.formatWithContentModel)(e,"insertTable",(function(i,m){var p,v,g,h=(0,l.deleteSelection)(i,[],m).insertPoint;if(h){var b=(0,n.createContentModelDocument)(),y=(0,a.createTableStructure)(b,t,r);(0,d.normalizeTable)(y,(0,s.getPendingFormat)(e)||h.marker.format),f=f||{verticalAlign:"top"},(0,o.applyTableFormat)(y,f),(0,c.mergeModel)(i,b,m,{insertPosition:h,mergeFormat:"mergeAll"});var _=null===(v=null===(p=y.rows[0])||void 0===p?void 0:p.cells[0])||void 0===v?void 0:v.blocks[0];if("Paragraph"==(null==_?void 0:_.blockType)){var C=(0,n.createSelectionMarker)(null===(g=_.segments[0])||void 0===g?void 0:g.format);_.segments.unshift(C),(0,u.setSelection)(i,C)}return!0}return!1}))}},7783:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(7536),a=r(2511),l=r(5544),i=r(1303),s=r(3684);t.default=function(e,t){e.focus(),(0,a.formatWithContentModel)(e,"setTableCellShade",(function(e){var r=(0,o.__read)((0,l.getFirstSelectedTable)(e),1)[0];return!!r&&((0,i.normalizeTable)(r),r.rows.forEach((function(e){return e.cells.forEach((function(e){(0,n.default)(e)&&(0,s.setTableCellBackgroundColor)(e,t,!0)}))})),!0)}))}},6154:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1741);t.default=function(e,t,r){(0,o.formatSegmentWithContentModel)(e,t,(function(e,t,o){"Image"==(null==o?void 0:o.segmentType)&&r(o)}),void 0,void 0)}},9139:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatParagraphWithContentModel=void 0;var o=r(2511),n=r(5544);t.formatParagraphWithContentModel=function(e,t,r){(0,o.formatWithContentModel)(e,t,(function(e){var t=(0,n.getSelectedParagraphs)(e);return t.forEach(r),t.length>0}),{preservePendingFormat:!0})}},1741:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatSegmentWithContentModel=void 0;var o=r(7582),n=r(5294),a=r(2511),l=r(2976),i=r(5544);t.formatSegmentWithContentModel=function(e,t,r,s,c,d){(0,a.formatWithContentModel)(e,t,(function(t){var a=(0,i.getSelectedSegmentsAndParagraphs)(t,!!c),u=(0,l.getPendingFormat)(e),f=1==a.length&&"SelectionMarker"==a[0][0].segmentType;if(f){var m=a[0][1];(a=(0,n.adjustWordSelection)(t,a[0][0]).map((function(e){return[e,m]}))).length>1&&(f=!1)}var p=u?[[u,null,null]]:a.map((function(e){return[e[0].format,e[0],e[1]]})),v=!!s&&p.every((function(e){var t=(0,o.__read)(e,3),r=t[0],n=t[1],a=t[2];return s(r,n,a)}));if(p.forEach((function(e){var t=(0,o.__read)(e,3),n=t[0],a=t[1],l=t[2];return r(n,!v,a,l)})),null==d||d(t),!u&&f){var g=e.getFocusedPosition();g&&(0,l.setPendingFormat)(e,a[0][0].format,g.node,g.offset)}return f?(e.focus(),!1):p.length>0}))}},2511:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatWithContentModel=void 0;var o=r(436),n=r(2976);t.formatWithContentModel=function(e,t,r,l){var i,s=l||{},c=s.onNodeCreated,d=s.preservePendingFormat,u=s.getChangeData,f=s.changeSource,m=s.rawEvent,p=s.selectionOverride,v=e.createContentModel(void 0,p),g={newEntities:[],deletedEntities:[],rawEvent:m,newImages:[]};if(r(v,g)){var h=function(){if(function(e,t){e.isDarkMode()&&t.newEntities.forEach((function(t){e.transformToDarkColor(t.wrapper)}))}(e,g),function(e,t){t.deletedEntities.forEach((function(r){var o=r.entity,n=o.wrapper,l=o.entityFormat,i=l.id,s=l.entityType,c=l.isReadonly,d=r.operation;if(i&&s){var u={id:i,type:s,isReadonly:!!c,wrapper:n};e.triggerPluginEvent(15,{entity:u,operation:a[d],rawEvent:t.rawEvent})}}))}(e,g),function(e,t){if(t.newImages.length>0){var r=e.getVisibleViewport();if(r){var o=r.left,n=r.right,a=Math.max(n-o,10);t.newImages.forEach((function(e){e.format.maxWidth=a+"px"}))}}}(e,g),i=e.setContentModel(v,void 0,c)||void 0,d){var t=(0,n.getPendingFormat)(e),r=e.getFocusedPosition();t&&r&&(0,n.setPendingFormat)(e,t,r.node,r.offset)}};g.skipUndoSnapshot?h():e.addUndoSnapshot(h,void 0,!1,{formatApiName:t});var b={contentModel:v,selection:i,source:f||o.ChangeSource.Format,data:null==u?void 0:u(),additionalData:{formatApiName:t}};e.triggerPluginEvent(7,b)}};var a={overwrite:6,removeFromEnd:5,removeFromStart:4}},5915:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergePasteContent=void 0;var o=r(7582),n=r(6331),a=r(436),l=r(2511),i=r(485),s=r(2976),c=r(1246),d=r(2347),u={asImage:3,asPlainText:1,mergeFormat:2,normal:0},f={backgroundColor:"",fontFamily:"",fontSize:"",fontWeight:"",italic:!1,letterSpacing:"",lineHeight:"",strikethrough:!1,superOrSubScriptSequence:"",textColor:"",underline:!1};function m(e,t,r,o,n){return n?n(e,r):(0,i.mergeModel)(e,r,t,{mergeFormat:o?"keepSourceEmphasisFormat":"none",mergeTable:p(r)})}function p(e){return 2==e.blocks.length&&"Table"===e.blocks[0].blockType&&"Paragraph"===e.blocks[1].blockType&&1===e.blocks[1].segments.length&&"Br"===e.blocks[1].segments[0].segmentType&&e.blocks.splice(1),1===e.blocks.length&&"Table"===e.blocks[0].blockType}t.default=function(e,t,r){var i;void 0===r&&(r="normal"),t.snapshotBeforePaste?e.setContent(t.snapshotBeforePaste):t.snapshotBeforePaste=e.getContent(2),e.focus(),(0,l.formatWithContentModel)(e,"Paste",(function(a,l){var s,f=function(e,t,r){var o=(0,d.createDefaultHtmlSanitizerOptions)();return o.cssStyleCallbacks["caret-color"]=function(){return!1},{clipboardData:t,fragment:e.getDocument().createDocumentFragment(),sanitizingOption:o,htmlBefore:"",htmlAfter:"",htmlAttributes:{},domToModelOption:{},pasteType:u[r]}}(e,t,r),p=(0,n.default)(a,!0)[0],v=null!==(s=null==p?void 0:p.format)&&void 0!==s?s:{},g=v.fontFamily,h=v.fontSize,b=v.textColor,y=v.backgroundColor,_=v.letterSpacing,C=v.lineHeight,P=function(e,t,r,n,a){var l=(0,o.__assign)({eventType:10},n),i=l.fragment,s=t.rawHtml,u=t.text,f=t.imageDataUri,m=e.getTrustedHTMLHandler(),p=s?(new DOMParser).parseFromString(m(s),"text/html"):void 0;(0,d.retrieveMetadataFromClipboard)(p,l,m),"asImage"==r&&f||"asPlainText"!=r&&!u&&f?(0,d.handleImagePaste)(f,i):"asPlainText"!=r&&s&&p&&p.body?(0,c.moveChildNodes)(i,null==p?void 0:p.body):u&&(0,d.handleTextPaste)(u,null,i);var v=i.ownerDocument.createElement("span");(0,c.moveChildNodes)(v,i),i.appendChild(v),(0,c.applySegmentFormatToElement)(v,a);var g=l;return"asPlainText"!==r&&(g=e.triggerPluginEvent(10,l,!0)),(0,d.sanitizePasteContent)(l,null),g}(e,t,r,f,{fontFamily:g,fontSize:h,textColor:b,backgroundColor:y,letterSpacing:_,lineHeight:C}),S=P.domToModelOption,k=P.fragment,O=P.customizedMerge,T=m(a,l,(0,c.domToContentModel)(k,(0,c.createDomToModelContext)(void 0,S)),"mergeFormat"==r,O);return T&&(i=T.marker.format),!0}),{changeSource:a.ChangeSource.Paste,getChangeData:function(){return t}});var p=e.getFocusedPosition();i&&p&&(0,s.setPendingFormat)(e,(0,o.__assign)((0,o.__assign)({},f),i),p.node,p.offset)},t.mergePasteContent=m},436:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeSource=void 0,(r=t.ChangeSource||(t.ChangeSource={})).AutoLink="AutoLink",r.CreateLink="CreateLink",r.Format="Format",r.ImageResize="ImageResize",r.Paste="Paste",r.SetContent="SetContent",r.Cut="Cut",r.Drop="Drop",r.InsertEntity="InsertEntity",r.SwitchToDarkMode="SwitchToDarkMode",r.SwitchToLightMode="SwitchToLightMode",r.ListChain="ListChain",r.Keyboard="Keyboard"},5826:(e,t)=>{var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.NumberingListType=t.BulletListType=void 0,(o=t.BulletListType||(t.BulletListType={}))[o.Min=1]="Min",o[o.Disc=1]="Disc",o[o.Dash=2]="Dash",o[o.Square=3]="Square",o[o.ShortArrow=4]="ShortArrow",o[o.LongArrow=5]="LongArrow",o[o.UnfilledArrow=6]="UnfilledArrow",o[o.Hyphen=7]="Hyphen",o[o.DoubleLongArrow=8]="DoubleLongArrow",o[o.Circle=9]="Circle",o[o.Max=9]="Max",(r=t.NumberingListType||(t.NumberingListType={}))[r.Min=1]="Min",r[r.Decimal=1]="Decimal",r[r.DecimalDash=2]="DecimalDash",r[r.DecimalParenthesis=3]="DecimalParenthesis",r[r.DecimalDoubleParenthesis=4]="DecimalDoubleParenthesis",r[r.LowerAlpha=5]="LowerAlpha",r[r.LowerAlphaParenthesis=6]="LowerAlphaParenthesis",r[r.LowerAlphaDoubleParenthesis=7]="LowerAlphaDoubleParenthesis",r[r.LowerAlphaDash=8]="LowerAlphaDash",r[r.UpperAlpha=9]="UpperAlpha",r[r.UpperAlphaParenthesis=10]="UpperAlphaParenthesis",r[r.UpperAlphaDoubleParenthesis=11]="UpperAlphaDoubleParenthesis",r[r.UpperAlphaDash=12]="UpperAlphaDash",r[r.LowerRoman=13]="LowerRoman",r[r.LowerRomanParenthesis=14]="LowerRomanParenthesis",r[r.LowerRomanDoubleParenthesis=15]="LowerRomanDoubleParenthesis",r[r.LowerRomanDash=16]="LowerRomanDash",r[r.UpperRoman=17]="UpperRoman",r[r.UpperRomanParenthesis=18]="UpperRomanParenthesis",r[r.UpperRomanDoubleParenthesis=19]="UpperRomanDoubleParenthesis",r[r.UpperRomanDash=20]="UpperRomanDash",r[r.Max=20]="Max"},8946:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TableBorderFormat=void 0,(r=t.TableBorderFormat||(t.TableBorderFormat={}))[r.DEFAULT=0]="DEFAULT",r[r.LIST_WITH_SIDE_BORDERS=1]="LIST_WITH_SIDE_BORDERS",r[r.NO_HEADER_BORDERS=2]="NO_HEADER_BORDERS",r[r.NO_SIDE_BORDERS=3]="NO_SIDE_BORDERS",r[r.FIRST_COLUMN_HEADER_EXTERNAL=4]="FIRST_COLUMN_HEADER_EXTERNAL",r[r.ESPECIAL_TYPE_1=5]="ESPECIAL_TYPE_1",r[r.ESPECIAL_TYPE_2=6]="ESPECIAL_TYPE_2",r[r.ESPECIAL_TYPE_3=7]="ESPECIAL_TYPE_3",r[r.CLEAR=8]="CLEAR"},398:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BulletListType=t.NumberingListType=t.TableBorderFormat=void 0;var o=r(8946);Object.defineProperty(t,"TableBorderFormat",{enumerable:!0,get:function(){return o.TableBorderFormat}});var n=r(5826);Object.defineProperty(t,"NumberingListType",{enumerable:!0,get:function(){return n.NumberingListType}}),Object.defineProperty(t,"BulletListType",{enumerable:!0,get:function(){return n.BulletListType}})},1533:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelEditor=void 0;var o=r(3247),n=r(2347);t.createContentModelEditor=function(e,t,r){var a=[new o.ContentModelPastePlugin];t&&(a=a.concat(t));var l={plugins:a,initialContent:r,getDarkColor:n.getDarkColor,defaultFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new o.ContentModelEditor(e,l)}},2594:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelEditor=void 0;var o=r(7582),n=r(1533);Object.defineProperty(t,"createContentModelEditor",{enumerable:!0,get:function(){return n.createContentModelEditor}}),(0,o.__exportStar)(r(398),t),(0,o.__exportStar)(r(1246),t),(0,o.__exportStar)(r(3247),t)},2347:e=>{e.exports=roosterjs},7582:(e,t,r)=>{r.r(t),r.d(t,{__assign:()=>a,__asyncDelegator:()=>O,__asyncGenerator:()=>k,__asyncValues:()=>T,__await:()=>S,__awaiter:()=>p,__classPrivateFieldGet:()=>x,__classPrivateFieldIn:()=>B,__classPrivateFieldSet:()=>j,__createBinding:()=>g,__decorate:()=>i,__esDecorate:()=>c,__exportStar:()=>h,__extends:()=>n,__generator:()=>v,__importDefault:()=>F,__importStar:()=>E,__makeTemplateObject:()=>M,__metadata:()=>m,__param:()=>s,__propKey:()=>u,__read:()=>y,__rest:()=>l,__runInitializers:()=>d,__setFunctionName:()=>f,__spread:()=>_,__spreadArray:()=>P,__spreadArrays:()=>C,__values:()=>b,default:()=>L});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)};function l(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function i(e,t,r,o){var n,a=arguments.length,l=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(a<3?n(l):a>3?n(t,r,l):n(t,r))||l);return a>3&&l&&Object.defineProperty(t,r,l),l}function s(e,t){return function(r,o){t(r,o,e)}}function c(e,t,r,o,n,a){function l(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var i,s=o.kind,c="getter"===s?"get":"setter"===s?"set":"value",d=!t&&e?o.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,o.name):{}),f=!1,m=r.length-1;m>=0;m--){var p={};for(var v in o)p[v]="access"===v?{}:o[v];for(var v in o.access)p.access[v]=o.access[v];p.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(l(e||null))};var g=(0,r[m])("accessor"===s?{get:u.get,set:u.set}:u[c],p);if("accessor"===s){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(i=l(g.get))&&(u.get=i),(i=l(g.set))&&(u.set=i),(i=l(g.init))&&n.unshift(i)}else(i=l(g))&&("field"===s?n.unshift(i):u[c]=i)}d&&Object.defineProperty(d,o.name,u),f=!0}function d(e,t,r){for(var o=arguments.length>2,n=0;n<t.length;n++)r=o?t[n].call(e,r):t[n].call(e);return o?r:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function f(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,o){return new(r||(r=Promise))((function(n,a){function l(e){try{s(o.next(e))}catch(e){a(e)}}function i(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,i)}s((o=o.apply(e,t||[])).next())}))}function v(e,t){var r,o,n,a,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(l=0)),l;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!((n=(n=l.trys).length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){l.label=i[1];break}if(6===i[0]&&l.label<n[1]){l.label=n[1],n=i;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(i);break}n[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var g=Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function h(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,a=r.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)l.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return l}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],l=0,i=a.length;l<i;l++,n++)o[n]=a[l];return o}function P(e,t,r){if(r||2===arguments.length)for(var o,n=0,a=t.length;n<a;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function k(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),a=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(e){n[e]&&(o[e]=function(t){return new Promise((function(r,o){a.push([e,t,r,o])>1||i(e,t)}))})}function i(e,t){try{(r=n[e](t)).value instanceof S?Promise.resolve(r.value.v).then(s,c):d(a[0][2],r)}catch(e){d(a[0][3],e)}var r}function s(e){i("next",e)}function c(e){i("throw",e)}function d(e,t){e(t),a.shift(),a.length&&i(a[0][0],a[0][1])}}function O(e){var t,r;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:S(e[o](t)),done:!1}:n?n(t):t}:n}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(o,n){!function(e,t,r,o){Promise.resolve(o).then((function(t){e({value:t,done:r})}),t)}(o,n,(t=e[r](t)).done,t.value)}))}}}function M(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var w=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return w(t,e),t}function F(e){return e&&e.__esModule?e:{default:e}}function x(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function j(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}function B(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}const L={__extends:n,__assign:a,__rest:l,__decorate:i,__param:s,__metadata:m,__awaiter:p,__generator:v,__createBinding:g,__exportStar:h,__values:b,__read:y,__spread:_,__spreadArrays:C,__spreadArray:P,__await:S,__asyncGenerator:k,__asyncDelegator:O,__asyncValues:T,__makeTemplateObject:M,__importStar:E,__importDefault:F,__classPrivateFieldGet:x,__classPrivateFieldSet:j,__classPrivateFieldIn:B}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o=r(2594);roosterjsContentModel=o})();
//# sourceMappingURL=rooster-content-model-min.js.map