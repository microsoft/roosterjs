{"version":3,"file":"demo.js","mappings":"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C,EACI7sC,EACAA,EACAA,GACA,GACA,GACA,GACA,EACA,EAAAs2B,kBAAkB2W,cAClB,KACAL,EACA5sC,EAXJ,EAaJktC,KAAM,SAACltC,EAAO4sC,GACV,OAAAC,EACI7sC,EACAA,EACA,MACA,GACA,GACA,GACA,EACA,EAAAs2B,kBAAkBwW,QAClB,KACAF,EACA5sC,EAXJ,EAaJmtC,mCAAoC,SAACntC,EAAO4sC,GACxC,OAAAC,EACI7sC,EACAA,EACAA,GACA,GACA,GACA,GACA,EACA,EAAAs2B,kBAAkB8W,0BAClB,UACAR,EACA5sC,EAXJ,EAaJqtC,SAAU,SAACrtC,EAAO4sC,GACd,OAAAC,EACI7sC,EACAA,EACAA,GACA,GACA,GACA,GACA,EACA,EAAAs2B,kBAAkBgX,oBAClB,KACAV,EACA5sC,EAXJ,EAaJutC,mBAAoB,SAACvtC,EAAO4sC,GACxB,OAAAC,EACI7sC,EACAA,EACAA,GACA,GACA,GACA,GACA,EACA,EAAAs2B,kBAAkBkX,gBAClB,KACAZ,EACA5sC,EAXJ,EAaJytC,gBAAiB,SAACztC,EAAO4sC,GACrB,OAAAC,EACI7sC,EACAA,EACAA,GACA,GACA,GACA,GACA,EACA,EAAAs2B,kBAAkBoX,cAClB,KACAd,EACA5sC,EAXJ,EAaJ2tC,gBAAiB,SAAC3tC,EAAO4sC,GACrB,OAAAC,EACI7sC,EACAA,EACAA,GACA,GACA,GACA,GACA,EACA,EAAAs2B,kBAAkBsX,cAClB,KACAhB,EACA5sC,EAXJ,EAaJ6tC,gBAAiB,SAAC7tC,EAAO4sC,GACrB,OAAAC,EACI7sC,EACAA,EACAA,GACA,GACA,GACA,GACA,EACA,EAAAs2B,kBAAkBwX,cAClBlB,EACA,KACA5sC,EAXJ,EAaJ+tC,MAAO,SAAC/tC,EAAO4sC,GACX,OAAAC,EACI7sC,EACAA,EACAA,GACA,GACA,GACA,GACA,EACA,EAAAs2B,kBAAkB0X,MAClBpB,EACA,KACA5sC,EAXJ,GAeR,SAAgB6sC,EACZoB,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACApY,EACAC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u+B,EAAkBv+B,SAC5BE,WAAYq+B,EAAkBr+B,WAC9BD,QAASs+B,EAAkBt+B,UAGnC,MACJ,IAAK,QACD,IAAM3mC,EAAQuyC,EAAat0B,cACvB,IAAMgnD,EAAkB7C,SAGxBpiE,IACAklE,EAAe,CACXx2E,KAAM,QACNsR,MAAOA,IAOvBklE,GACA9yB,EAAKc,IAAI8B,gBAAgB5C,EAAM8yB,EAEvC,kKC7DA,eAMa,EAAAjR,YAAqC,CAC9C,IACA,OACA,UACA,OACA,UACA,QACA,IACA,MACA,MACA,aACA,OACA,KACA,SACA,SACA,UACA,SACA,OACA,OACA,MACA,WACA,OACA,WACA,KACA,MACA,UACA,MACA,SACA,MACA,MACA,KACA,KACA,KACA,WACA,aACA,SACA,OACA,SACA,KACA,KACA,KACA,KACA,KACA,KACA,OACA,SACA,SACA,KACA,OACA,IACA,MACA,QACA,MACA,MACA,QACA,SACA,KACA,OACA,MACA,OACA,OACA,WACA,QACA,MACA,KACA,WACA,SACA,SACA,IACA,UACA,MACA,WACA,IACA,KACA,KACA,OACA,IACA,OACA,UACA,SACA,QACA,OACA,SACA,SACA,MACA,UACA,MACA,QACA,QACA,KACA,WACA,QACA,KACA,QACA,OACA,KACA,KACA,IACA,KACA,MACA,MACA,OAMS,EAAAG,eAAwC,CACjD,SACA,QACA,OACA,WACA,QACA,QACA,WACA,SACA,OACA,OACA,WACA,SACA,QACA,SACA,OACA,SACA,QACA,WACA,QACA,QACA,SAGJ,IAAMiR,EAAiB,iDACjBC,EAAkB,OAElBC,EAAoB,CACtB,SACA,QACA,MACA,UACA,OACA,QACA,QACA,OACA,UACA,cACA,SACA,WACA,UACA,MACA,UACA,WACA,WACA,OACA,UACA,SACA,SACA,OACA,OACA,WACA,QACA,OACA,QACA,OACA,OACA,MACA,MACA,YACA,QACA,MACA,WACA,OACA,UACA,UACA,cACA,WACA,MACA,WACA,WACA,OACA,UACA,QACA,WACA,QACA,OACA,QACA,OACA,aACA,MACA,UACA,SACA,QACA,OACA,QACA,WACA,SACA,QACA,YACA,OACA,SACA,SACA,QACA,QACA,OACA,WAGEC,EAAgD,CAClD,mBAAoB,cACpB,sBAAuB,eACvB,sBAAuB,OACvB,sBAAuB,MACvB,sBAAuB,IACvB,sBAAuB,UACvB,qBAAsB,OACtB,sBAAuB,OACvB,qBAAsB,IACtB,oBAAqB,eACrB,oBAAqB,OACrB,oBAAqB,MACrB,qBAAsB,eACtB,qBAAsB,OACtB,qBAAsB,MACtB,mBAAoB,eACpB,mBAAoB,OACpB,mBAAoB,MACpB,gBAAiB,cACjB,gBAAiB,OACjB,gBAAiB,MACjBrnB,SAAU,UACV,4BAA6B,MAC7B,YAAa,aACb,cAAe,MACf,eAAgB,MAChBr0C,QAAS,MACT,cAAe,MACf,eAAgB,MAChB,gBAAiB,MACjB,iBAAkB,MAClBhX,OAAQ,MACR,aAAc,MACd,cAAe,MACf,eAAgB,MAChB,gBAAiB,MACjB,iBAAkB,WAClB4D,MAAO,OACP,aAAc,SACd,yBAA0B,SAC1B,oBAAqB,SACrB,cAAe,MACf,iBAAkB,SAClB+uE,QAAS,IACT,aAAc,QACd,cAAe,MACf,iBAAkB,OAClBC,OAAQ,IACR,eAAgB,MAChB,cAAe,UAmDnB,SAAgB5Q,EACZ17E,EACA8D,EACAtC,EACA05E,EACAE,GAIA,IAFA,IAAMnkF,EAAU+I,EAAIle,cAAcgiB,GAEzBhmB,EAAI,EAAGA,EAAI0jB,EAAWzjB,OAAQD,IAAK,CACxC,IAAM6hB,EAAY6B,EAAW1jB,GACvB,EAAO6hB,EAAUrS,KAAKO,cAAcuI,OACpCnX,EAAQ0gB,EAAU1gB,MAElB8nD,EAAYq0C,aAAmB,EAAnBA,EAAsB,GAClCzkE,EACM,SAAR,EACM41E,EAAczoF,EAAK7kB,EAAOi8F,GACN,mBAAbn0C,EACPA,EAAU9nD,EAAO6kB,GACI,kBAAdijC,EACPA,EACI9nD,EACA,KACJktG,EAAkBj9F,QAAQ,IAAS,GAA8B,GAAzB,EAAKA,QAAQ,SACrDjQ,EACA,KAGN03B,SAECA,EAASlsB,MAAM,+BAEhBwM,EAAQhV,aAAa,EAAM00B,GAInC,OAAO1f,CACX,CAEA,SAASs1F,EACL7qF,EACAziB,EACAi8F,GAEA,IAAMsR,EAAQvtG,EAAM0L,MAAM,KACpBzG,EAAmB,GAiCzB,OA/BAsoG,EAAMtpG,SAAQ,SAAAupG,GACV,IAAMC,EAAaD,EAAKv9F,QAAQ,KAC1B5B,EAAOm/F,EAAKxrG,MAAM,EAAGyrG,GAAYt2F,OACnCnX,EAAgBwtG,EAAKxrG,MAAMyrG,EAAa,GAAGt2F,OAE/C,GAAI9I,GAAQrO,EAAO,EAkC3B,SAAuBA,GACnB,OAAyC,GAAlCA,EAAMiQ,QAAQg9F,EACzB,EAnCgBS,CAAc1tG,KACdA,EA2BhB,SAA4BA,GACxB,IAAMwL,EAAQwhG,EAAe5nG,KAAKpF,GAClC,OAAOwL,aAAK,EAALA,EAAQ,KAAM,EACzB,CA9BwBmiG,CAAmB3tG,IAG/B,IAAM8nD,EAAYm0C,aAAe,EAAfA,EAAkB5tF,GAC9Bu/F,EACkB,mBAAb9lD,EACDA,EAAU9nD,EAAOyiB,IACH,IAAdqlC,EACA,KACA9nD,EAGJ4tG,GACgB,WAAlBA,GACkB,WAAlBA,GACAA,EAAe39F,QAAQ,cAAgB,IACtC5B,EAAKgvC,WAAW,MACjB8vD,EAAkB9+F,IAASu/F,GAE3B3oG,EAAOtB,KAAQ0K,EAAI,IAAIu/F,GAGnC,IAEO3oG,EAAOH,KAAK,IACvB,CA7HA,2BAAgBu3F,EACZrkF,EACA0K,EACAo5E,EACAG,EACAE,GAEA,IAAMt3E,EAAM7M,EAAQyK,QAAQ7T,cACtBwtF,EACFN,EAAe7rF,QAAQ4U,IAAQ,EACzB,KACA43E,EACIzkF,EAAQ0D,cACRgH,EAAYzS,QAAQ4U,IAAQ,EAAIA,EAAM,OACtC7M,EAAQuK,WACR05E,EACAE,GAGd,GAAIC,EACA,IAAK,IAAIx/B,EAAQ5kD,EAAQuM,WAAYq4C,EAAOA,EAAQA,EAAMC,YAAa,CACnE,IAAMgxC,GAAW,IAAA/rB,cAAallB,EAAO,gBAC/By/B,EACIz/B,EACAl6C,EACAo5E,EACAG,EACAE,IAEJ,IAAAra,cAAallB,EAAO,aACpBA,EAAMvhD,YACN,KAEFwyF,IACAzR,SAAAA,EAAkBn5F,YAAY4qG,IAK1C,OAAOzR,CACX,EAKA,8ICnTa,EAAA0R,6BAAyD,CAClErjG,EAAG,CACCqlB,WAAW,GAEfi+E,WAAY,CACRjtD,UAAW,MACXF,aAAc,MACd6O,WAAY,OACZ8T,YAAa,QAEjB99B,KAAM,CACF1V,WAAY,aAEhB6gD,GAAI,CACAjhD,WAAY,OACZK,SAAU,OAEd6gD,GAAI,CACAlhD,WAAY,OACZK,SAAU,SAEd8gD,GAAI,CACAnhD,WAAY,OACZK,SAAU,UAEd+gD,GAAI,CACAphD,WAAY,OACZK,SAAU,OAEdghD,GAAI,CACArhD,WAAY,OACZK,SAAU,UAEdihD,GAAI,CACAthD,WAAY,OACZK,SAAU,UAEdtwB,EAAG,CACCohD,UAAW,MACXF,aAAc,OAElBotD,IAAK,CACDj+E,WAAY,YACZ+R,WAAY,MACZgf,UAAW,MACXF,aAAc,mICjDhBqtD,EAA6C,CAC/C9vE,QAAS,SAMA,EAAA+vE,oBAAuC,CAChDC,QAASF,EACTG,QAASH,EACTI,MAAOJ,EACPjmG,EAAG,CACC2nB,WAAY,QAEhBo+E,WAAY,CACR5vE,QAAS,QACT2iB,UAAW,MACXF,aAAc,MACd6O,WAAY,OACZ8T,YAAa,QAEjBp+B,GAAI8oE,EACJpzD,OAAQ,CACJ1c,QAAS,QACTuD,UAAW,UAEf4sE,GAAIL,EACJl/E,IAAKk/E,EACLM,GAAIN,EACJO,GAAIP,EACJQ,GAAI,CACAhlD,UAAW,UAEfilD,SAAUT,EACVU,WAAYV,EACZW,OAAQX,EACRY,OAAQZ,EACRa,KAAMb,EACNr9B,GAAI,CACAzyC,QAAS,QACTxO,WAAY,OACZK,SAAU,OAEd6gD,GAAI,CACA1yC,QAAS,QACTxO,WAAY,OACZK,SAAU,SAEd8gD,GAAI,CACA3yC,QAAS,QACTxO,WAAY,OACZK,SAAU,UAEd+gD,GAAI,CACA5yC,QAAS,QACTxO,WAAY,QAEhBqhD,GAAI,CACA7yC,QAAS,QACTxO,WAAY,OACZK,SAAU,UAEdihD,GAAI,CACA9yC,QAAS,QACTxO,WAAY,OACZK,SAAU,UAEdw3B,OAAQymD,EACRpjG,GAAIojG,EACJpvG,EAAG,CACC4qD,UAAW,UAEfslD,GAAI,CACA5wE,QAAS,aAEb6wE,KAAMf,EACNgB,IAAKhB,EACLiB,IAAI,EAAF,8BAAOjB,GAAY,CAAEkB,mBAAoB,SAC3CzvG,EAAG,CACCy+B,QAAS,QACT2iB,UAAW,MACXF,aAAc,OAElBotD,IAAK,CACD7vE,QAAS,QACTpO,WAAY,YACZ+R,WAAY,MACZgf,UAAW,MACXF,aAAc,OAElBrhD,EAAG,CACC6vG,eAAgB,gBAEpBC,QAASpB,EACTqB,OAAQ,CACJF,eAAgB,gBAEpBG,OAAQ,CACJ5/E,WAAY,QAEhB6/E,IAAK,CACD3tE,cAAe,MACf7R,SAAU,WAEdy/E,IAAK,CACD5tE,cAAe,QACf7R,SAAU,WAEdjQ,MAAO,CACHoe,QAAS,QACTzD,UAAW,cAEf21B,GAAI,CACAlyB,QAAS,cAEbuxE,GAAI,CACAvxE,QAAS,cAEbwxE,EAAG,CACCP,eAAgB,aAEpBQ,IAAI,EAAF,8BAAO3B,GAAY,CAAEkB,mBAAoB,2NC3H/C,WACA,WACA,UAoCA,SAAgBrzB,EACZ+zB,EACAt0B,GAEA,OAAOn8E,OAAOC,OACV,CAAC,EACDk8E,EASG,CAAEiiB,eAAe,GAMjB,CACHb,aAd8BphB,aAAa,EAAbA,EAAekB,WAWQ,CAAEv+C,UAAW,OAAU,CAAC,EAI7E+L,cAAe,CAAC,EAEhBmwD,WAAY,CACRvxD,OAAQ,GACRyxD,iBAAkB,KAMnB,CACHttF,KAAM,CACFyiB,OAAQ,CAAC,EACTwJ,QAAS,CAAC,GAEdwM,KAAM,CACFhW,OAAQ,CAAC,GAEbqgF,eAAgB,CACZrgF,OAAQ,CAAC,EACThN,QAAS,KAjCbotF,EAER,CAwCA,SAAgBzZ,EACZpnE,GAEA,MAAO,CACH+gF,kBAAmB3wG,OAAOC,OAAM,MAAbD,QAAM,oBACrB,CAAC,EACD,EAAA4wG,sBAAmB,YAChBhhF,EAAQ3qB,KAAI,SAAA0E,GAAK,OAAAA,aAAC,EAADA,EAAGwrF,iBAAH,MAAqB,IAE7CiO,cAAeyN,EACXjhF,EAAQ3qB,KAAI,SAAA0E,GAAK,OAAAA,aAAC,EAADA,EAAGkgG,oBAAH,IACjBj6E,EAAQ3qB,KAAI,SAAA0E,GAAK,OAAAA,aAAC,EAADA,EAAGmgG,uBAAH,KAErB5M,yBAA0B,EAAA0T,oBAC1BE,qBAAoB,uBAE5B,CASA,SAAgBD,EACZnJ,EACAqJ,QADA,IAAArJ,IAAAA,EAAA,SACA,IAAAqJ,IAAAA,EAAA,IAEA,IAAMC,EAAoBhxG,OAAOC,OAAM,MAAbD,QAAM,oBAAQ,CAAC,IAAC,YAAK0nG,IAAS,IAElD7hG,GAAS,IAAAk0B,eAAc,EAAAk3E,8BAA8Bj5D,QACvD,SAACnyC,EAAQuB,SACCxG,GAAQ,IAAAqwG,6BAA6B7pG,GACtCnC,KACG,SAAAisG,GACI,YAAkC3vG,IAAjCyvG,EAAkBE,GACb,EAAAJ,qBAAqBI,GACrBF,EAAkBE,EAFxB,KAIPpuG,OAAM,4CACAiuG,EAAuB9rG,KACtB,SAAAksG,GAAO,MAAI,OAAe,QAAd,EAAAA,aAAO,EAAPA,EAAU/pG,UAAI,QAAI,EAA0B,MAC3D,IAKT,OAFAvB,EAAOuB,GAAOxG,EAEPiF,CACX,GACA,CACI6T,KAAM,KAUd,OANAq3F,EAAuBlsG,SAAQ,SAAAssG,IACvBA,aAAO,EAAPA,EAASz3F,QACT7T,EAAO6T,KAAO7T,EAAO6T,KAAK5W,OAAOquG,EAAQz3F,MAEjD,IAEO7T,CACX,CA9HA,mCACIs2E,OACA,wDAEA,OAAOO,EAAkCsa,EAAuBpnE,GAAUusD,EAC9E,EAOA,sCAoDA,2BAyBA,mICnHA,eACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WAMa,EAAAy0B,oBAA2C,CACpDvlG,EAAG,EAAA+lG,cACHxoG,EAAG,EAAAyoG,sBACH1C,WAAY,EAAA0C,sBACZtrE,GAAI,EAAAurE,YACJjrE,KAAM,EAAAkrE,cACN5hF,IAAK,EAAA0hF,sBACLhC,GAAI,EAAAgC,sBACJp5D,KAAM,EAAAu5D,cACN/xG,EAAG,EAAA4xG,sBACH31C,IAAK,EAAA+1C,eACLjgC,GAAI,EAAAkgC,iBACJjgC,GAAI,EAAAigC,iBACJhgC,GAAI,EAAAggC,iBACJ//B,GAAI,EAAA+/B,iBACJ9/B,GAAI,EAAA8/B,iBACJ7/B,GAAI,EAAA6/B,iBACJjmG,GAAI,EAAAkmG,YACJhC,GAAI,EAAAiC,kBACJ9B,GAAI,EAAA+B,cACJvxG,EAAG,EAAAwxG,WACHlD,IAAK,EAAAmD,yBACL5xG,EAAG,EAAAkxG,sBACHpB,QAAS,EAAAoB,sBACT5qD,KAAM,EAAA4qD,sBACNnB,OAAQ,EAAAmB,sBACRlB,OAAQ,EAAAkB,sBACRjB,IAAK,EAAAiB,sBACLhB,IAAK,EAAAgB,sBACL1wF,MAAO,EAAAy0E,eACPmb,EAAG,EAAAc,sBACHb,GAAI,EAAAqB,cAEJ,IAAK,EAAAG,iBACL,QAAS,EAAAC,cACTr5F,QAAS,EAAAs5F,iBACTtsE,OAAQ,EAAA04D,gBACR9gC,MAAO,EAAA20C,eACPC,UAAW,EAAAC,8HC9Df,eACA,WAcA,6BACIv3F,EACAwtD,EACAld,GAEA,IAAM7iD,GAAQ,IAAA4rE,4BAA2B7L,EAAQh4C,eAOjD,OALAg4C,EAAQld,UAAYA,EACpBkd,EAAQqoC,kBAAkBnzC,MAAMj1D,EAAOuS,EAAMwtD,IAE7C,IAAAK,uBAAsBpgE,GAEfA,CACX,wHC5BA,WACA,WACA,WACA,WAOM+pG,EAAuB,CAAC,IAAK,QAKnC,0BACI5tE,EACA9rB,EACA0vD,EACAz9B,GAEA,IAAMR,EAAYi+B,EAAQooC,eAAertF,QAAUilD,EAAQooC,oBAAiBnvG,EACtEgxG,EAAqBD,EAAqBzhG,QAAQ+H,EAAQyK,UAAY,GAE5E,IAAA8/E,aAAYvqF,EAAS0vD,EAAQ86B,cAAcx+D,MAAO0jC,EAAQi1B,YAAaj1B,GAEvE,IAAMi1B,GAAc,EAAH,eAAQj1B,EAAQi1B,aAUjC,IARA,IAAA4F,aAAYvqF,EAAS0vD,EAAQ86B,cAAc3qE,UAAW8kE,EAAaj1B,GAEnE,EAAAkqC,cAAc3tG,SAAQ,SAAAwpB,GACdkvE,EAAYlvE,KACZi6C,EAAQi1B,YAAYlvE,GAASkvE,EAAYlvE,GAEjD,KAEKkkF,EAAoB,CACrB,IAAM9sE,GAAY,IAAAwjC,kBACd,EACAs0B,EACA1yD,EACAR,IAGJ,IAAA89B,UAASzjC,EAAOe,GAGpB6iC,EAAQqoC,kBAAkBnzC,MAAM94B,EAAO9rB,EAAS0vD,EACpD,sGChDA,eACA,WAMa,EAAAgpC,YAA+C,SAAC5sE,EAAO9rB,EAAS0vD,SACnEviC,GAAK,IAAAmjC,UAASZ,EAAQz9B,eAExBy9B,EAAQ81B,gBACRr4D,EAAGI,YAAa,GAGpB,IAAMV,GAAY,IAAA4oC,YAAW3pC,EAAOqB,EAAIuiC,EAAQi1B,aAC9B,QAAlB,EAAAj1B,EAAQ4U,kBAAU,SAAE6R,UAAUn2E,EAAS6sB,EAAW,CAACM,GACvD,oKChBA,WACA,WACA,WAuCA,SAAgBm4D,EACZx5D,EACA84B,EACA8K,IAEI,IAAAoa,cAAallB,EAAO,iBAA0C,QAAvBA,EAAMnvC,MAAM0Q,QACnDupC,EAAQqoC,kBAAkB/3F,QAAQ8rB,EAAO84B,EAAO8K,IACzC,IAAAoa,cAAallB,EAAO,cAC3B8K,EAAQqoC,kBAAkB,SAASjsE,EAAO84B,EAAO8K,EAEzD,CAWA,SAAgB21B,EACZ/3F,EACAoiE,EACA5jC,EACAo5D,EACAC,EACAtlE,SAEIvyB,GAAS43F,IACTx1B,EAAQ81B,eAAgB,GAExB,IAAAqU,oBAAmB/tE,EAAO4jC,EAAS7vC,EAAWvyB,IAG9CA,GAAS63F,GAA4C,UAAV,QAAjB,EAAAz1B,EAAQld,iBAAS,eAAEn0B,QACxCqxC,EAAQld,UAAUtV,MAAME,YACzB,IAAAy8D,oBAAmB/tE,EAAO4jC,EAAS7vC,EAAWvyB,GAElDoiE,EAAQ81B,eAAgB,EAEhC,CAnEa,EAAA+T,eAA+C,SACxDztE,EACAx2B,EACAo6D,GAKA,IAHM,oBAAmC,IAAAu1B,4BAA2Bv1B,EAASp6D,GAAO,GAA7E4vF,EAAe,KAAEC,EAAa,KACjC73F,EAAQ,EAEHs3D,EAAQtvD,EAAOiX,WAAYq4C,EAAOA,EAAQA,EAAMC,YACrDwgC,EAAuB/3F,EAAOoiE,EAAS5jC,EAAOo5D,EAAiBC,EAAe7vF,GAE9EgwF,EAAiBx5D,EAAO84B,EAAO8K,GAE/BpiE,IAGJ+3F,EAAuB/3F,EAAOoiE,EAAS5jC,EAAOo5D,EAAiBC,EAAe7vF,EAClF,EASA,qBAqBA,iIC9DA,eACA,WACA,WAMa,EAAAqjG,cAA+C,SAAC7sE,EAAO9rB,EAAS0vD,IACzE,IAAAoqC,aAAYpqC,EAAS,CAAEjiC,KAAM,gBAAiB,YAC1C,IAAA88D,aAAYvqF,EAAS0vD,EAAQ86B,cAAc/8D,KAAMiiC,EAAQjiC,KAAKhW,OAAQi4C,IAEtE,IAAA+oC,uBAAsB3sE,EAAO9rB,EAAS0vD,EAC1C,GACJ,6GCdA,eASa,EAAA+pC,mBAA6C,SAAC3tE,EAAO91B,EAAM05D,WAC9DxyB,EAAmC,UAAV,QAAjB,EAAAwyB,EAAQld,iBAAS,eAAEn0B,MAAkBqxC,EAAQld,UAAUtV,MAAQ,KAEzEA,IACIlnC,EAAKuwE,SAASrpC,EAAM4nC,kBACpBpV,EAAQ81B,eAAgB,GAExB,IAAAqU,oBAAmB/tE,EAAO4jC,IAGC,UAAV,QAAjB,EAAAA,EAAQld,iBAAS,eAAEn0B,OAAmBroB,EAAKuwE,SAASrpC,EAAMkpC,gBACrD1W,EAAQld,UAAUtV,MAAME,YACzB,IAAAy8D,oBAAmB/tE,EAAO4jC,GAG9BA,EAAQ81B,eAAgB,GAGpC,2GC3BA,eAaa,EAAA8T,iBAAkD,SAACxtE,EAAO9rB,EAAS0vD,GAC5E,IAAMjlD,EAAUzK,EAAQyK,QAAQ7T,cAC1B4tF,EAQV,SAAkCxkF,EAAsB0vD,GACpD,OAAO,IAAAghB,iBAAgB1wE,IAAuC,SAA3BA,EAAQ+tE,gBACrCre,EAAQqoC,kBAAkB/qE,OAC1B,IACV,CAZuB+sE,CAAyB/5F,EAAS0vD,IAczD,SAAqC1vD,EAAsB0vD,GACvD,OAAO,IAAAgpB,mBAAkB14E,GAAW0vD,EAAQqoC,kBAAkByB,UAAY,IAC9E,CAfQQ,CAA4Bh6F,EAAS0vD,IACrCA,EAAQqoC,kBAAkBttF,IACzBA,EAAQxS,QAAQ,MAAQ,GAAKy3D,EAAQqoC,kBAAkBnzC,OACxD8K,EAAQqoC,kBAAkB,KAC9BvT,EAAU14D,EAAO9rB,EAAS0vD,EAC9B,0GCrBA,eACA,WACA,WACA,WACA,WACA,WASa,EAAAg2B,gBAAiD,SAAC55D,EAAO9rB,EAAS0vD,GAC3E,IAAMuqC,GACF,IAAAroD,gBAAe5xC,IACW,gBAAzBA,EAAQyV,MAAM0Q,SAAoD,QAAvBnmB,EAAQyV,MAAMD,OAE9D,IAAAskF,aACIpqC,EACA,CAAEpgC,QAAS2qE,EAAgB,aAAUtxG,EAAWkkC,UAAW,UAC3D,iBACU4iC,GAAc,IAAAtiB,cAAantC,GAAS,EAAqB0vD,EAAQz9B,eAQvE,IANA,IAAAs4D,aAAYvqF,EAAS0vD,EAAQ86B,cAAcx9D,OAAQyiC,EAAYthC,aAAcuhC,GAEzEA,EAAQ81B,gBACR/1B,EAAYliC,YAAa,GAGzB0sE,GACA,IAAA1qC,UAASzjC,EAAO2jC,OACb,CACH,IAAM5iC,GAAY,IAAA4oC,YAAW3pC,EAAO2jC,GAClB,QAAlB,EAAAC,EAAQ4U,kBAAU,SAAE6R,UAAUn2E,EAAS6sB,EAAW,CAAC4iC,IAE3D,GAER,wGCvCA,eACA,WACA,WAGMyqC,EAAY,CAAC,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,QAmBtD,EAAAtB,cAAmD,SAAC9sE,EAAO9rB,EAAS0vD,IAC7E,IAAAoqC,aACIpqC,EACA,CACIpgC,SAAS,IAAAsiB,gBAAe5xC,GAAW,uBAAyB,iBAEhE,WACI,IAxBS0/B,EACXy6D,EAuBQpiF,EAAa/X,EAAQiE,aAAa,QAClC+T,GAzBG0nB,EAyBoB1/B,EAAQiE,aAAa,QAxBpDk2F,EAAUtmG,SAAS6rC,GAAQ,IAE7BtmC,OAAOnC,MAAMkjG,QACb,EACOA,EAAU,EACVD,EAAU,GACVC,EAAUD,EAAUpzG,OACpBozG,EAAUA,EAAUpzG,OAAS,GAE7BozG,EAAUC,EAAU,IAgBjBliF,EAAYjY,EAAQiE,aAAa,SACjCwT,EAASi4C,EAAQz9B,cAEnBla,IACAN,EAAOM,WAAaA,GAGpBC,IACAP,EAAOO,SAAWA,GAGlBC,IACAR,EAAOQ,UAAYA,IAGvB,IAAAsyE,aAAYvqF,EAAS0vD,EAAQ86B,cAAcl7D,QAASogC,EAAQz9B,cAAey9B,GAE3EA,EAAQqoC,kBAAkBnzC,MAAM94B,EAAO9rB,EAAS0vD,EACpD,GAER,kJCrDA,WACA,WACA,WACA,WACA,WACA,WACA,WAaa,EAAAkqC,cAA0D,CACnE,aACA,cACA,cACA,gBAMS,EAAAT,yBAA0D,SACnErtE,EACA9rB,EACA0vD,IAEA,IAAAoqC,aAAYpqC,EAAS,CAAEpgC,QAAS,uBAAwBzC,UAAW,iBAAkB,YACjF,IAAA09D,aAAYvqF,EAAS0vD,EAAQ86B,cAAcx+D,MAAO0jC,EAAQi1B,YAAaj1B,IACvE,IAAA66B,aAAYvqF,EAAS0vD,EAAQ86B,cAAcC,eAAgB/6B,EAAQz9B,cAAey9B,GAElF,IAAMj4C,GAAM,iBACLi4C,EAAQi1B,cAGf,IAAA4F,aAAYvqF,EAAS0vD,EAAQ86B,cAAc3qE,UAAWpI,EAAQi4C,GAE9D,IAAMjlD,EACkC,UAApC,IAAA2vF,iBAAgBp6F,GAASmmB,QAAqBnmB,EAAQyK,QAAQ7T,cAAgB,MAC5EyjG,GAAkB,IAAAhtC,uBAAsB5iD,EAASgN,GAevD,GAVA,EAAAmiF,cAAc3tG,SAAQ,SAAAwpB,UACXi6C,EAAQi1B,YAAYlvE,EAC/B,IAEAi6C,EAAQqoC,kBAAkBnzC,MAAMy1C,EAAiBr6F,EAAS0vD,GAEtD1vD,EAAQyV,MAAMuC,UAAgD,GAApCnkB,SAASmM,EAAQyV,MAAMuC,YACjDqiF,EAAgBpR,cAAe,GAyB3C,SAAmCoR,GAC/B,IAAM9tF,EAAa8tF,EAAgBtuE,OAAO,GAE1C,MAC+B,OAA3BsuE,EAAgB5vF,SACiB,GAAjC4vF,EAAgBtuE,OAAOjlC,QACC,aAAxBylB,EAAWmgB,WACXngB,EAAWqlB,UAEnB,CA/BY0oE,CAA0BD,GAAkB,CAG5C,IAAMxtE,EAAYwtE,EAAgBtuE,OAAO,GAErCsuE,EAAgBpR,eAChBp8D,EAAUoF,cAAgB7qC,OAAOC,OAAO,CAAC,EAAGwlC,EAAUoF,cAAe,CACjEja,SAAU,OAIlB5wB,OAAOC,OAAOwlC,EAAUpV,OAAQ4iF,EAAgB5iF,SAChD,IAAA63C,yBAAwBziC,IACxB,IAAA0iC,UAASzjC,EAAOe,QAEhB,IAAA0iC,UAASzjC,EAAOuuE,EAExB,KAEA,IAAA9qC,UAASzjC,GAAO,IAAAukC,kBAAgB,EAAqBX,EAAQi1B,aACjE,2GCjFA,eACA,WACA,WACA,UACA,WACA,WACA,WACA,WAGM4V,EAAuD,SAACzuE,EAAO9rB,EAAS0vD,GAC1E,IAAM1jC,GAAQ,IAAAwuE,oBAAmBx6F,GAC3By6F,EAAmB/qC,EAAQ81B,eAEjC,IAAAsU,aACIpqC,EACA,CACIpgC,QAAS,QACTzC,UAAW,QACX73B,KAAM,UAEV,YACI,IAAAu6D,UAASzjC,EAAOE,IAEhB,IAAAu+D,aAAYvqF,EAAS0vD,EAAQ86B,cAAcb,QAAS39D,EAAMvU,OAAQi4C,GAElEA,EAAQqoC,kBAAkBnzC,MAAM54B,EAAOhsB,EAAS0vD,EACpD,IAGA+qC,GAAoB/qC,EAAQ81B,gBAC5Bx5D,EAAMuB,YAAa,EAE3B,EAEMmtE,EAAyD,SAAC5uE,EAAO9rB,EAAS0vD,SACtEpgC,GAAU,IAAAqrE,sBAAqB36F,EAAS0vD,EAAQz9B,eAChDwoE,EAAmB/qC,EAAQ81B,eAEjC,IAAAoV,eAActrE,EAASogC,GACvB,IAAM7iC,GAAY,IAAA4oC,YAAW3pC,EAAOwD,GAClB,QAAlB,EAAAogC,EAAQ4U,kBAAU,SAAE6R,UAAUn2E,EAAS6sB,EAAW,CAACyC,KAEnD,IAAAwqE,aACIpqC,EACA,CACIpgC,QACI,UAER,YACI,IAAAi7D,aAAYvqF,EAAS0vD,EAAQ86B,cAAcb,QAASr6D,EAAQ7X,OAAQi4C,GAEpEA,EAAQqoC,kBAAkBnzC,MAAMt1B,EAAStvB,EAAS0vD,EACtD,IAGA+qC,GAAoB/qC,EAAQ81B,gBAC5Bl2D,EAAQ/B,YAAa,EAE7B,EAKa,EAAA6rE,iBAAkD,SAACttE,EAAO9rB,EAAS0vD,KAC1D,IAAA9d,gBAAe5xC,GAAWu6F,EAAwBG,GAE1D5uE,EAAO9rB,EAAS0vD,EAC9B,2GCpEA,eACA,WACA,WACA,WACA,WACA,WACA,WAMa,EAAAopC,iBAAyD,SAAChtE,EAAO9rB,EAAS0vD,IACnF,IAAAoqC,aACIpqC,EACA,CAAEpgC,QAAS,uBAAwBzC,UAAW,eAAgBirE,eAAgB,UAC9E,WACI,IAAM7lE,EAA2C,CAAC,GAElD,IAAAs4D,aAAYvqF,EAAS0vD,EAAQ86B,cAAcC,eAAgBx4D,EAAey9B,IAK1E,IAAAvuC,eAAc8Q,GAAehmC,SAAQ,SAAAuC,UAC1BkhE,EAAQz9B,cAAczjC,EACjC,IAEAkhE,EAAQooC,gBAAiB,IAAAz+B,0BAAyBr5D,EAAQyK,QAASwnB,IAEnE,IAAA4oE,gBAAe/uE,EAAO9rB,EAAS0vD,EACnC,KAGJ,IAAAH,UAASzjC,GAAO,IAAAukC,kBAAgB,EAAqBX,EAAQi1B,aACjE,sGCnCA,eACA,WACA,WACA,WAMa,EAAAoU,YAA+C,SAACjtE,EAAO9rB,EAAS0vD,IACzE,IAAAoqC,aACIpqC,EACA,CACI7iC,UAAW,iBAEf,YACI,IAAA09D,aAAYvqF,EAAS0vD,EAAQ86B,cAAct9D,QAASwiC,EAAQi1B,YAAaj1B,GAEzE,IAAM78D,GAAK,IAAAioG,eAAc,KAAMprC,EAAQi1B,aAEnC3kF,EAAQ0/B,OACR7sC,EAAG6sC,KAAO1/B,EAAQ0/B,MAGlBgwB,EAAQ81B,gBACR3yF,EAAG06B,YAAa,IAGpB,IAAAgiC,UAASzjC,EAAOj5B,EACpB,GAER,yGC/BA,eACA,WACA,WACA,WACA,WAMa,EAAAgmG,eAAqD,SAAC/sE,EAAO9rB,EAAS0vD,IAC/E,IAAAoqC,aAAYpqC,EAAS,CAAEpgC,QAAS,iBAAkB,qBACxCk5D,EAAuC94B,EAAQz9B,cAG/CjL,EAAiC,QAA3B,EAAAhnB,EAAQiE,aAAa,cAAM,QAAI,IAE3C,IAAAsmF,aAAYvqF,EAAS0vD,EAAQ86B,cAAcl7D,QAASk5D,EAAa94B,IACjE,IAAA66B,aAAYvqF,EAAS0vD,EAAQ86B,cAAc76D,MAAO64D,EAAa94B,IAC/D,IAAA66B,aAAYvqF,EAAS0vD,EAAQ86B,cAAcx+D,MAAO0jC,EAAQi1B,YAAaj1B,GAEvE,IAAM//B,GAAQ,IAAA2rC,aAAYt0C,EAAKwhE,GACzB1+B,EAAM9pD,EAAQ8pD,IACdlpC,EAAQ5gB,EAAQ4gB,OAEtB,IAAA2pE,aAAYvqF,EAAS0vD,EAAQ86B,cAAcvpE,QAAS0O,EAAM1O,QAASyuC,IACnE,IAAAkrC,eAAcjrE,EAAO+/B,GAEjB5F,IACAn6B,EAAMm6B,IAAMA,GAEZlpC,IACA+O,EAAM/O,MAAQA,GAEd8uC,EAAQ81B,gBACR71D,EAAMpC,YAAa,GAEQ,UAAV,QAAjB,EAAAmiC,EAAQld,iBAAS,eAAEn0B,OAAmBqxC,EAAQld,UAAU7iB,OAAS3vB,IACjE2vB,EAAMI,4BAA6B,EACnCJ,EAAMpC,YAAa,GAGvB,IAAMV,GAAY,IAAA4oC,YAAW3pC,EAAO6D,GAClB,QAAlB,EAAA+/B,EAAQ4U,kBAAU,SAAE6R,UAAUn2E,EAAS6sB,EAAW,CAAC8C,GACvD,GACJ,gHC7CA,eACA,WACA,WACA,WACA,WACA,WACA,WACA,WAOMorE,EAA8D,CAChE,eACA,YACA,gBACA,aACA,cACA,eACA,iBACA,oBACA,kBACA,mBACA,QACA,SACA,WACA,YACA,WACA,aAEEC,EAA4B,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,IAAK,KACtEtB,EAAuB,CAAC,IAAK,QAKtB,EAAAjB,sBAAuD,SAAC3sE,EAAO9rB,EAAS0vD,GACjF,IAAMjb,GAAU,IAAA7C,gBAAe5xC,GAE/B,IACKy0C,GAAoC,gBAAzBz0C,EAAQyV,MAAM0Q,UAsDlC,SAAkCnmB,EAAsB0vD,GAEpD,GAAIsrC,EAA0B/iG,QAAQ+H,EAAQyK,UAAY,EACtD,OAAO,EAGX,IAAMgL,EAAQzV,EAAQyV,MAChBwlF,GAAe,IAAAb,iBAAgBp6F,GAE/Bk7F,EAAUzlF,EAAM0lF,iBAAiB,oBAGvC,SAAID,GAAsB,eAAXA,OAOXH,EAA6B/mE,MACzB,SAAAxlC,GAAO,OAAAqF,SAAU4hB,EAAMjnB,IAAoBysG,EAAazsG,IAAmB,IAAM,CAA1E,MAOS,QAApBinB,EAAMgiC,YAA6C,QAArBhiC,EAAM81C,eAKpCvrD,EAAQiE,aAAa,UAK7B,CA1FQm3F,CAAyBp7F,IAEzB,IAAAm5F,0BAAyBrtE,EAAO9rB,EAAS0vD,QACtC,GAAIjb,EAAS,CAChB,IAAMhjB,EAAYi+B,EAAQooC,eAAertF,QAAUilD,EAAQooC,oBAAiBnvG,EACtEgxG,EAAqBD,EAAqBzhG,QAAQ+H,EAAQyK,UAAY,GAE5E,IAAAqvF,aAAYpqC,EAAS,CAAEpgC,QAAS,uBAAwBzC,UAAW,iBAAkB,WACjF,IAAMoF,EAA2C,CAAC,GAElD,IAAAs4D,aAAYvqF,EAAS0vD,EAAQ86B,cAAcC,eAAgBx4D,EAAey9B,GAC1EtoE,OAAOC,OAAOqoE,EAAQz9B,cAAeA,IAErC,IAAA4oE,gBAAe/uE,EAAO9rB,EAAS0vD,EAASz9B,EAC5C,IAEIwiB,IAAYklD,IACZ,IAAApqC,UACIzjC,GACA,IAAAukC,kBACI,EACAX,EAAQi1B,iBACRh8F,EACA8oC,SAKZ,IAAAqoE,aACIpqC,EACA,CACIpgC,QAAS,eACTzC,UAAW,eACX73B,KAAM,gBAEV,YACI,IAAAu1F,aAAYvqF,EAAS0vD,EAAQ86B,cAAcl7D,QAASogC,EAAQz9B,cAAey9B,GAEvEA,EAAQ16D,KAAKyiB,OAAO2M,MAA2B,KAAnBpkB,EAAQyK,UACpC,IAAA8/E,aACIvqF,EACA0vD,EAAQ86B,cAAc6Q,iBACtB3rC,EAAQ16D,KAAKyiB,OACbi4C,GAIRA,EAAQqoC,kBAAkBnzC,MAAM94B,EAAO9rB,EAAS0vD,EACpD,GAGZ,wGC9FA,eACA,WACA,WAMa,EAAA8oC,cAA+C,SAAC1sE,EAAO9rB,EAAS0vD,GACrE1vD,EAAQgE,aAAa,SACrB,IAAA81F,aAAYpqC,EAAS,CAAE16D,KAAM,gBAAiB,YAC1C,IAAAu1F,aAAYvqF,EAAS0vD,EAAQ86B,cAAcx1F,KAAM06D,EAAQ16D,KAAKyiB,OAAQi4C,IACtE,IAAA66B,aAAYvqF,EAAS0vD,EAAQ86B,cAAcvpE,QAASyuC,EAAQ16D,KAAKisB,QAASyuC,IAE1E,IAAA+oC,uBAAsB3sE,EAAO9rB,EAAS0vD,EAC1C,KAGA,IAAA+oC,uBAAsB3sE,EAAO9rB,EAAS0vD,EAE9C,4GCpBA,eACA,WACA,WAMa,EAAAspC,kBAAqD,SAACltE,EAAO9rB,EAAS0vD,SACvE0yB,EAAe1yB,EAAO,WAE9B,GAAI0yB,EAAW0J,YAAc1J,EAAWvxD,OAAO/pC,OAAS,GACpD,IAAAgzG,aACIpqC,EACA,CACIpgC,QAAS,yBAEb,YACI,IAAAi7D,aACIvqF,EACA0vD,EAAQ86B,cAAcC,eACtB/6B,EAAQz9B,cACRy9B,GAGJ,IAAMpjC,GAAW,IAAAknC,gBAAe4uB,EAAWvxD,OAAQ6+B,EAAQz9B,gBAC3D,IAAAs4D,aACIvqF,EACA0vD,EAAQ86B,cAAc8Q,gBACtBhvE,EAAS7U,OACTi4C,GAGJ0yB,EAAW0J,WAAY//D,OAAOpgC,KAAK2gC,IAEnC,IAAAi+D,aACIvqF,EACA0vD,EAAQ86B,cAAc+Q,eACtBjvE,EAASuE,OAAOvE,EAASuE,OAAO/pC,OAAS,GAAG2wB,OAC5Ci4C,GAGJA,EAAQqoC,kBAAkBnzC,MAAMt4B,EAAUtsB,EAAS0vD,GAEnD,IAAMnjD,EAAa+f,EAASP,OAAO,GAGL,GAA1BO,EAASP,OAAOjlC,QACQ,aAAxBylB,EAAWmgB,WACXngB,EAAWqlB,aAEXxqC,OAAOC,OAAOilC,EAAS7U,OAAQlL,EAAWkL,QAC1ClL,EAAWkL,OAAS,CAAC,EAE7B,QAED,CACH,IAAM+jF,EAAqC,QAArB,EAAApZ,EAAW0J,kBAAU,eAAE//D,OACvC0vE,EAAWD,aAAa,EAAbA,GAAgBA,aAAa,EAAbA,EAAe10G,QAAS,GAEzD4oE,EAAQqoC,kBAAkB,KACC,eAAvB0D,aAAQ,EAARA,EAAU/uE,WAA4B+uE,EAAW3vE,EACjD9rB,EACA0vD,GAGZ,wGClEA,cACA,WACA,WAMa,EAAAupC,cAAuE,SAChFntE,EACA9rB,EACA0vD,IAEA,IAAAoqC,aACIpqC,EACA,CACIpgC,QAAS,uBACTzC,UAAW,yBAEf,WACI,IAAMjyB,GAA+B,IAAA8xD,iBACjC1sD,EAAQyK,QACRilD,EAAQi1B,aAEJvC,EAAe1yB,EAAO,YAE9B,IAAA66B,aAAYvqF,EAAS0vD,EAAQ86B,cAAcvpE,QAASrmB,EAAMqmB,QAASyuC,IACnE,IAAA66B,aAAYvqF,EAAS0vD,EAAQ86B,cAAckR,gBAAiB9gG,EAAM6c,OAAQi4C,IAC1E,IAAA66B,aAAYvqF,EAAS0vD,EAAQ86B,cAAcjM,UAAW3jF,EAAM6c,OAAQi4C,IACpE,IAAA66B,aAAYvqF,EAAS0vD,EAAQ86B,cAAcl7D,QAASogC,EAAQz9B,cAAey9B,GAE3E,IAAMisC,EAAqBvZ,EAAW0J,WAEtC1J,EAAW0J,WAAa1J,EAAW0J,YAAchgE,EACjDs2D,EAAWvxD,OAAOllC,KAAKiP,GAEvB,IACI80D,EAAQqoC,kBAAkBnzC,MAAM94B,EAAO9rB,EAAS0vD,WAEhD0yB,EAAWvxD,OAAOh7B,MAClBusF,EAAW0J,WAAa6P,EAEhC,GAER,qGC5CA,eACA,WACA,WACA,WACA,WACA,WAMa,EAAAzC,WAA4C,SAACptE,EAAO9rB,EAAS0vD,IACtE,IAAAoqC,aACIpqC,EACA,CAAEooC,eAAgB,QAASxoE,QAAS,uBAAwBzC,UAAW,iBACvE,WACI6iC,EAAQooC,gBAAiB,IAAAz+B,0BAAyBr5D,EAAQyK,SAE1D,IAAMwnB,EAA2C,CAAC,GAElD,IAAAs4D,aAAYvqF,EAAS0vD,EAAQ86B,cAAcC,eAAgBx4D,EAAey9B,GAC1EtoE,OAAOC,OAAOqoE,EAAQz9B,cAAeA,IAErC,IAAA4oE,gBAAe/uE,EAAO9rB,EAAS0vD,EAASz9B,EAC5C,KAGJ,IAAAs9B,UAASzjC,GAAO,IAAAukC,kBAAgB,EAAqBX,EAAQi1B,aACjE,wHC5BA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WA6QA,SAASiX,EAAUn9B,GAIf,IAHA,IAAMxxE,EAAmB,GACrB4uG,EAAU,EAELh1G,EAAI43E,EAAU33E,OAAS,EAAGD,GAAK,EAAGA,IAGvC,GAAkB,iBAFZqG,EAAMuxE,EAAU53E,IAEM,CACxBg1G,EAAU3uG,EACV,MAIR,IAASrG,EAAI43E,EAAU33E,OAAS,EAAGD,GAAK,EAAGA,IAAK,CAC5C,IAAMqG,OACMvE,KADNuE,EAAMuxE,EAAU53E,IAElBoG,EAAOpG,GAAK,GAEZoG,EAAOpG,GAAKg1G,EAAU3uG,EACtB2uG,EAAU3uG,GAIlB,OAAOD,CACX,CA3Qa,EAAAuvF,eAAqD,SAC9D1wD,EACAyrD,EACA7nB,IAEA,IAAAoqC,aACIpqC,EACA,CAAEpgC,QAAS,uBAAwBzC,UAAW,yBAC9C,oBACI,IAAA09D,aAAYhT,EAAc7nB,EAAQ86B,cAAcx+D,MAAO0jC,EAAQi1B,YAAaj1B,GAE5E,IAAM3nD,GAAQ,IAAAmvD,aAAYqgB,EAAanjD,KAAKttC,OAAQ4oE,EAAQi1B,aACtDmX,EAA4C,UAAV,QAAjB,EAAApsC,EAAQld,iBAAS,eAAEn0B,MAAkBqxC,EAAQld,UAAY,KAE1EupD,GADgBD,aAAc,EAAdA,EAAgB/zF,QACKwvE,EAEvC7nB,EAAQ2U,oBACRt8D,EAAMoa,cAAgBo1D,GAGR,QAAlB,EAAA7nB,EAAQ4U,kBAAU,SAAEgT,QAAQC,EAAcxvE,IAE1C,IAAAwiF,aAAYhT,EAAc7nB,EAAQ86B,cAAcziF,MAAOA,EAAM0P,OAAQi4C,IACrE,IAAA66B,aAAYhT,EAAc7nB,EAAQ86B,cAAcwR,YAAaj0F,EAAM0P,OAAQi4C,IAC3E,IAAA66B,aACIhT,EACA7nB,EAAQ86B,cAAcC,eACtB/6B,EAAQz9B,cACRy9B,IAEJ,IAAA66B,aAAYhT,EAAc7nB,EAAQ86B,cAAcvpE,QAASlZ,EAAMkZ,QAASyuC,IACxE,IAAAH,UAASzjC,EAAO/jB,GAOhB,IALA,IAAMk0F,EAA0C,CAAC,GAC3CC,EA2OlB,SACIn0F,EACA2nD,EACAziE,GAKA,YAHI4uG,EAAU,EACVK,GAAc,EAETt3C,EAAQ78C,EAAMwE,WAAYq4C,EAAOA,EAAQA,EAAMC,YACpD,IAAI,IAAAilB,cAAallB,EAAO,iBAAoC,YAAjBA,EAAMn6C,QAAuB,CACpEyxF,GAAc,EAEd,IAAK,IAAIr4D,EAAM+gB,EAAMr4C,WAAYs3B,EAAKA,EAAMA,EAAIghB,YAC5C,IAAI,IAAAilB,cAAajmC,EAAK,iBAAkC,OAAfA,EAAIp5B,QAAkB,CAC3D,IAAM0xF,EAAwB,CAAC,GAE/B,IAAA5R,aAAY1mD,EAAK6rB,EAAQ86B,cAAc4R,YAAaD,EAAWzsC,GAE/D,IAAK,IAAI7oE,EAAI,EAAGA,EAAIgN,SAAiC,QAAxB,EAAAgwC,EAAI5/B,aAAa,eAAO,QAAI,KAAMpd,IAC3D,QAAwB8B,IAApBwzG,EAAU3mF,MACVvoB,EAAOtB,UAAKhD,OACT,CACH,IAAM6sB,GAAQ,IAAAy2C,oBACK,QAAf,EAAAkwC,EAAU3mF,aAAK,QAAI,QACnB7sB,EACA,MAGJsE,EAAOtB,KAAK6pB,EAAQqmF,GACpBA,GAAWrmF,IAQnC,OAAO0mF,CACX,CAjRgCG,CAAgB9kB,EAAc7nB,EAASusC,GACrDK,EAAyB,CAAC,GAC1BniF,EAAYu1C,EAAQv1C,WAAa,aAE9BsZ,GACL,IAAM4zD,EAAK9P,EAAanjD,KAAKX,GACvB8oE,EAAWx0F,EAAMqsB,KAAKX,GAEtBzrB,EAAQq/E,EAAG/+E,YAGb,IAAAwhE,cAAa9hE,EAAO,mBACnB,IAAAmmE,iBAAgBnmE,EAAO,WACpB,IAAAmmE,iBAAgBnmE,EAAO,WACvB,IAAAmmE,iBAAgBnmE,EAAO,WAE3B,IAAAuiF,aAAYviF,EAAO0nD,EAAQ86B,cAAc+R,SAAUA,EAAS9kF,OAAQi4C,GAC7DA,EAAQ2U,oBACfk4B,EAASp6E,cAAgBklE,IAG7B,IAAAkD,aAAYlD,EAAI33B,EAAQ86B,cAAc+R,SAAUA,EAAS9kF,OAAQi4C,IAEjE,IAAAoqC,aAAYpqC,EAAS,CAAE7iC,UAAW,eAAgByC,QAAS,iBAAkB,WACzE,IAAMh6B,EAAS+xF,EAAGn7F,cACZswG,EAAYlnG,aAAM,EAANA,EAAQmV,SAGtBnV,GACc,SAAbknG,GAAqC,SAAbA,GAAqC,SAAbA,KAGjD,IAAAjS,aACIj1F,EACAo6D,EAAQ86B,cAAcx+D,MACtB0jC,EAAQi1B,YACRj1B,IAEJ,IAAA66B,aACIj1F,EACAo6D,EAAQ86B,cAAcC,eACtB/6B,EAAQz9B,cACRy9B,KAIR,IAAA66B,aAAYlD,EAAI33B,EAAQ86B,cAAcx+D,MAAO0jC,EAAQi1B,YAAaj1B,IAClE,IAAA66B,aACIlD,EACA33B,EAAQ86B,cAAcC,eACtB/6B,EAAQz9B,cACRy9B,GAGJ,qBACQ43B,EAAeC,GAInB,KAAOgV,EAAS1oE,MAAM0zD,GAAYA,KAElC,IAAMlvC,EAAKgvC,EAAGxzD,MAAMyzD,GACdmV,EAAyB/sC,EAAQ81B,cACjCkX,EAASnV,EAAYlvC,EAAGlE,QACxBwoD,EAASlpE,EAAM4kB,EAAGmvC,QAClBoV,OAA4Cj0G,IAA5BszG,EAAgBS,GAChCG,OAA0Cl0G,IAAzB2zG,EAAaK,GAEpC,GAAIC,GAAiBC,EAAgB,CACjC,IAAM9+E,GAAO,IAAAC,uBAAsBq6B,GAEnC,GAAIt6B,EAAKvI,MAAQ,GAAKuI,EAAKvG,OAAS,EAAG,CACnC,GAAIolF,EAAe,CACf,IAAM1vG,EAAM+uG,EAAgB1U,GAE5B0U,EAAgBS,IACG,iBAAPxvG,EAAkBA,EAAM,GAAK6wB,EAAKvI,MAAQ2E,EAGtD0iF,IACAP,EAAaK,GACTL,EAAa7oE,GAAO1V,EAAKvG,OAAS2C,KAKlD,IAAA2/E,aACIpqC,EACA,CAAE7iC,UAAW,eAAgByC,QAAS,iBACtC,YACI,IAAAi7D,aACIlyC,EACAqX,EAAQ86B,cAAcx+D,MACtB0jC,EAAQi1B,YACRj1B,IAEJ,IAAA66B,aACIlyC,EACAqX,EAAQ86B,cAAcsS,mBACtBptC,EAAQz9B,cACRy9B,GAGJ,IAAMqtC,GAAU,iBACTrtC,EAAQi1B,aAET1jE,EAAyB,CAAC,GAEhC,IAAAspE,aACIlyC,EACAqX,EAAQ86B,cAAcwS,UACtBD,EACArtC,IAEJ,IAAA66B,aACIlyC,EACAqX,EAAQ86B,cAAcwR,YACtBe,EACArtC,IAEJ,IAAA66B,aAAYlyC,EAAIqX,EAAQ86B,cAAcvpE,QAASA,EAASyuC,GAExD,IACI,IAAIvb,EAAU,EACdA,GAAWkE,EAAGlE,QACdA,IAAWozC,IAEX,IAAK,IAAIC,EAAU,EAAGA,GAAWnvC,EAAGmvC,QAASA,IAAW,CACpD,IAAMyV,EAAmB,GAAX9oD,GAA2B,GAAXqzC,EACxB/6D,GAAO,IAAA0qC,iBACThjB,EAAU,EACVqzC,EAAU,EACI,MAAdnvC,EAAG5tC,QACHsyF,GAGJtwE,EAAKxL,SAAU,EAAH,eAAQA,GAEpB,IAAMi8E,EAAan1F,EAAMqsB,KAAKX,EAAM+zD,EAAU,GAM9C,GAJI0V,IACAA,EAAWrpE,MAAM0zD,GAAa96D,GAG9BwwE,EAAO,CAGHvtC,EAAQ2U,oBAAsB63B,IAC9BzvE,EAAKtK,cAAgBk2B,GAGnB,MAAyBqX,EAAQ0yB,WAA/B0J,EAAU,aAAEj7D,EAAM,SAE1B6+B,EAAQ0yB,WAAW0J,gBAAanjG,EAChC+mE,EAAQ0yB,WAAWvxD,OAAS,GAE5B,IACI6+B,EAAQqoC,kBAAkBnzC,MAAMn4B,EAAM4rB,EAAIqX,WAE1CA,EAAQ0yB,WAAW0J,WAAaA,EAChCp8B,EAAQ0yB,WAAWvxD,OAASA,GAIpC,IAAMssE,EAAwBztC,EAAQ81B,eAGjCiX,GAA0BU,GAC1BpB,GACGD,GACAroE,GAAOqoE,EAAezlC,UACtB5iC,GAAOqoE,EAAexlC,SACtBixB,GAAauU,EAAer6D,aAC5B8lD,GAAauU,EAAevlC,cAEhC9pC,EAAKc,YAAa,GAIlC,MA5Heg6D,GAAfD,EAAY,EAAGC,EAAY,EAC/BD,EAAYD,EAAGxzD,MAAM/sC,OACrBwgG,MAFIA,EAAeC,GAAAA,EAAY,CA+HvC,IAEA,IAAK,IAAI1jD,EAAM,EAAGA,EAAM04D,EAAS1oE,MAAM/sC,OAAQ+8C,IACtC04D,EAAS1oE,MAAMgQ,KAChB04D,EAAS1oE,MAAMgQ,IAAO,IAAAszB,kBAClB,GACA,GACA,EACAzH,EAAQi1B,eA1LflxD,EAAM,EAAGA,EAAM8jD,EAAanjD,KAAKttC,OAAQ2sC,MAAzCA,GAgMT1rB,EAAMosB,OAASynE,EAAUK,GAEzB,IAAMmB,EAAUxB,EAAUU,GAE1Bv0F,EAAMqsB,KAAKnoC,SAAQ,SAACwnC,EAAK5sC,GACjBu2G,EAAQv2G,GAAK,IACb4sC,EAAIjc,OAAS4lF,EAAQv2G,GAE7B,GACJ,GAER,wGCnRA,eACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WA6BA,SAASw2G,EACLvxE,EACA6qD,EACAjnB,SAEIonB,EAAMH,EAASngC,WAAa,GAC1B8mD,GAAU,IAAArY,4BAA2Bv1B,EAASinB,GAC9C4mB,EAAiBD,EAAQ,GAC3BE,EAAeF,EAAQ,GACrBvrE,EAA6C,GAC7ClF,GAAY,IAAA4wE,iBAAgB3xE,EAAO4jC,EAAQi1B,aAEjD,GAAI4Y,GAAkB,EAAG,CACrB,IAAMG,EAAU5mB,EAAIvpF,UAAU,EAAGgwG,GACjCxrE,EAASpmC,KAAKgyG,EAAe7xE,EAAO4xE,EAAS7wE,EAAW6iC,IACxDA,EAAQ81B,eAAgB,GAExB,IAAAqU,oBAAmB/tE,EAAO4jC,EAASinB,EAAU4mB,GAE7CzmB,EAAMA,EAAIvpF,UAAUgwG,GACpBC,GAAgBD,EAGhBC,GAAgB,IACVE,EAAU5mB,EAAIvpF,UAAU,EAAGiwG,GACjCzrE,EAASpmC,KAAKgyG,EAAe7xE,EAAO4xE,EAAS7wE,EAAW6iC,KAGpDA,EAAQld,WACmB,SAA1Bkd,EAAQld,UAAUn0B,MAAoBqxC,EAAQld,UAAUtV,MAAME,YAE/D,IAAAy8D,oBAAmB/tE,EAAO4jC,EAASinB,EAAU2mB,EAAQ,IAGzD5tC,EAAQ81B,eAAgB,EACxB1O,EAAMA,EAAIvpF,UAAUiwG,IAGxBzrE,EAASpmC,KAAKgyG,EAAe7xE,EAAOgrD,EAAKjqD,EAAW6iC,IAClC,QAAlB,EAAAA,EAAQ4U,kBAAU,SAAE6R,UAChBQ,EACA9pD,EACAkF,EAASka,QAAO,SAACl7C,GAA6B,QAAEA,CAAF,IAEtD,CAEA,SAAS4sG,EACL7xE,EACAhrB,EACA+rB,EACA6iC,SAEIkuC,EAoBJ,OAlBI98F,MAEK,IAAA+8F,eAAc/8F,KACY,QAA1B,EAAA+rB,aAAS,EAATA,EAAWkF,SAASjrC,cAAM,QAAI,GAAK,IACpC,IAAA89F,uBAAsB/3D,aAAS,EAATA,EAAWpV,OAAOqS,eAExC8zE,GAAY,IAAArpC,YAAWzzD,EAAM4uD,EAAQz9B,eAEjCy9B,EAAQ81B,gBACRoY,EAAUrwE,YAAa,IAG3B,IAAAqtE,eAAcgD,EAAWluC,IAEzB,IAAA+F,YAAW3pC,EAAO8xE,EAAWluC,EAAQi1B,cAItCiZ,CACX,CA1Fa,EAAAvE,cAAwC,SACjDvtE,EACA6qD,EACAjnB,GAEIA,EAAQ86B,cAAc1pF,KAAKha,OAAS,GACpC,IAAAgzG,aAAYpqC,EAAS,CAAEpgC,QAAS,iBAAkB,WAC9CogC,EAAQ86B,cAAc1pF,KAAK7U,SAAQ,SAAA4qD,GAC/BA,EAAO6Y,EAAQz9B,cAAe0kD,EAAUjnB,GACxC2tC,EAAsBvxE,EAAO6qD,EAAUjnB,EAC3C,GACJ,IAEA2tC,EAAsBvxE,EAAO6qD,EAAUjnB,EAE/C,4HCnCA,WACA,WACA,WAMA,8BACI5jC,EACA4jC,EACA7vC,EACAk1C,GAEA,IAAM6F,EACFlL,EAAQkL,eACRlL,EAAQkL,cAAciK,eAAiBhlD,GACvC6vC,EAAQkL,cAAcmK,YAAchQ,EAC9BrF,EAAQkL,cAAcnjD,YACtB9uB,EACJspC,GAAgB,EAAH,6CACZy9B,EAAQh4C,eACRg4C,EAAQz9B,eACR2oC,GAEDvoC,GAAS,IAAAk+B,uBAAsBt+B,IAErC,IAAA2oE,eAAcvoE,EAAQq9B,IAEtB,IAAA+F,YAAW3pC,EAAOuG,EAAQq9B,EAAQi1B,YAAa1yD,EACnD,yGC9BA,eAQA,0BAAiE6rE,EAAOC,GACpE,GAAID,GAAMC,EACN,OAAO,EAEP,IAAMC,GAAQ,IAAA78E,eAAc28E,GACtBG,GAAQ,IAAA98E,eAAc48E,GAE5B,OAAOC,EAAMl3G,QAAUm3G,EAAMn3G,QAAUk3G,EAAM9wC,OAAM,SAAA1+D,GAAO,OAAAsvG,EAAGtvG,IAAQuvG,EAAGvvG,EAAd,GAElE,8GCdA,iCAAsCwR,GAClC,OAAOA,EAAQge,uBACnB,0GCLA,eASA,2BAAgChe,GAC5B,IAAM6M,EAAM7M,EAAQyK,QAAQ7T,cAE5B,OAAO,EAAAs/F,oBAAoBrpF,IAAQ,CAAC,CACxC,mHCJA,sCACI6iD,EACAwuC,SAEMhhE,EAAmC,UAAV,QAAjB,EAAAwyB,EAAQld,iBAAS,eAAEn0B,MAAkBqxC,EAAQld,UAAUtV,MAAQ,KAK7E,MAAO,EAHaA,aAAK,EAALA,EAAO4nC,iBAAkBo5B,EAAmBhhE,EAAM8nC,aAAe,GACnE9nC,aAAK,EAALA,EAAOkpC,eAAgB83B,EAAmBhhE,EAAMopC,WAAc,EAGpF,yGCnBA,eAEM63B,EAAuB,CAAC,QAAS,YAAa,QAAS,aAAc,QAO3E,0BAA+Bn+F,GAC3B,IAAMmmB,EAAUnmB,EAAQyV,MAAM0Q,UAAW,IAAAi0E,iBAAgBp6F,GAASmmB,SAAW,GAE7E,OAAOg4E,EAAqBlmG,QAAQkuB,IAAY,CACpD,sGCbA,eAcA,uBACInmB,EACAu4F,EACA9gF,EACAi4C,GAEA,IAAMurC,GAAe,IAAAb,iBAAgBp6F,GAErCu4F,EAAQtsG,SAAQ,SAAA4qD,GACZA,SAAAA,EAASp/B,EAAQzX,EAAS0vD,EAASurC,EACvC,GACJ,qHCzBA,WA6BMmD,EAA+E,CACjF,mBAEEC,EAA2D,CAC7D,aACA,cACA,cACA,gBAiGJ,SAASC,EACL7mF,EACA8mF,GAEA,OAAQA,GACJ,IAAK,QACD,MAAO,CAAC,EAEZ,UAAK51G,EACD,OAAO8uB,EAEX,QACI,IAAM,GAAS,EAAH,eAAQA,GAepB,IAbA,IAAA0J,eAAc1J,GAAQxrB,SAAQ,SAAAuC,IAEN,wBAAf+vG,GACGH,EAAwCnmG,QACpCzJ,IACC,GACO,wBAAf+vG,GACGF,EAAsBpmG,QAAQzJ,IAAyC,WAEpE,EAAOA,EAEtB,IAEmB,gBAAf+vG,GAAgD,wBAAfA,EAAuC,CACxE,IAAM5Z,EAAcltE,EAIhBktE,EAAYh7D,oBACJ,EAAmC60E,oBAC3C7Z,EAAY6Z,qBAAsB,GAI1C,OAAO,EAEnB,CAnIA,uBACI9uC,EACA14C,EACA8G,GAGI,IAuEJrG,EAvEIwa,EAKAy9B,EAAO,cAJPi1B,EAIAj1B,EAAO,YAHD+uC,EAGN/uC,EAAO,KAFDgvC,EAENhvC,EAAO,KADSivC,EAChBjvC,EAAO,eACHpgC,EAAmDtY,EAAO,QAAjD6V,EAA0C7V,EAAO,UAAtChiB,EAA+BgiB,EAAO,KAAhCyW,EAAyBzW,EAAO,KAA1B8gF,EAAmB9gF,EAAO,eAElE,IACI04C,EAAQz9B,cAAgBqsE,EAAoBrsE,EAAe3C,GAC3DogC,EAAQi1B,YAAc2Z,EAAoB3Z,EAAa93D,GACvD6iC,EAAQ16D,KAchB,SACIypG,EACAzpG,GAEA,OAAQA,GACJ,IAAK,cACD,MAAO,CACHyiB,OAAQ,CACJK,WAAW,GAEfmJ,QAAS,CAAC,GAGlB,IAAK,QACD,MAAO,CACHxJ,OAAQ,CAAC,EACTwJ,QAAS,CAAC,GAIlB,QACI,MAAO,CACHA,QAASw9E,EAAWx9E,QACpBxJ,QAAQ,EAAF,eAAOgnF,EAAWhnF,SAGxC,CAxCuBmnF,CAAkBH,EAAYzpG,GAC7C06D,EAAQjiC,KAyChB,SAA2BixE,EAA8BjxE,GACrD,OAAQA,GACJ,IAAK,cACD,MAAO,CACHhW,OAAQ,CACJM,WAAY,cAGxB,IAAK,QACD,MAAO,CACHN,OAAQ,CAAC,GAEjB,QACI,OAAOinF,EAEnB,CAxDuBG,CAAkBH,EAAYjxE,GAC7CiiC,EAAQooC,gBA0DZrgF,EA1DoDknF,EA8D3C,UA9D4D7G,EA+DtD,CACHrgF,OAAQ,CAAC,EACThN,QAAS,IAGNgN,GAlEXqG,YAEA4xC,EAAQz9B,cAAgBA,EACxBy9B,EAAQi1B,YAAcA,EACtBj1B,EAAQ16D,KAAOypG,EACf/uC,EAAQjiC,KAAOixE,EACfhvC,EAAQooC,eAAiB6G,EAEjC,mOCvEA,WACA,WACA,WACA,WAOMG,EAAmB,UACnBC,EAAqB,UACrBC,EAAmB,QACnBC,EAAyB,cAEzBC,EAAmB,wBACnBC,EAAkB,uBAgIxB,SAASC,EAAYr1B,EAAoBn0D,GACrC,OAAOm0D,aAAE,EAAFA,EAAImO,UAAU3R,SAAS3wD,KAnIT,KAmIuBm0D,EAAGz/D,YACxCy/D,OACDphF,CACV,CAEA,SAAS02G,EAAgBt2F,EAAe/I,EAAkBy2E,SAChD5oC,EAAO9kC,EAAIle,cAAc,QAM/B,OAJAgjD,EAAKj4B,UAAY6gE,EAAU0oB,EAAkBD,EAC7CrxD,EAAK5iD,YAAY8d,EAAI7d,eA5IA,MA6IH,QAAlB,EAAA8U,EAAQsI,kBAAU,SAAEkB,aAAaqkC,EAAM4oC,EAAUz2E,EAAQ6kD,YAAc7kD,GAEhE6tC,CACX,CAzIA,2BAAgC73C,GAC5B,OAAO,IAAA8zE,cAAa9zE,EAAM,iBAAmBA,EAAKkiF,UAAU3R,SAASu4B,EACzE,EAOA,gCAAqC58F,GACjC,OAAO,aAAQA,EAAK8mE,iBAAiB,IAAM81B,GAC/C,EAOA,6BAAkC18E,GAC9B,IAAIk9E,GAAW,EACT7nF,EAAmC,CAAC,EAW1C,OATA2K,EAAQ81D,UAAUjsF,SAAQ,SAAAoK,GACtBipG,EAgBR,SACI1pF,EACA6B,GAEA,GAAI7B,GAAakpF,EACb,OAAO,EACyC,GAAzClpF,EAAU3d,QAAQ8mG,GACzBtnF,EAAO8W,WAAa3Y,EAAUroB,UAAUwxG,GACM,GAAvCnpF,EAAU3d,QAAQ+mG,GACzBvnF,EAAO7wB,GAAKgvB,EAAUroB,UAAUyxG,GACoB,GAA7CppF,EAAU3d,QAAQgnG,KACzBxnF,EAAO4W,WAAmE,KAAtDzY,EAAUroB,UAAU0xG,IAEhD,CA7BmBM,CAAqBlpG,EAAMohB,IAAW6nF,CACrD,IAEKA,IACD7nF,EAAOm5D,cAAe,EACtBn5D,EAAO4W,YAAcjM,EAAQgsD,mBAG1B32D,CACX,EA2BA,oCAAyCA,SACrC,OAAOA,EAAOm5D,aACR,GACGkuB,EAAgB,IAAIC,GAAsC,QAAjB,EAAAtnF,EAAO8W,kBAAU,QAAI,IAAE,KAC/D9W,EAAO7wB,GAAK,GAAGo4G,EAAmBvnF,EAAO7wB,GAAE,IAAM,IAClDq4G,GAAyBxnF,EAAO4W,WAAa,IAAM,IAChE,EAOA,6BAAkCruB,GAC9B,OACI,IAAAmuE,iBAAgBnuE,EAAS,UACxBA,EAAQk4E,UAAU3R,SAAS44B,IACxBn/F,EAAQk4E,UAAU3R,SAAS24B,KAnFd,MAoFjBl/F,EAAQsK,WAEhB,EAQA,yBACIvB,EACA/I,EACAyX,EACAi4C,GAEI,IAmBe8vC,EACbvyG,EACEmrF,EAAoBD,EArBxB,gBAoBElrF,EAAsC,GACpCmrF,GAFWonB,EAnBmCx/F,GAqBc,mBAAxCm4E,EAA2BqnB,EAAa,uBACpEvyG,EAAOtB,KACHyzG,EAAYhnB,EAAoB+mB,GAChCC,EAAYjnB,EAAwB+mB,IAGjCjyG,GA3BuD,GAAzDwyG,EAAc,KAAEC,EAAe,KAgBpC,OAdKD,IACDA,EAAiBJ,EAAgBt2F,EAAK/I,GAAS,GAC3C0vD,GAAWj4C,IACX,IAAAkhC,aAAY8mD,EAAgB/vC,EAAQiwC,eAAerwE,QAAS7X,EAAQi4C,IAIvEgwC,IACDA,EAAkBL,EAAgBt2F,EAAK/I,GAAS,GAC5C0vD,GAAWj4C,IACX,IAAAkhC,aAAY+mD,EAAiBhwC,EAAQiwC,eAAerwE,QAAS7X,EAAQi4C,IAItE,CAAC+vC,EAAgBC,EAC5B,sGC9HA,yBACI9nG,GAEA,OAAOxQ,OAAOiN,KAAKuD,EACvB,wGCHA,2BACIoI,EACA6M,SAEA,OAAuB,QAAhB,EAAA7M,aAAO,EAAPA,EAASyK,eAAO,eAAE2yD,sBAAuBvwD,CACpD,qGCuCA,wBACI7W,EACA4pG,GAEA,QAAS5pG,GAAQA,EAAKqM,UAAYK,KAAKk9F,EAC3C,8GCtDA,IAAMC,EAAwB,CAAC,MAAO,WAAY,gBAMlD,iCAAsC/1E,GAClC,QAASA,GAAc+1E,EAAsB5nG,QAAQ6xB,IAAe,CACxE,uHCTA,eAGMg2E,EAAyB,cAS/B,0BACInwG,EACAmuB,EACAiiF,GAEA,IAAMC,EAAiBrwG,EAAMsxB,QAAQ6+E,GACjCloG,EAAgB,KAEpB,IACIA,EAAMO,KAAKu1C,MAAMsyD,GACnB,SAAM,CAgBR,OAdID,KAAe,IAAAE,UAASroG,EAAKmoG,KAC7BnoG,EAAM,MAGNkmB,KACAlmB,EAAMkmB,EAASlmB,IAIHmoG,KAAc,IAAAE,UAASroG,EAAKmoG,KACpCpwG,EAAMsxB,QAAQ6+E,GAA0B3nG,KAAKC,UAAUR,WAFhDjI,EAAMsxB,QAAQ6+E,IAMtBloG,CACX,EAMA,uBAA+BjI,GAC3B,QAASA,EAAMsxB,QAAQ6+E,EAC3B,mGC/CA,eAUA,oBAAgBG,EAAYzsD,EAAY0sD,GACpC,IAmDoBC,EAAYC,EAnD5BnzG,GAAS,EACb,GAAKizG,EAAI9gB,iBAA+B,IAAV5rC,GAA2B0sD,EAAI3gB,WAAuB,OAAV/rC,EACtEvmD,GAAS,MACN,KACDizG,EAAI9gB,iBAA+B,IAAV5rC,IACzB0sD,EAAI3gB,WAAuB,OAAV/rC,EAEnB,OAAO,EAEP,OAAQ0sD,EAAI7hF,MACR,IAAK,SACDpxB,EACqB,iBAAVumD,SACe,IAAd0sD,EAAIl4G,OAAyBwrD,IAAU0sD,EAAIl4G,OACvD,MAEJ,IAAK,SACDiF,EACqB,iBAAVumD,SACe,IAAd0sD,EAAIl4G,QAgCRm4G,EAhCgDD,EAAIl4G,MAgCxCo4G,EAhC+C5sD,EAiCxEtjD,KAAKi5C,IAAIg3D,EAAKC,GAAM,cAhCc,IAAjBF,EAAI7gB,UAA4B7rC,GAAS0sD,EAAI7gB,iBAC5B,IAAjB6gB,EAAI5gB,UAA4B9rC,GAAS0sD,EAAI5gB,UACzD,MAEJ,IAAK,UACDryF,EACqB,kBAAVumD,SACe,IAAd0sD,EAAIl4G,OAAyBwrD,IAAU0sD,EAAIl4G,OACvD,MAEJ,IAAK,QACDiF,EACIU,MAAMC,QAAQ4lD,UACY,IAAlB0sD,EAAIzgB,WAA6BjsC,EAAM1sD,QAAUo5G,EAAIzgB,kBACnC,IAAlBygB,EAAIxgB,WAA6BlsC,EAAM1sD,QAAUo5G,EAAIxgB,YAC7DlsC,EAAM0Z,OAAM,SAAAn8D,GAAK,OAAAkvG,EAASlvG,EAAGmvG,EAAI1gB,QAAhB,IACrB,MAEJ,IAAK,SACDvyF,EACqB,iBAAVumD,IACP,IAAAryB,eAAc++E,EAAIvgB,aAAazyB,OAAM,SAAAn8D,GACjC,OAAAkvG,EAASzsD,EAAMziD,GAAImvG,EAAIvgB,YAAY5uF,GAAnC,KAMpB,OAAO9D,CACX,8BCtDA,SAAgB49E,EAAexmD,EAAcpnB,EAAeojG,GACxD,GAAKh8E,EAAL,CAIA,MAAQg8E,GAAwBh8E,EAAO9X,YACnC8X,EAAOl4B,YAAYk4B,EAAO9X,YAG9B,KAAOtP,aAAM,EAANA,EAAQsP,YACX8X,EAAOp5B,YAAYgS,EAAOsP,YAElC,8FAZA,mBAoBA,6BACIjX,EACAmV,GAEA,IAAM61F,EAAahrG,EAAOoO,cAAc7Y,cAAc4f,GAKtD,OAHAogE,EAAey1B,EAAYhrG,GAC3BA,EAAOrK,YAAYq1G,GAEZA,CACX,0HCpCA,eAWA,8BAAmChrG,EAAc0K,EAAeq0F,SAC5D,GAAIr0F,EAAQsI,YAAchT,EAAQ,CAM9B,IALA,IAAMgqG,GAAW,IAAA5uB,iBAAgB1wE,GAK1Bq0F,GAAWA,GAAWr0F,IAAYs/F,KAAa,IAAA5uB,iBAAgB2jB,KAAW,CAC7E,IAAMC,EAAOD,EAAQxvC,YAEH,QAAlB,EAAAwvC,EAAQ/rF,kBAAU,SAAEnc,YAAYkoG,GAChCA,EAAUC,EAGVD,GAAWA,GAAWr0F,EACtBq0F,EAAUA,EAAQxvC,YAElBvvD,EAAOkU,aAAaxJ,EAASq0F,QAGjC/+F,EAAOkU,aAAaxJ,EAASq0F,GAGjC,OAAOA,CACX,EAKA,sBAA2Br+F,SACjBs+F,EAAOt+F,EAAK6uD,YAGlB,OAFe,QAAf,EAAA7uD,EAAKsS,kBAAU,SAAEnc,YAAY6J,GAEtBs+F,CACX,+ECbA,mBAAgCiM,GAC5B,MAAO,GAAGv2G,MAAMnC,KAAK04G,EACzB,+FC7BA,kBAAuBvqG,GAEnB,IAAMsS,EAAatS,EAAOA,EAAKsS,WAAa,KAE5C,IAAKA,EACD,OAAO,KAGX,KAAOtS,EAAKuW,YACRjE,EAAWkB,aAAaxT,EAAKuW,WAAYvW,GAI7C,OADAsS,EAAWnc,YAAY6J,GAChBsS,CACX,6FCXA,gBACIS,EACA/S,EACAwqG,SAEMp+E,EAAUrZ,EAAIle,cAAc21G,GAIlC,OAHe,QAAf,EAAAxqG,EAAKsS,kBAAU,SAAEkB,aAAa4Y,EAASpsB,GACvCosB,EAAQn3B,YAAY+K,GAEbosB,CACX,+GCZa,EAAAq+E,uBAAyD,CAClE/yD,MAAO,SAACj2B,EAAQzX,EAASqE,EAAG42F,GACxB,IAAM9kF,EAAMnW,EAAQyV,MAAMyQ,WAAalmB,EAAQmW,KAAO8kF,EAAa/0E,UAE/D/P,IACAsB,EAAOyO,UAAmB,OAAP/P,EAAe,MAAQ,MAElD,EACAruB,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAOyO,YACPlmB,EAAQyV,MAAMyQ,UAAYzO,EAAOyO,UAEzC,8GCZS,EAAAw6E,qBAAqD,CAC9DhzD,MAAO,SAACj2B,EAAQzX,GACZ,IAAMmmB,EAAUnmB,EAAQyV,MAAM0Q,QAE1BA,IACA1O,EAAO0O,QAAUA,EAEzB,EACAr+B,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAO0O,UACPnmB,EAAQyV,MAAM0Q,QAAU1O,EAAO0O,QAEvC,kHClBJ,eACA,WAWa,EAAAw6E,uBAET,CACAjzD,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,GAC9B,EAAAwF,uBAAuB/yD,MAAMj2B,EAAQzX,EAAS0vD,EAASurC,GAEvD,IAAM30E,EAAYtmB,EAAQiE,aAAa,SAEnCqiB,IACA7O,EAAO6O,WAAY,IAAAs6E,WAAUt6E,EAAW7O,EAAOyO,kBACxCzO,EAAOiS,iBACPgmC,EAAQi1B,YAAYj7D,UAEnC,EACA5hC,MAAO,SAAC2vB,EAAQzX,GACZ,IAAMmW,EAAyC,OAApBsB,EAAOyO,UAAqB,MAAQ,MAE3DzO,EAAO6O,WACPtmB,EAAQhV,aAAa,QAAS,EAAA2/D,UAAUlzC,EAAO6O,WAAWnQ,GAElE,iHC1BS,EAAA0qF,wBAA2D,CACpEnzD,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,GAC9B,IAAM7zE,EAAapnB,EAAQyV,MAAM2R,YAAc6zE,EAAa7zE,WAExDA,GAA4B,WAAdA,IACd3P,EAAO2P,WAAaA,EAE5B,EACAt/B,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAO2P,aACPpnB,EAAQyV,MAAM2R,WAAa3P,EAAO2P,WAE1C,+GClBJ,eAIM05E,EAAiE,CACnE,YACA,cACA,eACA,cAMS,EAAAC,oBAAmD,CAC5DrzD,MAAO,SAACj2B,EAAQzX,EAASqE,EAAG42F,GACxB6F,EAAW70G,SAAQ,SAAAuC,GACf,IAAMxG,EAAQgY,EAAQyV,MAAMjnB,IAAQysG,EAAazsG,GAEjD,GAAIxG,EACA,OAAQwG,GACJ,IAAK,YACL,IAAK,eACDipB,EAAOjpB,GAAOxG,EACd,MAEJ,IAAK,aACL,IAAK,cACDyvB,EAAOjpB,GAAOipB,EAAOjpB,IACf,IAAAy9D,oBAAmBx0C,EAAOjpB,IAAQ,GAAIwR,IACtC,IAAAisD,oBAAmBjkE,EAAOgY,GAC1B,KACAhY,EAItB,GACJ,EACAF,MAAO,SAAC2vB,EAAQzX,EAAS0vD,GACrBoxC,EAAW70G,SAAQ,SAAAuC,GACf,IAAMxG,EAAQyvB,EAAOjpB,GAEjBxG,GAAS0nE,EAAQsxC,eAAexyG,KAChCwR,EAAQyV,MAAMjnB,GAAOxG,GAAS,IAEtC,GACJ,gHC9CJ,eAIMi5G,EAAmE,CACrE,aACA,eACA,gBACA,eAGEC,EAGD,CACD71C,YAAa,sBAGX81C,EAGD,CACD31C,aAAc,sBAML,EAAA41C,qBAAuE,CAChF1zD,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,GAC9B,EAAAwF,uBAAuB/yD,MAAMj2B,EAAQzX,EAAS0vD,EAASurC,GAEvDgG,EAAYh1G,SAAQ,SAAAuC,WACZxG,EAAQgY,EAAQyV,MAAMjnB,GACpB6yG,GAAqC,OAApB5pF,EAAOyO,UACxBi7E,EACAD,GAAmB1yG,GACnB/B,GAE2D,QAD5D,EAAiB,QAAjB,EAAAwuG,EAAazsG,UAAI,QACb6yG,EAAgBpG,EAAaoG,QAAiB14G,SAAU,QACzD,OAAS,GAEZX,IACDA,EAAQyE,GAGPzE,GAAkB,KAATA,IACVA,EAAQ,OAGRA,GAASA,GAASyE,IAClBgrB,EAAOjpB,GAAOxG,EAEtB,GACJ,EACAF,MAAO,SAAC2vB,EAAQzX,EAAS0vD,GACrBuxC,EAAYh1G,SAAQ,SAAAuC,GAChB,IAAMxG,EAAQyvB,EAAOjpB,GACjB/B,OAAmC9D,EAEhB,MAAnBqX,EAAQyK,SAAsC,MAAnBzK,EAAQyK,UAEV,OAApBgN,EAAOyO,WAA6B,gBAAP13B,GACT,OAApBipB,EAAOyO,WAA6B,eAAP13B,KAE9B/B,EAAe,QAInBzE,GAASA,GAASyE,IAClBuT,EAAQyV,MAAMjnB,GAAOxG,EAE7B,GACJ,kHCzEJ,eACA,WAOa,EAAAs5G,uBAA2E,CACpF5zD,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,SAC9B,EAAAwF,uBAAuB/yD,MAAMj2B,EAAQzX,EAAS0vD,EAASurC,GAEvD,IAAIvxE,EAAY1pB,EAAQyV,MAAMiU,WAAauxE,EAAavxE,UAGjC,MAAnB1pB,EAAQyK,SACiC,UAApB,QAArB,EAAAzK,EAAQ9T,qBAAa,eAAEupB,MAAM0Q,UACiB,WAA9CnmB,EAAQ9T,cAAcupB,MAAM8rF,eAC5BvhG,EAAQyV,MAAM+rF,YAGd93E,EAAY1pB,EAAQyV,MAAM+rF,WAG1B93E,IACAjS,EAAOiS,WAAY,IAAAk3E,WAAUl3E,EAAWjS,EAAOyO,WAEvD,EACAp+B,MAAO,SAAC2vB,EAAQzX,GACZ,IAAMmW,EAAyC,OAApBsB,EAAOyO,UAAqB,MAAQ,MAE/D,GAAIzO,EAAOiS,UAAW,CAClB,IAAM,EAAS1pB,EAAQ9T,cACjBswG,EAAY,aAAM,EAAN,EAAQ/xF,QAEH,MAAnBzK,EAAQyK,UAAmB,GAAwB,MAAb+xF,GAAkC,MAAbA,EAK3Dx8F,EAAQyV,MAAMiU,UAAY,EAAAihC,UAAUlzC,EAAOiS,WAAWvT,IAJtDnW,EAAQyV,MAAM+rF,UAAY/pF,EAAOiS,UACjC1pB,EAAQ9T,cAAcupB,MAAM8rF,cAAgB,SAC5CvhG,EAAQ9T,cAAcupB,MAAM0Q,QAAU,QAKlD,iHCrCS,EAAAs7E,wBAA2D,CACpE/zD,MAAO,SAACj2B,EAAQzX,GACZ,IAAM2pB,EAAa3pB,EAAQyV,MAAMkU,WAE7BA,IACAlS,EAAOkS,WAAaA,EAE5B,EACA7hC,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAOkS,aACP3pB,EAAQyV,MAAMkU,WAAalS,EAAOkS,WAE1C,mHClBJ,eAOa,EAAA+3E,wBAA2D,CACpEh0D,MAAO,SAACj2B,EAAQzX,EAASqE,EAAG42F,GACxB,IAAMnxE,EAAa9pB,EAAQyV,MAAMqU,YAAcmxE,EAAanxE,YAExD,IAAA63E,gBAAe73E,EAAY,SAAUrS,EAAOqS,WAAYmxE,EAAanxE,cACrErS,EAAOqS,WAAaA,EAE5B,EACAhiC,MAAO,SAAC2vB,EAAQzX,EAAS0vD,GACrB,IAAM5lC,EAAa4lC,EAAQsxC,eAAel3E,WACtCrS,EAAOqS,YAAcA,IACrB9pB,EAAQyV,MAAMqU,WAAarS,EAAOqS,YAAc,SAExD,wHCpBJ,eACA,WAOa,EAAA83E,6BAAqE,CAC9El0D,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,GAC9B,IAAM7iF,GACF,IAAA8tE,UACIlmF,GACA,IACE0vD,EAAQv6C,WACVu6C,EAAQwU,mBACP+2B,EAAa7iF,iBAGlB,IAAAupF,gBACIvpF,EACA,mBACAzvB,EACAsyG,EAAa7iF,mBAGjBX,EAAOW,gBAAkBA,EAEjC,EACAtwB,MAAO,SAAC2vB,EAAQzX,EAAS0vD,GACjBj4C,EAAOW,kBACP,IAAAwhC,UACI55C,EACAyX,EAAOW,iBACP,IACEs3C,EAAQv6C,WACVu6C,EAAQwU,iBAGpB,gHCjCS,EAAA29B,uBAAyD,CAClEn0D,MAAO,SAACj2B,EAAQzX,SACoB,eAAf,QAAb,EAAAA,EAAQyV,aAAK,eAAEiN,aACfjL,EAAOmO,cAAe,EAE9B,EACA99B,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAOmO,eACP5lB,EAAQyV,MAAMiN,UAAY,aAElC,0HCVS,EAAA6sE,WAAiE,CAC1E,YACA,cACA,eACA,cAIJ,IAAMuS,EAAiD,CACnD,iBACA,mBACA,oBACA,mBAGEC,EAAuE,CACzE,sBACA,uBACA,yBACA,2BAGEC,EAAU,EAAAzS,WAAWrlG,OAAO63G,GAKrB,EAAAE,oBAAmD,CAC5Dv0D,MAAO,SAACj2B,EAAQzX,EAASqE,EAAG42F,GACxB,EAAA1L,WAAWtjG,SAAQ,SAACuC,EAAK3H,SACfmB,EAAQgY,EAAQyV,MAAMjnB,GACtB0zG,EAA+C,QAAhC,EAAAjH,EAAa6G,EAAgBj7G,WAAG,QAAI,MACrD2uB,EAAQxV,EAAQyV,MAAMqsF,EAAgBj7G,IAE7B,KAAT2uB,IACAA,EAAQ,OAGRxtB,GAASwtB,GAAS0sF,IAClBzqF,EAAOjpB,GAAgB,QAATxG,EAAkB,GAAKA,EAE7C,IAEA,IAAMyoE,EAAezwD,EAAQyV,MAAMg7C,aAE/BA,EACAh5C,EAAOg5C,aAAeA,EAEtBsxC,EAAiB91G,SAAQ,SAAAuC,GACrB,IAAMxG,EAAQgY,EAAQyV,MAAMjnB,GAExBxG,IACAyvB,EAAOjpB,GAAOxG,EAEtB,GAER,EACAF,MAAO,SAAC2vB,EAAQzX,GACZgiG,EAAQ/1G,SAAQ,SAAAuC,GACZ,IAAMxG,EAAQyvB,EAAOjpB,GAEjBxG,IACAgY,EAAQyV,MAAMjnB,GAAOxG,EAE7B,IAEIyvB,EAAOg5C,eACPzwD,EAAQyV,MAAMg7C,aAAeh5C,EAAOg5C,aAE5C,gHCrES,EAAA0xC,uBAAyD,CAClEz0D,MAAO,SAACj2B,EAAQzX,UACK,QAAb,EAAAA,EAAQyV,aAAK,eAAEmmD,aACfnkD,EAAOmkD,UAAY57D,EAAQyV,MAAMmmD,UAEzC,EACA9zE,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAOmkD,YACP57D,EAAQyV,MAAMmmD,UAAYnkD,EAAOmkD,UAEzC,gHChBJ,eAOa,EAAAwmC,qBAAqD,CAC9D10D,MAAO,SAACj2B,EAAQzX,GACZ,IAAMihB,EAAUjhB,EAAQihB,SAExB,IAAAE,eAAcF,GAASh1B,SAAQ,SAAAuC,GAC3BipB,EAAOjpB,GAAOyyB,EAAQzyB,IAAQ,EAClC,GACJ,EAEA1G,MAAO,SAAC2vB,EAAQzX,IACZ,IAAAmhB,eAAc1J,GAAQxrB,SAAQ,SAAAuC,GAC1BwR,EAAQihB,QAAQzyB,GAAOipB,EAAOjpB,EAClC,GACJ,4GCdS,EAAA6zG,mBAAiD,CAC1D30D,MAAO,SAACj2B,EAAQzX,GACZ,IAAMqmB,EAAQrmB,EAAQyV,MAAM4Q,OAASrmB,EAAQiE,aAAa,SAEtDoiB,IACA5O,EAAO4O,MAAQA,EAEvB,EACAv+B,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAO4O,QACPrmB,EAAQyV,MAAM4Q,MAAQ5O,EAAO4O,MAErC,yGCZS,EAAAi8E,gBAA2C,CACpD50D,MAAO,SAACj2B,EAAQzX,GACRA,EAAQpZ,KACR6wB,EAAO7wB,GAAKoZ,EAAQpZ,GAE5B,EACAkB,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAO7wB,KACPoZ,EAAQpZ,GAAK6wB,EAAO7wB,GAE5B,2GCbJ,IAAM27G,EAAkB,WAuDxB,SAASC,EAAaxiG,EAAsBsL,GACxC,IAAMC,EAAYvL,EAAQiE,aAAaqH,GACjCtjB,EAAQ6L,SAAS0X,GAAa,IAEpC,OAAOA,GAAag3F,EAAgBjjG,KAAKiM,GACnCA,EACAnS,OAAOnC,MAAMjP,IAAmB,GAATA,OACvBW,EACAX,EAAQ,IAClB,CA3Da,EAAAy6G,kBAA+C,CACxD/0D,MAAO,SAACj2B,EAAQzX,EAAS0vD,GACrB,IAAMl6C,EAAQxV,EAAQyV,MAAMD,OAASgtF,EAAaxiG,EAAS,SACrDwX,EAASxX,EAAQyV,MAAM+B,QAAUgrF,EAAaxiG,EAAS,UACvDioB,EAAWjoB,EAAQyV,MAAMwS,SACzBC,EAAYloB,EAAQyV,MAAMyS,UAC1BC,EAAWnoB,EAAQyV,MAAM0S,SACzBC,EAAYpoB,EAAQyV,MAAM2S,UAE5B5S,IACAiC,EAAOjC,MAAQA,GAEfgC,IACAC,EAAOD,OAASA,GAEhByQ,IACAxQ,EAAOwQ,SAAWA,GAElBC,IACAzQ,EAAOyQ,UAAYA,GAEnBC,IACA1Q,EAAO0Q,SAAWA,GAElBC,IACA3Q,EAAO2Q,UAAYA,EAE3B,EACAtgC,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAOjC,QACPxV,EAAQyV,MAAMD,MAAQiC,EAAOjC,OAE7BiC,EAAOD,SACPxX,EAAQyV,MAAM+B,OAASC,EAAOD,QAE9BC,EAAOwQ,WACPjoB,EAAQyV,MAAMwS,SAAWxQ,EAAOwQ,UAEhCxQ,EAAOyQ,YACPloB,EAAQyV,MAAMyS,UAAYzQ,EAAOyQ,WAEjCzQ,EAAO0Q,WACPnoB,EAAQyV,MAAM0S,SAAW1Q,EAAO0Q,UAEhC1Q,EAAO2Q,YACPpoB,EAAQyV,MAAM2S,UAAY3Q,EAAO2Q,UAEzC,oHCjDS,EAAAs6E,2BAAiE,CAC1Eh1D,MAAO,SAACj2B,EAAQzX,GAGZ,OAFcA,EAAQyV,MAAMoU,eAAiB7pB,EAAQiE,aAAa,WAG9D,IAAK,WACL,IAAK,UACL,IAAK,QACL,IAAK,MACL,IAAK,WACL,IAAK,cACL,IAAK,MACDwT,EAAOoS,cAAgB,MACvB,MAEJ,IAAK,SACDpS,EAAOoS,cAAgB,SACvB,MAEJ,IAAK,SACDpS,EAAOoS,cAAgB,SAGnC,EACA/hC,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAOoS,gBACP7pB,EAAQyV,MAAMoU,cAAgBpS,EAAOoS,cAE7C,gHC5BS,EAAA84E,uBAAyD,CAClEj1D,MAAO,SAACj2B,EAAQzX,EAASqE,EAAG42F,GACxB,IAAMjxE,EAAYhqB,EAAQyV,MAAMuU,WAAaixE,EAAajxE,UAEtDA,IACAvS,EAAOuS,UAAYA,EAE3B,EACAliC,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAOuS,YACPhqB,EAAQyV,MAAMuU,UAAYvS,EAAOuS,UAEzC,qLClBJ,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WAgBM44E,EAA0C,CAC5CxqF,gBAAiB,EAAAwpF,6BACjBhqF,KAAM,EAAAirF,kBACNpgF,OAAQ,EAAAw/E,oBACRa,UAAW,EAAAjB,uBACXjmC,UAAW,EAAAumC,uBACXlhF,QAAS,EAAAmhF,qBACTl8E,UAAW,EAAAu6E,uBACXt6E,QAAS,EAAAu6E,qBACTr6E,MAAO,EAAAg8E,mBACPtqF,WAAY,EAAAgrF,wBACZ/qF,SAAU,EAAAgrF,sBACVh2E,OAAQ,EAAAi2E,oBACR38E,UAAW,EAAAq6E,uBACX/5G,GAAI,EAAA07G,gBACJzqF,OAAQ,EAAAqrF,oBACR/7E,cAAe,EAAAg8E,2BACf/7E,WAAY,EAAAy5E,wBACZ7rG,KAAM,EAAAouG,kBACN7H,eAAgB,EAAA8H,4BAChB3H,gBAAiB,EAAA4H,6BACjBC,UAAW,EAAAC,uBACX3nC,OAAQ,EAAAklC,oBACRtnE,QAAS,EAAA2nE,qBACT1hE,KAAM,EAAA+iE,kBACNnL,OAAQ,EAAAmM,oBACRC,iBAAkB,EAAAC,8BAClB/6E,YAAa,EAAAg7E,yBACbC,aAAc,EAAAC,0BACdp6E,UAAW,EAAA43E,uBACXrpF,UAAW,EAAA8rF,uBACXC,qBAAsB,EAAAC,kCACtBt6E,WAAY,EAAA83E,wBACZ3pF,UAAW,EAAAosF,uBACXr6E,cAAe,EAAA64E,2BACf54E,WAAY,EAAA43E,wBACZ13E,UAAW,EAAA24E,wBAGTwB,EAA2D,CAC7D,gBACA,aACA,YAGEC,EAA6D,CAC/D,SACA,YACA,mBACA,SACA,QAEEC,EAAqD,CACvD,YACA,YACA,aACA,aACA,cAEEC,EAAyD,CAC3D,kBACA,SACA,UACA,UAMS,EAAAjM,6BAET,CACArsE,MAAOq4E,EACP9I,eAAgB,CAAC,kBACjBG,gBAAiB,CAAC,mBAClBJ,iBAAiB,EAAF,qDACR+I,IAAkB,IACrB,YACA,YACA,aACA,SACA,iBAEJ9lB,UAAW,CAAC,YAAa,YAAa,SAAU,UAAW,YAAa,mBACxEgmB,mBAAmB,EAAF,qDAAMJ,IAAwB,IAAE,YAAa,kBAAmB,eAAY,GAC7FK,oBAAqBJ,EACrB90E,SAAS,EAAF,yEACA60E,IAAwB,gBACxBC,IAA0B,IAC7B,YACA,kBACA,kBAEJ3Z,gBAAgB,EAAF,yEAAM0Z,IAAwB,gBAAKC,IAA0B,IAAE,cAAW,GACxFtH,oBAAoB,EAAF,yEACXqH,IAAwB,gBACxBC,IAA0B,IAC7B,4BAEJpH,UAAW,CACP,SACA,kBACA,UACA,gBACA,YACA,YACA,YACA,QAEJT,SAAU,CAAC,mBACXH,YAAa,CAAC,QACdr0F,MAAO,CACH,KACA,SACA,kBACA,UACA,YACA,SACA,OACA,cACA,aAEJi0F,YAAa,CAAC,YAAa,gBAC3ByI,gBAAiB,CAAC,aAClB90E,MAAO,CACH,KACA,OACA,SACA,UACA,YACA,SACA,YACA,UACA,QACA,iBAEJ36B,KAAM,CACF,OACA,YACA,YACA,UACA,SACA,UACA,kBACA,SACA,OACA,aAEJqmG,iBAAkB,CAAC,aACnB5tE,KAAM,CAAC,aAAc,WACrBxM,QAAS,CAAC,WACViM,SAAS,EAAF,yEAAMm3E,IAAkB,gBAAKC,IAAsB,IAAE,UAAW,OAAQ,cAAW,GAC1FzkF,WAAW,EAAF,qDAAMykF,IAAsB,IAAE,YAAa,OAAQ,YAAS,GACrEt3E,OAAQ,CAAC,UACT28D,QAAS,CAAC,YAAa,oBAMd,EAAAuO,sBAAsC,IAAA/2E,eAAcyhF,GAAyBxjE,QACtF,SAACnyC,EAAQuB,GAEL,OADAvB,EAAOuB,GAAOo0G,EAAwBp0G,GAAKk/C,MACpCzgD,CACX,GACe,CAAC,GAMP,EAAAy3G,uBAAwC,IAAAvjF,eAAcyhF,GAAyBxjE,QACxF,SAACnyC,EAAQuB,GAEL,OADAvB,EAAOuB,GAAOo0G,EAAwBp0G,GAAK1G,MACpCmF,CACX,GACgB,CAAC,+GCpOrB,eAOa,EAAAg2G,oBAAkE,CAC3Ev1D,MAAO,SAACj2B,EAAQzX,GACZ5Y,OAAOC,OAAOowB,GAAQ,IAAAijD,mBAAkB16D,GAC5C,EAEAlY,MAAO,SAAC2vB,EAAQzX,GACPyX,EAAOm5D,eACR5wE,EAAQ4V,WAAY,IAAAk7D,0BAAyBr5D,IAG7CA,EAAO4W,WACPruB,EAAQ+tE,gBAAkB,QAE1B/tE,EAAQ4I,gBAAgB,kBAEhC,uHCtBJ,eACA,WAyCA,SAAS+7F,EAAY3kG,GACjB,OACI,IAAAmuE,iBAAgBnuE,EAAS,QACzB,IAAA8pE,cAAa9pE,EAAQsI,WAAY,kBACjC,IAAA6lE,iBAAgBnuE,EAAQsI,WAAY,KAE5C,CAxCa,EAAA+6F,4BAA+D,CACxE31D,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASk1C,GACtB,IAAAxiB,EAAe1yB,EAAO,WACxBqyB,EAAQK,EAAWvxD,OAAO/pC,OAC1Bq/B,EAAUnmB,EAAQyV,MAAM0Q,SAAWy+E,EAAcz+E,QAEnDA,GAAsB,aAAXA,EACX1O,EAAOotF,oBAAsB1+E,EACtBw+E,EAAY3kG,IAAY+hF,EAAQ,IACvCK,EAAWE,iBAAiBP,EAAQ,KACpCK,EAAWE,iBAAiBtqF,OAAO+pF,GACnCK,EAAWvxD,OAAO5kC,SAAQ,SAAA2O,UAGfA,EAAM6c,OAAOmQ,mBACxB,IAER,EACA9/B,MAAO,SAAC2vB,EAAQzX,EAAS0vD,SACrB,GAAIj4C,EAAOotF,oBACP7kG,EAAQyV,MAAM0Q,QAAU1O,EAAOotF,yBAC5B,GAAIF,EAAY3kG,GAAU,CACrB,IAAAoiF,EAAe1yB,EAAO,WACtB4yB,EAAqBF,EAAU,iBACjC90F,EAAQ80F,EAAWC,UAAUv7F,OAAS,EAExCwG,GAAS,IACTg1F,EAAiBtqF,OAAO1K,EAAQ,GAChCg1F,EAAiBh1F,IAAiC,QAAvB,EAAAg1F,EAAiBh1F,UAAM,QAAI,GAAK,GAGvE,wHCvCJ,eAOa,EAAAg2G,6BAAgE,CACzE51D,MAAO,SAACj2B,EAAQzX,EAAS0vD,GACrB,IAAI,IAAAye,iBAAgBnuE,EAAS,MAAO,CACxB,IAAAoiF,EAAe1yB,EAAO,WACtB4yB,EAA6BF,EAAU,iBACzCL,EAD+BK,EAAU,OAC1Bt7F,OAGkB,iBAA5Bw7F,EAAiBP,IACxB/hF,EAAQpW,OAAS04F,EAAiBP,GAAS,IAE3CtqE,EAAOmQ,oBAAsB5nB,EAAQpW,OAGzC04F,EAAiBP,GAAS/hF,EAAQpW,MAAQ,EAElD,EACA9B,MAAO,SAAC2vB,EAAQzX,EAAS0vD,GAEjB,MACAA,EAAO,WADO4yB,EAAgB,mBAK5BP,EALuC,YAKrBj7F,OAAS,EAEjC,GAAIi7F,GAAS,IAAK,IAAA5T,iBAAgBnuE,EAAS,MAAO,CAC9C,IAAMqkC,EAAc5sB,EAAOmQ,oBAEA,iBAAhByc,EACPi+C,EAAiBP,GAAS19C,EAAc,EACC,iBAA3Bi+C,EAAiBP,KAC/BO,EAAiBP,GAAS,GAG9BO,EAAiBtqF,OAAO+pF,EAAQ,GAChC/hF,EAAQpW,MAAQ04F,EAAiBP,GAAS,EAElD,gHCvCS,EAAAyhB,uBAAyD,CAClE91D,MAAO,SAACj2B,EAAQzX,GACZ,IAAMynB,EAAoBznB,EAAQyV,MAAMgS,kBAClCC,EAAgB1nB,EAAQyV,MAAMiS,cAEhCD,IACAhQ,EAAOgQ,kBAAoBA,GAG3BC,IACAjQ,EAAOiQ,cAAgBA,EAE/B,EACA5/B,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAOgQ,oBACPznB,EAAQyV,MAAMgS,kBAAoBhQ,EAAOgQ,mBAGzChQ,EAAOiQ,gBACP1nB,EAAQyV,MAAMiS,cAAgBjQ,EAAOiQ,cAE7C,6GC3BJ,eACA,WAOa,EAAAm7E,kBAA+C,CACxDn1D,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,GAC9B,IAAMtjF,EAAa3X,EAAQyV,MAAMkC,YAAcsjF,EAAatjF,YAExD,IAAAgqF,gBAAehqF,EAAY,MAAOF,EAAOE,WAAYsjF,EAAatjF,cAClEF,EAAOE,WAAaA,EAE5B,EACA7vB,MAAO,SAAC2vB,EAAQzX,EAAS0vD,GACrB,QAAiC,IAAtBj4C,EAAOE,WAAlB,CAIA,IAAMmtF,EAAkBp1C,EAAQsxC,eAAerpF,YAG1CmtF,GAAmBA,GAAmBrtF,EAAOE,aAC5CmtF,GAAmBrtF,EAAOE,YAAmC,UAArBF,EAAOE,cAExB,QAArBF,EAAOE,YACP,IAAAotF,mBAAkB/kG,EAAS,KAE3BA,EAAQyV,MAAMkC,WAAaF,EAAOE,YAAc,UAG5D,iHC3BS,EAAAorF,wBAA2D,CACpEr1D,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,GAC9B,IAAMljF,EAAa/X,EAAQyV,MAAMsC,YAAckjF,EAAaljF,WAExDA,GAA4B,WAAdA,IACdN,EAAOM,WAAaA,EAE5B,EACAjwB,MAAO,SAAC2vB,EAAQzX,EAAS0vD,GACjBj4C,EAAOM,YAAcN,EAAOM,YAAc23C,EAAQsxC,eAAejpF,aACjE/X,EAAQyV,MAAMsC,WAAaN,EAAOM,WAE1C,iHClBJ,eACA,WAOa,EAAAirF,sBAAuD,CAChEt1D,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,GAC9B,IAAMjjF,EAAWhY,EAAQyV,MAAMuC,UAAYijF,EAAajjF,SAClD6R,EAAgB7pB,EAAQyV,MAAMoU,eAAiBoxE,EAAapxE,cAI9D7R,KAAa,IAAAgtF,oBAAmBhtF,EAAU6R,IAA8B,WAAZ7R,IACxDhY,EAAQyV,MAAMuC,SACdP,EAAOO,SA6BvB,SACIA,EACAitF,EACAv1C,GAEA,IAAMw1C,EAAgBC,EAAentF,GAC/BotF,EAAYptF,EAAS6uC,SAAS,OAEpC,GAAIq+C,EACA,OAAOA,EACJ,KACS,WAAZltF,GACY,UAAZA,GACAA,EAAS6uC,SAAS,OAClB7uC,EAAS6uC,SAAS,MAClBu+C,GAoBG,MAAgB,WAAZptF,GAAqC,UAAZA,GAAoC,SAAZA,OACxD,EAEOA,EArBP,GAAKitF,GAAgBG,EAArB,CAGI,IAAMC,EAAmBD,EACnB11C,EAAQ4iC,cACR,IAAArmC,oBAAmBg5C,GAEzB,GAAII,EACA,OAAQrtF,GACJ,IAAK,UACD,OAAO9nB,KAAK8C,MAA0B,IAAnBqyG,EAA0B,GAAK,IAAM,KAC5D,IAAK,SACD,OAAOn1G,KAAK8C,MAA0B,IAAnBqyG,EAA0B,GAAK,IAAM,KAC5D,QACI,OAAO,IAAAp5C,oBAAmBj0C,EAAUqtF,EAAkB,MAAQ,MAStF,CArEkCC,CACdttF,EACA03C,EAAQz9B,cAAcja,SACtB03C,GAEGurC,EAAajjF,WACpBP,EAAOO,SAAWA,GAG9B,EACAlwB,MAAO,SAAC2vB,EAAQzX,EAAS0vD,GACjBj4C,EAAOO,UAAYP,EAAOO,UAAY03C,EAAQsxC,eAAehpF,WAC7DhY,EAAQyV,MAAMuC,SAAWP,EAAOO,SAExC,GAIJ,IAAMmtF,EAAyC,CAC3C,WAAY,SACZ,UAAW,QACXI,MAAO,SACPC,OAAQ,OACRC,MAAO,SACP,UAAW,OACX,WAAY,OACZ,YAAa,oHC3CjB,eAOa,EAAAvC,oBAAmD,CAC5Dx1D,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,GAC9B,IAAMxpD,EAAYzxC,EAAQyV,MAAMg8B,WAAawpD,EAAaxpD,UAEzC,UAAbA,GAAsC,WAAbA,EACzBh6B,EAAOI,QAAS,EACI,WAAb45B,GAAuC,UAAbA,IACjCh6B,EAAOI,QAAS,EAExB,EACA/vB,MAAO,SAAC2vB,EAAQzX,EAAS0vD,QACQ,IAAlBj4C,EAAOI,UAIK63C,EAAQsxC,eAAenpF,UAEpBJ,EAAOI,SACzBJ,EAAOI,QACP,IAAAktF,mBAAkB/kG,EAAS,KAE3BA,EAAQyV,MAAMg8B,UAAY,SAGtC,sHC/BJ,eAOa,EAAA0xD,2BAAiE,CAC1Ez1D,MAAO,SAACj2B,EAAQzX,EAASqE,EAAG42F,GACxB,IAAM9zE,EAAgBnnB,EAAQyV,MAAM0R,eAAiB8zE,EAAa9zE,eAG9D,IAAAw6E,gBACIx6E,EACA,SACA1P,EAAO0P,cACP8zE,EAAa9zE,iBAGjB1P,EAAO0P,cAAgBA,EAE/B,EACAr/B,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAO0P,gBACPnnB,EAAQyV,MAAM0R,cAAgB1P,EAAO0P,cAE7C,6GC1BJ,eAOa,EAAAi8E,kBAA+C,CACxD11D,MAAO,SAACj2B,EAAQzX,GACZ,IAAI,IAAAmuE,iBAAgBnuE,EAAS,KAAM,CAC/B,IAAM,EAAOA,EAAQ3J,KACf+tB,EAAOpkB,EAAQiE,aAAa,QAC5BogB,EAASrkB,EAAQqkB,OACjBqhF,EAAM1lG,EAAQ0lG,IACd9+G,EAAKoZ,EAAQpZ,GACbgvB,EAAY5V,EAAQ4V,UACpBgL,EAAQ5gB,EAAQ4gB,MAElB,IACAnJ,EAAOphB,KAAO,GAGd+tB,IACA3M,EAAO2M,KAAOA,GAGdC,IACA5M,EAAO4M,OAASA,GAGhBz9B,IACA6wB,EAAO6M,SAAW19B,GAGlB8+G,IACAjuF,EAAOgN,aAAeihF,GAGtB9kF,IACAnJ,EAAO+M,YAAc5D,GAGrBhL,IACA6B,EAAO8M,YAAc3O,GAGjC,EACA9tB,MAAO,SAAC2vB,EAAQzX,IACR,IAAAmuE,iBAAgBnuE,EAAS,MAAQyX,EAAO2M,OACxCpkB,EAAQokB,KAAO3M,EAAO2M,KAElB3M,EAAOphB,OACP2J,EAAQ3J,KAAOohB,EAAOphB,MAGtBohB,EAAO4M,SACPrkB,EAAQqkB,OAAS5M,EAAO4M,QAGxB5M,EAAO6M,WACPtkB,EAAQpZ,GAAK6wB,EAAO6M,UAGpB7M,EAAO8M,cACPvkB,EAAQ4V,UAAY6B,EAAO8M,aAG3B9M,EAAO+M,cACPxkB,EAAQ4gB,MAAQnJ,EAAO+M,aAGvB/M,EAAOgN,eACPzkB,EAAQ0lG,IAAMjuF,EAAOgN,cAGjC,+GC3EJ,eAOa,EAAAg/E,oBAAmD,CAC5D/1D,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,GAC9B,IAAM7D,EAAiBp3F,EAAQyV,MAAM2hF,gBAAkB6D,EAAa7D,gBAEhEA,aAAc,EAAdA,EAAgBn/F,QAAQ,kBAAoB,IAC5Cwf,EAAOgO,eAAgB,EAE/B,EACA39B,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAOgO,gBACP,IAAAs/E,mBAAkB/kG,EAAS,IAEnC,8ICnBJ,eAuCA,SAAgBglG,EACZhtF,EACA6R,GAEA,MAAmB,WAAZ7R,IAA2C,OAAjB6R,GAA2C,SAAjBA,EAC/D,CArCa,EAAA85E,8BAAuE,CAChFj2D,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,GAC9B,IAAMpxE,EAAgB7pB,EAAQyV,MAAMoU,eAAiBoxE,EAAapxE,cAG9Dm7E,EAFahlG,EAAQyV,MAAMuC,UAAYijF,EAAajjF,SAEvB6R,KAC7BpS,EAAOiO,0BAA4BjO,EAAOiO,0BAA4B,IACjEhyB,MAAM,KACNxJ,OAAO2/B,GACP/8B,KAAK,KACLqS,OAEb,EACArX,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAOiO,0BACPjO,EAAOiO,yBACFhyB,MAAM,KACN0vD,UACAn3D,SAAQ,SAAAjE,GACL,IAAMyiB,EAAmB,SAATziB,EAAmB,MAAiB,OAATA,EAAiB,MAAQ,KAEhEyiB,IACA,IAAAs6F,mBAAkB/kG,EAASyK,EAEnC,GAEZ,GAMJ,sICvCA,eAOa,EAAAs5F,uBAAyD,CAClEr2D,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,GAC9B,IAAMhjF,GACF,IAAAiuE,UACIlmF,GACA,IACE0vD,EAAQv6C,WACVu6C,EAAQwU,mBACP+2B,EAAa/nG,MAElB+kB,GAA0B,WAAbA,IACbR,EAAOQ,UAAYA,EAE3B,EACAnwB,MAAO,SAAC2vB,EAAQzX,EAAS0vD,GACrB,IAAMi2C,EAAgBj2C,EAAQsxC,eAAe/oF,UAEzCR,EAAOQ,WAAaR,EAAOQ,WAAa0tF,IACxC,IAAA/rD,UACI55C,EACAyX,EAAOQ,WACP,IACEy3C,EAAQv6C,WACVu6C,EAAQwU,iBAGpB,kHCjCJ,eAOa,EAAAggC,uBAAyD,CAClEx2D,MAAO,SAACj2B,EAAQzX,EAAS0vD,EAASurC,GAC9B,IAAM7D,EAAiBp3F,EAAQyV,MAAM2hF,gBAAkB6D,EAAa7D,gBAEhEA,aAAc,EAAdA,EAAgBn/F,QAAQ,eAAiB,EACzCwf,EAAOK,WAAY,EACO,KAAnB9X,EAAQyK,SAAoC,QAAlB2sF,IACjC3/E,EAAOK,WAAY,EAE3B,EACAhwB,MAAO,SAAC2vB,EAAQzX,EAAS0vD,QACW,IAArBj4C,EAAOK,aAIK43C,EAAQsxC,eAAelpF,aAEpBL,EAAOK,YACzBL,EAAOK,WACP,IAAAitF,mBAAkB/kG,EAAS,KAE3BA,EAAQyV,MAAM2hF,eAAiB,OAG3C,kHCzBS,EAAAwM,yBAA6D,CACtEl2D,MAAO,SAACj2B,EAAQzX,GACZ,IAAM4oB,EAAc5oB,EAAQyV,MAAMmT,YAC9BA,GAA8B,WAAfA,IACfnR,EAAOmR,YAAcA,EAE7B,EACA9gC,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAOmR,cACP5oB,EAAQyV,MAAMmT,YAAcnR,EAAOmR,YAE3C,mHCdJ,IAAMg9E,EAAkB,WAClBC,EAAiB,WAMV,EAAA/B,0BAA0D,CACnEp2D,MAAO,SAACj2B,EAAQzX,IACRA,EAAQyV,MAAM6S,gBAAkBs9E,GAGZ5lG,EAAQiE,aAVpB,kBAQRwT,EAAO6Q,gBAAiB,GAQxBtoB,EAAQyV,MAAM6S,gBAAkBu9E,IAChCpuF,EAAOquF,gBAAiB,EAEhC,EACAh+G,MAAO,SAAC2vB,EAAQzX,GACRyX,EAAO6Q,gBACPtoB,EAAQyV,MAAM6S,eAAiBs9E,EAC/B5lG,EAAQyV,MAAMswF,cAAgB,IAC9B/lG,EAAQyV,MAAMiN,UAAY,cACnBjL,EAAOquF,iBACd9lG,EAAQyV,MAAM6S,eAAiBu9E,EAC/B7lG,EAAQyV,MAAMswF,cAAgB,IAC9B/lG,EAAQyV,MAAMiN,UAAY,aAElC,2HC7BS,EAAAuhF,kCAAoE,CAC7Ev2D,MAAO,SAACj2B,EAAQzX,GACRA,EAAQyV,MAAMviB,cAIPukB,EAAOQ,SAEtB,EACAnwB,MAAO,WAAO,8JCflB,WAMa,EAAAk+G,iBAA6B,CACtC,iBACA,eACA,sBACA,kBACA,gBACA,eACA,iBACA,aACA,kBACA,eACA,cACA,WACA,WACA,OACA,YACA,mBACA,aACA,kBACA,oBACA,eACA,aACA,cACA,UAGJ,IACMC,EAAa,6CACbC,EAAa,sDACbC,EAAY,6EACZC,EAAa,oGACbpR,EAAiB,0DACjBC,EAAkB,OAyFxB,SAAgB1E,EAAWr9F,GAGvB,IAAIM,EACJ,OAAKA,GAHLN,GAASA,GAAS,IAAIiM,QAGH3L,MAAMyyG,IACd,CACHpyG,SAASL,EAAM,GAAKA,EAAM,GAAI,IAC9BK,SAASL,EAAM,GAAKA,EAAM,GAAI,IAC9BK,SAASL,EAAM,GAAKA,EAAM,GAAI,MAE1BA,EAAQN,EAAMM,MAAM0yG,IACrB,CAACryG,SAASL,EAAM,GAAI,IAAKK,SAASL,EAAM,GAAI,IAAKK,SAASL,EAAM,GAAI,MACnEA,EAAQN,EAAMM,MAAM2yG,IAAcjzG,EAAMM,MAAM4yG,IAC/C,CAACvyG,SAASL,EAAM,IAAKK,SAASL,EAAM,IAAKK,SAASL,EAAM,KAIxD,IAEf,CAjGA,oBACIwM,EACAqmG,EACAlxF,EACA+uD,GAEA,IAAIhxE,GACCmzG,EAAermG,EAAQyV,MAAM2C,gBAAkBpY,EAAQyV,MAAMviB,QAC9D8M,EAAQiE,aAAaoiG,EAAe,UAAY,eAChD19G,EAEJ,GAAIuK,GAAS,EAAA8yG,iBAAiB/tG,QAAQ/E,IAAU,EAC5CA,EAAQmzG,OAAe19G,EA7BZ,oBA8BR,GAAIu7E,GAAoBhxE,EAAO,CAClC,IAAMM,EAAQN,EAAMmyC,WAAW4vD,GAAmBD,EAAe5nG,KAAK8F,GAAS,KAE3EM,EACAN,EAAQM,EAAM,IAAM,GACb2hB,IAIPjiB,EA6EZ,SACI4+C,EACAmW,GAEA,IAAMq+C,EAAY/V,EAAWz+C,GAE7B,GAAIw0D,GAAar+C,EAAa,CAC1B,IAAMz5D,GAAM,IAAA2yB,eAAc8mC,GAAahf,MAAK,SAAAz6C,GACxC,IAAM+3G,EAAahW,EAAWtoC,EAAYz5D,GAAKotF,eAE/C,OACI2qB,GACAA,EAAW,IAAMD,EAAU,IAC3BC,EAAW,IAAMD,EAAU,IAC3BC,EAAW,IAAMD,EAAU,EAEnC,IAEA,GAAI93G,EACA,OAAOy5D,EAAYz5D,GAAK2pB,eAIhC,OAAO,IACX,CArGoBquF,CAA4BtzG,EAAOgxE,EAAiBjc,cAAgB,IAIpF,OAAO/0D,CACX,EAUA,oBACI8M,EACA9M,EACAmzG,EACAlxF,EACA+uD,WAEM1wE,EAAQN,GAASA,EAAMmyC,WAAW4vD,GAAmBD,EAAe5nG,KAAK8F,GAAS,KAClF,eAAkCM,QAAAA,EAAS,GAAE,GAAzCizG,GAAF,KAAa,MAAEC,EAAa,KAIpC,GAFAxzG,EAAQwzG,QAAAA,EAAiBxzG,EAErBgxE,GAAoBhxE,EAAO,CAC3B,IAAM1E,EAAMi4G,GAAkBE,eAAoBzzG,EAAM8L,QAAQ,WAAY,KACtE48E,GACiC,QAAnC,EAA4B,QAA5B,EAAA1X,EAAiBjc,mBAAW,eAAGz5D,UAAI,eAAEotF,gBACrC1X,EAAiBprD,aACb5lB,OACAvK,EACA09G,EAAe,aAAe,OAC9BrmG,GAGRkkE,EAAiBwX,iBAAiBvmE,EAAY3mB,EAAK,CAC/C2pB,eAAgBjlB,EAChB0oF,cAAa,IAGjB1oF,EAAQiiB,EAAa,GAAG8/E,EAAkBzmG,EAAG,KAAK0E,EA3EjC,IA2E8DA,EAGnF8M,EAAQ4I,gBAAgBy9F,EAAe,UAAY,SACnDrmG,EAAQyV,MAAM61C,YAAY+6C,EAAe,mBAAqB,QAASnzG,GAAS,KACpF,EAQA,2HC5Ha,EAAAy3D,UAAY,CACrB/gE,MAAO,CACHghE,IAAK,OACLjM,IAAK,SAET9b,OAAQ,CACJ+nB,IAAK,SACLjM,IAAK,UAET90D,IAAK,CACD+gE,IAAK,QACLjM,IAAK,QAETioD,QAAS,CACLh8C,IAAK,UACLjM,IAAK,WAETkM,QAAS,CACLD,IAAK,UACLjM,IAAK,YAOb,qBAA0BkoD,EAAe1wF,GACrC,OAAQ0wF,GACJ,IAAK,SACD,MAAO,SAEX,IAAK,OACD,MAAc,OAAP1wF,EAAe,MAAQ,QAElC,IAAK,QACD,MAAc,OAAPA,EAAe,QAAU,MAEpC,IAAK,QACL,IAAK,MAGL,IAAK,UACL,IAAK,UACD,OAAO0wF,EAEX,QACI,OAEZ,4HCnDMC,EAAmB,4BAyDzB,SAASC,EAAYC,WACjB,QAAoC,IAAzBA,EACP,OAAO,EACJ,GAAoC,iBAAzBA,EACd,OAAOA,EAEP,IAAMC,EAEW,QADb,EAA8C,QAA9C,EAAAD,EAAqBtjG,cAAc45B,mBAAW,eAAEre,iBAAiB+nF,GAC5DhvF,gBAAQ,QAAI,GAIrB,OAFkBkvF,EADAnwG,WAAWkwG,GAKrC,CAEA,SAASC,EAAOrpC,GACZ,OAAO3tE,KAAK8C,MAAY,IAAL6qE,EAAa,GAAK,GACzC,CA9DA,8BACI71E,EACAm/G,EACAC,QAFA,IAAAp/G,IAAAA,EAAA,SAEA,IAAAo/G,IAAAA,EAAA,MAEA,IA2DYvf,EA3DNr0F,EAAQszG,EAAiB15G,KAAKpF,GAChCiF,EAAS,EAEb,GAAIuG,EAAO,CACD,mBAAwBA,EAAK,GAAzB6zG,GAAF,KAAQ,MAAMC,GAAF,KAAM,MACpB7wG,EAAMM,WAAWswG,GAEvB,OAAQC,GACJ,IAAK,KACDr6G,EAASwJ,EACT,MACJ,IAAK,KACDxJ,EAASi6G,EAAOzwG,GAChB,MACJ,IAAK,KACDxJ,EAAS85G,EAAYI,GAA0B1wG,EAC/C,MACJ,IAAK,KACDxJ,EAAU85G,EAAYI,GAA0B1wG,EAAO,EACvD,MACJ,IAAK,IACDxJ,EAAU85G,EAAYI,GAA0B1wG,EAAO,IACvD,MACJ,IAAK,KACDxJ,EAvCK,GAuCIwJ,EACT,MACJ,IAAK,MACDxJ,GAAU85G,EAAYI,IAxCV,IAwC4D1wG,GASpF,OAJIxJ,EAAS,GAAmB,MAAdm6G,IA2BNvf,EA1BQ56F,EAAhBA,EA2BGiD,KAAK8C,MAAY,IAAL60F,EAAa,GAAK,KAxB9B56F,CACX,uGCpDA,0BACIjF,EACAu/G,EACAC,EACA/6G,GAEA,QACMzE,GACO,WAATA,MACGA,GAASu/G,GAAeC,GAAkB/6G,GAAgBzE,GAASyE,EAE9E,s3CCdA,eAAS,mFAAAu3E,iBAAiB,IAC1B,eAAS,mFAAAyE,iBAAiB,IAC1B,eAAS,oFAAAiiB,kBAAkB,IAE3B,eACI,gFAAA6O,cAAc,IACd,wFAAAlU,sBAAsB,IACtB,kFAAAC,gBAAgB,IAEpB,eAAS,iFAAAI,eAAe,IACxB,eAAS,gFAAAlJ,cAAc,IACvB,eAAS,oEAAAjmF,IAAA,oBAAA0uF,0BAA0B,IACnC,eAAS,6EAAAsF,WAAW,IACpB,eAAS,gFAAAj9B,cAAc,IACvB,eAAS,gFAAA1b,cAAc,IAEvB,eAAS,gFAAAmuC,cAAc,IAAE,6EAAA7e,WAAW,IACpC,eAAS,8EAAA4I,YAAY,IACrB,eAAS,iFAAAqE,eAAe,IACxB,eAAS,uDAAA53E,IAAA,oBAAA4qB,aAAa,IACtB,eAAS,yEAAAkpC,OAAO,IAChB,eAAS,gFAAAwgB,cAAc,IAAE,mFAAAk6B,iBAAiB,IAC1C,eAAS,sEAAAx3F,IAAI,IACb,eACI,iFAAAmjE,eAAe,IACf,8DAAAn6E,IAAA,oBAAA+6E,oBAAoB,IACpB,mFAAA5W,iBAAiB,IACjB,0FAAAoW,wBAAwB,IACxB,+EAAA2I,aAAa,IACb,mFAAAf,iBAAiB,IAErB,eAAS,oFAAA8b,kBAAkB,IAC3B,eAAS,uFAAA5P,qBAAqB,IAE9B,eAAS,0EAAAt0B,QAAQ,IACjB,eAAS,gFAAAkD,cAAc,IACvB,eAAS,uFAAAnG,qBAAqB,IAC9B,eAAS,iFAAAgD,eAAe,IACxB,eAAS,uFAAAE,qBAAqB,IAC9B,eAAS,6EAAA2G,WAAW,IACpB,cAAS,iFAAAC,eAAe,IACxB,eAAS,4EAAA5C,UAAU,IACnB,eAAS,6EAAA+G,WAAW,IACpB,eAAS,4FAAAC,0BAA0B,IACnC,eAAS,0FAAAlC,wBAAwB,IACjC,eAAS,sFAAAshC,oBAAoB,IAC7B,cAAS,oFAAAH,kBAAkB,IAC3B,eAAS,8EAAArtD,YAAY,IACrB,eAAS,+EAAA2tD,aAAa,IACtB,cAAS,iFAAApuC,eAAe,IACxB,eAAS,kFAAA0vB,gBAAgB,IAEzB,eAAS,0EAAA7sB,QAAQ,IACjB,eAAS,yEAAAgP,OAAO,IAChB,eAAS,yEAAA9B,OAAO,IAChB,eAAS,oFAAAgrC,kBAAkB,IAE3B,eAAS,uFAAA13C,qBAAqB,IAC9B,eAAS,kFAAA3gC,gBAAgB,IACzB,eAAS,6EAAAg+B,WAAW,IACpB,eAAS,4EAAAqI,UAAU,IACnB,eAAS,yEAAAiyC,OAAO,IAChB,cAAS,wFAAAva,sBAAsB,IAE/B,eAAS,yFAAA79B,uBAAuB,IAEhC,eAAS,oFAAArD,kBAAkB,IAC3B,eAAS,4EAAAsjC,UAAU,IACnB,eAAS,kFAAAyW,gBAAgB,IAAE,kDAAAzvG,IAAA,oBAAA2vF,QAAQ,IAAE,0EAAAtsC,QAAQ,IAAE,4EAAA22C,UAAU,IAEzD,gBACI,0FAAA7sB,uBAAuB,IACvB,oGAAAI,iCAAiC,IACjC,yFAAAsa,sBAAsB,IAE1B,gBACI,0FAAA9V,uBAAuB,IACvB,oGAAAE,iCAAiC,IACjC,yFAAAkW,sBAAsB,kHCxE1B,mCAAwC1yD,GACb,aAAnBA,EAAMU,WAA4BV,EAAM4F,aACxC5F,EAAM4F,YAAa,EAE3B,iGCHA,oBAAyB9F,EAA+BE,GACpDF,EAAMC,OAAOpgC,KAAKqgC,EACtB,2ICCA,SAAgBywC,EAAQntC,EAA8Bt6B,GAC9CA,EAAKyiB,OAAO2M,OACZkL,EAAQt6B,KAAO,CACXyiB,QAAQ,EAAF,eAAOziB,EAAKyiB,QAClBwJ,SAAS,EAAF,eAAOjsB,EAAKisB,UAG/B,CAOA,SAAgBs9C,EAAQjvC,EAA8B7B,GAC9CA,EAAKhW,OAAOM,aACZuX,EAAQ7B,KAAO,CACXhW,QAAQ,EAAF,eAAOgW,EAAKhW,SAG9B,CApBA,YAcA,YAWA,yBAA8B6X,EAA8BogC,GACxD+M,EAAQntC,EAASogC,EAAQ16D,MACzBupE,EAAQjvC,EAASogC,EAAQjiC,KAC7B,qGCtCA,eAgBA,sBACI3B,EACAq+D,EACAxF,EACA1yD,GAEA,IAAMpF,GAAY,IAAA4wE,iBAAgB3xE,EAAO64D,EAAa1yD,GAChD01E,EAAc96E,EAAUkF,SAASlF,EAAUkF,SAASjrC,OAAS,GA0BnE,OAxBI69F,aAAW,EAAXA,EAAah7D,cAGTg7D,EAAY6Z,qBAAoD,GAA7B3xE,EAAUkF,SAASjrC,cAC/C+lC,EAAUpV,OAAOkS,WAExBg7D,EAAY6Z,qBAAsB,SAG/B3xE,EAAUpV,OAAO+mF,qBAGE,mBAA1BrU,EAAW96D,YACNs4E,GAAgBA,EAAYp6E,YAC7BV,EAAUkF,SAASpmC,KAAKw+F,IAGxBA,EAAW58D,YAA0C,oBAA5Bo6E,aAAW,EAAXA,EAAat4E,cACtCxC,EAAUkF,SAASl8B,MAGvBg3B,EAAUkF,SAASpmC,KAAKw+F,IAGrBt9D,CACX,0GClDA,eACA,WAcA,2BACIf,EACA64D,EACA1yD,GAEA,IAAM21E,EAAY97E,EAAMC,OAAOD,EAAMC,OAAOjlC,OAAS,GAErD,GAA4B,cAAxB8gH,aAAS,EAATA,EAAWl7E,WACX,OAAOk7E,EAEP,IAAM/6E,GAAY,IAAAwjC,kBAAgB,EAAMs0B,EAAa1yD,GAGrD,OAFA,IAAAs9B,UAASzjC,EAAOe,GAETA,CAEf,sGC5BA,IAAMg7E,EAAmB,eAOzB,yBAA8B/wB,GAC1B,OAAO+wB,EAAiBvoG,KAAKw3E,EACjC,8BCFA,SAAgBgxB,EAAa97E,GACzB,OAAQA,EAAMU,WACV,IAAK,YACD,OAAgC,GAAzBV,EAAM+F,SAASjrC,OAE1B,IAAK,QACD,OAAOklC,EAAMoI,KAAK84B,OAAM,SAAAz5B,GAAO,OAAoB,GAApBA,EAAII,MAAM/sC,MAAV,IAEnC,IAAK,aACD,OAAOihH,EAAkB/7E,GAK7B,QACI,OAAO,EAEnB,CAKA,SAAgB+7E,EAAkBj8E,GAC9B,OAAQA,EAAMI,gBACV,IAAK,kBAED,MAAwB,OAAjBJ,EAAMrhB,SAA2BqhB,EAAMC,OAAOmhC,MAAM46C,GAE/D,IAAK,WACD,OAAOh8E,EAAMC,OAAOmhC,MAAM46C,GAE9B,IAAK,WACL,IAAK,UACL,IAAK,YACD,OAAO,EAEX,QACI,OAAO,EAEnB,CAKA,SAAgBE,EAAe14E,GAC3B,OAAQA,EAAQD,aACZ,IAAK,OACD,OAAQC,EAAQxuB,KAEpB,IAAK,QACD,OAAQwuB,EAAQtI,IAEpB,QACI,OAAO,EAEnB,uHAvDA,iBAsBA,sBAsBA,mBAiBA,mBACIr3B,GAEA,OAuBJ,SACIA,GAEA,MAAiE,iBAA1BA,EAAOu8B,cAClD,CA3BQ+7E,CAAat4G,GACNo4G,EAAkBp4G,GAgBjC,SACIA,GAEA,MAAuD,iBAArBA,EAAO+8B,SAC7C,CAnBe+nB,CAAQ9kD,GACRm4G,EAAan4G,KAQ5B,SACIA,GAEA,MAA2D,iBAAvBA,EAAO0/B,WAC/C,CAXe64E,CAAUv4G,IACVq4G,EAAer4G,EAI9B,yGCzEA,4BACIm8B,GAEA,MAC4B,WAAxBA,EAAMI,gBAC6C,WAAtBJ,EAAOuD,WAE5C,gHChBA,eACA,WACA,WAYA,iCAAgB0gC,EAAsBjkC,GAClC,IAAK,IAAIjlC,EAAIilC,EAAMC,OAAOjlC,OAAS,EAAGD,GAAK,EAAGA,IAAK,CAC/C,IAAMmlC,EAAQF,EAAMC,OAAOllC,GAE3B,OAAQmlC,EAAMU,WACV,IAAK,aAC2B,YAAxBV,EAAME,gBAAuD,GAAvBF,EAAM6E,OAAO/pC,QACnDD,GAAKmlC,EAAMD,OAAOjlC,QAClB,IAAAsmE,aAAYthC,EAAOE,IAEnB+jC,EAAsB/jC,GAE1B,MACJ,IAAK,aACD,IAAAy7E,oBAAmBz7E,GACnB,MACJ,IAAK,QACD,IAAK,IAAIj8B,EAAI,EAAGA,EAAIi8B,EAAMoI,KAAKttC,OAAQiJ,IACnC,IAAK,IAAIY,EAAI,EAAGA,EAAIq7B,EAAMoI,KAAKrkC,GAAG8jC,MAAM/sC,OAAQ6J,IACxCq7B,EAAMoI,KAAKrkC,GAAG8jC,MAAMljC,IACpBo/D,EAAsB/jC,EAAMoI,KAAKrkC,GAAG8jC,MAAMljC,KAO1D,IAAAm3G,cAAa97E,IACbF,EAAMC,OAAO/zB,OAAOnR,EAAG,GAGnC,6GC7CA,eACA,WACA,WACA,WACA,UAOA,8BAAmCgmC,GAC/B,IAAMkF,EAAWlF,EAAUkF,SAE3B,IAAKlF,EAAU+E,YAAcG,EAASjrC,OAAS,EAAG,CAC9C,IAAMurE,EAAOtgC,EAASA,EAASjrC,OAAS,GAClCqhH,EAAap2E,EAASA,EAASjrC,OAAS,GAE9C,GACwB,mBAApBurE,EAAKhjC,aACH84E,GAAwC,MAA1BA,EAAW94E,aAGxB,GAAI0C,EAASjrC,OAAS,GAAkD,MAA7CirC,EAASA,EAASjrC,OAAS,GAAGuoC,YAAqB,CACjF,IAAM+4E,EAAmBr2E,EAASka,QAAO,SAAAl7C,GAAK,MAAiB,mBAAjBA,EAAEs+B,WAAF,IAK1C+4E,EAAiBthH,OAAS,GACmC,MAA7DshH,EAAiBA,EAAiBthH,OAAS,GAAGuoC,aAE9C0C,EAASl8B,YAVbk8B,EAASpmC,MAAK,IAAA2kE,UAAS+B,EAAK56C,UAe/B,IAAAmtE,uBAAsB/3D,EAAUpV,OAAOqS,cACxC,IAAAu+E,sBAAqBx7E,GAgB7B,SAA0BA,GACtB,IAAMwF,EAASxF,EAAUkF,SAASkX,MAAK,SAAAl4C,GAAK,MAAiB,mBAAjBA,EAAEs+B,WAAF,IAC5C,GAAIgD,EAAQ,CACR,IAAM8nD,EAActtD,EAAUkF,SAAS95B,QAAQo6B,GACzCi2E,EAAOz7E,EAAUkF,SAASooD,EAAc,GACxCma,EAAOznE,EAAUkF,SAASooD,EAAc,IAEzCmuB,IACIA,EAAKtzG,OACN,IAAAs4D,gBAAeg7C,EAAK7wF,OAAQ4a,EAAO5a,WACjC68E,IAAUA,EAAKt/F,OAAQ,IAAAs4D,gBAAegnC,EAAK78E,OAAQ4a,EAAO5a,UAC5D4a,EAAOr9B,OACTszG,GACEj2E,EAAOr9B,MACPs/F,IACCA,EAAKt/F,OACN,IAAAs4D,gBAAegnC,EAAK78E,OAAQ4a,EAAO5a,iBAEhC4a,EAAOr9B,KAG1B,CAlCIuzG,CAAiB17E,GAKrB,SAA6Bb,GACzB,IAAK,IAAI8H,EAAI9H,EAAM+F,SAASjrC,OAAS,EAAGgtC,GAAK,EAAGA,KACxC,IAAAk0E,gBAAeh8E,EAAM+F,SAAS+B,KAC9B9H,EAAM+F,SAAS/5B,OAAO87B,EAAG,EAGrC,CATI00E,CAAoB37E,EACxB,0LC5CA,eAOM47E,EAAQ,IACRC,EAAmB,IACnBC,EAAsB,WACtBC,EAAuB,WAiD7B,SAASC,EACLn5C,GAEA,OAAOtoE,OAAOC,OAAOqoE,QAAAA,EAAW,CAAC,EAAG,CAChCqnB,aAAc,GACd+xB,qBAAqB,EACrBC,sBAAsB,EACtBC,uBAAmBrgH,EACnBgsE,qBAAiBhsE,GAEzB,CAKA,SAAgBsgH,EAAiB35E,EAA8BogC,GAC3D,OAAQpgC,EAAQD,aACZ,IAAK,KACD65E,EAAsBx5C,EAAQqnB,aAAcrnB,EAAQs5C,mBACpDG,EAAyBz5C,EAAQiF,gBAAiBjF,EAAQs5C,mBAG1DH,EAA6Bn5C,GAC7B,MAEJ,IAAK,SACL,IAAK,UACL,IAAK,QAIDA,EAAQs5C,kBAAoB15E,EAC5BogC,EAAQo5C,qBAAsB,EAC9B,MAEJ,IAAK,OACDp5C,EAAQqnB,aAAaprF,KAAK2jC,GAC1BogC,EAAQs5C,kBAAoB15E,EAC5BogC,EAAQiF,gBAAkBrlC,EAE1B,IAAMqkC,EAAQrkC,EAAQxuB,KAAKvT,UAAU,EAAG,GAClC8kE,EAAO/iC,EAAQxuB,KAAK0tC,QAAQ,IAE7B,IAAAqvD,eAAcvuE,EAAQxuB,QACnB6yD,GAAS80C,IAETn5E,EAAQxuB,KAAOwuB,EAAQxuB,KAAK9B,QACxB2pG,EACAj5C,EAAQo5C,oBAAsB,GAAKJ,IAIvCr2C,GAAQo2C,IAERn5E,EAAQxuB,KAAOwuB,EAAQxuB,KAAK9B,QACxB4pG,EACAl5C,EAAQq5C,qBAAuBN,EAAQC,KAKnDh5C,EAAQo5C,oBAAsBz2C,GAAQo2C,EAIlD,CAEA,SAASS,EACLn3E,EACAi3E,GAEAj3E,EAAS9lC,SAAQ,SAAAqjC,GAGb,GAAIA,GAAW05E,EAAmB,CAC9B,IAAMloG,EAAOwuB,EAAQxuB,KAGjBA,EAAK0tC,QAAQ,IAAMk6D,GACnB5nG,EAAKha,OAAS,GACdga,EAAK0tC,QAAQ,EAAG,IAAMi6D,IAEtBn5E,EAAQxuB,KAAOA,EAAKvT,UAAU,EAAGuT,EAAKha,OAAS,GAAK2hH,GAGhE,GACJ,CAEA,SAASU,EACL75E,EACA05E,GAEI15E,GAAWA,GAAW05E,IAAqB15E,aAAO,EAAPA,EAASxuB,KAAK0tC,QAAQ,KAAMi6D,IAEvEn5E,EAAQxuB,KAAOwuB,EAAQxuB,KAAK9B,QAAQ4pG,EAAsB,IAElE,CA5IA,gCAAqC/7E,GACjC,IAAM6iC,EAAUm5C,IAEhBh8E,EAAUkF,SAAS9lC,SAAQ,SAAAqjC,GACvB25E,EAAiB35E,EAASogC,EAC9B,IAEAw5C,EAAsBx5C,EAAQqnB,aAAcrnB,EAAQs5C,mBACpDG,EAAyBz5C,EAAQiF,gBAAiBjF,EAAQs5C,kBAC9D,EAOA,kCACI15E,EACAy5E,QAAA,IAAAA,IAAAA,GAAA,GAEA,IAAMr5C,EAAUm5C,IAEhBn5C,EAAQq5C,qBAAuBA,EAC/BE,EAAiB35E,EAASogC,EAC9B,EAgBA,2CACI,OAAOm5C,GACX,EAiBA,wIC1EA,WAQA,uBACIvzG,EACA8zG,WAEM97G,EAA6C,QAArC,EAAAgI,aAAM,EAANA,EAAQy2B,OAAO9zB,QAAQmxG,UAAc,SAAK,EAEpD97G,GAAS,IACT87G,EAAcr9E,OAAO9/B,QAAQ,EAAAqjE,yBAE7Bh6D,UAAM,EAANA,EAAQy2B,QAAO/zB,OAAM,6BAAC1K,EAAO,IAAC,YAAK87G,EAAcr9E,SAAM,IAE/D,kHCbA,oBAAyBtU,GACrB,MAAO,CACH4X,YAAa,KACb5X,OAAQA,GAAS,EAAD,eAAMA,GAAW,CAAC,EAE1C,mHCFA,sCACIC,GAEA,IAAMzqB,EAA+B,CACjCi/B,eAAgB,WAChBH,OAAQ,IAOZ,OAJIrU,IACAzqB,EAAOwqB,OAASC,GAGbzqB,CACX,uHCfA,yBACIwd,EACAgN,GAEA,MAAO,CACHiV,UAAW,UACXjiB,QAAO,EACPgN,OAAQA,GAAS,EAAD,eAAMA,GAAW,CAAC,EAE1C,2GChBA,eACA,WACA,WACA,WAUA,4BAAiCA,GAC7B,IAAM9nB,GAAQ,IAAA4rE,4BAA2B9jD,GACnCoV,GAAY,IAAAwjC,kBAAgB,OAAsB1nE,EAA2B8uB,GAKnF,OAHAoV,EAAUkF,SAASpmC,MAAK,IAAA4kE,uBAAsB94C,IAAS,IAAA64C,UAAS74C,IAChE9nB,EAAMo8B,OAAOpgC,KAAKkhC,GAEXl9B,CACX,sHCXA,wBACIyyB,EACAiM,EACA4D,EACA5T,EACAz3B,GAEA,YALA,IAAAynC,IAAAA,GAAA,GAKO,CACHgB,YAAa,SACb3C,UAAW,SACXjV,QAAQ,EAAF,eAAOwa,GACb9D,aAAc,CACVvnC,GAAE,EACF2nC,WAAYlQ,EACZgQ,WAAU,GAEdjM,QAAO,EAEf,+HClBA,iCACIvV,EACA4K,GAEA,MAAO,CACHiV,UAAW,aACXR,eAAgB,kBAChBzhB,QAASoC,EACTkf,OAAQ,GACRtU,QAAQ,EAAF,eAAQA,GAAU,CAAC,GAEjC,0GCfA,8BAAmCzX,GAC/B,MAAO,CACH0sB,UAAW,aACXR,eAAgB,UAChBlsB,QAASA,EACT+rB,OAAQ,GACRtU,OAAQ,CAAC,EAEjB,8HCJA,gCACIzX,EACAyX,GAEA,MAAO,CACHiV,UAAW,aACXR,eAAgB,UAChBmD,YAAa,UACb5X,OAAQA,GAAS,EAAD,eAAMA,GAAW,CAAC,EAClCsU,OAAQ,GACR/rB,QAASA,EAEjB,qHCfA,uBAA4BgnB,EAAavP,GACrC,MAAO,CACH4X,YAAa,QACbrI,IAAKA,EACLvP,OAAQA,GAAS,EAAD,eAAMA,GAAW,CAAC,EAClCwJ,QAAS,CAAC,EAElB,yGCdA,cACA,WAYA,0BACI4P,EACApZ,GAEA,MAAO,CACHiV,UAAW,aACXR,eAAgB,WAChBH,OAAQ,GACR8E,OAAQA,EACFA,EAAOxkC,KAAI,SAAAuO,GAAS,WAAA8xD,iBAAgB9xD,EAAMs2B,SAAUt2B,EAAM6c,OAAQ7c,EAAMqmB,QAApD,IACpB,GACN8P,cAAc,IAAAw/B,uBAAsB94C,GACpCA,OAAQ,CAAC,EAEjB,wHCfA,2BACIyZ,EACAzZ,EACAwJ,GAEA,MAAO,CACHiQ,SAAQ,EACRzZ,QAAQ,EAAF,eAAOA,GACbwJ,SAAS,EAAF,eAAOA,GAEtB,yHCRA,2BACI2Q,EACA+yD,EACA1yD,EACAR,GAEA,IAAMxkC,EAAgC,CAClCy/B,UAAW,YACXqF,SAAU,GACVta,OAAQktE,GAAc,EAAD,eAAMA,GAAgB,CAAC,GAkBhD,OAfI1yD,GAAiB7qC,OAAOiN,KAAK49B,GAAenrC,OAAS,IACrDmG,EAAOglC,eAAgB,EAAH,eAAQA,IAG5BL,IACA3kC,EAAO2kC,YAAa,GAGpBH,IACAxkC,EAAOwkC,UAAY,CACfhnB,QAASgnB,EAAUhnB,QACnBgN,QAAQ,EAAF,eAAOga,EAAUha,UAIxBxqB,CACX,kIChCA,oCACIwd,EACAgN,GAEA,MAAO,CACHhN,QAASA,EAAQ2yD,oBACjB3lD,QAAQ,EAAF,eAAQA,GAAU,CAAC,GAEjC,+HCTA,iCACIA,GAEA,MAAO,CACH4X,YAAa,kBACb9B,YAAY,EACZ9V,OAAQA,GAAS,EAAD,eAAMA,GAAW,CAAC,EAE1C,qHCNA,uBAA4B4xF,EAAkB5xF,GAG1C,IAFA,IAAM2c,EAA+B,GAE5BvtC,EAAI,EAAGA,EAAIwiH,EAAUxiH,IAC1ButC,EAAKzoC,KAAK,CACN6rB,OAAQ,EACRC,OAAQ,CAAC,EACToc,MAAO,KAIf,MAAO,CACHnH,UAAW,QACX0H,KAAI,EACJ3c,QAAQ,EAAF,eAAQA,GAAU,CAAC,GACzB0c,OAAQ,GACRlT,QAAS,CAAC,EAElB,wHChBA,2BACIqoF,EACAC,EACA12E,EACApb,EACAwJ,GAEA,IAAM8R,EAC2B,iBAAtBu2E,EAAiCA,EAAoB,IAAMA,EAChEr2E,EAC4B,iBAAvBs2E,EAAkCA,EAAqB,IAAMA,EACxE,MAAO,CACHr9E,eAAgB,YAChBH,OAAQ,GACRtU,OAAQA,GAAS,EAAD,eAAMA,GAAW,CAAC,EAClCsb,SAAQ,EACRE,UAAS,EACTJ,WAAYA,EACZ5R,SAAS,EAAF,eAAOA,GAEtB,oHCjCA,WAeA,sBACIngB,EACA2W,EACAziB,EACAy4B,GAEA,IAAMxgC,EAA2B,CAC7BoiC,YAAa,OACbvuB,KAAMA,EACN2W,OAAQA,GAAS,EAAD,eAAMA,GAAW,CAAC,GAWtC,OARIziB,IACA,IAAAynE,SAAQxvE,EAAQ+H,GAGhBy4B,IACA,IAAA8wC,SAAQtxE,EAAQwgC,GAGbxgC,CACX,4GCpCA,eACA,WAkEA,SAASu8G,EACLt8G,aAEID,EAkBJ,GAhBIC,EAAI8+B,QACC9+B,EAAIoiC,SAEE,IAAAw6C,cAAa58E,EAAIoiC,QAAS,aACjCriC,EAAS,CAAE4yB,UAAW3yB,EAAIoiC,QAASylC,QAA6B,QAArB,EAAA7nE,EAAIoiC,QAAQknB,iBAAS,eAAE1vD,SAAU,GACrEoG,EAAIoiC,QAAQhnB,aACnBrb,EAAS,CACL4yB,UAAW3yB,EAAIoiC,QAAQhnB,WACvBysD,QACI,aAAQ7nE,EAAIoiC,QAAQhnB,WAAWmB,YAAgCxR,QAC3D/K,EAAIoiC,SACJ,IATZriC,EAAS,CAAE4yB,UAAW3yB,EAAI8+B,MAAO+oC,OAAQ,IAc7C9nE,IAAU,IAAA68E,cAAa78E,EAAO4yB,UAAW,0BAA2B,CACpE,IAAMpW,EAAaxc,EAAO4yB,UAAUpW,WAEpC,GAAIA,EAAW3iB,OAASmG,EAAO8nE,OAC3B9nE,EAAS,CAAE4yB,UAAWpW,EAAWxc,EAAO8nE,QAASA,OAAQ,QACtD,GAAI9nE,EAAO4yB,UAAU22D,UAAW,CACnC,IAAM32D,EAAY5yB,EAAO4yB,UAAU22D,UACnCvpF,EAAS,CACL4yB,UAAS,EACTk1C,QAAQ,IAAA+U,cAAajqD,EAAW,aACC,QAA3B,EAAmB,QAAnB,EAAAA,EAAU22B,iBAAS,eAAE1vD,cAAM,QAAI,EAC/B+4B,EAAUpW,WAAW3iB,aAG/BmG,OAAStE,EAIjB,OAAOsE,CACX,CAxFA,6BACI8b,EACA7G,EACAvS,EACA+/D,GAEAA,EAAQ+5C,cAAcC,mBAAmB3gG,EAAK7G,EAAMvS,EAAO+/D,GAE3D,IAAMxyB,EAOV,SAA+Bn0B,EAAe2mD,GAEtC,IAKAi6C,EACAC,EANA,EAGAl6C,EAAO,iBAHa9lE,EAAK,QAAEC,EAAG,MAC9BiyG,EAEApsC,EAAO,eADPm6C,EACAn6C,EAAO,eAKX,GAAIm6C,EACA,OAAOA,EACJ,IACFF,EAAgB//G,GAAS4/G,EAAa5/G,MACtCggH,EAAc//G,GAAO2/G,EAAa3/G,IACrC,CACE,IAAMqzC,EAAQn0B,EAAI2oC,cAKlB,OAHAxU,EAAMs2C,SAASm2B,EAAc9pF,UAAW8pF,EAAc50C,QACtD73B,EAAM87C,OAAO4wB,EAAY/pF,UAAW+pF,EAAY70C,QAEzC,CACH12C,KAAM,QACN6e,MAAK,EACLupC,YAAY,GAEb,OAAIq1B,GAGA,IAEf,CAtCkBgO,CAAsB/gG,EAAK2mD,GAIzC,OAFAxtD,EAAK22E,YAEE37C,CACX,oNChCA,WACA,WACA,UAkCA,SAAgBsrC,EACZqvB,EACAt0B,GAEA,OAAOn8E,OAAOC,OACV,CAAC,EACDk8E,EAQG,CACHwmC,iBAAkB,CACdn0G,QAAS,CACLo2B,MAAO,KACPsD,QAAS,QAOd,CACH8yD,WAAY,CACRE,iBAAkB,GAClBD,UAAW,IAEf2e,eAAgB,CAAC,GArBjBnJ,EAER,CA2BA,SAAgBnZ,EACZ1nE,GAEA,MAAO,CACHyyF,cAAeriH,OAAOC,OAAM,MAAbD,QAAM,oBACjB,CAAC,EACD,EAAA4iH,8BAA2B,YACxBhzF,EAAQ3qB,KAAI,SAAA0E,GAAK,OAAAA,aAAC,EAADA,EAAGk5G,oBAAH,MAAwB,IAEhDtK,eAAgBuK,EACZlzF,EAAQ3qB,KAAI,SAAA0E,GAAK,OAAAA,aAAC,EAADA,EAAGo5G,qBAAH,IACjBnzF,EAAQ3qB,KAAI,SAAA0E,GAAK,OAAAA,aAAC,EAADA,EAAGq5G,wBAAH,KAErBC,qBAAsB,EAAAL,4BACtBtF,sBAAqB,wBACrBrmB,iBAAkBj3F,OAAOC,OAAM,MAAbD,QAAM,oBAAQ,CAAC,IAAC,YAAK4vB,EAAQ3qB,KAAI,SAAA0E,GAAK,OAAAA,aAAC,EAADA,EAAGstF,gBAAH,MAAoB,IAEpF,CAMA,SAAgB6rB,EACZpb,EACAwb,QADA,IAAAxb,IAAAA,EAAA,SACA,IAAAwb,IAAAA,EAAA,IAEA,IAAMlS,EAAoBhxG,OAAOC,OAAM,MAAbD,QAAM,oBAAQ,CAAC,IAAC,YAAK0nG,IAAS,IAElD7hG,GAAS,IAAAk0B,eAAc,EAAAk3E,8BAA8Bj5D,QACvD,SAACnyC,EAAQuB,SACCxG,GAAQ,IAAAqwG,6BAA6B7pG,GACtCnC,KACG,SAAAisG,GACI,YAAkC3vG,IAAjCyvG,EAAkBE,GACb,EAAAoM,sBAAsBpM,GACtBF,EAAkBE,EAFxB,KAIPpuG,OAAM,4CACAogH,EAAwBj+G,KACvB,SAAAk+G,GAAQ,MAAI,OAAgB,QAAf,EAAAA,aAAQ,EAARA,EAAW/7G,UAAI,QAAI,EAA2B,MAC9D,IAKT,OAFAvB,EAAOuB,GAAOxG,EAEPiF,CACX,GACA,CACI6T,KAAM,KAUd,OANAwpG,EAAwBr+G,SAAQ,SAAAs+G,IACxBA,aAAQ,EAARA,EAAUzpG,QACV7T,EAAO6T,KAAO7T,EAAO6T,KAAK5W,OAAOqgH,EAASzpG,MAElD,IAEO7T,CACX,CA9GA,mCACIs2E,OACA,wDAEA,OAAOiF,EAAkCkW,EAAuB1nE,GAAUusD,EAC9E,EAOA,sCAsCA,2BAuBA,4ICjGA,eACA,UACA,WACA,WACA,SACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WAMa,EAAAymC,4BAAsD,CAC/Dh+E,MAAO,EAAAw+E,YACPd,mBAAoB,EAAAe,yBACpBt9E,GAAI,EAAAu9E,SACJC,YAAa,EAAAC,kBACbC,cAAe,EAAAC,oBACfC,aAAc,EAAAC,mBACdC,eAAgB,EAAAC,qBAChBh+E,QAAS,EAAAi+E,cACTx7E,MAAO,EAAAy7E,YACP/uG,KAAM,EAAAgvG,WACN/+E,SAAU,EAAAg/E,eACVz+E,UAAW,EAAA0+E,gBACXlR,gBAAiB,EAAAmR,sBACjBl8E,QAAS,EAAAm8E,cACTC,iBAAkB,EAAAC,uBAClB5jG,MAAO,EAAA6jG,YACP9qG,KAAM,EAAA+qG,8GC5BG,EAAArB,YAA2D,SACpEzhG,EACAzT,EACA02B,EACA0jC,EACA2kC,GAEA,IAAMyX,EAAWp8C,EAAQ+5C,cAEzB,OAAQz9E,EAAMU,WACV,IAAK,QACD2nE,EAAUyX,EAAS/jG,MAAMgB,EAAKzT,EAAQ02B,EAAO0jC,EAAS2kC,GACtD,MACJ,IAAK,YACDA,EAAUyX,EAASj/E,UAAU9jB,EAAKzT,EAAQ02B,EAAO0jC,EAAS2kC,GAC1D,MACJ,IAAK,SACDA,EAAUyX,EAASnB,YAAY5hG,EAAKzT,EAAQ02B,EAAO0jC,EAAS2kC,GAC5D,MACJ,IAAK,UACDA,EAAUyX,EAAS5+E,QAAQnkB,EAAKzT,EAAQ02B,EAAO0jC,EAAS2kC,GACxD,MACJ,IAAK,aACD,OAAQroE,EAAME,gBACV,IAAK,UACDmoE,EAAUyX,EAASf,aAAahiG,EAAKzT,EAAQ02B,EAAO0jC,EAAS2kC,GAC7D,MAEJ,IAAK,kBACDA,EAAUyX,EAASzR,gBAAgBtxF,EAAKzT,EAAQ02B,EAAO0jC,EAAS2kC,GAChE,MAEJ,IAAK,WACDA,EAAUyX,EAASx/E,SAASvjB,EAAKzT,EAAQ02B,EAAO0jC,EAAS2kC,IAOzE,OAAOA,CACX,gHCzCa,EAAAoW,yBAAwE,SACjF1hG,EACAzT,EACAw2B,EACA4jC,SAEQ0yB,EAAe1yB,EAAO,WACxB2yB,EAAYD,EAAWC,UACzBgS,EAAuB/+F,EAAOiX,WAElC,IAkBI,IAjBAuf,EAAMC,OAAO9/B,SAAQ,SAAC8/G,EAAYz+G,GAMjB,GAATA,GACwB,cAAxBy+G,EAAWr/E,WACkB,YAA7Bq/E,EAAW7/E,iBAEXk2D,EAAWC,UAAY,IAG3BgS,EAAU3kC,EAAQ+5C,cAAcz9E,MAAMjjB,EAAKzT,EAAQy2G,EAAYr8C,EAAS2kC,EAC5E,IAGOA,GAAS,CACZ,IAAMC,EAAOD,EAAQxvC,YAEH,QAAlB,EAAAwvC,EAAQ/rF,kBAAU,SAAEnc,YAAYkoG,GAChCA,EAAUC,WAGdlS,EAAWC,UAAYA,EAE/B,mGC9CA,eAMa,EAAAqoB,SAAuD,SAChE3hG,EACAzT,EACAg6B,EACAogC,EACAs8C,GAEA,IAAM7+E,EAAKpkB,EAAIle,cAAc,MACvBmV,EAAU+I,EAAIle,cAAc,QAClCmV,EAAQ/U,YAAYkiC,GACpB73B,EAAOrK,YAAY+U,IAEnB,IAAAisG,qBAAoBljG,EAAKokB,EAAIntB,EAASsvB,EAASogC,EAASs8C,EAC5D,wGCnBA,eACA,WAUa,EAAAb,cAA+D,SACxEpiG,EACAzT,EACA43B,EACAwiC,EACA2kC,SAEIr0F,EAAU0vD,EAAQ2U,kBAAoBn3C,EAAQ/K,mBAAgBx5B,EAsBlE,OApBIqX,EACAq0F,GAAU,IAAAG,oBAAmBl/F,EAAQ0K,EAASq0F,IAE9Cr0F,EAAU+I,EAAIle,cAAcqiC,EAAQziB,SAEhCilD,EAAQ2U,oBACRn3C,EAAQ/K,cAAgBniB,GAG5B1K,EAAOkU,aAAaxJ,EAASq0F,IAE7B,IAAA17C,aAAY34C,EAAS0vD,EAAQiwC,eAAezyE,QAASA,EAAQzV,OAAQi4C,GAEjExiC,EAAQwS,MACR1/B,EAAQhV,aAAa,OAAQkiC,EAAQwS,OAIxB,QAArB,EAAAgwB,EAAQkN,qBAAa,cAArBlN,EAAwBxiC,EAASltB,GAE1Bq0F,CACX,+ICzCA,WACA,WACA,WACA,WACA,WASMJ,EAAuB,2BAwE7B,SAASiY,EACLx8C,SAEA,OAAO,EAAP,8BAC4B,QAArB,EAAAA,EAAQkL,qBAAa,eAAEnjD,QACvBi4C,EAAQh4C,cAEnB,CA1Ea,EAAAkzF,kBAAkE,SAC3E7hG,EACAzT,EACAm6D,EACAC,EACA2kC,WAEQlmE,EAA0BshC,EAAW,aAAvBrtC,EAAYqtC,EAAW,SAE7C,IAAA9W,aAAYv2B,EAASstC,EAAQiwC,eAAe3yE,OAAQmB,EAAcuhC,GAElE,IAAMy8C,EACFz8C,EAAQ0U,uBACiB,gBAAzBhiD,EAAQ3M,MAAM0Q,SACS,QAAvB/D,EAAQ3M,MAAMD,MACZ42F,EAAmC,QAArB,EAAAhqF,EAAQl2B,qBAAa,eAAEgsF,UAAU3R,SAAS0tB,GACxDoY,EAAiBD,GAAeD,EAAuB/pF,EAAQl2B,cAAiBk2B,EActF,OAZAiyE,GAAU,IAAAG,oBAAmBl/F,EAAQ+2G,EAAgBhY,GAEjD8X,IACKC,IACe,IAAA7+F,MAAKxE,EAAKqZ,EAAS,OAC3B81D,UAAUpG,IAAImiB,IAE1B,IAAAxa,eAAc1wE,EAAKqZ,EAAS8pF,EAAiBx8C,GAAUA,IAGtC,QAArB,EAAAA,EAAQkN,qBAAa,cAArBlN,EAAwBD,EAAartC,GAE9BiyE,CACX,EAKa,EAAAyW,oBAAsE,SAC/E/hG,EACAzT,EACAm6D,EACAC,EACAmnB,SAEQ1oD,EAAkCshC,EAAW,aAA/BrtC,EAAoBqtC,EAAW,QAAtBh4C,EAAWg4C,EAAW,OAKrD,GAHAn6D,EAAOrK,YAAYm3B,GACnBy0D,SAAAA,EAAalrF,KAAKy2B,IAEd,IAAAjB,eAAc1J,GAAQ3wB,OAAS,EAAG,CAClC,IAAM+mD,GAAO,IAAAtgC,MAAKxE,EAAKqZ,EAAS,SAEhC,IAAAu2B,aAAY9K,EAAM6hB,EAAQiwC,eAAerwE,QAAS7X,EAAQi4C,GAK9D,IAFA,IAAA/W,aAAYv2B,EAASstC,EAAQiwC,eAAe3yE,OAAQmB,EAAcuhC,GAE9DA,EAAQ0U,uBAAyBj2C,EAAaE,WAAY,CACpD,oBAAkB,IAAAorD,eAAc1wE,EAAKqZ,EAAS8pF,EAAiBx8C,GAAUA,GAAQ,GAAhF48C,EAAK,KAAEC,EAAM,KAEpB11B,SAAAA,EAAalrF,KAAK2gH,EAAOC,GACzB78C,EAAQq6C,iBAAiBn0G,QAAQ05B,QAAUg9E,OAE3C58C,EAAQq6C,iBAAiBn0G,QAAQ05B,QAAUlN,EAG1B,QAArB,EAAAstC,EAAQkN,qBAAa,cAArBlN,EAAwBD,EAAartC,EACzC,gHCpFA,eACA,WACA,WACA,WASMoqF,EAAsE,CACxEz0F,WAAY,YACZ+R,WAAY,OAMH,EAAA0hF,sBAA+E,SACxFziG,EACAzT,EACAuqB,EACA6vC,EACA2kC,SAEIr0F,EAAU0vD,EAAQ2U,kBAAoBxkD,EAAUsC,mBAAgBx5B,EAEpE,GAAIqX,EACAq0F,GAAU,IAAAG,oBAAmBl/F,EAAQ0K,EAASq0F,GAE9C3kC,EAAQ+5C,cAAcC,mBAAmB3gG,EAAK/I,EAAS6f,EAAW6vC,QAC/D,KAAK,IAAAq4C,mBAAkBloF,GAAY,CACtC,IAAM,EAAgB9W,EAAIle,cAAcg1B,EAAUpV,SAE9CilD,EAAQ2U,oBACRxkD,EAAUsC,cAAgB,GAG9B7sB,EAAOkU,aAAa,EAAe6qF,IAEnC,IAAAyF,aAAYpqC,EAAS7vC,EAAUpV,SAAS,YACpC,IAAAkuC,aAAY,EAAe+W,EAAQiwC,eAAe9/E,UAAWA,EAAUpI,OAAQi4C,IAC/E,IAAA/W,aACI,EACA+W,EAAQiwC,eAAelV,eACvB5qE,EAAUpI,OACVi4C,IAGJ,IAAA/W,aAAY,EAAe+W,EAAQiwC,eAAe9/E,UAAWA,EAAUpI,OAAQi4C,EACnF,IAEyB,OAArB7vC,EAAUpV,SACV,IAAAqvF,aAAYpqC,EAAS88C,GAAgB,WACjC98C,EAAQ+5C,cAAcC,mBAAmB3gG,EAAK,EAAe8W,EAAW6vC,EAC5E,IAEAA,EAAQ+5C,cAAcC,mBAAmB3gG,EAAK,EAAe8W,EAAW6vC,GAG5E1vD,EAAU,EAOd,OAJIA,IACqB,QAArB,EAAA0vD,EAAQkN,qBAAa,cAArBlN,EAAwB7vC,EAAW7f,IAGhCq0F,CACX,oICtEA,eACA,WACA,WACA,WACA,WAWa,EAAA2W,mBAAyE,SAClFjiG,EACAzT,EACAw2B,EACA4jC,EACA2kC,SAEIr+F,EAAoB81B,EAAM9rB,QAgB9B,OAdIq0F,GAAWr+F,EAAKsS,YAAchT,EAC9B++F,GAAU,IAAAG,oBAAmBl/F,EAAQU,EAAMq+F,IAE3Cr+F,EAAOA,EAAKqN,YACZyoB,EAAM9rB,QAAUhK,GAEhB,IAAA2iD,aAAY3iD,EAAM05D,EAAQiwC,eAAehW,QAAS79D,EAAMrU,OAAQi4C,GAEhEp6D,EAAOkU,aAAaxT,EAAMq+F,IAGT,QAArB,EAAA3kC,EAAQkN,qBAAa,cAArBlN,EAAwB5jC,EAAO91B,GAC/B05D,EAAQ+5C,cAAcC,mBAAmB3gG,EAAK/S,EAAM81B,EAAO4jC,GAEpD2kC,CACX,EAKa,EAAA6W,qBAA+E,SACxFniG,EACAzT,EACAw2B,EACA4jC,EACAs8C,SAEMh2G,EAAO81B,EAAM9rB,QAAQqD,YAI3B,GAHAyoB,EAAM9rB,QAAUhK,EAChBV,EAAOrK,YAAY+K,IAEf,IAAA8zE,cAAa9zE,EAAM,gBAAiB,CACpC,IAAMgK,GAAU,IAAAuN,MAAKxE,EAAK/S,EAAM,SAEhC,IAAAi2G,qBAAoBljG,EAAK/S,EAAMgK,EAAS8rB,EAAO4jC,EAASs8C,IACxD,IAAArzD,aAAY3iD,EAAM05D,EAAQiwC,eAAehW,QAAS79D,EAAMrU,OAAQi4C,GAE3C,QAArB,EAAAA,EAAQkN,qBAAa,cAArBlN,EAAwB5jC,EAAO91B,GAGnC05D,EAAQ+5C,cAAcC,mBAAmB3gG,EAAK/S,EAAM81B,EAAO4jC,EAC/D,sGCjEA,eACA,WACA,WAMa,EAAA07C,YAA6D,SACtEriG,EACAzT,EACAm3G,EACA/8C,EACAs8C,GAEA,IAAMlpD,EAAM/5C,EAAIle,cAAc,OACxBmV,EAAUvV,SAASI,cAAc,QAEvCyK,EAAOrK,YAAY+U,GACnBA,EAAQ/U,YAAY63D,GAEpBA,EAAI97B,IAAMylF,EAAWzlF,IAEjBylF,EAAW3iD,MACXhH,EAAIgH,IAAM2iD,EAAW3iD,KAGrB2iD,EAAW7rF,QACXkiC,EAAIliC,MAAQ6rF,EAAW7rF,QAG3B,IAAA+3B,aAAYmK,EAAK4M,EAAQiwC,eAAehwE,MAAO88E,EAAWh1F,OAAQi4C,IAClE,IAAA/W,aAAYmK,EAAK4M,EAAQiwC,eAAe1+E,QAASwrF,EAAWxrF,QAASyuC,GAE/D,MAAoB+8C,EAAWh1F,OAA7BjC,EAAK,QAAEgC,EAAM,SACfk1F,EAAWl3F,GAAQ,IAAAy2C,oBAAmBz2C,GAAS,EAC/Cm3F,EAAYn1F,GAAS,IAAAy0C,oBAAmBz0C,GAAU,EAEpDk1F,EAAW,IACX5pD,EAAIttC,MAAQk3F,GAGZC,EAAY,IACZ7pD,EAAItrC,OAASm1F,GAGbF,EAAW18E,6BACX2/B,EAAQm6C,eAAiB,CACrBxrF,KAAM,QACNsR,MAAOmzB,KAIf,IAAAmpD,qBAAoBljG,EAAK+5C,EAAK9iD,EAASysG,EAAY/8C,EAASs8C,EAChE,oHCtDA,WACA,WAUa,EAAAX,WAA6D,SACtEtiG,EACAzT,EACAg3B,EACAojC,EACA2kC,WAEIuY,EAAQ,EACJvqB,EAAc3yB,EAAQ0yB,WAAU,UASxC,IAPwB,GAApBC,EAAUv7F,QACVu7F,EAAU12F,KAAK,CACXqK,KAAMV,IAKPs3G,EAAQtgF,EAASuE,OAAO/pC,QAAU8lH,EAAQ,EAAIvqB,EAAUv7F,OAAQ8lH,IAAS,CAC5E,IAAMC,EAAaxqB,EAAUuqB,EAAQ,GAC/BE,EAAYxgF,EAASuE,OAAO+7E,GAElC,GACIC,EAAW37E,UAAY47E,EAAU57E,WACf,QAAlB,EAAA27E,EAAW5rF,eAAO,eAAE8sB,cAAe++D,EAAU7rF,QAAQ8sB,aAC9B,MAAtB++D,EAAU57E,UAAoE,iBAAzC47E,EAAUr1F,OAAOmQ,oBAEvD,MAQR,IAHAy6D,EAAUrqF,OAAO40G,EAAQ,GAGlBA,EAAQtgF,EAASuE,OAAO/pC,OAAQ8lH,IAAS,CAC5C,IAAMhyG,EAAQ0xB,EAASuE,OAAO+7E,GACxB/gB,EAAU9iF,EAAIle,cAAc+P,EAAMs2B,UAAY,MACjCmxD,EAAUA,EAAUv7F,OAAS,GAAGkP,KAExCwT,aAAaqiF,EAAkB,GAAT+gB,EAAavY,EAAU,MACxDhS,EAAU12F,MAAK,EAAD,aAAGqK,KAAM61F,GAAYjxF,KAEnC,IAAA+9C,aAAYkzC,EAASn8B,EAAQiwC,eAAejE,gBAAiB9gG,EAAM6c,OAAQi4C,IAG3E,IAAAq9C,eAAcnyG,EAAO80D,EAAQ2uB,iBAAiBE,UAAW3jF,EAAM6c,OAAQi4C,IAGvE,IAAA/W,aAAYkzC,EAASn8B,EAAQiwC,eAAephB,UAAW3jF,EAAM6c,OAAQi4C,IACrE,IAAA/W,aAAYkzC,EAASn8B,EAAQiwC,eAAe1+E,QAASrmB,EAAMqmB,QAASyuC,GAE/C,QAArB,EAAAA,EAAQkN,qBAAa,cAArBlN,EAAwB90D,EAAOixF,GAGnC,OAAOwI,CACX,yGClEA,eACA,WACA,WACA,WAUa,EAAAiX,eAAiE,SAC1EviG,EACAzT,EACAg3B,EACAojC,EACA2kC,WAEAA,EAAU3kC,EAAQ+5C,cAAcptG,KAAK0M,EAAKzT,EAAQg3B,EAAUojC,EAAS2kC,GAE7D,IAAAhS,EAAc3yB,EAAQ0yB,WAAU,UAElC0J,GAA+C,QAAlC,EAAAzJ,aAAS,EAATA,GAAYA,aAAS,EAATA,EAAWv7F,QAAS,UAAE,eAAEkP,OAAQV,EACzDyhG,EAAKhuF,EAAIle,cAAc,MACvB+P,EAAQ0xB,EAASuE,OAAOvE,EAASuE,OAAO/pC,OAAS,GA6BvD,OAzBAglG,EAAWtiF,aAAautF,GAAI1C,aAAO,EAAPA,EAAS/rF,aAAcwjF,EAAauI,EAAU,MAEtEz5F,IACA,IAAA+9C,aAAYo+C,EAAIrnC,EAAQiwC,eAAerwE,QAAShD,EAASyE,aAAatZ,OAAQi4C,IAC9E,IAAA/W,aAAYo+C,EAAIrnC,EAAQiwC,eAAepE,eAAgB3gG,EAAM6c,OAAQi4C,IAGrE,IAAAq9C,eAAcnyG,EAAO80D,EAAQ2uB,iBAAiB/xD,SAAUA,EAAS7U,OAAQi4C,IAGzE,IAAA/W,aAAYo+C,EAAIrnC,EAAQiwC,eAAerE,gBAAiBhvE,EAAS7U,OAAQi4C,GAEzEA,EAAQ+5C,cAAcC,mBAAmB3gG,EAAKguF,EAAIzqE,EAAUojC,KAI5DpjC,EAASP,OAAO9/B,QAAQ,EAAAqjE,yBAExBI,EAAQ+5C,cAAcC,mBAAmB3gG,EAAKguF,EAAIzqE,EAAUojC,IAE5D,IAAAs9C,QAAOjW,IAGU,QAArB,EAAArnC,EAAQkN,qBAAa,cAArBlN,EAAwBpjC,EAAUyqE,GAE3B1C,CACX,yHCxDA,WACA,WACA,UACA,WACA,WACA,WAYa,EAAAkX,gBAAmE,SAC5ExiG,EACAzT,EACAu3B,EACA6iC,EACA2kC,SAEIx0E,EAAY6vC,EAAQ2U,kBAAoBx3C,EAAU1K,mBAAgBx5B,EAsGtE,OApGIk3B,EACAw0E,GAAU,IAAAG,oBAAmBl/F,EAAQuqB,EAAWw0E,IAEhD,IAAAyF,aAAYpqC,GAA4B,QAAnB,EAAA7iC,EAAU4E,iBAAS,eAAEhnB,UAAW,MAAM,uBACjDwiG,GACDpgF,EAAU+E,cACT/E,EAAU4E,YACX,IAAAtQ,eAAc0L,EAAUpV,QAAQ3wB,OAAS,GACtC+lC,EAAUkF,SAASiC,MAAK,SAAA1E,GAAW,MAAuB,mBAAvBA,EAAQD,WAAR,IACrC69E,EAAkBD,GAClB,EAAD,+BAC4B,QAAnB,EAAApgF,EAAU4E,iBAAS,eAAEha,SAAU,CAAC,GACjCoV,EAAUoF,eAEjB,CAAC,EAEPpS,EAAY9W,EAAIle,eAAiC,QAAnB,EAAAgiC,EAAU4E,iBAAS,eAAEhnB,UA9BnC,OAgChBnV,EAAOkU,aAAaqW,EAAWw0E,GAE/B3kC,EAAQq6C,iBAAiBn0G,QAAU,CAC/Bo2B,MAAOihF,EAAuBptF,EAAYA,EAAUvX,WACpDgnB,QAAS,MAGb,IAAM69E,EAAiB,WACnB,IAAM73G,EAASuqB,EAEf,GAAIvqB,EAAQ,CACR,IAAMymE,EAAelvC,EAAUkF,SAAS,GAEP,oBAA7BgqC,aAAY,EAAZA,EAAc1sC,cAIdqgC,EAAQ+5C,cAAc3oG,KAClBiI,EACAzT,GAAM,gCAECymE,GAAY,CACf1sC,YAAa,OACbvuB,KAAM,KAEV4uD,EACA,IAIR7iC,EAAUkF,SAAS9lC,SAAQ,SAAAqjC,GACvB,IAAMunD,EAAsB,GAC5BnnB,EAAQ+5C,cAAcn6E,QAAQvmB,EAAKzT,EAAQg6B,EAASogC,EAASmnB,GAE7DA,EAAY5qF,SAAQ,SAAA+J,SACE,QAAlB,EAAA05D,EAAQ4U,kBAAU,SAAE6R,UAAUngF,EAAM62B,EAAW,CAACyC,GACpD,GACJ,IAER,EAEI29E,IACA,IAAAnT,aAAYpqC,EAASw9C,EAAiBC,IAEtC,IAAAx0D,aAAY94B,EAAW6vC,EAAQiwC,eAAe3zE,MAAOa,EAAUpV,OAAQi4C,IACvE,IAAA/W,aAAY94B,EAAW6vC,EAAQiwC,eAAe9/E,UAAWgN,EAAUpV,OAAQi4C,IAC3E,IAAA/W,aACI94B,EACA6vC,EAAQiwC,eAAelV,eACvByiB,EACAx9C,IAGJy9C,KAGJ,IAAAC,UAASvtF,GAQTw0E,EAAUx0E,EAAUglC,YAEhBhlC,IACqB,QAArB,EAAA6vC,EAAQkN,qBAAa,cAArBlN,EAAwB7iC,EAAWhN,GACjB,QAAlB,EAAA6vC,EAAQ4U,kBAAU,SAAE6S,YAAYt3D,IAGhCotF,EACIv9C,EAAQ2U,oBACRx3C,EAAU1K,cAAgBtC,KAG9B,IAAAmtF,QAAOntF,GACPA,OAAYl3B,EAEpB,IAGG0rG,CACX,uHCvHa,EAAAoX,cAAiE,SAC1E1iG,EACAzT,EACAg6B,EACAogC,EACAs8C,GAEA,IAAMjC,EAAmBr6C,EAAQq6C,iBASjC,OANIz6E,EAAQ/B,aAAew8E,EAAiBngH,QACxCmgH,EAAiBngH,OAAQ,EAAH,eACfmgH,EAAiBn0G,UAIpB05B,EAAQD,aACZ,IAAK,OACDqgC,EAAQ+5C,cAAc3oG,KAAKiI,EAAKzT,EAAQg6B,EAASogC,EAASs8C,GAC1D,MAEJ,IAAK,KACDt8C,EAAQ+5C,cAAct8E,GAAGpkB,EAAKzT,EAAQg6B,EAASogC,EAASs8C,GACxD,MAEJ,IAAK,QACDt8C,EAAQ+5C,cAAc95E,MAAM5mB,EAAKzT,EAAQg6B,EAASogC,EAASs8C,GAC3D,MAEJ,IAAK,UACDt8C,EAAQ+5C,cAAcwB,eAAeliG,EAAKzT,EAAQg6B,EAASogC,EAASs8C,GACpE,MAEJ,IAAK,SACDt8C,EAAQ+5C,cAAcoB,cAAc9hG,EAAKzT,EAAQg6B,EAASogC,EAASs8C,GAMvE18E,EAAQ/B,YAAcw8E,EAAiBngH,QACvCmgH,EAAiBlgH,KAAM,EAAH,eACbkgH,EAAiBn0G,SAGhC,iHCrDA,eACA,WACA,WACA,WASa,EAAA+1G,uBAA0E,SACnFtnG,EACA/O,EACAg6B,EACAogC,EACAs8C,GAEQ,IAAAv+E,EAAe6B,EAAO,KAAhBt6B,EAASs6B,EAAO,MAE1B,IAAAw6C,cAAax0E,EAAQ,kBACjBN,IACA,IAAA8kG,aAAYpqC,EAAS,KAAK,iBAChBj9D,GAAI,IAAAsyG,mBAAkBzvG,EAAQ,MAEpC,IAAAqjD,aAAYlmD,EAAGi9D,EAAQiwC,eAAe3qG,KAAMA,EAAKyiB,OAAQi4C,IACzD,IAAA/W,aAAYlmD,EAAGi9D,EAAQiwC,eAAe1+E,QAASjsB,EAAKisB,QAASyuC,GAE7Ds8C,SAAAA,EAAcrgH,KAAK8G,GACE,QAArB,EAAAi9D,EAAQkN,qBAAa,cAArBlN,EAAwB16D,EAAMvC,EAClC,IAGAg7B,IACA,IAAAqsE,aAAYpqC,EAAS,QAAQ,iBACnB29C,GAAW,IAAAtI,mBAAkBzvG,EAAQ,SAE3C,IAAAqjD,aAAY00D,EAAU39C,EAAQiwC,eAAelyE,KAAMA,EAAKhW,OAAQi4C,GAEhEs8C,SAAAA,EAAcrgH,KAAK0hH,GACE,QAArB,EAAA39C,EAAQkN,qBAAa,cAArBlN,EAAwBjiC,EAAM4/E,EAClC,IAGZ,sGC7CA,eACA,WACA,WACA,WACA,WAWa,EAAAzB,YAA2D,SACpE7iG,EACAzT,EACAyS,EACA2nD,EACA2kC,qBAEA,IAAI,IAAAyT,cAAa//F,GAEb,OAAOssF,EAGX,IAAIiZ,EAAY59C,EAAQ2U,kBAAoBt8D,EAAMoa,mBAAgBx5B,EAE9D2kH,GACAjZ,GAAU,IAAAG,oBAAmBl/F,EAAQg4G,EAAWjZ,IAEhD,IAAAxpB,gBAAeyiC,KAEfA,EAAYvkG,EAAIle,cAAc,SAE1B6kE,EAAQ2U,oBACRt8D,EAAMoa,cAAgBmrF,GAG1Bh4G,EAAOkU,aAAa8jG,EAAWjZ,IAE/B,IAAA17C,aAAY20D,EAAW59C,EAAQiwC,eAAe3zE,MAAOjkB,EAAM0P,OAAQi4C,IACnE,IAAA/W,aAAY20D,EAAW59C,EAAQiwC,eAAe53F,MAAOA,EAAM0P,OAAQi4C,IACnE,IAAA/W,aAAY20D,EAAW59C,EAAQiwC,eAAe3D,YAAaj0F,EAAM0P,OAAQi4C,IACzE,IAAA/W,aAAY20D,EAAW59C,EAAQiwC,eAAe1+E,QAASlZ,EAAMkZ,QAASyuC,IAGrD,QAArB,EAAAA,EAAQkN,qBAAa,cAArBlN,EAAwB3nD,EAAOulG,GAE/B,IAAMtlG,EAAQe,EAAIle,cAAc,SAChCyiH,EAAUriH,YAAY+c,GAEtB,IAAK,IAAIyrB,EAAM,EAAGA,EAAM1rB,EAAMqsB,KAAKttC,OAAQ2sC,IAAO,CAC9C,IAAM8oE,EAAWx0F,EAAMqsB,KAAKX,GAE5B,GAA6B,GAAzB8oE,EAAS1oE,MAAM/sC,OAAnB,CAKA,IAAMugG,EAAM33B,EAAQ2U,mBAAqBk4B,EAASp6E,eAAkBpZ,EAAIle,cAAc,MACtFmd,EAAM/c,YAAYo8F,IAClB,IAAAxc,gBAAewc,GAEVkV,EAASp6E,gBACNutC,EAAQ2U,oBACRk4B,EAASp6E,cAAgBklE,IAG7B,IAAA1uC,aAAY0uC,EAAI33B,EAAQiwC,eAAepD,SAAUA,EAAS9kF,OAAQi4C,IAGjD,QAArB,EAAAA,EAAQkN,qBAAa,cAArBlN,EAAwB6sC,EAAUlV,GAElC,IAAK,IAAIxjD,EAAM,EAAGA,EAAM04D,EAAS1oE,MAAM/sC,OAAQ+8C,IAAO,CAClD,IAAMpX,EAAO8vE,EAAS1oE,MAAMgQ,GAE5B,GAAIpX,EAAKc,WAAY,CACjB,IAAMuuE,EAAiCpsC,EAAQosC,gBAAkB,CAC7Dz9E,KAAM,QACNtW,MAAOulG,EACP7rE,YAAaoC,EACb0yB,WAAY1yB,EACZwyB,SAAU5iC,EACV6iC,QAAS7iC,GAGTqoE,EAAe/zF,OAASulG,IACxBxR,EAAevlC,WAAarmE,KAAKC,IAAI2rG,EAAevlC,WAAY1yB,GAChEi4D,EAAexlC,QAAUpmE,KAAKC,IAAI2rG,EAAexlC,QAAS7iC,IAG9Di8B,EAAQosC,eAAiBA,EAG7B,IAAKrvE,EAAKwG,YAAcxG,EAAKsG,SAAU,CACnC,IAAMslB,EACDqX,EAAQ2U,mBAAqB53C,EAAKtK,eACnCpZ,EAAIle,cAAc4hC,EAAKoG,SAAW,KAAO,MAE7Cw0D,EAAGp8F,YAAYotD,GAOf,IALA,IAAImvC,EAAU,EACVrzC,EAAU,EACV3+B,EAAQzN,EAAMosB,OAAO0P,GACrBrsB,EAAS+kF,EAAS/kF,OAEsB,QAArC,EAAyB,QAAzB,EAAAzP,EAAMqsB,KAAKX,EAAM+zD,UAAQ,eAAE3zD,MAAMgQ,UAAI,eAAE5Q,UAAWu0D,IACrDhwE,GAAUzP,EAAMqsB,KAAKX,EAAM+zD,GAAShwE,OAExC,KAAoC,QAA7B,EAAA+kF,EAAS1oE,MAAMgQ,EAAMsQ,UAAQ,eAAEphB,SAAUohB,IAC5C3+B,GAASzN,EAAMosB,OAAO0P,EAAMsQ,GAG5BqzC,EAAU,IACVnvC,EAAGmvC,QAAUA,GAGbrzC,EAAU,IACVkE,EAAGlE,QAAUA,KAGZ1nB,EAAKtK,eAAkBsK,EAAKhV,OAAOmO,eAAgB,IAAAs7C,aAAYn5D,MAC5DyN,EAAQ,IAAM6iC,EAAG5iC,MAAMD,QACvB6iC,EAAG5iC,MAAMD,MAAQA,EAAQ,MAGzBgC,EAAS,IAAM6gC,EAAG5iC,MAAM+B,SACxB6gC,EAAG5iC,MAAM+B,OAASA,EAAS,OAI9BiV,EAAKtK,gBACFutC,EAAQ2U,oBACR53C,EAAKtK,cAAgBk2B,IAGzB,IAAAM,aAAYN,EAAIqX,EAAQiwC,eAAe3zE,MAAOS,EAAKhV,OAAQi4C,IAC3D,IAAA/W,aAAYN,EAAIqX,EAAQiwC,eAAe3C,UAAWvwE,EAAKhV,OAAQi4C,IAC/D,IAAA/W,aAAYN,EAAIqX,EAAQiwC,eAAe8E,gBAAiBh4E,EAAKhV,OAAQi4C,IACrE,IAAA/W,aAAYN,EAAIqX,EAAQiwC,eAAe1+E,QAASwL,EAAKxL,QAASyuC,IAGlEA,EAAQ+5C,cAAcC,mBAAmB3gG,EAAKsvC,EAAI5rB,EAAMijC,GAEnC,QAArB,EAAAA,EAAQkN,qBAAa,cAArBlN,EAAwBjjC,EAAM4rB,MAO1C,OAFkB,QAAlB,EAAAqX,EAAQ4U,kBAAU,SAAEgT,QAAQg2B,EAAWvlG,GAEhCssF,CACX,qGC1JA,eAMa,EAAAwX,WAA2D,SACpE9iG,EACAzT,EACAg6B,EACAogC,EACAs8C,GAEA,IAAMl1B,EAAM/tE,EAAI7d,eAAeokC,EAAQxuB,MACjCd,EAAU+I,EAAIle,cAAc,QAElCyK,EAAOrK,YAAY+U,GACnBA,EAAQ/U,YAAY6rF,GAEpBpnB,EAAQiwC,eAAe7+F,KAAK7U,SAAQ,SAAAshH,GAAW,OAAAA,EAAQj+E,EAAQ7X,OAAQq/D,EAAKpnB,EAA7B,KAE/C,IAAAu8C,qBAAoBljG,EAAK+tE,EAAK92E,EAASsvB,EAASogC,EAASs8C,EAC7D,oGCtBA,eAEMwB,EAAe,CAAC,OAAQ,IAAK,KAAM,IAAK,IAAK,MAAO,MAAO,SAAU,IAAK,IAAK,QA4BrF,SAASC,EAAkBC,EAAuBC,GAC9C,IAAMC,EAAQF,EAASnjG,WACjBsjG,EAAQF,EAASpjG,WAEvB,GAAIqjG,EAAM9mH,QAAU+mH,EAAM/mH,OACtB,OAAO,EAGX,IAAK,IAAID,EAAI,EAAGA,EAAI+mH,EAAM9mH,OAAQD,IAC9B,GAAI+mH,EAAM/mH,GAAGwP,MAAQw3G,EAAMhnH,GAAGwP,MAAQu3G,EAAM/mH,GAAGmB,OAAS6lH,EAAMhnH,GAAGmB,MAC7D,OAAO,EAIf,OAAO,CACX,CAtCA,qBAA0Bka,GACtB,IAAK,IAAI0iD,EAAQ1iD,EAAKqK,WAAYq4C,GAAS,CACvC,IAAM0vC,EAAO1vC,EAAMC,YAEnB,GACIyvC,IACA,IAAAxqB,cAAallB,EAAO,kBACpB,IAAAklB,cAAawqB,EAAM,iBACnB1vC,EAAMn6C,SAAW6pF,EAAK7pF,SACtB+iG,EAAav1G,QAAQ2sD,EAAMn6C,UAAY,GACvCgjG,EAAkB7oD,EAAO0vC,GAC3B,CACE,KAAOA,EAAK/nF,YACRq4C,EAAM35D,YAAYqpG,EAAK/nF,YAG3B+nF,EAAKhsF,WAAYnc,YAAYmoG,QAE7B1vC,EAAQ0vC,EAGpB,kGC5BA,eACA,WACA,WAKA,oBAAgB8Y,EAASlrG,GAIrB,KAAI,IAAAwuE,iBAAgBxuE,GAApB,EAIA,IAAA4rG,uBAAsB5rG,IACtB,IAAA6rG,WAAU7rG,GAEV,IAAK,IAAI0iD,EAAQ1iD,EAAKqK,WAAYq4C,EAAOA,EAAQA,EAAMC,YACnDuoD,EAASxoD,GAEjB,gHCrBA,eAKA,iCAAsC1iD,GAClC,IAAK,IAAI0iD,EAAQ1iD,EAAKqK,WAAYq4C,GAC9B,IACI,IAAAklB,cAAallB,EAAO,iBACH,QAAjBA,EAAMn6C,SACqB,GAA3Bm6C,EAAMr6C,WAAWzjB,OACnB,CACE,IAAMkP,EAAO4uD,EACTyvC,EAAUzvC,EAAMC,YAGpB,IAFAD,EAAQA,EAAMC,YAEP7uD,EAAKwgF,WAAW,CACnB,IAAMw3B,EAAUh4G,EAAKwgF,UACrBt0E,EAAKsH,aAAawkG,EAAS3Z,GAC3BA,EAAU2Z,EAGd9rG,EAAK/V,YAAY6J,QAEjB4uD,EAAQA,EAAMC,WAG1B,oGCbA,uBACI7kD,EACAuqG,EACA9yF,EACAi4C,GAEA66C,EAASt+G,SAAQ,SAAAshH,GACbA,SAAAA,EAAU91F,EAAQzX,EAAS0vD,EAC/B,GACJ,wGCvBA,eAWA,yBACI//D,EACA49G,EACA91F,EACAi4C,GAEI69C,IACA,IAAAxtB,gBACIpwF,GACA,SAAAm1B,GAEI,OADAyoF,EAAQrrB,gBAAgBp9D,EAAUrN,EAAQi4C,GACnC5qC,CACX,GACAyoF,EAAQtrB,mBAGpB,8GC3BA,eAMA,+BACIl5E,EACAqtE,EACA63B,EACA3+E,EACAogC,EACAs8C,SAEK51B,EAAY7pE,aACbmjD,EAAQq6C,iBAAiBn0G,QAAQ05B,QAAU8mD,IAG/C,IAAAz9B,aAAYs1D,EAAev+C,EAAQiwC,eAAe4E,kBAAmBj1E,EAAQ7X,OAAQi4C,GAErFs8C,SAAAA,EAAcrgH,KAAKyqF,GACnB1mB,EAAQ+5C,cAAciC,iBAAiB3iG,EAAKklG,EAAe3+E,EAASogC,EAASs8C,IAE7E,IAAArzD,aAAYs1D,EAAev+C,EAAQiwC,eAAe6E,oBAAqBl1E,EAAQ7X,OAAQi4C,GAElE,QAArB,EAAAA,EAAQkN,qBAAa,cAArBlN,EAAwBpgC,EAAS8mD,EACrC,qHC1BA,WAUA,uBACI1mB,EACAw+C,EACApwF,GAEA,IAAMk/C,EACyB,iBAApBkxC,EACD,EAAApY,6BAA6BoY,GAC7BA,EAEV,GAAIlxC,EAAW,CACX,IAAMgkC,EAAiBtxC,EAAQsxC,eAE/B,IACItxC,EAAQsxC,gBAAiB,EAAH,8BACfA,GACAhkC,GAGPl/C,YAEA4xC,EAAQsxC,eAAiBA,QAG7BljF,GAER,8BClBA,SAASqwF,EAAwBriF,EAA+BsiF,GAC5DtiF,EAAMC,OAAO9/B,SAAQ,SAAA+/B,GACjB,OAAQA,EAAMU,WACV,IAAK,YACD,IAAI,EAAO,GAEXV,EAAM+F,SAAS9lC,SAAQ,SAAAqjC,GACnB,OAAQA,EAAQD,aACZ,IAAK,KACD++E,EAAUziH,KAAK,GACf,EAAO,GACP,MAEJ,IAAK,SACD,GAAQ2jC,EAAQlN,QAAQ9X,aAAe,GACvC,MAEJ,IAAK,UACD,GAAQglB,EAAQtvB,QAAQsK,aAAe,GACvC,MAEJ,IAAK,OACD,GAAQglB,EAAQxuB,KAChB,MAEJ,IAAK,QACD,GAAQ,IAGpB,IACAstG,EAAUziH,KAAK,GACf,MAEJ,IAAK,UACL,IAAK,SACDyiH,EAAUziH,KAAK,IACf,MAEJ,IAAK,QACDqgC,EAAMoI,KAAKnoC,SAAQ,SAAAwnC,GACf,OAAAA,EAAII,MAAM5nC,SAAQ,SAAAwgC,GACd0hF,EAAwB1hF,EAAM2hF,EAClC,GAFA,IAIJ,MAEJ,IAAK,aACDD,EAAwBniF,EAAOoiF,GAG3C,GACJ,8EA9DA,8BACIz+G,EACA0+G,QAAA,IAAAA,IAAAA,EAAA,QAEA,IAAMD,EAAsB,GAI5B,OAFAD,EAAwBx+G,EAAOy+G,GAExBA,EAAUthH,KAAKuhH,EAC1B,2GChBA,eA0BMC,EAA8C,CAChDjzD,YAAY,EACZkzD,eAAe,GAOnB,aAQI,WAAoBv3F,QAAA,IAAAA,IAAAA,EAAA,QAAAA,QAAAA,EAPZ,KAAAyB,OAAyB,IAOiC,CAyDtE,OApDI,YAAAmd,QAAA,WACI,MAAO,YACX,EAQA,YAAAC,WAAA,SAAWpd,GACPtxB,KAAKsxB,OAASA,CAClB,EAOA,YAAA0c,QAAA,WACIhuC,KAAKsxB,OAAS,IAClB,EAQA,YAAAsd,cAAA,SAAcC,GACN7uC,KAAKsxB,QAEI,YADDud,EAAMC,WAEN9uC,KAAKqnH,mBAAmBrnH,KAAKsxB,OAAQud,EAIrD,EAEQ,YAAAw4E,mBAAR,SAA2B/1F,EAAiBud,GACxC,IAAMiX,EAAWjX,EAAMiX,SACvB,IAAKA,EAASonC,mBAAqBr+C,EAAMy4E,sBAE5B,MADDxhE,EAASz+C,IACb,CACU,MAAgCrH,KAAK6vB,QAAnCqkC,EAAU,aAAEkzD,EAAa,iBAC7BlzD,GAAckzD,KACd,IAAAG,qBAAoBj2F,EAAQw0B,EAAUoO,EAAYkzD,EAEjD,CAGrB,EACJ,EAjEA,GAAa,EAAAx6F,iBAAAA,8GCnCb,eACA,WACA,WACA,WAMA,+BACI0E,EACAw0B,EACA0hE,EACAC,QADA,IAAAD,IAAAA,GAAA,QACA,IAAAC,IAAAA,GAAA,GAEAn2F,EAAOiiC,oBAAmB,SAAC/qD,EAAOk/G,GAC9B,IAAMnnF,GAAgB,IAAAonF,kBAClBn/G,EACAg/G,EACAC,GAEJ,GAAIlnF,EAAe,CACf,IAAMqnF,GAAwB,IAAAluC,kCAAiClxE,GAAO,GAClEo/G,EAAsB,IAAMA,EAAsB,GAAG,IACrDA,EAAsB,GAAG,GAAGh9E,SAAS/5B,OAAO,EAAG,GAE3C,IAAAk5B,EAA+BxJ,EAAa,SAAlCsnF,EAAqBtnF,EAAa,UAAvBp6B,EAAUo6B,EAAa,MAKpD,OAJAunF,EAAYx2F,EAAQ9oB,EAAOuhC,EAAU89E,EAAW1hH,GAChD2/C,EAAS1uB,kBACT,IAAAwxC,uBAAsBpgE,IAEf,EAEX,OAAO,CACX,GACJ,EAEA,IAAMs/G,EAAc,SAChBx2F,EACA9oB,EACAuhC,EACA89E,EACA1hH,IAEA,IAAA6jC,aAAYxhC,EAAOuhC,GACnB,IAAM6hC,EAA4B,MAAZ7hC,EAElB5jC,GAASA,EAAQ,GAAKylE,IACtB,IAAAzuB,oBAAmB7rB,EAAQnrB,IAE/B,IAAAy5C,cACItuB,EACAs6C,EACM,CACIzrC,iBAAkB0nF,GAEtB,CACIznF,mBAAoBynF,GAGtC,+GCtDA,kCAAuCE,GACnC,IAAMl4G,EAAQk4G,EAAO37G,cACrB,GAAIyD,EAAO,CAEP,IADA,IAAI/J,EAAS,EACJpG,EAAI,EAAGA,EAAImQ,EAAMlQ,OAAQD,IAE9BoG,EAAkB,GAATA,GADQ+J,EAAMmwF,WAAWtgG,GAAK,GAAK,GAIhD,OAAOoG,EAGf,mGClBA,eAKA,oBAAyBkiH,GACrB,IAAM7hH,EAAQ6hH,EAAUnwG,QAAQ,iBAAkB,IAC5CowG,EAAcv7G,SAASvG,GAC7B,OAAQ2J,MAAMm4G,IAA6B,IAAAC,wBAAuB/hH,GAArC8hH,CACjC,2GCTA,eACA,WAMA,WAoBA,4BACIz/G,EACAg/G,EACAC,QADA,IAAAD,IAAAA,GAAA,QACA,IAAAC,IAAAA,GAAA,GAEA,IAAMU,GAAgC,IAAAzuC,kCAAiClxE,GAAO,GACxE0iC,EAASi9E,EAA8B,GAAG,GAC1CziF,EAAYyiF,EAA8B,GAAG,GAC7CC,EAAoB1iF,aAAS,EAATA,EAAWkF,SAAS,GAE9C,GACIM,GACsB,mBAAtBA,EAAOhD,aACPkgF,GACiC,QAAjCA,EAAkBlgF,YACpB,CACE,IAAMmgF,EAAaD,EAAkBzuG,KAC/B2uG,EAAaC,EAAeF,GAElC,GAAIC,GAAcd,EACd,MAAO,CAAEz9E,SAAU,KAAM89E,UAAWS,GACjC,GAAIb,EAA0B,CACjC,IAAMe,EAAeC,EAAqBjgH,EAAOk9B,GAC3CgjF,EAAgBC,EAAqBngH,EAAOggH,GAC5CI,EAAoBC,EAAqBL,GACzCM,GAAgB,IAAAC,uBAClBV,EACAK,EACAE,GAEJ,GAAIE,EACA,MAAO,CACH/+E,SAAU,KACV89E,UAAWiB,EACX3iH,OACK6iH,EAAUX,IACXO,IAAsBE,GACtBJ,EACMA,EAAgB,OAChBlnH,IAM9B,EAEA,IAAMmnH,EAAuB,SACzBngH,EACAygH,GAEA,OAAOA,GAAmB,IAAA3lD,2BAA0B96D,EAAOygH,GAAkBtpH,YAAS6B,CAC1F,EAEMinH,EAAuB,SAACjgH,EAA6Bk9B,GACvD,IAAMd,GAAS,IAAAk/B,sBACXt7D,EACA,CAAC,YACD,CAAC,cACH,GACE28B,OAA6C3jC,EACjD,GAAIojC,EAAQ,CACR,IAAMskF,EAAiBtkF,EAAOz2B,OAAOy2B,OAAO9zB,QAAQ40B,GAEpD,GAAIwjF,GAAkB,EAClB,IAAK,IAAIxpH,EAAIwpH,EAAiB,EAAGxpH,GAAK,EAAGA,IAAK,CAC1C,IAAMyV,EAAOyvB,EAAOz2B,OAAOy2B,OAAOllC,GAClC,IAAI,IAAAglE,oBAAyCvvD,EAAM,YAAa,CAC5DgwB,EAAWhwB,EACX,QAMhB,OAAOgwB,CACX,EAEM0jF,EAAuB,SAAC3zG,SAC1B,GAAIA,aAAI,EAAJA,EAAMw0B,OAAO,GAAG5P,QAChB,OAAyC,QAAlC,OAAAqQ,oBAAmBj1B,EAAKw0B,OAAO,WAAG,eAAEvJ,gBAEnD,EAEMooF,EAAyC,CAC3C,IAAK,EAAArpE,eAAeC,KACpB,IAAK,EAAAD,eAAeE,KACpB,KAAM,EAAAF,eAAeG,OACrB,KAAM,EAAAH,eAAeK,UACrB,SAAO,EAAAL,eAAeQ,gBACtB,KAAM,EAAAR,eAAeM,cACrB,IAAK,EAAAN,eAAeI,WACpB,IAAK,EAAAJ,eAAeO,QAGlBupE,EAAY,SAACX,GACf,IAAMn9E,EAASm9E,EAAWxwG,QAAQ,WAAY,IAE9C,MADgB,YACDM,KAAK+yB,EACxB,gIC9HA,eACA,WAiBMi+E,EAAqC,CACvC,IAAK,EACL,IAAK,EACL,IAAK,GAGHC,EAAkB,CACpB,EAAAnpE,kBAAkBa,WAClB,EAAAb,kBAAkBgB,eAClB,EAAAhB,kBAAkBe,4BAClB,EAAAf,kBAAkBc,uBAEhBsoE,EAAkB,CACpB,EAAAppE,kBAAkBiB,WAClB,EAAAjB,kBAAkBoB,eAClB,EAAApB,kBAAkBmB,4BAClB,EAAAnB,kBAAkBkB,uBAEhBmoE,EAAoB,CAAC,IAAK,IAAK,IAAK,IAAK,KACzCC,EAAoB,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KACnDC,EAAoB,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAoCnDC,IAAkB,MACpB,GAA0B,SAAAj9G,GAAQ,OAAAk9G,EAAcl9G,SAAShL,CAAvB,EAClC,KAA6B,SAAAgL,GAAQ,OAAAm9G,EAAgBn9G,SAAShL,CAAzB,EACrC,KAA6B,SAAAgL,GAAQ,OAAAo9G,EAAgBp9G,SAAShL,CAAzB,EACrC,KAA6B,SAAAgL,GAAQ,OAAAq9G,EAAgBr9G,SAAShL,CAAzB,EACrC,KAA6B,SAAAgL,GAAQ,OAAAs9G,EAAgBt9G,SAAShL,CAAzB,KAGnCsoH,IAAe,MACjB,GAAiB,EAAA7pE,kBAAkBiB,WACnC,KAAkB,EAAAjB,kBAAkBoB,eACpC,KAAyB,EAAApB,kBAAkBkB,sBAC3C,KAA+B,EAAAlB,kBAAkBmB,+BAG/CyoE,IAAe,MACjB,GAAiB,EAAA5pE,kBAAkBa,WACnC,KAAkB,EAAAb,kBAAkBgB,eACpC,KAAyB,EAAAhB,kBAAkBc,sBAC3C,KAA+B,EAAAd,kBAAkBe,+BAG/C4oE,IAAe,MACjB,GAAiB,EAAA3pE,kBAAkBS,WACnC,KAAkB,EAAAT,kBAAkBY,eACpC,KAAyB,EAAAZ,kBAAkBU,sBAC3C,KAA+B,EAAAV,kBAAkBW,+BAG/C+oE,IAAe,MACjB,GAAiB,EAAA1pE,kBAAkBK,WACnC,KAAkB,EAAAL,kBAAkBQ,eACpC,KAAyB,EAAAR,kBAAkBM,sBAC3C,KAA+B,EAAAN,kBAAkBO,+BAG/CkpE,IAAa,MACf,GAAiB,EAAAzpE,kBAAkBC,QACnC,KAAkB,EAAAD,kBAAkBE,YACpC,KAAyB,EAAAF,kBAAkBG,mBAC3C,KAA+B,EAAAH,kBAAkBI,4BAuBrD,iCACI0pE,EACAC,EACApB,GAEA,IAAMqB,EAAUF,EAAiB/xG,OAC3BkyG,EAAqC,MAAfD,EAAQ,IAA8C,MAAhCA,EAAQA,EAAQtqH,OAAS,GAGrEqoH,EAAYkC,EAAsBD,EAAQpnH,MAAM,GAAI,GAAKonH,EAAQpnH,MAAM,GAAI,GAC3EsD,GAAQ,IAAAgkH,UAASnC,GACjBoC,EAAkBd,EAAkBx4G,QAAQk3G,GAAa,EAE/D,MACK7hH,GACDA,EAAQ,IACN6jH,GAAqBI,GACtBJ,GAAqBI,IAwB9B,SAAuBjkH,EAAgB6jH,GACnC,OAAOA,GAAqB7jH,GAAS6jH,EAAoB,IAAM7jH,CACnE,CA1BkDkkH,CAAclkH,EAAO6jH,IAJnE,CASA,IAAMlB,EAeV,SAA0B3iH,GACtB,OAAO8L,OAAO9L,IAAU,gBAAgBgS,KAAKhS,EACjD,CAjB0BmkH,CAAiBtC,GA1CT,SAC9BuC,EACAL,EACAtB,GAEA,IAAM4B,EAAqBN,EACrB,EACAf,EAAWoB,EAAUA,EAAU5qH,OAAS,IAE9C,GAAI6qH,EAAoB,CACpB,IACM1B,EAxFgB,SAACnvG,EAAcivG,GACzC,IAAK94G,MAAMpD,SAASiN,IAChB,OAAO,EACJ,GAAI,UAAUxB,KAAKwB,GAAO,CAC7B,GAC2B,IAAtBivG,GACGQ,EAAgBt4G,QAAQ83G,IAAsB,GAC9CW,EAAkBz4G,QAAQ6I,EAAK,KAAO,IACxCivG,GAA8B,MAATjvG,EAEvB,OAAO,EACJ,GACmB,IAAtBivG,IACEA,GAA8B,MAATjvG,EAEvB,OAAO,OAER,GAAI,UAAUxB,KAAKwB,GAAO,CAC7B,GAC0B,GAArBivG,GACGS,EAAgBv4G,QAAQ83G,IAAsB,GAC9CY,EAAkB14G,QAAQ6I,EAAK,KAAO,IACxCivG,GAA8B,MAATjvG,EAEvB,OAAO,EACJ,GACkB,GAArBivG,IACEA,GAA8B,MAATjvG,EAEvB,OAAO,EAGnB,CAwD8B8wG,CADPP,EAAsBK,EAAU1nH,MAAM,GAAI,GAAK0nH,EAAU1nH,MAAM,GAAI,GAC9B+lH,GACpD,OAAOE,EAAgBW,EAAmBX,GAAe0B,QAAsBhpH,EAGvF,CA4BUkpH,CACIT,EACAC,EACAE,EAAkBxB,OAAoBpnH,QAE1CA,EACN,OAAOsnH,EACX,qGCvKA,eACA,WACA,WAkBA,0BACY,KAAAx3F,OAAyB,KACzB,KAAA4jB,SAAgC,KAChC,KAAAy1E,4BAA6B,CA0HzC,QArHI,YAAAl8E,QAAA,WACI,MAAO,MACX,EAQA,YAAAC,WAAA,SAAWpd,GAAX,WACItxB,KAAKsxB,OAASA,EACVA,EAAOw6D,iBAAiBttB,YACxBx+D,KAAKk1C,SAAWl1C,KAAKsxB,OAAO6pD,eAAe,CACvCyvC,YAAa,CACTrvC,eAAgB,SAAAhoD,GAAK,SAAKs3F,uBAAuBv5F,EAAQiC,EAApC,KAIrC,EAOA,YAAAya,QAAA,iBACIhuC,KAAKsxB,OAAS,KACD,QAAb,EAAAtxB,KAAKk1C,gBAAQ,cAAbl1C,MACAA,KAAKk1C,SAAW,IACpB,EAQA,YAAAtG,cAAA,SAAcC,GACN7uC,KAAKsxB,QAEI,YADDud,EAAMC,WAEN9uC,KAAKqnH,mBAAmBrnH,KAAKsxB,OAAQud,EAIrD,EAEQ,YAAAw4E,mBAAR,SAA2B/1F,EAAiBud,GACxC,IAAMiX,EAAWjX,EAAMiX,SAEvB,IAAKA,EAASonC,mBAAqBr+C,EAAMy4E,qBACrC,OAAQxhE,EAASz+C,KACb,IAAK,YACL,IAAK,UAGD,IAAAyjH,gBAAex5F,EAAQw0B,GACvB,MAEJ,IAAK,OACD,IAAAilE,aAAYz5F,EAAQw0B,GACpB,MACJ,IAAK,eACGx0B,EAAOw6D,iBAAiBttB,YACxBx+D,KAAK2qH,4BAA6B,GAEtC,MAGJ,SACI,IAAAK,eAAc15F,EAAQw0B,GAItC,EAEQ,YAAA+kE,uBAAR,SAA+Bv5F,EAAiBw0B,GAG5C,GACK9lD,KAAK2qH,4BACJ7kE,aAAoBmlE,aACtBnlE,EAASonC,iBAHb,CAOAltF,KAAK2qH,4BAA6B,EAElC,IAAIO,GAAU,EACd,OAAQplE,EAASuX,WACb,IAAK,wBACD6tD,GAAU,IAAAJ,gBACNx5F,EACA,IAAI65F,cAAc,UAAW,CACzB9jH,IAAK,YACL+jH,QAlHF,EAmHEhzF,MAnHF,KAsHN,MACJ,IAAK,uBACD8yF,GAAU,IAAAJ,gBACNx5F,EACA,IAAI65F,cAAc,UAAW,CACzB9jH,IAAK,SACL+jH,QA3HL,GA4HKhzF,MA5HL,MAkIP8yF,GACAplE,EAAS1uB,iBAEjB,EACJ,EA7HA,GAAa,EAAA1K,WAAAA,iHCpBb,eAMa,EAAA2+F,uBAA8C,SAAA9iD,GACvD,GAA4B,cAAxBA,EAAQE,aAOZ,IAHM,MAAwBF,EAAQI,YAA9BjjC,EAAS,YAAEwF,EAAM,SAGhBxrC,EAFKgmC,EAAUkF,SAAS95B,QAAQo6B,GAEpB,EAAGxrC,GAAK,EAAGA,IAAK,CACjC,IAAMyoC,EAAUzC,EAAUkF,SAASlrC,GAEnCyoC,EAAQ/B,YAAa,GAEjB,IAAAqxD,eAAc/xD,EAAWyC,EAASogC,EAAQqzB,iBAC1CrzB,EAAQE,aAAe,SAGnC,6JCvBA,eACA,WACA,WACA,WAcA,SAAS6iD,EAA4BvsF,GACjC,OAAO,SAAAwpC,SACH,GAA4B,cAAxBA,EAAQE,aAAZ,CAIA,IAAMszB,EAAyB,WAAbh9D,EACZ,EAA4CwpC,EAAQI,YAAlDjjC,EAAS,YAAEwF,EAAM,SAAEh9B,EAAI,OAAEi5D,EAAY,eACvCv8B,EAAWlF,EAAUkF,UAsGnC,SAAiBA,WACb,GAAkD,OAAjB,QAA7B,EAAAA,EAASA,EAASjrC,OAAS,UAAE,eAAEuoC,aAAqB,CACpD,IAAMqjF,EAAoB3gF,EAASka,QAAO,SAAAl7C,GAAK,MAAiB,mBAAjBA,EAAEs+B,WAAF,IAEqB,OAAjB,QAA/C,EAAAqjF,EAAkBA,EAAkB5rH,OAAS,UAAE,eAAEuoC,cACjD0C,EAASl8B,MAGrB,CA5GQ88G,CAAQ5gF,GAER,IAEI+6D,EACA5qF,EAHE5U,EAAQykC,EAAS95B,QAAQo6B,IAAW6wD,EAAY,GAAK,GACrD8J,EAAkBj7D,EAASzkC,GAIjC,GAAI0/F,GACI,IAAApO,eAAc/xD,EAAWmgE,EAAiBt9B,EAAQqzB,cAAe78D,KACjEwpC,EAAQE,aAAe,cAIvB,IAAAN,yBAAwBziC,SAEzB,GAiEf,SACIq2D,EACAnxD,EACAlF,EACAx3B,GAEA,OACK6tF,GACkB,GAAnBnxD,EAASjrC,QACkB,mBAA3BirC,EAAS,GAAG1C,aACZxC,EAAUpV,OAAOggC,YACjB5jD,SAASg5B,EAAUpV,OAAOggC,cAC1B,IAAAmW,mCAAkCv4D,EAAM,CAAC,WAAY,aAAc,CAAC,cAAgB,CAE5F,CA9EYu9G,CAAuB1vB,EAAWnxD,EAAUlF,EAAWx3B,KACtD6M,EA0Db,SAAiB7M,GACb,IAAMw9G,EAAax9G,EAAKA,EAAKvO,OAAS,GACtC,MAAoC,YAA7B+rH,EAAW3mF,eAA+B2mF,EAAa,IAClE,CA7DoBC,CAAQz9G,KAEhB,IAAAq1D,qBAAoBxoD,EAAM,WAC1BwtD,EAAQE,aAAe,aACpB,GAAKk9B,GAAgB,IAAAimB,qBAAoB19G,EAAMw3B,EAAWq2D,GAAa,CAClE,IAAAl3D,EAAgC8gE,EAAa,MAAtC,EAAyBA,EAAa,KAAhCkmB,EAAmBlmB,EAAa,eAE9B,aAAnB9gE,EAAMU,WACFsmF,GAEI,IAAAp0B,eAAc5yD,EAAOgnF,EAAgBtjD,EAAQqzB,cAAe78D,KAC5DwpC,EAAQE,aAAe,UAGvBszB,EACAxzB,EAAQyO,cAAgBnyC,GAEsC,OAAjB,QAAzC,EAAAA,EAAM+F,SAAS/F,EAAM+F,SAASjrC,OAAS,UAAE,eAAEuoC,cAC3CrD,EAAM+F,SAASl8B,MAGnB65D,EAAQI,YAAc,CAClBz9B,OAAM,EACNxF,UAAWb,EACX32B,KAAI,EACJi5D,aAAY,GAEhBoB,EAAQyO,cAAgBtxC,SACjBb,EAAM7J,eAGjButC,EAAQE,aAAe,SAI3BF,EAAQuzB,iBAAmB30B,IAGvB,IAAAuwB,aACI,EAAK,GAAG9yD,OACRC,OACArjC,EACA+mE,EAAQqzB,cACR78D,KAGJwpC,EAAQE,aAAe,cAO/BF,EAAQE,aAAe,kBAE/B,CACJ,CAwCa,EAAAqjD,gCAAkCR,EAA4B,WAK9D,EAAAS,iCAAmCT,EAA4B,+GCjJ5E,eAMa,EAAAU,WAAkC,SAAAzjD,GACrC,MAA8BA,EAAQI,YAApCjjC,EAAS,YAAEwF,EAAM,SAAEh9B,EAAI,OAE/B,GAA4B,mBAAxBq6D,EAAQE,cAA6D,cAAxBF,EAAQE,aAA8B,CACnF,IAAMtiE,GAAQ,IAAAsgE,mCAAkCv4D,EAAM,CAAC,WAAY,cAC7DiH,EAAOjH,EAAK/H,GAEdA,GAAS,GACTu/B,EAAUkF,SAAS,IAAMM,GACF,YAAvB/1B,EAAK4vB,iBACyB,GAA7BW,EAAUkF,SAASjrC,QACc,GAA7B+lC,EAAUkF,SAASjrC,QAAoD,MAArC+lC,EAAUkF,SAAS,GAAG1C,eAE7D/yB,EAAKu0B,OAAS,GACd6+B,EAAQE,aAAe,SAGnC,kKCvBA,WACA,WAsBA,SAASwjD,EAAuBltF,GAC5B,OAAO,SAAAwpC,GACH,GAA4B,cAAxBA,EAAQE,aAWZ,IAPM,MAAwBF,EAAQI,YAA9Bz9B,EAAM,SAAExF,EAAS,YACnB8mE,EAAa9mE,EAAUkF,SAAS95B,QAAQo6B,GACxCghF,EAA0B,WAAbntF,EAEbtkB,EAiEd,SACIirB,EACAstD,EACAm5B,EACA5jD,4FAEM9H,EAAO0rD,EAAU,GAAK,EACtBvhF,EAAWlF,EAAUkF,SACrBk7D,GAAqB,IAAArI,uBAAsB/3D,EAAUpV,OAAOqS,YAEzDjjC,EAAIszF,EAAcvyB,wBAAM/gE,GAAK,GAAKA,EAAIkrC,EAASjrC,QAAM,qBACpDwoC,EAAUyC,EAASlrC,IAETwoC,iBACP,uBAyCA,wBAcA,kDArDOyE,EAAIw/E,EAAU,EAAIhkF,EAAQxuB,KAAKha,OAAS,0BAC5CgtC,GAAK,GAAKA,EAAIxE,EAAQxuB,KAAKha,QAGrB6J,EAAI2+B,EAAQxuB,KAAKgzB,GACjBy/E,GAAc,IAAAv+C,eAAcrkE,GAC5B6iH,GAAQ,IAAAv+C,SAAQtkE,GAGlB,GAAM,CAAE4iH,YAAW,EAAEC,MAAK,EAAE1yG,MAFlByyG,IAAgBC,KANG,aAQjC,GAAI,SAAoC,CAWpC,GARAl/C,GAFIA,EAAUhlC,EAAQxuB,MAEJvT,UAAU,EAAGumC,GAAKwgC,EAAQ/mE,UAAUumC,EAAI,GAErDm5D,IACD34B,GAAU,IAAAyqB,eAAczqB,EAASg/C,IAGrC5jD,EAAQE,aAAe,SAEnB0E,EAaA,OANAviC,EAAS/5B,OAAOnR,EAAG,GAEf+gE,EAAO,IACP/gE,GAAK+gE,GAGT,MAZAt4B,EAAQxuB,KAAOwzD,EAEX1M,EAAO,IACP9zB,GAAK8zB,2BAtBjB9zB,GAAK8zB,eAmCT,oBAII,SAAM,CAAE2rD,aAAa,EAAMC,OAAO,EAAO1yG,MAAM,WAUnD,OAVI,WAEAixB,EAAS/5B,OAAOnR,EAAG,GAEf+gE,EAAO,IACP/gE,GAAK+gE,GAGT8H,EAAQE,aAAe,SAE3B,cAGA,qBAGA,MAAO,CAAP,EAAO,qBA/D6C/oE,GAAK+gE,gBAmErE,MAAO,CAAP,EAAO,UA9Ic6rD,CAAgB5mF,EAAW8mE,EAAY0f,EAAY3jD,GAChEgkD,EAAO9xG,EAAS0yF,OAEXrsG,EAAQ,EAAgC,GAATA,IAAiCyrH,EAAKC,MAAQ,CAC5E,MAA+BD,EAAK1rH,MAAlCurH,EAAW,cAAEC,EAAK,QAAE1yG,EAAI,OAMhC,OAAQ7Y,GACJ,KAAK,EACDA,EAAQurH,EACF,EACAD,EACA,EACA,EACNG,EAAO9xG,EAAS0yF,MAAK,GACrB,MAEJ,KAAK,EACG+e,GAAcG,GACdvrH,EAAQ,EACRyrH,EAAO9xG,EAAS0yF,MAAK,IACdif,EACPG,EAAO9xG,EAAS0yF,MAAK,GAErBrsG,EAAQ,EAEZ,MAEJ,KAAK,EACGorH,GAAcG,GACdvrH,EAAQ,EACRyrH,EAAO9xG,EAAS0yF,MAAK,IACdxzF,EACP4yG,EAAO9xG,EAAS0yF,MAAK,GAErBrsG,EAAQ,EAEZ,MAEJ,KAAK,EACGsrH,IAAgBC,EAChBvrH,EAAQ,EAERyrH,EAAO9xG,EAAS0yF,MAAK,GAEzB,MAEJ,KAAK,EACGkf,EACAE,EAAO9xG,EAAS0yF,MAAK,GACdif,GACPtrH,EAAQorH,EAAa,EAA0B,EAC/CK,EAAO9xG,EAAS0yF,MAAK,IAErBrsG,EAAQorH,EAAa,EAAsB,GAK/D,CACJ,CAqFa,EAAAO,2BAA6BR,EAAuB,WAKpD,EAAAS,4BAA8BT,EAAuB,iLC1LlE,eAYA,qCACI36F,EACA9oB,EACAs9C,EACAhgD,EACAyiE,GAKA,OAHAA,EAAQsK,kBAAmB,EAC3BtK,EAAQ4V,iBAAkB,EAElBr4E,GACJ,IAAK,aAKD,OAHAyiE,EAAQ4V,iBAAkB,GAGnB,EAEX,IAAK,kBAGD,OADAr4B,EAAS1uB,kBACF,EAEX,IAAK,QACL,IAAK,aAgBD,OAdA0uB,EAAS1uB,kBACT,IAAAwxC,uBAAsBpgE,GAER,SAAV1C,IAEAyiE,EAAQsK,kBAAmB,GAK/BvhD,EAAOyzB,aAAa,wBAAyB,CACzCe,SAAQ,KAGL,EAEnB,EAKA,4BAAiCA,EAAyBwY,GACtD,OACKA,GAASxY,EAASmnC,SAAWnnC,EAASsnC,UACrC9uB,GAASxY,EAASC,UAAYD,EAASmnC,MAEjD,EAKA,yCAA8CnnC,GAC1C,OAAOA,EAASsnC,UAAYtnC,EAASmnC,MACzC,2HCvEA,WAIA,WAqBa,EAAA0/B,kBAAyC,SAAApkD,GAC1C,IAAAE,EAAiBF,EAAO,aAChC,GACoB,mBAAhBE,GACgB,cAAhBA,GACgB,SAAhBA,EACF,CACU,IAAAE,EAA+BJ,EAAO,YAAzBqzB,EAAkBrzB,EAAO,cACtCr6D,EAASy6D,EAAW,KACtB7iB,EAAW81C,aAAa,EAAbA,EAAe91C,SAC1B3/C,GAAQ,IAAAsgE,mCAAkCv4D,EAAM,CAAC,YAAa,CAAC,cAE/D,EAAWA,EAAK/H,GAChBw+F,EAAaz2F,EAAK/H,EAAQ,GAEhC,GAAI,GAAwC,aAA5B,EAAS4+B,eAA+B,CACpD,IAAMijF,EAAYrjB,EAAW//D,OAAO9zB,QAAQ,GACtCu3D,EAAYs8B,EAAW//D,OAAOojF,EAAY,GAChD,GAAoB,SAAhBv/C,GAA2BJ,EAAW,EACtC,IAAAO,uBAAsB+7B,GACtB,IAAMioB,EAAejoB,EAAW//D,OAAOojF,EAAY,GACnD,IACI,IAAAtjD,oBAAyCkoD,EAAc,aACvDA,EAAaljF,OAAO,GACtB,CACEkjF,EAAaljF,OAAO5kC,SAAQ,SAAC2O,EAAOtN,GAChCsN,EAAM6c,OAAOmQ,yBAAsBj/B,EACnCiS,EAAMqmB,QAAU,EAAS4P,OAAOvjC,GAC1B,EAASujC,OAAOvjC,GAAO2zB,QACvB,CAAC,CACX,IACA,IAAMk9C,EAAgB,EAASpyC,OAAO,EAASA,OAAOjlC,OAAS,GACzDspE,EAAgB2jD,EAAahoF,OAAO,GAEV,cAA5BqkC,EAAc1jC,WACc,cAA5ByxC,EAAczxC,WAEV,oBADJyxC,EAAcpsC,SAASosC,EAAcpsC,SAASjrC,OAAS,GAAGuoC,cAG1D8uC,EAAcpsC,SAASl8B,MAEvBu6D,EAAcr+B,SAASv8B,SACnB,IAAA+6D,uBAAsBT,EAAYz9B,OAAO5a,UAGjDi4C,EAAQyO,mBAAgBx1E,OAEJ,UAAjBinE,IACHokD,EAAgB,GAChB,EAASnjF,OAAOh7B,MAEhBo+G,EAAkBvkD,EAAS,EAAUo8B,IAG7C7+C,SAAAA,EAAU1uB,iBACVmxC,EAAQE,aAAe,SAGnC,EAEA,IAAMokD,EAAkB,SAAC1nF,GACrB,OAC+B,IAA3BA,EAASP,OAAOjlC,QACiB,cAAjCwlC,EAASP,OAAO,GAAGW,WACoB,IAAvCJ,EAASP,OAAO,GAAGgG,SAASjrC,QACmB,oBAA/CwlC,EAASP,OAAO,GAAGgG,SAAS,GAAG1C,aACgB,OAA/C/C,EAASP,OAAO,GAAGgG,SAAS,GAAG1C,WAEvC,EAEM4kF,EAAoB,SACtBvkD,EACApjC,EACAw/D,GAEQ,IAAAh8B,EAAgBJ,EAAO,YACzBy/C,EAAYrjB,EAAW//D,OAAO9zB,QAAQq0B,GACtCm9D,EAAeyqB,EAAmBpkD,GAElCj/B,EAASsjF,EAAmB7nF,GAC5BinC,GAAc,IAAAC,gBAAe3iC,EAAQi/B,EAAYz9B,OAAO5a,QAC9D87C,EAAYxnC,OAAOpgC,KAAK89F,GACxB35B,EAAYjjC,UAAY48D,EACxB/5B,EAAQyO,cAAgBsrB,EACxBqC,EAAW//D,OAAO/zB,OAAOm3G,EAAY,EAAG,EAAG57C,EAC/C,EAEM4gD,EAAqB,SAAC7nF,GACxB,OAAOA,EAASuE,OAAOxkC,KAAI,SAAAuO,GACvB,OAAO,IAAA8xD,iBACH9xD,EAAMs2B,UAAQ,gCAEPt2B,EAAM6c,QAAM,CACfmQ,yBAAqBj/B,IAEzBiS,EAAMqmB,QAEd,GACJ,EAEMizF,EAAqB,SAACpkD,SAChBjjC,EAAsBijC,EAAW,UAAtBz9B,EAAWy9B,EAAW,OACnC25B,GAAe,IAAAp5B,kBACjB,EACAxjC,EAAUpV,OACVoV,EAAUoF,eAGRkoD,EAActtD,EAAUkF,SAAS95B,QAAQo6B,GACzCN,EAAWlF,EAAUkF,SAAS/5B,OAChCmiF,EACAttD,EAAUkF,SAASjrC,OAASqzF,GAahC,OAVA,EAAAsP,EAAa13D,UAASpmC,KAAI,4CAAIomC,IAAQ,KAEtC,IAAAu9B,yBAAwBziC,GAEpBA,EAAUkF,SAASm7B,OAAM,SAAAn8D,GAAK,MAAiB,mBAAjBA,EAAEs+B,WAAF,KAC9BxC,EAAUkF,SAASpmC,MAAK,IAAA2kE,UAASj+B,EAAO5a,UAG5C,IAAAgwF,oBAAmBhe,GAEZA,CACX,yGCtJA,eACA,WACA,WACA,WACA,WAKA,WAIA,WAaA,0BAA+BhxE,EAAiBw0B,GAC5C,IAAIolE,GAAU,EAwBd,OAkBJ,SAAsC7/D,EAAgCvF,GAClE,GAAKuF,EAEE,IAAsB,SAAlBA,EAAUn0B,MAAoBm0B,EAAUtV,MAAME,UAElD,CACH,IAAMF,EAAQsV,EAAUtV,MAGxB,SACI,IAAA4sC,cAAa5sC,EAAM4nC,eAAgB,gBAClC,IAAAwO,eAAcrmC,KAM3B,SAAyBA,EAAyB/P,GAC9C,MAAuB,aAAhB+P,EAASz+C,KAAsB0uC,EAAM8nC,YAAc,CAC9D,CAPaovC,CAAgBnnE,EAAU/P,IASvC,SAAwB+P,EAAyB/P,WAC7C,MACoB,UAAhB+P,EAASz+C,KACT0uC,EAAM8nC,aAAqD,QAAtC,EAA8B,QAA9B,EAAA9nC,EAAM4nC,eAAetuB,iBAAS,eAAE1vD,cAAM,QAAI,GAAK,CAE5E,CAdiDutH,CAAepnE,EAAU/P,KARlE,OAAO,EAFP,OAAO,CAaf,CAtDQo3E,CAFc77F,EAAO0kB,kBAEmB8P,IACxCx0B,EAAOiiC,oBACH,SAAC/qD,EAAO+/D,GACJ,IAAMziE,GAAS,IAAA4iE,iBACXlgE,EAoBpB,SAAwBs9C,EAAyBwY,GAC7C,IAAMy9B,EAA4B,UAAhBj2C,EAASz+C,IAW3B,MAAO,EATH,IAAA+lH,+BAA8BtnE,KAAci2C,EAAY,EAAAsvB,uBAAyB,MACzD,IAAAgC,kBAAiBvnE,EAAUwY,GACjDy9B,EACI,EAAA0wB,2BACA,EAAAC,4BACJ,KAC2B3wB,EAC3B,EAAA+vB,gCACA,EAAAC,iCAC6E,EAAAC,WACvF,CAhCoBsB,CAAexnE,IAAYx0B,EAAOw6D,iBAAiBxtB,OACnDiK,GACFE,aAGF,OADAyiD,GAAU,IAAAqC,2BAA0Bj8F,EAAQ9oB,EAAOs9C,EAAUhgD,EAAQyiE,EAEzE,GACA,CACIziB,SAAQ,EACRotB,aAAc,EAAAC,aAAawH,SAC3BtH,cAAe,WAAM,OAAAvtB,EAAS1tB,KAAT,EACrBk5C,QAAyB,UAAhBxrB,EAASz+C,IAAkB,kBAAoB,uBAK7D6jH,CACX,wGCpDA,eACA,WACA,WAMA,yBAA8B55F,EAAiBw0B,GAC3C,IAAMuF,EAAY/5B,EAAO0kB,kBAEzB,GAuCJ,SAAqCqV,EAAgCvF,GACjE,QAAKuF,MAGA,IAAA8gC,eAAcrmC,IACE,SAAhBA,EAASz+C,KAAkC,SAAhBy+C,EAASz+C,KAAyC,GAAvBy+C,EAASz+C,IAAI1H,UAG9C,SAAlB0rD,EAAUn0B,OACTm0B,EAAUtV,MAAME,WACjBu3E,EAAqBniE,EAAWvF,GAK5C,CAtDQ2nE,CAA4BpiE,EAAWvF,GA+BvC,OA9BAx0B,EAAOsuC,eAEPtuC,EAAOiiC,oBACH,SAAC/qD,EAAO+/D,SACEziE,GAAS,IAAA4iE,iBAAgBlgE,EA8B/C,SAAuB6iD,EAAgCvF,GACnD,OAAO0nE,EAAqBniE,EAAWvF,GAAY,CAAC,EAAA6mE,mBAAqB,EAC7E,CAhCsDe,CAAcriE,EAAWvF,GAAWyiB,GAS1E,OALAA,EAAQ4V,iBAAkB,EAG1B5V,EAAQsK,kBAAmB,EAEA,SAAvB/sE,EAAO2iE,eAEPF,EAAQ0J,iBAAqC,QAAlB,EAAAnsE,EAAO6iE,mBAAW,eAAEz9B,OAAO5a,QAEtD,IAAAs4C,uBAAsBpgE,IAGf,EAIf,GACA,CACIs9C,SAAQ,KAIT,CAEf,EAuBA,IAAM0nE,EAAuB,SAACniE,EAAgCvF,GAC1D,OAAOuF,GAA+B,SAAlBA,EAAUn0B,MAAmC,SAAhB4uB,EAASz+C,MAAmBy+C,EAASsmC,QAC1F,sGCrEA,eACA,UACA,WACA,WAUA,uBAA4B96D,EAAiBw0B,GACzC,IAAMuF,EAAY/5B,EAAO0kB,kBAEzB,GAAuB,UAAnBqV,aAAS,EAATA,EAAWn0B,MAUX,OATA5F,EAAOiiC,oBACH,SAAA/qD,GACI,OAehB,SAAmBA,EAA6Bs9C,GAC5C,IAAMlhB,GAAS,IAAAk/B,sBAA2Ct7D,EAAO,CAAC,YAAa,CAAC,cAC1Eq8B,EAAQD,EAAOjlC,OAAS,EAAIilC,EAAO,GAAGC,WAAQrjC,EACpD,OAAIojC,EAAOjlC,OAAS,IAChB,IAAA4jE,qBAAoB/6D,EAAOs9C,EAASsmC,SAAW,UAAY,UAC3DtmC,EAAS1uB,kBACF,GACqB,eAArByN,aAAK,EAALA,EAAOU,YACP,IAAAooF,sBAAqBnlH,EAAOq8B,EAAOihB,MACnC,IAAA4e,oBAAyC7/B,EAAO,cAChD,IAAA+oF,iBAAgBplH,EAAOq8B,EAAOihB,EAG7C,CA5BuB+nE,CAAUrlH,EAAOs9C,EAC5B,GACA,CACIwrB,QAAS,kBAIV,CAEf,yGC5BA,eACA,WAQA,2BACI9oE,EACA28B,EACA2gB,GAEA,IAAMgoE,EAqBV,SAA+B3oF,GAC3B,OAAOA,EAASP,OAAOkgB,QACnB,SAAAjgB,GACI,MAAmB,aAAnBA,EAAMU,WAA4BV,EAAM+F,SAASiC,MAAK,SAAA1E,GAAW,OAAAA,EAAQ/B,UAAR,GAAjE,GAEZ,CA1B8B2nF,CAAsB5oF,GAChD,OAaJ,SAAgCA,GAC5B,MACoC,aAAhCA,EAASP,OAAO,GAAGW,WAC2B,mBAA9CJ,EAASP,OAAO,GAAGgG,SAAS,GAAG1C,WAEvC,CAjBS8lF,CAAuB7oF,IACI,GAA5B2oF,EAAkBnuH,QACiB,cAAnCmuH,EAAkB,GAAGvoF,YAIrB,IAAAg+B,qBAAoB/6D,EAAOs9C,EAASsmC,SAAW,UAAY,UAC3DtmC,EAAS1uB,kBACF,IAJA,IAAAu2F,sBAAqBnlH,EAAOslH,EAAkB,GAAIhoE,EAMjE,+GC1BA,eACA,WAGMmoE,EAAY,OAkBlB,gCACIzlH,EACAk9B,EACAogB,GAEA,IAAMooE,EAAmBxoF,EAAUkF,SAASka,QAAO,SAAA3c,GAAW,OAAAA,EAAQ/B,UAAR,IACxD+nF,EAC0B,IAA5BD,EAAiBvuH,QAAoD,oBAApCuuH,EAAiB,GAAGhmF,YACnDkmF,EAAgB1oF,EAAUkF,SAASm7B,OAAM,SAAA59B,GAAW,OAAAA,EAAQ/B,UAAR,IAC1D,GAA2C,oBAAtCV,EAAUkF,SAAS,GAAG1C,aAAqCimF,GAAgBC,GAC5E,IAAA7qD,qBAAoB/6D,EAAOs9C,EAASsmC,SAAW,UAAY,eAE3D,GAAK+hC,EA4BE,CACH,IAAMn7B,EAActtD,EAAUkF,SAASgiC,WACnC,SAAAzkC,GAAW,MAAwB,oBAAxBA,EAAQD,WAAR,IAEf,GAAK4d,EAASsmC,UAOV,GAA2B,SAFrBiiC,EAAU3oF,EAAUkF,SAASooD,EAAc,IAErC9qD,YAAuB,CAC/B,IAAMomF,EAAqBD,EAAQ10G,KAAKha,OAFpBsuH,EAGpB,GAAII,EAAQ10G,OAASs0G,EACjBvoF,EAAUkF,SAAS/5B,OAAOmiF,EAAc,EAAG,OACxC,IAAIq7B,EAAQ10G,KAAKvT,UAAUkoH,KAAwBL,EAGtD,OAAO,EAFPI,EAAQ10G,KAAO00G,EAAQ10G,KAAKvT,UAAU,EAAGkoH,SAZ7B,CACpB,IAAMngC,EAAezoD,EAAUkF,SAASooD,GAAa1iE,OAC/C+9F,GAAU,IAAAjhD,YAAW6gD,EAAW9/B,GACtCzoD,EAAUkF,SAAS/5B,OAAOmiF,EAAa,EAAGq7B,QAnChC,CACd,IAAI,OAAgD7sH,EAChD,OAA+CA,EAUnD,GARAkkC,EAAUkF,SAAS9lC,SAAQ,SAACqjC,EAAShiC,GAC7BgiC,EAAQ/B,aACH,IACD,EAA4BjgC,GAEhC,EAA2BA,EAEnC,KACI,IAA6B,EAc7B,OAAO,EAbP,IAAMooH,EAAuB7oF,EAAUkF,SAAS,GAC1C4jF,GAAY,IAAAphD,YACdtnB,EAASsmC,SAAW6hC,EA5C1B,IA6CMM,EAAqBj+F,QAEnB4a,GAAS,IAAAk+B,uBAAsBmlD,EAAqBj+F,QAC1DoV,EAAUkF,SAAS/5B,OACf,EACA,EAA2B,EAA4B,EACvD29G,EACAtjF,GA+BhB,OADA4a,EAAS1uB,kBACF,CACX,6HCzFA,WAgCA,+BACIlpB,EACA22B,EACA4pF,GAIA,UAFM9nB,GAAU,EAAH,iCAAOz4F,IAAI,gBAGpB,IAAMy2B,EAAQgiE,EAAQ,GAChBxgG,EAAQw+B,EAAMC,OAAO9zB,QAAQ+zB,GAEnC,GAAI1+B,EAAQ,gBAIZ,IAAIkiE,EAAY1jC,EAAMC,OAAOz+B,GAASsoH,EAAS,GAAK,IAEpD,GAAIpmD,EAAW,CACX,KAA8B,cAAvBA,EAAU9iC,WAA2B,CACxC,IAAMk4B,EAAQ4K,EAAUzjC,OAAO6pF,EAAS,EAAIpmD,EAAUzjC,OAAOjlC,OAAS,GAEtE,IAAK89D,eACM,CAAE54B,MAAOwjC,EAAWn6D,KAAMy4F,IAC9B,GAAuB,cAAnBlpC,EAAMl4B,iBACbohE,EAAQt4F,QAAQg6D,UACT,CAAExjC,MAAO44B,EAAOvvD,KAAMy4F,IAE7BA,EAAQt4F,QAAQg6D,GAChBA,EAAY5K,eAIb,CAAE54B,MAAOwjC,EAAWn6D,KAAMy4F,IAC9B,IAAI,IAAA1+D,kBAAiBtD,GAAQ,CAGhCgiE,EAAQhqC,QAER,IAAI,GAAgB,EACd,EAAUh4B,EACVqtC,EAAiB,QAAV,EAAA20B,EAAQ,UAAE,eAAE/hE,OAAOkd,MAC5B,SAAAl4C,GAAK,MAAe,aAAfA,EAAE27B,YAA6B,EAAe37B,EAAEghC,SAAS95B,QAAQ,KAAa,CAA9E,IAGT,IAAIkhE,gBAEA,IAAM65C,EAAiB75C,EAAKpnC,SAAS,GAAgB6jF,EAAS,GAAK,IAEnE,GAAI5C,eAEO,CAAEhnF,MAAOmtC,EAAM9jE,KAAMy4F,EAASklB,eAAc,IAGnDhnF,EAAQmtC,MAMb,IAA4B,YAAxBrtC,EAAMI,gBAAwD,aAAxBJ,EAAMI,6BACnD4hE,EAAQhqC,QACR93B,EAAQF,IAtDTgiE,EAAQhnG,OAAS,GAAG,qEA4D3B,OAAO,IACX,wYCpGA,eAAS,iFAAA0tB,eAAe,IACxB,eAAS,6EAAAE,WAAW,IACpB,eAAS,4EAAAb,UAAU,IACnB,eAAS,kFAAAE,gBAAgB,IAEzB,eACI,8EAAA8hG,YAAY,IACZ,gFAAAC,cAAc,IACd,mFAAAC,iBAAiB,IACjB,qFAAAC,mBAAmB,IACnB,8EAAAC,YAAY,IACZ,+EAAAC,aAAa,IACb,8EAAAC,YAAY,IACZ,mFAAAC,iBAAiB,IACjB,gFAAAC,cAAc,IACd,mFAAAC,iBAAiB,IACjB,sFAAAC,oBAAoB,IACpB,sFAAAC,oBAAoB,IAExB,eAAS,gFAAA54F,cAAc,wJCnBvB,WACA,WACA,WAGM64F,EAAoB,0CACpBC,EAAoB,6CACpBC,EAAgB,kBAChBC,EAAmB,qBACnBC,EAAuB,oBA0E7B,SAAgBC,EAAat2G,EAAcsyF,GACvC,GAAItyF,EAAKhN,MAAMijH,GAAoB,CAC/B,IAAMM,EAAUjkB,EAAWt/F,MAAMmjH,GAEjCn2G,GADWu2G,EAAUA,EAAQ,GAAK,QACtBv2G,EAAO,QAEvB,GAAIA,EAAKhN,MAAMkjH,GAAoB,CAC/B,IAAMM,EAAalkB,EAAWt/F,MAAMojH,GAEpCp2G,GADcw2G,EAAaA,EAAW,GAAK,WAC5Bx2G,EAAO,WAG1B,OAAOA,CACX,CA/EA,yCACIw1B,EACA/c,EACAg+F,GAEQ,IAAAnrG,EAAwCkqB,EAAK,SAAnC88D,EAA8B98D,EAAK,WAAvBkP,EAAkBlP,EAAK,cAC/Cx1B,EAAO0kC,EAAc1kC,KAAOs2G,EAAa5xE,EAAc1kC,KAAMsyF,QAAcnqG,EAEjF,GAAI6X,GAAQ0kC,EAAc1kC,MAAQA,EAAM,CACpC,IAAMuI,GAAM,IAAI7F,WAAYiG,gBAAgB8P,EAAmBzY,GAAO,cACtE,IAAAqqE,gBAAe/+D,EAAU/C,aAAG,EAAHA,EAAKQ,MAIlC,IAAMgD,EAAaT,EAASS,YAExB,IAAAu9D,cAAav9D,EAAY,iBACH,OAAtBA,EAAW9B,SACX8B,EAAWA,YAEQ5e,MAAMsH,KAAKsX,EAAW9C,YAAYyjD,OAAM,SAACtI,GAExD,IAAMn6C,GAAU,IAAAq/D,cAAallB,EAAO,iBAAmBA,EAAMn6C,QAE7D,MAAkB,QAAXA,GAEU,SAAXA,GACAm6C,GAASr4C,EAAWiqE,SAE9B,KAGkBjqE,EAAWiqE,WACzBxgD,EAAMlqB,SAASorG,gBAAgB3qG,EAAWiqE,YAIlD,aAAUxgD,EAAMi9D,iBAAkB,aAAa,SAACx7E,EAAQzX,GAC/Ci3G,GAAyD,SAA9Bj3G,EAAQyV,MAAMo7C,cAC1Cp5C,EAAOs5C,aAAe8lD,EACtBp/F,EAAOi0C,WAAamrD,EACpBp/F,EAAOk0C,YAAckrD,EACrBp/F,EAAOq5C,UAAY+lD,EAE3B,KAEA,IAAAM,cAAanhF,EAAMi9D,iBAAkB,SAAS,SAACnnE,EAAO9rB,EAAS0vD,GAC3D,IAAMz9B,GAAgB,EAAH,eAAQy9B,EAAQz9B,eACN,cAAzBnG,EAAMI,gBAAkCJ,EAAMrU,OAAOQ,YACrDy3C,EAAQz9B,cAAcha,UAAY6T,EAAMrU,OAAOQ,WAGnDy3C,EAAQ40B,yBAAyB1/B,MAAM94B,EAAO9rB,EAAS0vD,GAE1B,cAAzB5jC,EAAMI,gBAAkCJ,EAAMrU,OAAOQ,YACrDy3C,EAAQz9B,cAAgBA,SACjBnG,EAAMrU,OAAOQ,UAE5B,GACJ,EAOA,qHCnFA,eACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UAkBA,aAQI,WAAoBg/F,GAAA,KAAAA,wBAAAA,EAPZ,KAAAx+F,OAAyB,IAOuB,CAoF5D,OA/EI,YAAAmd,QAAA,WACI,MAAO,OACX,EAQA,YAAAC,WAAA,SAAWpd,GACPtxB,KAAKsxB,OAASA,CAClB,EAOA,YAAA0c,QAAA,WACIhuC,KAAKsxB,OAAS,IAClB,EAQA,YAAAsd,cAAA,SAAcC,GACV,GAAK7uC,KAAKsxB,QAA6B,eAAnBud,EAAMC,WAIrBD,EAAMi9D,iBAAX,CAIA,IAAMmkB,GAAc,IAAAC,gBAAerhF,GAAO,GACpCoxC,EAAYpxC,EAAMoxC,UAExB,OAAQgwC,GACJ,IAAK,eACD,IAAAE,qCAAoCthF,EAAO7uC,KAAKsxB,OAAOsmB,yBACvD,MACJ,IAAK,iBACD,IAAAw4E,mCAAkCvhF,GAClC,MACJ,IAAK,cACL,IAAK,eACiB,WAAdoxC,GAAwC,gBAAdA,IAE1B,IAAAowC,+BACIxhF,EACA7uC,KAAKsxB,OAAOsmB,wBACZ53C,KAAK8vH,yBAGb,MACJ,IAAK,eACDjhF,EAAMi9D,iBAAiBpP,sBAAsBl4F,KACzC,EAAA8rH,mBAAmBC,wBAEvB,MACJ,IAAK,qBACD,IAAAC,oCAAmC3hF,EAAO7uC,KAAKsxB,OAAOsmB,0BAI9D,aAAU/I,EAAMi9D,iBAAkB,OAAQ,EAAA2kB,YAC1C,aAAU5hF,EAAMi9D,iBAAkB,YAAa,EAAA4kB,8BAC/C,aAAU7hF,EAAMi9D,iBAAkB,YAAa6kB,IAC/C,aAAU9hF,EAAMi9D,iBAAkB,QAAS,EAAA4kB,6BAEzB,gBAAdzwC,KACA,aAAUpxC,EAAMi9D,iBAAkB,QAAS8kB,IAC3C,aAAU/hF,EAAMi9D,iBAAkB,YAAa8kB,IAEvD,EACJ,EA5FA,GAAa,EAAArjG,YAAAA,EAkGb,IAAMqjG,EAA4D,SAC9DtgG,EACAzX,GAEIA,EAAQyV,MAAM2C,wBACPX,EAAOW,eAEtB,EAEM4/F,EAAoB,IAAI1+E,IAO5B,CACE,CAAC,YAAa,CAAEplC,EAAG,iBAAkB3M,EAAG,iBAAkBoJ,EAAG,mBAC7D,CAAC,cAAe,CAAEuD,EAAG,mBAAoB3M,EAAG,mBAAoBoJ,EAAG,qBACnE,CAAC,eAAgB,CAAEuD,EAAG,oBAAqB3M,EAAG,oBAAqBoJ,EAAG,sBACtE,CAAC,aAAc,CAAEuD,EAAG,kBAAmB3M,EAAG,kBAAmBoJ,EAAG,sBAGpE,SAASmnH,EAAkBrgG,EAAqCzX,GAC5D,EAAAuvF,WAAWtjG,SAAQ,SAAAuC,GACf,IAAKipB,EAAOjpB,GAAM,CACd,IAAMypH,EAAWD,EAAkBzhH,IAAI/H,GAEnCypH,GACAj4G,EAAQyV,MAAMwiG,EAAS/jH,IACvB8L,EAAQyV,MAAMwiG,EAAS1wH,KACtByY,EAAQyV,MAAMwiG,EAAStnH,KAExB8mB,EAAOjpB,GAAUwR,EAAQyV,MAAMwiG,EAAS/jH,GAAE,IAAI8L,EAAQyV,MAAMwiG,EAAS1wH,IAGjF,GACJ,6HClKA,eASA,8CACIyuC,EACA/c,GAEQ,IAAAnN,EAA4BkqB,EAAK,SAAvBkP,EAAkBlP,EAAK,cAEzC,GAAIkP,EAAc1kC,OAAS0kC,EAAcpkC,MAAQokC,EAAcvV,MAAO,CAGlE,IAAM5mB,GAAM,IAAI7F,WAAYiG,gBACxB8P,EAAmBisB,EAAc1kC,MACjC,cAGJ,IAAAqqE,gBAAe/+D,EAAU/C,aAAG,EAAHA,EAAKQ,MAEtC,uYCtBa,EAAA2uG,uCAAmD,CAC5D,yBACA,0BACA,2BACA,4BACA,yBACA,uBAKS,EAAAC,kBAA4B,kBAI5B,EAAAC,kBAA4B,kBAI5B,EAAAC,aAAuB,iBAIvB,EAAAC,gBAA0B,oBAI1B,EAAAC,gBAA0B,iBAI1B,EAAAC,UAAoB,YAIpB,EAAAC,kCAA4C,uBAI5C,EAAAC,wBAAkC,uBAIlC,EAAAC,gCAA0C,0BAI1C,EAAAC,uBAAqB,uDAC3B,EAAAV,yCAAsC,IACzC,8BAKS,EAAAW,sBACT,cAAc,EAAAV,kBAAiB,OAAO,EAAAI,gBAAe,eAAe,EAAAH,kBAAiB,OAAO,EAAAG,gBAAe,SAAS,EAAAD,gBAAe,SAAS,EAAAD,aAAY,KAAK,EAAAK,wBAAuB,KAAK,EAAAC,gCAA+B,IACxN,EAAAT,uCAAuC7rH,KAAI,SAAAsE,GAAK,2BAAqBA,EAAC,IAAtB,IAA4B7D,KAAK,6IC3DrF,WACA,WACA,WACA,WAoBMgsH,EAAoB,CAAC,KAAM,KAAM,MACjCC,EAAwBD,EAAkBhsH,KAAK,KAiB/CksH,EAA6D,SAC/DvhG,EACAzX,GAEA,IAAM6pB,EAAgB7pB,EAAQyV,MAAMoU,cACd,UAAlBA,IACApS,EAAOiO,yBAA2B,SAEhB,QAAlBmE,IACApS,EAAOiO,yBAA2B,MAE1C,EAUMuzF,EAAqD,SACvDntF,EACA9rB,EACA0vD,GAEA,IAAMwpD,EAAal5G,EAAQyK,QAO3B,GALIzK,EAAQiJ,QAAQ,EAAA4vG,yBAChB74G,EAAQyV,MAAMqmE,eAAe,WAC7B97E,EAAQyV,MAAMqmE,eAAe,WAG7B97E,EAAQk4E,UAAU3R,SAAS,EAAAkyC,mCAC3B/oD,EAAQqoC,kBAAkBnzC,MAAM94B,EAAO9rB,EAAS0vD,QAIpD,IAAI,EAAAkpD,sBAAsB5kF,MAAK,SAAApe,GAAa,OAAA5V,EAAQk4E,UAAU3R,SAAS3wD,EAA3B,IAA5C,CAEO,GA0GX,SACIsjG,EACAl5G,EACA0vD,GAEA,OACIA,EAAQ0yB,WAAWvxD,OAAO/pC,OAAS,GACnCgyH,EAAkB5rD,OAAM,SAAArgD,GAAO,OAAAA,GAAOqsG,CAAP,MAC9Bl5G,EAAQs5E,QAAQy/B,EAEzB,CApHeI,CAAuBD,EAAYl5G,EAAS0vD,GAAU,CACrD,IAAA0yB,EAAe1yB,EAAO,WAC9B0yB,EAAWvxD,OAAS,GACpBuxD,EAAW0J,gBAAanjG,EAG5B+mE,EAAQ40B,yBAAyBtkF,QAAQ8rB,EAAO9rB,EAAS0vD,GAC7D,EAKM0pD,EAAyD,SAC3DttF,EACA9rB,EACA0vD,iBAEM90D,EAAQ/G,SAAgD,QAAvC,EAAAmM,EAAQiE,aAAa,0BAAkB,QAAI,IAC5Dm+E,EAAa1yB,EAAQ0yB,WACrBlxD,GACqD,QAAvD,EAAAkxD,EAAWvxD,OAAO6+B,EAAQ0yB,WAAWvxD,OAAO/pC,OAAS,UAAE,eAAEoqC,YAChC,QAAxB,EAAAlxB,EAAQs5E,QAAQ,gBAAQ,eAAE7uE,QAAQlX,eACjCk5D,GAAkC,IAAAC,iBAAgBx7B,EAAUw+B,EAAQi1B,aAK1E,IAJA,IAAA4F,aAAYvqF,EAAS0vD,EAAQ86B,cAAckR,gBAAiBjvC,EAASh1C,OAAQi4C,IAC7E,IAAA66B,aAAYvqF,EAAS0vD,EAAQ86B,cAAcjM,UAAW9xB,EAASh1C,OAAQi4C,GACvEA,EAAQ0yB,WAAWvxD,OAASuxD,EAAWi3B,mBAAqB3pD,EAAQ0yB,WAAWvxD,OAE3Ej2B,EAAQ,EACR,GAAIA,EAAQ80D,EAAQ0yB,WAAWvxD,OAAO/pC,OAClC,KAAO8T,GAAS80D,EAAQ0yB,WAAWvxD,OAAO/pC,QACtC4oE,EAAQ0yB,WAAWvxD,OAAOllC,KAAK8gE,QAGnCiD,EAAQ0yB,WAAWvxD,OAAO74B,OAAO4C,EAAO80D,EAAQ0yB,WAAWvxD,OAAO/pC,OAAS,GAC3E4oE,EAAQ0yB,WAAWvxD,OAAOj2B,EAAQ,GAAK6xD,EAIZ,QAAnC,KAAAiD,EAAQ40B,0BAAyByS,UAAE,gBAAGjrE,EAAO9rB,EAAS0vD,GAEtD,IAAMo8B,EAAa1J,EAAW0J,WAC9B,GAAIA,EAAY,CACZ,IAAMwtB,EAAYxtB,EAAW//D,OAAO+/D,EAAW//D,OAAOjlC,OAAS,GACpC,cAAvBwyH,EAAU5sF,WAAyD,YAA5B4sF,EAAUptF,gBAkH7D,SACIymC,EACA3yD,EACAu5G,GAEA,GAAK5mD,GAAyC,MAAzBA,EAAazhC,SAAlC,CAIA,IAAM70B,EAAO2D,EAAQs5E,QAAQ,MACvB8I,EAAam3B,EAAIn3B,WACjB,eAYV,SACI/lF,EACAC,GAEA,IAAMg3D,EACFh3D,GAAQ3O,MAAMsH,MAAKoH,aAAI,EAAJA,EAAM2sE,iBAAiB,QAAS,IAAI/wE,QAAQqE,GAKnE,MAAO,CAHHzI,UAASwI,aAAI,EAAJA,EAAM4H,aAAa,WAAY,MAAQqvD,GAAaA,EAAY,EAAIA,EAAY,GAC3Ez/D,UAASyI,aAAI,EAAJA,EAAM2H,aAAa,qBAAsB,IAGxE,CAvB+Bu1G,CAAwBn9G,EAAM2D,GAAQ,GAA1DpW,EAAK,KAAE20F,EAAS,KAElB6D,EAAWmZ,iBACZnZ,EAAWmZ,eAAiB,IAGhC,IAAMke,EAA6Br3B,EAAWmZ,eAAehd,GACzDk7B,GAAU7vH,EAAQ6vH,GAAU,IAC5B9mD,EAAal7C,OAAOmQ,oBAAsBh+B,GAE9Cw4F,EAAWmZ,eAAehd,GAAa30F,EAC3C,CAtIY8vH,CADqBJ,EAAUzoF,OAAOyoF,EAAUzoF,OAAO/pC,OAAS,GAC9BkZ,EAAS0vD,GAInD,IAAMiqD,EAAqC,GAC3Cv3B,EAAWvxD,OAAO5kC,SAAQ,SAAAuE,GACtB,IAAMkvB,EAAkC,CACpCuB,SAAS,EAAF,eAAOzwB,EAAEywB,SAChBxJ,QAAQ,EAAF,eAAOjnB,EAAEinB,QACfyZ,SAAU1gC,EAAE0gC,UAEhByoF,EAAUhuH,KAAK+zB,EACnB,IACA0iE,EAAWi3B,kBAAoBM,EAC/Bv3B,EAAWvxD,OAAS,EACxB,EAOM+oF,EAAmE,SACrEniG,EACAzX,GAE8B,UAA1BA,EAAQyV,MAAM0Q,UACd1O,EAAOotF,yBAAsBl8G,GAGjC8uB,EAAOggC,gBAAa9uD,CACxB,EAKMkxH,EAAoE,SACtEpiG,GAEAA,EAAOggC,gBAAa9uD,EACpB8uB,EAAO4zC,iBAAc1iE,CACzB,EAgCMmxH,EAA4D,SAC9DriG,EACAzX,IAGIA,EAAQ4V,UAAUs4D,SAAS,EAAAwqC,0BAC3B14G,EAAQ4V,UAAUs4D,SAAS,EAAAyqC,0CAEpBlhG,EAAOW,eAEtB,EAQA,6CAAkDjtB,IAC9C,aAAUA,EAAG8nG,iBAAkB,UAAW+lB,IAC1C,aAAU7tH,EAAG8nG,iBAAkB,iBAAkB2mB,IACjD,aAAUzuH,EAAG8nG,iBAAkB,YAAa4mB,IAC5C,aAAU1uH,EAAG8nG,iBAAkB,YAAa8mB,IAC5C,aAAU5uH,EAAG8nG,iBAAkB,QAAS8mB,IACxC,aAAU5uH,EAAG8nG,iBAAkB,UAAW6mB,IAE1C,IAAA3C,cAAahsH,EAAG8nG,iBAAkB,UAAWgmB,IAC7C,IAAA9B,cAAahsH,EAAG8nG,iBAAkB,KAAMmmB,EAC5C,EAEA,IAAMW,EAA4D,SAC9DtiG,EACAzX,GAEIA,EAAQyV,MAAMgiC,WAAWpS,WAAW,aAC7B5tB,EAAOggC,UAEtB,gGC5OA,WAIMuiE,EAAkB,eAsBxB,mBACI7uH,EACA8tB,GAEA,IAAMghG,EAAyC,IAAI3gF,IAoDnD,OAnDY,IAAIp2B,WAAYiG,gBAAgB8P,EAAmB9tB,EAAG2nG,YAAa,aAC5D9pB,iBAAiB,SAE7B/8E,SAAQ,SAAAwpB,GAIX,IAHA,IAAM3U,GAAO2U,aAAK,EAALA,EAAOnM,UAAUnK,SAAU,GAEpC7R,EAAQ,eAER,IAAM4sH,EAAUp5G,EAAK7I,QAAQ,IAAK3K,EAAQ,GACpC6sH,EAAgBr5G,EAAK7I,QAAQ,IAAKiiH,GAClCE,EAAkBt5G,EAAK7I,QAAQ,IAAKiiH,GAC1C5sH,EAAQ4sH,EAGR,IAAMG,EAAev5G,EAChBvT,UAAU2sH,EAAU,EAAGE,GACvBp7G,QAAQg7G,EAAiB,IACzBh7G,QAAQ,OAAQ,IAChBi1D,YACAqmD,WAGCC,EAAWz5G,EACZvT,UAAU6sH,EAAiBD,EAAgB,GAC3CG,WACArmD,YACCxoE,EAAiC,CAAC,EAGxB8uH,EAAS7mH,MAAM,KACvBzH,SAAQ,SAAAk5E,GAEN,mBAAeA,EAAMzxE,MAAM,KAAI,GAA9BlF,EAAG,KAAExG,EAAK,KACjB,GAAIwG,GAAOxG,EAAO,CACd,IAAMwyH,EAAchsH,EAAIwQ,QAAQg7G,EAAiB,IAAI/lD,YAAYqmD,WAC3DG,EAAgBzyH,EAAMgX,QAAQg7G,EAAiB,IAAI/lD,YAAYqmD,WAErE7uH,EAAO+uH,GAAeC,EAE9B,IAEA,IAAMh+G,EAAqB,CACvB,0BAA2BhR,EAAO,2BAClC,qBAAsBA,EAAO,uBAAyB,IACtD,iBAAkBA,EAAO,oBAEzB,IAAA01B,eAAc1kB,GAAMu3B,MAAK,SAAAxlC,GAAO,QAAEiO,EAAKjO,EAAP,KAChCyrH,EAAYl6G,IAAIs6G,EAAc59G,IAxC/BnP,GAAS,MA2CpB,IACO2sH,CACX,8HCnFA,eACA,WACA,UACA,WACA,WACA,WACA,WAYMS,EAAmB,IAQzB,+CACIvvH,EACA8tB,GAEA,IAAMghG,GAAyC,aAAiB9uH,EAAI8tB,IAEpE,IAAAk+F,cAAahsH,EAAG8nG,iBAAkB,UAAW0nB,EAA4BV,KACzE,aAAU9uH,EAAG8nG,iBAAkB,QAAS2nB,IACxC,aAAUzvH,EAAG8nG,iBAAkB,QAAS,EAAA4nB,iCACxC,aAAU1vH,EAAG8nG,iBAAkB,YAAa6nB,IAC5C,aAAU3vH,EAAG8nG,iBAAkB,YAAa8nB,IAC5C,aAAU5vH,EAAG8nG,iBAAkB,QAAS8nB,EAC5C,EAEA,IAAMJ,EAA8B,SAChCK,GAEA,OAAO,SAAClvF,EAAO9rB,EAAS0vD,GACpB,IAAM1iE,GAAS,IAAA0oB,WAAU1V,IAIjB,IAAAi7G,iBAAgBjuH,EAAQ8+B,EAAO9rB,EAAS0vD,EAASsrD,KACjD,IAAAE,qBAAoBluH,EAAQgT,IAGhC0vD,EAAQ40B,yBAAyBtkF,QAAQ8rB,EAAO9rB,EAAS0vD,EAEjE,CACJ,EAEA,SAASkrD,EACLnjG,EACAzX,EACA0vD,EACAurC,GAGA,IAAIkgB,EAEAT,EAAiBp7G,KAAKU,EAAQyV,MAAM2R,cACnCnwB,MAAOkkH,EAAmBtnH,SAASmM,EAAQyV,MAAM2R,cAClD+zF,EAjDuC,MAmDvC1jG,EAAO2P,WAAa6zE,EAAa7zE,WAEzC,CAEA,SAAS0zF,EACLrjG,EACAzX,EACA0vD,EACAurC,GAEgC,IAA5Bj7F,EAAQyV,MAAMgiC,aACdhgC,EAAOggC,WAAawjD,EAAaxjD,YAGrChgC,EAAOmxB,kBAAejgD,CAC1B,CAEA,IAAMoyH,EAAyD,SAACtjG,UACvC,QAAjB,EAAAA,EAAOggC,kBAAU,eAAEpS,WAAW,cACvB5tB,EAAOggC,UAEtB,8GC3FA,eAEM2jE,EAAgC,YAYtC,+BAAoCpuH,EAAgCgT,GAChE,MAXkC,WAY9BhT,EAbsB,2BAcrB,IAAAmhF,iBAAgBnuE,EAAS,MAAQo7G,EAA8B97G,KAAKU,EAAQokB,OAXpD,gBAYzBp3B,EAbY,cAepB,yHCpBA,WACA,WAEA,WAqBMquH,EAAuB,iBAoL7B,SAASC,EACL7jG,EACAzX,GAEIA,EAAQyV,MAAMgiC,YAA0C,OAA5Bz3C,EAAQyV,MAAMgiC,aAC1ChgC,EAAO4zC,YAAc,OAErBrrD,EAAQyV,MAAM81C,aAA4C,OAA7BvrD,EAAQyV,MAAM81C,cAC3C9zC,EAAO+zC,aAAe,MAE9B,CAzKA,2BACIx+D,EACA8+B,EACA9rB,EACA0vD,EACA5qC,SAEMs9D,EAAa1yB,EAAQ0yB,WACtBA,EAAWm5B,kBACZn5B,EAAWm5B,gBAAkB,IAAIjiF,KAErC,IAAMkiF,EAAgBxuH,EAnCT,aAmC6B,GAI1C,GAtCoB,WAsChBwuH,EAAc5kH,cACd,OAAO,EAGL,mBAAmB4kH,EAAc9nH,MAAM,KAAI,GAA1C+nH,EAAO,KAAE7gH,EAAK,KAWrB,GARAwnF,EAAWs5B,UAAY9gH,GAAS/G,SAAS+G,EAAM4zC,OAAO,IAEtD4zC,EAAWu5B,SAAWF,GA9CF,KA+CY,GAA5Br5B,EAAWvxD,OAAO/pC,SAClBs7F,EAAWvxD,OACNuxD,EAAWu5B,UAAYv5B,EAAWm5B,gBAAgBhlH,IAAI6rF,EAAWu5B,WAAc,IAGpFH,GAAiB1vF,GAAyC,iBAAzBs2D,EAAWs5B,UAAwB,CAC5D,IAAAA,EAAwBt5B,EAAU,UAAvBu5B,EAAav5B,EAAU,SAEpCw5B,EAAe92F,EAASvuB,IAAOklH,EAAO,IAAI7gH,GAC1Cs2B,EA3CU,WA4C6B,QAAzC,EAAA0qF,aAAY,EAAZA,EAAe,kCAA0B,eAAEhlH,eACrC,KACA,KAGJ61D,GAAkC,IAAAC,iBAAgBx7B,GAUxD,IATA,IAAAq5D,aACIvqF,GAAO,uDACH0vD,EAAQ86B,cAAcjM,YAAS,IAAE+8B,IAAqB,GAC1D7uD,EAASh1C,OACTi4C,GAKAgsD,EAAYt5B,EAAWvxD,OAAO/pC,OAC9B,KAAO40H,GAAat5B,EAAWvxD,OAAO/pC,QAClCs7F,EAAWvxD,OAAOllC,KAAK8gE,QAG3B21B,EAAWvxD,OAAO74B,OAAO0jH,EAAWt5B,EAAWvxD,OAAO/pC,OAAS,GAC/Ds7F,EAAWvxD,OAAO6qF,EAAY,GAAKjvD,EAevC,OAbC21B,EAAWvxD,OAAOuxD,EAAWvxD,OAAO/pC,OAAS,GACzC2wB,OAA0BkkG,SAAWA,EAE1Cv5B,EAAW0J,WAAahgE,EAgBhC,SACIs2D,EACA1yB,EACA1vD,EACA8rB,EACA8vF,GAEA,IACQ1qF,EADUkxD,EAAWvxD,OAAOuxD,EAAWvxD,OAAO/pC,OAAS,GACjC,SACxBk7F,EAwBV,SAA+B45B,EAAwC1qF,GACnE,IACI2qF,EADEC,GAAeF,aAAY,EAAZA,EAAe,6BAA8B,UAGlE,GAAIA,aAAY,EAAZA,EAAe,kBAAmB,CAClC,IAAIG,EAAwB,GAC5B,OAAQD,GACJ,IAAK,cACDC,EAAgB,aAChB,MACJ,IAAK,cACDA,EAAgB,aAChB,MACJ,IAAK,cACDA,EAAgB,aAChB,MACJ,IAAK,cACDA,EAAgB,aAChB,MACJ,QACIA,EAAgB,SAQxBF,EAAgB,KALED,EAAa,mBAAqB,IAC/C58G,QAAQ,KAAM,IACdA,QAAQ,IAAK,IACbA,QAAQq8G,EAAsB,KAAOU,EAAgB,KAEzB,UAEjC,OAAQD,GACJ,IAAK,cACDD,EAAgB,cAChB,MACJ,IAAK,cACDA,EAAgB,cAChB,MACJ,IAAK,cACDA,EAAgB,cAChB,MACJ,QACIA,EAAgB,UAK5B,OAAO,IAAA18B,4BAA2BjuD,EAAU2qF,EAChD,CAvEmBG,CAAsBJ,EAAc1qF,GAC/C8wD,IACA,IAAA1wD,oBAAmB8wD,EAAWvxD,OAAOuxD,EAAWvxD,OAAO/pC,OAAS,IAAI,SAAAg+B,GAChE,OAAA19B,OAAOC,OAAO,CAAC,EAAGy9B,EAAU,CACxByC,mBAAgC,MAAZ2J,EAAmB8wD,OAASr5F,EAChD2+B,iBAA8B,MAAZ4J,EAAmB8wD,OAASr5F,GAFlD,IAOR,IAAM2jC,GAAW,IAAAknC,gBAAe4uB,EAAWvxD,OAAQ6+B,EAAQz9B,gBAE3D,IAAAs4D,aAAYvqF,EAAS0vD,EAAQ86B,cAAcC,eAAgB/6B,EAAQz9B,cAAey9B,IAClF,IAAA66B,aAAYvqF,EAAS0vD,EAAQ86B,cAAc8Q,gBAAiBhvE,EAAS7U,OAAQi4C,IAC7E,IAAA66B,aAAYvqF,EAAS,CAAC,EAAA66G,gCAAiCvuF,EAAS7U,OAAQi4C,GAExD,MAAZx+B,GAqER,SACI5E,EACAojC,EACAksD,WAEM,EAMFlsD,EAAQ0yB,WALR0J,EAAU,aACV6vB,EAAQ,WACRJ,EAAe,kBACfG,EAAS,YACT7qF,EAAM,SAGJ7E,EAmBV,SAA8B8/D,GAC1B,IAAK,IAAIx+F,IAASw+F,aAAU,EAAVA,EAAY//D,OAAOjlC,SAAU,GAAK,EAAGwG,EAAQ,EAAGA,IAAS,CACvE,IAAML,EAAS6+F,aAAU,EAAVA,EAAY//D,OAAOz+B,GAClC,GAAIL,KAAW,IAAAy6G,SAAQz6G,GACnB,OAAOA,EAKnB,CA5BkBgvH,CAAqBnwB,GACnC,IACyB,eAApB9/D,aAAK,EAALA,EAAOU,YACoB,YAAxBV,EAAME,gBACLwvF,IACsD,QAAnD,EAAwB,QAAvB,EAAA1vF,EAAM6E,OAAO6qF,UAAU,eAAEjkG,cAAyB,eAAEkkG,WAAYA,IACzEA,EACF,CACE,IAAM/xH,GAAQgyH,aAAY,EAAZA,EAAe,uBACvB/nH,SAAS+nH,EAAa,uBACtBM,IACAC,GAAaZ,aAAe,EAAfA,EAAiBhlH,IAAIolH,KAAa,GAExChzH,MAATiB,GAAuBqN,MAAMrN,IAAUuyH,EAAWr1H,QAAU+pC,EAAO/pC,SACnEwlC,EAASuE,OAAOvE,EAASuE,OAAO/pC,OAAS,GAAG2wB,OAAOmQ,oBAAsBh+B,GAGrF,CAlGQwyH,CAAe9vF,EAAUojC,EAASksD,GAGtClsD,EAAQqoC,kBAAkBnzC,MAAMt4B,EAAUtsB,EAAS0vD,IACnD,IAAAH,UAASzjC,EAAOQ,EACpB,CA7CQ+vF,CAAkBj6B,EAAY1yB,EAAS1vD,EAAS8rB,EAAO8vF,GAGnDx5B,EAAWvxD,OAAO/pC,OAAS,GAC3Bs7F,EAAWm5B,gBAAgBhlH,IAAIolH,IAAav5B,EAAWvxD,QAEvDuxD,EAAWm5B,gBAAgBx7G,IAAI47G,GAAU,EAAF,iCAAMv5B,EAAWvxD,SAAM,KAE3D,EAGX,OAAO,CACX,uHCnHa,EAAAgqF,+BAAiE,SAACpjG,EAAQzX,UAC9D,QAAjB,EAAAyX,EAAOkS,kBAAU,eAAE0b,WAAW,cACvB5tB,EAAOkS,UAEtB,2GCNa,EAAA8tF,mBAAqB,CAI9BC,uBAAwB,4BAKxB4E,aAAc,SAKdC,6BAA8B,8HCjBlC,eASa,EAAAC,2BAAgD,SAAAxtG,GAEzD,QADqBA,EAAK,SACR4+B,cAAc,EAAAirE,sBACpC,yGCZA,eACA,WACA,WACA,WACA,WACA,WACA,WAgCM4D,EAAqB,IAAInjF,IAA6C,CACxE,CAAC,cAAe,EAAAojF,uBAChB,CAAC,eAAgB,EAAAC,wBACjB,CAAC,cAAe,EAAAC,uBAChB,CAAC,oBAAqB,EAAAC,6BACtB,CAAC,gBAAiB,EAAAL,4BAClB,CAAC,eAAgB,EAAAM,uBACjB,CAAC,cAAe,EAAAC,8BAUpB,0BACI/mF,EACAgnF,GAEQ,IAAAhqB,EAA4Ch9D,EAAK,eAAjCkP,EAA4BlP,EAAK,cAAlBlqB,EAAakqB,EAAK,SAErD/oC,EAAsC,KACpCgwH,EAA8B,CAChCjqB,eAAc,EACdlnF,SAAQ,EACRkxG,yBAAwB,EACxB93E,cAAa,GASjB,OANAu3E,EAAmBxwH,SAAQ,SAACtC,EAAM6E,IACzBvB,GAAUtD,EAAKszH,KAChBhwH,EAASuB,EAEjB,IAEOvB,QAAAA,EAAU,SACrB,iHC5EA,eAWa,EAAA0vH,uBAA4C,SAAA3tG,GAGrD,MAX0B,0CASCA,EAAK,eAEV,EAAAyoG,mBAAmB8E,6BAC7C,gHCfA,eAYa,EAAAK,sBAA2C,SAAA5tG,GAC5C,IAAAgkF,EAAmBhkF,EAAK,eAEhC,MAXiC,eAY7BgkF,EAAe,EAAAykB,mBAAmB6E,eACiC3zH,MAAnEqqG,EAAe,EAAAykB,mBAAmB8E,6BAE1C,gHCnBA,eASa,EAAAO,sBAA2C,SAAA9tG,GAEpD,QADqBA,EAAK,SACR4+B,cAAc,EAAA6pE,mBAAmBC,uBACvD,sHCZA,eAWa,EAAAmF,4BAAiD,SAAA7tG,GAC1D,MAT+B,oBASxBA,EAAMgkF,eAAe,EAAAykB,mBAAmB6E,aACnD,gHCbA,eAaa,EAAAI,sBAA2C,SAAA1tG,GAC5C,IAAAgkF,EAAmBhkF,EAAK,eAChC,MAXyB,yCAYrBgkF,EAboB,YAEP,iBAYbA,EAAe,EAAAykB,mBAAmB6E,aAE1C,mHCVa,EAAAS,2BAAgD,SAAA/tG,SACjDguG,EAA4ChuG,EAAK,yBAAvBk2B,EAAkBl2B,EAAK,cACzD,OACIguG,GACiD,IAAZ,QAArC,EAAA93E,EAAc4uD,+BAAuB,eAAEhtG,SACK,OAA5Co+C,EAAc4uD,wBAAwB,EAE9C,+ECNA,mBACIb,EACA9tB,EACA+rB,SAEK+B,EAAiB/B,0BAClB+B,EAAiB/B,wBAA0B,CAAC,GAE3C+B,EAAiB/B,wBAAwB/rB,KAC1C8tB,EAAiB/B,wBAAwB/rB,GAAS,IAGP,QAA/C,EAAA8tB,EAAiB/B,wBAAwB/rB,UAAM,SAAEx5E,KAAKulG,EAC1D,sHCvBA,eAMa,EAAA2mB,4BAA0D,SACnEpgG,GAEA,EAAA83E,WAAWtjG,SAAQ,SAAAuC,GACf,IAAMxG,EAAQyvB,EAAOjpB,GACjB0E,EAAgB,GACpB,GACIlL,GACA,EAAAg+G,iBAAiBhyE,MAAK,SAAAkpF,GAAU,OAAAl1H,EAAMiQ,QAAQilH,IAAW,IAAMhqH,EAAQgqH,EAAvC,IAClC,CACE,IAAMx9F,EAAW13B,EAAMgX,QAAQ9L,EAAO,IAAI+gE,YAC1Cx8C,EAAOjpB,GAAOkxB,EAEtB,GACJ,iGCfA,qBAA0B1f,GACtB,IAAM/S,EAAiC,CAAC,EAUxC,QATc+S,aAAO,EAAPA,EAASiE,aAAa,WAAY,IAC1CvQ,MAAM,KAAKzH,SAAQ,SAAAupG,GACrB,IAAMC,EAAaD,EAAKv9F,QAAQ,KAC1B5B,EAAOm/F,EAAKxrG,MAAM,EAAGyrG,GACrBztG,EAAQwtG,EAAKxrG,MAAMyrG,EAAa,GAClCp/F,GAAQrO,IACRiF,EAAOoJ,EAAK8I,QAAUnX,EAAMmX,OAEpC,IACOlS,CACX,oGCjBA,eAGMkwH,EAAsB,CAAC,QAAS,SAAU,SAAU,UAAW,YAC/DC,EAAsB,0BAKf,EAAAxF,UAAuD,SAACngG,EAAQzX,GACzE,IAAK,IAAAmuE,iBAAgBnuE,EAAS,KAA9B,CAIA,IAAI83B,EACJ,IACIA,EAAM,IAAIulF,IAAIr9G,EAAQokB,MACxB,SACE0T,OAAMnvC,GAILmvC,IAAsD,IAA/CqlF,EAAoBllH,QAAQ6/B,EAAIwlF,WACxCF,EAAoB99G,KAAKU,EAAQokB,SAEjCpkB,EAAQ4I,gBAAgB,QACxB6O,EAAO2M,KAAO,IAEtB,qGCvBA,wBACI6uE,EACA9tB,EACAoX,GAEK0W,EAAiB1W,oBAClB0W,EAAiB1W,kBAAoB,CAAC,GAG1C0W,EAAiB1W,kBAAkBpX,GAASoX,CAChD,iFCfA,eAUA,mBAAwB1xF,EACpB0yH,EACA9yH,GAEA,IAAK8yH,IAAgBA,EAAY1wG,IAC7B,OAAO,KAGH,IAAAA,EAAoE0wG,EAAW,IAA1Er7D,EAA+Dq7D,EAAW,UAA/D3nG,EAAoD2nG,EAAW,UAApD9nG,EAAyC8nG,EAAW,MAA7Ct8F,EAAkCs8F,EAAW,QAApChzG,EAAyBgzG,EAAW,WAAxBC,EAAaD,EAAW,SACjFtwH,EAASi1D,EACTz3D,EAASgzH,gBAAgBv7D,EAAWr1C,GACpCpiB,EAASI,cAAcgiB,GAmC7B,OAjCI4I,GACAxoB,EAAOjC,aAAa,QAASyqB,GAG7BG,IACA3oB,EAAO2oB,UAAYA,GAGnBqL,IAAW,IAAA6oD,cAAa78E,EAAQ,kBAChC,IAAAk0B,eAAcF,GAASh1B,SAAQ,SAAAyxH,GAC3BzwH,EAAOg0B,QAAQy8F,GAAez8F,EAAQy8F,EAC1C,IAGAnzG,IACA,IAAA4W,eAAc5W,GAAYte,SAAQ,SAAAqf,GAC9Bre,EAAOjC,aAAasgB,EAAUf,EAAWe,GAC7C,IAGAkyG,GACAA,EAASvxH,SAAQ,SAAA24D,GACb,GAAqB,iBAAVA,EACP33D,EAAOhC,YAAYR,EAASS,eAAe05D,SACxC,GAAIA,EAAO,CACd,IAAM+4D,EAAe9yH,EAAc+5D,EAAOn6D,GACtCkzH,GACA1wH,EAAOhC,YAAY0yH,GAG/B,IAGG1wH,CACX,gGC3BM2wH,EACK,CACHC,UAAW,YACXC,UAAW,YACXC,QAAS,UACTC,UAaR,SAA6BtjG,GACzB,MAAO,CAACA,EAAEM,MAAON,EAAE0D,MACvB,GAXM6/F,EACK,CACHJ,UAAW,aACXC,UAAW,YACXC,QAAS,WACTC,UAQR,SAA6BtjG,GACzB,IAAIM,EAAQ,EACRoD,EAAQ,EACZ,GAAI1D,EAAEwjG,eAAiBxjG,EAAEwjG,cAAcp3H,OAAS,EAAG,CAC/C,IAAMq3H,EAAQzjG,EAAEwjG,cAAc,GAC9BljG,EAAQmjG,EAAMnjG,MACdoD,EAAQ+/F,EAAM//F,MAElB,MAAO,CAACpD,EAAOoD,EACnB,GAMA,iBAiBI,WACYgzF,EACA1hD,EACA0uD,EACAC,EACAlkG,EACRmkG,GANJ,WACY,KAAAlN,QAAAA,EACA,KAAA1hD,QAAAA,EACA,KAAA0uD,SAAAA,EACA,KAAAC,QAAAA,EACA,KAAAlkG,UAAAA,EArBJ,KAAAokG,MAAgB,EAChB,KAAAC,MAAgB,EAChB,KAAA1zF,eAAoCniC,EAkDpC,KAAA8xB,YAAc,SAACC,aACnBA,EAAE6D,iBACF7D,EAAE4D,kBACF,EAAKmgG,oBACL,eAA2B,EAAKC,SAASV,UAAUtjG,GAA6B,GAA/E,EAAK6jG,MAAK,KAAE,EAAKC,MAAK,KACvB,EAAK1zF,UAAoC,QAAxB,OAAKuzF,SAAQ3vC,mBAAW,sBAAG,EAAKhf,QAASh1C,EAC9D,EAEQ,KAAAE,YAAc,SAACF,aACnBA,EAAE6D,iBACI,mBAAiB,EAAKmgG,SAASV,UAAUtjG,GAA6B,GAArEM,EAAK,KAAEoD,EAAK,KACbugG,GAAU3jG,EAAQ,EAAKujG,OAAS,EAAKpkG,UACrCykG,GAAUxgG,EAAQ,EAAKogG,OAAS,EAAKrkG,UAEvC,EAAK2Q,YACkB,QAAvB,OAAKuzF,SAAQQ,kBAAU,sBAAG,EAAKnvD,QAASh1C,EAAiB,EAAKoQ,UAAW6zF,EAAQC,MAEpE,QAAb,IAAKR,gBAAQ,cAAb,EAAgB,EAAK1uD,QAAS,EAAK0hD,SAE3C,EAEQ,KAAAv2F,UAAY,SAACH,aACjBA,EAAE6D,iBACF,EAAKugG,wBACqB,QAAtB,OAAKT,SAAQU,iBAAS,sBAAG,EAAKrvD,QAASh1C,EAAiB,EAAKoQ,cAChD,QAAb,IAAKszF,gBAAQ,cAAb,EAAgB,EAAK1uD,QAAS,EAAK0hD,SAE3C,EAvDIjqH,KAAKu3H,SAAWJ,EAAcL,EAA0BL,EACxDxM,EAAQz2F,iBAAiBxzB,KAAKu3H,SAASb,UAAW12H,KAAKszB,YAC3D,CAsDJ,OAjDI,YAAA0a,QAAA,WACIhuC,KAAKiqH,QAAQl2F,oBAAoB/zB,KAAKu3H,SAASb,UAAW12H,KAAKszB,aAC/DtzB,KAAK23H,sBACT,EAEA,sBAAW,wBAAS,KAApB,WACI,OAAO33H,KAAKu3H,UAAYT,EAA0B,QAAU,OAChE,kCAEQ,YAAAQ,kBAAR,WACI,IAAM11G,EAAM5hB,KAAKiqH,QAAQ1tG,cACzBqF,EAAI4R,iBAAiBxzB,KAAKu3H,SAASZ,UAAW32H,KAAKyzB,aAAa,GAChE7R,EAAI4R,iBAAiBxzB,KAAKu3H,SAASX,QAAS52H,KAAK0zB,WAAW,EAChE,EAEQ,YAAAikG,qBAAR,WACI,IAAM/1G,EAAM5hB,KAAKiqH,QAAQ1tG,cACzBqF,EAAImS,oBAAoB/zB,KAAKu3H,SAASZ,UAAW32H,KAAKyzB,aAAa,GACnE7R,EAAImS,oBAAoB/zB,KAAKu3H,SAASX,QAAS52H,KAAK0zB,WAAW,EACnE,EA8BJ,EAjFA,6GCnEA,WA4BA,mBACIgsD,EACAC,QAAA,IAAAA,IAAAA,EAAA,IAEA,IAAMC,EAAQF,EACTx6E,KAAI,SAAA2T,GAAW,oBAAcA,EAAQge,wBAAtB,IACf9zB,OAAO48E,GACP76B,QAAO,SAAAjsC,GAAW,QAAEA,CAAF,IAEjB/S,EAAe,CACjBkxB,IAAKjuB,KAAKC,IAAG,MAARD,MAAI,mCAAQ62E,EAAM16E,KAAI,SAAA0D,GAAK,OAAAA,EAAEouB,GAAF,MAAM,IACtCukB,OAAQxyC,KAAKD,IAAG,MAARC,MAAI,mCAAQ62E,EAAM16E,KAAI,SAAA0D,GAAK,OAAAA,EAAE2yC,MAAF,MAAS,IAC5CxkB,KAAMhuB,KAAKC,IAAG,MAARD,MAAI,mCAAQ62E,EAAM16E,KAAI,SAAA0D,GAAK,OAAAA,EAAEmuB,IAAF,MAAO,IACxC0kB,MAAO1yC,KAAKD,IAAG,MAARC,MAAI,mCAAQ62E,EAAM16E,KAAI,SAAA0D,GAAK,OAAAA,EAAE6yC,KAAF,MAAQ,KAG9C,OAAO31C,EAAOkxB,IAAMlxB,EAAOy1C,QAAUz1C,EAAOixB,KAAOjxB,EAAO21C,MAAQ31C,EAAS,IAC/E,+ECtCA,mBAAsC+xH,GAC5B,MACFA,GAAuB,CAAE9gG,KAAM,EAAG0kB,MAAO,EAAGzkB,IAAK,EAAGukB,OAAQ,GADxDxkB,EAAI,OAAE0kB,EAAK,QAAEzkB,EAAG,MAAEukB,EAAM,SAEhC,OAAgB,IAATxkB,GAAwB,IAAV0kB,GAAuB,IAARzkB,GAAwB,IAAXukB,EAC3C,KACA,CACIxkB,KAAMhuB,KAAK8C,MAAMkrB,GACjB0kB,MAAO1yC,KAAK8C,MAAM4vC,GAClBzkB,IAAKjuB,KAAK8C,MAAMmrB,GAChBukB,OAAQxyC,KAAK8C,MAAM0vC,GAEjC,yGClBA,eAEA,WAqBMu8E,EAAsC,CACxC,EAAApJ,aACA,EAAAC,eACA,EAAAC,kBACA,EAAAC,oBACA,EAAAC,aACA,EAAAC,cACA,EAAAC,aACA,EAAAC,kBACA,EAAAC,eACA,EAAAC,kBACA,EAAAC,qBACA,EAAAC,sBAOJ,aAQI,WAAoB0I,QAAA,IAAAA,IAAAA,EAAA,QAAAA,UAAAA,EAPZ,KAAAzmG,OAAyB,KACzB,KAAAgtC,OAAQ,CAMsD,CAmG1E,OA9FI,YAAA7vB,QAAA,WACI,MAAO,UACX,EAQA,YAAAC,WAAA,SAAWpd,GACPtxB,KAAKsxB,OAASA,EACdtxB,KAAKs+D,QAAUt+D,KAAKsxB,OAAOw6D,iBAAiBxtB,KAChD,EAOA,YAAAtwB,QAAA,WACIhuC,KAAKsxB,OAAS,IAClB,EAUA,YAAAwyD,2BAAA,SAA2Bj1C,GACvB,MACuB,WAAnBA,EAAMC,YACLD,EAAMiX,SAASC,SAAWlX,EAAMiX,SAASmnC,QAAUp+C,EAAMiX,SAASsnC,YACjEptF,KAAKg4H,gBAAgBnpF,EAE/B,EAQA,YAAAD,cAAA,SAAcC,GACV,GAAI7uC,KAAKsxB,QAA6B,WAAnBud,EAAMC,UAAwB,CAC7C,IAAMmpF,EAAUj4H,KAAKg4H,gBAAgBnpF,GAEjCopF,IACAA,EAAQ9hG,QAAQn2B,KAAKsxB,QACrBud,EAAMiX,SAAS1uB,kBAG3B,EAEQ,YAAA4gG,gBAAR,SAAwBnpF,GAAxB,WACI,OAAO,IAAAkpD,mBAAkBlpD,EA5ET,0BA4EiC,SAAAA,GAG7C,OAFe,EAAKvd,QAIhB,EAAKymG,UAAUjzE,QACX,SAAAmzE,GACI,SAAKC,QAAQD,EAAQ1iC,cACrB,EAAK4iC,cAAcF,EAAQG,YAAavpF,EAAMiX,SAD9C,IAEN,EAEV,GACJ,EAEQ,YAAAoyE,QAAR,SAAgB3iC,GACZ,OAAQA,GACJ,IAAK,MACD,OAAOv1F,KAAKs+D,MAEhB,IAAK,SACD,OAAQt+D,KAAKs+D,MAEjB,QACI,OAAO,EAEnB,EAEQ,YAAA65D,cAAR,SAAsBC,EAAoCvpF,GAC9C,IAAAkX,EAA8ClX,EAAK,QAA1Co+C,EAAqCp+C,EAAK,OAAlCu9C,EAA6Bv9C,EAAK,SAAxBzW,EAAmByW,EAAK,MAAjBu+C,EAAYv+C,EAAK,QACrDwpF,EAAar4H,KAAKs+D,MAAQ8uB,EAAUrnC,EAK1C,OAHgC,QAA3BqyE,EAAYE,aAAyBD,IAAeprC,GACzB,OAA3BmrC,EAAYE,aAAwBrrC,IAAWorC,IAE5BjsC,GAAYgsC,EAAYhsC,UAAYgsC,EAAYhgG,OAASA,CACrF,EACJ,EA3GA,GAAa,EAAA3B,eAAAA,uTC1Cb,eACA,WA6Ba,EAAAi4F,aAAgC,CACzC0J,YAAa,CACTE,YAAa,OACblsC,UAAU,EACVh0D,MAAO,IAEXjC,QAAS,SAAA7E,GAAU,WAAAulB,YAAWvlB,EAAX,GAQV,EAAAq9F,eAAkC,CAC3CyJ,YAAa,CACTE,YAAa,OACblsC,UAAU,EACVh0D,MAAO,IAEXjC,QAAS,SAAA7E,GAAU,WAAAurB,cAAavrB,EAAb,GAQV,EAAAs9F,kBAAqC,CAC9CwJ,YAAa,CACTE,YAAa,OACblsC,UAAU,EACVh0D,MAAO,IAEXjC,QAAS,SAAA7E,GAAU,WAAAozB,iBAAgBpzB,EAAhB,GAQV,EAAAu9F,oBAAuC,CAChDuJ,YAAa,CACTE,YAAa,OACblsC,UAAU,EACVh0D,MAAO,IAEXjC,QAAS,SAAA7E,GAAU,WAAAimB,aAAYjmB,EAAZ,GAQV,EAAAw9F,aAAgC,CACzCsJ,YAAa,CACTE,YAAa,OACblsC,UAAU,EACVh0D,MAAO,IAEXjC,QAAS,SAAA7E,GAAU,WAAAszB,MAAKtzB,EAAL,GAQV,EAAAy9F,cAAiC,CAC1CqJ,YAAa,CACTE,YAAa,MACblsC,UAAU,EACVh0D,MAAO,GAEXjC,QAAS,SAAA7E,GAAU,WAAAszB,MAAKtzB,EAAL,EACnBikE,YAAa,UAQJ,EAAAy5B,aAAgC,CACzCoJ,YAAa,CACTE,YAAa,OACblsC,UAAU,EACVh0D,MAAO,IAEXjC,QAAS,SAAA7E,GAAU,WAAAwtB,MAAKxtB,EAAL,EACnBikE,YAAa,UAQJ,EAAA05B,kBAAqC,CAC9CmJ,YAAa,CACTE,YAAa,OACblsC,UAAU,EACVh0D,MAAO,IAEXjC,QAAS,SAAA7E,GAAU,WAAAwtB,MAAKxtB,EAAL,EACnBikE,YAAa,OAQJ,EAAA25B,eAAkC,CAC3CkJ,YAAa,CACTE,YAAa,OACblsC,UAAU,EACVh0D,MAAO,KAEXjC,QAAS,SAAA7E,GAAU,WAAAylB,cAAazlB,EAAb,GAQV,EAAA69F,kBAAqC,CAC9CiJ,YAAa,CACTE,YAAa,OACblsC,UAAU,EACVh0D,MAAO,KAEXjC,QAAS,SAAA7E,GAAU,WAAA+rB,iBAAgB/rB,EAAhB,GAQV,EAAA89F,qBAAwC,CACjDgJ,YAAa,CACTE,YAAa,OACblsC,UAAU,EACVh0D,MAAO,KAEXjC,QAAS,SAAA7E,GAAU,WAAAomB,gBAAepmB,EAAQ,WAAvB,GAQV,EAAA+9F,qBAAwC,CACjD+I,YAAa,CACTE,YAAa,OACblsC,UAAU,EACVh0D,MAAO,KAEXjC,QAAS,SAAA7E,GAAU,WAAAomB,gBAAepmB,EAAQ,WAAvB,2GCjMvB,eACA,WACA,WAQA,aAYI,WAAoBinG,GAApB,WAAoB,KAAAA,wBAAAA,EAXZ,KAAAjnG,OAAyB,KACzB,KAAAknG,oBAA2C,KAC3C,KAAAC,aAAiE,KACjE,KAAAC,YAAkC,KA8BlC,KAAAv9F,WAAa,SAAC,OACZw9F,EAD2B,gBAE3BC,EAF0C,iBAI5C,IAAAj2C,cAAag2C,EAAmB,kBAChC,IAAAh2C,cAAai2C,EAAmB,iBAChC,EAAKF,cACJ,EAAKA,YAAYG,eAAeF,KAChCC,EAAkBx5C,SAASu5C,IAE5B,EAAKG,eAAe,KAE5B,EA+BQ,KAAArlG,YAAc,SAACob,SACbtb,EAAIsb,EAEV,KAAItb,EAAExL,QAAU,IAAM,EAAKuJ,OAA3B,CAIA,EAAKynG,mBAEL,IAAMC,EAAe,EAAK1nG,OAAOqd,cAAcwH,aAAen1C,OACxD4I,EAAI2pB,EAAEM,MAAQmlG,EAAaC,QAC3BpvH,EAAI0pB,EAAE0D,MAAQ+hG,EAAaE,QAC7BC,EAAwC,KAG5C,GAAI,EAAKV,aACL,IAAK,IAAI/4H,EAAI,EAAK+4H,aAAa94H,OAAS,EAAGD,GAAK,EAAGA,IAAK,CAC9C,MAAkB,EAAK+4H,aAAa/4H,GAAlCkhB,EAAK,QAAEgW,EAAI,OAEnB,GACIhtB,GAAKgtB,EAAKG,KAtGD,IAuGTntB,GAAKgtB,EAAK6kB,MAvGD,IAwGT5xC,GAAK+sB,EAAKI,IAxGD,IAyGTntB,GAAK+sB,EAAK2kB,OAzGD,GA0GX,CACE49E,EAAev4G,EACf,OAKZ,EAAKk4G,eAAeK,EAAc5lG,GAClB,QAAhB,IAAKmlG,mBAAW,SAAEjlG,YAAY7pB,EAAGC,GACrC,EA2BQ,KAAAuvH,qBAAuB,WAC3B,EAAKX,aAAe,IACxB,CA/HuD,CAwJ3D,OAnJI,YAAAhqF,QAAA,WACI,MAAO,WACX,EAMA,YAAAC,WAAA,SAAWpd,GACPtxB,KAAKsxB,OAASA,EACdtxB,KAAKw4H,oBAAsBx4H,KAAKsxB,OAAO6pD,eAAe,CAClDk+C,UAAW,CAAE99C,eAAgBv7E,KAAKyzB,eAEdzzB,KAAKsxB,OAAOkkE,qBACpBhiE,iBAAiB,WAAYxzB,KAAKm7B,WACtD,EAmBA,YAAA6S,QAAA,mBACUwxC,EAA6B,QAAX,EAAAx/E,KAAKsxB,cAAM,eAAEkkE,qBACrChW,SAAAA,EAAiBzrD,oBAAoB,WAAY/zB,KAAKm7B,YAC9B,QAAxB,EAAAn7B,KAAKw4H,2BAAmB,cAAxBx4H,MACAA,KAAKo5H,uBACLp5H,KAAKs5H,qBACLt5H,KAAKsxB,OAAS,KACdtxB,KAAKw4H,oBAAsB,IAC/B,EAMA,YAAA5pF,cAAA,SAAcrb,GACV,OAAQA,EAAEub,WACN,IAAK,QACL,IAAK,iBACL,IAAK,SACL,IAAK,cACD9uC,KAAK84H,eAAe,MACpB94H,KAAKo5H,uBAGjB,EA0CO,YAAAN,eAAP,SAAsBl4G,EAAgCiuB,GAKlD,GAJI7uC,KAAK04H,cAAgB14H,KAAK04H,YAAYa,aAAe34G,GAAS5gB,KAAK04H,YAAY93G,OAC/E5gB,KAAKs5H,sBAGJt5H,KAAK04H,aAAe93G,GAAS5gB,KAAKsxB,QAAU1Q,EAAMqsB,KAAKttC,OAAS,EAAG,CACpE,IAAM+4B,EAAY14B,KAAKu4H,wBACjBv4H,KAAKsxB,OAAO+3D,eAAe37B,cAAc1tD,KAAKu4H,yBAAyB,QACvE/2H,EAENxB,KAAK04H,YAAc,IAAI,UACnB14H,KAAKsxB,OACL1Q,EACA5gB,KAAKo5H,sBACL,IAAAz2C,cAAajqD,EAAmB,gBAAkBA,OAAYl3B,EAC9DqtC,aAAK,EAALA,EAAO2qF,eAGnB,EAMQ,YAAAF,mBAAR,iBACoB,QAAhB,EAAAt5H,KAAK04H,mBAAW,SAAE1qF,UAClBhuC,KAAK04H,YAAc,IACvB,EAEQ,YAAAK,iBAAR,uBACS/4H,KAAKy4H,cAAgBz4H,KAAKsxB,SAC3BtxB,KAAKy4H,aAAe,GAELz4H,KAAKsxB,OAAO+3D,eAAe37B,cAAc,SACjD5oD,SAAQ,SAAA8b,GACX,GAAIA,EAAMqmE,kBAAmB,CACzB,IAAMrwD,GAAO,aAAchW,EAAMiW,yBAC7BD,GAAQ,EAAK6hG,cACb,EAAKA,aAAaj0H,KAAK,CACnBoc,MAAK,EACLgW,KAAI,IAIpB,IAER,EACJ,EApKA,GAAa,EAAAvJ,gBAAAA,iFCVb,eACA,WACA,WACA,UACA,WACA,WACA,WAsCA,aAmBI,WACYiE,EACQ1Q,EACRigD,EACA44D,EACAz1C,GALZ,aACY,KAAA1yD,OAAAA,EACQ,KAAA1Q,MAAAA,EACR,KAAAigD,UAAAA,EACA,KAAA44D,gBAAAA,EACA,KAAAz1C,WAAAA,EAtBJ,KAAA01C,mBAA8C,KAC9C,KAAAC,iBAA4C,KAG5C,KAAAC,kBAA6C,KAC7C,KAAAC,gBAA2C,KAG3C,KAAAC,aAAwC,KAGxC,KAAAC,WAAsC,KAGtC,KAAAhkF,MAAsB,KAyPtB,KAAAikF,gBAAkB,WAWtB,OAVA,EAAK1oG,OAAOyc,QAER,EAAKgI,OACL,EAAKzkB,OAAOksD,gBAAgB,CAAEtmD,KAAM,QAAS6e,MAAO,EAAKA,MAAOupC,YAAY,IAGhF,EAAKhuD,OAAOsuC,eACZ,EAAKiB,YACL,EAAKo5D,oBAAqB,GAEnB,CACX,EAEQ,KAAAC,mBAAqB,WACzB,EAAKD,oBAAqB,EAC1B,EAAKE,eACT,EAEQ,KAAAC,kBAAoB,WACxB,EAAKH,oBAAqB,EAC1B,EAAKI,sBACL,EAAKF,eACT,EAaQ,KAAAG,WAAa,WACjB,EAAKD,sBACL,EAAKL,iBACT,EAMO,KAAAvhG,SAAW,SAAC7X,GAGf,GAFA,EAAK0Q,OAAOyc,QAERntB,EAAO,CACP,IAAMyqC,EAA4B,CAC9BzqC,MAAOA,EACPsuD,SAAU,EACV50B,YAAa,EACb60B,QAASvuD,EAAMqsB,KAAKttC,OAAS,EAC7ByvE,WAAYxuD,EAAMqsB,KAAKrsB,EAAMqsB,KAAKttC,OAAS,GAAG+sC,MAAM/sC,OAAS,EAC7Du3B,KAAM,SAGV,EAAK5F,OAAOksD,gBAAgBnyB,GAEpC,EAEQ,KAAAkvE,cAAgB,SAACC,GACrB,OAAO,SAACx2H,GAEAw2H,GACAx2H,EAAGy2H,eAAiBD,IACpB,IAAA73C,cAAa,EAAKqB,WAAoB,kBACtC,IAAArB,cAAa3+E,EAAGy2H,cAAuB,iBACrC,EAAKz2C,YAAchgF,EAAGy2H,eAExB,EAAKzsF,SAEb,CACJ,EAzTIhuC,KAAK06H,MAA+E,QAAvC,QAAhC,EAAAppG,EAAOqd,cAAcwH,mBAAW,eAAEre,iBAAiBlX,GAAOme,WACvE/+B,KAAK26H,oBACL36H,KAAKi6H,oBAAqB,CAC9B,CAuTJ,OArTI,YAAAjsF,QAAA,WACIhuC,KAAKq6H,sBACLr6H,KAAK46H,sBACL56H,KAAK66H,uBACL76H,KAAK86H,mBACT,EAEA,YAAAvB,UAAA,WACI,OAAOv5H,KAAKi6H,kBAChB,EAEA,YAAApB,eAAA,SAAehqH,GACX,MAAO,CACH7O,KAAK85H,aACL95H,KAAK+5H,WACL/5H,KAAK05H,mBACL15H,KAAK25H,iBACL35H,KAAK45H,kBACL55H,KAAK65H,iBAEJ/0E,QAAO,SAAA01E,GAAW,SAAEA,aAAO,EAAPA,EAAS5qG,IAAX,IAClBid,MAAK,SAAA2tF,GAAW,OAAAA,aAAO,EAAPA,EAAS5qG,MAAO/gB,CAAhB,GACzB,EAEA,YAAA4kB,YAAA,SAAY7pB,EAAWC,SAEbkxH,GAAY,aAAc/6H,KAAK4gB,MAAMiW,yBAG3C,GAAKkkG,EAAL,CAkBA,IAbA,IAAMC,EACFnxH,GAAKkxH,EAAU/jG,IApGG,EAqGZ,EACAh3B,KAAK06H,MACL9wH,GAAKmxH,EAAUt/E,MAvGH,EAwGR,OACAj6C,EACJoI,GAAKmxH,EAAUhkG,KA1GH,EA2GZ,OACAv1B,EACJy5H,EAAkBD,EAAY,EAAI,EAG/Bt7H,EAAI,EAAGA,EAAIM,KAAK4gB,MAAMqsB,KAAKttC,OAAQD,IAAK,CAG7C,IAFA,IAAMwgG,EAAKlgG,KAAK4gB,MAAMqsB,KAAKvtC,GACvBitC,EAAI,EACDA,EAAIuzD,EAAGxzD,MAAM/sC,OAAQgtC,IAAK,CAC7B,IAAMukB,EAAKgvC,EAAGxzD,MAAMC,GACduuF,GAAS,aAAchqE,EAAGr6B,yBAEhC,GAAKqkG,GAAWH,EAAhB,CAMA,IAAMI,EAAiBtxH,GAAKqxH,EAAO3/E,OAC7B6/E,EAAgBp7H,KAAK06H,MACrB9wH,GAAKsxH,EAAOz/E,MA/HJ,EA+HoCw/E,EAC5CrxH,GAAKsxH,EAAOz/E,MACZ4/E,EAAer7H,KAAK06H,MACpB9wH,GAAKsxH,EAAOnkG,KACZntB,GAAKsxH,EAAOnkG,KAnIJ,EAmImCkkG,EAEjD,GAAIE,GAAkBC,GAAiBC,EAAc,CACjD,GAAU,IAAN37H,GAAwB,GAAbs7H,EAA8B,CACzC,IAAMt/E,GAAUw/E,EAAOnkG,KAAOmkG,EAAOz/E,OAAS,EACxC6/E,EAAgBt7H,KAAK06H,MAAQ9wH,EAAI8xC,EAAS9xC,EAAI8xC,EACpD17C,KAAKu7H,cACDD,EAAgBpqE,EAAKgvC,EAAGxzD,MAAMC,EAAI,IAClC,QAED,GAAU,IAANA,GAAwB,GAAbquF,EAA+B,CACjD,IAAMQ,EAAgC,QAAtB,EAAAx7H,KAAK4gB,MAAMqsB,KAAKvtC,EAAI,UAAE,eAAEgtC,MAAM,GACxC+uF,EAAcD,GACd,aAAcA,EAAQ3kG,yBACtB,KAEA6kG,EAAsBD,EAEtBz7H,KAAK06H,MACLe,EAAYhgF,QAAUy/E,EAAOz/E,MAC7BggF,EAAY1kG,OAASmkG,EAAOnkG,KAH5B,KAKN/2B,KAAKu7H,cACD1xH,GAAKqxH,EAAOlkG,IAAMkkG,EAAO3/E,QAAU,GAAKmgF,EAClCF,EACAtqE,GACN,QAGJlxD,KAAKu7H,cAAc,MAGvBv7H,KAAK27H,cAAczqE,GAGnB,QAIR,GAAIvkB,EAAIuzD,EAAGxzD,MAAM/sC,OACb,MAKRK,KAAK26H,oBACT,EAEQ,YAAAA,kBAAR,WACS36H,KAAK+5H,aACN/5H,KAAK+5H,YAAa,aACd/5H,KAAK4gB,MACL5gB,KAAKsxB,OACLtxB,KAAK06H,MACL16H,KAAKy4B,SACLz4B,KAAKu6H,cACLv6H,KAAKgkF,WACLhkF,KAAKy5H,kBAIRz5H,KAAK85H,eACN95H,KAAK85H,cAAe,aAChB95H,KAAK4gB,MACL5gB,KAAKsxB,OACLtxB,KAAK06H,MACL16H,KAAKk6H,mBACLl6H,KAAKg6H,gBACLh6H,KAAKgkF,WACLhkF,KAAKy5H,iBAGjB,EAEQ,YAAAkC,cAAR,SAAsBzqE,GACdlxD,KAAK45H,mBAAqB55H,KAAK45H,kBAAkB/qH,MAAQqiD,GACzDlxD,KAAK46H,uBAGJ56H,KAAK45H,mBAAqB1oE,IAC3BlxD,KAAK45H,mBAAoB,aACrB55H,KAAKsxB,OACL4/B,EACAlxD,KAAK4gB,MACL5gB,KAAK06H,OACL,EACA16H,KAAKo6H,kBACLp6H,KAAKg6H,gBACLh6H,KAAKy5H,iBAETz5H,KAAK65H,iBAAkB,aACnB75H,KAAKsxB,OACL4/B,EACAlxD,KAAK4gB,MACL5gB,KAAK06H,OACL,EACA16H,KAAKo6H,kBACLp6H,KAAKg6H,gBACLh6H,KAAKy5H,iBAGjB,EAMQ,YAAA8B,cAAR,SAAsBrqE,EAAiC0qE,GACnD,IAAMC,EAAWD,EAAe57H,KAAK05H,mBAAqB15H,KAAK25H,iBAK/D,IAJW,OAAPzoE,GAAgB2qE,GAAYA,EAAShtH,MAAQqiD,IAC7ClxD,KAAK66H,wBAGJ76H,KAAK05H,qBAAuB15H,KAAK25H,kBAAoBzoE,EAAI,CAC1D,IAAM4qE,GAAc,aAChB97H,KAAKsxB,OACL4/B,EACAlxD,KAAK4gB,MACL5gB,KAAK06H,QACHkB,EACF57H,KAAKs6H,WACLt6H,KAAKu6H,cACLv6H,KAAKy5H,iBAELmC,EACA57H,KAAK05H,mBAAqBoC,EAE1B97H,KAAK25H,iBAAmBmC,EAGpC,EAEQ,YAAAzB,oBAAR,WACQr6H,KAAK85H,gBACL,IAAAiC,yBAAwB/7H,KAAK85H,cAC7B95H,KAAK85H,aAAe,KAE5B,EAEQ,YAAAe,qBAAR,WACQ76H,KAAK05H,sBACL,IAAAqC,yBAAwB/7H,KAAK05H,oBAC7B15H,KAAK05H,mBAAqB,MAE1B15H,KAAK25H,oBACL,IAAAoC,yBAAwB/7H,KAAK25H,kBAC7B35H,KAAK25H,iBAAmB,KAEhC,EAEQ,YAAAiB,oBAAR,WACQ56H,KAAK45H,qBACL,IAAAmC,yBAAwB/7H,KAAK45H,mBAC7B55H,KAAK45H,kBAAoB,MAEzB55H,KAAK65H,mBACL,IAAAkC,yBAAwB/7H,KAAK65H,iBAC7B75H,KAAK65H,gBAAkB,KAE/B,EAEQ,YAAAiB,kBAAR,WACQ96H,KAAK+5H,cACL,IAAAgC,yBAAwB/7H,KAAK+5H,YAC7B/5H,KAAK+5H,WAAa,KAE1B,EA2BQ,YAAAI,cAAR,WACIn6H,KAAKi6H,oBAAqB,EAC1B,IAAMlkF,EAAQ/1C,KAAKsxB,OAAO0kB,kBAEtBD,GAAuB,SAAdA,EAAM7e,OACfl3B,KAAK+1C,MAAQA,EAAMA,OAGvB/1C,KAAKsxB,OAAOsuC,cAChB,EAyCJ,EApVA,6GC5CA,WACA,WACA,WACA,WACA,WA2EA,SAAS2nB,EAAYhf,EAA6B15B,GACtC,IAAAqiB,EAAgBqX,EAAO,GAAnByzD,EAAYzzD,EAAO,QACzB3xC,GAAO,aAAcs6B,EAAGr6B,yBAGxBolG,EAAc/qE,EAAGW,UACjBvlB,EACF4kB,EAAGnsD,gBAAiB,IAAAiiF,iBAAgB91B,EAAGnsD,cAAe,MAAQmsD,EAAGnsD,mBAAgBvD,EAC/EowD,EAAWtlB,aAAG,EAAHA,EAAKslB,SAEtB,GAAgBpwD,MAAZowD,EACA,MAAO,CACHsqE,aAAS16H,EACT26H,kBAAc36H,EACd46H,eAAW56H,EACX66H,iBAAkB,EAClBC,UAAW,IAIX,IAAAhrG,EAAkBi3C,EAAO,OAAjB3nD,EAAU2nD,EAAO,MAG3Bld,EAAY/5B,EAAO0kB,kBAGzB1kB,EAAOksD,gBAAgB,CACnBtmD,KAAM,QACNojB,YAAa,EACb40B,SAAU,EACVE,WAAY,EACZD,QAAS,EACTvuD,MAAOA,IAIX,IAAMs7G,GAAU,IAAA1kD,uBAAsBlmD,EAAO4hC,oBAAoB,iBAAiB,GAKlF,OAFA5hC,EAAOksD,gBAAgBnyB,GAEnBz0B,GAAQslG,GACRF,IAEO,CACHE,QAAO,EACPC,aAAcF,EACdG,UAAWxqE,EACXyqE,gBAAiBH,EAAQjvF,KAAK2kB,GAAUvhC,OACxCisG,WAAW,EAAF,iCAAMJ,EAAQlvF,SAAM,KAG1B,CACHkvF,QAAO,EACPC,kBAAc36H,EACd46H,eAAW56H,EACX66H,iBAAkB,EAClBC,UAAW,GAGvB,CAEA,SAASC,EACLh0D,EACA15B,EACAlL,EACA6zF,EACAC,GAEQ,IAAA72G,EAAU2nD,EAAO,MACjB2zD,EAAwCv4F,EAAS,QAAxCy4F,EAA+Bz4F,EAAS,UAA7B04F,EAAoB14F,EAAS,gBAGzD,GAAIu4F,GAAwB16H,MAAb46H,EAAwB,CAEnCF,EAAQjvF,KAAKmvF,GAAW/rG,QAAUgsG,QAAAA,EAAmB,GAAK5E,GAG1D,IAAAx+C,gBAAeijD,GAIf,IADA,IAAM9mB,EAAWx0F,EAAMqsB,KAAKmvF,GACnB1/E,EAAM,EAAGA,EAAM04D,EAAS1oE,MAAM/sC,OAAQ+8C,IAChC04D,EAAS1oE,MAAMgQ,GACvBpuB,MAAM+B,OAAS6rG,EAAQjvF,KAAKmvF,GAAW/rG,OAAS,KAGvD,OAAO,EAEP,OAAO,CAEf,CAEA,SAASmsG,EACLj0D,EACA15B,EACAlL,EACA6zF,GAEQ,IAAA52G,EAAiB2nD,EAAO,MAAjBmyD,EAAUnyD,EAAO,MACxB2zD,EAAqCv4F,EAAS,QAArCw4F,EAA4Bx4F,EAAS,aAAvB24F,EAAc34F,EAAS,UAGtD,GAAIu4F,GAA2B16H,MAAhB26H,EAA2B,CAEtC,IACM5lD,EAASihD,GAAUkD,GAAS,EAAI,GAEtC,GAHmByB,GAAgBD,EAAQlvF,OAAOrtC,OAAS,EAKvDu8H,EAAQlvF,OAAOmvF,GAAgBG,EAAUH,GAAgB5lD,MACtD,CAEH,IAAMkmD,EAAeH,EAAUH,GAAgB5lD,EACzCmmD,EAAmBJ,EAAUH,EAAe,GAAK5lD,EACvD,GACIkmD,EAAe,EAAA9kC,8BACf+kC,EAAmB,EAAA/kC,6BAEnB,OAAO,EAEXukC,EAAQlvF,OAAOmvF,GAAgBM,EAC/BP,EAAQlvF,OAAOmvF,EAAe,GAAKO,GAIvC,IAAAzjD,gBAAeijD,GAGf,IAAK,IAAI5vF,EAAM,EAAGA,EAAM1rB,EAAMqsB,KAAKttC,OAAQ2sC,IAEvC,IADA,IAAM8oE,EAAWx0F,EAAMqsB,KAAKX,GACnBoQ,EAAM,EAAGA,EAAM04D,EAAS1oE,MAAM/sC,OAAQ+8C,IAC3C04D,EAAS1oE,MAAMgQ,GAAKpuB,MAAMD,MAAQ6tG,EAAQlvF,OAAO0P,GAAO,KAIhE,OAAO,EAEP,OAAO,CAEf,CAEA,SAASigF,EAAsBp0D,EAA6B0hD,GAChD,IAAA/4D,EAAOqX,EAAO,GAChB3xC,GAAO,aAAcs6B,EAAGr6B,yBAC1BD,IACAqzF,EAAQxqH,GAAK,oBACbwqH,EAAQ37F,MAAM0I,IAAMJ,EAAK2kB,OArNN,EAqNoC,KACvD0uE,EAAQ37F,MAAMyI,KAAOH,EAAKG,KAAO,KACjCkzF,EAAQ37F,MAAMD,MAAQuI,EAAK6kB,MAAQ7kB,EAAKG,KAAO,KAC/CkzF,EAAQ37F,MAAM+B,OAASusG,MAE/B,CAEA,SAASC,EAAoBt0D,EAA6B0hD,GAC9C,IAAA/4D,EAAcqX,EAAO,GAAjBmyD,EAAUnyD,EAAO,MACvB3xC,GAAO,aAAcs6B,EAAGr6B,yBAC1BD,IACAqzF,EAAQxqH,GAAK,kBACbwqH,EAAQ37F,MAAM0I,IAAMJ,EAAKI,IAAM,KAC/BizF,EAAQ37F,MAAMyI,MAAQ2jG,EAAQ9jG,EAAKG,KAAOH,EAAK6kB,OAlO5B,EAkO0D,EAAI,KACjFwuE,EAAQ37F,MAAMD,MAAQuuG,MACtB3S,EAAQ37F,MAAM+B,OAASuG,EAAK2kB,OAAS3kB,EAAKI,IAAM,KAExD,CAjOA,mBACI1F,EACA4/B,EACAtwC,EACA85G,EACAkB,EACAI,EACAc,EACArD,GAEA,IAAMn2H,EAAW4tD,EAAG30C,cACdwgH,EAAoB,CACtBr3G,IAAK,MACL4I,MAAO,6BAA4BstG,EAAe,MAAQ,OAAK,8BAE7D5oG,EAAY1B,EAAO+3D,eAAejM,qBAElCxtD,GAAM,aAAcmtG,EAAmBz5H,IAE5Cm2H,GAAmBn2H,EAAS8e,MAAMte,YAAY8rB,GAE/C,IAAM24C,EAA8B,CAAEj3C,OAAM,EAAE4/B,GAAE,EAAEtwC,MAAK,EAAE85G,MAAK,EAAE1nG,UAAS,EAAEgpG,QAAO,GAC5EjvE,EAAc6uE,EAAee,EAAwBE,EAC3D9vE,EAAYwb,EAAS34C,GAErB,IAAMsnG,EAAwE,CAC1E3vC,YAAW,EAEXmwC,WAAYkE,EAAeW,EAAuBC,EAClD5E,UAAWkF,GAYf,MAAO,CAAEjuH,KAAMqiD,EAAIthC,IAAG,EAAEotG,eATD,IAAI,UACvBptG,EACA24C,EACAxb,EACAmqE,EACAlkG,EACA1B,EAAOw6D,iBAAiBrtB,kBAIhC,gHC9CA,mCAAwCxoC,aAChCA,IACuB,QAAvB,EAAW,QAAX,EAAAA,EAAQrG,WAAG,eAAEzO,kBAAU,SAAEnc,YAAYixB,EAAQrG,KAC7CqG,EAAQrG,IAAM,KACQ,QAAtB,EAAAqG,EAAQ+mG,sBAAc,SAAEhvF,UACxB/X,EAAQ+mG,eAAiB,KAEjC,iFCrBA,eACA,WACA,WACA,WACA,WAkBA,mBACI1rG,EACA4/B,EACAtwC,EACA85G,EACAkB,EACAqB,EACA1C,EACAd,GAEA,IAAMyB,GAAS,aAAchqE,EAAGr6B,yBAC1BqmG,EAAW5rG,EAAOitD,qBAClBw8C,EAAYn6G,GAASs8G,GAAW,aAAmB,CAACt8G,GAAQ,CAACs8G,IAAa,KAGhF,GAAIhC,GAAUH,EAAW,CACrB,IAAM,EAAW7pE,EAAG30C,cACdwgH,EA6Gd,SACInB,EACAjoH,EACA+mH,EACAzpG,GAEA,IAAMksG,EAAgBxpH,EA3IO,QADV,UAyJnB,MAAO,CACH+R,IAAK,MACL4I,MAdkB,+KAA+O6uG,EAAa,2CAA2ClsG,EAezTolG,SAAU,CAZuB,CACjC3wG,IAAK,MACL4I,MAHoB,iEAAiE2C,EAAe,KAK/F2qG,GANWlB,EAAQ,QAAU,QAOV,wDAAwDyC,EAAa,8BAA8BA,EAAa,6BAA6BA,EAAa,sBACxK,4DAA4DA,EAAa,6BAA6BA,EAAa,8BAA8BA,EAAa,uBAMlJ,KAE9B,CArIkCC,CACtBxB,EACAtqG,EAAOtD,aACP0sG,EACAppG,EAAO+3D,eAAegL,YAAY,oBAAsB,SAGtDzkE,GAAM,aAAcmtG,EAAmB,GAkC7C,OAhCInB,GAEAhsG,EAAInwB,GAAK,qBACTmwB,EAAItB,MAAMyI,MACN2jG,EACMK,EAAUt/E,MACVs/E,EAAUhkG,KAAO,IAAqD,KAEhFnH,EAAItB,MAAM0I,IAASkkG,EAAO3/E,OAAS,EAAC,KACnC3rB,EAAIxK,WAA2BkJ,MAAMD,MAAW0sG,EAAUt/E,MAAQs/E,EAAUhkG,KAAI,OAEjFnH,EAAInwB,GAAK,mBACTmwB,EAAItB,MAAMyI,MAAU2jG,EAAQQ,EAAOnkG,KAAO,EAAImkG,EAAOz/E,MAAQ,GAAC,KAE9D7rB,EAAItB,MAAM0I,IACN+jG,EAAU/jG,IAAM,GAAqD,KAExEpH,EAAIxK,WAA2BkJ,MAAM+B,OAAY0qG,EAAUx/E,OAASw/E,EAAU/jG,IAAG,OAGrFyiG,GAAmB,EAASr3G,MAAMte,YAAY8rB,GAYxC,CAAEA,IAAG,EAAEotG,eAVE,IAAIK,EAChBztG,EACAshC,EACAtwC,EACAg7G,EACAtqG,EACA2rG,EACA1C,GAGmC1rH,KAAMqiD,GAGjD,OAAO,IACX,EAEA,iBAEI,WACYthC,EACAshC,EACAtwC,EACAg7G,EACAtqG,EACA2rG,EACR1C,GAPJ,WACY,KAAA3qG,IAAAA,EACA,KAAAshC,GAAAA,EACA,KAAAtwC,MAAAA,EACA,KAAAg7G,aAAAA,EACA,KAAAtqG,OAAAA,EACA,KAAA2rG,SAAAA,EAkBJ,KAAAK,SAAW,WAEf,IAAMrB,EAAc,EAAK/qE,GAAGW,UACtBvlB,EACF,EAAK4kB,GAAGnsD,gBAAiB,IAAAiiF,iBAAgB,EAAK91B,GAAGnsD,cAAe,MAC1D,EAAKmsD,GAAGnsD,mBACRvD,EACJowD,EAAWtlB,GAAOA,EAAIslB,SAEVpwD,OAAd8qC,aAAG,EAAHA,EAAKI,QAAkClrC,MAAZowD,KAK/B,IAAAyR,6BACI,EAAK/xC,OACL,mBACA,SAAAimD,GACI,EAAKqkD,cACC,IAAAz4D,gBAAeoU,EAAY,gBAC3B,IAAAnU,mBAAkBmU,EAAY,cACxC,GACA,CACIrgD,KAAM,QACNojB,YAAa2hF,EACb/sD,SAAUtd,EACVwd,WAAY6sD,EACZ9sD,QAASvd,EACThxC,MAAO,EAAKA,QAIpB,EAAKq8G,WACT,EAhDIj9H,KAAK4vB,IAAI4D,iBAAiB,QAASxzB,KAAKs9H,UACxCt9H,KAAKu9H,gBAAkBhD,EAAc3qG,GACrC5vB,KAAK4vB,IAAI4D,iBAAiB,WAAYxzB,KAAKu9H,gBAC/C,CA8CJ,OA5CI,YAAAvvF,QAAA,WACIhuC,KAAK4vB,IAAImE,oBAAoB,QAAS/zB,KAAKs9H,UAEvCt9H,KAAKu9H,iBACLv9H,KAAK4vB,IAAImE,oBAAoB,WAAY/zB,KAAKu9H,iBAGlDv9H,KAAKu9H,gBAAkB,IAC3B,EAoCJ,EA5DA,iGCtFA,WACA,WACA,WACA,WAaA,mBACI38G,EACA0Q,EACAopG,EACA8C,EACAjD,EACAv2C,EACAy1C,GAEA,IAAM7iG,GAAO,aAAchW,EAAMiW,yBAEjC,IAmGJ,SAA2BvF,EAAiBsF,EAAmBotD,GAC3D,IAAMy5C,EAAkBnsG,EAAOitD,qBAC/B,IAAI,IAAAoE,cAAaqB,EAAY,iBAAmBy5C,GAAmB7mG,EAAM,CACrE,IAAM8mG,GAAgB,aAAc15C,EAAWntD,yBAE/C,QAAS6mG,GAAiBA,EAAc1mG,KAAOJ,EAAKI,KAAOymG,EAAgBzmG,KAAOJ,EAAKI,IAG3F,OAAO,CACX,CA5GS2mG,CAAkBrsG,EAAQsF,EAAMotD,GACjC,OAAO,KAGX,IAAMhxD,EAAY1B,EAAO+3D,eAAejM,qBAClC95E,EAAWsd,EAAMrE,cAMjBqT,GAAM,aALc,CACtBlK,IAAK,MACL4I,MAAO,qFAGkChrB,GAE7CssB,EAAInwB,GA/Be,eAgCnBmwB,EAAItB,MAAMD,MAAWuvG,OACrBhuG,EAAItB,MAAM+B,OAAYutG,QAErBnE,GAAmBn2H,EAAS8e,MAAMte,YAAY8rB,GAE/C,IAAM24C,EAA6B,CAC/B3nD,MAAK,EACLoS,UAAS,EACT4D,KAAI,EACJ8jG,MAAK,GAGTmD,EAAet1D,EAAS34C,GAExB,IAOMotG,EAAiB,IAAIc,EACvBluG,EACA24C,EACAs1D,EACA,CACIjG,UAZU,SAACrvD,EAA4B15B,GAI3C,OAHIA,EAAM3R,QAAUtN,GAChB4tG,EAAiBj1D,EAAQ3nD,QAEtB,CACX,GASI2nD,EAAQv1C,UACRunG,GAGJ,MAAO,CAAE3qG,IAAG,EAAEotG,eAAc,EAAEnuH,KAAM+R,EACxC,EAaA,kBAGI,WACYgP,EACR24C,EACA0uD,EAKAC,EACAlkG,EACAunG,EACApD,EACAz+F,GAZJ,MAcI,YAAM9I,EAAK24C,EAAS0uD,EAAUC,EAASlkG,EAAWmkG,IAAY,YAbtD,EAAAvnG,IAAAA,EAcR,EAAKuL,WAAao/F,EAAc3qG,GAChCA,EAAI4D,iBAAiB,WAAY,EAAK2H,aAC1C,CASJ,OA7BgC,oBAsB5B,YAAA6S,QAAA,WACI,YAAMA,QAAO,WACThuC,KAAKm7B,YACLn7B,KAAK4vB,IAAImE,oBAAoB,WAAY/zB,KAAKm7B,YAElDn7B,KAAKm7B,WAAa,IACtB,EACJ,EA7BA,CAAgC,WA+BhC,SAAS0iG,EAAet1D,EAA4B0hD,GACxC,IAAArzF,EAAS2xC,EAAO,KACpB3xC,IACAqzF,EAAQ37F,MAAM0I,IAASJ,EAAKI,IAjHT,GAiHiC,KACpDizF,EAAQ37F,MAAMyI,KAAUH,EAAKG,KAlHV,GAkHsC,EAAC,KAElE,gFC5HA,eACA,WACA,WACA,WACA,WAIMgnG,EAAuB,GAqF7B,SAASx2C,EAAYhf,EAA6B15B,GAC9C05B,EAAQyzD,UAEA,IAAA1qG,EAAkBi3C,EAAO,OAAjB3nD,EAAU2nD,EAAO,MAG3Bld,EAAY/5B,EAAO0kB,kBAGzB1kB,EAAOksD,gBAAgB,CACnBtmD,KAAM,QACNojB,YAAa,EACb40B,SAAU,EACVE,WAAY,EACZD,QAAS,EACTvuD,MAAOA,IAIX,IAAMs7G,GAAU,IAAA1kD,uBAAsBlmD,EAAO4hC,oBAAoB,iBAAiB,GAGlF5hC,EAAOksD,gBAAgBnyB,GAGvB,IAAM4qD,EAAoB,GAC1BimB,SAAAA,EAASjvF,KAAKnoC,SAAQ,SAAAwnC,GAClB2pE,EAAQzxG,KAAK8nC,EAAIjc,OACrB,IACA,IAAM2c,EAAmB,GAKzB,OAJAkvF,SAAAA,EAASlvF,OAAOloC,SAAQ,SAAAupB,GACpB2e,EAAOxoC,KAAK6pB,EAChB,IAEO,CACH2vG,aAAcp9G,EAAMiW,wBACpBqlG,QAAO,EACP+B,gBAAiBhoB,QAAAA,EAAW,GAC5BioB,eAAgBlxF,QAAAA,EAAU,GAElC,CAEA,SAAS0qF,EACLnvD,EACA15B,EACAlL,EACA6zF,EACAC,WAEQiD,EAA4BnyD,EAAO,MAA5Bv1C,EAAqBu1C,EAAO,UAAjB3nD,EAAU2nD,EAAO,MACnCy1D,EAA2Dr6F,EAAS,aAAtDs6F,EAA6Ct6F,EAAS,gBAArCu6F,EAA4Bv6F,EAAS,eAArBu4F,EAAYv4F,EAAS,QAEtEw6F,EAAS,EAAO3G,EAASwG,EAAa3vG,MAAS2E,GAAa0nG,GAAS,EAAI,GACzE0D,EAAS,EAAO3G,EAASuG,EAAa3tG,OAAU2C,EAChDqrG,EAAgBt1H,KAAKi5C,IAAIm8E,EAAS,GAAO,KACzCG,EAAgBv1H,KAAKi5C,IAAIo8E,EAAS,GAAO,KAQ/C,GALAx9G,EAAM0N,MAAM61C,YAAY,QAAS,MAEjCvjD,EAAM0N,MAAM61C,YAAY,SAAU,MAG9B+3D,GAAWA,EAAQjvF,OAASoxF,GAAiBC,GAAgB,CAE7D,IAAK,IAAI5+H,EAAI,EAAGA,EAAIw8H,EAAQjvF,KAAKttC,OAAQD,IACrC,IAAK,IAAIitC,EAAI,EAAGA,EAAIuvF,EAAQjvF,KAAKvtC,GAAGgtC,MAAM/sC,OAAQgtC,IACjCuvF,EAAQjvF,KAAKvtC,GAAGgtC,MAAMC,KAE3B0xF,GAAsB,GAAL3+H,IACjBw8H,EAAQlvF,OAAOL,IAAuB,QAAjB,EAAAuxF,EAAevxF,UAAE,QAAI,GAAKwxF,GAE/CG,GAAsB,GAAL3xF,IACjBuvF,EAAQjvF,KAAKvtC,GAAG2wB,QAA4B,QAAlB,EAAA4tG,EAAgBv+H,UAAE,QAAI,GAAK0+H,KAOrE,IAAAnlD,gBAAeijD,GAGf,IAAK,IAAI5vF,EAAM,EAAGA,EAAM1rB,EAAMqsB,KAAKttC,OAAQ2sC,IAAO,CAC9C,IAAM8oE,EAAWx0F,EAAMqsB,KAAKX,GAE5B,GAA6B,GAAzB8oE,EAAS1oE,MAAM/sC,OAKnB,IAAK,IAAI+8C,EAAM,EAAGA,EAAM04D,EAAS1oE,MAAM/sC,OAAQ+8C,IAAO,CAClD,IAAMwU,EAAKkkD,EAAS1oE,MAAMgQ,GAC1BwU,EAAG5iC,MAAMD,MAAQ6tG,EAAQlvF,OAAO0P,GAAO,KACvCwU,EAAG5iC,MAAM+B,OAAS6rG,EAAQjvF,KAAKX,GAAKjc,OAAS,MAGrD,OAAO,EAEP,OAAO,CAEf,CAEA,SAASunG,EACLrvD,EACA15B,EACAlL,GAaA,OAVI46F,EACIh2D,EAAQj3C,QACR,aAAci3C,EAAQ3nD,MAAMiW,yBAC5B0xC,EAAQyb,cAGZzb,EAAQ34C,IAAItB,MAAMkwG,WAAa,UAC/BX,EAAet1D,EAASA,EAAQ34C,MAEpC24C,EAAQu0D,SACD,CACX,CAEA,SAASe,EAAet1D,EAA6B0hD,GACzC,IAAArpG,EAAiB2nD,EAAO,MAAjBmyD,EAAUnyD,EAAO,MAC1B3xC,GAAO,aAAchW,EAAMiW,yBAE7BD,IACAqzF,EAAQ37F,MAAM0I,IAASJ,EAAK2kB,OAAM,KAClC0uE,EAAQ37F,MAAMyI,KAAO2jG,EACZ9jG,EAAKG,KAAOgnG,EAAuB,EAAC,KACpCnnG,EAAK6kB,MAAK,KAE3B,CAEA,SAASgjF,EAAYl2D,EAA6B0hD,GAC9CA,EAAQ37F,MAAMkwG,WAAa,QAC/B,CAEA,SAASD,EACLjtG,EACAsF,EACAotD,GAEA,IAAMy5C,EAAkBnsG,EAAOitD,qBAC/B,IAAI,IAAAoE,cAAaqB,EAAY,iBAAmBy5C,GAAmB7mG,EAAM,CACrE,IAAM8mG,GAAgB,aAAc15C,EAAWntD,yBAE/C,QACM6mG,GACFA,EAAcniF,QAAU3kB,EAAK2kB,QAC7BkiF,EAAgBliF,QAAU3kB,EAAK2kB,OAIvC,OAAO,CACX,CA1OA,mBACI36B,EACA0Q,EACAopG,EACAsB,EACAc,EACA94C,EACAy1C,GAIA,IAAK8E,EAAqBjtG,GAFb,aAAc1Q,EAAMiW,yBAEOmtD,GACpC,OAAO,KAGX,IAAM1gF,EAAWsd,EAAMrE,cACjByW,EAAY1B,EAAO+3D,eAAejM,qBAClC2/C,EAAoB,CACtBr3G,IAAK,MACL4I,MAAO,6BACHosG,EAAQ,KAAO,MAAI,yDAIrB9qG,GAAM,aAAcmtG,EAAmBz5H,GAE7CssB,EAAInwB,GA/BiB,iBAgCrBmwB,EAAItB,MAAMD,MAAW0vG,EAAoB,KACzCnuG,EAAItB,MAAM+B,OAAY0tG,EAAoB,MAEzCtE,GAAmBn2H,EAAS8e,MAAMte,YAAY8rB,GAE/C,IAAM24C,EAA8B,CAChCmyD,MAAK,EACL95G,MAAK,EACLoS,UAAS,EACTgpG,QAAO,EACPc,MAAK,EACLltG,IAAG,EACH0B,OAAM,EACN0yD,WAAU,GAkBd,OAfA65C,EAAet1D,EAAS34C,GAejB,CAAE/gB,KAAM+R,EAAOgP,IAAG,EAAEotG,eAbJ,IAAI,UACvBptG,EACA24C,EACAk2D,EACA,CACIl3C,YAAW,EACXmwC,WAAU,EACVE,UAAS,GAEb5kG,EACA1B,EAAOw6D,iBAAiBrtB,kBAIhC,8ICzEA,WACA,WACA,WACA,WAyDA,aAMI,WACYigE,EACRntG,EACQK,QADR,IAAAL,IAAAA,EAAA,SACQ,IAAAK,IAAAA,EAAA,IAFA,KAAA8sG,aAAAA,EAEA,KAAA9sG,qBAAAA,EAER,IAAM+sG,GAAa,IAAAC,oBAEnB5+H,KAAKuxB,eAAgB,EAAH,kBAAIotG,IAAU,YAAKptG,EAAcuzB,QAAO,SAAAl7C,GAAK,QAAEA,CAAF,MAAI,GACnE5J,KAAK6+H,KAAOF,EAAWxnE,WACvBn3D,KAAKilF,qBAAuBjlF,KAAKuxB,cAAcuzB,OAAOsgC,GACtDplF,KAAK8+H,yBAA2B9+H,KAAKuxB,cAAcsb,MAC/C,SAAA9d,GAAU,OAAAA,EAAO+0D,0BAAP,GAElB,CAwGJ,OAnGI,YAAAr1C,QAAA,WACI,MAAO,QACX,EAMA,YAAAC,WAAA,SAAWpd,GACP,IAAMytG,EAAc/+H,KAAK0+H,aAAa1+H,KAAK+0F,iBAAiBzjE,IAE5DtxB,KAAKuxB,cAAczsB,SAAQ,SAAAiqB,GAAU,OAAAA,EAAO2f,WAAWqwF,EAAlB,GACzC,EAKA,YAAA/wF,QAAA,WACI,IAAK,IAAItuC,EAAIM,KAAKuxB,cAAc5xB,OAAS,EAAGD,GAAK,EAAGA,IACjCM,KAAKuxB,cAAc7xB,GAE3BsuC,SAEf,EAEA,YAAA81C,2BAAA,SAA2Bj1C,GACvB,OAAO7uC,KAAK8+H,4BAA8B9+H,KAAKg/H,gCAAgCnwF,EACnF,EAEA,YAAAD,cAAA,SAAcC,SACJowF,EAAWj/H,KAAKk/H,iBAAiBrwF,GAEvC,GAAIowF,EAAU,CACV,IAAME,EAA+Bn/H,KAAKg/H,gCAAgCnwF,GAEtEswF,EAC0C,QAA1C,EAAAA,EAA6BvwF,qBAAa,cAA1CuwF,EAA6CF,GAE7Cj/H,KAAKuxB,cAAczsB,SAAQ,SAAAiqB,GAAM,MAAI,OAAoB,QAApB,EAAAA,EAAO6f,qBAAa,oBAApB7f,EAAuBkwG,EAAS,IAGzEh/H,OAAOC,OAAO2uC,GAAO,IAAAuwF,oBAAmBH,EAAUpwF,IAE1D,EAOA,YAAAs2C,oBAAA,SAAoBjoD,GAChB,IAAMmiG,EAAkB,GAaxB,OAXAr/H,KAAKilF,qBAAqBngF,SAAQ,SAAAogF,SACxBrwC,EAA4C,QAApC,EAAAqwC,EAASC,oBAAoBjoD,UAAO,QAAI,IAClD2X,aAAK,EAALA,EAAOl1C,QAAS,IACZ0/H,EAAS1/H,OAAS,GAClB0/H,EAAS76H,KAAK,MAGlB66H,EAAS76H,KAAI,MAAb66H,GAAQ,mCAASxqF,IAAK,IAE9B,IAEOwqF,CACX,EAEQ,YAAAL,gCAAR,SAAwCnwF,GAAxC,WACI,OAAO,IAAAkpD,mBAAkBlpD,EAxIO,kCAwIiC,SAAAA,SACvDowF,EAAW,EAAKC,iBAAiBrwF,GAEvC,GAAIowF,EACA,IAAK,IAAIv/H,EAAI,EAAGA,EAAI,EAAK6xB,cAAc5xB,OAAQD,IAAK,CAChD,IAAMqvB,EAAS,EAAKwC,cAAc7xB,GAElC,GAAqC,QAAjC,EAAAqvB,EAAO+0D,kCAA0B,oBAAjC/0D,EAAoCkwG,GACpC,OAAOlwG,EAKnB,OAAO,IACX,GACJ,EAEQ,YAAAmwG,iBAAR,SAAyBrwF,GACrB,OAAO,IAAAkpD,mBAAkBlpD,EAzJb,yBAyJiC,EAAAywF,mBACjD,EAEQ,YAAAvqC,iBAAR,SAAyBzjE,SACrB,MAAO,CACHiuG,WAAY,CAAC,EACb3tG,qBAA+C,QAAzB,EAAA5xB,KAAK4xB,4BAAoB,QAAI,GACnD4tG,gBAAiBC,EAAsBnuG,GACvCyrD,kBAAkB,IAAA2Z,wBAAuBplE,EAAOw4D,mBAChD+0C,KAAM7+H,KAAK6+H,KACX55C,qBAAsBjlF,KAAKilF,qBAEnC,EACJ,EA3HA,GAiIA,SAAgBw6C,EAAsBnuG,GAClC,OAAO,SAAAinB,GAAQ,OAAAA,EAAOjnB,EAAO+3D,eAAejM,oBAA7B,CACnB,CAEA,SAASgI,EACLtvE,SAEA,SAAiD,QAAxC,EAAiCA,SAAO,eAAEqvE,oBACvD,CAzIa,EAAAu6C,aAAAA,EAiIb,mIC7LA,eAaA,aAQI,aAPQ,KAAApuG,OAAyB,KAQ7BtxB,KAAKc,MAAQ,CACT81D,SAAU,CAAC,EAEnB,CAqEJ,OAhEI,YAAAnoB,QAAA,WACI,MAAO,MACX,EAMA,YAAAC,WAAA,SAAWpd,GACPtxB,KAAKsxB,OAASA,CAClB,EAKA,YAAA0c,QAAA,WACIhuC,KAAKsxB,OAAS,IAClB,EAKA,YAAA6lC,SAAA,WACI,OAAOn3D,KAAKc,KAChB,EAMA,YAAA8tC,cAAA,SAAcC,SACN8wF,GAAiB,EACjB/oE,EAA4D,KAC5DyhE,GAAa,EACXuH,EAAoC,GAAnB/wF,EAAMC,UAE7B,GAAI8wF,EAAgB,CAChB,IAAM95E,EAAWjX,EAAMiX,SACjB/P,EAAmB,QAAX,EAAA/1C,KAAKsxB,cAAM,eAAEuuG,oBAG3BF,GADAtH,GAAa,IAAAlrC,qBAAoBrnC,KACFA,EAASmnC,OACxCr2B,EACI52D,KAAKc,MAAM81D,SAAS9Q,EAAS1tB,QAC5B2d,IAAUA,EAAME,WAAaj2C,KAAKc,MAAM81D,SAAS,UAC5B,GAAnB/nB,EAAMC,YACb8nB,EAAW52D,KAAKc,MAAM81D,SAAS,MAGnC,IAAK,IAAIl3D,EAAI,EAAGk3D,GAAYl3D,GAAIk3D,aAAQ,EAARA,EAAUj3D,QAAQD,IAAK,CACnD,IAAM86H,EAAU5jE,EAASl3D,GACzB,IACK86H,EAAQsF,oBAAsBH,IAC/B3/H,KAAKsxB,QACLkpG,EAAQuF,kBAAkBlxF,EAAO7uC,KAAKsxB,OAAQ+mG,GAChD,CACEmC,EAAQwF,YAAYnxF,EAAO7uC,KAAKsxB,QAC5BsuG,IACA/wF,EAAMy4E,sBAAuB,GAEjC,OAGZ,EACJ,EAjFA,GAuFA,8BACI,OAAO,IAAI56F,CACf,iHCtGA,eAIMmhF,EAAiB,0DAIvB,aACI,WAAoBoyB,GAAA,KAAAA,aAAAA,CAA2C,CAkInE,OA5HI,YAAAC,mBAAA,WACI,OAAOjgI,OAAOqiC,OAAOtiC,KAAKigI,aAAan/D,YAC3C,EASA,YAAAq/D,cAAA,SAAcnvG,EAAwBhD,EAAqBymE,GACvD,IACI2rC,EADEC,EAAcrgI,KAAKsgI,gBAAgBtvG,GASzC,OANIqvG,IACArvG,EAAiBqvG,EAAYrvG,eAC7ByjE,EAAgB4rC,EAAY5rC,eAAiBA,EAC7C2rC,EAAWC,EAAYh5H,KAGvB2mB,GAAcgD,GACdovG,EACIA,GAAY,eAAyBpvG,EAAenZ,QAAQ,WAAY,KAE5E7X,KAAKigI,aAAa1rC,iBAAiBvmE,EAAYoyG,EAAU,CACrDpvG,eAAc,EACdyjE,cAAeA,GAAiBz0F,KAAKigI,aAAatuG,aAAaX,KAG5D,OAAOovG,EAAQ,KAAKpvG,EAAc,KAElCA,CAEf,EAKA,YAAA0jE,MAAA,WACI10F,KAAKigI,aAAavrC,OACtB,EASA,YAAA4rC,gBAAA,SAAgBv0H,EAAkCw0H,SAC1Cl5H,EAEAotF,EADAzjE,EAAiB,GAGrB,GAAIjlB,EAAO,CACP,IAAMM,EAAQN,EAAMmyC,WAlER,QAkEsC2vD,EAAe5nG,KAAK8F,GAAS,KAE3EM,EACIA,EAAM,IACNhF,EAAMgF,EAAM,GACZ2kB,EAAiB3kB,EAAM,GACvBooF,EAAkD,QAAlC,EAAAz0F,KAAKigI,aAAan/D,YAAYz5D,UAAI,eAAEotF,eAEpDzjE,EAAiB,GAEduvG,GAIPvvG,EAAiBhxB,KAAKq/G,4BAA4BtzG,IAAU,MAGxD0oF,EAAgB1oF,GAGpBilB,EAAiBjlB,EAIzB,MAAO,CAAE1E,IAAG,EAAE2pB,eAAc,EAAEyjE,cAAa,EAC/C,EAMA,YAAA4qB,4BAAA,SAA4B10D,GACxB,IAAMw0D,GAAY,IAAA/V,YAAWz+C,GACvBmW,EAAc9gE,KAAKigI,aAAan/D,YAEtC,GAAIq+C,EAAW,CACX,IAAM93G,GAAM,IAAA2yB,eAAc8mC,GAAahf,MAAK,SAAAz6C,GACxC,IAAM+3G,GAAa,IAAAhW,YAAWtoC,EAAYz5D,GAAKotF,eAE/C,OACI2qB,GACAA,EAAW,IAAMD,EAAU,IAC3BC,EAAW,IAAMD,EAAU,IAC3BC,EAAW,IAAMD,EAAU,EAEnC,IAEA,GAAI93G,EACA,OAAOy5D,EAAYz5D,GAAK2pB,eAIhC,OAAO,IACX,EAQA,YAAAwvG,sBAAA,SAAsB3nH,EAAsB4nH,EAAuB3hC,GAC/D,IAAMhuE,GAAY,IAAAiuE,UAASlmF,GAAS,GAAyBimF,EAAY9+F,KAAKigI,cACxEjhC,GAAY,IAAAD,UAASlmF,GAAS,GAAwBimF,EAAY9+F,KAAKigI,eAE7E,IAAAxtE,UAAS55C,EAASiY,GAAW,EAAwBguE,EAAY9+F,KAAKigI,eACtE,IAAAxtE,UAAS55C,EAASmmF,GAAW,EAAuBF,EAAY9+F,KAAKigI,aACzE,EACJ,EAnIA,GAwIA,kCAAuCA,GACnC,OAAO,IAAIrrC,EAAqBqrC,EACpC,6HClJA,WACA,WACA,WACA,WAEA,WAKA,WAgDA,WAcA,WA2BMS,IAAiB,MACnB,GAA4B,OAC5B,KAA4B,YAC5B,KAAgC,gBAChC,KAA8B,OAC9B,KAAuC,UAO3C,cAQI,WAAY18C,EAA4Bn0D,gBAAA,IAAAA,IAAAA,EAAA,IAAxC,WACU8wG,EAAe,IAAI,EAAAjB,cACrB,SAAA9kD,GAGI,OAFA,EAAKgmD,uBAAyBhmD,EAEvB,CACX,GACA/qD,EAAQ0B,cACR1B,EAAQ+B,sBAGNvC,GAAU,EAAH,kBAAIsxG,IAAY,YAAqB,QAAf,EAAA9wG,EAAQR,eAAO,QAAI,KAAG,GACnDwxG,EAAoC,QAAtB,EAAAhxG,EAAQkC,sBAAc,QAAIiyD,EAAW7hE,UACnD6yE,EACF6rC,IAAgBhxG,EAAQmlE,cAClB,IAAAwC,qBACIqpC,EACAhxG,EAAQmnE,yBACRnnE,EAAQiC,mBACRjC,EAAQ4B,sBAEZ5B,EAAQmlE,aACZ8rC,GAAuB,gCACtBjxG,GAAO,CACVR,QAAO,EACP2lE,aAAY,WAGhB,cAAMhR,EAAY88C,IAAwB,IAC9C,CA+9BJ,OApgCmC,oBA0C/B,YAAA9yF,QAAA,WACI,YAAMA,QAAO,WAEb,IAAM4sC,EAAO56E,KAAK4gI,uBAEdhmD,KACA,IAAA5gD,eAAc4gD,EAAK2kD,YAAYz6H,SAAQ,SAAAuC,GACnC,IAAMiO,EAAOslE,EAAK2kD,WAAWl4H,GAEzBiO,GAAQA,EAAK4/B,UACb5/B,EAAK4/B,SAAS5/B,EAAKzU,cAGhB+5E,EAAK2kD,WAAWl4H,EAC3B,IAEArH,KAAK4gI,4BAAyBp/H,EAEtC,EAMA,YAAAuyE,WAAA,WACI,OAAO,YAAMA,WAAU,aAAO/zE,KAAK4gI,sBACvC,EAYA,YAAAG,WAAA,SAAWlyH,EAAYlK,SACnB,GAAIkK,EAAM,CACNlK,EAASA,GAAU,CACfy2B,SAAU,EACV0xB,iBAAiB,EACjBF,cAAc,EACdC,kBAAkB,EAClBm0E,oBAAoB,GAGhB,IAAAjmD,EAAiB/6E,KAAKk1F,UAAS,aAMvC,GAJIvwF,EAAOioD,cACP5sD,KAAK+tC,QAGc,GAAnBppC,EAAOy2B,SACgB,QAAvB,EAAA2/C,EAAa55D,kBAAU,SAAEkB,aAAaxT,EAAMksE,EAAard,iBACtD,CACC19D,KAAKguB,eACL,IAAA67D,gBACIh7E,GACA,EACA,cACA7O,KAAK8pF,mBAIb,IAAMz+B,GAAY,IAAA01E,YAAWhmD,EAAc/6E,KAAKg2C,kBAAmBnnC,EAAMlK,GAErE0mD,GAAa1mD,EAAOioD,cACpB5sD,KAAKw9E,gBAAgBnyB,GAI7B,OAAO,EAEP,OAAO,CAEf,EAOA,YAAA41E,WAAA,SAAWpyH,GAEP,SAAIA,GAAQ7O,KAAKo/E,SAASvwE,IAASA,EAAKsS,cACpCtS,EAAKsS,WAAWnc,YAAY6J,IACrB,EAIf,EASA,YAAAqyH,YAAA,SAAYC,EAAoBC,EAAcC,SACpCzmD,EAAO56E,KAAKk1F,UAElB,SAAIl1F,KAAKo/E,SAAS+hD,KAAiBC,IAC3BxmD,EAAKE,UAAU9sD,YAAcqzG,GAC7BrhI,KAAKshI,qBAAqBF,EAAQ,GAGf,QAAvB,EAAAD,EAAahgH,kBAAU,SAAEosF,aAAa6zB,EAAQD,GAEvC,GAIf,EAOA,YAAAI,sBAAA,SAAsB1yH,GAClB,OAAO,IAAA0yH,uBAAsBvhI,KAAKk1F,UAAUvZ,YAAa9sE,EAC7D,EAEA,YAAAuwE,SAAA,SAASj5D,GACL,QAAKA,IAGE,IAAAi5D,UAASp/E,KAAKk1F,UAAUvZ,YAAmBx1D,EACtD,EAEA,YAAAunC,cAAA,SACIF,EACAg0E,EAIA7qG,QAJA,IAAA6qG,IAAAA,EAAA,GAMA,IAAM5mD,EAAO56E,KAAKk1F,UACZpvF,EAAwB,GACxB27H,EAAQD,aAA2BvqH,SAAW,EAAkBuqH,EACtE7qG,EAAW6qG,aAA2BvqH,SAAWuqH,EAAkB7qG,EAEnE,IAAM+qG,EAAuB,GAATD,EAA2B,KAAOzhI,KAAKsrD,sBAC3D,OAAIo2E,GACAA,EAAYC,OAAO78H,SAAQ,SAAAixC,GACvBjwC,EAAOtB,KAAI,MAAXsB,GAAM,oCAAS,IAAA4nD,eAAcktB,EAAKe,YAAanuB,EAAU72B,EAAU8qG,EAAO1rF,KAAM,GACpF,IAWGjwC,IATI,IAAA4nD,eACHktB,EAAKe,YACLnuB,EACA72B,EACA8qG,OACAjgI,EAKZ,EAaA,YAAAogI,cAAA,SAAcn/H,EAAaC,EAAWm/H,GAClC,OAAO,IAAAD,eAAc5hI,KAAKk1F,UAAUna,aAAct4E,EAAOC,EAAKm/H,EAClE,EAWA,YAAAthB,QAAA,SAAQvoG,GACJ,OAAO,IAAA8pH,aAAY9hI,KAAKk1F,UAAUna,aAAc/iE,EACpD,EAOA,YAAA0iB,WAAA,SAAW14B,GACP,YADO,IAAAA,IAAAA,EAAA,IACA,IAAA6pB,eACH7rB,KACA0gI,EAAkB1+H,GAClBhC,KAAKk1F,UAAU9T,mBAAmB1E,WAE1C,EAOA,YAAAvb,WAAA,SAAW7hE,EAAiB8qD,QAAA,IAAAA,IAAAA,GAAA,GACxB,IAAMwwB,EAAO56E,KAAKk1F,UACVna,EAAuEH,EAAI,aAA7Dc,EAAyDd,EAAI,IAAxD9oD,EAAoD8oD,EAAI,mBAApCE,EAAgCF,EAAI,UAAzBmC,EAAqBnC,EAAI,iBAEnFc,EAAI32B,aACA61B,EACA,CACI9rC,UAAW,mBACX+xC,WAAYvhF,IAEhB,GAGJ,IAAM2jG,GAAW,IAAAzL,qBACbl4F,EACAs7E,EAAK4B,mBAAmBE,WACxB5qD,EACA8oD,EAAKtqD,OAAOC,eAGhBmrD,EAAI7oB,gBAAgB+nB,EAAMqoB,GAEtB74C,EACAsxB,EAAI32B,aACA61B,EACA,CACI9rC,UAAW,iBACXh5B,OAAQ,eAEZ,GAEGglE,EAAU9sD,aACjB,IAAA67D,gBAAe9O,GAAc,EAAuB,cAAegC,EAE3E,EAWA,YAAAl0B,cAAA,SAAcvpD,EAAiBqF,SAC3B,GAAIrF,EAAS,CACT,IAAMsiB,EAAM5hB,KAAK2uC,cACXvsB,EAGL,QAHY,OAAIrG,WAAYiG,gBACzBhiB,KAAKk1F,UAAUpjE,mBAAmBxyB,GAClC,oBACH,eAAE8iB,KACC2/G,GAAW3/G,aAAI,EAAJA,EAAME,aAAa,IAAAogE,SAAQtgE,EAAKE,YAAc,GAKzD3d,GAAUA,EAAOmoD,iBAAmBi1E,EAASpiI,OAAS,IACtDoiI,EAAW,EAAC,IAAA37G,MAAK27G,KAGrB,IAAM,EAAWngH,EAAInE,yBACrBskH,EAASj9H,SAAQ,SAAA+J,GAAQ,SAAS/K,YAAY+K,EAArB,IAEzB7O,KAAK+gI,WAAW,EAAUp8H,GAElC,EAKA,YAAAq9H,sBAAA,WACI,IAAMjsF,EAAQ/1C,KAAK6/H,oBACnB,OAAI9pF,IAAUA,EAAME,WACT,IAAA+rF,uBAAsBhiI,KAAKk1F,UAAUna,aAAchlC,GAEvD,IACX,EAUA,YAAAnF,MAAA,SACImN,EACAkkF,EACAC,EACAC,QAFA,IAAAF,IAAAA,GAAA,QACA,IAAAC,IAAAA,GAAA,QACA,IAAAC,IAAAA,GAAA,GAEAniI,KAAKg+C,mBACDD,EACAkkF,EACM,cACAC,EACA,cACAC,EACA,UACA,SAEd,EAaA,YAAAtC,kBAAA,SAAkBuC,QAAA,IAAAA,IAAAA,GAAA,GACd,IAAM/2E,EAAYrrD,KAAKg2C,kBAEvB,MAA0B,UAAnBqV,aAAS,EAATA,EAAWn0B,MAAkBm0B,EAAUtV,MAAQ,IAC1D,EASA,YAAAuV,oBAAA,WACI,IAAMD,EAAYrrD,KAAKg2C,kBAEvB,OAAO,IAAAqsF,8BAA6Bh3E,EACxC,EAOA,YAAAi3E,iBAAA,WACI,IAAMvsF,EAAQ/1C,KAAK6/H,oBACnB,OAAO9pF,IAAS,IAAAusF,kBAAiBtiI,KAAKk1F,UAAUna,aAAchlC,EAClE,EAEA,YAAAmS,OAAA,SACIq6E,EACAC,EACAC,EACAC,GAEA,IAAM9nD,EAAO56E,KAAKk1F,UACZytC,GAAU,IAAAC,cAAahoD,EAAKG,aAAcwnD,EAAMC,EAAMC,EAAMC,GAC5Dr3E,GAAY,IAAAw3E,8BAA6BF,GAG/C,OADA3iI,KAAKw9E,gBAAgBnyB,IACd,CACX,EAKA,YAAAsS,mBAAA,iBACUqR,EAAoC,QAA9B,EAAAhvE,KAAK2uC,cAAcwH,mBAAW,eAAE8S,eAC5C,IAAI+lB,aAAG,EAAHA,EAAKgQ,YAAah/E,KAAKo/E,SAASpQ,EAAIgQ,WACpC,OAAO,IAAI,EAAA8jD,SAAS9zD,EAAIgQ,UAAWhQ,EAAIkQ,aAG3C,IAAMnpC,EAAQ/1C,KAAK6/H,oBACnB,OAAI9pF,EACO,EAAA+sF,SAASC,SAAShtF,GAGtB,IACX,EAcA,YAAA2a,mBAAA,SACIlD,EACAw1E,EACAn0F,GAHJ,aAOI,OAFAA,EAAQm0F,OAAYxhI,EAAYqtC,EAY1B,QATF,OAAAkpD,mBAAkBlpD,QAAAA,EAAS,KAAM,yBAA2B2e,GAAU,WAClE,IAAKw1E,EAAW,CACZ,IAAM5nG,EAAW,EAAKuiC,qBACtBqlE,EAAY5nG,aAAQ,EAARA,EAAUvsB,KAE1B,OACIm0H,IACA,IAAAz9E,4BAA2By9E,EAAW,EAAK9tC,UAAUna,aAAcvtB,EAE3E,WAAE,QAAI,IAEd,EAQA,YAAAy1E,sBAAA,SAAsB7nG,GAClB,OAAO,IAAA8nG,yBAAwB9nG,EAAUp7B,KAAKk1F,UAAUvZ,YAC5D,EAKA,YAAAttB,mBAAA,SAAmBn3B,QAAA,IAAAA,IAAAA,EAAA,GACf,IAAMm0B,EAAYrrD,KAAKsrD,sBACjBxlD,EAAmB,GACnB61E,EAAc37E,KAAKk1F,UAAUvZ,YAInC,OAHAtwB,EAAUs2E,OAAO78H,SAAQ,SAAAixC,GACrBjwC,EAAOtB,KAAI,MAAXsB,GAAM,mCAAUiwC,GAAQ,IAAAotF,qBAAoBxnD,EAAa5lC,EAAO7e,GAAQ,KAAG,GAC/E,IACOpxB,EAAOg/C,QAAO,SAACjkD,EAAOsF,EAAOwL,GAChC,OAAOA,EAAKb,QAAQjQ,KAAWsF,CACnC,GACJ,EAMA,YAAAi9H,mBAAA,SACIC,EACAnM,SAEMoM,EAAgC,iBAAbD,IAAuB,MAAIA,GAAYnM,EAAQ,GAAKmM,EACvEE,EAAkD,CAAC,EA2BzD,OAzBA,IAAAvpG,eAAcspG,GAAWx+H,SAAQ,SAAAuC,GAC7B,IAAMm8H,EAAaF,EAAUj8H,GACzBvB,EAAyB,CACzBw1E,gBAAiB,KACjBC,eAAgB,MAGpB,GAA0B,iBAAfioD,EACP19H,EAAOw1E,gBAAkB,EAAAmoD,2BAA2BD,QACjD,GAA0B,mBAAfA,EACd19H,EAAOy1E,eAAiBioD,OACrB,GAA0B,iBAAfA,EAAyB,CACvC,IAAMl/H,EAASk/H,EACf19H,EAAS,CACLy1E,eAAgBj3E,EAAOi3E,eACvBD,gBACqC,iBAA1Bh3E,EAAOg3E,gBACR,EAAAmoD,2BAA2Bn/H,EAAOg3E,sBAClC95E,GAIlB+hI,EAAgBl8H,GAAOvB,CAC3B,IAEO9F,KAAKm7E,eAAeooD,EAC/B,EAWO,YAAAG,mBAAP,SACI50F,EACAx5B,EACAuuE,cAAA,IAAAA,IAAAA,GAAA,GAEA,IAAMo7C,GAAW,eACbnwF,UAAS,GACNx5B,GAEDquH,GAAW,IAAAvE,oBAAmBH,GAC9BrkD,EAAO56E,KAAKk1F,UAElB,OAAIyuC,GACA/oD,EAAKc,IAAI32B,aAAa61B,EAAM+oD,EAAU9/C,GACQ,QAAtC,OAAAy7C,oBAAmBqE,EAAU1E,UAAS,QAAIA,GAE3CA,CAEf,EAOA,YAAA70E,2BAAA,SACIt0C,EACAR,QADA,IAAAQ,IAAAA,EAAA,cAGA9V,KAAK0jI,mBAAmB,EAAgC,CACpD5tH,OAAM,EACNR,KAAI,GAEZ,EASA,YAAAsvC,KAAA,YACI,IAAAA,MAAK5kD,KACT,EAKA,YAAA8+C,KAAA,YACI,IAAAA,MAAK9+C,KACT,EAYA,YAAA0lD,gBAAA,SACI/uB,EACAu8C,EACA2H,EACA+oD,WAKItuH,EAHEslE,EAAO56E,KAAKk1F,UACZ2uC,EAAYjpD,EAAKh2B,KACjBw5B,EAAWylD,EAAUzlD,SAGtBA,IACDylD,EAAUzlD,UAAW,GAKjBxD,EAAKh2B,KAAKs2B,iBAAiBtH,gBAC1BgwD,aAAc,EAAdA,EAAgBh+E,iBAChBjvB,GAEDikD,EAAKc,IAAIh2B,gBACLk1B,IACEC,EAC4B,QAA9B,EAAA+oD,aAAc,EAAdA,EAAgBh+E,sBAAc,oBAA9Bg+E,KAKZ,IACI,GAAIjtG,EAAU,CACV,IAAM00B,EACAtV,EAA2B,UAAnBsV,OADRA,EAAYuvB,EAAKc,IAAI1lC,gBAAgB4kC,SACpB,EAATvvB,EAAWn0B,MAAkBm0B,EAAUtV,MAAQ,KAM7D,GALAzgC,EAAOqhB,EACHof,GAAS,EAAA+sF,SAASC,SAAShtF,GAAO27C,YAClC37C,GAAS,EAAA+sF,SAASgB,OAAO/tF,GAAO27C,cAG/BtT,EAAU,CACX,IAAMvf,EAA6C,QAA9B,EAAA+kE,aAAc,EAAdA,EAAgBh+E,sBAAc,oBAA9Bg+E,GAErBhpD,EAAKc,IAAIh2B,gBAAgBk1B,GAAM,EAAkC/b,aAIpEuf,IACDylD,EAAUzlD,UAAW,GAI7B,GAAIznD,GAAYu8C,EAAc,CAC1B,IAAM,EAA6B,CAC/BpkC,UAAW,EACXh5B,OAAQo9D,EACR59D,KAAMA,EACNsuH,eAAc,GAElB5jI,KAAK0jI,mBAAmB,EAAgC,GAAO,GAG/D7oD,GAGuB,UAAnBxvB,OAFEA,EAAYuvB,EAAKc,IAAI1lC,gBAAgB4kC,SAE9B,EAATvvB,EAAWn0B,QACX0jD,EAAKh2B,KAAKs2B,iBAAiBtH,eAAgB,EAC3CgH,EAAKh2B,KAAK84B,aAAeryB,EAAUtV,MAAM4nC,eACzC/C,EAAKh2B,KAAKg5B,UAAYvyB,EAAUtV,MAAM8nC,YAGlD,EAKA,YAAAkmD,aAAA,WACY,IAAA7oD,EAAqBl7E,KAAKk1F,UAAUtwC,KAAI,iBAChD,MAAO,CACHD,QACIu2B,EAAiBtH,eAAiBsH,EAAiBxZ,SAAS,GAChE7iB,QAASq8B,EAAiBxZ,QAAQ,GAE1C,EAcA,YAAAsiE,cAAA,SAAiB38H,EAAa07B,EAAkBmS,GAC5C,IAAM0lC,EAAO56E,KAAKikI,4BAClB,OAAQrpD,EAAK2kD,WAAWl4H,GAAOuzE,EAAK2kD,WAAWl4H,IAAQ,CACnDxG,MAAOkiC,EAASA,SAAWvhC,EAC3B0zC,SAAQ,IACTr0C,KACP,EAMA,YAAAqjI,iBAAA,WACI,IAAM5zG,EAAStwB,KAAKk1F,UAAU5kE,OAAOC,cAErC,MAAO,CACHE,MAAM,IAAAgf,QAAOnf,EAAOE,YACpBE,OAAQJ,EAAOI,OACfC,UAAWL,EAAOK,UAClBC,WAAYN,EAAOM,WACnBC,SAAUP,EAAOO,SACjBC,UAAWR,EAAOQ,UAClBG,gBAAiBX,EAAOW,gBAEhC,EAMA,YAAAu4B,iBAAA,SAAiBm0C,GACb,OAAO,EAAAwmC,iBAAiBC,oBAAoBpkI,KAAKk1F,UAAUvZ,YAAagiB,EAC5E,EAMA,YAAA0mC,sBAAA,SAAsBtuF,SAElB,OADAA,EAAyC,QAAjC,EAAAA,QAAAA,EAAS/1C,KAAK6/H,2BAAmB,aAAIr+H,GAEvC,EAAA2iI,iBAAiBG,yBAAyBtkI,KAAKk1F,UAAUvZ,YAAa5lC,GACtE,IACV,EAOA,YAAAwuF,kBAAA,SACIvB,QAAA,IAAAA,IAAAA,EAAA,GAEA,IAAMjtF,EAAQ/1C,KAAK6/H,oBACnB,OAAO9pF,EACD,EAAAouF,iBAAiBK,qBAAqBxkI,KAAKk1F,UAAUvZ,YAAa5lC,EAAOitF,GACzE,IACV,EAQA,YAAAyB,2BAAA,SAA2B51F,GAA3B,WACI,OAAO,IAAAkpD,mBAAkBlpD,QAAAA,EAAS,KAAM,mBAAmB,WACvD,IAAMkH,EAAQ,EAAK8pF,oBACnB,OACI9pF,GACA,IAAI,EAAA2uF,wBAAwB,EAAKxvC,UAAUvZ,YAAa,EAAAmnD,SAASC,SAAShtF,GAElF,GACJ,EAOA,YAAAsT,SAAA,SAAS1yB,GAAT,WACU1B,EAAMj1B,KAAKk1F,UAAUna,aAAax+D,cAAc45B,aAAen1C,OAC/D2jI,EAAS1vG,EAAIuxD,uBAAsB,YAChC,EAAKzS,cAAgBp9C,GACtBA,EAAS,EAEjB,IAEA,OAAO,WACH1B,EAAI2vG,qBAAqBD,EAC7B,CACJ,EAOA,YAAAE,sBAAA,SAAsB31H,EAAcrO,GAChCb,KAAKqpF,eAAe8K,gBAAgBjlF,EAAMrO,EAC9C,EAMA,YAAAikI,sBAAA,SAAsB51H,GAClB,OAAOlP,KAAKqpF,eAAe+K,gBAAgBllF,EAC/C,EAWA,YAAA61H,4BAAA,SAA4BlsH,EAAsBmsH,GAC9C,GAAIhlI,KAAKo/E,SAASvmE,GAAU,CACxB,IAAMkiE,EAAe/6E,KAAKk1F,UAAUna,aAC9BkqD,EAAalqD,EAAalkD,wBAC1BquG,EAAcrsH,EAAQge,wBAE5B,GAAIouG,GAAcC,EAAa,CAC3B,IAAIt7H,EAAIs7H,EAAYnuG,MAAOkuG,aAAU,EAAVA,EAAYluG,MACnCltB,EAAIq7H,EAAYluG,KAAMiuG,aAAU,EAAVA,EAAYjuG,KAOtC,OALIguG,IACAp7H,GAAKmxE,EAAaoqD,WAClBt7H,GAAKkxE,EAAaqqD,WAGf,CAACx7H,EAAGC,IAInB,OAAO,IACX,EAMA,YAAAw7H,sBAAA,SAAsB7K,GAClB,IAAM5/C,EAAO56E,KAAKikI,4BAClBzJ,SAAAA,EAASttH,KAAKpI,SAAQ,SAAAuC,GAClB,IAAMwK,EAAQ+oE,EAAKikD,KAAKjoE,SAASvvD,IAAQ,GACzCwK,EAAMrN,KAAKg2H,GACX5/C,EAAKikD,KAAKjoE,SAASvvD,GAAOwK,CAC9B,GACJ,EAMA,YAAAyzH,yBAAA,SAAyB9K,GACrB,IAAM5/C,EAAO56E,KAAKikI,4BAClBzJ,SAAAA,EAASttH,KAAKpI,SAAQ,SAAAuC,SACZk+H,EAAa3qD,EAAKikD,KAAKjoE,SAASvvD,GAChClB,EAAoC,QAA5B,EAAAo/H,aAAU,EAAVA,EAAYz0H,QAAQ0pH,UAAQ,SAAK,EAC3Cr0H,GAAS,IACTy0E,EAAKikD,KAAKjoE,SAASvvD,GAAKwJ,OAAO1K,EAAO,GAClCy0E,EAAKikD,KAAKjoE,SAASvvD,GAAK1H,OAAS,UAC1Bi7E,EAAKikD,KAAKjoE,SAASvvD,GAGtC,GACJ,EAMA,YAAAm+H,yBAAA,WACI,IAAMl1G,EAAStwB,KAAKylI,sBAEpB,MAAO,CACHx0G,gBAAiBX,EAAOW,gBACxB8N,UAAWzO,EAAOyO,UAClByQ,SAAUlf,EAAOkf,SACjB3e,SAAUP,EAAOO,SACjBL,WAAYF,EAAOE,WACnByP,WAAY3P,EAAO2P,WACnBwhB,aAAcnxB,EAAOmxB,aACrBE,UAAWrxB,EAAOqxB,UAClBpf,UAAWjS,EAAOiS,UAClBzR,UAAWR,EAAOQ,UAE1B,EAOA,YAAA40G,uBAAA,WACI,IAAMp1G,EAAStwB,KAAKylI,sBAEpB,MAAO,CACHh2F,OAAQnf,EAAOmf,OACfC,SAAUpf,EAAOof,SACjBC,gBAAiBrf,EAAOqf,gBACxBC,YAAatf,EAAOsf,YACpBC,cAAevf,EAAOsf,YACtBE,YAAaxf,EAAOwf,YAE5B,EAQA,YAAA61F,sBAAA,SAAsBvqG,EAAwBwqG,GAE9C,EAWA,YAAAtE,qBAAA,SACIzyH,EACAkwB,QAAA,IAAAA,IAAAA,EAAA,GAIA,IAAM67C,EAAO56E,KAAKk1F,UAEdta,EAAKE,UAAU9sD,aACf,IAAA67D,gBACIh7E,GACA,EACa,GAAbkwB,EAAmD,cAAgB,cACnE67C,EAAKmC,iBAGjB,EAMA,YAAAjsB,iBAAA,SAAiB0pE,GACb,OACIx6H,KAAKikI,4BAA4BryG,qBAAqB9gB,QAClD0pH,IACC,CAEb,EAQA,YAAAqL,aAAA,WACI,OAAO7lI,KAAKqpF,eAAejM,oBAC/B,EAQA,YAAAn4B,aAAA,SAAal3B,GACLA,EAAQ,GAAKA,GAAS,IACL/tB,KAAK6lI,gBAEN93G,GACZ/tB,KAAK+kD,aACD,cACA,CACIC,aAAcj3B,IAElB,EAIhB,EAKA,YAAA+3G,mBAAA,WACI,OAAO9lI,KAAKikI,4BAA4BzE,eAC5C,EAKA,YAAAuG,oBAAA,WAEI,OADa/lI,KAAKikI,4BACNlnD,gBAChB,EAMA,YAAAjf,QAAA,WACI,OAAO99D,KAAKk1F,UAAUzV,SAAS3hB,OACnC,EAEQ,YAAA2nE,oBAAR,WACI,IAAMhyD,EAAgBzzE,KAAK0zE,mBACrB5tE,EAAkC,CAAC,EACnC0C,EAAQxI,KAAKkzD,oBAAoB,WAIvC,OAFA,IAAA2gB,0BAAyBrrE,EAAOirE,EAAe3tE,GAExCA,CACX,EAMQ,YAAAm+H,0BAAR,WACI,IAAKjkI,KAAK4gI,uBACN,MAAM,IAAIn4H,MAAM,8BAGpB,OAAOzI,KAAK4gI,sBAChB,EACJ,EApgCA,CAAmC,EAAAhuG,QAAtB,EAAA9C,cAAAA,uGC/Gb,eAaA,wBACI/U,EACAwnH,EACAC,EACAC,EACAC,GAEA,IA8DMr3E,EAYAn9C,EA1EFy0H,EAAmC,KAEvC,GAiDJ,SAA4BlyH,GACxB,IAAMkyH,EAAUlyH,EAChB,OACIkyH,GACkB,iBAAXA,GACgB,iBAAhBA,EAAQzrG,MACf1wB,MAAMC,QAAQk8H,EAAQhB,OAE9B,CAzDQqE,CAAmBzD,GACnBI,EAAUJ,OACP,IAAI,IAAAl5F,gBAAek5F,EAAM,sBA6Dd,QAHZl3E,EA1DwEm3E,IA8DzEn3E,GACuB,iBAAbA,GACuB,iBAAvBA,EAAUS,WACY,iBAAtBT,EAAUU,UAhErB42E,EAAU,CACNzrG,KAAM,EACNyqG,OAAQ,GACRz1E,iBAAiB,EACjBtrC,MAAO2hH,EACP32E,YAAa42E,QAAAA,OAAQhhI,QAEtB,IAAI,IAAA6nC,gBAAek5F,EAAM,0BAAsC,IAARC,EAC1DG,EAAU,CACNzrG,KAAM,EACNyqG,OAAQ,GACRz1E,iBAAiB,EACjB1jB,MAAO+5F,OAER,CACH,IAAMxsF,EAASwsF,GAET,IAAAl5F,gBAAek5F,EAAM,SACrBA,GAmDJr0H,EAlDoBq0H,IAoDI,iBAARr0H,GAAoB1H,MAAMC,QAAQyH,EAAKzL,QAAU+D,MAAMC,QAAQyH,EAAKxL,MAnDhF,IAAA6nD,aAAYxvC,EAAMwnH,EAAK9/H,MAAO8/H,EAAK7/H,KAsDjD,SAAwB+N,GACpB,IAAM1K,EAAM0K,EAEZ,OACI1K,GACc,iBAAPA,GACY,iBAAZA,EAAI8I,MACU,iBAAd9I,EAAI6nE,MAEnB,CA9Dcq4D,CAAe1D,KAAS,IAAAl5F,gBAAek5F,EAAM,SAC7C,IAAAh4E,aACUg4E,EACiBC,EACjBC,EACiBC,GAE3B,KAZA,KAcNC,EAAU5sF,EACJ,CACI7e,KAAM,EACNyqG,OAAQ,CAAC5rF,GACTmW,gBAAiBnW,EAAME,WAE3B,CACI/e,KAAM,EACNyqG,OAAQ,GACRz1E,iBAAiB,GAI/B,OAAOy2E,CACX,2KCrEA,eACA,WAqBMuD,EAAwD,CAC1DC,QAAS,EACTC,YAAa,EACb9xD,YAAa,EACb+xD,OAAQ,GAGNC,IAAiB,MACnB,GAAwB,UACxB,KAA4B,cAC5B,KAA4B,cAC5B,KAAuB,YAGrBC,IAA4B,MAC9B,GAAkD,yBAClD,KAAqD,4BACrD,KAAmD,6BAGjDC,EAAyF,CAC3FC,uBAAwB,EACxBC,0BAA2B,EAC3BC,wBAAyB,GAGvBC,IAAuB,MACzB,GAAgC,YAChC,KAAgC,YAChC,KAAoC,gBACpC,KAAsC,kBACtC,KAA8C,0BAC9C,MAAwC,oBACxC,KAA4B,QAC5B,UAAkCplI,EAClC,UAA6BA,EAC7B,UAAuCA,EACvC,UAAoCA,EACpC,WAAuCA,KAGrCqlI,EAA0E,CAC5EC,UAAW,EACXC,UAAW,EACXC,cAAe,EACfC,gBAAiB,EACjBC,wBAAyB,EACzBC,kBAAmB,GACnB7vF,MAAO,GAME,EAAAmsF,6BAA0B,MACnC,GAAiC,gBACjC,MAAiC,gBACjC,MAAyC,wBACzC,MAA+B,cAC/B,MAAoC,mBACpC,KAAkC,iBAClC,KAAkC,iBAClC,MAA+B,cAC/B,MAA6B,YAC7B,MAA+B,cAC/B,MAAqC,oBACrC,MAAmC,kBACnC,KAAyC,wBACzC,KAAyB,QACzB,KAA2B,UAC3B,KAA4B,WAC5B,KAAyB,QACzB,MAAqC,oBACrC,KAA6B,YAC7B,KAA2B,UAC3B,WAA6CjiI,EAC7C,MAA0B,SAC1B,MAAoC,mBACpC,MAA+B,iBAMnC,8BACI6qD,EACA+6E,+BA0a0B9xH,EAxa1B,OAAQ+2C,EAAMvd,WACV,KAAK,EACD,MAAO,CACHA,UAAW,gBACX20C,WAAYp3B,EAAMo3B,WAClB0b,eAAgB9yC,EAAM8yC,eACtBjiC,MAAO7Q,EAAM6Q,MACbnnB,MAAOsW,EAAMtW,MACb+P,SAAUuG,EAAMvG,UAGxB,KAAK,GACD,MAAO,CACHhX,UAAW,gBACXqwD,eAAgB9yC,EAAM8yC,gBAG9B,KAAK,GACD,MAAO,CACHrwD,UAAW,wBACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,UAGxB,KAAK,GACD,IAAMuhF,EAA6C,gBAAvBD,aAAQ,EAARA,EAAUt4F,WAA6Bs4F,OAAW5lI,EACxE8lI,EAAqBj7E,EAE3B,MAAO,CACHvd,UAAW,cACXiP,cAAesO,EAAMtO,cACrBkuD,gBACsC,QAAlC,EAAAq7B,EAAmBr7B,uBAAe,QAAIo7B,aAAmB,EAAnBA,EAAqBp7B,gBAC/DH,iBACyC,QADvB,EAAmC,QAAnC,EAAAw7B,EAAmBx7B,wBAAgB,QACjDu7B,aAAmB,EAAnBA,EAAqBv7B,wBAAgB,QAAI,CACrCpP,sBAAuB,GACvBG,yBAA0B,GAC1BkN,wBAAyB,CAAC,EAC1BD,qBAAsB,CAAC,EACvB1U,kBAAmB,CAAC,EACpB0H,gBAAiB,CAAC,EAClBE,oBAAqB,CAAC,GAE9BmC,eAAgB9yC,EAAM8yC,eACtBx6E,SAAU0nC,EAAM1nC,SAChBinF,UAAWv/C,EAAMu/C,UACjBC,eAAgBx/C,EAAMw/C,eACtBF,WAAYt/C,EAAMs/C,WAClB1rB,UAAWqmD,EAAkBj6E,EAAM4zB,YAG3C,KAAK,GACD,MAAO,CACHnxC,UAAW,mBACXqwD,eAAgB9yC,EAAM8yC,eACtBte,WAAYx0B,EAAMw0B,YAG1B,KAAK,EACD,MAAO,CACH/xC,UAAW,iBACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,UAGxB,KAAK,EACD,IAAMyhF,EACqB,mBAAvBH,aAAQ,EAARA,EAAUt4F,WAAgCs4F,OAAW5lI,EACzD,MAAO,CACHstC,UAAW,iBACXqwD,eAAgB9yC,EAAM8yC,eACtBvgB,gBAAiB2oD,aAAsB,EAAtBA,EAAwB3oD,gBACzC9rB,aAAcy0E,aAAsB,EAAtBA,EAAwBz0E,aACtCx9C,KAAM+2C,EAAM/2C,KACZupD,aAC4C,QAAxC,EAAoC,QAApC,EAAoB,QAApB,EAAAxS,EAAMu3E,sBAAc,eAAEh+E,sBAAc,8BAAI,QACxC2hF,aAAsB,EAAtBA,EAAwB1oE,aAC5BxT,UAAWk8E,aAAsB,EAAtBA,EAAwBl8E,UACnCv1C,OAAQu2C,EAAMv2C,OACd6oE,cACuC,QAAnC,EAAoB,QAApB,EAAAtyB,EAAMu3E,sBAAc,eAAEjlD,qBAAa,QAAI4oD,aAAsB,EAAtBA,EAAwB5oD,cACnE6oD,aACmE,QAsVrDlyH,EAtVgD,QAArC,EAAoB,QAApB,EAAA+2C,EAAMu3E,sBAAc,eAAE6D,uBAAe,uBAA1D,EAuVTnyH,EACD,CACIoyH,eAAgBpyH,EAAKoyH,eACfnB,EAA6BjxH,EAAKoyH,qBAClClmI,EACNmmI,cAAeryH,EAAKqyH,cACpBhuH,KAAMrE,EAAKqE,WAEfnY,SA/VyE,QAC/D+lI,aAAsB,EAAtBA,EAAwBC,cAGpC,KAAK,GACD,MAAO,CACH14F,UAAW,cACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,SAChBjR,MAAOwX,EAAMxX,OAGrB,KAAK,GACD,MAAO,CACH/F,UAAW,YACXqwD,eAAgB9yC,EAAM8yC,eACtB32D,MAAO6jB,EAAM7jB,MACb20B,OAAQ9Q,EAAM8Q,OACd6W,YAAa3nB,EAAM2nB,YACnBC,YAAa5nB,EAAM4nB,aAG3B,KAAK,GACD,MAAO,CACHnlC,UAAW,cACXqwD,eAAgB9yC,EAAM8yC,gBAG9B,KAAK,GACD,MAAO,CACHrwD,UAAW,oBACXqwD,eAAgB9yC,EAAM8yC,gBAG9B,KAAK,GACD,IAAMj5C,EAAY0gF,EAAwBv6E,EAAMnG,WAEhD,YAAqB1kD,IAAd0kD,OACD1kD,EACA,CACIstC,UAAW,kBACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,SAChBjgB,OAAQwmB,EAAMxmB,OACdqgB,UAAWA,EACXG,cAAegG,EAAMhG,cACrBvlD,MAAOurD,EAAMvrD,OAG3B,KAAK,EACD,MAAO,CACHguC,UAAW,wBACXqwD,eAAgB9yC,EAAM8yC,eACtB1b,WAAYp3B,EAAMo3B,YAG1B,KAAK,EACD,MAAO,CACH30C,UAAW,QACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,UAGxB,KAAK,EACL,KAAK,EACL,KAAK,EACD,MAAO,CACHhX,UACuB,GAAnBud,EAAMvd,UACA,UACmB,GAAnBud,EAAMvd,UACN,WACA,QACVqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,UAGxB,KAAK,GACD,MAAO,CACHhX,UAAW,oBACXqwD,eAAgB9yC,EAAM8yC,gBAG9B,KAAK,EACD,MAAO,CACHrwD,UAAW,YACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,UAGxB,KAAK,EACD,MAAO,CACHhX,UAAW,UACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,SAChBsiC,WAAY/7B,EAAM+7B,YAG1B,KAAK,GACD,MAAO,CACHt5C,UAAW,SACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,SAChB05B,gBAAiBnzB,EAAMmzB,iBAG/B,KAAK,GACD,IAAMooD,EACqB,qBAAvBR,aAAQ,EAARA,EAAUt4F,WAAkCs4F,OAAW5lI,EAE3D,MAAO,CACHstC,UAAW,mBACXqwD,eAAgB9yC,EAAM8yC,eACtB9b,aAC0C,QAAtC,EAAAukD,aAAwB,EAAxBA,EAA0BvkD,oBAAY,SACtC,IAAAw/C,8BAA6Bx2E,EAAMw7E,mBAG/C,KAAK,GACD,MAAO,CACH/4F,UAAW,cACXqwD,eAAgB9yC,EAAM8yC,eACtBn6C,aAAcqH,EAAMrH,cAG5B,QACI,OAEZ,EAKA,8BAAmCqH,EAAiB+6E,eAChD,OAAQ/6E,EAAMvd,WACV,IAAK,gBACD,MAAO,CACHA,UAAW,EACX20C,WAAYp3B,EAAMo3B,WAClB0b,eAAgB9yC,EAAM8yC,eACtBjiC,MAAO7Q,EAAM6Q,MACbnnB,MAAOsW,EAAMtW,MACb+P,SAAUuG,EAAMvG,UAGxB,IAAK,gBACD,MAAO,CACHhX,UAAW,GACXqwD,eAAgB9yC,EAAM8yC,gBAG9B,IAAK,wBACD,MAAO,CACHrwD,UAAW,GACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,UAGxB,IAAK,cACD,IAAMuhF,EACiB,KAAnBD,aAAQ,EAARA,EAAUt4F,WAA2Cs4F,OAAW5lI,EAiBpE,MAfqD,CACjDstC,UAAW,GACXiP,cAAesO,EAAMtO,cACrBohD,eAAgB9yC,EAAM8yC,eACtBx6E,SAAU0nC,EAAM1nC,SAChBinF,UAAWv/C,EAAMu/C,UACjBC,eAAgBx/C,EAAMw/C,eACtBF,WAAYt/C,EAAMs/C,WAClB1rB,UAAWimD,EAAkB75E,EAAM4zB,WACnCvjB,iBACyC,QAArC,EAAA2qE,aAAmB,EAAnBA,EAAqB3qE,wBAAgB,SAAI,IAAAorE,qCAC7Ch8B,iBAAkBz/C,EAAMy/C,iBACxBG,gBAAiB5/C,EAAM4/C,iBAK/B,IAAK,mBACD,MAAO,CACHn9D,UAAW,GACXqwD,eAAgB9yC,EAAM8yC,eACtBte,WAAYx0B,EAAMw0B,YAG1B,IAAK,iBACD,MAAO,CACH/xC,UAAW,EACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,UAGxB,IAAK,iBACD,IAAM,EAAeuG,EAAMwS,aAE3B,MAAO,CACH/vB,UAAW,EACXqwD,eAAgB9yC,EAAM8yC,eACtB7pF,KAAM+2C,EAAM/2C,KACZQ,OAAQu2C,EAAMv2C,OACd8tH,eAAgB,CACZjlD,cAAetyB,EAAMsyB,cACrB8oD,gBAAiBp7E,EAAMm7E,aACjB,WAAM,OAsJFlyH,EAtJuB+2C,EAAMm7E,cAwJjD,CACIE,eAAgBpyH,EAAKoyH,eACflB,EAA6BlxH,EAAKoyH,qBAClClmI,EACNmmI,cAAeryH,EAAKqyH,cACpBhuH,KAAMrE,EAAKqE,WAEfnY,EATV,IAA8B8T,CAtJE,OACN9T,EACNokD,eAAgB,EAAe,WAAM,eAAepkD,IAIhE,IAAK,cACD,MAAO,CACHstC,UAAW,GACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,SAChBjR,MAAOwX,EAAMxX,OAGrB,IAAK,YACD,MAAO,CACH/F,UAAW,GACXqwD,eAAgB9yC,EAAM8yC,eACtB32D,MAAO6jB,EAAM7jB,MACb20B,OAAQ9Q,EAAM8Q,OACd6W,YAAa3nB,EAAM2nB,YACnBC,YAAa5nB,EAAM4nB,aAG3B,IAAK,cACD,MAAO,CACHnlC,UAAW,GACXqwD,eAAgB9yC,EAAM8yC,gBAG9B,IAAK,oBACD,IAAM4oC,EACiB,KAAnBX,aAAQ,EAARA,EAAUt4F,WAAiDs4F,OAAW5lI,EAE1E,MAAO,CACHstC,UAAW,GACXqwD,eAAgB9yC,EAAM8yC,eACtBx6E,SAA6C,QAAnC,EAAAojH,aAAyB,EAAzBA,EAA2BpjH,gBAAQ,QAAIrhB,SAASma,yBAC1DuqH,cAAuD,QAAxC,EAAAD,aAAyB,EAAzBA,EAA2BC,qBAAa,QAAI,CACvDtlI,IAAK,GACLD,MAAO,KAInB,IAAK,kBACD,MAAO,CACHqsC,UAAW,GACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,SAChBjgB,OAAQwmB,EAAMxmB,OACdqgB,UAAW2gF,EAAwBx6E,EAAMnG,WACzCG,cAAegG,EAAMhG,cACrBvlD,MAAOurD,EAAMvrD,OAGrB,IAAK,wBACD,MAAO,CACHguC,UAAW,EACXqwD,eAAgB9yC,EAAM8yC,eACtB1b,WAAYp3B,EAAMo3B,YAG1B,IAAK,QACD,MAAO,CACH30C,UAAW,EACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,UAGxB,IAAK,UACL,IAAK,WACL,IAAK,QACD,MAAO,CACHhX,UACuB,WAAnBud,EAAMvd,UACA,EACmB,YAAnBud,EAAMvd,UACN,EACA,EACVqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,UAGxB,IAAK,oBACD,MAAO,CACHhX,UAAW,GACXqwD,eAAgB9yC,EAAM8yC,gBAG9B,IAAK,YACD,MAAO,CACHrwD,UAAW,EACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,UAGxB,IAAK,UACD,MAAO,CACHhX,UAAW,EACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,SAChBsiC,WAAY/7B,EAAM+7B,YAG1B,IAAK,SACD,MAAO,CACHt5C,UAAW,GACXqwD,eAAgB9yC,EAAM8yC,eACtBr5C,SAAUuG,EAAMvG,SAChB05B,gBAAiBnzB,EAAMmzB,iBAG/B,IAAK,mBACD,IAAMooD,EACiB,KAAnBR,aAAQ,EAARA,EAAUt4F,WAAgDs4F,OAAW5lI,EAEzE,MAAO,CACHstC,UAAW,GACXqwD,eAAgB9yC,EAAM8yC,eACtB0oC,iBAC8C,QAA1C,EAAAD,aAAwB,EAAxBA,EAA0BC,wBAAgB,SAC1C,IAAAxF,8BAA6Bh2E,EAAMg3B,eAG/C,IAAK,cACD,MAAO,CACHv0C,UAAW,GACXqwD,eAAgB9yC,EAAM8yC,eACtBn6C,aAAcqH,EAAMrH,aACpBoY,aACuB,KAAnBgqE,aAAQ,EAARA,EAAUt4F,WAA2Cs4F,EAAShqE,aAAe,GAGzF,QACI,OAEZ,qGClhBA,eA0CA,sBACI4mB,EACA34B,EACAx8C,EACAlK,WAEA,OAAQA,EAAOy2B,UACX,KAAK,EACL,KAAK,EACD,IAEI,EAFE6sG,EAA6B,GAAnBtjI,EAAOy2B,SACjByJ,GAAQ,IAAAqjG,0BAAyBlkD,EAAYikD,GAEnD,GAAIpjG,EAAO,CACP,IAAMqoE,EAAU+6B,EAAUpjG,EAAM+kB,eAAiB/kB,EAAMglB,aAEnDllD,EAAOmoD,iBACa,GAApBogD,EAAQhyF,WACR,IAAAitH,mBAAkBj7B,IAKd,IAAA7jE,gBAAex6B,EAAM,qBAGrB,GAAe,IAAA6zE,SAAQ7zE,EAAKyT,YACV,QAAlB,EAAA4qF,EAAQ/rF,kBAAU,SAAEkB,aAChBxT,EACAo5H,EAAU/6B,EAAUA,EAAQxvC,cAGhC,EAAiC,QAAlB,EAAAwvC,EAAQ/rF,kBAAU,eAAEkB,aAC/BxT,EACAo5H,EAAU/6B,EAAUA,EAAQxvC,aAMpC,EAAewvC,EAAQ7qF,aAAaxT,EAAMo5H,EAAU/6B,EAAQ9nF,WAAa,WAI7E,EAAe4+D,EAAWlgF,YAAY+K,GAK1C,GAAI,GAAgBlK,EAAOmoD,gBAAiB,CACxC,IAAMwkC,EAAQ9qF,MAAMC,QAAQ,GAAgB,EAAe,CAAC,IACvD,IAAAgkD,gBAAe6mC,EAAM,MAAQ,IAAA7mC,gBAAe6mC,EAAMA,EAAM3xF,OAAS,MAClE,IAAAymB,MAAKkrE,GAIb,MAEJ,KAAK,EAED,IAAM82C,EAAepkD,EAAWlgF,YAAY+K,GAGxCu5H,GAAgBzjI,EAAOmoD,mBAAoB,IAAArC,gBAAe29E,KAC1D,IAAAhiH,MAAKgiH,GAET,MACJ,KAAK,EACL,KAAK,EACG,MA7FhB,SACI/8E,EACA1mD,GAMA,IAAIoxC,EAA2B,UAAnBsV,aAAS,EAATA,EAAWn0B,MAAkBm0B,EAAUtV,MAAQ,KACvDsyF,EAAiB,KASrB,OAPuB,GAAnB1jI,EAAOy2B,UACPitG,EAAiBtyF,EACjBA,EAAQpxC,EAAOoxC,OACRA,IACPsyF,EAAiBtyF,EAAMuyF,cAGpB,CAAEvyF,MAAK,EAAEsyF,eAAc,EAClC,CA0E4CE,CAAgBl9E,EAAW1mD,GAArDoxC,EAAK,QAAEsyF,EAAc,iBAC3B,IAAKtyF,EACD,MAIApxC,EAAOkoD,mBAAqB9W,EAAME,WAClCF,EAAM+7C,iBAGV,IAAI/rF,EAAoB,EAAA+8H,SAASC,SAAShtF,GACtC+4D,OAAY,EAGZ/oG,EADApB,EAAOmoD,iBAAmBnoD,EAAOq8H,mBAiCjD,SACIh9C,EACAjuC,EACA3a,GAEA,IAAM0tB,GAAS,IAAAq6E,qBAAoBn/C,EAAYjuC,EAAO,GAAkB,GACpElnC,EAAoBusB,EAASvsB,KAEjC,GAAIi6C,EAAQ,CAKR,GAJqB,GAAjBj6C,EAAKqM,UAA8BkgB,EAASotG,UAC5C35H,GAAO,IAAA45H,eAAc55H,EAAcusB,EAASwyC,QAAQ,IAGpD/+D,GAAQi6C,EAAO8F,SACf,KAAO//C,GAAQA,EAAKsS,YAAc2nC,EAAO8F,WACrC,IAAA85E,iBAAgB75H,GAAM,GACtBA,EAAOA,EAAKsS,WAIhBtS,IACAusB,EAAW,IAAI,EAAA0nG,SAASj0H,GAAI,IAIpC,OAAOusB,CACX,CA1DsButG,CAA+B3kD,EAAYjuC,EAAOhwC,GAExDpB,EAAOmoD,kBACNgiD,GAAe,IAAAyyB,uBAAsBv9C,EAAYj+E,EAAI2rF,YAAY7iF,OAyDlF,SACIigG,EACA9qB,EACAj+E,GAEA,IAAI6iI,EAAU,IAAI,EAAA9F,SAASh0B,EAAajlD,cAAY,GACpD,IAAI,IAAAxgB,gBAAeu/F,EAAQ/5H,KAAM,uBAAwB,CACrD,IAAM+gB,EAAMo0D,EAAWznE,cAAc7Y,cAAc,QACrC,IAAA6mD,aAAYxkD,GACpBg7H,WAAWnxG,GACjBg5G,EAAU,IAAI,EAAA9F,SAASlzG,EAAK,GAEhC,OAAOg5G,CACX,CApEsBC,CAA4B/5B,EAAc9qB,EAAYj+E,IAEtD,IAAA+iI,sBAAqB9kD,EAAYn1E,EAAM9I,EAAKgwC,GAGtD,IAAMgzF,EACe,IAAjBl6H,EAAKqM,SAAwCrM,EAAKwgF,UAAYxgF,EAWlE,OATAknC,GAAQ,IAAAwU,aAAYxkD,IACdg7H,WAAWlyH,GAEblK,EAAOioD,cAAgBm8E,IACvBV,GAAiB,IAAA99E,aACb,IAAI,EAAAu4E,SAASiG,GAAa,GAAsBr3C,cAIjD22C,EACD,CACInxG,KAAM,QACN6e,MAAOsyF,EACP/oD,YAAY,QAEhB99E,EAElB,sJC5JA,eACA,WAUA,wCACImhI,GAEA,OAAQA,aAAO,EAAPA,EAASzrG,MACb,KAAK,EACD,MAAO,CACHA,KAAM,QACNsR,MAAOm6F,EAAQn6F,OAGvB,KAAK,EACD,OAAOm6F,EAAQhB,OAAOhiI,OAAS,EACzB,CACIu3B,KAAM,QACN6e,MAAO4sF,EAAQhB,OAAO,GACtBriD,YAAY,GAEhB,KAEV,KAAK,EACD,OAAOqjD,EAAQ/2E,YACT,CACI10B,KAAM,QACNtW,MAAO+hH,EAAQ/hH,MACf05B,YAAaqoF,EAAQ/2E,YAAYE,UAAUliD,EAC3CslE,SAAUyzD,EAAQ/2E,YAAYE,UAAUjiD,EACxCulE,WAAYuzD,EAAQ/2E,YAAYG,SAASniD,EACzCulE,QAASwzD,EAAQ/2E,YAAYG,SAASliD,GAE1C,KAEV,QACI,OAAO,KAEnB,EAKA,wCAA6CwhD,GACzC,OAAQA,aAAS,EAATA,EAAWn0B,MACf,IAAK,QACD,MAAO,CACHA,KAAM,EACNsR,MAAO6iB,EAAU7iB,MACjB0jB,iBAAiB,EACjBy1E,OAAQ,EAAC,IAAAp3E,aAAYc,EAAU7iB,SAGvC,IAAK,QACD,MAAO,CACHtR,KAAM,EACNyqG,OAAQ,CAACt2E,EAAUtV,OACnBmW,gBAAiBb,EAAUtV,MAAME,WAGzC,IAAK,QACD,MAAO,CACH/e,KAAM,EACNyqG,QAAQ,IAAA9pC,mBAAkBxsC,GAC1Ba,iBAAiB,EACjBtrC,MAAOyqC,EAAUzqC,MACjBgrC,YAAa,CACTE,UAAW,CAAEliD,EAAGyhD,EAAU/Q,YAAazwC,EAAGwhD,EAAU6jB,UACpDnjB,SAAU,CAAEniD,EAAGyhD,EAAU+jB,WAAYvlE,EAAGwhD,EAAU8jB,WAI9D,QACI,MAAO,CACHj4C,KAAM,EACNyqG,OAAQ,GACRz1E,iBAAiB,GAGjC,wGCnFA,eAAS,+EAAAp8B,aAAa,eCHtBtwB,EAAOM,QAAU,w/MCAjBN,EAAOM,QAAU,qnCCAjBN,EAAOM,QAAUkpI,sCCAjBxpI,EAAOM,QAAUqzB,8BCAjB3zB,EAAOM,QAAUmyB,iCCAjBzyB,EAAOM,QAAUmpI,kCCAjBzpI,EAAOM,QAAUopI,moBCgBjB,IAAIC,EAAgB,SAASC,EAAGvgI,GAI9B,OAHAsgI,EAAgBlpI,OAAOoW,gBAClB,CAAEgzH,UAAW,cAAgB7iI,OAAS,SAAU4iI,EAAGvgI,GAAKugI,EAAEC,UAAYxgI,CAAG,GAC1E,SAAUugI,EAAGvgI,GAAK,IAAK,IAAItI,KAAKsI,EAAO5I,OAAOO,UAAUC,eAAeC,KAAKmI,EAAGtI,KAAI6oI,EAAE7oI,GAAKsI,EAAEtI,GAAI,EAC7F4oI,EAAcC,EAAGvgI,EAC1B,EAEO,SAASygI,EAAUF,EAAGvgI,GAC3B,GAAiB,mBAANA,GAA0B,OAANA,EAC3B,MAAM,IAAIwP,UAAU,uBAAyBX,OAAO7O,GAAK,iCAE7D,SAAS0kE,IAAOvtE,KAAK0a,YAAc0uH,CAAG,CADtCD,EAAcC,EAAGvgI,GAEjBugI,EAAE5oI,UAAkB,OAANqI,EAAa5I,OAAOyW,OAAO7N,IAAM0kE,EAAG/sE,UAAYqI,EAAErI,UAAW,IAAI+sE,EACjF,CAEO,IAAIxtE,EAAW,WAQpB,OAPAA,EAAWE,OAAOC,QAAU,SAAkBC,GAC1C,IAAK,IAAIC,EAAGV,EAAI,EAAGW,EAAIC,UAAUX,OAAQD,EAAIW,EAAGX,IAE5C,IAAK,IAAIa,KADTH,EAAIE,UAAUZ,GACOO,OAAOO,UAAUC,eAAeC,KAAKN,EAAGG,KAAIJ,EAAEI,GAAKH,EAAEG,IAE9E,OAAOJ,CACX,EACOJ,EAASY,MAAMX,KAAMM,UAC9B,EAEO,SAASipI,EAAOnpI,EAAGmzB,GACxB,IAAIpzB,EAAI,CAAC,EACT,IAAK,IAAII,KAAKH,EAAOH,OAAOO,UAAUC,eAAeC,KAAKN,EAAGG,IAAMgzB,EAAEziB,QAAQvQ,GAAK,IAC9EJ,EAAEI,GAAKH,EAAEG,IACb,GAAS,MAALH,GAAqD,mBAAjCH,OAAOupI,sBACtB,KAAI9pI,EAAI,EAAb,IAAgBa,EAAIN,OAAOupI,sBAAsBppI,GAAIV,EAAIa,EAAEZ,OAAQD,IAC3D6zB,EAAEziB,QAAQvQ,EAAEb,IAAM,GAAKO,OAAOO,UAAUipI,qBAAqB/oI,KAAKN,EAAGG,EAAEb,MACvES,EAAEI,EAAEb,IAAMU,EAAEG,EAAEb,IAF4B,CAItD,OAAOS,CACT,CAEO,SAASupI,EAAWC,EAAYzsG,EAAQ71B,EAAK+R,GAClD,IAA2HgwH,EAAvH5/H,EAAIlJ,UAAUX,OAAQiJ,EAAIY,EAAI,EAAI0zB,EAAkB,OAAT9jB,EAAgBA,EAAOnZ,OAAOuW,yBAAyB0mB,EAAQ71B,GAAO+R,EACrH,GAAuB,iBAAZxC,SAAoD,mBAArBA,QAAQgzH,SAAyBhhI,EAAIgO,QAAQgzH,SAASD,EAAYzsG,EAAQ71B,EAAK+R,QACpH,IAAK,IAAI1Z,EAAIiqI,EAAWhqI,OAAS,EAAGD,GAAK,EAAGA,KAAS0pI,EAAIO,EAAWjqI,MAAIkJ,GAAKY,EAAI,EAAI4/H,EAAExgI,GAAKY,EAAI,EAAI4/H,EAAElsG,EAAQ71B,EAAKuB,GAAKwgI,EAAElsG,EAAQ71B,KAASuB,GAChJ,OAAOY,EAAI,GAAKZ,GAAK3I,OAAOW,eAAes8B,EAAQ71B,EAAKuB,GAAIA,CAC9D,CAEO,SAASihI,EAAQC,EAAYx/F,GAClC,OAAO,SAAUpN,EAAQ71B,GAAOijC,EAAUpN,EAAQ71B,EAAKyiI,EAAa,CACtE,CAEO,SAASC,EAAaC,EAAMC,EAAcN,EAAYO,EAAWC,EAAcC,GACpF,SAASnzF,EAAOtsC,GAAK,QAAU,IAANA,GAA6B,mBAANA,EAAkB,MAAM,IAAI0N,UAAU,qBAAsB,OAAO1N,CAAG,CAKtH,IAJA,IAGIuS,EAHAqhC,EAAO2rF,EAAU3rF,KAAMl3C,EAAe,WAATk3C,EAAoB,MAAiB,WAATA,EAAoB,MAAQ,QACrFrhB,GAAU+sG,GAAgBD,EAAOE,EAAkB,OAAIF,EAAOA,EAAKxpI,UAAY,KAC/E6pI,EAAaJ,IAAiB/sG,EAASj9B,OAAOuW,yBAAyB0mB,EAAQgtG,EAAUh7H,MAAQ,CAAC,GAC/Fs9G,GAAO,EACL9sH,EAAIiqI,EAAWhqI,OAAS,EAAGD,GAAK,EAAGA,IAAK,CAC7C,IAAI6oE,EAAU,CAAC,EACf,IAAK,IAAIhoE,KAAK2pI,EAAW3hE,EAAQhoE,GAAW,WAANA,EAAiB,CAAC,EAAI2pI,EAAU3pI,GACtE,IAAK,IAAIA,KAAK2pI,EAAUI,OAAQ/hE,EAAQ+hE,OAAO/pI,GAAK2pI,EAAUI,OAAO/pI,GACrEgoE,EAAQgiE,eAAiB,SAAU5/H,GAAK,GAAI6hH,EAAM,MAAM,IAAIn0G,UAAU,0DAA2D+xH,EAAkB5lI,KAAKyyC,EAAOtsC,GAAK,MAAQ,EAC5K,IAAI7E,GAAS,EAAI6jI,EAAWjqI,IAAa,aAAT6+C,EAAsB,CAAEnvC,IAAKi7H,EAAWj7H,IAAKwJ,IAAKyxH,EAAWzxH,KAAQyxH,EAAWhjI,GAAMkhE,GACtH,GAAa,aAAThqB,EAAqB,CACrB,QAAe,IAAXz4C,EAAmB,SACvB,GAAe,OAAXA,GAAqC,iBAAXA,EAAqB,MAAM,IAAIuS,UAAU,oBACnE6E,EAAI+5B,EAAOnxC,EAAOsJ,QAAMi7H,EAAWj7H,IAAM8N,IACzCA,EAAI+5B,EAAOnxC,EAAO8S,QAAMyxH,EAAWzxH,IAAMsE,IACzCA,EAAI+5B,EAAOnxC,EAAO0kI,QAAOL,EAAa97H,QAAQ6O,EACtD,MACSA,EAAI+5B,EAAOnxC,MACH,UAATy4C,EAAkB4rF,EAAa97H,QAAQ6O,GACtCmtH,EAAWhjI,GAAO6V,EAE/B,CACIggB,GAAQj9B,OAAOW,eAAes8B,EAAQgtG,EAAUh7H,KAAMm7H,GAC1D7d,GAAO,CACT,CAEO,SAASie,EAAkBjyH,EAAS2xH,EAActpI,GAEvD,IADA,IAAI6pI,EAAWpqI,UAAUX,OAAS,EACzBD,EAAI,EAAGA,EAAIyqI,EAAaxqI,OAAQD,IACrCmB,EAAQ6pI,EAAWP,EAAazqI,GAAGgB,KAAK8X,EAAS3X,GAASspI,EAAazqI,GAAGgB,KAAK8X,GAEnF,OAAOkyH,EAAW7pI,OAAQ,CAC5B,CAEO,SAAS8pI,EAAU/gI,GACxB,MAAoB,iBAANA,EAAiBA,EAAI,GAAG7G,OAAO6G,EAC/C,CAEO,SAASghI,EAAkBjgI,EAAGuE,EAAM+lE,GAEzC,MADoB,iBAAT/lE,IAAmBA,EAAOA,EAAK27H,YAAc,IAAI9nI,OAAOmM,EAAK27H,YAAa,KAAO,IACrF5qI,OAAOW,eAAe+J,EAAG,OAAQ,CAAEmgI,cAAc,EAAMjqI,MAAOo0E,EAAS,GAAGlyE,OAAOkyE,EAAQ,IAAK/lE,GAAQA,GAC/G,CAEO,SAAS67H,EAAWlX,EAAamX,GACtC,GAAuB,iBAAZp0H,SAAoD,mBAArBA,QAAQ+mB,SAAyB,OAAO/mB,QAAQ+mB,SAASk2F,EAAamX,EAClH,CAEO,SAASC,EAAUzyH,EAAS0yH,EAAYC,EAAGC,GAEhD,OAAO,IAAKD,IAAMA,EAAIztF,WAAU,SAAUotD,EAASugC,GAC/C,SAASC,EAAUzqI,GAAS,IAAM4/D,EAAK2qE,EAAUj+B,KAAKtsG,GAAS,CAAE,MAAO0yB,GAAK83G,EAAO93G,EAAI,CAAE,CAC1F,SAASg4G,EAAS1qI,GAAS,IAAM4/D,EAAK2qE,EAAiB,MAAEvqI,GAAS,CAAE,MAAO0yB,GAAK83G,EAAO93G,EAAI,CAAE,CAC7F,SAASktC,EAAK36D,GAJlB,IAAejF,EAIaiF,EAAO0mH,KAAO1hB,EAAQhlG,EAAOjF,QAJ1CA,EAIyDiF,EAAOjF,MAJhDA,aAAiBsqI,EAAItqI,EAAQ,IAAIsqI,GAAE,SAAUrgC,GAAWA,EAAQjqG,EAAQ,KAIjBy7C,KAAKgvF,EAAWC,EAAW,CAC7G9qE,GAAM2qE,EAAYA,EAAUzqI,MAAM6X,EAAS0yH,GAAc,KAAK/9B,OAClE,GACF,CAEO,SAASq+B,EAAYhzH,EAAS4J,GACnC,IAAsGzX,EAAGd,EAAG1J,EAAGc,EAA3Gic,EAAI,CAAEkvC,MAAO,EAAGq/E,KAAM,WAAa,GAAW,EAAPtrI,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,EAAI,EAAGurI,KAAM,GAAIC,IAAK,IAChG,OAAO1qI,EAAI,CAAEksG,KAAMy+B,EAAK,GAAI,MAASA,EAAK,GAAI,OAAUA,EAAK,IAAwB,mBAAXpxH,SAA0BvZ,EAAEuZ,OAAOC,UAAY,WAAa,OAAOza,IAAM,GAAIiB,EACvJ,SAAS2qI,EAAKvrI,GAAK,OAAO,SAAUgJ,GAAK,OACzC,SAAcwiI,GACV,GAAIlhI,EAAG,MAAM,IAAI0N,UAAU,mCAC3B,KAAOpX,IAAMA,EAAI,EAAG4qI,EAAG,KAAO3uH,EAAI,IAAKA,OACnC,GAAIvS,EAAI,EAAGd,IAAM1J,EAAY,EAAR0rI,EAAG,GAAShiI,EAAU,OAAIgiI,EAAG,GAAKhiI,EAAS,SAAO1J,EAAI0J,EAAU,SAAM1J,EAAEO,KAAKmJ,GAAI,GAAKA,EAAEsjG,SAAWhtG,EAAIA,EAAEO,KAAKmJ,EAAGgiI,EAAG,KAAKrf,KAAM,OAAOrsH,EAE3J,OADI0J,EAAI,EAAG1J,IAAG0rI,EAAK,CAAS,EAARA,EAAG,GAAQ1rI,EAAEU,QACzBgrI,EAAG,IACP,KAAK,EAAG,KAAK,EAAG1rI,EAAI0rI,EAAI,MACxB,KAAK,EAAc,OAAX3uH,EAAEkvC,QAAgB,CAAEvrD,MAAOgrI,EAAG,GAAIrf,MAAM,GAChD,KAAK,EAAGtvG,EAAEkvC,QAASviD,EAAIgiI,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAK3uH,EAAEyuH,IAAIj9H,MAAOwO,EAAEwuH,KAAKh9H,MAAO,SACxC,QACI,MAAkBvO,GAAZA,EAAI+c,EAAEwuH,MAAY/rI,OAAS,GAAKQ,EAAEA,EAAER,OAAS,KAAkB,IAAVksI,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAE3uH,EAAI,EAAG,QAAU,CAC3G,GAAc,IAAV2uH,EAAG,MAAc1rI,GAAM0rI,EAAG,GAAK1rI,EAAE,IAAM0rI,EAAG,GAAK1rI,EAAE,IAAM,CAAE+c,EAAEkvC,MAAQy/E,EAAG,GAAI,KAAO,CACrF,GAAc,IAAVA,EAAG,IAAY3uH,EAAEkvC,MAAQjsD,EAAE,GAAI,CAAE+c,EAAEkvC,MAAQjsD,EAAE,GAAIA,EAAI0rI,EAAI,KAAO,CACpE,GAAI1rI,GAAK+c,EAAEkvC,MAAQjsD,EAAE,GAAI,CAAE+c,EAAEkvC,MAAQjsD,EAAE,GAAI+c,EAAEyuH,IAAInnI,KAAKqnI,GAAK,KAAO,CAC9D1rI,EAAE,IAAI+c,EAAEyuH,IAAIj9H,MAChBwO,EAAEwuH,KAAKh9H,MAAO,SAEtBm9H,EAAKzpH,EAAK1hB,KAAK8X,EAAS0E,EAC5B,CAAE,MAAOqW,GAAKs4G,EAAK,CAAC,EAAGt4G,GAAI1pB,EAAI,CAAG,CAAE,QAAUc,EAAIxK,EAAI,CAAG,CACzD,GAAY,EAAR0rI,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAEhrI,MAAOgrI,EAAG,GAAKA,EAAG,QAAK,EAAQrf,MAAM,EAC9E,CAtBgD/rD,CAAK,CAACpgE,EAAGgJ,GAAK,CAAG,CAuBnE,CAEO,IAAIyiI,EAAkB7rI,OAAOyW,OAAS,SAAU2tB,EAAGn5B,EAAGzB,EAAGsiI,QACnDvqI,IAAPuqI,IAAkBA,EAAKtiI,GAC3B,IAAI2P,EAAOnZ,OAAOuW,yBAAyBtL,EAAGzB,GACzC2P,KAAS,QAASA,GAAQlO,EAAE8gI,WAAa5yH,EAAK6yH,UAAY7yH,EAAK0xH,gBAChE1xH,EAAO,CAAE8yH,YAAY,EAAM98H,IAAK,WAAa,OAAOlE,EAAEzB,EAAI,IAE9DxJ,OAAOW,eAAeyjC,EAAG0nG,EAAI3yH,EAC9B,EAAI,SAAUirB,EAAGn5B,EAAGzB,EAAGsiI,QACXvqI,IAAPuqI,IAAkBA,EAAKtiI,GAC3B46B,EAAE0nG,GAAM7gI,EAAEzB,EACX,EAEM,SAAS0iI,EAAajhI,EAAGm5B,GAC9B,IAAK,IAAI9jC,KAAK2K,EAAa,YAAN3K,GAAoBN,OAAOO,UAAUC,eAAeC,KAAK2jC,EAAG9jC,IAAIurI,EAAgBznG,EAAGn5B,EAAG3K,EAC7G,CAEO,SAAS6rI,EAAS/nG,GACvB,IAAIjkC,EAAsB,mBAAXoa,QAAyBA,OAAOC,SAAUvP,EAAI9K,GAAKikC,EAAEjkC,GAAIV,EAAI,EAC5E,GAAIwL,EAAG,OAAOA,EAAExK,KAAK2jC,GACrB,GAAIA,GAAyB,iBAAbA,EAAE1kC,OAAqB,MAAO,CAC1CwtG,KAAM,WAEF,OADI9oE,GAAK3kC,GAAK2kC,EAAE1kC,SAAQ0kC,OAAI,GACrB,CAAExjC,MAAOwjC,GAAKA,EAAE3kC,KAAM8sH,MAAOnoF,EACxC,GAEJ,MAAM,IAAIhsB,UAAUjY,EAAI,0BAA4B,kCACtD,CAEO,SAASisI,EAAOhoG,EAAGhkC,GACxB,IAAI6K,EAAsB,mBAAXsP,QAAyB6pB,EAAE7pB,OAAOC,UACjD,IAAKvP,EAAG,OAAOm5B,EACf,IAAmBz7B,EAAY2qB,EAA3B7zB,EAAIwL,EAAExK,KAAK2jC,GAAOioG,EAAK,GAC3B,IACI,WAAc,IAANjsI,GAAgBA,KAAM,MAAQuI,EAAIlJ,EAAEytG,QAAQqf,MAAM8f,EAAG9nI,KAAKoE,EAAE/H,MACxE,CACA,MAAO0rI,GAASh5G,EAAI,CAAEg5G,MAAOA,EAAS,CACtC,QACI,IACQ3jI,IAAMA,EAAE4jH,OAASthH,EAAIxL,EAAU,SAAIwL,EAAExK,KAAKhB,EAClD,CACA,QAAU,GAAI6zB,EAAG,MAAMA,EAAEg5G,KAAO,CACpC,CACA,OAAOD,CACT,CAGO,SAASE,IACd,IAAK,IAAIF,EAAK,GAAI5sI,EAAI,EAAGA,EAAIY,UAAUX,OAAQD,IAC3C4sI,EAAKA,EAAGvpI,OAAOspI,EAAO/rI,UAAUZ,KACpC,OAAO4sI,CACT,CAGO,SAASG,IACd,IAAK,IAAIrsI,EAAI,EAAGV,EAAI,EAAGgtI,EAAKpsI,UAAUX,OAAQD,EAAIgtI,EAAIhtI,IAAKU,GAAKE,UAAUZ,GAAGC,OACxE,IAAIiJ,EAAIpC,MAAMpG,GAAIqJ,EAAI,EAA3B,IAA8B/J,EAAI,EAAGA,EAAIgtI,EAAIhtI,IACzC,IAAK,IAAI4L,EAAIhL,UAAUZ,GAAIitC,EAAI,EAAGggG,EAAKrhI,EAAE3L,OAAQgtC,EAAIggG,EAAIhgG,IAAKljC,IAC1Db,EAAEa,GAAK6B,EAAEqhC,GACjB,OAAO/jC,CACT,CAEO,SAASgkI,EAAc7+H,EAAID,EAAM++H,GACtC,GAAIA,GAA6B,IAArBvsI,UAAUX,OAAc,IAAK,IAA4B2sI,EAAxB5sI,EAAI,EAAGiJ,EAAImF,EAAKnO,OAAYD,EAAIiJ,EAAGjJ,KACxE4sI,GAAQ5sI,KAAKoO,IACRw+H,IAAIA,EAAK9lI,MAAMhG,UAAUqC,MAAMnC,KAAKoN,EAAM,EAAGpO,IAClD4sI,EAAG5sI,GAAKoO,EAAKpO,IAGrB,OAAOqO,EAAGhL,OAAOupI,GAAM9lI,MAAMhG,UAAUqC,MAAMnC,KAAKoN,GACpD,CAEO,SAASg/H,EAAQzjI,GACtB,OAAOrJ,gBAAgB8sI,GAAW9sI,KAAKqJ,EAAIA,EAAGrJ,MAAQ,IAAI8sI,EAAQzjI,EACpE,CAEO,SAAS0jI,EAAiBv0H,EAAS0yH,EAAYE,GACpD,IAAK5wH,OAAOwyH,cAAe,MAAM,IAAI30H,UAAU,wCAC/C,IAAoD3Y,EAAhDuB,EAAImqI,EAAUzqI,MAAM6X,EAAS0yH,GAAc,IAAQtgI,EAAI,GAC3D,OAAOlL,EAAI,CAAC,EAAGksI,EAAK,QAASA,EAAK,SAAUA,EAAK,UAAWlsI,EAAE8a,OAAOwyH,eAAiB,WAAc,OAAOhtI,IAAM,EAAGN,EACpH,SAASksI,EAAKvrI,GAASY,EAAEZ,KAAIX,EAAEW,GAAK,SAAUgJ,GAAK,OAAO,IAAIq0C,SAAQ,SAAUpyC,EAAGzC,GAAK+B,EAAEpG,KAAK,CAACnE,EAAGgJ,EAAGiC,EAAGzC,IAAM,GAAKokI,EAAO5sI,EAAGgJ,EAAI,GAAI,EAAG,CACzI,SAAS4jI,EAAO5sI,EAAGgJ,GAAK,KACVT,EADqB3H,EAAEZ,GAAGgJ,IACnBxI,iBAAiBisI,EAAUpvF,QAAQotD,QAAQliG,EAAE/H,MAAMwI,GAAGizC,KAAK4wF,EAAS7B,GAAU8B,EAAOviI,EAAE,GAAG,GAAIhC,EADtE,CAAE,MAAO2qB,GAAK45G,EAAOviI,EAAE,GAAG,GAAI2oB,EAAI,CAC/E,IAAc3qB,CADmE,CAEjF,SAASskI,EAAQrsI,GAASosI,EAAO,OAAQpsI,EAAQ,CACjD,SAASwqI,EAAOxqI,GAASosI,EAAO,QAASpsI,EAAQ,CACjD,SAASssI,EAAOxiI,EAAGtB,GAASsB,EAAEtB,GAAIuB,EAAE+xD,QAAS/xD,EAAEjL,QAAQstI,EAAOriI,EAAE,GAAG,GAAIA,EAAE,GAAG,GAAK,CACnF,CAEO,SAASwiI,EAAiB/oG,GAC/B,IAAI3kC,EAAGa,EACP,OAAOb,EAAI,CAAC,EAAGksI,EAAK,QAASA,EAAK,SAAS,SAAUr4G,GAAK,MAAMA,CAAG,IAAIq4G,EAAK,UAAWlsI,EAAE8a,OAAOC,UAAY,WAAc,OAAOza,IAAM,EAAGN,EAC1I,SAASksI,EAAKvrI,EAAGsK,GAAKjL,EAAEW,GAAKgkC,EAAEhkC,GAAK,SAAUgJ,GAAK,OAAQ9I,GAAKA,GAAK,CAAEM,MAAOisI,EAAQzoG,EAAEhkC,GAAGgJ,IAAKmjH,MAAM,GAAU7hH,EAAIA,EAAEtB,GAAKA,CAAG,EAAIsB,CAAG,CACvI,CAEO,SAAS0iI,EAAchpG,GAC5B,IAAK7pB,OAAOwyH,cAAe,MAAM,IAAI30H,UAAU,wCAC/C,IAAiC3Y,EAA7BwL,EAAIm5B,EAAE7pB,OAAOwyH,eACjB,OAAO9hI,EAAIA,EAAExK,KAAK2jC,IAAMA,EAAqC+nG,EAAS/nG,GAA2B3kC,EAAI,CAAC,EAAGksI,EAAK,QAASA,EAAK,SAAUA,EAAK,UAAWlsI,EAAE8a,OAAOwyH,eAAiB,WAAc,OAAOhtI,IAAM,EAAGN,GAC9M,SAASksI,EAAKvrI,GAAKX,EAAEW,GAAKgkC,EAAEhkC,IAAM,SAAUgJ,GAAK,OAAO,IAAIq0C,SAAQ,SAAUotD,EAASugC,IACvF,SAAgBvgC,EAASugC,EAAQjC,EAAG//H,GAAKq0C,QAAQotD,QAAQzhG,GAAGizC,MAAK,SAASjzC,GAAKyhG,EAAQ,CAAEjqG,MAAOwI,EAAGmjH,KAAM4c,GAAM,GAAGiC,EAAS,CADb8B,CAAOriC,EAASugC,GAA7BhiI,EAAIg7B,EAAEhkC,GAAGgJ,IAA8BmjH,KAAMnjH,EAAExI,MAAQ,GAAI,CAAG,CAEjK,CAEO,SAASysI,EAAqBC,EAAQ5/H,GAE3C,OADI1N,OAAOW,eAAkBX,OAAOW,eAAe2sI,EAAQ,MAAO,CAAE1sI,MAAO8M,IAAiB4/H,EAAO5/H,IAAMA,EAClG4/H,CACT,CAEA,IAAIC,EAAqBvtI,OAAOyW,OAAS,SAAU2tB,EAAGh7B,GACpDpJ,OAAOW,eAAeyjC,EAAG,UAAW,CAAE6nG,YAAY,EAAMrrI,MAAOwI,GAChE,EAAI,SAASg7B,EAAGh7B,GACfg7B,EAAW,QAAIh7B,CACjB,EAEO,SAASokI,EAAaC,GAC3B,GAAIA,GAAOA,EAAI1B,WAAY,OAAO0B,EAClC,IAAI5nI,EAAS,CAAC,EACd,GAAW,MAAP4nI,EAAa,IAAK,IAAIjkI,KAAKikI,EAAe,YAANjkI,GAAmBxJ,OAAOO,UAAUC,eAAeC,KAAKgtI,EAAKjkI,IAAIqiI,EAAgBhmI,EAAQ4nI,EAAKjkI,GAEtI,OADA+jI,EAAmB1nI,EAAQ4nI,GACpB5nI,CACT,CAEO,SAAS6nI,EAAgBD,GAC9B,OAAQA,GAAOA,EAAI1B,WAAc0B,EAAM,CAAExqE,QAASwqE,EACpD,CAEO,SAASE,EAAuBC,EAAU/sI,EAAOy9C,EAAM5zC,GAC5D,GAAa,MAAT4zC,IAAiB5zC,EAAG,MAAM,IAAI0N,UAAU,iDAC5C,GAAqB,mBAAVvX,EAAuB+sI,IAAa/sI,IAAU6J,GAAK7J,EAAM0+F,IAAIquC,GAAW,MAAM,IAAIx1H,UAAU,4EACvG,MAAgB,MAATkmC,EAAe5zC,EAAa,MAAT4zC,EAAe5zC,EAAEjK,KAAKmtI,GAAYljI,EAAIA,EAAE9J,MAAQC,EAAMsO,IAAIy+H,EACtF,CAEO,SAASC,EAAuBD,EAAU/sI,EAAOD,EAAO09C,EAAM5zC,GACnE,GAAa,MAAT4zC,EAAc,MAAM,IAAIlmC,UAAU,kCACtC,GAAa,MAATkmC,IAAiB5zC,EAAG,MAAM,IAAI0N,UAAU,iDAC5C,GAAqB,mBAAVvX,EAAuB+sI,IAAa/sI,IAAU6J,GAAK7J,EAAM0+F,IAAIquC,GAAW,MAAM,IAAIx1H,UAAU,2EACvG,MAAiB,MAATkmC,EAAe5zC,EAAEjK,KAAKmtI,EAAUhtI,GAAS8J,EAAIA,EAAE9J,MAAQA,EAAQC,EAAM8X,IAAIi1H,EAAUhtI,GAASA,CACtG,CAEO,SAASktI,EAAsBjtI,EAAO+sI,GAC3C,GAAiB,OAAbA,GAA0C,iBAAbA,GAA6C,mBAAbA,EAA0B,MAAM,IAAIx1H,UAAU,0CAC/G,MAAwB,mBAAVvX,EAAuB+sI,IAAa/sI,EAAQA,EAAM0+F,IAAIquC,EACtE,CAEA,SACEvE,YACAvpI,WACAwpI,SACAG,aACAG,UACAkB,aACAE,YACAO,cACAM,kBACAK,eACAC,WACAC,SACAG,WACAC,iBACAG,gBACAE,UACAC,mBACAK,mBACAC,gBACAC,uBACAG,eACAE,kBACAC,yBACAE,yBACAC,2BC9TEC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqB1sI,IAAjB2sI,EACH,OAAOA,EAAaruI,QAGrB,IAAIN,EAASwuI,EAAyBE,GAAY,CACjDzuI,GAAIyuI,EAEJpuI,QAAS,CAAC,GAOX,OAHAsuI,EAAoBF,GAAUxtI,KAAKlB,EAAOM,QAASN,EAAQA,EAAOM,QAASmuI,GAGpEzuI,EAAOM,OACf,CCrBAmuI,EAAoB7E,EAAI,CAACtpI,EAAS84G,KACjC,IAAI,IAAIvxG,KAAOuxG,EACXq1B,EAAoB5pG,EAAEu0E,EAAYvxG,KAAS4mI,EAAoB5pG,EAAEvkC,EAASuH,IAC5EpH,OAAOW,eAAed,EAASuH,EAAK,CAAE6kI,YAAY,EAAM98H,IAAKwpG,EAAWvxG,IAE1E,ECND4mI,EAAoBhtI,EAAI,WACvB,GAA0B,iBAAfotI,WAAyB,OAAOA,WAC3C,IACC,OAAOruI,MAAQ,IAAIiX,SAAS,cAAb,EAChB,CAAE,MAAOsc,GACR,GAAsB,iBAAXvyB,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxBitI,EAAoB5pG,EAAI,CAAC5zB,EAAK0I,IAAUlZ,OAAOO,UAAUC,eAAeC,KAAK+P,EAAK0I,GCClF80H,EAAoBrlI,EAAK9I,IACH,oBAAX0a,QAA0BA,OAAO8zH,aAC1CruI,OAAOW,eAAed,EAAS0a,OAAO8zH,YAAa,CAAEztI,MAAO,WAE7DZ,OAAOW,eAAed,EAAS,aAAc,CAAEe,OAAO,GAAO,qBCL9D,eACA,WACA,WAEMq0E,EAAS5xE,SAASoqB,SAASwnD,OAAO9uE,UAAU,GAAGmG,MAAM,KAEvD2oE,EAAOroC,MAAK,SAAAjjC,GAAK,MAAK,QAALA,CAAA,KACjB,IAAA2kI,OAAgCjrI,SAASiyB,eAAe,aACjD2/C,EAAOroC,MAAK,SAAAjjC,GAAK,MAAK,QAALA,CAAA,KACxB,IAAA2kI,OAA8BjrI,SAASiyB,eAAe,cAEtD,IAAAg5G,OAA6BjrI,SAASiyB,eAAe","sources":["webpack://roosterjs/./demo/scripts/controls/ContentModelEditorMainPane.scss?b82e","webpack://roosterjs/./demo/scripts/controls/MainPane.scss?02c0","webpack://roosterjs/./demo/scripts/controls/StandaloneEditorMainPane.scss?fd1a","webpack://roosterjs/./demo/scripts/controls/colorPicker/ColorPicker.scss?c445","webpack://roosterjs/./demo/scripts/controls/contentModel/components/ButtonGroup.scss?4796","webpack://roosterjs/./demo/scripts/controls/contentModel/components/ContentModelView.scss?b125","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/FormatView.scss?89ef","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelBrView.scss?9e4e","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelCodeView.scss?605a","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelDividerView.scss?7292","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelDocumentView.scss?32ef","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelEntityView.scss?57ac","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelFormatContainerView.scss?08a9","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelGeneralView.scss?522d","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelImageView.scss?2dba","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelJson.scss?958c","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelLinkView.scss?a3cb","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelListItemView.scss?ce13","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelListLevelView.scss?cfed","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelParagraphView.scss?ba57","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelSelectionMarkerView.scss?aadf","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelTableCellView.scss?e173","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelTableRowView.scss?8fed","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelTableView.scss?89ed","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelTextView.scss?c7ad","webpack://roosterjs/./demo/scripts/controls/sidePane/ContentModelSidePane.scss?bc3d","webpack://roosterjs/./demo/scripts/controls/sidePane/SidePane.scss?a7d6","webpack://roosterjs/./demo/scripts/controls/sidePane/StandaloneSidePane.scss?8a74","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/ApiPlaygroundPane.scss?cd78","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/blockElements/BlockElementsPane.scss?ce6a","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/darkColor/GetDarkColorPane.scss?facd","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/getSelection/getSelectionPane.scss?f584","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/insertContent/InsertContentPane.scss?2858","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/insertEntity/InsertEntityPane.scss?8968","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/region/GetSelectedRegionsPane.scss?89d2","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/sanitizer/SanitizerPane.scss?2631","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/vtable/VTablePane.scss?698d","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModel/ContentModelPane.scss?1b5c","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModelApiPlayground/ApiPlaygroundPane.scss?0c4b","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModelApiPlayground/insertEntity/InsertEntityPane.scss?0292","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/OptionsPane.scss?48fd","webpack://roosterjs/./demo/scripts/controls/sidePane/eventViewer/EventViewPane.scss?43ed","webpack://roosterjs/./demo/scripts/controls/sidePane/formatState/FormatStatePane.scss?5094","webpack://roosterjs/./demo/scripts/controls/sidePane/snapshot/SnapshotPane.scss?6a8a","webpack://roosterjs/./demo/scripts/controls/titleBar/ContentModelTitleBar.scss?fb7a","webpack://roosterjs/./demo/scripts/controls/titleBar/StandaloneTitleBar.scss?310d","webpack://roosterjs/./demo/scripts/controls/titleBar/TitleBar.scss?49b4","webpack://roosterjs/./node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js","webpack://roosterjs/./node_modules/color-convert/conversions.js","webpack://roosterjs/./node_modules/color-convert/index.js","webpack://roosterjs/./node_modules/color-convert/route.js","webpack://roosterjs/./node_modules/color-name/index.js","webpack://roosterjs/./node_modules/color-string/index.js","webpack://roosterjs/./node_modules/color/index.js","webpack://roosterjs/./demo/scripts/controls/ContentModelEditorMainPane.scss","webpack://roosterjs/./demo/scripts/controls/MainPane.scss","webpack://roosterjs/./demo/scripts/controls/StandaloneEditorMainPane.scss","webpack://roosterjs/./demo/scripts/controls/colorPicker/ColorPicker.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/ButtonGroup.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/ContentModelView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/FormatView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelBrView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelCodeView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelDividerView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelDocumentView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelEntityView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelFormatContainerView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelGeneralView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelImageView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelJson.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelLinkView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelListItemView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelListLevelView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelParagraphView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelSelectionMarkerView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelTableCellView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelTableRowView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelTableView.scss","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelTextView.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/ContentModelSidePane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/SidePane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/StandaloneSidePane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/ApiPlaygroundPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/blockElements/BlockElementsPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/darkColor/GetDarkColorPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/getSelection/getSelectionPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/insertContent/InsertContentPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/insertEntity/InsertEntityPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/region/GetSelectedRegionsPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/sanitizer/SanitizerPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/vtable/VTablePane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModel/ContentModelPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModelApiPlayground/ApiPlaygroundPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModelApiPlayground/insertEntity/InsertEntityPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/OptionsPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/eventViewer/EventViewPane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/formatState/FormatStatePane.scss","webpack://roosterjs/./demo/scripts/controls/sidePane/snapshot/SnapshotPane.scss","webpack://roosterjs/./demo/scripts/controls/titleBar/ContentModelTitleBar.scss","webpack://roosterjs/./demo/scripts/controls/titleBar/StandaloneTitleBar.scss","webpack://roosterjs/./demo/scripts/controls/titleBar/TitleBar.scss","webpack://roosterjs/./node_modules/css-loader/dist/runtime/api.js","webpack://roosterjs/./node_modules/dompurify/dist/purify.js","webpack://roosterjs/./node_modules/is-arrayish/index.js","webpack://roosterjs/./node_modules/simple-swizzle/index.js","webpack://roosterjs/./demo/scripts/controls/BuildInPluginState.ts","webpack://roosterjs/./demo/scripts/controls/ContentModelEditorMainPane.tsx","webpack://roosterjs/./demo/scripts/controls/MainPane.tsx","webpack://roosterjs/./demo/scripts/controls/MainPaneBase.tsx","webpack://roosterjs/./demo/scripts/controls/StandaloneEditorMainPane.tsx","webpack://roosterjs/./demo/scripts/controls/colorPicker/ColorPicker.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/ButtonGroup.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/ContentModelView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/BlockFormatView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/FormatView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/LinkFormatView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/MetadataView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/SegmentFormatView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/BackgroundColorFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/BasicFormatRenderers.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/BorderBoxFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/BorderFormatRenderers.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/DirectionFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/DisplayFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/FloatFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/FontFamilyFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/FontSizeFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/HtmlAlignFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/IdFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/ImageMetadataFormatRenderers.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/LetterSpacingFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/LineHeightFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/ListMetadataFormatRenderers.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/ListStylePositionFormatRenderers.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/ListThreadFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/MarginFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/PaddingFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/SizeFormatRenderers.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/SpacingFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/TableCellMetadataFormatRenders.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/TableLayoutFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/TableMetadataFormatRenders.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/TextAlignFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/TextColorFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/TextIndentFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/VerticalAlignFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/WhiteSpaceFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/formatPart/WordBreakFormatRenderer.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/utils/createCheckboxFormatRenderer.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/utils/createColorFormatRender.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/utils/createDropDownFormatRenderer.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/format/utils/createTextFormatRenderer.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/BlockGroupContentView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelBlockGroupView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelBlockView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelBrView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelCodeView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelDividerView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelDocumentView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelEntityView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelFormatContainerView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelGeneralView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelImageView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelJson.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelLinkView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelListItemView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelListLevelView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelParagraphView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelSegmentView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelSelectionMarkerView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelTableCellView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelTableRowView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelTableView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/components/model/ContentModelTextView.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/editor/ContentModelRooster.tsx","webpack://roosterjs/./demo/scripts/controls/contentModel/hooks/useProperty.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/plugins/ContentModelFormatPainterPlugin.ts","webpack://roosterjs/./demo/scripts/controls/getToggleablePlugins.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/ContentModelRibbon.tsx","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/ContentModelRibbonPlugin.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/alignCenterButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/alignJustifyButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/alignLeftButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/alignRightButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/backgroundColorButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/blockQuoteButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/boldButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/bulletedListButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/changeImageButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/clearFormatButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/codeButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/darkMode.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/decreaseFontSizeButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/decreaseIndentButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/export.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/fontButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/fontSizeButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/formatPainterButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/formatTableButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/imageBorderColorButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/imageBorderRemoveButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/imageBorderStyleButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/imageBorderWidthButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/imageBoxShadowButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/increaseFontSizeButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/increaseIndentButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/insertImageButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/insertLinkButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/insertTableButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/italicButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/listStartNumberButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/ltrButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/moreCommands.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/numberedListButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/pasteButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/popout.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/redoButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/removeLinkButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/rtlButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/setBulletedListStyleButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/setHeadingLevelButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/setNumberedListStyleButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/setTableCellShadeButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/setTableHeaderButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/spaceBeforeAfterButtons.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/spacingButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/strikethroughButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/subscriptButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/superscriptButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/tableBorderApplyButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/tableBorderColorButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/tableBorderStyleButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/tableBorderWidthButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/tableEditButtons.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/textColorButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/underlineButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/undoButton.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/contentModel/zoom.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/darkMode.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/export.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/popout.ts","webpack://roosterjs/./demo/scripts/controls/ribbonButtons/zoom.ts","webpack://roosterjs/./demo/scripts/controls/sampleEntity/SampleEntityPlugin.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/SidePane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/SidePanePluginImpl.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/ApiPlaygroundPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/ApiPlaygroundPlugin.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/apiEntries.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/blockElements/BlockElementsPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/darkColor/GetDarkColorPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/getSelection/getSelectionPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/insertContent/InsertContentPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/insertEntity/InsertEntityPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/matchLink/MatchLinkPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/region/GetSelectedRegionsPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/sanitizer/SanitizerPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/vlist/VListPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/vtable/PredefinedTableStyles.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/apiPlayground/vtable/VTablePane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModel/ContentModelPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModel/ContentModelPanePlugin.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModel/buttons/exportButton.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModel/buttons/refreshButton.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModel/currentModel.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModelApiPlayground/ApiPlaygroundPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModelApiPlayground/ApiPlaygroundPlugin.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModelApiPlayground/apiEntries.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/contentModelApiPlayground/insertEntity/InsertEntityPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/Code.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/ContentEditFeatures.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/ContentModelEditorOptionsPlugin.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/ContentModelExperimentalFeatures.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/ContentModelOptionsPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/ContentModelPlugins.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/DefaultFormat.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/EditorOptionsPlugin.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/ExperimentalFeatures.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/OptionsPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/Plugins.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/ButtonsCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/CodeElement.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/ContentEditCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/ContentEditFeaturesCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/ContentModelButtonsCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/ContentModelEditorCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/DarkModeCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/DefaultFormatCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/EditorCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/ExperimentalFeaturesCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/HyperLinkCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/PluginsCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/ReactEditorCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/RibbonButtonCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/RibbonCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/SimplePluginCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/TableCellSelectionCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/codes/WatermarkCode.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/editorOptions/getDefaultContentEditFeatureSettings.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/eventViewer/ContentModelEventViewPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/eventViewer/ContentModelEventViewPlugin.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/eventViewer/EventViewPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/eventViewer/EventViewPlugin.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/formatState/ContentModelFormatStatePlugin.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/formatState/FormatStatePane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/formatState/FormatStatePlugin.ts","webpack://roosterjs/./demo/scripts/controls/sidePane/snapshot/ContentModelSnapshotPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/snapshot/ContentModelSnapshotPlugin.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/snapshot/SnapshotPane.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/snapshot/SnapshotPlugin.tsx","webpack://roosterjs/./demo/scripts/controls/sidePane/snapshot/UndoSnapshots.ts","webpack://roosterjs/./demo/scripts/controls/titleBar/TitleBar.tsx","webpack://roosterjs/./demo/scripts/utils/cssMonitor.ts","webpack://roosterjs/./demo/scripts/utils/trustedHTMLHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/index.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/block/setModelAlignment.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/block/setModelDirection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/block/setModelIndentation.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/block/toggleModelBlockQuote.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/common/clearModelFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/common/wrapBlock.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/entity/insertEntityModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/image/applyImageBorderFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/link/matchLink.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/list/findListItemsInSameThread.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/list/setListType.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/selection/adjustSegmentSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/selection/adjustTrailingSpaceSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/selection/adjustWordSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/selection/collapseTableSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/alignTable.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/alignTableCell.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/canMergeCells.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/clearSelectedCells.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/createTableStructure.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/deleteTable.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/deleteTableColumn.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/deleteTableRow.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/ensureFocusableParagraphForTable.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/insertTableColumn.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/insertTableRow.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/mergeTableCells.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/mergeTableColumn.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/mergeTableRow.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/splitTableCellHorizontally.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/modelApi/table/splitTableCellVertically.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/block/setAlignment.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/block/setDirection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/block/setHeadingLevel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/block/setIndentation.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/block/setParagraphMargin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/block/setSpacing.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/block/toggleBlockQuote.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/entity/insertEntity.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/format/clearFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/format/getFormatState.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/image/adjustImageSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/image/changeImage.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/image/insertImage.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/image/setImageAltText.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/image/setImageBorder.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/image/setImageBoxShadow.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/link/adjustLinkSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/link/insertLink.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/link/removeLink.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/list/setListStartNumber.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/list/setListStyle.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/list/toggleBullet.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/list/toggleNumbering.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/applySegmentFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/changeCapitalization.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/changeFontSize.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/setBackgroundColor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/setFontName.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/setFontSize.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/setTextColor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/toggleBold.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/toggleCode.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/toggleItalic.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/toggleStrikethrough.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/toggleSubscript.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/toggleSuperscript.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/segment/toggleUnderline.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/table/applyTableBorderFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/table/editTable.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/table/formatTable.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/table/insertTable.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/table/setTableCellShade.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/utils/formatImageWithContentModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/utils/formatParagraphWithContentModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/utils/formatSegmentWithContentModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-api/lib/publicApi/utils/formatTableWithContentModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/constants/BulletListType.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/constants/ChangeSource.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/constants/NumberingListType.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/constants/TableBorderFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/addUndoSnapshot.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/attachDomEvent.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/createContentModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/createEditorContext.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/focus.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/formatContentModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/getDOMSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/getVisibleViewport.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/hasFocus.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/paste.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/restoreUndoSnapshot.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/setContentModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/setDOMSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/switchShadowEdit.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/coreApi/triggerEvent.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/CachePlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/ContextMenuPlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/CopyPastePlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/DOMEventPlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/EntityPlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/FormatPlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/LifecyclePlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/SelectionPlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/UndoPlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/createEditorCorePlugins.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/utils/addRangeToSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/utils/applyDefaultFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/utils/applyPendingFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/utils/areSameSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/utils/deleteEmptyList.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/utils/domIndexerImpl.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/utils/entityDelimiterUtils.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/utils/findAllEntities.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/corePlugin/utils/textMutationObserver.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/editor/DOMHelperImpl.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/editor/DarkColorHandlerImpl.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/editor/Editor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/editor/SnapshotsManagerImpl.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/editor/coreApiMap.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/editor/createEditorCore.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/editor/createEditorDefaultSettings.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/index.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/metadata/definitionCreators.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/metadata/updateImageMetadata.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/metadata/updateListMetadata.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/metadata/updateTableCellMetadata.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/metadata/updateTableMetadata.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/modelApi/edit/deleteExpandedSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/modelApi/edit/deleteSingleChar.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/override/containerSizeFormatParser.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/override/pasteCopyBlockEntityParser.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/override/pasteDisplayFormatParser.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/override/pasteEntityProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/override/pasteGeneralProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/override/pasteTextProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/override/reducedModelChildProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/override/tablePreProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/color/transformColor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/domUtils/borderValues.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/domUtils/cacheGetEventData.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/domUtils/eventUtils.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/domUtils/getSegmentTextFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/domUtils/readFile.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/domUtils/stringUtil.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/domUtils/tableCellUtils.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/format/retrieveModelFormatState.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/model/cloneModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/model/createModelFromHtml.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/model/exportContent.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/model/getClosestAncestorBlockGroupIndex.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/model/isBlockGroupOfType.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/model/isBold.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/model/mergeModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/selection/collectSelections.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/selection/deleteBlock.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/selection/deleteSegment.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/selection/deleteSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/selection/getSelectionRootNode.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/selection/hasSelectionInBlock.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/selection/hasSelectionInBlockGroup.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/selection/hasSelectionInSegment.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/selection/iterateSelections.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/selection/setSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/table/applyTableFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/table/getSelectedCells.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/table/normalizeTable.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/table/setTableCellBackgroundColor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/undo/redo.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/publicApi/undo/undo.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/convertInlineCss.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/createDomToModelContextForSanitizing.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/createSnapshotSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/extractClipboardItems.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/getRootComputedStyleForContext.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/paste/createPasteFragment.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/paste/generatePasteOptionFromPlugins.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/paste/mergePasteContent.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/paste/retrieveHtmlInfo.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/restoreSnapshotColors.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/restoreSnapshotHTML.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/restoreSnapshotSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-core/lib/utils/sanitizeElement.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/config/defaultContentModelFormatMap.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/config/defaultHTMLStyleMap.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/context/createDomToModelContext.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/context/defaultProcessors.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/domToContentModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/blockProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/brProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/childProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/codeProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/delimiterProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/elementProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/entityProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/fontProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/formatContainerProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/generalProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/headingProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/hrProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/imageProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/knownElementProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/linkProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/listItemProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/listProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/pProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/tableProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/processors/textProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/utils/addSelectionMarker.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/utils/areSameFormats.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/utils/getBoundingClientRect.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/utils/getDefaultStyle.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/utils/getRegularSelectionOffsets.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/utils/isBlockElement.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/utils/parseFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domToModel/utils/stackFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domUtils/entityUtils.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domUtils/getObjectKeys.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domUtils/isElementOfType.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domUtils/isNodeOfType.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domUtils/isWhiteSpacePreserved.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domUtils/metadata/updateMetadata.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domUtils/metadata/validate.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domUtils/moveChildNodes.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domUtils/reuseCachedElement.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domUtils/toArray.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domUtils/unwrap.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/domUtils/wrap.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/block/directionFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/block/displayFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/block/htmlAlignFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/block/lineHeightFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/block/marginFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/block/paddingFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/block/textAlignFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/block/textIndentFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/block/whiteSpaceFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/common/backgroundColorFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/common/borderBoxFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/common/borderFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/common/boxShadowFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/common/datasetFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/common/floatFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/common/idFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/common/sizeFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/common/verticalAlignFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/common/wordBreakFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/defaultFormatHandlers.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/entity/entityFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/list/listItemThreadFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/list/listLevelThreadFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/list/listStyleFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/segment/boldFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/segment/fontFamilyFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/segment/fontSizeFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/segment/italicFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/segment/letterSpacingFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/segment/linkFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/segment/strikeFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/segment/superOrSubScriptFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/segment/textColorFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/segment/underlineFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/table/tableLayoutFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/table/tableSpacingFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/table/textColorOnTableCellFormatHandler.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/utils/color.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/utils/dir.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/utils/parseValueWithUnit.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/formatHandlers/utils/shouldSetValue.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/index.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/block/setParagraphNotImplicit.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/common/addBlock.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/common/addDecorators.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/common/addSegment.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/common/ensureParagraph.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/common/hasSpacesOnly.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/common/isEmpty.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/common/isGeneralSegment.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/common/normalizeContentModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/common/normalizeParagraph.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/common/normalizeSegment.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/common/unwrapBlock.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createBr.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createContentModelDocument.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createDivider.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createEmptyModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createEntity.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createFormatContainer.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createGeneralBlock.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createGeneralSegment.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createImage.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createListItem.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createListLevel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createParagraph.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createParagraphDecorator.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createSelectionMarker.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createTable.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createTableCell.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelApi/creators/createText.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/contentModelToDom.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/context/createModelToDomContext.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/context/defaultContentModelHandlers.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleBlock.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleBlockGroupChildren.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleBr.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleDivider.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleEntity.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleFormatContainer.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleGeneralModel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleImage.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleList.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleListItem.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleParagraph.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleSegment.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleSegmentDecorator.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleTable.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/handlers/handleText.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/optimizers/mergeNode.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/optimizers/optimize.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/optimizers/removeUnnecessarySpan.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/utils/applyFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/utils/applyMetadata.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/utils/handleSegmentCommon.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToDom/utils/stackFormat.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-dom/lib/modelToText/contentModelToText.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/autoFormat/AutoFormatPlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/autoFormat/keyboardListTrigger.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/autoFormat/utils/convertAlphaToDecimals.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/autoFormat/utils/getIndex.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/autoFormat/utils/getListTypeStyle.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/autoFormat/utils/getNumberingListStyle.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/EditPlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/deleteSteps/deleteAllSegmentBefore.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/deleteSteps/deleteCollapsedSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/deleteSteps/deleteList.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/deleteSteps/deleteWordSelection.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/handleKeyboardEventCommon.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/inputSteps/handleEnterOnList.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/keyboardDelete.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/keyboardInput.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/keyboardTab.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/tabUtils/handleTabOnList.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/tabUtils/handleTabOnParagraph.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/edit/utils/getLeafSiblingBlock.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/index.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/Excel/processPastedContentFromExcel.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/PastePlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/PowerPoint/processPastedContentFromPowerPoint.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/WacComponents/constants.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/WacComponents/processPastedContentWacComponents.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/WordDesktop/getStyleMetadata.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/WordDesktop/processPastedContentFromWordDesktop.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/WordDesktop/processWordComments.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/WordDesktop/processWordLists.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/WordDesktop/removeNegativeTextIndentParser.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/pasteSourceValidations/constants.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/pasteSourceValidations/documentContainWacElements.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/pasteSourceValidations/getPasteSource.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/pasteSourceValidations/isExcelDesktopDocument.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/pasteSourceValidations/isExcelOnlineDocument.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/pasteSourceValidations/isGoogleSheetDocument.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/pasteSourceValidations/isPowerPointDesktopDocument.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/pasteSourceValidations/isWordDesktopDocument.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/pasteSourceValidations/shouldConvertToSingleImage.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/utils/addParser.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/utils/deprecatedColorParser.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/utils/getStyles.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/utils/linkParser.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/paste/utils/setProcessor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/pluginUtils/CreateElement/createElement.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/pluginUtils/DragAndDrop/DragAndDropHelper.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/pluginUtils/Rect/getIntersectedRect.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/pluginUtils/Rect/normalizeRect.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/shortcut/ShortcutPlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/shortcut/shortcuts.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/tableEdit/TableEditPlugin.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/tableEdit/editors/TableEditor.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/tableEdit/editors/features/CellResizer.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/tableEdit/editors/features/TableEditorFeature.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/tableEdit/editors/features/TableInserter.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/tableEdit/editors/features/TableMover.ts","webpack://roosterjs/./packages-content-model/roosterjs-content-model-plugins/lib/tableEdit/editors/features/TableResizer.ts","webpack://roosterjs/./packages/roosterjs-editor-adapter/lib/corePlugins/BridgePlugin.ts","webpack://roosterjs/./packages/roosterjs-editor-adapter/lib/corePlugins/EditPlugin.ts","webpack://roosterjs/./packages/roosterjs-editor-adapter/lib/editor/DarkColorHandlerImpl.ts","webpack://roosterjs/./packages/roosterjs-editor-adapter/lib/editor/EditorAdapter.ts","webpack://roosterjs/./packages/roosterjs-editor-adapter/lib/editor/utils/buildRangeEx.ts","webpack://roosterjs/./packages/roosterjs-editor-adapter/lib/editor/utils/eventConverter.ts","webpack://roosterjs/./packages/roosterjs-editor-adapter/lib/editor/utils/insertNode.ts","webpack://roosterjs/./packages/roosterjs-editor-adapter/lib/editor/utils/selectionConverter.ts","webpack://roosterjs/./packages/roosterjs-editor-adapter/lib/index.ts","webpack://roosterjs/./demo/scripts/controls/contentModel/plugins/formatpaintercursor.svg","webpack://roosterjs/./demo/scripts/controls/titleBar/iconmonstr-github-1.svg","webpack://roosterjs/external var \"FluentUIReact\"","webpack://roosterjs/external var \"React\"","webpack://roosterjs/external var \"ReactDOM\"","webpack://roosterjs/external var \"roosterjs\"","webpack://roosterjs/external var \"roosterjsReact\"","webpack://roosterjs/./node_modules/tslib/tslib.es6.mjs","webpack://roosterjs/webpack/bootstrap","webpack://roosterjs/webpack/runtime/define property getters","webpack://roosterjs/webpack/runtime/global","webpack://roosterjs/webpack/runtime/hasOwnProperty shorthand","webpack://roosterjs/webpack/runtime/make namespace object","webpack://roosterjs/./demo/scripts/index.ts"],"sourcesContent":["var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../node_modules/sass-loader/dist/cjs.js!./ContentModelEditorMainPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../node_modules/sass-loader/dist/cjs.js!./MainPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../node_modules/sass-loader/dist/cjs.js!./StandaloneEditorMainPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../node_modules/sass-loader/dist/cjs.js!./ColorPicker.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../node_modules/sass-loader/dist/cjs.js!./ButtonGroup.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./FormatView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelBrView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelCodeView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelDividerView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelDocumentView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelEntityView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelFormatContainerView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelGeneralView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelImageView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelJson.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelLinkView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelListItemView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelListLevelView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelParagraphView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelSelectionMarkerView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelTableCellView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelTableRowView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelTableView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelTextView.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelSidePane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../node_modules/sass-loader/dist/cjs.js!./SidePane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../node_modules/sass-loader/dist/cjs.js!./StandaloneSidePane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../node_modules/sass-loader/dist/cjs.js!./ApiPlaygroundPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./BlockElementsPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./GetDarkColorPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./getSelectionPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./InsertContentPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./InsertEntityPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./GetSelectedRegionsPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./SanitizerPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./VTablePane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../node_modules/sass-loader/dist/cjs.js!./ApiPlaygroundPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../../node_modules/sass-loader/dist/cjs.js!./InsertEntityPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../node_modules/sass-loader/dist/cjs.js!./OptionsPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../node_modules/sass-loader/dist/cjs.js!./EventViewPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../node_modules/sass-loader/dist/cjs.js!./FormatStatePane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../../node_modules/sass-loader/dist/cjs.js!./SnapshotPane.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../node_modules/sass-loader/dist/cjs.js!./ContentModelTitleBar.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../node_modules/sass-loader/dist/cjs.js!./StandaloneTitleBar.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../node_modules/sass-loader/dist/cjs.js!./TitleBar.scss\");\nvar loader = require(\"/home/runner/work/roosterjs/roosterjs/node_modules/@microsoft/loader-load-themed-styles/node_modules/@microsoft/load-themed-styles/lib/index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], false);\n\nif(content.locals) module.exports = content.locals;","\"use strict\";\n/**\n * An IThemingInstruction can specify a rawString to be preserved or a theme slot and a default value\n * to use if that slot is not specified by the theme.\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// Store the theming state in __themeState__ global scope for reuse in the case of duplicate\n// load-themed-styles hosted on the page.\nvar _root = (typeof window === 'undefined') ? global : window; // eslint-disable-line @typescript-eslint/no-explicit-any\n// Nonce string to inject into script tag if one provided. This is used in CSP (Content Security Policy).\nvar _styleNonce = _root && _root.CSPSettings && _root.CSPSettings.nonce;\nvar _themeState = initializeThemeState();\n/**\n * Matches theming tokens. For example, \"[theme: themeSlotName, default: #FFF]\" (including the quotes).\n */\nvar _themeTokenRegex = /[\\'\\\"]\\[theme:\\s*(\\w+)\\s*(?:\\,\\s*default:\\s*([\\\\\"\\']?[\\.\\,\\(\\)\\#\\-\\s\\w]*[\\.\\,\\(\\)\\#\\-\\w][\\\"\\']?))?\\s*\\][\\'\\\"]/g;\nvar now = function () { return (typeof performance !== 'undefined' && !!performance.now) ? performance.now() : Date.now(); };\nfunction measure(func) {\n    var start = now();\n    func();\n    var end = now();\n    _themeState.perf.duration += end - start;\n}\n/**\n * initialize global state object\n */\nfunction initializeThemeState() {\n    var state = _root.__themeState__ || {\n        theme: undefined,\n        lastStyleElement: undefined,\n        registeredStyles: []\n    };\n    if (!state.runState) {\n        state = __assign({}, (state), { perf: {\n                count: 0,\n                duration: 0\n            }, runState: {\n                flushTimer: 0,\n                mode: 0 /* sync */,\n                buffer: []\n            } });\n    }\n    if (!state.registeredThemableStyles) {\n        state = __assign({}, (state), { registeredThemableStyles: [] });\n    }\n    _root.__themeState__ = state;\n    return state;\n}\n/**\n * Loads a set of style text. If it is registered too early, we will register it when the window.load\n * event is fired.\n * @param {string | ThemableArray} styles Themable style text to register.\n * @param {boolean} loadAsync When true, always load styles in async mode, irrespective of current sync mode.\n */\nfunction loadStyles(styles, loadAsync) {\n    if (loadAsync === void 0) { loadAsync = false; }\n    measure(function () {\n        var styleParts = Array.isArray(styles) ? styles : splitStyles(styles);\n        var _a = _themeState.runState, mode = _a.mode, buffer = _a.buffer, flushTimer = _a.flushTimer;\n        if (loadAsync || mode === 1 /* async */) {\n            buffer.push(styleParts);\n            if (!flushTimer) {\n                _themeState.runState.flushTimer = asyncLoadStyles();\n            }\n        }\n        else {\n            applyThemableStyles(styleParts);\n        }\n    });\n}\nexports.loadStyles = loadStyles;\n/**\n * Allows for customizable loadStyles logic. e.g. for server side rendering application\n * @param {(processedStyles: string, rawStyles?: string | ThemableArray) => void}\n * a loadStyles callback that gets called when styles are loaded or reloaded\n */\nfunction configureLoadStyles(loadStylesFn) {\n    _themeState.loadStyles = loadStylesFn;\n}\nexports.configureLoadStyles = configureLoadStyles;\n/**\n * Configure run mode of load-themable-styles\n * @param mode load-themable-styles run mode, async or sync\n */\nfunction configureRunMode(mode) {\n    _themeState.runState.mode = mode;\n}\nexports.configureRunMode = configureRunMode;\n/**\n * external code can call flush to synchronously force processing of currently buffered styles\n */\nfunction flush() {\n    measure(function () {\n        var styleArrays = _themeState.runState.buffer.slice();\n        _themeState.runState.buffer = [];\n        var mergedStyleArray = [].concat.apply([], styleArrays);\n        if (mergedStyleArray.length > 0) {\n            applyThemableStyles(mergedStyleArray);\n        }\n    });\n}\nexports.flush = flush;\n/**\n * register async loadStyles\n */\nfunction asyncLoadStyles() {\n    return setTimeout(function () {\n        _themeState.runState.flushTimer = 0;\n        flush();\n    }, 0);\n}\n/**\n * Loads a set of style text. If it is registered too early, we will register it when the window.load event\n * is fired.\n * @param {string} styleText Style to register.\n * @param {IStyleRecord} styleRecord Existing style record to re-apply.\n */\nfunction applyThemableStyles(stylesArray, styleRecord) {\n    if (_themeState.loadStyles) {\n        _themeState.loadStyles(resolveThemableArray(stylesArray).styleString, stylesArray);\n    }\n    else {\n        registerStyles(stylesArray);\n    }\n}\n/**\n * Registers a set theme tokens to find and replace. If styles were already registered, they will be\n * replaced.\n * @param {theme} theme JSON object of theme tokens to values.\n */\nfunction loadTheme(theme) {\n    _themeState.theme = theme;\n    // reload styles.\n    reloadStyles();\n}\nexports.loadTheme = loadTheme;\n/**\n * Clear already registered style elements and style records in theme_State object\n * @param option - specify which group of registered styles should be cleared.\n * Default to be both themable and non-themable styles will be cleared\n */\nfunction clearStyles(option) {\n    if (option === void 0) { option = 3 /* all */; }\n    if (option === 3 /* all */ || option === 2 /* onlyNonThemable */) {\n        clearStylesInternal(_themeState.registeredStyles);\n        _themeState.registeredStyles = [];\n    }\n    if (option === 3 /* all */ || option === 1 /* onlyThemable */) {\n        clearStylesInternal(_themeState.registeredThemableStyles);\n        _themeState.registeredThemableStyles = [];\n    }\n}\nexports.clearStyles = clearStyles;\nfunction clearStylesInternal(records) {\n    records.forEach(function (styleRecord) {\n        var styleElement = styleRecord && styleRecord.styleElement;\n        if (styleElement && styleElement.parentElement) {\n            styleElement.parentElement.removeChild(styleElement);\n        }\n    });\n}\n/**\n * Reloads styles.\n */\nfunction reloadStyles() {\n    if (_themeState.theme) {\n        var themableStyles = [];\n        for (var _i = 0, _a = _themeState.registeredThemableStyles; _i < _a.length; _i++) {\n            var styleRecord = _a[_i];\n            themableStyles.push(styleRecord.themableStyle);\n        }\n        if (themableStyles.length > 0) {\n            clearStyles(1 /* onlyThemable */);\n            applyThemableStyles([].concat.apply([], themableStyles));\n        }\n    }\n}\n/**\n * Find theme tokens and replaces them with provided theme values.\n * @param {string} styles Tokenized styles to fix.\n */\nfunction detokenize(styles) {\n    if (styles) {\n        styles = resolveThemableArray(splitStyles(styles)).styleString;\n    }\n    return styles;\n}\nexports.detokenize = detokenize;\n/**\n * Resolves ThemingInstruction objects in an array and joins the result into a string.\n * @param {ThemableArray} splitStyleArray ThemableArray to resolve and join.\n */\nfunction resolveThemableArray(splitStyleArray) {\n    var theme = _themeState.theme;\n    var themable = false;\n    // Resolve the array of theming instructions to an array of strings.\n    // Then join the array to produce the final CSS string.\n    var resolvedArray = (splitStyleArray || []).map(function (currentValue) {\n        var themeSlot = currentValue.theme;\n        if (themeSlot) {\n            themable = true;\n            // A theming annotation. Resolve it.\n            var themedValue = theme ? theme[themeSlot] : undefined;\n            var defaultValue = currentValue.defaultValue || 'inherit';\n            // Warn to console if we hit an unthemed value even when themes are provided, but only if \"DEBUG\" is true.\n            // Allow the themedValue to be undefined to explicitly request the default value.\n            if (theme && !themedValue && console && !(themeSlot in theme) && typeof DEBUG !== 'undefined' && DEBUG) {\n                console.warn(\"Theming value not provided for \\\"\" + themeSlot + \"\\\". Falling back to \\\"\" + defaultValue + \"\\\".\");\n            }\n            return themedValue || defaultValue;\n        }\n        else {\n            // A non-themable string. Preserve it.\n            return currentValue.rawString;\n        }\n    });\n    return {\n        styleString: resolvedArray.join(''),\n        themable: themable\n    };\n}\n/**\n * Split tokenized CSS into an array of strings and theme specification objects\n * @param {string} styles Tokenized styles to split.\n */\nfunction splitStyles(styles) {\n    var result = [];\n    if (styles) {\n        var pos = 0; // Current position in styles.\n        var tokenMatch = void 0; // eslint-disable-line @rushstack/no-null\n        while ((tokenMatch = _themeTokenRegex.exec(styles))) {\n            var matchIndex = tokenMatch.index;\n            if (matchIndex > pos) {\n                result.push({\n                    rawString: styles.substring(pos, matchIndex)\n                });\n            }\n            result.push({\n                theme: tokenMatch[1],\n                defaultValue: tokenMatch[2] // May be undefined\n            });\n            // index of the first character after the current match\n            pos = _themeTokenRegex.lastIndex;\n        }\n        // Push the rest of the string after the last match.\n        result.push({\n            rawString: styles.substring(pos)\n        });\n    }\n    return result;\n}\nexports.splitStyles = splitStyles;\n/**\n * Registers a set of style text. If it is registered too early, we will register it when the\n * window.load event is fired.\n * @param {ThemableArray} styleArray Array of IThemingInstruction objects to register.\n * @param {IStyleRecord} styleRecord May specify a style Element to update.\n */\nfunction registerStyles(styleArray) {\n    if (typeof document === 'undefined') {\n        return;\n    }\n    var head = document.getElementsByTagName('head')[0];\n    var styleElement = document.createElement('style');\n    var _a = resolveThemableArray(styleArray), styleString = _a.styleString, themable = _a.themable;\n    styleElement.setAttribute('data-load-themed-styles', 'true');\n    if (_styleNonce) {\n        styleElement.setAttribute('nonce', _styleNonce);\n    }\n    styleElement.appendChild(document.createTextNode(styleString));\n    _themeState.perf.count++;\n    head.appendChild(styleElement);\n    var ev = document.createEvent('HTMLEvents');\n    ev.initEvent('styleinsert', true /* bubbleEvent */, false /* cancelable */);\n    ev.args = {\n        newStyle: styleElement\n    };\n    document.dispatchEvent(ev);\n    var record = {\n        styleElement: styleElement,\n        themableStyle: styleArray\n    };\n    if (themable) {\n        _themeState.registeredThemableStyles.push(record);\n    }\n    else {\n        _themeState.registeredStyles.push(record);\n    }\n}\n//# sourceMappingURL=index.js.map","/* MIT license */\nvar cssKeywords = require('color-name');\n\n// NOTE: conversions should only return primitive values (i.e. arrays, or\n//       values that give correct `typeof` results).\n//       do not use box values types (i.e. Number(), String(), etc.)\n\nvar reverseKeywords = {};\nfor (var key in cssKeywords) {\n\tif (cssKeywords.hasOwnProperty(key)) {\n\t\treverseKeywords[cssKeywords[key]] = key;\n\t}\n}\n\nvar convert = module.exports = {\n\trgb: {channels: 3, labels: 'rgb'},\n\thsl: {channels: 3, labels: 'hsl'},\n\thsv: {channels: 3, labels: 'hsv'},\n\thwb: {channels: 3, labels: 'hwb'},\n\tcmyk: {channels: 4, labels: 'cmyk'},\n\txyz: {channels: 3, labels: 'xyz'},\n\tlab: {channels: 3, labels: 'lab'},\n\tlch: {channels: 3, labels: 'lch'},\n\thex: {channels: 1, labels: ['hex']},\n\tkeyword: {channels: 1, labels: ['keyword']},\n\tansi16: {channels: 1, labels: ['ansi16']},\n\tansi256: {channels: 1, labels: ['ansi256']},\n\thcg: {channels: 3, labels: ['h', 'c', 'g']},\n\tapple: {channels: 3, labels: ['r16', 'g16', 'b16']},\n\tgray: {channels: 1, labels: ['gray']}\n};\n\n// hide .channels and .labels properties\nfor (var model in convert) {\n\tif (convert.hasOwnProperty(model)) {\n\t\tif (!('channels' in convert[model])) {\n\t\t\tthrow new Error('missing channels property: ' + model);\n\t\t}\n\n\t\tif (!('labels' in convert[model])) {\n\t\t\tthrow new Error('missing channel labels property: ' + model);\n\t\t}\n\n\t\tif (convert[model].labels.length !== convert[model].channels) {\n\t\t\tthrow new Error('channel and label counts mismatch: ' + model);\n\t\t}\n\n\t\tvar channels = convert[model].channels;\n\t\tvar labels = convert[model].labels;\n\t\tdelete convert[model].channels;\n\t\tdelete convert[model].labels;\n\t\tObject.defineProperty(convert[model], 'channels', {value: channels});\n\t\tObject.defineProperty(convert[model], 'labels', {value: labels});\n\t}\n}\n\nconvert.rgb.hsl = function (rgb) {\n\tvar r = rgb[0] / 255;\n\tvar g = rgb[1] / 255;\n\tvar b = rgb[2] / 255;\n\tvar min = Math.min(r, g, b);\n\tvar max = Math.max(r, g, b);\n\tvar delta = max - min;\n\tvar h;\n\tvar s;\n\tvar l;\n\n\tif (max === min) {\n\t\th = 0;\n\t} else if (r === max) {\n\t\th = (g - b) / delta;\n\t} else if (g === max) {\n\t\th = 2 + (b - r) / delta;\n\t} else if (b === max) {\n\t\th = 4 + (r - g) / delta;\n\t}\n\n\th = Math.min(h * 60, 360);\n\n\tif (h < 0) {\n\t\th += 360;\n\t}\n\n\tl = (min + max) / 2;\n\n\tif (max === min) {\n\t\ts = 0;\n\t} else if (l <= 0.5) {\n\t\ts = delta / (max + min);\n\t} else {\n\t\ts = delta / (2 - max - min);\n\t}\n\n\treturn [h, s * 100, l * 100];\n};\n\nconvert.rgb.hsv = function (rgb) {\n\tvar rdif;\n\tvar gdif;\n\tvar bdif;\n\tvar h;\n\tvar s;\n\n\tvar r = rgb[0] / 255;\n\tvar g = rgb[1] / 255;\n\tvar b = rgb[2] / 255;\n\tvar v = Math.max(r, g, b);\n\tvar diff = v - Math.min(r, g, b);\n\tvar diffc = function (c) {\n\t\treturn (v - c) / 6 / diff + 1 / 2;\n\t};\n\n\tif (diff === 0) {\n\t\th = s = 0;\n\t} else {\n\t\ts = diff / v;\n\t\trdif = diffc(r);\n\t\tgdif = diffc(g);\n\t\tbdif = diffc(b);\n\n\t\tif (r === v) {\n\t\t\th = bdif - gdif;\n\t\t} else if (g === v) {\n\t\t\th = (1 / 3) + rdif - bdif;\n\t\t} else if (b === v) {\n\t\t\th = (2 / 3) + gdif - rdif;\n\t\t}\n\t\tif (h < 0) {\n\t\t\th += 1;\n\t\t} else if (h > 1) {\n\t\t\th -= 1;\n\t\t}\n\t}\n\n\treturn [\n\t\th * 360,\n\t\ts * 100,\n\t\tv * 100\n\t];\n};\n\nconvert.rgb.hwb = function (rgb) {\n\tvar r = rgb[0];\n\tvar g = rgb[1];\n\tvar b = rgb[2];\n\tvar h = convert.rgb.hsl(rgb)[0];\n\tvar w = 1 / 255 * Math.min(r, Math.min(g, b));\n\n\tb = 1 - 1 / 255 * Math.max(r, Math.max(g, b));\n\n\treturn [h, w * 100, b * 100];\n};\n\nconvert.rgb.cmyk = function (rgb) {\n\tvar r = rgb[0] / 255;\n\tvar g = rgb[1] / 255;\n\tvar b = rgb[2] / 255;\n\tvar c;\n\tvar m;\n\tvar y;\n\tvar k;\n\n\tk = Math.min(1 - r, 1 - g, 1 - b);\n\tc = (1 - r - k) / (1 - k) || 0;\n\tm = (1 - g - k) / (1 - k) || 0;\n\ty = (1 - b - k) / (1 - k) || 0;\n\n\treturn [c * 100, m * 100, y * 100, k * 100];\n};\n\n/**\n * See https://en.m.wikipedia.org/wiki/Euclidean_distance#Squared_Euclidean_distance\n * */\nfunction comparativeDistance(x, y) {\n\treturn (\n\t\tMath.pow(x[0] - y[0], 2) +\n\t\tMath.pow(x[1] - y[1], 2) +\n\t\tMath.pow(x[2] - y[2], 2)\n\t);\n}\n\nconvert.rgb.keyword = function (rgb) {\n\tvar reversed = reverseKeywords[rgb];\n\tif (reversed) {\n\t\treturn reversed;\n\t}\n\n\tvar currentClosestDistance = Infinity;\n\tvar currentClosestKeyword;\n\n\tfor (var keyword in cssKeywords) {\n\t\tif (cssKeywords.hasOwnProperty(keyword)) {\n\t\t\tvar value = cssKeywords[keyword];\n\n\t\t\t// Compute comparative distance\n\t\t\tvar distance = comparativeDistance(rgb, value);\n\n\t\t\t// Check if its less, if so set as closest\n\t\t\tif (distance < currentClosestDistance) {\n\t\t\t\tcurrentClosestDistance = distance;\n\t\t\t\tcurrentClosestKeyword = keyword;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn currentClosestKeyword;\n};\n\nconvert.keyword.rgb = function (keyword) {\n\treturn cssKeywords[keyword];\n};\n\nconvert.rgb.xyz = function (rgb) {\n\tvar r = rgb[0] / 255;\n\tvar g = rgb[1] / 255;\n\tvar b = rgb[2] / 255;\n\n\t// assume sRGB\n\tr = r > 0.04045 ? Math.pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);\n\tg = g > 0.04045 ? Math.pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);\n\tb = b > 0.04045 ? Math.pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);\n\n\tvar x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);\n\tvar y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);\n\tvar z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);\n\n\treturn [x * 100, y * 100, z * 100];\n};\n\nconvert.rgb.lab = function (rgb) {\n\tvar xyz = convert.rgb.xyz(rgb);\n\tvar x = xyz[0];\n\tvar y = xyz[1];\n\tvar z = xyz[2];\n\tvar l;\n\tvar a;\n\tvar b;\n\n\tx /= 95.047;\n\ty /= 100;\n\tz /= 108.883;\n\n\tx = x > 0.008856 ? Math.pow(x, 1 / 3) : (7.787 * x) + (16 / 116);\n\ty = y > 0.008856 ? Math.pow(y, 1 / 3) : (7.787 * y) + (16 / 116);\n\tz = z > 0.008856 ? Math.pow(z, 1 / 3) : (7.787 * z) + (16 / 116);\n\n\tl = (116 * y) - 16;\n\ta = 500 * (x - y);\n\tb = 200 * (y - z);\n\n\treturn [l, a, b];\n};\n\nconvert.hsl.rgb = function (hsl) {\n\tvar h = hsl[0] / 360;\n\tvar s = hsl[1] / 100;\n\tvar l = hsl[2] / 100;\n\tvar t1;\n\tvar t2;\n\tvar t3;\n\tvar rgb;\n\tvar val;\n\n\tif (s === 0) {\n\t\tval = l * 255;\n\t\treturn [val, val, val];\n\t}\n\n\tif (l < 0.5) {\n\t\tt2 = l * (1 + s);\n\t} else {\n\t\tt2 = l + s - l * s;\n\t}\n\n\tt1 = 2 * l - t2;\n\n\trgb = [0, 0, 0];\n\tfor (var i = 0; i < 3; i++) {\n\t\tt3 = h + 1 / 3 * -(i - 1);\n\t\tif (t3 < 0) {\n\t\t\tt3++;\n\t\t}\n\t\tif (t3 > 1) {\n\t\t\tt3--;\n\t\t}\n\n\t\tif (6 * t3 < 1) {\n\t\t\tval = t1 + (t2 - t1) * 6 * t3;\n\t\t} else if (2 * t3 < 1) {\n\t\t\tval = t2;\n\t\t} else if (3 * t3 < 2) {\n\t\t\tval = t1 + (t2 - t1) * (2 / 3 - t3) * 6;\n\t\t} else {\n\t\t\tval = t1;\n\t\t}\n\n\t\trgb[i] = val * 255;\n\t}\n\n\treturn rgb;\n};\n\nconvert.hsl.hsv = function (hsl) {\n\tvar h = hsl[0];\n\tvar s = hsl[1] / 100;\n\tvar l = hsl[2] / 100;\n\tvar smin = s;\n\tvar lmin = Math.max(l, 0.01);\n\tvar sv;\n\tvar v;\n\n\tl *= 2;\n\ts *= (l <= 1) ? l : 2 - l;\n\tsmin *= lmin <= 1 ? lmin : 2 - lmin;\n\tv = (l + s) / 2;\n\tsv = l === 0 ? (2 * smin) / (lmin + smin) : (2 * s) / (l + s);\n\n\treturn [h, sv * 100, v * 100];\n};\n\nconvert.hsv.rgb = function (hsv) {\n\tvar h = hsv[0] / 60;\n\tvar s = hsv[1] / 100;\n\tvar v = hsv[2] / 100;\n\tvar hi = Math.floor(h) % 6;\n\n\tvar f = h - Math.floor(h);\n\tvar p = 255 * v * (1 - s);\n\tvar q = 255 * v * (1 - (s * f));\n\tvar t = 255 * v * (1 - (s * (1 - f)));\n\tv *= 255;\n\n\tswitch (hi) {\n\t\tcase 0:\n\t\t\treturn [v, t, p];\n\t\tcase 1:\n\t\t\treturn [q, v, p];\n\t\tcase 2:\n\t\t\treturn [p, v, t];\n\t\tcase 3:\n\t\t\treturn [p, q, v];\n\t\tcase 4:\n\t\t\treturn [t, p, v];\n\t\tcase 5:\n\t\t\treturn [v, p, q];\n\t}\n};\n\nconvert.hsv.hsl = function (hsv) {\n\tvar h = hsv[0];\n\tvar s = hsv[1] / 100;\n\tvar v = hsv[2] / 100;\n\tvar vmin = Math.max(v, 0.01);\n\tvar lmin;\n\tvar sl;\n\tvar l;\n\n\tl = (2 - s) * v;\n\tlmin = (2 - s) * vmin;\n\tsl = s * vmin;\n\tsl /= (lmin <= 1) ? lmin : 2 - lmin;\n\tsl = sl || 0;\n\tl /= 2;\n\n\treturn [h, sl * 100, l * 100];\n};\n\n// http://dev.w3.org/csswg/css-color/#hwb-to-rgb\nconvert.hwb.rgb = function (hwb) {\n\tvar h = hwb[0] / 360;\n\tvar wh = hwb[1] / 100;\n\tvar bl = hwb[2] / 100;\n\tvar ratio = wh + bl;\n\tvar i;\n\tvar v;\n\tvar f;\n\tvar n;\n\n\t// wh + bl cant be > 1\n\tif (ratio > 1) {\n\t\twh /= ratio;\n\t\tbl /= ratio;\n\t}\n\n\ti = Math.floor(6 * h);\n\tv = 1 - bl;\n\tf = 6 * h - i;\n\n\tif ((i & 0x01) !== 0) {\n\t\tf = 1 - f;\n\t}\n\n\tn = wh + f * (v - wh); // linear interpolation\n\n\tvar r;\n\tvar g;\n\tvar b;\n\tswitch (i) {\n\t\tdefault:\n\t\tcase 6:\n\t\tcase 0: r = v; g = n; b = wh; break;\n\t\tcase 1: r = n; g = v; b = wh; break;\n\t\tcase 2: r = wh; g = v; b = n; break;\n\t\tcase 3: r = wh; g = n; b = v; break;\n\t\tcase 4: r = n; g = wh; b = v; break;\n\t\tcase 5: r = v; g = wh; b = n; break;\n\t}\n\n\treturn [r * 255, g * 255, b * 255];\n};\n\nconvert.cmyk.rgb = function (cmyk) {\n\tvar c = cmyk[0] / 100;\n\tvar m = cmyk[1] / 100;\n\tvar y = cmyk[2] / 100;\n\tvar k = cmyk[3] / 100;\n\tvar r;\n\tvar g;\n\tvar b;\n\n\tr = 1 - Math.min(1, c * (1 - k) + k);\n\tg = 1 - Math.min(1, m * (1 - k) + k);\n\tb = 1 - Math.min(1, y * (1 - k) + k);\n\n\treturn [r * 255, g * 255, b * 255];\n};\n\nconvert.xyz.rgb = function (xyz) {\n\tvar x = xyz[0] / 100;\n\tvar y = xyz[1] / 100;\n\tvar z = xyz[2] / 100;\n\tvar r;\n\tvar g;\n\tvar b;\n\n\tr = (x * 3.2406) + (y * -1.5372) + (z * -0.4986);\n\tg = (x * -0.9689) + (y * 1.8758) + (z * 0.0415);\n\tb = (x * 0.0557) + (y * -0.2040) + (z * 1.0570);\n\n\t// assume sRGB\n\tr = r > 0.0031308\n\t\t? ((1.055 * Math.pow(r, 1.0 / 2.4)) - 0.055)\n\t\t: r * 12.92;\n\n\tg = g > 0.0031308\n\t\t? ((1.055 * Math.pow(g, 1.0 / 2.4)) - 0.055)\n\t\t: g * 12.92;\n\n\tb = b > 0.0031308\n\t\t? ((1.055 * Math.pow(b, 1.0 / 2.4)) - 0.055)\n\t\t: b * 12.92;\n\n\tr = Math.min(Math.max(0, r), 1);\n\tg = Math.min(Math.max(0, g), 1);\n\tb = Math.min(Math.max(0, b), 1);\n\n\treturn [r * 255, g * 255, b * 255];\n};\n\nconvert.xyz.lab = function (xyz) {\n\tvar x = xyz[0];\n\tvar y = xyz[1];\n\tvar z = xyz[2];\n\tvar l;\n\tvar a;\n\tvar b;\n\n\tx /= 95.047;\n\ty /= 100;\n\tz /= 108.883;\n\n\tx = x > 0.008856 ? Math.pow(x, 1 / 3) : (7.787 * x) + (16 / 116);\n\ty = y > 0.008856 ? Math.pow(y, 1 / 3) : (7.787 * y) + (16 / 116);\n\tz = z > 0.008856 ? Math.pow(z, 1 / 3) : (7.787 * z) + (16 / 116);\n\n\tl = (116 * y) - 16;\n\ta = 500 * (x - y);\n\tb = 200 * (y - z);\n\n\treturn [l, a, b];\n};\n\nconvert.lab.xyz = function (lab) {\n\tvar l = lab[0];\n\tvar a = lab[1];\n\tvar b = lab[2];\n\tvar x;\n\tvar y;\n\tvar z;\n\n\ty = (l + 16) / 116;\n\tx = a / 500 + y;\n\tz = y - b / 200;\n\n\tvar y2 = Math.pow(y, 3);\n\tvar x2 = Math.pow(x, 3);\n\tvar z2 = Math.pow(z, 3);\n\ty = y2 > 0.008856 ? y2 : (y - 16 / 116) / 7.787;\n\tx = x2 > 0.008856 ? x2 : (x - 16 / 116) / 7.787;\n\tz = z2 > 0.008856 ? z2 : (z - 16 / 116) / 7.787;\n\n\tx *= 95.047;\n\ty *= 100;\n\tz *= 108.883;\n\n\treturn [x, y, z];\n};\n\nconvert.lab.lch = function (lab) {\n\tvar l = lab[0];\n\tvar a = lab[1];\n\tvar b = lab[2];\n\tvar hr;\n\tvar h;\n\tvar c;\n\n\thr = Math.atan2(b, a);\n\th = hr * 360 / 2 / Math.PI;\n\n\tif (h < 0) {\n\t\th += 360;\n\t}\n\n\tc = Math.sqrt(a * a + b * b);\n\n\treturn [l, c, h];\n};\n\nconvert.lch.lab = function (lch) {\n\tvar l = lch[0];\n\tvar c = lch[1];\n\tvar h = lch[2];\n\tvar a;\n\tvar b;\n\tvar hr;\n\n\thr = h / 360 * 2 * Math.PI;\n\ta = c * Math.cos(hr);\n\tb = c * Math.sin(hr);\n\n\treturn [l, a, b];\n};\n\nconvert.rgb.ansi16 = function (args) {\n\tvar r = args[0];\n\tvar g = args[1];\n\tvar b = args[2];\n\tvar value = 1 in arguments ? arguments[1] : convert.rgb.hsv(args)[2]; // hsv -> ansi16 optimization\n\n\tvalue = Math.round(value / 50);\n\n\tif (value === 0) {\n\t\treturn 30;\n\t}\n\n\tvar ansi = 30\n\t\t+ ((Math.round(b / 255) << 2)\n\t\t| (Math.round(g / 255) << 1)\n\t\t| Math.round(r / 255));\n\n\tif (value === 2) {\n\t\tansi += 60;\n\t}\n\n\treturn ansi;\n};\n\nconvert.hsv.ansi16 = function (args) {\n\t// optimization here; we already know the value and don't need to get\n\t// it converted for us.\n\treturn convert.rgb.ansi16(convert.hsv.rgb(args), args[2]);\n};\n\nconvert.rgb.ansi256 = function (args) {\n\tvar r = args[0];\n\tvar g = args[1];\n\tvar b = args[2];\n\n\t// we use the extended greyscale palette here, with the exception of\n\t// black and white. normal palette only has 4 greyscale shades.\n\tif (r === g && g === b) {\n\t\tif (r < 8) {\n\t\t\treturn 16;\n\t\t}\n\n\t\tif (r > 248) {\n\t\t\treturn 231;\n\t\t}\n\n\t\treturn Math.round(((r - 8) / 247) * 24) + 232;\n\t}\n\n\tvar ansi = 16\n\t\t+ (36 * Math.round(r / 255 * 5))\n\t\t+ (6 * Math.round(g / 255 * 5))\n\t\t+ Math.round(b / 255 * 5);\n\n\treturn ansi;\n};\n\nconvert.ansi16.rgb = function (args) {\n\tvar color = args % 10;\n\n\t// handle greyscale\n\tif (color === 0 || color === 7) {\n\t\tif (args > 50) {\n\t\t\tcolor += 3.5;\n\t\t}\n\n\t\tcolor = color / 10.5 * 255;\n\n\t\treturn [color, color, color];\n\t}\n\n\tvar mult = (~~(args > 50) + 1) * 0.5;\n\tvar r = ((color & 1) * mult) * 255;\n\tvar g = (((color >> 1) & 1) * mult) * 255;\n\tvar b = (((color >> 2) & 1) * mult) * 255;\n\n\treturn [r, g, b];\n};\n\nconvert.ansi256.rgb = function (args) {\n\t// handle greyscale\n\tif (args >= 232) {\n\t\tvar c = (args - 232) * 10 + 8;\n\t\treturn [c, c, c];\n\t}\n\n\targs -= 16;\n\n\tvar rem;\n\tvar r = Math.floor(args / 36) / 5 * 255;\n\tvar g = Math.floor((rem = args % 36) / 6) / 5 * 255;\n\tvar b = (rem % 6) / 5 * 255;\n\n\treturn [r, g, b];\n};\n\nconvert.rgb.hex = function (args) {\n\tvar integer = ((Math.round(args[0]) & 0xFF) << 16)\n\t\t+ ((Math.round(args[1]) & 0xFF) << 8)\n\t\t+ (Math.round(args[2]) & 0xFF);\n\n\tvar string = integer.toString(16).toUpperCase();\n\treturn '000000'.substring(string.length) + string;\n};\n\nconvert.hex.rgb = function (args) {\n\tvar match = args.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);\n\tif (!match) {\n\t\treturn [0, 0, 0];\n\t}\n\n\tvar colorString = match[0];\n\n\tif (match[0].length === 3) {\n\t\tcolorString = colorString.split('').map(function (char) {\n\t\t\treturn char + char;\n\t\t}).join('');\n\t}\n\n\tvar integer = parseInt(colorString, 16);\n\tvar r = (integer >> 16) & 0xFF;\n\tvar g = (integer >> 8) & 0xFF;\n\tvar b = integer & 0xFF;\n\n\treturn [r, g, b];\n};\n\nconvert.rgb.hcg = function (rgb) {\n\tvar r = rgb[0] / 255;\n\tvar g = rgb[1] / 255;\n\tvar b = rgb[2] / 255;\n\tvar max = Math.max(Math.max(r, g), b);\n\tvar min = Math.min(Math.min(r, g), b);\n\tvar chroma = (max - min);\n\tvar grayscale;\n\tvar hue;\n\n\tif (chroma < 1) {\n\t\tgrayscale = min / (1 - chroma);\n\t} else {\n\t\tgrayscale = 0;\n\t}\n\n\tif (chroma <= 0) {\n\t\thue = 0;\n\t} else\n\tif (max === r) {\n\t\thue = ((g - b) / chroma) % 6;\n\t} else\n\tif (max === g) {\n\t\thue = 2 + (b - r) / chroma;\n\t} else {\n\t\thue = 4 + (r - g) / chroma + 4;\n\t}\n\n\thue /= 6;\n\thue %= 1;\n\n\treturn [hue * 360, chroma * 100, grayscale * 100];\n};\n\nconvert.hsl.hcg = function (hsl) {\n\tvar s = hsl[1] / 100;\n\tvar l = hsl[2] / 100;\n\tvar c = 1;\n\tvar f = 0;\n\n\tif (l < 0.5) {\n\t\tc = 2.0 * s * l;\n\t} else {\n\t\tc = 2.0 * s * (1.0 - l);\n\t}\n\n\tif (c < 1.0) {\n\t\tf = (l - 0.5 * c) / (1.0 - c);\n\t}\n\n\treturn [hsl[0], c * 100, f * 100];\n};\n\nconvert.hsv.hcg = function (hsv) {\n\tvar s = hsv[1] / 100;\n\tvar v = hsv[2] / 100;\n\n\tvar c = s * v;\n\tvar f = 0;\n\n\tif (c < 1.0) {\n\t\tf = (v - c) / (1 - c);\n\t}\n\n\treturn [hsv[0], c * 100, f * 100];\n};\n\nconvert.hcg.rgb = function (hcg) {\n\tvar h = hcg[0] / 360;\n\tvar c = hcg[1] / 100;\n\tvar g = hcg[2] / 100;\n\n\tif (c === 0.0) {\n\t\treturn [g * 255, g * 255, g * 255];\n\t}\n\n\tvar pure = [0, 0, 0];\n\tvar hi = (h % 1) * 6;\n\tvar v = hi % 1;\n\tvar w = 1 - v;\n\tvar mg = 0;\n\n\tswitch (Math.floor(hi)) {\n\t\tcase 0:\n\t\t\tpure[0] = 1; pure[1] = v; pure[2] = 0; break;\n\t\tcase 1:\n\t\t\tpure[0] = w; pure[1] = 1; pure[2] = 0; break;\n\t\tcase 2:\n\t\t\tpure[0] = 0; pure[1] = 1; pure[2] = v; break;\n\t\tcase 3:\n\t\t\tpure[0] = 0; pure[1] = w; pure[2] = 1; break;\n\t\tcase 4:\n\t\t\tpure[0] = v; pure[1] = 0; pure[2] = 1; break;\n\t\tdefault:\n\t\t\tpure[0] = 1; pure[1] = 0; pure[2] = w;\n\t}\n\n\tmg = (1.0 - c) * g;\n\n\treturn [\n\t\t(c * pure[0] + mg) * 255,\n\t\t(c * pure[1] + mg) * 255,\n\t\t(c * pure[2] + mg) * 255\n\t];\n};\n\nconvert.hcg.hsv = function (hcg) {\n\tvar c = hcg[1] / 100;\n\tvar g = hcg[2] / 100;\n\n\tvar v = c + g * (1.0 - c);\n\tvar f = 0;\n\n\tif (v > 0.0) {\n\t\tf = c / v;\n\t}\n\n\treturn [hcg[0], f * 100, v * 100];\n};\n\nconvert.hcg.hsl = function (hcg) {\n\tvar c = hcg[1] / 100;\n\tvar g = hcg[2] / 100;\n\n\tvar l = g * (1.0 - c) + 0.5 * c;\n\tvar s = 0;\n\n\tif (l > 0.0 && l < 0.5) {\n\t\ts = c / (2 * l);\n\t} else\n\tif (l >= 0.5 && l < 1.0) {\n\t\ts = c / (2 * (1 - l));\n\t}\n\n\treturn [hcg[0], s * 100, l * 100];\n};\n\nconvert.hcg.hwb = function (hcg) {\n\tvar c = hcg[1] / 100;\n\tvar g = hcg[2] / 100;\n\tvar v = c + g * (1.0 - c);\n\treturn [hcg[0], (v - c) * 100, (1 - v) * 100];\n};\n\nconvert.hwb.hcg = function (hwb) {\n\tvar w = hwb[1] / 100;\n\tvar b = hwb[2] / 100;\n\tvar v = 1 - b;\n\tvar c = v - w;\n\tvar g = 0;\n\n\tif (c < 1) {\n\t\tg = (v - c) / (1 - c);\n\t}\n\n\treturn [hwb[0], c * 100, g * 100];\n};\n\nconvert.apple.rgb = function (apple) {\n\treturn [(apple[0] / 65535) * 255, (apple[1] / 65535) * 255, (apple[2] / 65535) * 255];\n};\n\nconvert.rgb.apple = function (rgb) {\n\treturn [(rgb[0] / 255) * 65535, (rgb[1] / 255) * 65535, (rgb[2] / 255) * 65535];\n};\n\nconvert.gray.rgb = function (args) {\n\treturn [args[0] / 100 * 255, args[0] / 100 * 255, args[0] / 100 * 255];\n};\n\nconvert.gray.hsl = convert.gray.hsv = function (args) {\n\treturn [0, 0, args[0]];\n};\n\nconvert.gray.hwb = function (gray) {\n\treturn [0, 100, gray[0]];\n};\n\nconvert.gray.cmyk = function (gray) {\n\treturn [0, 0, 0, gray[0]];\n};\n\nconvert.gray.lab = function (gray) {\n\treturn [gray[0], 0, 0];\n};\n\nconvert.gray.hex = function (gray) {\n\tvar val = Math.round(gray[0] / 100 * 255) & 0xFF;\n\tvar integer = (val << 16) + (val << 8) + val;\n\n\tvar string = integer.toString(16).toUpperCase();\n\treturn '000000'.substring(string.length) + string;\n};\n\nconvert.rgb.gray = function (rgb) {\n\tvar val = (rgb[0] + rgb[1] + rgb[2]) / 3;\n\treturn [val / 255 * 100];\n};\n","var conversions = require('./conversions');\nvar route = require('./route');\n\nvar convert = {};\n\nvar models = Object.keys(conversions);\n\nfunction wrapRaw(fn) {\n\tvar wrappedFn = function (args) {\n\t\tif (args === undefined || args === null) {\n\t\t\treturn args;\n\t\t}\n\n\t\tif (arguments.length > 1) {\n\t\t\targs = Array.prototype.slice.call(arguments);\n\t\t}\n\n\t\treturn fn(args);\n\t};\n\n\t// preserve .conversion property if there is one\n\tif ('conversion' in fn) {\n\t\twrappedFn.conversion = fn.conversion;\n\t}\n\n\treturn wrappedFn;\n}\n\nfunction wrapRounded(fn) {\n\tvar wrappedFn = function (args) {\n\t\tif (args === undefined || args === null) {\n\t\t\treturn args;\n\t\t}\n\n\t\tif (arguments.length > 1) {\n\t\t\targs = Array.prototype.slice.call(arguments);\n\t\t}\n\n\t\tvar result = fn(args);\n\n\t\t// we're assuming the result is an array here.\n\t\t// see notice in conversions.js; don't use box types\n\t\t// in conversion functions.\n\t\tif (typeof result === 'object') {\n\t\t\tfor (var len = result.length, i = 0; i < len; i++) {\n\t\t\t\tresult[i] = Math.round(result[i]);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n\n\t// preserve .conversion property if there is one\n\tif ('conversion' in fn) {\n\t\twrappedFn.conversion = fn.conversion;\n\t}\n\n\treturn wrappedFn;\n}\n\nmodels.forEach(function (fromModel) {\n\tconvert[fromModel] = {};\n\n\tObject.defineProperty(convert[fromModel], 'channels', {value: conversions[fromModel].channels});\n\tObject.defineProperty(convert[fromModel], 'labels', {value: conversions[fromModel].labels});\n\n\tvar routes = route(fromModel);\n\tvar routeModels = Object.keys(routes);\n\n\trouteModels.forEach(function (toModel) {\n\t\tvar fn = routes[toModel];\n\n\t\tconvert[fromModel][toModel] = wrapRounded(fn);\n\t\tconvert[fromModel][toModel].raw = wrapRaw(fn);\n\t});\n});\n\nmodule.exports = convert;\n","var conversions = require('./conversions');\n\n/*\n\tthis function routes a model to all other models.\n\n\tall functions that are routed have a property `.conversion` attached\n\tto the returned synthetic function. This property is an array\n\tof strings, each with the steps in between the 'from' and 'to'\n\tcolor models (inclusive).\n\n\tconversions that are not possible simply are not included.\n*/\n\nfunction buildGraph() {\n\tvar graph = {};\n\t// https://jsperf.com/object-keys-vs-for-in-with-closure/3\n\tvar models = Object.keys(conversions);\n\n\tfor (var len = models.length, i = 0; i < len; i++) {\n\t\tgraph[models[i]] = {\n\t\t\t// http://jsperf.com/1-vs-infinity\n\t\t\t// micro-opt, but this is simple.\n\t\t\tdistance: -1,\n\t\t\tparent: null\n\t\t};\n\t}\n\n\treturn graph;\n}\n\n// https://en.wikipedia.org/wiki/Breadth-first_search\nfunction deriveBFS(fromModel) {\n\tvar graph = buildGraph();\n\tvar queue = [fromModel]; // unshift -> queue -> pop\n\n\tgraph[fromModel].distance = 0;\n\n\twhile (queue.length) {\n\t\tvar current = queue.pop();\n\t\tvar adjacents = Object.keys(conversions[current]);\n\n\t\tfor (var len = adjacents.length, i = 0; i < len; i++) {\n\t\t\tvar adjacent = adjacents[i];\n\t\t\tvar node = graph[adjacent];\n\n\t\t\tif (node.distance === -1) {\n\t\t\t\tnode.distance = graph[current].distance + 1;\n\t\t\t\tnode.parent = current;\n\t\t\t\tqueue.unshift(adjacent);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn graph;\n}\n\nfunction link(from, to) {\n\treturn function (args) {\n\t\treturn to(from(args));\n\t};\n}\n\nfunction wrapConversion(toModel, graph) {\n\tvar path = [graph[toModel].parent, toModel];\n\tvar fn = conversions[graph[toModel].parent][toModel];\n\n\tvar cur = graph[toModel].parent;\n\twhile (graph[cur].parent) {\n\t\tpath.unshift(graph[cur].parent);\n\t\tfn = link(conversions[graph[cur].parent][cur], fn);\n\t\tcur = graph[cur].parent;\n\t}\n\n\tfn.conversion = path;\n\treturn fn;\n}\n\nmodule.exports = function (fromModel) {\n\tvar graph = deriveBFS(fromModel);\n\tvar conversion = {};\n\n\tvar models = Object.keys(graph);\n\tfor (var len = models.length, i = 0; i < len; i++) {\n\t\tvar toModel = models[i];\n\t\tvar node = graph[toModel];\n\n\t\tif (node.parent === null) {\n\t\t\t// no possible conversion, or this node is the source model.\n\t\t\tcontinue;\n\t\t}\n\n\t\tconversion[toModel] = wrapConversion(toModel, graph);\n\t}\n\n\treturn conversion;\n};\n\n","'use strict'\r\n\r\nmodule.exports = {\r\n\t\"aliceblue\": [240, 248, 255],\r\n\t\"antiquewhite\": [250, 235, 215],\r\n\t\"aqua\": [0, 255, 255],\r\n\t\"aquamarine\": [127, 255, 212],\r\n\t\"azure\": [240, 255, 255],\r\n\t\"beige\": [245, 245, 220],\r\n\t\"bisque\": [255, 228, 196],\r\n\t\"black\": [0, 0, 0],\r\n\t\"blanchedalmond\": [255, 235, 205],\r\n\t\"blue\": [0, 0, 255],\r\n\t\"blueviolet\": [138, 43, 226],\r\n\t\"brown\": [165, 42, 42],\r\n\t\"burlywood\": [222, 184, 135],\r\n\t\"cadetblue\": [95, 158, 160],\r\n\t\"chartreuse\": [127, 255, 0],\r\n\t\"chocolate\": [210, 105, 30],\r\n\t\"coral\": [255, 127, 80],\r\n\t\"cornflowerblue\": [100, 149, 237],\r\n\t\"cornsilk\": [255, 248, 220],\r\n\t\"crimson\": [220, 20, 60],\r\n\t\"cyan\": [0, 255, 255],\r\n\t\"darkblue\": [0, 0, 139],\r\n\t\"darkcyan\": [0, 139, 139],\r\n\t\"darkgoldenrod\": [184, 134, 11],\r\n\t\"darkgray\": [169, 169, 169],\r\n\t\"darkgreen\": [0, 100, 0],\r\n\t\"darkgrey\": [169, 169, 169],\r\n\t\"darkkhaki\": [189, 183, 107],\r\n\t\"darkmagenta\": [139, 0, 139],\r\n\t\"darkolivegreen\": [85, 107, 47],\r\n\t\"darkorange\": [255, 140, 0],\r\n\t\"darkorchid\": [153, 50, 204],\r\n\t\"darkred\": [139, 0, 0],\r\n\t\"darksalmon\": [233, 150, 122],\r\n\t\"darkseagreen\": [143, 188, 143],\r\n\t\"darkslateblue\": [72, 61, 139],\r\n\t\"darkslategray\": [47, 79, 79],\r\n\t\"darkslategrey\": [47, 79, 79],\r\n\t\"darkturquoise\": [0, 206, 209],\r\n\t\"darkviolet\": [148, 0, 211],\r\n\t\"deeppink\": [255, 20, 147],\r\n\t\"deepskyblue\": [0, 191, 255],\r\n\t\"dimgray\": [105, 105, 105],\r\n\t\"dimgrey\": [105, 105, 105],\r\n\t\"dodgerblue\": [30, 144, 255],\r\n\t\"firebrick\": [178, 34, 34],\r\n\t\"floralwhite\": [255, 250, 240],\r\n\t\"forestgreen\": [34, 139, 34],\r\n\t\"fuchsia\": [255, 0, 255],\r\n\t\"gainsboro\": [220, 220, 220],\r\n\t\"ghostwhite\": [248, 248, 255],\r\n\t\"gold\": [255, 215, 0],\r\n\t\"goldenrod\": [218, 165, 32],\r\n\t\"gray\": [128, 128, 128],\r\n\t\"green\": [0, 128, 0],\r\n\t\"greenyellow\": [173, 255, 47],\r\n\t\"grey\": [128, 128, 128],\r\n\t\"honeydew\": [240, 255, 240],\r\n\t\"hotpink\": [255, 105, 180],\r\n\t\"indianred\": [205, 92, 92],\r\n\t\"indigo\": [75, 0, 130],\r\n\t\"ivory\": [255, 255, 240],\r\n\t\"khaki\": [240, 230, 140],\r\n\t\"lavender\": [230, 230, 250],\r\n\t\"lavenderblush\": [255, 240, 245],\r\n\t\"lawngreen\": [124, 252, 0],\r\n\t\"lemonchiffon\": [255, 250, 205],\r\n\t\"lightblue\": [173, 216, 230],\r\n\t\"lightcoral\": [240, 128, 128],\r\n\t\"lightcyan\": [224, 255, 255],\r\n\t\"lightgoldenrodyellow\": [250, 250, 210],\r\n\t\"lightgray\": [211, 211, 211],\r\n\t\"lightgreen\": [144, 238, 144],\r\n\t\"lightgrey\": [211, 211, 211],\r\n\t\"lightpink\": [255, 182, 193],\r\n\t\"lightsalmon\": [255, 160, 122],\r\n\t\"lightseagreen\": [32, 178, 170],\r\n\t\"lightskyblue\": [135, 206, 250],\r\n\t\"lightslategray\": [119, 136, 153],\r\n\t\"lightslategrey\": [119, 136, 153],\r\n\t\"lightsteelblue\": [176, 196, 222],\r\n\t\"lightyellow\": [255, 255, 224],\r\n\t\"lime\": [0, 255, 0],\r\n\t\"limegreen\": [50, 205, 50],\r\n\t\"linen\": [250, 240, 230],\r\n\t\"magenta\": [255, 0, 255],\r\n\t\"maroon\": [128, 0, 0],\r\n\t\"mediumaquamarine\": [102, 205, 170],\r\n\t\"mediumblue\": [0, 0, 205],\r\n\t\"mediumorchid\": [186, 85, 211],\r\n\t\"mediumpurple\": [147, 112, 219],\r\n\t\"mediumseagreen\": [60, 179, 113],\r\n\t\"mediumslateblue\": [123, 104, 238],\r\n\t\"mediumspringgreen\": [0, 250, 154],\r\n\t\"mediumturquoise\": [72, 209, 204],\r\n\t\"mediumvioletred\": [199, 21, 133],\r\n\t\"midnightblue\": [25, 25, 112],\r\n\t\"mintcream\": [245, 255, 250],\r\n\t\"mistyrose\": [255, 228, 225],\r\n\t\"moccasin\": [255, 228, 181],\r\n\t\"navajowhite\": [255, 222, 173],\r\n\t\"navy\": [0, 0, 128],\r\n\t\"oldlace\": [253, 245, 230],\r\n\t\"olive\": [128, 128, 0],\r\n\t\"olivedrab\": [107, 142, 35],\r\n\t\"orange\": [255, 165, 0],\r\n\t\"orangered\": [255, 69, 0],\r\n\t\"orchid\": [218, 112, 214],\r\n\t\"palegoldenrod\": [238, 232, 170],\r\n\t\"palegreen\": [152, 251, 152],\r\n\t\"paleturquoise\": [175, 238, 238],\r\n\t\"palevioletred\": [219, 112, 147],\r\n\t\"papayawhip\": [255, 239, 213],\r\n\t\"peachpuff\": [255, 218, 185],\r\n\t\"peru\": [205, 133, 63],\r\n\t\"pink\": [255, 192, 203],\r\n\t\"plum\": [221, 160, 221],\r\n\t\"powderblue\": [176, 224, 230],\r\n\t\"purple\": [128, 0, 128],\r\n\t\"rebeccapurple\": [102, 51, 153],\r\n\t\"red\": [255, 0, 0],\r\n\t\"rosybrown\": [188, 143, 143],\r\n\t\"royalblue\": [65, 105, 225],\r\n\t\"saddlebrown\": [139, 69, 19],\r\n\t\"salmon\": [250, 128, 114],\r\n\t\"sandybrown\": [244, 164, 96],\r\n\t\"seagreen\": [46, 139, 87],\r\n\t\"seashell\": [255, 245, 238],\r\n\t\"sienna\": [160, 82, 45],\r\n\t\"silver\": [192, 192, 192],\r\n\t\"skyblue\": [135, 206, 235],\r\n\t\"slateblue\": [106, 90, 205],\r\n\t\"slategray\": [112, 128, 144],\r\n\t\"slategrey\": [112, 128, 144],\r\n\t\"snow\": [255, 250, 250],\r\n\t\"springgreen\": [0, 255, 127],\r\n\t\"steelblue\": [70, 130, 180],\r\n\t\"tan\": [210, 180, 140],\r\n\t\"teal\": [0, 128, 128],\r\n\t\"thistle\": [216, 191, 216],\r\n\t\"tomato\": [255, 99, 71],\r\n\t\"turquoise\": [64, 224, 208],\r\n\t\"violet\": [238, 130, 238],\r\n\t\"wheat\": [245, 222, 179],\r\n\t\"white\": [255, 255, 255],\r\n\t\"whitesmoke\": [245, 245, 245],\r\n\t\"yellow\": [255, 255, 0],\r\n\t\"yellowgreen\": [154, 205, 50]\r\n};\r\n","/* MIT license */\nvar colorNames = require('color-name');\nvar swizzle = require('simple-swizzle');\n\nvar reverseNames = {};\n\n// create a list of reverse color names\nfor (var name in colorNames) {\n\tif (colorNames.hasOwnProperty(name)) {\n\t\treverseNames[colorNames[name]] = name;\n\t}\n}\n\nvar cs = module.exports = {\n\tto: {},\n\tget: {}\n};\n\ncs.get = function (string) {\n\tvar prefix = string.substring(0, 3).toLowerCase();\n\tvar val;\n\tvar model;\n\tswitch (prefix) {\n\t\tcase 'hsl':\n\t\t\tval = cs.get.hsl(string);\n\t\t\tmodel = 'hsl';\n\t\t\tbreak;\n\t\tcase 'hwb':\n\t\t\tval = cs.get.hwb(string);\n\t\t\tmodel = 'hwb';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tval = cs.get.rgb(string);\n\t\t\tmodel = 'rgb';\n\t\t\tbreak;\n\t}\n\n\tif (!val) {\n\t\treturn null;\n\t}\n\n\treturn {model: model, value: val};\n};\n\ncs.get.rgb = function (string) {\n\tif (!string) {\n\t\treturn null;\n\t}\n\n\tvar abbr = /^#([a-f0-9]{3,4})$/i;\n\tvar hex = /^#([a-f0-9]{6})([a-f0-9]{2})?$/i;\n\tvar rgba = /^rgba?\\(\\s*([+-]?\\d+)\\s*,\\s*([+-]?\\d+)\\s*,\\s*([+-]?\\d+)\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/;\n\tvar per = /^rgba?\\(\\s*([+-]?[\\d\\.]+)\\%\\s*,\\s*([+-]?[\\d\\.]+)\\%\\s*,\\s*([+-]?[\\d\\.]+)\\%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/;\n\tvar keyword = /(\\D+)/;\n\n\tvar rgb = [0, 0, 0, 1];\n\tvar match;\n\tvar i;\n\tvar hexAlpha;\n\n\tif (match = string.match(hex)) {\n\t\thexAlpha = match[2];\n\t\tmatch = match[1];\n\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\t// https://jsperf.com/slice-vs-substr-vs-substring-methods-long-string/19\n\t\t\tvar i2 = i * 2;\n\t\t\trgb[i] = parseInt(match.slice(i2, i2 + 2), 16);\n\t\t}\n\n\t\tif (hexAlpha) {\n\t\t\trgb[3] = parseInt(hexAlpha, 16) / 255;\n\t\t}\n\t} else if (match = string.match(abbr)) {\n\t\tmatch = match[1];\n\t\thexAlpha = match[3];\n\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\trgb[i] = parseInt(match[i] + match[i], 16);\n\t\t}\n\n\t\tif (hexAlpha) {\n\t\t\trgb[3] = parseInt(hexAlpha + hexAlpha, 16) / 255;\n\t\t}\n\t} else if (match = string.match(rgba)) {\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\trgb[i] = parseInt(match[i + 1], 0);\n\t\t}\n\n\t\tif (match[4]) {\n\t\t\trgb[3] = parseFloat(match[4]);\n\t\t}\n\t} else if (match = string.match(per)) {\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\trgb[i] = Math.round(parseFloat(match[i + 1]) * 2.55);\n\t\t}\n\n\t\tif (match[4]) {\n\t\t\trgb[3] = parseFloat(match[4]);\n\t\t}\n\t} else if (match = string.match(keyword)) {\n\t\tif (match[1] === 'transparent') {\n\t\t\treturn [0, 0, 0, 0];\n\t\t}\n\n\t\trgb = colorNames[match[1]];\n\n\t\tif (!rgb) {\n\t\t\treturn null;\n\t\t}\n\n\t\trgb[3] = 1;\n\n\t\treturn rgb;\n\t} else {\n\t\treturn null;\n\t}\n\n\tfor (i = 0; i < 3; i++) {\n\t\trgb[i] = clamp(rgb[i], 0, 255);\n\t}\n\trgb[3] = clamp(rgb[3], 0, 1);\n\n\treturn rgb;\n};\n\ncs.get.hsl = function (string) {\n\tif (!string) {\n\t\treturn null;\n\t}\n\n\tvar hsl = /^hsla?\\(\\s*([+-]?(?:\\d{0,3}\\.)?\\d+)(?:deg)?\\s*,\\s*([+-]?[\\d\\.]+)%\\s*,\\s*([+-]?[\\d\\.]+)%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/;\n\tvar match = string.match(hsl);\n\n\tif (match) {\n\t\tvar alpha = parseFloat(match[4]);\n\t\tvar h = (parseFloat(match[1]) + 360) % 360;\n\t\tvar s = clamp(parseFloat(match[2]), 0, 100);\n\t\tvar l = clamp(parseFloat(match[3]), 0, 100);\n\t\tvar a = clamp(isNaN(alpha) ? 1 : alpha, 0, 1);\n\n\t\treturn [h, s, l, a];\n\t}\n\n\treturn null;\n};\n\ncs.get.hwb = function (string) {\n\tif (!string) {\n\t\treturn null;\n\t}\n\n\tvar hwb = /^hwb\\(\\s*([+-]?\\d{0,3}(?:\\.\\d+)?)(?:deg)?\\s*,\\s*([+-]?[\\d\\.]+)%\\s*,\\s*([+-]?[\\d\\.]+)%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/;\n\tvar match = string.match(hwb);\n\n\tif (match) {\n\t\tvar alpha = parseFloat(match[4]);\n\t\tvar h = ((parseFloat(match[1]) % 360) + 360) % 360;\n\t\tvar w = clamp(parseFloat(match[2]), 0, 100);\n\t\tvar b = clamp(parseFloat(match[3]), 0, 100);\n\t\tvar a = clamp(isNaN(alpha) ? 1 : alpha, 0, 1);\n\t\treturn [h, w, b, a];\n\t}\n\n\treturn null;\n};\n\ncs.to.hex = function () {\n\tvar rgba = swizzle(arguments);\n\n\treturn (\n\t\t'#' +\n\t\thexDouble(rgba[0]) +\n\t\thexDouble(rgba[1]) +\n\t\thexDouble(rgba[2]) +\n\t\t(rgba[3] < 1\n\t\t\t? (hexDouble(Math.round(rgba[3] * 255)))\n\t\t\t: '')\n\t);\n};\n\ncs.to.rgb = function () {\n\tvar rgba = swizzle(arguments);\n\n\treturn rgba.length < 4 || rgba[3] === 1\n\t\t? 'rgb(' + Math.round(rgba[0]) + ', ' + Math.round(rgba[1]) + ', ' + Math.round(rgba[2]) + ')'\n\t\t: 'rgba(' + Math.round(rgba[0]) + ', ' + Math.round(rgba[1]) + ', ' + Math.round(rgba[2]) + ', ' + rgba[3] + ')';\n};\n\ncs.to.rgb.percent = function () {\n\tvar rgba = swizzle(arguments);\n\n\tvar r = Math.round(rgba[0] / 255 * 100);\n\tvar g = Math.round(rgba[1] / 255 * 100);\n\tvar b = Math.round(rgba[2] / 255 * 100);\n\n\treturn rgba.length < 4 || rgba[3] === 1\n\t\t? 'rgb(' + r + '%, ' + g + '%, ' + b + '%)'\n\t\t: 'rgba(' + r + '%, ' + g + '%, ' + b + '%, ' + rgba[3] + ')';\n};\n\ncs.to.hsl = function () {\n\tvar hsla = swizzle(arguments);\n\treturn hsla.length < 4 || hsla[3] === 1\n\t\t? 'hsl(' + hsla[0] + ', ' + hsla[1] + '%, ' + hsla[2] + '%)'\n\t\t: 'hsla(' + hsla[0] + ', ' + hsla[1] + '%, ' + hsla[2] + '%, ' + hsla[3] + ')';\n};\n\n// hwb is a bit different than rgb(a) & hsl(a) since there is no alpha specific syntax\n// (hwb have alpha optional & 1 is default value)\ncs.to.hwb = function () {\n\tvar hwba = swizzle(arguments);\n\n\tvar a = '';\n\tif (hwba.length >= 4 && hwba[3] !== 1) {\n\t\ta = ', ' + hwba[3];\n\t}\n\n\treturn 'hwb(' + hwba[0] + ', ' + hwba[1] + '%, ' + hwba[2] + '%' + a + ')';\n};\n\ncs.to.keyword = function (rgb) {\n\treturn reverseNames[rgb.slice(0, 3)];\n};\n\n// helpers\nfunction clamp(num, min, max) {\n\treturn Math.min(Math.max(min, num), max);\n}\n\nfunction hexDouble(num) {\n\tvar str = num.toString(16).toUpperCase();\n\treturn (str.length < 2) ? '0' + str : str;\n}\n","'use strict';\n\nvar colorString = require('color-string');\nvar convert = require('color-convert');\n\nvar _slice = [].slice;\n\nvar skippedModels = [\n\t// to be honest, I don't really feel like keyword belongs in color convert, but eh.\n\t'keyword',\n\n\t// gray conflicts with some method names, and has its own method defined.\n\t'gray',\n\n\t// shouldn't really be in color-convert either...\n\t'hex'\n];\n\nvar hashedModelKeys = {};\nObject.keys(convert).forEach(function (model) {\n\thashedModelKeys[_slice.call(convert[model].labels).sort().join('')] = model;\n});\n\nvar limiters = {};\n\nfunction Color(obj, model) {\n\tif (!(this instanceof Color)) {\n\t\treturn new Color(obj, model);\n\t}\n\n\tif (model && model in skippedModels) {\n\t\tmodel = null;\n\t}\n\n\tif (model && !(model in convert)) {\n\t\tthrow new Error('Unknown model: ' + model);\n\t}\n\n\tvar i;\n\tvar channels;\n\n\tif (obj == null) { // eslint-disable-line no-eq-null,eqeqeq\n\t\tthis.model = 'rgb';\n\t\tthis.color = [0, 0, 0];\n\t\tthis.valpha = 1;\n\t} else if (obj instanceof Color) {\n\t\tthis.model = obj.model;\n\t\tthis.color = obj.color.slice();\n\t\tthis.valpha = obj.valpha;\n\t} else if (typeof obj === 'string') {\n\t\tvar result = colorString.get(obj);\n\t\tif (result === null) {\n\t\t\tthrow new Error('Unable to parse color from string: ' + obj);\n\t\t}\n\n\t\tthis.model = result.model;\n\t\tchannels = convert[this.model].channels;\n\t\tthis.color = result.value.slice(0, channels);\n\t\tthis.valpha = typeof result.value[channels] === 'number' ? result.value[channels] : 1;\n\t} else if (obj.length) {\n\t\tthis.model = model || 'rgb';\n\t\tchannels = convert[this.model].channels;\n\t\tvar newArr = _slice.call(obj, 0, channels);\n\t\tthis.color = zeroArray(newArr, channels);\n\t\tthis.valpha = typeof obj[channels] === 'number' ? obj[channels] : 1;\n\t} else if (typeof obj === 'number') {\n\t\t// this is always RGB - can be converted later on.\n\t\tobj &= 0xFFFFFF;\n\t\tthis.model = 'rgb';\n\t\tthis.color = [\n\t\t\t(obj >> 16) & 0xFF,\n\t\t\t(obj >> 8) & 0xFF,\n\t\t\tobj & 0xFF\n\t\t];\n\t\tthis.valpha = 1;\n\t} else {\n\t\tthis.valpha = 1;\n\n\t\tvar keys = Object.keys(obj);\n\t\tif ('alpha' in obj) {\n\t\t\tkeys.splice(keys.indexOf('alpha'), 1);\n\t\t\tthis.valpha = typeof obj.alpha === 'number' ? obj.alpha : 0;\n\t\t}\n\n\t\tvar hashedKeys = keys.sort().join('');\n\t\tif (!(hashedKeys in hashedModelKeys)) {\n\t\t\tthrow new Error('Unable to parse color from object: ' + JSON.stringify(obj));\n\t\t}\n\n\t\tthis.model = hashedModelKeys[hashedKeys];\n\n\t\tvar labels = convert[this.model].labels;\n\t\tvar color = [];\n\t\tfor (i = 0; i < labels.length; i++) {\n\t\t\tcolor.push(obj[labels[i]]);\n\t\t}\n\n\t\tthis.color = zeroArray(color);\n\t}\n\n\t// perform limitations (clamping, etc.)\n\tif (limiters[this.model]) {\n\t\tchannels = convert[this.model].channels;\n\t\tfor (i = 0; i < channels; i++) {\n\t\t\tvar limit = limiters[this.model][i];\n\t\t\tif (limit) {\n\t\t\t\tthis.color[i] = limit(this.color[i]);\n\t\t\t}\n\t\t}\n\t}\n\n\tthis.valpha = Math.max(0, Math.min(1, this.valpha));\n\n\tif (Object.freeze) {\n\t\tObject.freeze(this);\n\t}\n}\n\nColor.prototype = {\n\ttoString: function () {\n\t\treturn this.string();\n\t},\n\n\ttoJSON: function () {\n\t\treturn this[this.model]();\n\t},\n\n\tstring: function (places) {\n\t\tvar self = this.model in colorString.to ? this : this.rgb();\n\t\tself = self.round(typeof places === 'number' ? places : 1);\n\t\tvar args = self.valpha === 1 ? self.color : self.color.concat(this.valpha);\n\t\treturn colorString.to[self.model](args);\n\t},\n\n\tpercentString: function (places) {\n\t\tvar self = this.rgb().round(typeof places === 'number' ? places : 1);\n\t\tvar args = self.valpha === 1 ? self.color : self.color.concat(this.valpha);\n\t\treturn colorString.to.rgb.percent(args);\n\t},\n\n\tarray: function () {\n\t\treturn this.valpha === 1 ? this.color.slice() : this.color.concat(this.valpha);\n\t},\n\n\tobject: function () {\n\t\tvar result = {};\n\t\tvar channels = convert[this.model].channels;\n\t\tvar labels = convert[this.model].labels;\n\n\t\tfor (var i = 0; i < channels; i++) {\n\t\t\tresult[labels[i]] = this.color[i];\n\t\t}\n\n\t\tif (this.valpha !== 1) {\n\t\t\tresult.alpha = this.valpha;\n\t\t}\n\n\t\treturn result;\n\t},\n\n\tunitArray: function () {\n\t\tvar rgb = this.rgb().color;\n\t\trgb[0] /= 255;\n\t\trgb[1] /= 255;\n\t\trgb[2] /= 255;\n\n\t\tif (this.valpha !== 1) {\n\t\t\trgb.push(this.valpha);\n\t\t}\n\n\t\treturn rgb;\n\t},\n\n\tunitObject: function () {\n\t\tvar rgb = this.rgb().object();\n\t\trgb.r /= 255;\n\t\trgb.g /= 255;\n\t\trgb.b /= 255;\n\n\t\tif (this.valpha !== 1) {\n\t\t\trgb.alpha = this.valpha;\n\t\t}\n\n\t\treturn rgb;\n\t},\n\n\tround: function (places) {\n\t\tplaces = Math.max(places || 0, 0);\n\t\treturn new Color(this.color.map(roundToPlace(places)).concat(this.valpha), this.model);\n\t},\n\n\talpha: function (val) {\n\t\tif (arguments.length) {\n\t\t\treturn new Color(this.color.concat(Math.max(0, Math.min(1, val))), this.model);\n\t\t}\n\n\t\treturn this.valpha;\n\t},\n\n\t// rgb\n\tred: getset('rgb', 0, maxfn(255)),\n\tgreen: getset('rgb', 1, maxfn(255)),\n\tblue: getset('rgb', 2, maxfn(255)),\n\n\thue: getset(['hsl', 'hsv', 'hsl', 'hwb', 'hcg'], 0, function (val) { return ((val % 360) + 360) % 360; }), // eslint-disable-line brace-style\n\n\tsaturationl: getset('hsl', 1, maxfn(100)),\n\tlightness: getset('hsl', 2, maxfn(100)),\n\n\tsaturationv: getset('hsv', 1, maxfn(100)),\n\tvalue: getset('hsv', 2, maxfn(100)),\n\n\tchroma: getset('hcg', 1, maxfn(100)),\n\tgray: getset('hcg', 2, maxfn(100)),\n\n\twhite: getset('hwb', 1, maxfn(100)),\n\twblack: getset('hwb', 2, maxfn(100)),\n\n\tcyan: getset('cmyk', 0, maxfn(100)),\n\tmagenta: getset('cmyk', 1, maxfn(100)),\n\tyellow: getset('cmyk', 2, maxfn(100)),\n\tblack: getset('cmyk', 3, maxfn(100)),\n\n\tx: getset('xyz', 0, maxfn(100)),\n\ty: getset('xyz', 1, maxfn(100)),\n\tz: getset('xyz', 2, maxfn(100)),\n\n\tl: getset('lab', 0, maxfn(100)),\n\ta: getset('lab', 1),\n\tb: getset('lab', 2),\n\n\tkeyword: function (val) {\n\t\tif (arguments.length) {\n\t\t\treturn new Color(val);\n\t\t}\n\n\t\treturn convert[this.model].keyword(this.color);\n\t},\n\n\thex: function (val) {\n\t\tif (arguments.length) {\n\t\t\treturn new Color(val);\n\t\t}\n\n\t\treturn colorString.to.hex(this.rgb().round().color);\n\t},\n\n\trgbNumber: function () {\n\t\tvar rgb = this.rgb().color;\n\t\treturn ((rgb[0] & 0xFF) << 16) | ((rgb[1] & 0xFF) << 8) | (rgb[2] & 0xFF);\n\t},\n\n\tluminosity: function () {\n\t\t// http://www.w3.org/TR/WCAG20/#relativeluminancedef\n\t\tvar rgb = this.rgb().color;\n\n\t\tvar lum = [];\n\t\tfor (var i = 0; i < rgb.length; i++) {\n\t\t\tvar chan = rgb[i] / 255;\n\t\t\tlum[i] = (chan <= 0.03928) ? chan / 12.92 : Math.pow(((chan + 0.055) / 1.055), 2.4);\n\t\t}\n\n\t\treturn 0.2126 * lum[0] + 0.7152 * lum[1] + 0.0722 * lum[2];\n\t},\n\n\tcontrast: function (color2) {\n\t\t// http://www.w3.org/TR/WCAG20/#contrast-ratiodef\n\t\tvar lum1 = this.luminosity();\n\t\tvar lum2 = color2.luminosity();\n\n\t\tif (lum1 > lum2) {\n\t\t\treturn (lum1 + 0.05) / (lum2 + 0.05);\n\t\t}\n\n\t\treturn (lum2 + 0.05) / (lum1 + 0.05);\n\t},\n\n\tlevel: function (color2) {\n\t\tvar contrastRatio = this.contrast(color2);\n\t\tif (contrastRatio >= 7.1) {\n\t\t\treturn 'AAA';\n\t\t}\n\n\t\treturn (contrastRatio >= 4.5) ? 'AA' : '';\n\t},\n\n\tisDark: function () {\n\t\t// YIQ equation from http://24ways.org/2010/calculating-color-contrast\n\t\tvar rgb = this.rgb().color;\n\t\tvar yiq = (rgb[0] * 299 + rgb[1] * 587 + rgb[2] * 114) / 1000;\n\t\treturn yiq < 128;\n\t},\n\n\tisLight: function () {\n\t\treturn !this.isDark();\n\t},\n\n\tnegate: function () {\n\t\tvar rgb = this.rgb();\n\t\tfor (var i = 0; i < 3; i++) {\n\t\t\trgb.color[i] = 255 - rgb.color[i];\n\t\t}\n\t\treturn rgb;\n\t},\n\n\tlighten: function (ratio) {\n\t\tvar hsl = this.hsl();\n\t\thsl.color[2] += hsl.color[2] * ratio;\n\t\treturn hsl;\n\t},\n\n\tdarken: function (ratio) {\n\t\tvar hsl = this.hsl();\n\t\thsl.color[2] -= hsl.color[2] * ratio;\n\t\treturn hsl;\n\t},\n\n\tsaturate: function (ratio) {\n\t\tvar hsl = this.hsl();\n\t\thsl.color[1] += hsl.color[1] * ratio;\n\t\treturn hsl;\n\t},\n\n\tdesaturate: function (ratio) {\n\t\tvar hsl = this.hsl();\n\t\thsl.color[1] -= hsl.color[1] * ratio;\n\t\treturn hsl;\n\t},\n\n\twhiten: function (ratio) {\n\t\tvar hwb = this.hwb();\n\t\thwb.color[1] += hwb.color[1] * ratio;\n\t\treturn hwb;\n\t},\n\n\tblacken: function (ratio) {\n\t\tvar hwb = this.hwb();\n\t\thwb.color[2] += hwb.color[2] * ratio;\n\t\treturn hwb;\n\t},\n\n\tgrayscale: function () {\n\t\t// http://en.wikipedia.org/wiki/Grayscale#Converting_color_to_grayscale\n\t\tvar rgb = this.rgb().color;\n\t\tvar val = rgb[0] * 0.3 + rgb[1] * 0.59 + rgb[2] * 0.11;\n\t\treturn Color.rgb(val, val, val);\n\t},\n\n\tfade: function (ratio) {\n\t\treturn this.alpha(this.valpha - (this.valpha * ratio));\n\t},\n\n\topaquer: function (ratio) {\n\t\treturn this.alpha(this.valpha + (this.valpha * ratio));\n\t},\n\n\trotate: function (degrees) {\n\t\tvar hsl = this.hsl();\n\t\tvar hue = hsl.color[0];\n\t\thue = (hue + degrees) % 360;\n\t\thue = hue < 0 ? 360 + hue : hue;\n\t\thsl.color[0] = hue;\n\t\treturn hsl;\n\t},\n\n\tmix: function (mixinColor, weight) {\n\t\t// ported from sass implementation in C\n\t\t// https://github.com/sass/libsass/blob/0e6b4a2850092356aa3ece07c6b249f0221caced/functions.cpp#L209\n\t\tif (!mixinColor || !mixinColor.rgb) {\n\t\t\tthrow new Error('Argument to \"mix\" was not a Color instance, but rather an instance of ' + typeof mixinColor);\n\t\t}\n\t\tvar color1 = mixinColor.rgb();\n\t\tvar color2 = this.rgb();\n\t\tvar p = weight === undefined ? 0.5 : weight;\n\n\t\tvar w = 2 * p - 1;\n\t\tvar a = color1.alpha() - color2.alpha();\n\n\t\tvar w1 = (((w * a === -1) ? w : (w + a) / (1 + w * a)) + 1) / 2.0;\n\t\tvar w2 = 1 - w1;\n\n\t\treturn Color.rgb(\n\t\t\t\tw1 * color1.red() + w2 * color2.red(),\n\t\t\t\tw1 * color1.green() + w2 * color2.green(),\n\t\t\t\tw1 * color1.blue() + w2 * color2.blue(),\n\t\t\t\tcolor1.alpha() * p + color2.alpha() * (1 - p));\n\t}\n};\n\n// model conversion methods and static constructors\nObject.keys(convert).forEach(function (model) {\n\tif (skippedModels.indexOf(model) !== -1) {\n\t\treturn;\n\t}\n\n\tvar channels = convert[model].channels;\n\n\t// conversion methods\n\tColor.prototype[model] = function () {\n\t\tif (this.model === model) {\n\t\t\treturn new Color(this);\n\t\t}\n\n\t\tif (arguments.length) {\n\t\t\treturn new Color(arguments, model);\n\t\t}\n\n\t\tvar newAlpha = typeof arguments[channels] === 'number' ? channels : this.valpha;\n\t\treturn new Color(assertArray(convert[this.model][model].raw(this.color)).concat(newAlpha), model);\n\t};\n\n\t// 'static' construction methods\n\tColor[model] = function (color) {\n\t\tif (typeof color === 'number') {\n\t\t\tcolor = zeroArray(_slice.call(arguments), channels);\n\t\t}\n\t\treturn new Color(color, model);\n\t};\n});\n\nfunction roundTo(num, places) {\n\treturn Number(num.toFixed(places));\n}\n\nfunction roundToPlace(places) {\n\treturn function (num) {\n\t\treturn roundTo(num, places);\n\t};\n}\n\nfunction getset(model, channel, modifier) {\n\tmodel = Array.isArray(model) ? model : [model];\n\n\tmodel.forEach(function (m) {\n\t\t(limiters[m] || (limiters[m] = []))[channel] = modifier;\n\t});\n\n\tmodel = model[0];\n\n\treturn function (val) {\n\t\tvar result;\n\n\t\tif (arguments.length) {\n\t\t\tif (modifier) {\n\t\t\t\tval = modifier(val);\n\t\t\t}\n\n\t\t\tresult = this[model]();\n\t\t\tresult.color[channel] = val;\n\t\t\treturn result;\n\t\t}\n\n\t\tresult = this[model]().color[channel];\n\t\tif (modifier) {\n\t\t\tresult = modifier(result);\n\t\t}\n\n\t\treturn result;\n\t};\n}\n\nfunction maxfn(max) {\n\treturn function (v) {\n\t\treturn Math.max(0, Math.min(max, v));\n\t};\n}\n\nfunction assertArray(val) {\n\treturn Array.isArray(val) ? val : [val];\n}\n\nfunction zeroArray(arr, length) {\n\tfor (var i = 0; i < length; i++) {\n\t\tif (typeof arr[i] !== 'number') {\n\t\t\tarr[i] = 0;\n\t\t}\n\t}\n\n\treturn arr;\n}\n\nmodule.exports = Color;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"@media(prefers-color-scheme: dark){button{background-color:#cb6587;color:#fff;border:solid 1px #cb6587}select,input,textarea{background-color:#333;color:#fff;border:solid 1px #cb6587}}._3oqP36CzDqGwQhR5EBotZ8{display:flex;flex-direction:column;width:100%;height:100%}.TgPjoV7iJNYCAy7JGehq5{flex:0 0 auto;overflow-x:hidden}._3HATRWbeMgoyox2A7L0YBE{flex:1 1 auto;position:relative;display:flex}._3r2W4NoMPT9FFoHwxvOAWA{width:\\\"100%\\\";min-width:200px;flex-grow:1;flex-shrink:1;position:relative}@media(prefers-color-scheme: dark){._3r2W4NoMPT9FFoHwxvOAWA a:link,._3r2W4NoMPT9FFoHwxvOAWA a:visited{color:#ba7cff}}.pducnu-_KEc0VRXCEcKQ6{border:solid 1px #c68;overflow:auto;padding:10px;outline:none;position:absolute;left:0;top:0;right:0;bottom:0}.gSkNqVOto4JJj3_aeBHHI{flex-grow:0;flex-shrink:0;width:6px;cursor:col-resize}.gSkNqVOto4JJj3_aeBHHI:hover{background-color:#ccc}._2cnuW2eMTyKiAnLSYyZHg2{flex-grow:0;flex-shrink:0;width:30px;cursor:hand;white-space:nowrap}._2cnuW2eMTyKiAnLSYyZHg2 div{transform:rotate(-90deg)}._2cnuW2eMTyKiAnLSYyZHg2:hover{background-color:#ccc}._15X-vLCs72gF0Wb1DRBm9K{min-width:340px;flex-shrink:0;flex-grow:0;width:300px}._15X-vLCs72gF0Wb1DRBm9K._4c3Np7Ob3EgjJqvy3_r07{width:100%}@media(prefers-color-scheme: dark){.pducnu-_KEc0VRXCEcKQ6{border:solid 1px #cb6587}}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"mainPane\": \"_3oqP36CzDqGwQhR5EBotZ8\",\n\t\"noGrow\": \"TgPjoV7iJNYCAy7JGehq5\",\n\t\"body\": \"_3HATRWbeMgoyox2A7L0YBE\",\n\t\"editorContainer\": \"_3r2W4NoMPT9FFoHwxvOAWA\",\n\t\"editor\": \"pducnu-_KEc0VRXCEcKQ6\",\n\t\"resizer\": \"gSkNqVOto4JJj3_aeBHHI\",\n\t\"showSidePane\": \"_2cnuW2eMTyKiAnLSYyZHg2\",\n\t\"sidePane\": \"_15X-vLCs72gF0Wb1DRBm9K\",\n\t\"sidePaneFullWidth\": \"_4c3Np7Ob3EgjJqvy3_r07\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"@media(prefers-color-scheme: dark){button{background-color:#0091a1;color:#aaf7ff;border:solid 1px #007b8b}select,input,textarea{background-color:#333;color:#aaf7ff;border:solid 1px #007b8b}}._2bo1k8lHl_uV-BG6znDJAB{display:flex;flex-direction:column;width:100%;height:100%}._2w6Qajx0rNoAfiZ90ELvWi{flex:0 0 auto;overflow-x:hidden}.Wu-w1vnX5xXDlokHB7qep{flex:1 1 auto;position:relative;display:flex}._1QRxv0rbFhdjIh9rjvd2w4{width:\\\"100%\\\";min-width:200px;flex-grow:1;flex-shrink:1;position:relative}@media(prefers-color-scheme: dark){._1QRxv0rbFhdjIh9rjvd2w4 a:link,._1QRxv0rbFhdjIh9rjvd2w4 a:visited{color:#ba7cff}}._3a-q_waO25gsrEedKcbvzq{border:solid 1px #0bc;overflow:auto;padding:10px;outline:none;position:absolute;left:0;top:0;right:0;bottom:0}._2fUtCc9nx7qZAmJvSYE2Ij{flex-grow:0;flex-shrink:0;width:6px;cursor:col-resize}._2fUtCc9nx7qZAmJvSYE2Ij:hover{background-color:#ccc}._2ksqVkP0P8VOnkTSDwC9gZ{flex-grow:0;flex-shrink:0;width:30px;cursor:hand;white-space:nowrap}._2ksqVkP0P8VOnkTSDwC9gZ div{transform:rotate(-90deg)}._2ksqVkP0P8VOnkTSDwC9gZ:hover{background-color:#ccc}.p_p04H6Z22MyE14zIJ1QR{min-width:340px;flex-shrink:0;flex-grow:0;width:300px}.p_p04H6Z22MyE14zIJ1QR._3aTZ87z1JhQNydo6VrKJpL{width:100%}@media(prefers-color-scheme: dark){._3a-q_waO25gsrEedKcbvzq{border:solid 1px #007b8b}}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"mainPane\": \"_2bo1k8lHl_uV-BG6znDJAB\",\n\t\"noGrow\": \"_2w6Qajx0rNoAfiZ90ELvWi\",\n\t\"body\": \"Wu-w1vnX5xXDlokHB7qep\",\n\t\"editorContainer\": \"_1QRxv0rbFhdjIh9rjvd2w4\",\n\t\"editor\": \"_3a-q_waO25gsrEedKcbvzq\",\n\t\"resizer\": \"_2fUtCc9nx7qZAmJvSYE2Ij\",\n\t\"showSidePane\": \"_2ksqVkP0P8VOnkTSDwC9gZ\",\n\t\"sidePane\": \"p_p04H6Z22MyE14zIJ1QR\",\n\t\"sidePaneFullWidth\": \"_3aTZ87z1JhQNydo6VrKJpL\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"@media(prefers-color-scheme: dark){button{background-color:#359;color:#f3f5fa;border:solid 1px #359}select,input,textarea{background-color:#333;color:#f3f5fa;border:solid 1px #359}}.dVd89RZgIk76h7b7dVpOJ{display:flex;flex-direction:column;width:100%;height:100%}._2kePKYpu6F5AsbB7DqyHNN{flex:0 0 auto;overflow-x:hidden}._62AP4_hA_Vv0eN0AQhCeJ{flex:1 1 auto;position:relative;display:flex}.YLkdFAKHbXAE4CNIUlJCD{width:\\\"100%\\\";min-width:200px;flex-grow:1;flex-shrink:1;position:relative}@media(prefers-color-scheme: dark){.YLkdFAKHbXAE4CNIUlJCD a:link,.YLkdFAKHbXAE4CNIUlJCD a:visited{color:#ba7cff}}._1bIYHzmrp09BNU3VSi5a7n{border:solid 1px #46a;overflow:auto;padding:10px;outline:none;position:absolute;left:0;top:0;right:0;bottom:0}._3T0-hBePrejQ-DvJN1tx7X{flex-grow:0;flex-shrink:0;width:6px;cursor:col-resize}._3T0-hBePrejQ-DvJN1tx7X:hover{background-color:#ccc}.YzkmD24k3OFCDeGz5oS4P{flex-grow:0;flex-shrink:0;width:30px;cursor:hand;white-space:nowrap}.YzkmD24k3OFCDeGz5oS4P div{transform:rotate(-90deg)}.YzkmD24k3OFCDeGz5oS4P:hover{background-color:#ccc}._3jULxjzwYnEMHvFrdRNVW{min-width:340px;flex-shrink:0;flex-grow:0;width:300px}._3jULxjzwYnEMHvFrdRNVW._1FPCiYLQgR18tA4VOYaZk5{width:100%}@media(prefers-color-scheme: dark){._1bIYHzmrp09BNU3VSi5a7n{border:solid 1px #359}}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"mainPane\": \"dVd89RZgIk76h7b7dVpOJ\",\n\t\"noGrow\": \"_2kePKYpu6F5AsbB7DqyHNN\",\n\t\"body\": \"_62AP4_hA_Vv0eN0AQhCeJ\",\n\t\"editorContainer\": \"YLkdFAKHbXAE4CNIUlJCD\",\n\t\"editor\": \"_1bIYHzmrp09BNU3VSi5a7n\",\n\t\"resizer\": \"_3T0-hBePrejQ-DvJN1tx7X\",\n\t\"showSidePane\": \"YzkmD24k3OFCDeGz5oS4P\",\n\t\"sidePane\": \"_3jULxjzwYnEMHvFrdRNVW\",\n\t\"sidePaneFullWidth\": \"_1FPCiYLQgR18tA4VOYaZk5\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".zzrG7QTYWevpNEutHRteL{border:solid 1px #000;position:relative;width:100%;height:250px}.zzrG7QTYWevpNEutHRteL ._2oyU282TgFscZ5UHgcUmdp{position:absolute;top:5px;left:5px;right:60px;bottom:25px}.zzrG7QTYWevpNEutHRteL ._2oyU282TgFscZ5UHgcUmdp .tACuk57Dyi-G8vSeWqr1J{width:100%;height:100%;background:linear-gradient(to right, white, rgba(255, 255, 255, 0))}.zzrG7QTYWevpNEutHRteL ._2oyU282TgFscZ5UHgcUmdp ._2spr_UnliyPKejcb4aR4VA{width:100%;height:100%;background:linear-gradient(to top, black, rgba(0, 0, 0, 0))}.zzrG7QTYWevpNEutHRteL ._2oyU282TgFscZ5UHgcUmdp .w4z5tFrATWvV5ruSLWsJp{position:absolute}.zzrG7QTYWevpNEutHRteL ._2oyU282TgFscZ5UHgcUmdp .w4z5tFrATWvV5ruSLWsJp div{position:absolute;box-sizing:border-box;left:-6px;top:-6px;width:12px;height:12px;border:solid 2px #000;border-radius:50%}.zzrG7QTYWevpNEutHRteL .dtqPj9iGhxveR4Am-elmu{position:absolute;top:5px;width:50px;right:5px;bottom:50%}.zzrG7QTYWevpNEutHRteL ._3eWedriXwotOrDVbydtjbM{position:absolute;top:50%;width:50px;right:5px;bottom:5px}.zzrG7QTYWevpNEutHRteL ._3MccxpeP-m7bKvTxQer9Ky{position:absolute;left:5px;right:60px;bottom:5px;height:15px;background:linear-gradient(to right, #ff0000 0%, #ffff00 17%, #00ff00 33%, #00ffff 50%, #0000ff 67%, #ff00ff 83%, #ff0000 100%)}.zzrG7QTYWevpNEutHRteL ._3MccxpeP-m7bKvTxQer9Ky .w4z5tFrATWvV5ruSLWsJp{position:absolute;height:100%}.zzrG7QTYWevpNEutHRteL ._3MccxpeP-m7bKvTxQer9Ky .w4z5tFrATWvV5ruSLWsJp div{position:absolute;box-sizing:border-box;left:-4px;width:8px;top:-2px;bottom:-2px;border:solid 2px #000;border-radius:20%}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"container\": \"zzrG7QTYWevpNEutHRteL\",\n\t\"picker\": \"_2oyU282TgFscZ5UHgcUmdp\",\n\t\"layer1\": \"tACuk57Dyi-G8vSeWqr1J\",\n\t\"layer2\": \"_2spr_UnliyPKejcb4aR4VA\",\n\t\"currentColor\": \"w4z5tFrATWvV5ruSLWsJp\",\n\t\"newColor\": \"dtqPj9iGhxveR4Am-elmu\",\n\t\"initColor\": \"_3eWedriXwotOrDVbydtjbM\",\n\t\"hueBar\": \"_3MccxpeP-m7bKvTxQer9Ky\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._1XG2Bco-v9O5NAoH3itX7Q{height:20px;vertical-align:top;padding:2px;border-width:1px;border-color:#888;background-color:#ccc}._1XG2Bco-v9O5NAoH3itX7Q:hover{background-color:#fff}._3v5ta2KP4K-0EgGtd3bQK_{font-weight:bold;background-color:#eee;border-bottom:none}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"button\": \"_1XG2Bco-v9O5NAoH3itX7Q\",\n\t\"buttonChecked\": \"_3v5ta2KP4K-0EgGtd3bQK_\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._2GEQ9Uklm2RgowVT5wloM5{margin-bottom:2px;display:flex;font-family:\\\"Segoe UI\\\",Tahoma,Geneva,Verdana,sans-serif;font-size:12pt;border:solid 2px #ccc;flex:1 1 auto;display:flex;flex-direction:column}._2GEQ9Uklm2RgowVT5wloM5._1SGC81fRmFiRryJnOCUYUA{border-color:#0aa}._2GEQ9Uklm2RgowVT5wloM5 ._3mTUXQnR6WVKJ3TIojfBxV{border-color:blue}._1VCYY8CALrYrYoxHKLOR4P{flex:0 0 auto;white-space:nowrap;overflow:hidden;padding:3px 0 0 0;height:20px}._1VCYY8CALrYrYoxHKLOR4P:hover .ub-CPWuXr_N9mRIZPU7_I{display:block}._3SCrXbMz2KKukvkwCWTGdf{font-weight:bold;padding:0 5px;float:left}._1kZx8vRULBT9npbnyJBuc9{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis}.ub-CPWuXr_N9mRIZPU7_I{float:right;display:none}._16PbfQXLdPWe8joev_gpv1{border-bottom:solid 1px #888}.KbF2K3xE3GR0RxLEUbmOI{background-color:#fff;padding:4px;display:flex;flex-direction:column}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelWrapper\": \"_2GEQ9Uklm2RgowVT5wloM5\",\n\t\"childSelected\": \"_1SGC81fRmFiRryJnOCUYUA\",\n\t\"selected\": \"_3mTUXQnR6WVKJ3TIojfBxV\",\n\t\"titleBar\": \"_1VCYY8CALrYrYoxHKLOR4P\",\n\t\"buttonGroup\": \"ub-CPWuXr_N9mRIZPU7_I\",\n\t\"title\": \"_3SCrXbMz2KKukvkwCWTGdf\",\n\t\"subTitle\": \"_1kZx8vRULBT9npbnyJBuc9\",\n\t\"titleWithBorder\": \"_16PbfQXLdPWe8joev_gpv1\",\n\t\"expandedBody\": \"KbF2K3xE3GR0RxLEUbmOI\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".oWxDoOcJZm6FiLp8R9doV{display:table}._1MRfJEKwXkTsWv0iJ-vp_0{display:table-row;height:24px}._2LoglwXHTK6h_k0iBs_O6k{display:table-cell;width:120px;vertical-align:top}._3HcoL7AQ-tp5YkzIl3mYj9{display:table-cell;margin:2px;overflow-x:hidden}._1ZUjp1XfsLv5W05XJC-yHg{color:red;font-weight:bold}.gydAIDg3ErAaS1zSeeuyA{width:60px}.glbDMIRcOZLB6uttC-OMc{width:95%}._35ylXsle1EnTq1SQZNPxAb{width:95%;height:80px}._2DP7dT0OkQLaRfU9QBRWGs{width:80px}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"formatTable\": \"oWxDoOcJZm6FiLp8R9doV\",\n\t\"formatRow\": \"_1MRfJEKwXkTsWv0iJ-vp_0\",\n\t\"formatName\": \"_2LoglwXHTK6h_k0iBs_O6k\",\n\t\"formatValue\": \"_3HcoL7AQ-tp5YkzIl3mYj9\",\n\t\"errorMessage\": \"_1ZUjp1XfsLv5W05XJC-yHg\",\n\t\"colorValue\": \"gydAIDg3ErAaS1zSeeuyA\",\n\t\"textValue\": \"glbDMIRcOZLB6uttC-OMc\",\n\t\"multiLineValue\": \"_35ylXsle1EnTq1SQZNPxAb\",\n\t\"numberValue\": \"_2DP7dT0OkQLaRfU9QBRWGs\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._3AxKJernZ4-yqwa_1a-E_Q{background-color:#cff}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelBr\": \"_3AxKJernZ4-yqwa_1a-E_Q\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._1htVWp5WjKy-H11id0kYoy{background-color:#093}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelCode\": \"_1htVWp5WjKy-H11id0kYoy\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".SzAPBNvfwSEs9ZB-TdEJo{background-color:#c0f}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelDivider\": \"SzAPBNvfwSEs9ZB-TdEJo\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._8Zkp-BcezdCSurVQQVKEO{background-color:#ddd}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelDocument\": \"_8Zkp-BcezdCSurVQQVKEO\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._3ZSCq_xeNTupfMzY2Ru2Bp{background-color:#3b2}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelEntity\": \"_3ZSCq_xeNTupfMzY2Ru2Bp\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".BywJYW0DKFb7EVGTLPKzi{background-color:#a8a}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelFormatContainer\": \"BywJYW0DKFb7EVGTLPKzi\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._1EZG3xw5ewbbyW0GpZTTUQ{background-color:#cfc}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelGeneral\": \"_1EZG3xw5ewbbyW0GpZTTUQ\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._1ds6to0NHohXvwGPPunJ0X{max-width:100px}._1nx1rBpjrPCd4cDcqPs8fA{background-color:#ff3}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"image\": \"_1ds6to0NHohXvwGPPunJ0X\",\n\t\"modelImage\": \"_1nx1rBpjrPCd4cDcqPs8fA\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Iywlk_OkpYROuncmQ4PcD{margin:0;font-size:13px;word-break:break-all;white-space:pre-wrap}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"json\": \"Iywlk_OkpYROuncmQ4PcD\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".DJcEiH6WFtND_54zovraZ{background-color:#07f}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelLink\": \"DJcEiH6WFtND_54zovraZ\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._2VoVfljozZbZcTgt3lNWnz{background-color:#fb7}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelListItem\": \"_2VoVfljozZbZcTgt3lNWnz\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._3iC2KJHDovY7JBIxFureNz{background-color:#38a}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelListLevel\": \"_3iC2KJHDovY7JBIxFureNz\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._32LMnZyuA6QyMQE-nWjkoV{background-color:#bdf}._2jkb_ijQSG8B_W4LIGJ7YQ{background-color:#ccf}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelParagraph\": \"_32LMnZyuA6QyMQE-nWjkoV\",\n\t\"modelDecorator\": \"_2jkb_ijQSG8B_W4LIGJ7YQ\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._18pEffJ4lYmtsOB10zXC-S{background-color:#7ef}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelSelectionMarker\": \"_18pEffJ4lYmtsOB10zXC-S\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._2G6nJ-wUvIVFiltEkbKI1V{background-color:#fbd}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelTableCell\": \"_2G6nJ-wUvIVFiltEkbKI1V\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._2Ok59Ge7z9BTMr_2iCW49a{background-color:#a88}._3MpKDhrjzKUJOzbuG5WIUt{width:40px}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelTableRow\": \"_2Ok59Ge7z9BTMr_2iCW49a\",\n\t\"sizeInput\": \"_3MpKDhrjzKUJOzbuG5WIUt\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._1Ggt2n9oUJ-EdkAiKF6Cmz{background-color:#df8}._19aUZi4gbsA50rFiPAAEo0{width:40px}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelTable\": \"_1Ggt2n9oUJ-EdkAiKF6Cmz\",\n\t\"sizeInput\": \"_19aUZi4gbsA50rFiPAAEo0\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._3t8NafdkqMYrJOBA5RCf95{background-color:#fca}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modelText\": \"_3t8NafdkqMYrJOBA5RCf95\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"@media(prefers-color-scheme: dark){button{background-color:#cb6587;color:#fff;border:solid 1px #cb6587}select,input,textarea{background-color:#333;color:#fff;border:solid 1px #cb6587}}._2MoIdQIJL4VJdSV5qIMppd{display:flex;flex-direction:column;overflow:auto hidden;border:solid 1px #c68}._2BiG3YW4OWQohdnTDeQB-q{font-family:\\\"Tahoma\\\";font-size:12pt;font-weight:bold;background-color:#c68;color:#fff;padding:2px;border:solid 1px #fff;cursor:pointer;flex:0 0 auto}._2BiG3YW4OWQohdnTDeQB-q:hover{background-color:#d27997}._1VpEDwEJkCV8mwoMk95-4h{display:flex;flex-direction:column;flex:1 1 auto}._1VpEDwEJkCV8mwoMk95-4h .AjBWAWK4o414DXYB0fK4T{flex:1 1 auto;display:flex;position:relative}._1VpEDwEJkCV8mwoMk95-4h .AjBWAWK4o414DXYB0fK4T ._4KpfnLoPVRjAX7uRasMo3{position:absolute;left:0;top:0;right:0;bottom:0;display:flex;flex-direction:column;font-family:Arial,Helvetica,sans-serif;padding:10px;overflow-y:auto}._1zbXX1raP8Kmh12FSUD_56{flex:0 0 auto}._1zbXX1raP8Kmh12FSUD_56 .AjBWAWK4o414DXYB0fK4T{height:0;overflow:hidden}@media(prefers-color-scheme: dark){._2MoIdQIJL4VJdSV5qIMppd{color:#0bc;border:solid 1px #cb6587}._2BiG3YW4OWQohdnTDeQB-q{background-color:#cb6587;color:#333}._2BiG3YW4OWQohdnTDeQB-q:hover{background-color:#d17896}}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"sidePane\": \"_2MoIdQIJL4VJdSV5qIMppd\",\n\t\"title\": \"_2BiG3YW4OWQohdnTDeQB-q\",\n\t\"activePane\": \"_1VpEDwEJkCV8mwoMk95-4h\",\n\t\"bodyContainer\": \"AjBWAWK4o414DXYB0fK4T\",\n\t\"body\": \"_4KpfnLoPVRjAX7uRasMo3\",\n\t\"inactivePane\": \"_1zbXX1raP8Kmh12FSUD_56\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"@media(prefers-color-scheme: dark){button{background-color:#0091a1;color:#aaf7ff;border:solid 1px #007b8b}select,input,textarea{background-color:#333;color:#aaf7ff;border:solid 1px #007b8b}}._1PlpDVxjlx0PpeYJornEhO{display:flex;flex-direction:column;overflow:auto hidden;border:solid 1px #0bc}.bUl77zUyQ8rsLeCWewoHf{font-family:\\\"Tahoma\\\";font-size:12pt;font-weight:bold;background-color:#09a;color:#fff;padding:2px;border:solid 1px #fff;cursor:pointer;flex:0 0 auto}.bUl77zUyQ8rsLeCWewoHf:hover{background-color:#00b0c4}._1Wy64YypxEm0pHdAFt3XyU{display:flex;flex-direction:column;flex:1 1 auto}._1Wy64YypxEm0pHdAFt3XyU ._3n6qkPOj7d7pT5EreXLpW_{flex:1 1 auto;display:flex;position:relative}._1Wy64YypxEm0pHdAFt3XyU ._3n6qkPOj7d7pT5EreXLpW_ ._1kHOYplq2tIl0x8bAqBZrs{position:absolute;left:0;top:0;right:0;bottom:0;display:flex;flex-direction:column;font-family:Arial,Helvetica,sans-serif;padding:10px;overflow-y:auto}._2l2WY2-sLGfv8zWnCEMFYu{flex:0 0 auto}._2l2WY2-sLGfv8zWnCEMFYu ._3n6qkPOj7d7pT5EreXLpW_{height:0;overflow:hidden}@media(prefers-color-scheme: dark){._1PlpDVxjlx0PpeYJornEhO{color:#0bc;border:solid 1px #007b8b}.bUl77zUyQ8rsLeCWewoHf{background-color:#0091a1;color:#333}.bUl77zUyQ8rsLeCWewoHf:hover{background-color:#00a8bb}}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"sidePane\": \"_1PlpDVxjlx0PpeYJornEhO\",\n\t\"title\": \"bUl77zUyQ8rsLeCWewoHf\",\n\t\"activePane\": \"_1Wy64YypxEm0pHdAFt3XyU\",\n\t\"bodyContainer\": \"_3n6qkPOj7d7pT5EreXLpW_\",\n\t\"body\": \"_1kHOYplq2tIl0x8bAqBZrs\",\n\t\"inactivePane\": \"_2l2WY2-sLGfv8zWnCEMFYu\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"@media(prefers-color-scheme: dark){button{background-color:#359;color:#f3f5fa;border:solid 1px #359}select,input,textarea{background-color:#333;color:#f3f5fa;border:solid 1px #359}}._3E4w2dfxapv3keUAbTD4H1{display:flex;flex-direction:column;overflow:auto hidden;border:solid 1px #46a}._28bOaJOupYZyt1pzmeArKM{font-family:\\\"Tahoma\\\";font-size:12pt;font-weight:bold;background-color:#46a;color:#fff;padding:2px;border:solid 1px #fff;cursor:pointer;flex:0 0 auto}._28bOaJOupYZyt1pzmeArKM:hover{background-color:#4f72b9}._21V0X2bVftymWiIWtX-Yxr{display:flex;flex-direction:column;flex:1 1 auto}._21V0X2bVftymWiIWtX-Yxr .ipNNSLeCQh9Ds7_lntGVq{flex:1 1 auto;display:flex;position:relative}._21V0X2bVftymWiIWtX-Yxr .ipNNSLeCQh9Ds7_lntGVq ._3o7ub-wm8v4QeSG8bhfps4{position:absolute;left:0;top:0;right:0;bottom:0;display:flex;flex-direction:column;font-family:Arial,Helvetica,sans-serif;padding:10px;overflow-y:auto}._1O6YfzpAOvAfNByCh5Z0dA{flex:0 0 auto}._1O6YfzpAOvAfNByCh5Z0dA .ipNNSLeCQh9Ds7_lntGVq{height:0;overflow:hidden}@media(prefers-color-scheme: dark){._3E4w2dfxapv3keUAbTD4H1{color:#0bc;border:solid 1px #359}._28bOaJOupYZyt1pzmeArKM{background-color:#359;color:#333}._28bOaJOupYZyt1pzmeArKM:hover{background-color:#3960ac}}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"sidePane\": \"_3E4w2dfxapv3keUAbTD4H1\",\n\t\"title\": \"_28bOaJOupYZyt1pzmeArKM\",\n\t\"activePane\": \"_21V0X2bVftymWiIWtX-Yxr\",\n\t\"bodyContainer\": \"ipNNSLeCQh9Ds7_lntGVq\",\n\t\"body\": \"_3o7ub-wm8v4QeSG8bhfps4\",\n\t\"inactivePane\": \"_1O6YfzpAOvAfNByCh5Z0dA\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._12Yaq4bmIYMlsqqYimZ13I{flex:0 0 auto;padding-bottom:5px}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"header\": \"_12Yaq4bmIYMlsqqYimZ13I\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._1_jgBU84mPgcYlpMVPoqWE{overflow:hidden;text-overflow:ellipsis;cursor:pointer;margin:3px 0;white-space:nowrap}._1_jgBU84mPgcYlpMVPoqWE:hover{background-color:#eee}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"block\": \"_1_jgBU84mPgcYlpMVPoqWE\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._2QN9z7UV4YLHwj9CQ-6ra6{position:absolute;left:25px;right:25px;top:25px;bottom:25px}.KAuwbJuev3yAQmPcrB-wl,._2r_v4LIS95O1jezeMfgUpS,.bIPZz2lZ0Dy0-dW2Poeua{position:relative;width:100px;height:100px;border:solid 1px #000}.bIPZz2lZ0Dy0-dW2Poeua{background-color:#fff}._2r_v4LIS95O1jezeMfgUpS{background-color:#333}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"result\": \"_2QN9z7UV4YLHwj9CQ-6ra6\",\n\t\"backgroundBase\": \"KAuwbJuev3yAQmPcrB-wl\",\n\t\"darkBackground\": \"_2r_v4LIS95O1jezeMfgUpS\",\n\t\"lightBackground\": \"bIPZz2lZ0Dy0-dW2Poeua\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._1hYhx3hKo_jDHdj3blAjc{margin-top:2px;margin-bottom:2px;line-height:2px}._5v3zhTlG_yH7GaGVgXfQP{width:30px;margin-left:4px}._1RrgLiiHLlvBCf-d5YWxnu{margin-top:2px;margin-bottom:2px}._3V3Ji0Va8o5p54tjedX892{font-weight:bold}._137J0ZhSm3qals9lhoTtS3{line-height:20px}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"input\": \"_1hYhx3hKo_jDHdj3blAjc\",\n\t\"coordinates\": \"_5v3zhTlG_yH7GaGVgXfQP\",\n\t\"button\": \"_1RrgLiiHLlvBCf-d5YWxnu\",\n\t\"title\": \"_3V3Ji0Va8o5p54tjedX892\",\n\t\"containerInfo\": \"_137J0ZhSm3qals9lhoTtS3\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._3zqjTFVESq7ErkoLCRZ-6U{resize:none;min-height:100px;max-height:200px}._3eEmGG3kPCcFFRLXYSrjlt{text-align:center}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"text\": \"_3zqjTFVESq7ErkoLCRZ-6U\",\n\t\"buttonRow\": \"_3eEmGG3kPCcFFRLXYSrjlt\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._3w8Hon1pjNxrKF0BoO_5HY{outline:none;resize:none;min-height:40px;width:90%}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"textarea\": \"_3w8Hon1pjNxrKF0BoO_5HY\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"@media(prefers-color-scheme: dark){button{background-color:#0091a1;color:#aaf7ff;border:solid 1px #007b8b}select,input,textarea{background-color:#333;color:#aaf7ff;border:solid 1px #007b8b}}.deySpGrN2RNEpBoMFR8Uh{font-weight:bold;background-color:#aaf7ff}._2mBGUX8vWQF-5jynECLtGD{background-color:#00b0c4;border:solid 2px #09a}@media(prefers-color-scheme: dark){.deySpGrN2RNEpBoMFR8Uh{background-color:#a1f6ff}._2mBGUX8vWQF-5jynECLtGD{background-color:#00a8bb;border:solid 2px #0091a1}}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"regionNode\": \"deySpGrN2RNEpBoMFR8Uh\",\n\t\"hover\": \"_2mBGUX8vWQF-5jynECLtGD\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".z_Kjs2wjz5dWJBsuOtSYN{outline:none;resize:none;min-height:100px;height:300px}._1jzoyXnrzDHw1HFmidMaWi{margin:10px;height:35px;width:80px;flex:0 0 auto}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"textarea\": \"z_Kjs2wjz5dWJBsuOtSYN\",\n\t\"button\": \"_1jzoyXnrzDHw1HFmidMaWi\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._1npSAsDS54nnYHLeTCHICi{text-align:center}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"buttonRow\": \"_1npSAsDS54nnYHLeTCHICi\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".CbjnP9kr5_9Gii4apK5Fd{flex:1 1 auto;overflow:auto}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"contentModel\": \"CbjnP9kr5_9Gii4apK5Fd\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".CUhdSMr2-viO-wEH-cIdZ{flex:0 0 auto;padding-bottom:5px}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"header\": \"CUhdSMr2-viO-wEH-cIdZ\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._14ZiO78VHLGM8tMbB6Y_d5{outline:none;resize:none;min-height:40px;width:90%}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"textarea\": \"_14ZiO78VHLGM8tMbB6Y_d5\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._3QUL-cTI2rzYtI4ueZE5lr{vertical-align:top}._pll-4jUC7rvgi0vFQdY1{white-space:nowrap}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"checkboxColumn\": \"_3QUL-cTI2rzYtI4ueZE5lr\",\n\t\"defaultFormatLabel\": \"_pll-4jUC7rvgi0vFQdY1\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._2TlmgQ1bW5R050B6jYhEX{max-width:100%;max-height:300px}.ffJacBjxWzCVBw1QPEOh4{font-family:\\\"Courier New\\\";font-size:10.5pt;margin:10px}.bUF-XqoekK8dhSeJ-0o5c{margin-left:20px}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"img\": \"_2TlmgQ1bW5R050B6jYhEX\",\n\t\"pasteContent\": \"ffJacBjxWzCVBw1QPEOh4\",\n\t\"eventContent\": \"bUF-XqoekK8dhSeJ-0o5c\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._2HXvsNDp44ok-mZyQwNNCy{color:#eee}._1HxlX2f9hy_xnwciZLYJ3w{font-weight:bold}@media(prefers-color-scheme: dark){._2HXvsNDp44ok-mZyQwNNCy{color:#555}}.dark ._2HXvsNDp44ok-mZyQwNNCy{color:#555}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"inactive\": \"_2HXvsNDp44ok-mZyQwNNCy\",\n\t\"title\": \"_1HxlX2f9hy_xnwciZLYJ3w\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"@media(prefers-color-scheme: dark){button{background-color:#0091a1;color:#aaf7ff;border:solid 1px #007b8b}select,input,textarea{background-color:#333;color:#aaf7ff;border:solid 1px #007b8b}}.HibV3xkyKxOpjnAyk0qr4{flex:1 1 auto;display:flex;flex-direction:column}._1yCf4MUqqEDULqM4RSNRBS{margin-bottom:10px;flex:0 0 auto}.E1MpWNg-lFB-dmiOBDnVv{flex:1 1 auto;resize:none;min-height:100px;border-color:#0bc}._2WqAZxlRXbhGBPoaHrJ1Gv{min-height:100px;max-height:200px;overflow:hidden auto;border:solid 1px #0bc}._2WqAZxlRXbhGBPoaHrJ1Gv pre{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:pointer;margin:0}._2WqAZxlRXbhGBPoaHrJ1Gv pre:hover{background-color:#eee}._2WqAZxlRXbhGBPoaHrJ1Gv pre._21blMEsk_K31sbjM73Q_V2{font-weight:bold}._2WqAZxlRXbhGBPoaHrJ1Gv pre.t0z_eiUKKfEvZR3eNUMXy{background-color:#ff0}@media(prefers-color-scheme: dark){._2WqAZxlRXbhGBPoaHrJ1Gv{border:solid 1px #007b8b}.E1MpWNg-lFB-dmiOBDnVv{border-color:#007b8b}._2WqAZxlRXbhGBPoaHrJ1Gv{border:solid 1px #007b8b}}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"snapshotPane\": \"HibV3xkyKxOpjnAyk0qr4\",\n\t\"buttons\": \"_1yCf4MUqqEDULqM4RSNRBS\",\n\t\"textarea\": \"E1MpWNg-lFB-dmiOBDnVv\",\n\t\"snapshotList\": \"_2WqAZxlRXbhGBPoaHrJ1Gv\",\n\t\"current\": \"_21blMEsk_K31sbjM73Q_V2\",\n\t\"autoComplete\": \"t0z_eiUKKfEvZR3eNUMXy\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"@media(prefers-color-scheme: dark){button{background-color:#cb6587;color:#fff;border:solid 1px #cb6587}select,input,textarea{background-color:#333;color:#fff;border:solid 1px #cb6587}}._1dPrtIaXm5OZiwGvYZs7np{display:flex;background-color:#c68;padding:5px 10px;margin-bottom:10px;border-radius:10px;align-items:center}.H_3MhqqSOq4ettME3CNgm{flex:0 0 auto;font-size:24pt;font-family:Arial;font-weight:bold;font-style:italic;color:#fff;text-shadow:2px 2px 2px #000}._2Iroycc7jUmkVt04JzK-Fp{flex:1 1 auto;color:#fff;font-family:Calibri;font-size:14pt;margin:10px 0 0 10px}._2Tp0xMBcm0okVYYTLmosAr{color:#fff;flex:0 0 auto;text-align:right;font-size:14pt;font-family:Calibri}._5ZLVBARla7nLK4fvyUoex{color:#fff;text-decoration:none}._5ZLVBARla7nLK4fvyUoex:hover{text-decoration:underline}._6IgdoHPZzkK1OmM311Sga{vertical-align:middle}@media(prefers-color-scheme: dark){._1dPrtIaXm5OZiwGvYZs7np{background-color:#cb6587}.H_3MhqqSOq4ettME3CNgm,._5ZLVBARla7nLK4fvyUoex{color:#bbd1e1}}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"titleBar\": \"_1dPrtIaXm5OZiwGvYZs7np\",\n\t\"title\": \"H_3MhqqSOq4ettME3CNgm\",\n\t\"version\": \"_2Iroycc7jUmkVt04JzK-Fp\",\n\t\"links\": \"_2Tp0xMBcm0okVYYTLmosAr\",\n\t\"link\": \"_5ZLVBARla7nLK4fvyUoex\",\n\t\"externalLink\": \"_6IgdoHPZzkK1OmM311Sga\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"@media(prefers-color-scheme: dark){button{background-color:#359;color:#f3f5fa;border:solid 1px #359}select,input,textarea{background-color:#333;color:#f3f5fa;border:solid 1px #359}}._3X8Lgknb197iLhP0b2l77s{display:flex;background-color:#46a;padding:5px 10px;margin-bottom:10px;border-radius:10px;align-items:center}._3f6jTWSg_aYlWtePaFKzQ7{flex:0 0 auto;font-size:24pt;font-family:Arial;font-weight:bold;font-style:italic;color:#fff;text-shadow:2px 2px 2px #000}._3odnyJ_B7yAqJnzLSqUNLe{flex:1 1 auto;color:#fff;font-family:Calibri;font-size:14pt;margin:10px 0 0 10px}.WakFUvulNr27Ng-iLIEfo{color:#fff;flex:0 0 auto;text-align:right;font-size:14pt;font-family:Calibri}._15bhlczooQP8dD64785KWB{color:#fff;text-decoration:none}._15bhlczooQP8dD64785KWB:hover{text-decoration:underline}.VPWTmw0hPSpQvSWY05pYv{vertical-align:middle}@media(prefers-color-scheme: dark){._3X8Lgknb197iLhP0b2l77s{background-color:#359}._3f6jTWSg_aYlWtePaFKzQ7,._15bhlczooQP8dD64785KWB{color:#bbd1e1}}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"titleBar\": \"_3X8Lgknb197iLhP0b2l77s\",\n\t\"title\": \"_3f6jTWSg_aYlWtePaFKzQ7\",\n\t\"version\": \"_3odnyJ_B7yAqJnzLSqUNLe\",\n\t\"links\": \"WakFUvulNr27Ng-iLIEfo\",\n\t\"link\": \"_15bhlczooQP8dD64785KWB\",\n\t\"externalLink\": \"VPWTmw0hPSpQvSWY05pYv\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"@media(prefers-color-scheme: dark){button{background-color:#0091a1;color:#aaf7ff;border:solid 1px #007b8b}select,input,textarea{background-color:#333;color:#aaf7ff;border:solid 1px #007b8b}}._38B2xrPpolo75ScC_XTUJ0{display:flex;background-color:#09a;padding:5px 10px;margin-bottom:10px;border-radius:10px;align-items:center}._3rKujTCbT6hEqSSJowznfl{flex:0 0 auto;font-size:24pt;font-family:Arial;font-weight:bold;font-style:italic;color:#fff;text-shadow:2px 2px 2px #000}.LmRq7AaEB4aAjkYn1_Fx1{flex:1 1 auto;color:#fff;font-family:Calibri;font-size:14pt;margin:10px 0 0 10px}._2pD0Ll-40t-pFcvxGbmrDa{color:#fff;flex:0 0 auto;text-align:right;font-size:14pt;font-family:Calibri}.NlCA34doW26bRa3ETK3MV{color:#fff;text-decoration:none}.NlCA34doW26bRa3ETK3MV:hover{text-decoration:underline}._1TClD7zQfb72l9_IIRB9Bu{vertical-align:middle}@media(prefers-color-scheme: dark){._38B2xrPpolo75ScC_XTUJ0{background-color:#0091a1}._3rKujTCbT6hEqSSJowznfl,.NlCA34doW26bRa3ETK3MV{color:#bbd1e1}}\", \"\"]);\n// Exports\nexports.locals = {\n\t\"titleBar\": \"_38B2xrPpolo75ScC_XTUJ0\",\n\t\"title\": \"_3rKujTCbT6hEqSSJowznfl\",\n\t\"version\": \"LmRq7AaEB4aAjkYn1_Fx1\",\n\t\"links\": \"_2pD0Ll-40t-pFcvxGbmrDa\",\n\t\"link\": \"NlCA34doW26bRa3ETK3MV\",\n\t\"externalLink\": \"_1TClD7zQfb72l9_IIRB9Bu\"\n};\nmodule.exports = exports;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","/*! @license DOMPurify 2.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.0/LICENSE */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.DOMPurify = factory());\n}(this, function () { 'use strict';\n\n  function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n  var hasOwnProperty = Object.hasOwnProperty,\n      setPrototypeOf = Object.setPrototypeOf,\n      isFrozen = Object.isFrozen,\n      getPrototypeOf = Object.getPrototypeOf,\n      getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n  var freeze = Object.freeze,\n      seal = Object.seal,\n      create = Object.create; // eslint-disable-line import/no-mutable-exports\n\n  var _ref = typeof Reflect !== 'undefined' && Reflect,\n      apply = _ref.apply,\n      construct = _ref.construct;\n\n  if (!apply) {\n    apply = function apply(fun, thisValue, args) {\n      return fun.apply(thisValue, args);\n    };\n  }\n\n  if (!freeze) {\n    freeze = function freeze(x) {\n      return x;\n    };\n  }\n\n  if (!seal) {\n    seal = function seal(x) {\n      return x;\n    };\n  }\n\n  if (!construct) {\n    construct = function construct(Func, args) {\n      return new (Function.prototype.bind.apply(Func, [null].concat(_toConsumableArray(args))))();\n    };\n  }\n\n  var arrayForEach = unapply(Array.prototype.forEach);\n  var arrayPop = unapply(Array.prototype.pop);\n  var arrayPush = unapply(Array.prototype.push);\n\n  var stringToLowerCase = unapply(String.prototype.toLowerCase);\n  var stringMatch = unapply(String.prototype.match);\n  var stringReplace = unapply(String.prototype.replace);\n  var stringIndexOf = unapply(String.prototype.indexOf);\n  var stringTrim = unapply(String.prototype.trim);\n\n  var regExpTest = unapply(RegExp.prototype.test);\n\n  var typeErrorCreate = unconstruct(TypeError);\n\n  function unapply(func) {\n    return function (thisArg) {\n      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return apply(func, thisArg, args);\n    };\n  }\n\n  function unconstruct(func) {\n    return function () {\n      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      return construct(func, args);\n    };\n  }\n\n  /* Add properties to a lookup table */\n  function addToSet(set, array) {\n    if (setPrototypeOf) {\n      // Make 'in' and truthy checks like Boolean(set.constructor)\n      // independent of any properties defined on Object.prototype.\n      // Prevent prototype setters from intercepting set as a this value.\n      setPrototypeOf(set, null);\n    }\n\n    var l = array.length;\n    while (l--) {\n      var element = array[l];\n      if (typeof element === 'string') {\n        var lcElement = stringToLowerCase(element);\n        if (lcElement !== element) {\n          // Config presets (e.g. tags.js, attrs.js) are immutable.\n          if (!isFrozen(array)) {\n            array[l] = lcElement;\n          }\n\n          element = lcElement;\n        }\n      }\n\n      set[element] = true;\n    }\n\n    return set;\n  }\n\n  /* Shallow clone an object */\n  function clone(object) {\n    var newObject = create(null);\n\n    var property = void 0;\n    for (property in object) {\n      if (apply(hasOwnProperty, object, [property])) {\n        newObject[property] = object[property];\n      }\n    }\n\n    return newObject;\n  }\n\n  /* IE10 doesn't support __lookupGetter__ so lets'\n   * simulate it. It also automatically checks\n   * if the prop is function or getter and behaves\n   * accordingly. */\n  function lookupGetter(object, prop) {\n    while (object !== null) {\n      var desc = getOwnPropertyDescriptor(object, prop);\n      if (desc) {\n        if (desc.get) {\n          return unapply(desc.get);\n        }\n\n        if (typeof desc.value === 'function') {\n          return unapply(desc.value);\n        }\n      }\n\n      object = getPrototypeOf(object);\n    }\n\n    function fallbackValue(element) {\n      console.warn('fallback value for', element);\n      return null;\n    }\n\n    return fallbackValue;\n  }\n\n  var html = freeze(['a', 'abbr', 'acronym', 'address', 'area', 'article', 'aside', 'audio', 'b', 'bdi', 'bdo', 'big', 'blink', 'blockquote', 'body', 'br', 'button', 'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'content', 'data', 'datalist', 'dd', 'decorator', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt', 'element', 'em', 'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hgroup', 'hr', 'html', 'i', 'img', 'input', 'ins', 'kbd', 'label', 'legend', 'li', 'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meter', 'nav', 'nobr', 'ol', 'optgroup', 'option', 'output', 'p', 'picture', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 's', 'samp', 'section', 'select', 'shadow', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'tr', 'track', 'tt', 'u', 'ul', 'var', 'video', 'wbr']);\n\n  // SVG\n  var svg = freeze(['svg', 'a', 'altglyph', 'altglyphdef', 'altglyphitem', 'animatecolor', 'animatemotion', 'animatetransform', 'circle', 'clippath', 'defs', 'desc', 'ellipse', 'filter', 'font', 'g', 'glyph', 'glyphref', 'hkern', 'image', 'line', 'lineargradient', 'marker', 'mask', 'metadata', 'mpath', 'path', 'pattern', 'polygon', 'polyline', 'radialgradient', 'rect', 'stop', 'style', 'switch', 'symbol', 'text', 'textpath', 'title', 'tref', 'tspan', 'view', 'vkern']);\n\n  var svgFilters = freeze(['feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence']);\n\n  // List of SVG elements that are disallowed by default.\n  // We still need to know them so that we can do namespace\n  // checks properly in case one wants to add them to\n  // allow-list.\n  var svgDisallowed = freeze(['animate', 'color-profile', 'cursor', 'discard', 'fedropshadow', 'feimage', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignobject', 'hatch', 'hatchpath', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'missing-glyph', 'script', 'set', 'solidcolor', 'unknown', 'use']);\n\n  var mathMl = freeze(['math', 'menclose', 'merror', 'mfenced', 'mfrac', 'mglyph', 'mi', 'mlabeledtr', 'mmultiscripts', 'mn', 'mo', 'mover', 'mpadded', 'mphantom', 'mroot', 'mrow', 'ms', 'mspace', 'msqrt', 'mstyle', 'msub', 'msup', 'msubsup', 'mtable', 'mtd', 'mtext', 'mtr', 'munder', 'munderover']);\n\n  // Similarly to SVG, we want to know all MathML elements,\n  // even those that we disallow by default.\n  var mathMlDisallowed = freeze(['maction', 'maligngroup', 'malignmark', 'mlongdiv', 'mscarries', 'mscarry', 'msgroup', 'mstack', 'msline', 'msrow', 'semantics', 'annotation', 'annotation-xml', 'mprescripts', 'none']);\n\n  var text = freeze(['#text']);\n\n  var html$1 = freeze(['accept', 'action', 'align', 'alt', 'autocapitalize', 'autocomplete', 'autopictureinpicture', 'autoplay', 'background', 'bgcolor', 'border', 'capture', 'cellpadding', 'cellspacing', 'checked', 'cite', 'class', 'clear', 'color', 'cols', 'colspan', 'controls', 'controlslist', 'coords', 'crossorigin', 'datetime', 'decoding', 'default', 'dir', 'disabled', 'disablepictureinpicture', 'disableremoteplayback', 'download', 'draggable', 'enctype', 'enterkeyhint', 'face', 'for', 'headers', 'height', 'hidden', 'high', 'href', 'hreflang', 'id', 'inputmode', 'integrity', 'ismap', 'kind', 'label', 'lang', 'list', 'loading', 'loop', 'low', 'max', 'maxlength', 'media', 'method', 'min', 'minlength', 'multiple', 'muted', 'name', 'noshade', 'novalidate', 'nowrap', 'open', 'optimum', 'pattern', 'placeholder', 'playsinline', 'poster', 'preload', 'pubdate', 'radiogroup', 'readonly', 'rel', 'required', 'rev', 'reversed', 'role', 'rows', 'rowspan', 'spellcheck', 'scope', 'selected', 'shape', 'size', 'sizes', 'span', 'srclang', 'start', 'src', 'srcset', 'step', 'style', 'summary', 'tabindex', 'title', 'translate', 'type', 'usemap', 'valign', 'value', 'width', 'xmlns', 'slot']);\n\n  var svg$1 = freeze(['accent-height', 'accumulate', 'additive', 'alignment-baseline', 'ascent', 'attributename', 'attributetype', 'azimuth', 'basefrequency', 'baseline-shift', 'begin', 'bias', 'by', 'class', 'clip', 'clippathunits', 'clip-path', 'clip-rule', 'color', 'color-interpolation', 'color-interpolation-filters', 'color-profile', 'color-rendering', 'cx', 'cy', 'd', 'dx', 'dy', 'diffuseconstant', 'direction', 'display', 'divisor', 'dur', 'edgemode', 'elevation', 'end', 'fill', 'fill-opacity', 'fill-rule', 'filter', 'filterunits', 'flood-color', 'flood-opacity', 'font-family', 'font-size', 'font-size-adjust', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'fx', 'fy', 'g1', 'g2', 'glyph-name', 'glyphref', 'gradientunits', 'gradienttransform', 'height', 'href', 'id', 'image-rendering', 'in', 'in2', 'k', 'k1', 'k2', 'k3', 'k4', 'kerning', 'keypoints', 'keysplines', 'keytimes', 'lang', 'lengthadjust', 'letter-spacing', 'kernelmatrix', 'kernelunitlength', 'lighting-color', 'local', 'marker-end', 'marker-mid', 'marker-start', 'markerheight', 'markerunits', 'markerwidth', 'maskcontentunits', 'maskunits', 'max', 'mask', 'media', 'method', 'mode', 'min', 'name', 'numoctaves', 'offset', 'operator', 'opacity', 'order', 'orient', 'orientation', 'origin', 'overflow', 'paint-order', 'path', 'pathlength', 'patterncontentunits', 'patterntransform', 'patternunits', 'points', 'preservealpha', 'preserveaspectratio', 'primitiveunits', 'r', 'rx', 'ry', 'radius', 'refx', 'refy', 'repeatcount', 'repeatdur', 'restart', 'result', 'rotate', 'scale', 'seed', 'shape-rendering', 'specularconstant', 'specularexponent', 'spreadmethod', 'startoffset', 'stddeviation', 'stitchtiles', 'stop-color', 'stop-opacity', 'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-linejoin', 'stroke-miterlimit', 'stroke-opacity', 'stroke', 'stroke-width', 'style', 'surfacescale', 'systemlanguage', 'tabindex', 'targetx', 'targety', 'transform', 'text-anchor', 'text-decoration', 'text-rendering', 'textlength', 'type', 'u1', 'u2', 'unicode', 'values', 'viewbox', 'visibility', 'version', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'width', 'word-spacing', 'wrap', 'writing-mode', 'xchannelselector', 'ychannelselector', 'x', 'x1', 'x2', 'xmlns', 'y', 'y1', 'y2', 'z', 'zoomandpan']);\n\n  var mathMl$1 = freeze(['accent', 'accentunder', 'align', 'bevelled', 'close', 'columnsalign', 'columnlines', 'columnspan', 'denomalign', 'depth', 'dir', 'display', 'displaystyle', 'encoding', 'fence', 'frame', 'height', 'href', 'id', 'largeop', 'length', 'linethickness', 'lspace', 'lquote', 'mathbackground', 'mathcolor', 'mathsize', 'mathvariant', 'maxsize', 'minsize', 'movablelimits', 'notation', 'numalign', 'open', 'rowalign', 'rowlines', 'rowspacing', 'rowspan', 'rspace', 'rquote', 'scriptlevel', 'scriptminsize', 'scriptsizemultiplier', 'selection', 'separator', 'separators', 'stretchy', 'subscriptshift', 'supscriptshift', 'symmetric', 'voffset', 'width', 'xmlns']);\n\n  var xml = freeze(['xlink:href', 'xml:id', 'xlink:title', 'xml:space', 'xmlns:xlink']);\n\n  // eslint-disable-next-line unicorn/better-regex\n  var MUSTACHE_EXPR = seal(/\\{\\{[\\s\\S]*|[\\s\\S]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\n  var ERB_EXPR = seal(/<%[\\s\\S]*|[\\s\\S]*%>/gm);\n  var DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]/); // eslint-disable-line no-useless-escape\n  var ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\n  var IS_ALLOWED_URI = seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n  );\n  var IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\n  var ATTR_WHITESPACE = seal(/[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n  );\n\n  var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n  function _toConsumableArray$1(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n  var getGlobal = function getGlobal() {\n    return typeof window === 'undefined' ? null : window;\n  };\n\n  /**\n   * Creates a no-op policy for internal use only.\n   * Don't export this function outside this module!\n   * @param {?TrustedTypePolicyFactory} trustedTypes The policy factory.\n   * @param {Document} document The document object (to determine policy name suffix)\n   * @return {?TrustedTypePolicy} The policy created (or null, if Trusted Types\n   * are not supported).\n   */\n  var _createTrustedTypesPolicy = function _createTrustedTypesPolicy(trustedTypes, document) {\n    if ((typeof trustedTypes === 'undefined' ? 'undefined' : _typeof(trustedTypes)) !== 'object' || typeof trustedTypes.createPolicy !== 'function') {\n      return null;\n    }\n\n    // Allow the callers to control the unique policy name\n    // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n    // Policy creation with duplicate names throws in Trusted Types.\n    var suffix = null;\n    var ATTR_NAME = 'data-tt-policy-suffix';\n    if (document.currentScript && document.currentScript.hasAttribute(ATTR_NAME)) {\n      suffix = document.currentScript.getAttribute(ATTR_NAME);\n    }\n\n    var policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n\n    try {\n      return trustedTypes.createPolicy(policyName, {\n        createHTML: function createHTML(html$$1) {\n          return html$$1;\n        }\n      });\n    } catch (_) {\n      // Policy creation failed (most likely another DOMPurify script has\n      // already run). Skip creating the policy, as this will only cause errors\n      // if TT are enforced.\n      console.warn('TrustedTypes policy ' + policyName + ' could not be created.');\n      return null;\n    }\n  };\n\n  function createDOMPurify() {\n    var window = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getGlobal();\n\n    var DOMPurify = function DOMPurify(root) {\n      return createDOMPurify(root);\n    };\n\n    /**\n     * Version label, exposed for easier checks\n     * if DOMPurify is up to date or not\n     */\n    DOMPurify.version = '2.3.0';\n\n    /**\n     * Array of elements that DOMPurify removed during sanitation.\n     * Empty if nothing was removed.\n     */\n    DOMPurify.removed = [];\n\n    if (!window || !window.document || window.document.nodeType !== 9) {\n      // Not running in a browser, provide a factory function\n      // so that you can pass your own Window\n      DOMPurify.isSupported = false;\n\n      return DOMPurify;\n    }\n\n    var originalDocument = window.document;\n\n    var document = window.document;\n    var DocumentFragment = window.DocumentFragment,\n        HTMLTemplateElement = window.HTMLTemplateElement,\n        Node = window.Node,\n        Element = window.Element,\n        NodeFilter = window.NodeFilter,\n        _window$NamedNodeMap = window.NamedNodeMap,\n        NamedNodeMap = _window$NamedNodeMap === undefined ? window.NamedNodeMap || window.MozNamedAttrMap : _window$NamedNodeMap,\n        Text = window.Text,\n        Comment = window.Comment,\n        DOMParser = window.DOMParser,\n        trustedTypes = window.trustedTypes;\n\n\n    var ElementPrototype = Element.prototype;\n\n    var cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n    var getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n    var getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n    var getParentNode = lookupGetter(ElementPrototype, 'parentNode');\n\n    // As per issue #47, the web-components registry is inherited by a\n    // new document created via createHTMLDocument. As per the spec\n    // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n    // a new empty registry is used when creating a template contents owner\n    // document, so we use that as our parent document to ensure nothing\n    // is inherited.\n    if (typeof HTMLTemplateElement === 'function') {\n      var template = document.createElement('template');\n      if (template.content && template.content.ownerDocument) {\n        document = template.content.ownerDocument;\n      }\n    }\n\n    var trustedTypesPolicy = _createTrustedTypesPolicy(trustedTypes, originalDocument);\n    var emptyHTML = trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML('') : '';\n\n    var _document = document,\n        implementation = _document.implementation,\n        createNodeIterator = _document.createNodeIterator,\n        createDocumentFragment = _document.createDocumentFragment,\n        getElementsByTagName = _document.getElementsByTagName;\n    var importNode = originalDocument.importNode;\n\n\n    var documentMode = {};\n    try {\n      documentMode = clone(document).documentMode ? document.documentMode : {};\n    } catch (_) {}\n\n    var hooks = {};\n\n    /**\n     * Expose whether this browser supports running the full DOMPurify.\n     */\n    DOMPurify.isSupported = typeof getParentNode === 'function' && implementation && typeof implementation.createHTMLDocument !== 'undefined' && documentMode !== 9;\n\n    var MUSTACHE_EXPR$$1 = MUSTACHE_EXPR,\n        ERB_EXPR$$1 = ERB_EXPR,\n        DATA_ATTR$$1 = DATA_ATTR,\n        ARIA_ATTR$$1 = ARIA_ATTR,\n        IS_SCRIPT_OR_DATA$$1 = IS_SCRIPT_OR_DATA,\n        ATTR_WHITESPACE$$1 = ATTR_WHITESPACE;\n    var IS_ALLOWED_URI$$1 = IS_ALLOWED_URI;\n\n    /**\n     * We consider the elements and attributes below to be safe. Ideally\n     * don't add any new ones but feel free to remove unwanted ones.\n     */\n\n    /* allowed element names */\n\n    var ALLOWED_TAGS = null;\n    var DEFAULT_ALLOWED_TAGS = addToSet({}, [].concat(_toConsumableArray$1(html), _toConsumableArray$1(svg), _toConsumableArray$1(svgFilters), _toConsumableArray$1(mathMl), _toConsumableArray$1(text)));\n\n    /* Allowed attribute names */\n    var ALLOWED_ATTR = null;\n    var DEFAULT_ALLOWED_ATTR = addToSet({}, [].concat(_toConsumableArray$1(html$1), _toConsumableArray$1(svg$1), _toConsumableArray$1(mathMl$1), _toConsumableArray$1(xml)));\n\n    /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n    var FORBID_TAGS = null;\n\n    /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n    var FORBID_ATTR = null;\n\n    /* Decide if ARIA attributes are okay */\n    var ALLOW_ARIA_ATTR = true;\n\n    /* Decide if custom data attributes are okay */\n    var ALLOW_DATA_ATTR = true;\n\n    /* Decide if unknown protocols are okay */\n    var ALLOW_UNKNOWN_PROTOCOLS = false;\n\n    /* Output should be safe for common template engines.\n     * This means, DOMPurify removes data attributes, mustaches and ERB\n     */\n    var SAFE_FOR_TEMPLATES = false;\n\n    /* Decide if document with <html>... should be returned */\n    var WHOLE_DOCUMENT = false;\n\n    /* Track whether config is already set on this instance of DOMPurify. */\n    var SET_CONFIG = false;\n\n    /* Decide if all elements (e.g. style, script) must be children of\n     * document.body. By default, browsers might move them to document.head */\n    var FORCE_BODY = false;\n\n    /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n     * string (or a TrustedHTML object if Trusted Types are supported).\n     * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n     */\n    var RETURN_DOM = false;\n\n    /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n     * string  (or a TrustedHTML object if Trusted Types are supported) */\n    var RETURN_DOM_FRAGMENT = false;\n\n    /* If `RETURN_DOM` or `RETURN_DOM_FRAGMENT` is enabled, decide if the returned DOM\n     * `Node` is imported into the current `Document`. If this flag is not enabled the\n     * `Node` will belong (its ownerDocument) to a fresh `HTMLDocument`, created by\n     * DOMPurify.\n     *\n     * This defaults to `true` starting DOMPurify 2.2.0. Note that setting it to `false`\n     * might cause XSS from attacks hidden in closed shadowroots in case the browser\n     * supports Declarative Shadow: DOM https://web.dev/declarative-shadow-dom/\n     */\n    var RETURN_DOM_IMPORT = true;\n\n    /* Try to return a Trusted Type object instead of a string, return a string in\n     * case Trusted Types are not supported  */\n    var RETURN_TRUSTED_TYPE = false;\n\n    /* Output should be free from DOM clobbering attacks? */\n    var SANITIZE_DOM = true;\n\n    /* Keep element content when removing element? */\n    var KEEP_CONTENT = true;\n\n    /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n     * of importing it into a new Document and returning a sanitized copy */\n    var IN_PLACE = false;\n\n    /* Allow usage of profiles like html, svg and mathMl */\n    var USE_PROFILES = {};\n\n    /* Tags to ignore content of when KEEP_CONTENT is true */\n    var FORBID_CONTENTS = addToSet({}, ['annotation-xml', 'audio', 'colgroup', 'desc', 'foreignobject', 'head', 'iframe', 'math', 'mi', 'mn', 'mo', 'ms', 'mtext', 'noembed', 'noframes', 'noscript', 'plaintext', 'script', 'style', 'svg', 'template', 'thead', 'title', 'video', 'xmp']);\n\n    /* Tags that are safe for data: URIs */\n    var DATA_URI_TAGS = null;\n    var DEFAULT_DATA_URI_TAGS = addToSet({}, ['audio', 'video', 'img', 'source', 'image', 'track']);\n\n    /* Attributes safe for values like \"javascript:\" */\n    var URI_SAFE_ATTRIBUTES = null;\n    var DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, ['alt', 'class', 'for', 'id', 'label', 'name', 'pattern', 'placeholder', 'summary', 'title', 'value', 'style', 'xmlns']);\n\n    var MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n    var SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n    var HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n    /* Document namespace */\n    var NAMESPACE = HTML_NAMESPACE;\n    var IS_EMPTY_INPUT = false;\n\n    /* Keep a reference to config to pass to hooks */\n    var CONFIG = null;\n\n    /* Ideally, do not touch anything below this line */\n    /* ______________________________________________ */\n\n    var formElement = document.createElement('form');\n\n    /**\n     * _parseConfig\n     *\n     * @param  {Object} cfg optional config literal\n     */\n    // eslint-disable-next-line complexity\n    var _parseConfig = function _parseConfig(cfg) {\n      if (CONFIG && CONFIG === cfg) {\n        return;\n      }\n\n      /* Shield configuration object from tampering */\n      if (!cfg || (typeof cfg === 'undefined' ? 'undefined' : _typeof(cfg)) !== 'object') {\n        cfg = {};\n      }\n\n      /* Shield configuration object from prototype pollution */\n      cfg = clone(cfg);\n\n      /* Set configuration parameters */\n      ALLOWED_TAGS = 'ALLOWED_TAGS' in cfg ? addToSet({}, cfg.ALLOWED_TAGS) : DEFAULT_ALLOWED_TAGS;\n      ALLOWED_ATTR = 'ALLOWED_ATTR' in cfg ? addToSet({}, cfg.ALLOWED_ATTR) : DEFAULT_ALLOWED_ATTR;\n      URI_SAFE_ATTRIBUTES = 'ADD_URI_SAFE_ATTR' in cfg ? addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES), cfg.ADD_URI_SAFE_ATTR) : DEFAULT_URI_SAFE_ATTRIBUTES;\n      DATA_URI_TAGS = 'ADD_DATA_URI_TAGS' in cfg ? addToSet(clone(DEFAULT_DATA_URI_TAGS), cfg.ADD_DATA_URI_TAGS) : DEFAULT_DATA_URI_TAGS;\n      FORBID_TAGS = 'FORBID_TAGS' in cfg ? addToSet({}, cfg.FORBID_TAGS) : {};\n      FORBID_ATTR = 'FORBID_ATTR' in cfg ? addToSet({}, cfg.FORBID_ATTR) : {};\n      USE_PROFILES = 'USE_PROFILES' in cfg ? cfg.USE_PROFILES : false;\n      ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n      ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n      ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n      SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n      WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n      RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n      RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n      RETURN_DOM_IMPORT = cfg.RETURN_DOM_IMPORT !== false; // Default true\n      RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n      FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n      SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n      KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n      IN_PLACE = cfg.IN_PLACE || false; // Default false\n      IS_ALLOWED_URI$$1 = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI$$1;\n      NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n      if (SAFE_FOR_TEMPLATES) {\n        ALLOW_DATA_ATTR = false;\n      }\n\n      if (RETURN_DOM_FRAGMENT) {\n        RETURN_DOM = true;\n      }\n\n      /* Parse profile info */\n      if (USE_PROFILES) {\n        ALLOWED_TAGS = addToSet({}, [].concat(_toConsumableArray$1(text)));\n        ALLOWED_ATTR = [];\n        if (USE_PROFILES.html === true) {\n          addToSet(ALLOWED_TAGS, html);\n          addToSet(ALLOWED_ATTR, html$1);\n        }\n\n        if (USE_PROFILES.svg === true) {\n          addToSet(ALLOWED_TAGS, svg);\n          addToSet(ALLOWED_ATTR, svg$1);\n          addToSet(ALLOWED_ATTR, xml);\n        }\n\n        if (USE_PROFILES.svgFilters === true) {\n          addToSet(ALLOWED_TAGS, svgFilters);\n          addToSet(ALLOWED_ATTR, svg$1);\n          addToSet(ALLOWED_ATTR, xml);\n        }\n\n        if (USE_PROFILES.mathMl === true) {\n          addToSet(ALLOWED_TAGS, mathMl);\n          addToSet(ALLOWED_ATTR, mathMl$1);\n          addToSet(ALLOWED_ATTR, xml);\n        }\n      }\n\n      /* Merge configuration parameters */\n      if (cfg.ADD_TAGS) {\n        if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n          ALLOWED_TAGS = clone(ALLOWED_TAGS);\n        }\n\n        addToSet(ALLOWED_TAGS, cfg.ADD_TAGS);\n      }\n\n      if (cfg.ADD_ATTR) {\n        if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n          ALLOWED_ATTR = clone(ALLOWED_ATTR);\n        }\n\n        addToSet(ALLOWED_ATTR, cfg.ADD_ATTR);\n      }\n\n      if (cfg.ADD_URI_SAFE_ATTR) {\n        addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR);\n      }\n\n      /* Add #text in case KEEP_CONTENT is set to true */\n      if (KEEP_CONTENT) {\n        ALLOWED_TAGS['#text'] = true;\n      }\n\n      /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n      if (WHOLE_DOCUMENT) {\n        addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n      }\n\n      /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n      if (ALLOWED_TAGS.table) {\n        addToSet(ALLOWED_TAGS, ['tbody']);\n        delete FORBID_TAGS.tbody;\n      }\n\n      // Prevent further manipulation of configuration.\n      // Not available in IE8, Safari 5, etc.\n      if (freeze) {\n        freeze(cfg);\n      }\n\n      CONFIG = cfg;\n    };\n\n    var MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, ['mi', 'mo', 'mn', 'ms', 'mtext']);\n\n    var HTML_INTEGRATION_POINTS = addToSet({}, ['foreignobject', 'desc', 'title', 'annotation-xml']);\n\n    /* Keep track of all possible SVG and MathML tags\n     * so that we can perform the namespace checks\n     * correctly. */\n    var ALL_SVG_TAGS = addToSet({}, svg);\n    addToSet(ALL_SVG_TAGS, svgFilters);\n    addToSet(ALL_SVG_TAGS, svgDisallowed);\n\n    var ALL_MATHML_TAGS = addToSet({}, mathMl);\n    addToSet(ALL_MATHML_TAGS, mathMlDisallowed);\n\n    /**\n     *\n     *\n     * @param  {Element} element a DOM element whose namespace is being checked\n     * @returns {boolean} Return false if the element has a\n     *  namespace that a spec-compliant parser would never\n     *  return. Return true otherwise.\n     */\n    var _checkValidNamespace = function _checkValidNamespace(element) {\n      var parent = getParentNode(element);\n\n      // In JSDOM, if we're inside shadow DOM, then parentNode\n      // can be null. We just simulate parent in this case.\n      if (!parent || !parent.tagName) {\n        parent = {\n          namespaceURI: HTML_NAMESPACE,\n          tagName: 'template'\n        };\n      }\n\n      var tagName = stringToLowerCase(element.tagName);\n      var parentTagName = stringToLowerCase(parent.tagName);\n\n      if (element.namespaceURI === SVG_NAMESPACE) {\n        // The only way to switch from HTML namespace to SVG\n        // is via <svg>. If it happens via any other tag, then\n        // it should be killed.\n        if (parent.namespaceURI === HTML_NAMESPACE) {\n          return tagName === 'svg';\n        }\n\n        // The only way to switch from MathML to SVG is via\n        // svg if parent is either <annotation-xml> or MathML\n        // text integration points.\n        if (parent.namespaceURI === MATHML_NAMESPACE) {\n          return tagName === 'svg' && (parentTagName === 'annotation-xml' || MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);\n        }\n\n        // We only allow elements that are defined in SVG\n        // spec. All others are disallowed in SVG namespace.\n        return Boolean(ALL_SVG_TAGS[tagName]);\n      }\n\n      if (element.namespaceURI === MATHML_NAMESPACE) {\n        // The only way to switch from HTML namespace to MathML\n        // is via <math>. If it happens via any other tag, then\n        // it should be killed.\n        if (parent.namespaceURI === HTML_NAMESPACE) {\n          return tagName === 'math';\n        }\n\n        // The only way to switch from SVG to MathML is via\n        // <math> and HTML integration points\n        if (parent.namespaceURI === SVG_NAMESPACE) {\n          return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n        }\n\n        // We only allow elements that are defined in MathML\n        // spec. All others are disallowed in MathML namespace.\n        return Boolean(ALL_MATHML_TAGS[tagName]);\n      }\n\n      if (element.namespaceURI === HTML_NAMESPACE) {\n        // The only way to switch from SVG to HTML is via\n        // HTML integration points, and from MathML to HTML\n        // is via MathML text integration points\n        if (parent.namespaceURI === SVG_NAMESPACE && !HTML_INTEGRATION_POINTS[parentTagName]) {\n          return false;\n        }\n\n        if (parent.namespaceURI === MATHML_NAMESPACE && !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]) {\n          return false;\n        }\n\n        // Certain elements are allowed in both SVG and HTML\n        // namespace. We need to specify them explicitly\n        // so that they don't get erronously deleted from\n        // HTML namespace.\n        var commonSvgAndHTMLElements = addToSet({}, ['title', 'style', 'font', 'a', 'script']);\n\n        // We disallow tags that are specific for MathML\n        // or SVG and should never appear in HTML namespace\n        return !ALL_MATHML_TAGS[tagName] && (commonSvgAndHTMLElements[tagName] || !ALL_SVG_TAGS[tagName]);\n      }\n\n      // The code should never reach this place (this means\n      // that the element somehow got namespace that is not\n      // HTML, SVG or MathML). Return false just in case.\n      return false;\n    };\n\n    /**\n     * _forceRemove\n     *\n     * @param  {Node} node a DOM node\n     */\n    var _forceRemove = function _forceRemove(node) {\n      arrayPush(DOMPurify.removed, { element: node });\n      try {\n        // eslint-disable-next-line unicorn/prefer-dom-node-remove\n        node.parentNode.removeChild(node);\n      } catch (_) {\n        try {\n          node.outerHTML = emptyHTML;\n        } catch (_) {\n          node.remove();\n        }\n      }\n    };\n\n    /**\n     * _removeAttribute\n     *\n     * @param  {String} name an Attribute name\n     * @param  {Node} node a DOM node\n     */\n    var _removeAttribute = function _removeAttribute(name, node) {\n      try {\n        arrayPush(DOMPurify.removed, {\n          attribute: node.getAttributeNode(name),\n          from: node\n        });\n      } catch (_) {\n        arrayPush(DOMPurify.removed, {\n          attribute: null,\n          from: node\n        });\n      }\n\n      node.removeAttribute(name);\n\n      // We void attribute values for unremovable \"is\"\" attributes\n      if (name === 'is' && !ALLOWED_ATTR[name]) {\n        if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n          try {\n            _forceRemove(node);\n          } catch (_) {}\n        } else {\n          try {\n            node.setAttribute(name, '');\n          } catch (_) {}\n        }\n      }\n    };\n\n    /**\n     * _initDocument\n     *\n     * @param  {String} dirty a string of dirty markup\n     * @return {Document} a DOM, filled with the dirty markup\n     */\n    var _initDocument = function _initDocument(dirty) {\n      /* Create a HTML document */\n      var doc = void 0;\n      var leadingWhitespace = void 0;\n\n      if (FORCE_BODY) {\n        dirty = '<remove></remove>' + dirty;\n      } else {\n        /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n        var matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n        leadingWhitespace = matches && matches[0];\n      }\n\n      var dirtyPayload = trustedTypesPolicy ? trustedTypesPolicy.createHTML(dirty) : dirty;\n      /*\n       * Use the DOMParser API by default, fallback later if needs be\n       * DOMParser not work for svg when has multiple root element.\n       */\n      if (NAMESPACE === HTML_NAMESPACE) {\n        try {\n          doc = new DOMParser().parseFromString(dirtyPayload, 'text/html');\n        } catch (_) {}\n      }\n\n      /* Use createHTMLDocument in case DOMParser is not available */\n      if (!doc || !doc.documentElement) {\n        doc = implementation.createDocument(NAMESPACE, 'template', null);\n        try {\n          doc.documentElement.innerHTML = IS_EMPTY_INPUT ? '' : dirtyPayload;\n        } catch (_) {\n          // Syntax error if dirtyPayload is invalid xml\n        }\n      }\n\n      var body = doc.body || doc.documentElement;\n\n      if (dirty && leadingWhitespace) {\n        body.insertBefore(document.createTextNode(leadingWhitespace), body.childNodes[0] || null);\n      }\n\n      /* Work on whole document or just its body */\n      if (NAMESPACE === HTML_NAMESPACE) {\n        return getElementsByTagName.call(doc, WHOLE_DOCUMENT ? 'html' : 'body')[0];\n      }\n\n      return WHOLE_DOCUMENT ? doc.documentElement : body;\n    };\n\n    /**\n     * _createIterator\n     *\n     * @param  {Document} root document/fragment to create iterator for\n     * @return {Iterator} iterator instance\n     */\n    var _createIterator = function _createIterator(root) {\n      return createNodeIterator.call(root.ownerDocument || root, root, NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT, null, false);\n    };\n\n    /**\n     * _isClobbered\n     *\n     * @param  {Node} elm element to check for clobbering attacks\n     * @return {Boolean} true if clobbered, false if safe\n     */\n    var _isClobbered = function _isClobbered(elm) {\n      if (elm instanceof Text || elm instanceof Comment) {\n        return false;\n      }\n\n      if (typeof elm.nodeName !== 'string' || typeof elm.textContent !== 'string' || typeof elm.removeChild !== 'function' || !(elm.attributes instanceof NamedNodeMap) || typeof elm.removeAttribute !== 'function' || typeof elm.setAttribute !== 'function' || typeof elm.namespaceURI !== 'string' || typeof elm.insertBefore !== 'function') {\n        return true;\n      }\n\n      return false;\n    };\n\n    /**\n     * _isNode\n     *\n     * @param  {Node} obj object to check whether it's a DOM node\n     * @return {Boolean} true is object is a DOM node\n     */\n    var _isNode = function _isNode(object) {\n      return (typeof Node === 'undefined' ? 'undefined' : _typeof(Node)) === 'object' ? object instanceof Node : object && (typeof object === 'undefined' ? 'undefined' : _typeof(object)) === 'object' && typeof object.nodeType === 'number' && typeof object.nodeName === 'string';\n    };\n\n    /**\n     * _executeHook\n     * Execute user configurable hooks\n     *\n     * @param  {String} entryPoint  Name of the hook's entry point\n     * @param  {Node} currentNode node to work on with the hook\n     * @param  {Object} data additional hook parameters\n     */\n    var _executeHook = function _executeHook(entryPoint, currentNode, data) {\n      if (!hooks[entryPoint]) {\n        return;\n      }\n\n      arrayForEach(hooks[entryPoint], function (hook) {\n        hook.call(DOMPurify, currentNode, data, CONFIG);\n      });\n    };\n\n    /**\n     * _sanitizeElements\n     *\n     * @protect nodeName\n     * @protect textContent\n     * @protect removeChild\n     *\n     * @param   {Node} currentNode to check for permission to exist\n     * @return  {Boolean} true if node was killed, false if left alive\n     */\n    var _sanitizeElements = function _sanitizeElements(currentNode) {\n      var content = void 0;\n\n      /* Execute a hook if present */\n      _executeHook('beforeSanitizeElements', currentNode, null);\n\n      /* Check if element is clobbered or can clobber */\n      if (_isClobbered(currentNode)) {\n        _forceRemove(currentNode);\n        return true;\n      }\n\n      /* Check if tagname contains Unicode */\n      if (stringMatch(currentNode.nodeName, /[\\u0080-\\uFFFF]/)) {\n        _forceRemove(currentNode);\n        return true;\n      }\n\n      /* Now let's check the element's type and name */\n      var tagName = stringToLowerCase(currentNode.nodeName);\n\n      /* Execute a hook if present */\n      _executeHook('uponSanitizeElement', currentNode, {\n        tagName: tagName,\n        allowedTags: ALLOWED_TAGS\n      });\n\n      /* Detect mXSS attempts abusing namespace confusion */\n      if (!_isNode(currentNode.firstElementChild) && (!_isNode(currentNode.content) || !_isNode(currentNode.content.firstElementChild)) && regExpTest(/<[/\\w]/g, currentNode.innerHTML) && regExpTest(/<[/\\w]/g, currentNode.textContent)) {\n        _forceRemove(currentNode);\n        return true;\n      }\n\n      /* Remove element if anything forbids its presence */\n      if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n        /* Keep content except for bad-listed elements */\n        if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n          var parentNode = getParentNode(currentNode) || currentNode.parentNode;\n          var childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n\n          if (childNodes && parentNode) {\n            var childCount = childNodes.length;\n\n            for (var i = childCount - 1; i >= 0; --i) {\n              parentNode.insertBefore(cloneNode(childNodes[i], true), getNextSibling(currentNode));\n            }\n          }\n        }\n\n        _forceRemove(currentNode);\n        return true;\n      }\n\n      /* Check whether element has a valid namespace */\n      if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n        _forceRemove(currentNode);\n        return true;\n      }\n\n      if ((tagName === 'noscript' || tagName === 'noembed') && regExpTest(/<\\/no(script|embed)/i, currentNode.innerHTML)) {\n        _forceRemove(currentNode);\n        return true;\n      }\n\n      /* Sanitize element content to be template-safe */\n      if (SAFE_FOR_TEMPLATES && currentNode.nodeType === 3) {\n        /* Get the element's text content */\n        content = currentNode.textContent;\n        content = stringReplace(content, MUSTACHE_EXPR$$1, ' ');\n        content = stringReplace(content, ERB_EXPR$$1, ' ');\n        if (currentNode.textContent !== content) {\n          arrayPush(DOMPurify.removed, { element: currentNode.cloneNode() });\n          currentNode.textContent = content;\n        }\n      }\n\n      /* Execute a hook if present */\n      _executeHook('afterSanitizeElements', currentNode, null);\n\n      return false;\n    };\n\n    /**\n     * _isValidAttribute\n     *\n     * @param  {string} lcTag Lowercase tag name of containing element.\n     * @param  {string} lcName Lowercase attribute name.\n     * @param  {string} value Attribute value.\n     * @return {Boolean} Returns true if `value` is valid, otherwise false.\n     */\n    // eslint-disable-next-line complexity\n    var _isValidAttribute = function _isValidAttribute(lcTag, lcName, value) {\n      /* Make sure attribute cannot clobber */\n      if (SANITIZE_DOM && (lcName === 'id' || lcName === 'name') && (value in document || value in formElement)) {\n        return false;\n      }\n\n      /* Allow valid data-* attributes: At least one character after \"-\"\n          (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n          XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n          We don't need to check the value; it's always URI safe. */\n      if (ALLOW_DATA_ATTR && !FORBID_ATTR[lcName] && regExpTest(DATA_ATTR$$1, lcName)) ; else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR$$1, lcName)) ; else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n        return false;\n\n        /* Check value is safe. First, is attr inert? If so, is safe */\n      } else if (URI_SAFE_ATTRIBUTES[lcName]) ; else if (regExpTest(IS_ALLOWED_URI$$1, stringReplace(value, ATTR_WHITESPACE$$1, ''))) ; else if ((lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') && lcTag !== 'script' && stringIndexOf(value, 'data:') === 0 && DATA_URI_TAGS[lcTag]) ; else if (ALLOW_UNKNOWN_PROTOCOLS && !regExpTest(IS_SCRIPT_OR_DATA$$1, stringReplace(value, ATTR_WHITESPACE$$1, ''))) ; else if (!value) ; else {\n        return false;\n      }\n\n      return true;\n    };\n\n    /**\n     * _sanitizeAttributes\n     *\n     * @protect attributes\n     * @protect nodeName\n     * @protect removeAttribute\n     * @protect setAttribute\n     *\n     * @param  {Node} currentNode to sanitize\n     */\n    var _sanitizeAttributes = function _sanitizeAttributes(currentNode) {\n      var attr = void 0;\n      var value = void 0;\n      var lcName = void 0;\n      var l = void 0;\n      /* Execute a hook if present */\n      _executeHook('beforeSanitizeAttributes', currentNode, null);\n\n      var attributes = currentNode.attributes;\n\n      /* Check if we have attributes; if not we might have a text node */\n\n      if (!attributes) {\n        return;\n      }\n\n      var hookEvent = {\n        attrName: '',\n        attrValue: '',\n        keepAttr: true,\n        allowedAttributes: ALLOWED_ATTR\n      };\n      l = attributes.length;\n\n      /* Go backwards over all attributes; safely remove bad ones */\n      while (l--) {\n        attr = attributes[l];\n        var _attr = attr,\n            name = _attr.name,\n            namespaceURI = _attr.namespaceURI;\n\n        value = stringTrim(attr.value);\n        lcName = stringToLowerCase(name);\n\n        /* Execute a hook if present */\n        hookEvent.attrName = lcName;\n        hookEvent.attrValue = value;\n        hookEvent.keepAttr = true;\n        hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n        _executeHook('uponSanitizeAttribute', currentNode, hookEvent);\n        value = hookEvent.attrValue;\n        /* Did the hooks approve of the attribute? */\n        if (hookEvent.forceKeepAttr) {\n          continue;\n        }\n\n        /* Remove attribute */\n        _removeAttribute(name, currentNode);\n\n        /* Did the hooks approve of the attribute? */\n        if (!hookEvent.keepAttr) {\n          continue;\n        }\n\n        /* Work around a security issue in jQuery 3.0 */\n        if (regExpTest(/\\/>/i, value)) {\n          _removeAttribute(name, currentNode);\n          continue;\n        }\n\n        /* Sanitize attribute content to be template-safe */\n        if (SAFE_FOR_TEMPLATES) {\n          value = stringReplace(value, MUSTACHE_EXPR$$1, ' ');\n          value = stringReplace(value, ERB_EXPR$$1, ' ');\n        }\n\n        /* Is `value` valid for this attribute? */\n        var lcTag = currentNode.nodeName.toLowerCase();\n        if (!_isValidAttribute(lcTag, lcName, value)) {\n          continue;\n        }\n\n        /* Handle invalid data-* attribute set by try-catching it */\n        try {\n          if (namespaceURI) {\n            currentNode.setAttributeNS(namespaceURI, name, value);\n          } else {\n            /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n            currentNode.setAttribute(name, value);\n          }\n\n          arrayPop(DOMPurify.removed);\n        } catch (_) {}\n      }\n\n      /* Execute a hook if present */\n      _executeHook('afterSanitizeAttributes', currentNode, null);\n    };\n\n    /**\n     * _sanitizeShadowDOM\n     *\n     * @param  {DocumentFragment} fragment to iterate over recursively\n     */\n    var _sanitizeShadowDOM = function _sanitizeShadowDOM(fragment) {\n      var shadowNode = void 0;\n      var shadowIterator = _createIterator(fragment);\n\n      /* Execute a hook if present */\n      _executeHook('beforeSanitizeShadowDOM', fragment, null);\n\n      while (shadowNode = shadowIterator.nextNode()) {\n        /* Execute a hook if present */\n        _executeHook('uponSanitizeShadowNode', shadowNode, null);\n\n        /* Sanitize tags and elements */\n        if (_sanitizeElements(shadowNode)) {\n          continue;\n        }\n\n        /* Deep shadow DOM detected */\n        if (shadowNode.content instanceof DocumentFragment) {\n          _sanitizeShadowDOM(shadowNode.content);\n        }\n\n        /* Check attributes, sanitize if necessary */\n        _sanitizeAttributes(shadowNode);\n      }\n\n      /* Execute a hook if present */\n      _executeHook('afterSanitizeShadowDOM', fragment, null);\n    };\n\n    /**\n     * Sanitize\n     * Public method providing core sanitation functionality\n     *\n     * @param {String|Node} dirty string or DOM node\n     * @param {Object} configuration object\n     */\n    // eslint-disable-next-line complexity\n    DOMPurify.sanitize = function (dirty, cfg) {\n      var body = void 0;\n      var importedNode = void 0;\n      var currentNode = void 0;\n      var oldNode = void 0;\n      var returnNode = void 0;\n      /* Make sure we have a string to sanitize.\n        DO NOT return early, as this will return the wrong type if\n        the user has requested a DOM object rather than a string */\n      IS_EMPTY_INPUT = !dirty;\n      if (IS_EMPTY_INPUT) {\n        dirty = '<!-->';\n      }\n\n      /* Stringify, in case dirty is an object */\n      if (typeof dirty !== 'string' && !_isNode(dirty)) {\n        // eslint-disable-next-line no-negated-condition\n        if (typeof dirty.toString !== 'function') {\n          throw typeErrorCreate('toString is not a function');\n        } else {\n          dirty = dirty.toString();\n          if (typeof dirty !== 'string') {\n            throw typeErrorCreate('dirty is not a string, aborting');\n          }\n        }\n      }\n\n      /* Check we can run. Otherwise fall back or ignore */\n      if (!DOMPurify.isSupported) {\n        if (_typeof(window.toStaticHTML) === 'object' || typeof window.toStaticHTML === 'function') {\n          if (typeof dirty === 'string') {\n            return window.toStaticHTML(dirty);\n          }\n\n          if (_isNode(dirty)) {\n            return window.toStaticHTML(dirty.outerHTML);\n          }\n        }\n\n        return dirty;\n      }\n\n      /* Assign config vars */\n      if (!SET_CONFIG) {\n        _parseConfig(cfg);\n      }\n\n      /* Clean up removed elements */\n      DOMPurify.removed = [];\n\n      /* Check if dirty is correctly typed for IN_PLACE */\n      if (typeof dirty === 'string') {\n        IN_PLACE = false;\n      }\n\n      if (IN_PLACE) ; else if (dirty instanceof Node) {\n        /* If dirty is a DOM element, append to an empty document to avoid\n           elements being stripped by the parser */\n        body = _initDocument('<!---->');\n        importedNode = body.ownerDocument.importNode(dirty, true);\n        if (importedNode.nodeType === 1 && importedNode.nodeName === 'BODY') {\n          /* Node is already a body, use as is */\n          body = importedNode;\n        } else if (importedNode.nodeName === 'HTML') {\n          body = importedNode;\n        } else {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          body.appendChild(importedNode);\n        }\n      } else {\n        /* Exit directly if we have nothing to do */\n        if (!RETURN_DOM && !SAFE_FOR_TEMPLATES && !WHOLE_DOCUMENT &&\n        // eslint-disable-next-line unicorn/prefer-includes\n        dirty.indexOf('<') === -1) {\n          return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(dirty) : dirty;\n        }\n\n        /* Initialize the document to work on */\n        body = _initDocument(dirty);\n\n        /* Check we have a DOM node from the data */\n        if (!body) {\n          return RETURN_DOM ? null : emptyHTML;\n        }\n      }\n\n      /* Remove first element node (ours) if FORCE_BODY is set */\n      if (body && FORCE_BODY) {\n        _forceRemove(body.firstChild);\n      }\n\n      /* Get node iterator */\n      var nodeIterator = _createIterator(IN_PLACE ? dirty : body);\n\n      /* Now start iterating over the created document */\n      while (currentNode = nodeIterator.nextNode()) {\n        /* Fix IE's strange behavior with manipulated textNodes #89 */\n        if (currentNode.nodeType === 3 && currentNode === oldNode) {\n          continue;\n        }\n\n        /* Sanitize tags and elements */\n        if (_sanitizeElements(currentNode)) {\n          continue;\n        }\n\n        /* Shadow DOM detected, sanitize it */\n        if (currentNode.content instanceof DocumentFragment) {\n          _sanitizeShadowDOM(currentNode.content);\n        }\n\n        /* Check attributes, sanitize if necessary */\n        _sanitizeAttributes(currentNode);\n\n        oldNode = currentNode;\n      }\n\n      oldNode = null;\n\n      /* If we sanitized `dirty` in-place, return it. */\n      if (IN_PLACE) {\n        return dirty;\n      }\n\n      /* Return sanitized string or DOM */\n      if (RETURN_DOM) {\n        if (RETURN_DOM_FRAGMENT) {\n          returnNode = createDocumentFragment.call(body.ownerDocument);\n\n          while (body.firstChild) {\n            // eslint-disable-next-line unicorn/prefer-dom-node-append\n            returnNode.appendChild(body.firstChild);\n          }\n        } else {\n          returnNode = body;\n        }\n\n        if (RETURN_DOM_IMPORT) {\n          /*\n            AdoptNode() is not used because internal state is not reset\n            (e.g. the past names map of a HTMLFormElement), this is safe\n            in theory but we would rather not risk another attack vector.\n            The state that is cloned by importNode() is explicitly defined\n            by the specs.\n          */\n          returnNode = importNode.call(originalDocument, returnNode, true);\n        }\n\n        return returnNode;\n      }\n\n      var serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n\n      /* Sanitize final string template-safe */\n      if (SAFE_FOR_TEMPLATES) {\n        serializedHTML = stringReplace(serializedHTML, MUSTACHE_EXPR$$1, ' ');\n        serializedHTML = stringReplace(serializedHTML, ERB_EXPR$$1, ' ');\n      }\n\n      return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(serializedHTML) : serializedHTML;\n    };\n\n    /**\n     * Public method to set the configuration once\n     * setConfig\n     *\n     * @param {Object} cfg configuration object\n     */\n    DOMPurify.setConfig = function (cfg) {\n      _parseConfig(cfg);\n      SET_CONFIG = true;\n    };\n\n    /**\n     * Public method to remove the configuration\n     * clearConfig\n     *\n     */\n    DOMPurify.clearConfig = function () {\n      CONFIG = null;\n      SET_CONFIG = false;\n    };\n\n    /**\n     * Public method to check if an attribute value is valid.\n     * Uses last set config, if any. Otherwise, uses config defaults.\n     * isValidAttribute\n     *\n     * @param  {string} tag Tag name of containing element.\n     * @param  {string} attr Attribute name.\n     * @param  {string} value Attribute value.\n     * @return {Boolean} Returns true if `value` is valid. Otherwise, returns false.\n     */\n    DOMPurify.isValidAttribute = function (tag, attr, value) {\n      /* Initialize shared config vars if necessary. */\n      if (!CONFIG) {\n        _parseConfig({});\n      }\n\n      var lcTag = stringToLowerCase(tag);\n      var lcName = stringToLowerCase(attr);\n      return _isValidAttribute(lcTag, lcName, value);\n    };\n\n    /**\n     * AddHook\n     * Public method to add DOMPurify hooks\n     *\n     * @param {String} entryPoint entry point for the hook to add\n     * @param {Function} hookFunction function to execute\n     */\n    DOMPurify.addHook = function (entryPoint, hookFunction) {\n      if (typeof hookFunction !== 'function') {\n        return;\n      }\n\n      hooks[entryPoint] = hooks[entryPoint] || [];\n      arrayPush(hooks[entryPoint], hookFunction);\n    };\n\n    /**\n     * RemoveHook\n     * Public method to remove a DOMPurify hook at a given entryPoint\n     * (pops it from the stack of hooks if more are present)\n     *\n     * @param {String} entryPoint entry point for the hook to remove\n     */\n    DOMPurify.removeHook = function (entryPoint) {\n      if (hooks[entryPoint]) {\n        arrayPop(hooks[entryPoint]);\n      }\n    };\n\n    /**\n     * RemoveHooks\n     * Public method to remove all DOMPurify hooks at a given entryPoint\n     *\n     * @param  {String} entryPoint entry point for the hooks to remove\n     */\n    DOMPurify.removeHooks = function (entryPoint) {\n      if (hooks[entryPoint]) {\n        hooks[entryPoint] = [];\n      }\n    };\n\n    /**\n     * RemoveAllHooks\n     * Public method to remove all DOMPurify hooks\n     *\n     */\n    DOMPurify.removeAllHooks = function () {\n      hooks = {};\n    };\n\n    return DOMPurify;\n  }\n\n  var purify = createDOMPurify();\n\n  return purify;\n\n}));\n//# sourceMappingURL=purify.js.map\n","module.exports = function isArrayish(obj) {\n\tif (!obj || typeof obj === 'string') {\n\t\treturn false;\n\t}\n\n\treturn obj instanceof Array || Array.isArray(obj) ||\n\t\t(obj.length >= 0 && (obj.splice instanceof Function ||\n\t\t\t(Object.getOwnPropertyDescriptor(obj, (obj.length - 1)) && obj.constructor.name !== 'String')));\n};\n","'use strict';\n\nvar isArrayish = require('is-arrayish');\n\nvar concat = Array.prototype.concat;\nvar slice = Array.prototype.slice;\n\nvar swizzle = module.exports = function swizzle(args) {\n\tvar results = [];\n\n\tfor (var i = 0, len = args.length; i < len; i++) {\n\t\tvar arg = args[i];\n\n\t\tif (isArrayish(arg)) {\n\t\t\t// http://jsperf.com/javascript-array-concat-vs-push/98\n\t\t\tresults = concat.call(results, slice.call(arg));\n\t\t} else {\n\t\t\tresults.push(arg);\n\t\t}\n\t}\n\n\treturn results;\n};\n\nswizzle.wrap = function (fn) {\n\treturn function () {\n\t\treturn fn(swizzle(arguments));\n\t};\n};\n","import { SidePaneElementProps } from './sidePane/SidePaneElement';\nimport {\n    ContentEditFeatureSettings,\n    DefaultFormat,\n    ExperimentalFeatures,\n} from 'roosterjs-editor-types';\n\nexport const UrlPlaceholder = '$url$';\n\nexport interface BuildInPluginList {\n    contentEdit: boolean;\n    hyperlink: boolean;\n    paste: boolean;\n    watermark: boolean;\n    imageEdit: boolean;\n    cutPasteListChain: boolean;\n    tableCellSelection: boolean;\n    customReplace: boolean;\n    listEditMenu: boolean;\n    imageEditMenu: boolean;\n    tableEditMenu: boolean;\n    contextMenu: boolean;\n    autoFormat: boolean;\n    announce: boolean;\n}\n\nexport default interface BuildInPluginState {\n    pluginList: BuildInPluginList;\n    contentEditFeatures: ContentEditFeatureSettings;\n    defaultFormat: DefaultFormat;\n    linkTitle: string;\n    watermarkText: string;\n    experimentalFeatures: ExperimentalFeatures[];\n    forcePreserveRatio: boolean;\n    isRtl: boolean;\n    cacheModel?: boolean;\n    tableFeaturesContainerSelector: string;\n    applyChangesOnMouseUp?: boolean;\n}\n\nexport interface BuildInPluginProps extends BuildInPluginState, SidePaneElementProps {}\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport ApiPlaygroundPlugin from './sidePane/contentModelApiPlayground/ApiPlaygroundPlugin';\nimport ContentModelEditorOptionsPlugin from './sidePane/editorOptions/ContentModelEditorOptionsPlugin';\nimport ContentModelEventViewPlugin from './sidePane/eventViewer/ContentModelEventViewPlugin';\nimport ContentModelFormatPainterPlugin from './contentModel/plugins/ContentModelFormatPainterPlugin';\nimport ContentModelFormatStatePlugin from './sidePane/formatState/ContentModelFormatStatePlugin';\nimport ContentModelPanePlugin from './sidePane/contentModel/ContentModelPanePlugin';\nimport ContentModelRibbonButton from './ribbonButtons/contentModel/ContentModelRibbonButton';\nimport ContentModelRooster from './contentModel/editor/ContentModelRooster';\nimport ContentModelSnapshotPlugin from './sidePane/snapshot/ContentModelSnapshotPlugin';\nimport getToggleablePlugins from './getToggleablePlugins';\nimport MainPaneBase, { MainPaneBaseState } from './MainPaneBase';\nimport RibbonPlugin from './ribbonButtons/contentModel/RibbonPlugin';\nimport SampleEntityPlugin from './sampleEntity/SampleEntityPlugin';\nimport SidePane from './sidePane/SidePane';\nimport TitleBar from './titleBar/TitleBar';\nimport { alignCenterButton } from './ribbonButtons/contentModel/alignCenterButton';\nimport { alignJustifyButton } from './ribbonButtons/contentModel/alignJustifyButton';\nimport { alignLeftButton } from './ribbonButtons/contentModel/alignLeftButton';\nimport { alignRightButton } from './ribbonButtons/contentModel/alignRightButton';\nimport { arrayPush } from 'roosterjs-editor-dom';\nimport { backgroundColorButton } from './ribbonButtons/contentModel/backgroundColorButton';\nimport { blockQuoteButton } from './ribbonButtons/contentModel/blockQuoteButton';\nimport { boldButton } from './ribbonButtons/contentModel/boldButton';\nimport { bulletedListButton } from './ribbonButtons/contentModel/bulletedListButton';\nimport { changeImageButton } from './ribbonButtons/contentModel/changeImageButton';\nimport { clearFormatButton } from './ribbonButtons/contentModel/clearFormatButton';\nimport { codeButton } from './ribbonButtons/contentModel/codeButton';\nimport { ContentModelRibbon } from './ribbonButtons/contentModel/ContentModelRibbon';\nimport { ContentModelRibbonPlugin } from './ribbonButtons/contentModel/ContentModelRibbonPlugin';\nimport { createEmojiPlugin, createPasteOptionPlugin } from 'roosterjs-react';\nimport { darkMode } from './ribbonButtons/contentModel/darkMode';\nimport { decreaseFontSizeButton } from './ribbonButtons/contentModel/decreaseFontSizeButton';\nimport { decreaseIndentButton } from './ribbonButtons/contentModel/decreaseIndentButton';\nimport { EditorAdapter, EditorAdapterOptions } from 'roosterjs-editor-adapter';\nimport { EditorPlugin } from 'roosterjs-editor-types';\nimport { exportContent } from './ribbonButtons/contentModel/export';\nimport { fontButton } from './ribbonButtons/contentModel/fontButton';\nimport { fontSizeButton } from './ribbonButtons/contentModel/fontSizeButton';\nimport { formatPainterButton } from './ribbonButtons/contentModel/formatPainterButton';\nimport { formatTableButton } from './ribbonButtons/contentModel/formatTableButton';\nimport { getDarkColor } from 'roosterjs-color-utils';\nimport { imageBorderColorButton } from './ribbonButtons/contentModel/imageBorderColorButton';\nimport { imageBorderRemoveButton } from './ribbonButtons/contentModel/imageBorderRemoveButton';\nimport { imageBorderStyleButton } from './ribbonButtons/contentModel/imageBorderStyleButton';\nimport { imageBorderWidthButton } from './ribbonButtons/contentModel/imageBorderWidthButton';\nimport { imageBoxShadowButton } from './ribbonButtons/contentModel/imageBoxShadowButton';\nimport { increaseFontSizeButton } from './ribbonButtons/contentModel/increaseFontSizeButton';\nimport { increaseIndentButton } from './ribbonButtons/contentModel/increaseIndentButton';\nimport { insertImageButton } from './ribbonButtons/contentModel/insertImageButton';\nimport { insertLinkButton } from './ribbonButtons/contentModel/insertLinkButton';\nimport { insertTableButton } from './ribbonButtons/contentModel/insertTableButton';\nimport { italicButton } from './ribbonButtons/contentModel/italicButton';\nimport { listStartNumberButton } from './ribbonButtons/contentModel/listStartNumberButton';\nimport { ltrButton } from './ribbonButtons/contentModel/ltrButton';\nimport { numberedListButton } from './ribbonButtons/contentModel/numberedListButton';\nimport { PartialTheme } from '@fluentui/react/lib/Theme';\nimport { pasteButton } from './ribbonButtons/contentModel/pasteButton';\nimport { popout } from './ribbonButtons/contentModel/popout';\nimport { redoButton } from './ribbonButtons/contentModel/redoButton';\nimport { removeLinkButton } from './ribbonButtons/contentModel/removeLinkButton';\nimport { rtlButton } from './ribbonButtons/contentModel/rtlButton';\nimport { setBulletedListStyleButton } from './ribbonButtons/contentModel/setBulletedListStyleButton';\nimport { setHeadingLevelButton } from './ribbonButtons/contentModel/setHeadingLevelButton';\nimport { setNumberedListStyleButton } from './ribbonButtons/contentModel/setNumberedListStyleButton';\nimport { setTableCellShadeButton } from './ribbonButtons/contentModel/setTableCellShadeButton';\nimport { setTableHeaderButton } from './ribbonButtons/contentModel/setTableHeaderButton';\nimport { spacingButton } from './ribbonButtons/contentModel/spacingButton';\nimport { strikethroughButton } from './ribbonButtons/contentModel/strikethroughButton';\nimport { subscriptButton } from './ribbonButtons/contentModel/subscriptButton';\nimport { superscriptButton } from './ribbonButtons/contentModel/superscriptButton';\nimport { tableBorderApplyButton } from './ribbonButtons/contentModel/tableBorderApplyButton';\nimport { tableBorderColorButton } from './ribbonButtons/contentModel/tableBorderColorButton';\nimport { tableBorderStyleButton } from './ribbonButtons/contentModel/tableBorderStyleButton';\nimport { tableBorderWidthButton } from './ribbonButtons/contentModel/tableBorderWidthButton';\nimport { textColorButton } from './ribbonButtons/contentModel/textColorButton';\nimport { trustedHTMLHandler } from '../utils/trustedHTMLHandler';\nimport { underlineButton } from './ribbonButtons/contentModel/underlineButton';\nimport { undoButton } from './ribbonButtons/contentModel/undoButton';\nimport { zoom } from './ribbonButtons/contentModel/zoom';\nimport { ContentModelSegmentFormat, IEditor, Snapshots } from 'roosterjs-content-model-types';\nimport {\n    AutoFormatPlugin,\n    EditPlugin,\n    PastePlugin,\n    TableEditPlugin,\n} from 'roosterjs-content-model-plugins';\nimport {\n    spaceAfterButton,\n    spaceBeforeButton,\n} from './ribbonButtons/contentModel/spaceBeforeAfterButtons';\nimport {\n    tableAlignCellButton,\n    tableAlignTableButton,\n    tableDeleteButton,\n    tableInsertButton,\n    tableMergeButton,\n    tableSplitButton,\n} from './ribbonButtons/contentModel/tableEditButtons';\n\nconst styles = require('./ContentModelEditorMainPane.scss');\n\nconst LightTheme: PartialTheme = {\n    palette: {\n        themePrimary: '#cc6688',\n        themeLighterAlt: '#080405',\n        themeLighter: '#211016',\n        themeLight: '#3d1f29',\n        themeTertiary: '#7a3d52',\n        themeSecondary: '#b45a78',\n        themeDarkAlt: '#d17392',\n        themeDark: '#d886a1',\n        themeDarker: '#e2a3b8',\n        neutralLighterAlt: '#f8f8f8',\n        neutralLighter: '#f4f4f4',\n        neutralLight: '#eaeaea',\n        neutralQuaternaryAlt: '#dadada',\n        neutralQuaternary: '#d0d0d0',\n        neutralTertiaryAlt: '#c8c8c8',\n        neutralTertiary: '#595959',\n        neutralSecondary: '#373737',\n        neutralPrimaryAlt: '#2f2f2f',\n        neutralPrimary: '#000000',\n        neutralDark: '#151515',\n        black: '#0b0b0b',\n        white: '#ffffff',\n    },\n};\n\nconst DarkTheme: PartialTheme = {\n    palette: {\n        themePrimary: '#cb6587',\n        themeLighterAlt: '#fdf8fa',\n        themeLighter: '#f7e3ea',\n        themeLight: '#f0ccd8',\n        themeTertiary: '#e09db4',\n        themeSecondary: '#d27694',\n        themeDarkAlt: '#b85c7a',\n        themeDark: '#9b4e67',\n        themeDarker: '#72394c',\n        neutralLighterAlt: '#3c3c3c',\n        neutralLighter: '#444444',\n        neutralLight: '#515151',\n        neutralQuaternaryAlt: '#595959',\n        neutralQuaternary: '#5f5f5f',\n        neutralTertiaryAlt: '#7a7a7a',\n        neutralTertiary: '#c8c8c8',\n        neutralSecondary: '#d0d0d0',\n        neutralPrimaryAlt: '#dadada',\n        neutralPrimary: '#ffffff',\n        neutralDark: '#f4f4f4',\n        black: '#f8f8f8',\n        white: '#333333',\n    },\n};\n\ninterface ContentModelMainPaneState extends MainPaneBaseState {\n    editorCreator: (div: HTMLDivElement, options: EditorAdapterOptions) => IEditor;\n}\n\nclass ContentModelEditorMainPane extends MainPaneBase<ContentModelMainPaneState> {\n    private formatStatePlugin: ContentModelFormatStatePlugin;\n    private editorOptionPlugin: ContentModelEditorOptionsPlugin;\n    private eventViewPlugin: ContentModelEventViewPlugin;\n    private apiPlaygroundPlugin: ApiPlaygroundPlugin;\n    private contentModelPanePlugin: ContentModelPanePlugin;\n    private contentModelEditPlugin: EditPlugin;\n    private contentModelAutoFormatPlugin: AutoFormatPlugin;\n    private contentModelRibbonPlugin: RibbonPlugin;\n    private pasteOptionPlugin: EditorPlugin;\n    private emojiPlugin: EditorPlugin;\n    private snapshotPlugin: ContentModelSnapshotPlugin;\n    private toggleablePlugins: EditorPlugin[] | null = null;\n    private formatPainterPlugin: ContentModelFormatPainterPlugin;\n    private pastePlugin: PastePlugin;\n    private sampleEntityPlugin: SampleEntityPlugin;\n    private tableEditPlugin: TableEditPlugin;\n    private snapshots: Snapshots;\n    private buttons: ContentModelRibbonButton<any>[] = [\n        formatPainterButton,\n        boldButton,\n        italicButton,\n        underlineButton,\n        fontButton,\n        fontSizeButton,\n        increaseFontSizeButton,\n        decreaseFontSizeButton,\n        textColorButton,\n        backgroundColorButton,\n        bulletedListButton,\n        numberedListButton,\n        decreaseIndentButton,\n        increaseIndentButton,\n        blockQuoteButton,\n        alignLeftButton,\n        alignCenterButton,\n        alignRightButton,\n        alignJustifyButton,\n        insertLinkButton,\n        removeLinkButton,\n        insertTableButton,\n        insertImageButton,\n        superscriptButton,\n        subscriptButton,\n        strikethroughButton,\n        setHeadingLevelButton,\n        codeButton,\n        ltrButton,\n        rtlButton,\n        undoButton,\n        redoButton,\n        clearFormatButton,\n        setBulletedListStyleButton,\n        setNumberedListStyleButton,\n        listStartNumberButton,\n        formatTableButton,\n        setTableCellShadeButton,\n        setTableHeaderButton,\n        tableInsertButton,\n        tableDeleteButton,\n        tableMergeButton,\n        tableSplitButton,\n        tableAlignCellButton,\n        tableAlignTableButton,\n        tableBorderApplyButton,\n        tableBorderColorButton,\n        tableBorderWidthButton,\n        tableBorderStyleButton,\n        imageBorderColorButton,\n        imageBorderWidthButton,\n        imageBorderStyleButton,\n        imageBorderRemoveButton,\n        changeImageButton,\n        imageBoxShadowButton,\n        spacingButton,\n        spaceBeforeButton,\n        spaceAfterButton,\n        pasteButton,\n        darkMode,\n        zoom,\n        exportContent,\n    ];\n\n    constructor(props: {}) {\n        super(props);\n\n        this.snapshots = {\n            snapshots: [],\n            totalSize: 0,\n            currentIndex: -1,\n            autoCompleteIndex: -1,\n            maxSize: 1e7,\n        };\n\n        this.formatStatePlugin = new ContentModelFormatStatePlugin();\n        this.editorOptionPlugin = new ContentModelEditorOptionsPlugin();\n        this.eventViewPlugin = new ContentModelEventViewPlugin();\n        this.apiPlaygroundPlugin = new ApiPlaygroundPlugin();\n        this.snapshotPlugin = new ContentModelSnapshotPlugin(this.snapshots);\n        this.contentModelPanePlugin = new ContentModelPanePlugin();\n        this.contentModelEditPlugin = new EditPlugin();\n        this.contentModelAutoFormatPlugin = new AutoFormatPlugin();\n        this.contentModelRibbonPlugin = new ContentModelRibbonPlugin();\n        this.pasteOptionPlugin = createPasteOptionPlugin();\n        this.emojiPlugin = createEmojiPlugin();\n        this.formatPainterPlugin = new ContentModelFormatPainterPlugin();\n        this.tableEditPlugin = new TableEditPlugin();\n        this.pastePlugin = new PastePlugin();\n        this.sampleEntityPlugin = new SampleEntityPlugin();\n        this.state = {\n            showSidePane: window.location.hash != '',\n            popoutWindow: null,\n            initState: this.editorOptionPlugin.getBuildInPluginState(),\n            scale: 1,\n            isDarkMode: this.themeMatch?.matches || false,\n            editorCreator: null,\n            isRtl: false,\n            tableBorderFormat: {\n                width: '1px',\n                style: 'solid',\n                color: '#ABABAB',\n            },\n        };\n    }\n\n    getStyles(): Record<string, string> {\n        return styles;\n    }\n\n    renderTitleBar() {\n        return <TitleBar className={styles.noGrow} mode=\"contentModel\" />;\n    }\n\n    renderRibbon(isPopout: boolean) {\n        const buttons = isPopout ? this.buttons : this.buttons.concat([popout]);\n\n        return (\n            <ContentModelRibbon\n                buttons={buttons}\n                plugin={this.contentModelRibbonPlugin}\n                dir={this.state.isRtl ? 'rtl' : 'ltr'}\n            />\n        );\n    }\n\n    renderSidePane(fullWidth: boolean) {\n        const styles = this.getStyles();\n\n        return (\n            <SidePane\n                ref={this.sidePane}\n                plugins={this.getSidePanePlugins()}\n                mode=\"contentModel\"\n                className={`main-pane ${styles.sidePane} ${\n                    fullWidth ? styles.sidePaneFullWidth : ''\n                }`}\n            />\n        );\n    }\n\n    getPlugins() {\n        this.toggleablePlugins =\n            this.toggleablePlugins || getToggleablePlugins(this.state.initState);\n\n        const plugins = [\n            ...this.toggleablePlugins,\n            this.pasteOptionPlugin,\n            this.emojiPlugin,\n            this.sampleEntityPlugin,\n        ];\n\n        if (this.state.showSidePane || this.state.popoutWindow) {\n            arrayPush(plugins, this.getSidePanePlugins());\n        }\n\n        plugins.push(this.updateContentPlugin);\n\n        return plugins;\n    }\n\n    resetEditor() {\n        this.toggleablePlugins = null;\n        this.setState({\n            editorCreator: (div: HTMLDivElement, options: EditorAdapterOptions) =>\n                new EditorAdapter(div, {\n                    ...options,\n                    cacheModel: this.state.initState.cacheModel,\n                }),\n        });\n    }\n\n    renderEditor() {\n        const styles = this.getStyles();\n        const allPlugins = this.getPlugins();\n        const editorStyles = {\n            transform: `scale(${this.state.scale})`,\n            transformOrigin: this.state.isRtl ? 'right top' : 'left top',\n            height: `calc(${100 / this.state.scale}%)`,\n            width: `calc(${100 / this.state.scale}%)`,\n        };\n        const format = this.state.initState.defaultFormat;\n        const defaultFormat: ContentModelSegmentFormat = {\n            fontWeight: format.bold ? 'bold' : undefined,\n            italic: format.italic || undefined,\n            underline: format.underline || undefined,\n            fontFamily: format.fontFamily || undefined,\n            fontSize: format.fontSize || undefined,\n            textColor: format.textColors?.lightModeColor || format.textColor || undefined,\n            backgroundColor:\n                format.backgroundColors?.lightModeColor || format.backgroundColor || undefined,\n        };\n\n        this.updateContentPlugin.forceUpdate();\n\n        return (\n            <div className={styles.editorContainer} id=\"EditorContainer\">\n                <div style={editorStyles}>\n                    {this.state.editorCreator && (\n                        <ContentModelRooster\n                            id={MainPaneBase.editorDivId}\n                            className={styles.editor}\n                            legacyPlugins={allPlugins}\n                            plugins={[\n                                this.contentModelRibbonPlugin,\n                                this.formatPainterPlugin,\n                                this.pastePlugin,\n                                this.tableEditPlugin,\n                                this.contentModelAutoFormatPlugin,\n                                this.contentModelEditPlugin,\n                                this.contentModelPanePlugin.getInnerRibbonPlugin(),\n                            ]}\n                            defaultSegmentFormat={defaultFormat}\n                            inDarkMode={this.state.isDarkMode}\n                            getDarkColor={getDarkColor}\n                            experimentalFeatures={this.state.initState.experimentalFeatures}\n                            snapshots={this.snapshotPlugin.getSnapshots()}\n                            trustedHTMLHandler={trustedHTMLHandler}\n                            initialContent={this.content}\n                            editorCreator={this.state.editorCreator}\n                            dir={this.state.isRtl ? 'rtl' : 'ltr'}\n                        />\n                    )}\n                </div>\n            </div>\n        );\n    }\n\n    getTheme(isDark: boolean): PartialTheme {\n        return isDark ? DarkTheme : LightTheme;\n    }\n\n    private getSidePanePlugins() {\n        return [\n            this.formatStatePlugin,\n            this.editorOptionPlugin,\n            this.eventViewPlugin,\n            this.apiPlaygroundPlugin,\n            this.snapshotPlugin,\n            this.contentModelPanePlugin,\n        ];\n    }\n}\n\nexport function mount(parent: HTMLElement) {\n    ReactDOM.render(<ContentModelEditorMainPane />, parent);\n}\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport ApiPlaygroundPlugin from './sidePane/apiPlayground/ApiPlaygroundPlugin';\nimport EditorOptionsPlugin from './sidePane/editorOptions/EditorOptionsPlugin';\nimport EventViewPlugin from './sidePane/eventViewer/EventViewPlugin';\nimport FormatStatePlugin from './sidePane/formatState/FormatStatePlugin';\nimport getToggleablePlugins from './getToggleablePlugins';\nimport MainPaneBase, { MainPaneBaseState } from './MainPaneBase';\nimport SampleEntityPlugin from './sampleEntity/SampleEntityPlugin';\nimport SidePane from './sidePane/SidePane';\nimport SnapshotPlugin from './sidePane/snapshot/SnapshotPlugin';\nimport TitleBar from './titleBar/TitleBar';\nimport { arrayPush } from 'roosterjs-editor-dom';\nimport { darkMode, DarkModeButtonStringKey } from './ribbonButtons/darkMode';\nimport { Editor } from 'roosterjs-editor-core';\nimport { EditorOptions, EditorPlugin, IEditor } from 'roosterjs-editor-types';\nimport { ExportButtonStringKey, exportContent } from './ribbonButtons/export';\nimport { getDarkColor } from 'roosterjs-color-utils';\nimport { PartialTheme } from '@fluentui/react/lib/Theme';\nimport { popout, PopoutButtonStringKey } from './ribbonButtons/popout';\nimport { trustedHTMLHandler } from '../utils/trustedHTMLHandler';\nimport { zoom, ZoomButtonStringKey } from './ribbonButtons/zoom';\nimport {\n    createRibbonPlugin,\n    RibbonPlugin,\n    createPasteOptionPlugin,\n    createEmojiPlugin,\n    Ribbon,\n    RibbonButton,\n    AllButtonStringKeys,\n    getButtons,\n    AllButtonKeys,\n    Rooster,\n} from 'roosterjs-react';\n\nconst styles = require('./MainPane.scss');\ntype RibbonStringKeys =\n    | AllButtonStringKeys\n    | DarkModeButtonStringKey\n    | ZoomButtonStringKey\n    | ExportButtonStringKey\n    | PopoutButtonStringKey;\n\nconst LightTheme: PartialTheme = {\n    palette: {\n        themePrimary: '#0099aa',\n        themeLighterAlt: '#f2fbfc',\n        themeLighter: '#cbeef2',\n        themeLight: '#a1dfe6',\n        themeTertiary: '#52c0cd',\n        themeSecondary: '#16a5b5',\n        themeDarkAlt: '#008a9a',\n        themeDark: '#007582',\n        themeDarker: '#005660',\n        neutralLighterAlt: '#faf9f8',\n        neutralLighter: '#f3f2f1',\n        neutralLight: '#edebe9',\n        neutralQuaternaryAlt: '#e1dfdd',\n        neutralQuaternary: '#d0d0d0',\n        neutralTertiaryAlt: '#c8c6c4',\n        neutralTertiary: '#a19f9d',\n        neutralSecondary: '#605e5c',\n        neutralPrimaryAlt: '#3b3a39',\n        neutralPrimary: '#323130',\n        neutralDark: '#201f1e',\n        black: '#000000',\n        white: '#ffffff',\n    },\n};\n\nconst DarkTheme: PartialTheme = {\n    palette: {\n        themePrimary: '#0091A1',\n        themeLighterAlt: '#f1fafb',\n        themeLighter: '#caecf0',\n        themeLight: '#9fdce3',\n        themeTertiary: '#4fbac6',\n        themeSecondary: '#159dac',\n        themeDarkAlt: '#008291',\n        themeDark: '#006e7a',\n        themeDarker: '#00515a',\n        neutralLighterAlt: '#3c3c3c',\n        neutralLighter: '#444444',\n        neutralLight: '#515151',\n        neutralQuaternaryAlt: '#595959',\n        neutralQuaternary: '#5f5f5f',\n        neutralTertiaryAlt: '#7a7a7a',\n        neutralTertiary: '#c8c8c8',\n        neutralSecondary: '#d0d0d0',\n        neutralPrimaryAlt: '#dadada',\n        neutralPrimary: '#ffffff',\n        neutralDark: '#f4f4f4',\n        black: '#f8f8f8',\n        white: '#333333',\n    },\n};\n\ninterface MainPaneState extends MainPaneBaseState {\n    editorCreator: (div: HTMLDivElement, options: EditorOptions) => IEditor;\n}\n\nclass MainPane extends MainPaneBase<MainPaneState> {\n    private formatStatePlugin: FormatStatePlugin;\n    private editorOptionPlugin: EditorOptionsPlugin;\n    private eventViewPlugin: EventViewPlugin;\n    private apiPlaygroundPlugin: ApiPlaygroundPlugin;\n    private ribbonPlugin: RibbonPlugin;\n    private pasteOptionPlugin: EditorPlugin;\n    private emojiPlugin: EditorPlugin;\n    private toggleablePlugins: EditorPlugin[] | null = null;\n    private sampleEntityPlugin: SampleEntityPlugin;\n    private snapshotPlugin: SnapshotPlugin;\n    private mainWindowButtons: RibbonButton<RibbonStringKeys>[];\n    private popoutWindowButtons: RibbonButton<RibbonStringKeys>[];\n\n    constructor(props: {}) {\n        super(props);\n\n        this.formatStatePlugin = new FormatStatePlugin();\n        this.editorOptionPlugin = new EditorOptionsPlugin();\n        this.eventViewPlugin = new EventViewPlugin();\n        this.apiPlaygroundPlugin = new ApiPlaygroundPlugin();\n        this.snapshotPlugin = new SnapshotPlugin();\n        this.ribbonPlugin = createRibbonPlugin();\n        this.pasteOptionPlugin = createPasteOptionPlugin();\n        this.emojiPlugin = createEmojiPlugin();\n        this.sampleEntityPlugin = new SampleEntityPlugin();\n\n        this.mainWindowButtons = getButtons([\n            ...AllButtonKeys,\n            darkMode,\n            zoom,\n            exportContent,\n            popout,\n        ]);\n        this.popoutWindowButtons = getButtons([...AllButtonKeys, darkMode, zoom, exportContent]);\n\n        this.state = {\n            showSidePane: window.location.hash != '',\n            popoutWindow: null,\n            initState: this.editorOptionPlugin.getBuildInPluginState(),\n            scale: 1,\n            isDarkMode: this.themeMatch?.matches || false,\n            editorCreator: null,\n            isRtl: false,\n        };\n    }\n\n    getStyles(): Record<string, string> {\n        return styles;\n    }\n\n    renderTitleBar() {\n        return <TitleBar className={styles.noGrow} mode=\"classical\" />;\n    }\n\n    renderRibbon(isPopout: boolean) {\n        return (\n            <Ribbon\n                buttons={isPopout ? this.popoutWindowButtons : this.mainWindowButtons}\n                plugin={this.ribbonPlugin}\n                dir={this.state.isRtl ? 'rtl' : 'ltr'}\n            />\n        );\n    }\n\n    renderSidePane(fullWidth: boolean) {\n        const styles = this.getStyles();\n\n        return (\n            <SidePane\n                ref={this.sidePane}\n                plugins={this.getSidePanePlugins()}\n                mode=\"classical\"\n                className={`main-pane ${styles.sidePane} ${\n                    fullWidth ? styles.sidePaneFullWidth : ''\n                }`}\n            />\n        );\n    }\n\n    getPlugins() {\n        this.toggleablePlugins =\n            this.toggleablePlugins || getToggleablePlugins(this.state.initState);\n\n        const plugins = [\n            ...this.toggleablePlugins,\n            this.ribbonPlugin,\n            this.pasteOptionPlugin,\n            this.emojiPlugin,\n            this.sampleEntityPlugin,\n        ];\n\n        if (this.state.showSidePane || this.state.popoutWindow) {\n            arrayPush(plugins, this.getSidePanePlugins());\n        }\n\n        plugins.push(this.updateContentPlugin);\n\n        return plugins;\n    }\n\n    resetEditor() {\n        this.toggleablePlugins = null;\n        this.setState({\n            editorCreator: (div: HTMLDivElement, options: EditorOptions) =>\n                new Editor(div, options),\n        });\n    }\n\n    getTheme(isDark: boolean): PartialTheme {\n        return isDark ? DarkTheme : LightTheme;\n    }\n\n    renderEditor() {\n        const styles = this.getStyles();\n        const allPlugins = this.getPlugins();\n        const editorStyles = {\n            transform: `scale(${this.state.scale})`,\n            transformOrigin: this.state.isRtl ? 'right top' : 'left top',\n            height: `calc(${100 / this.state.scale}%)`,\n            width: `calc(${100 / this.state.scale}%)`,\n        };\n\n        this.updateContentPlugin.forceUpdate();\n\n        return (\n            <div className={styles.editorContainer} id=\"EditorContainer\">\n                <div style={editorStyles}>\n                    {this.state.editorCreator && (\n                        <Rooster\n                            className={styles.editor}\n                            plugins={allPlugins}\n                            defaultFormat={this.state.initState.defaultFormat}\n                            inDarkMode={this.state.isDarkMode}\n                            getDarkColor={getDarkColor}\n                            experimentalFeatures={this.state.initState.experimentalFeatures}\n                            undoMetadataSnapshotService={this.snapshotPlugin.getSnapshotService()}\n                            trustedHTMLHandler={trustedHTMLHandler}\n                            zoomScale={this.state.scale}\n                            initialContent={this.content}\n                            editorCreator={this.state.editorCreator}\n                            dir={this.state.isRtl ? 'rtl' : 'ltr'}\n                        />\n                    )}\n                </div>\n            </div>\n        );\n    }\n\n    private getSidePanePlugins() {\n        return [\n            this.formatStatePlugin,\n            this.editorOptionPlugin,\n            this.eventViewPlugin,\n            this.apiPlaygroundPlugin,\n            this.snapshotPlugin,\n        ];\n    }\n}\n\nexport function mount(parent: HTMLElement) {\n    ReactDOM.render(<MainPane />, parent);\n}\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport BuildInPluginState from './BuildInPluginState';\nimport SidePane from './sidePane/SidePane';\nimport { Border } from 'roosterjs-content-model-types';\nimport { createUpdateContentPlugin, UpdateContentPlugin, UpdateMode } from 'roosterjs-react';\nimport { PartialTheme, ThemeProvider } from '@fluentui/react/lib/Theme';\nimport { registerWindowForCss, unregisterWindowForCss } from '../utils/cssMonitor';\nimport { trustedHTMLHandler } from '../utils/trustedHTMLHandler';\nimport { WindowProvider } from '@fluentui/react/lib/WindowProvider';\n\nexport interface MainPaneBaseState {\n    showSidePane: boolean;\n    popoutWindow: Window;\n    initState: BuildInPluginState;\n    scale: number;\n    isDarkMode: boolean;\n    isRtl: boolean;\n    tableBorderFormat?: Border;\n}\n\nconst PopoutRoot = 'mainPane';\nconst POPOUT_HTML = `<!doctype html><html><head><title>RoosterJs Demo Site</title></head><body><div id=${PopoutRoot}></div></body></html>`;\nconst POPOUT_FEATURES = 'menubar=no,statusbar=no,width=1200,height=800';\nconst POPOUT_URL = 'about:blank';\nconst POPOUT_TARGET = '_blank';\n\nexport default abstract class MainPaneBase<T extends MainPaneBaseState> extends React.Component<\n    {},\n    T\n> {\n    private mouseX: number;\n    private static instance: MainPaneBase<MainPaneBaseState>;\n    private popoutRoot: HTMLElement;\n\n    protected sidePane = React.createRef<SidePane>();\n    protected updateContentPlugin: UpdateContentPlugin;\n    protected content: string = '';\n    protected themeMatch = window.matchMedia?.('(prefers-color-scheme: dark)');\n\n    static getInstance() {\n        return this.instance;\n    }\n\n    static readonly editorDivId = 'RoosterJsContentDiv';\n\n    constructor(props: {}) {\n        super(props);\n\n        MainPaneBase.instance = this;\n        this.updateContentPlugin = createUpdateContentPlugin(UpdateMode.OnDispose, this.onUpdate);\n    }\n\n    abstract getStyles(): Record<string, string>;\n\n    abstract renderRibbon(isPopout: boolean): JSX.Element;\n\n    abstract renderTitleBar(): JSX.Element;\n\n    abstract renderSidePane(fullWidth: boolean): JSX.Element;\n\n    abstract resetEditor(): void;\n\n    abstract getTheme(isDark: boolean): PartialTheme;\n\n    abstract renderEditor(): JSX.Element;\n\n    render() {\n        const styles = this.getStyles();\n\n        return (\n            <ThemeProvider\n                applyTo=\"body\"\n                theme={this.getTheme(this.state.isDarkMode)}\n                className={styles.mainPane}>\n                {this.renderTitleBar()}\n                {!this.state.popoutWindow && this.renderRibbon(false /*isPopout*/)}\n                <div className={styles.body + ' ' + (this.state.isDarkMode ? 'dark' : '')}>\n                    {this.state.popoutWindow ? this.renderPopout() : this.renderMainPane()}\n                </div>\n            </ThemeProvider>\n        );\n    }\n\n    componentDidMount() {\n        this.themeMatch?.addEventListener('change', this.onThemeChange);\n        this.resetEditor();\n    }\n\n    componentWillUnmount() {\n        this.themeMatch?.removeEventListener('change', this.onThemeChange);\n    }\n\n    popout() {\n        this.updateContentPlugin.forceUpdate();\n\n        const win = window.open(POPOUT_URL, POPOUT_TARGET, POPOUT_FEATURES);\n        win.document.write(trustedHTMLHandler(POPOUT_HTML));\n        win.addEventListener('beforeunload', () => {\n            this.updateContentPlugin.forceUpdate();\n\n            unregisterWindowForCss(win);\n            this.setState({ popoutWindow: null });\n        });\n\n        registerWindowForCss(win);\n\n        this.popoutRoot = win.document.getElementById(PopoutRoot);\n        this.setState({\n            popoutWindow: win,\n        });\n    }\n\n    resetEditorPlugin(pluginState: BuildInPluginState) {\n        this.updateContentPlugin.forceUpdate();\n        this.setState({\n            initState: pluginState,\n        });\n\n        this.resetEditor();\n    }\n\n    setScale(scale: number): void {\n        this.setState({\n            scale: scale,\n        });\n    }\n\n    getTableBorder(): Border {\n        return this.state.tableBorderFormat;\n    }\n\n    setTableBorderColor(color: string): void {\n        this.setState({\n            tableBorderFormat: { ...this.getTableBorder(), color },\n        });\n    }\n\n    setTableBorderWidth(width: string): void {\n        this.setState({\n            tableBorderFormat: { ...this.getTableBorder(), width },\n        });\n    }\n\n    setTableBorderStyle(style: string): void {\n        this.setState({\n            tableBorderFormat: { ...this.getTableBorder(), style },\n        });\n    }\n\n    toggleDarkMode(): void {\n        this.setState({\n            isDarkMode: !this.state.isDarkMode,\n        });\n    }\n\n    setPageDirection(isRtl: boolean): void {\n        this.setState({ isRtl: isRtl });\n        [window, this.state.popoutWindow].forEach(win => {\n            if (win) {\n                win.document.body.dir = isRtl ? 'rtl' : 'ltr';\n            }\n        });\n    }\n\n    private renderMainPane() {\n        const styles = this.getStyles();\n\n        return (\n            <>\n                {this.renderEditor()}\n                {this.state.showSidePane ? (\n                    <>\n                        <div className={styles.resizer} onMouseDown={this.onMouseDown} />\n                        {this.renderSidePane(false /*fullWidth*/)}\n                        {this.renderSidePaneButton()}\n                    </>\n                ) : (\n                    this.renderSidePaneButton()\n                )}\n            </>\n        );\n    }\n\n    private renderSidePaneButton() {\n        const styles = this.getStyles();\n\n        return (\n            <button\n                className={`side-pane-toggle ${this.state.showSidePane ? 'open' : 'close'} ${\n                    styles.showSidePane\n                }`}\n                onClick={this.state.showSidePane ? this.onHideSidePane : this.onShowSidePane}>\n                <div>{this.state.showSidePane ? 'Hide side pane' : 'Show side pane'}</div>\n            </button>\n        );\n    }\n\n    private renderPopout() {\n        const styles = this.getStyles();\n\n        return (\n            <>\n                {this.renderSidePane(true /*fullWidth*/)}\n                {ReactDOM.createPortal(\n                    <WindowProvider window={this.state.popoutWindow}>\n                        <ThemeProvider applyTo=\"body\" theme={this.getTheme(this.state.isDarkMode)}>\n                            <div className={styles.mainPane}>\n                                {this.renderRibbon(true /*isPopout*/)}\n                                <div className={styles.body}>{this.renderEditor()}</div>\n                            </div>\n                        </ThemeProvider>\n                    </WindowProvider>,\n                    this.popoutRoot\n                )}\n            </>\n        );\n    }\n\n    private onMouseDown = (e: React.MouseEvent<EventTarget>) => {\n        document.addEventListener('mousemove', this.onMouseMove, true);\n        document.addEventListener('mouseup', this.onMouseUp, true);\n        document.body.style.userSelect = 'none';\n        this.mouseX = e.pageX;\n    };\n\n    private onMouseMove = (e: MouseEvent) => {\n        this.sidePane.current.changeWidth(this.mouseX - e.pageX);\n        this.mouseX = e.pageX;\n    };\n\n    private onMouseUp = (e: MouseEvent) => {\n        document.removeEventListener('mousemove', this.onMouseMove, true);\n        document.removeEventListener('mouseup', this.onMouseUp, true);\n        document.body.style.userSelect = '';\n    };\n\n    private onUpdate = (content: string) => {\n        this.content = content;\n    };\n\n    private onShowSidePane = () => {\n        this.setState({\n            showSidePane: true,\n        });\n        this.resetEditor();\n    };\n\n    private onHideSidePane = () => {\n        this.setState({\n            showSidePane: false,\n        });\n        this.resetEditor();\n        window.location.hash = '';\n    };\n\n    private onThemeChange = () => {\n        this.setState({\n            isDarkMode: this.themeMatch?.matches || false,\n        });\n    };\n}\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport ApiPlaygroundPlugin from './sidePane/contentModelApiPlayground/ApiPlaygroundPlugin';\nimport ContentModelEditorOptionsPlugin from './sidePane/editorOptions/ContentModelEditorOptionsPlugin';\nimport ContentModelEventViewPlugin from './sidePane/eventViewer/ContentModelEventViewPlugin';\nimport ContentModelFormatPainterPlugin from './contentModel/plugins/ContentModelFormatPainterPlugin';\nimport ContentModelFormatStatePlugin from './sidePane/formatState/ContentModelFormatStatePlugin';\nimport ContentModelPanePlugin from './sidePane/contentModel/ContentModelPanePlugin';\nimport ContentModelRibbonButton from './ribbonButtons/contentModel/ContentModelRibbonButton';\nimport ContentModelRooster from './contentModel/editor/ContentModelRooster';\nimport ContentModelSnapshotPlugin from './sidePane/snapshot/ContentModelSnapshotPlugin';\nimport MainPaneBase, { MainPaneBaseState } from './MainPaneBase';\nimport RibbonPlugin from './ribbonButtons/contentModel/RibbonPlugin';\nimport SidePane from './sidePane/SidePane';\nimport TitleBar from './titleBar/TitleBar';\nimport { alignCenterButton } from './ribbonButtons/contentModel/alignCenterButton';\nimport { alignJustifyButton } from './ribbonButtons/contentModel/alignJustifyButton';\nimport { alignLeftButton } from './ribbonButtons/contentModel/alignLeftButton';\nimport { alignRightButton } from './ribbonButtons/contentModel/alignRightButton';\nimport { backgroundColorButton } from './ribbonButtons/contentModel/backgroundColorButton';\nimport { blockQuoteButton } from './ribbonButtons/contentModel/blockQuoteButton';\nimport { boldButton } from './ribbonButtons/contentModel/boldButton';\nimport { bulletedListButton } from './ribbonButtons/contentModel/bulletedListButton';\nimport { changeImageButton } from './ribbonButtons/contentModel/changeImageButton';\nimport { clearFormatButton } from './ribbonButtons/contentModel/clearFormatButton';\nimport { codeButton } from './ribbonButtons/contentModel/codeButton';\nimport { ContentModelRibbon } from './ribbonButtons/contentModel/ContentModelRibbon';\nimport { ContentModelRibbonPlugin } from './ribbonButtons/contentModel/ContentModelRibbonPlugin';\nimport { darkMode } from './ribbonButtons/contentModel/darkMode';\nimport { decreaseFontSizeButton } from './ribbonButtons/contentModel/decreaseFontSizeButton';\nimport { decreaseIndentButton } from './ribbonButtons/contentModel/decreaseIndentButton';\nimport { Editor } from 'roosterjs-content-model-core';\nimport { exportContent } from './ribbonButtons/contentModel/export';\nimport { fontButton } from './ribbonButtons/contentModel/fontButton';\nimport { fontSizeButton } from './ribbonButtons/contentModel/fontSizeButton';\nimport { formatPainterButton } from './ribbonButtons/contentModel/formatPainterButton';\nimport { formatTableButton } from './ribbonButtons/contentModel/formatTableButton';\nimport { getDarkColor } from 'roosterjs-color-utils';\nimport { imageBorderColorButton } from './ribbonButtons/contentModel/imageBorderColorButton';\nimport { imageBorderRemoveButton } from './ribbonButtons/contentModel/imageBorderRemoveButton';\nimport { imageBorderStyleButton } from './ribbonButtons/contentModel/imageBorderStyleButton';\nimport { imageBorderWidthButton } from './ribbonButtons/contentModel/imageBorderWidthButton';\nimport { imageBoxShadowButton } from './ribbonButtons/contentModel/imageBoxShadowButton';\nimport { increaseFontSizeButton } from './ribbonButtons/contentModel/increaseFontSizeButton';\nimport { increaseIndentButton } from './ribbonButtons/contentModel/increaseIndentButton';\nimport { insertImageButton } from './ribbonButtons/contentModel/insertImageButton';\nimport { insertLinkButton } from './ribbonButtons/contentModel/insertLinkButton';\nimport { insertTableButton } from './ribbonButtons/contentModel/insertTableButton';\nimport { italicButton } from './ribbonButtons/contentModel/italicButton';\nimport { listStartNumberButton } from './ribbonButtons/contentModel/listStartNumberButton';\nimport { ltrButton } from './ribbonButtons/contentModel/ltrButton';\nimport { numberedListButton } from './ribbonButtons/contentModel/numberedListButton';\nimport { PartialTheme } from '@fluentui/react/lib/Theme';\nimport { pasteButton } from './ribbonButtons/contentModel/pasteButton';\nimport { popout } from './ribbonButtons/contentModel/popout';\nimport { redoButton } from './ribbonButtons/contentModel/redoButton';\nimport { removeLinkButton } from './ribbonButtons/contentModel/removeLinkButton';\nimport { rtlButton } from './ribbonButtons/contentModel/rtlButton';\nimport { setBulletedListStyleButton } from './ribbonButtons/contentModel/setBulletedListStyleButton';\nimport { setHeadingLevelButton } from './ribbonButtons/contentModel/setHeadingLevelButton';\nimport { setNumberedListStyleButton } from './ribbonButtons/contentModel/setNumberedListStyleButton';\nimport { setTableCellShadeButton } from './ribbonButtons/contentModel/setTableCellShadeButton';\nimport { setTableHeaderButton } from './ribbonButtons/contentModel/setTableHeaderButton';\nimport { Snapshots } from 'roosterjs-editor-types';\nimport { spacingButton } from './ribbonButtons/contentModel/spacingButton';\nimport { strikethroughButton } from './ribbonButtons/contentModel/strikethroughButton';\nimport { subscriptButton } from './ribbonButtons/contentModel/subscriptButton';\nimport { superscriptButton } from './ribbonButtons/contentModel/superscriptButton';\nimport { tableBorderApplyButton } from './ribbonButtons/contentModel/tableBorderApplyButton';\nimport { tableBorderColorButton } from './ribbonButtons/contentModel/tableBorderColorButton';\nimport { tableBorderStyleButton } from './ribbonButtons/contentModel/tableBorderStyleButton';\nimport { tableBorderWidthButton } from './ribbonButtons/contentModel/tableBorderWidthButton';\nimport { textColorButton } from './ribbonButtons/contentModel/textColorButton';\nimport { trustedHTMLHandler } from '../utils/trustedHTMLHandler';\nimport { underlineButton } from './ribbonButtons/contentModel/underlineButton';\nimport { undoButton } from './ribbonButtons/contentModel/undoButton';\nimport { zoom } from './ribbonButtons/contentModel/zoom';\nimport {\n    AutoFormatPlugin,\n    EditPlugin,\n    ShortcutPlugin,\n    TableEditPlugin,\n} from 'roosterjs-content-model-plugins';\nimport {\n    ContentModelSegmentFormat,\n    IEditor,\n    Snapshot,\n    EditorOptions,\n} from 'roosterjs-content-model-types';\nimport {\n    spaceAfterButton,\n    spaceBeforeButton,\n} from './ribbonButtons/contentModel/spaceBeforeAfterButtons';\nimport {\n    tableAlignCellButton,\n    tableAlignTableButton,\n    tableDeleteButton,\n    tableInsertButton,\n    tableMergeButton,\n    tableSplitButton,\n} from './ribbonButtons/contentModel/tableEditButtons';\n\nconst styles = require('./StandaloneEditorMainPane.scss');\n\nconst LightTheme: PartialTheme = {\n    palette: {\n        themePrimary: '#4466aa',\n        themeLighterAlt: '#f6f8fc',\n        themeLighter: '#dae2f2',\n        themeLight: '#bccae6',\n        themeTertiary: '#839bcd',\n        themeSecondary: '#5575b5',\n        themeDarkAlt: '#3e5c9a',\n        themeDark: '#344e82',\n        themeDarker: '#263960',\n        neutralLighterAlt: '#faf9f8',\n        neutralLighter: '#f3f2f1',\n        neutralLight: '#edebe9',\n        neutralQuaternaryAlt: '#e1dfdd',\n        neutralQuaternary: '#d0d0d0',\n        neutralTertiaryAlt: '#c8c6c4',\n        neutralTertiary: '#c2c2c2',\n        neutralSecondary: '#858585',\n        neutralPrimaryAlt: '#4b4b4b',\n        neutralPrimary: '#333333',\n        neutralDark: '#272727',\n        black: '#1d1d1d',\n        white: '#ffffff',\n    },\n};\n\nconst DarkTheme: PartialTheme = {\n    palette: {\n        themePrimary: '#335599',\n        themeLighterAlt: '#f4f6fb',\n        themeLighter: '#d5deef',\n        themeLight: '#b3c2e0',\n        themeTertiary: '#748ec2',\n        themeSecondary: '#4464a5',\n        themeDarkAlt: '#2d4c8a',\n        themeDark: '#264074',\n        themeDarker: '#1c2f56',\n        neutralLighterAlt: '#faf9f8',\n        neutralLighter: '#f3f2f1',\n        neutralLight: '#edebe9',\n        neutralQuaternaryAlt: '#e1dfdd',\n        neutralQuaternary: '#d0d0d0',\n        neutralTertiaryAlt: '#c8c6c4',\n        neutralTertiary: '#c2c2c2',\n        neutralSecondary: '#858585',\n        neutralPrimaryAlt: '#4b4b4b',\n        neutralPrimary: '#333333',\n        neutralDark: '#272727',\n        black: '#1d1d1d',\n        white: '#ffffff',\n    },\n};\n\ninterface ContentModelMainPaneState extends MainPaneBaseState {\n    editorCreator: (div: HTMLDivElement, options: EditorOptions) => IEditor;\n}\n\nclass ContentModelEditorMainPane extends MainPaneBase<ContentModelMainPaneState> {\n    private formatStatePlugin: ContentModelFormatStatePlugin;\n    private editorOptionPlugin: ContentModelEditorOptionsPlugin;\n    private eventViewPlugin: ContentModelEventViewPlugin;\n    private apiPlaygroundPlugin: ApiPlaygroundPlugin;\n    private contentModelPanePlugin: ContentModelPanePlugin;\n    private contentModelEditPlugin: EditPlugin;\n    private contentModelRibbonPlugin: RibbonPlugin;\n    private contentAutoFormatPlugin: AutoFormatPlugin;\n    private snapshotPlugin: ContentModelSnapshotPlugin;\n    private shortcutPlugin: ShortcutPlugin;\n    private formatPainterPlugin: ContentModelFormatPainterPlugin;\n    private tableEditPlugin: TableEditPlugin;\n    private snapshots: Snapshots<Snapshot>;\n    private buttons: ContentModelRibbonButton<any>[] = [\n        formatPainterButton,\n        boldButton,\n        italicButton,\n        underlineButton,\n        fontButton,\n        fontSizeButton,\n        increaseFontSizeButton,\n        decreaseFontSizeButton,\n        textColorButton,\n        backgroundColorButton,\n        bulletedListButton,\n        numberedListButton,\n        decreaseIndentButton,\n        increaseIndentButton,\n        blockQuoteButton,\n        alignLeftButton,\n        alignCenterButton,\n        alignRightButton,\n        alignJustifyButton,\n        insertLinkButton,\n        removeLinkButton,\n        insertTableButton,\n        insertImageButton,\n        superscriptButton,\n        subscriptButton,\n        strikethroughButton,\n        setHeadingLevelButton,\n        codeButton,\n        ltrButton,\n        rtlButton,\n        undoButton,\n        redoButton,\n        clearFormatButton,\n        setBulletedListStyleButton,\n        setNumberedListStyleButton,\n        listStartNumberButton,\n        formatTableButton,\n        setTableCellShadeButton,\n        setTableHeaderButton,\n        tableInsertButton,\n        tableDeleteButton,\n        tableMergeButton,\n        tableSplitButton,\n        tableAlignCellButton,\n        tableAlignTableButton,\n        tableBorderApplyButton,\n        tableBorderColorButton,\n        tableBorderWidthButton,\n        tableBorderStyleButton,\n        imageBorderColorButton,\n        imageBorderWidthButton,\n        imageBorderStyleButton,\n        imageBorderRemoveButton,\n        changeImageButton,\n        imageBoxShadowButton,\n        spacingButton,\n        spaceBeforeButton,\n        spaceAfterButton,\n        pasteButton,\n        darkMode,\n        zoom,\n        exportContent,\n    ];\n\n    constructor(props: {}) {\n        super(props);\n\n        this.snapshots = {\n            snapshots: [],\n            totalSize: 0,\n            currentIndex: -1,\n            autoCompleteIndex: -1,\n            maxSize: 1e7,\n        };\n\n        this.formatStatePlugin = new ContentModelFormatStatePlugin();\n        this.editorOptionPlugin = new ContentModelEditorOptionsPlugin();\n        this.eventViewPlugin = new ContentModelEventViewPlugin();\n        this.apiPlaygroundPlugin = new ApiPlaygroundPlugin();\n        this.snapshotPlugin = new ContentModelSnapshotPlugin(this.snapshots);\n        this.contentModelPanePlugin = new ContentModelPanePlugin();\n        this.contentModelEditPlugin = new EditPlugin();\n        this.contentAutoFormatPlugin = new AutoFormatPlugin();\n        this.shortcutPlugin = new ShortcutPlugin();\n        this.contentModelRibbonPlugin = new ContentModelRibbonPlugin();\n        this.formatPainterPlugin = new ContentModelFormatPainterPlugin();\n        this.tableEditPlugin = new TableEditPlugin();\n        this.state = {\n            showSidePane: window.location.hash != '',\n            popoutWindow: null,\n            initState: this.editorOptionPlugin.getBuildInPluginState(),\n            scale: 1,\n            isDarkMode: this.themeMatch?.matches || false,\n            editorCreator: null,\n            isRtl: false,\n            tableBorderFormat: {\n                width: '1px',\n                style: 'solid',\n                color: '#ABABAB',\n            },\n        };\n    }\n\n    getStyles(): Record<string, string> {\n        return styles;\n    }\n\n    renderTitleBar() {\n        return <TitleBar className={styles.noGrow} mode=\"standalone\" />;\n    }\n\n    renderRibbon(isPopout: boolean) {\n        const buttons = isPopout ? this.buttons : this.buttons.concat([popout]);\n        return (\n            <ContentModelRibbon\n                buttons={buttons}\n                plugin={this.contentModelRibbonPlugin}\n                dir={this.state.isRtl ? 'rtl' : 'ltr'}\n            />\n        );\n    }\n\n    renderSidePane(fullWidth: boolean) {\n        const styles = this.getStyles();\n\n        return (\n            <SidePane\n                ref={this.sidePane}\n                plugins={this.getSidePanePlugins()}\n                mode=\"standalone\"\n                className={`main-pane ${styles.sidePane} ${\n                    fullWidth ? styles.sidePaneFullWidth : ''\n                }`}\n            />\n        );\n    }\n\n    resetEditor() {\n        this.setState({\n            editorCreator: (div: HTMLDivElement, options: EditorOptions) =>\n                new Editor(div, {\n                    ...options,\n                    cacheModel: this.state.initState.cacheModel,\n                }),\n        });\n    }\n\n    renderEditor() {\n        const styles = this.getStyles();\n        const editorStyles = {\n            transform: `scale(${this.state.scale})`,\n            transformOrigin: this.state.isRtl ? 'right top' : 'left top',\n            height: `calc(${100 / this.state.scale}%)`,\n            width: `calc(${100 / this.state.scale}%)`,\n        };\n        const format = this.state.initState.defaultFormat;\n        const defaultFormat: ContentModelSegmentFormat = {\n            fontWeight: format.bold ? 'bold' : undefined,\n            italic: format.italic || undefined,\n            underline: format.underline || undefined,\n            fontFamily: format.fontFamily || undefined,\n            fontSize: format.fontSize || undefined,\n            textColor: format.textColors?.lightModeColor || format.textColor || undefined,\n            backgroundColor:\n                format.backgroundColors?.lightModeColor || format.backgroundColor || undefined,\n        };\n\n        this.updateContentPlugin.forceUpdate();\n\n        return (\n            <div className={styles.editorContainer} id=\"EditorContainer\">\n                <div style={editorStyles}>\n                    {this.state.editorCreator && (\n                        <ContentModelRooster\n                            id={MainPaneBase.editorDivId}\n                            className={styles.editor}\n                            plugins={[\n                                this.contentModelRibbonPlugin,\n                                this.formatPainterPlugin,\n                                this.tableEditPlugin,\n                                this.contentModelEditPlugin,\n                                this.contentAutoFormatPlugin,\n                                this.shortcutPlugin,\n                            ]}\n                            defaultSegmentFormat={defaultFormat}\n                            inDarkMode={this.state.isDarkMode}\n                            getDarkColor={getDarkColor}\n                            experimentalFeatures={this.state.initState.experimentalFeatures}\n                            snapshots={this.snapshotPlugin.getSnapshots()}\n                            trustedHTMLHandler={trustedHTMLHandler}\n                            initialContent={this.content}\n                            editorCreator={this.state.editorCreator}\n                            dir={this.state.isRtl ? 'rtl' : 'ltr'}\n                        />\n                    )}\n                </div>\n            </div>\n        );\n    }\n\n    getTheme(isDark: boolean): PartialTheme {\n        return isDark ? DarkTheme : LightTheme;\n    }\n\n    private getSidePanePlugins() {\n        return [\n            this.formatStatePlugin,\n            this.editorOptionPlugin,\n            this.eventViewPlugin,\n            this.apiPlaygroundPlugin,\n            this.snapshotPlugin,\n            this.contentModelPanePlugin,\n        ];\n    }\n}\n\nexport function mount(parent: HTMLElement) {\n    ReactDOM.render(<ContentModelEditorMainPane />, parent);\n}\n","import * as Color from 'color';\nimport * as React from 'react';\nimport { getComputedStyle } from 'roosterjs-editor-dom';\n\nconst styles = require('./ColorPicker.scss');\n\nexport interface ColorPickerProps {\n    initColor: Color;\n    onSelect?: (color: Color) => void;\n    className?: string;\n}\n\nconst enum Keys {\n    PageUp = 33,\n    PageDown = 34,\n    End = 35,\n    Home = 36,\n    Left = 37,\n    Up = 38,\n    Right = 39,\n    Down = 40,\n}\n\nexport default function ColorPicker(props: ColorPickerProps): JSX.Element {\n    const hueBar = React.useRef<HTMLDivElement>(null);\n    const picker = React.useRef<HTMLDivElement>(null);\n    const hsv = props.initColor.hsv();\n    const [hue, setHue] = React.useState(hsv.hue());\n    const [saturation, setSaturation] = React.useState(hsv.saturationv());\n    const [value, setValue] = React.useState(hsv.value());\n    const isRtl = getComputedStyle(document.body, 'direction') == 'rtl';\n\n    const onMouseDownHueBar = React.useCallback((e: React.MouseEvent<EventTarget>) => {\n        startDrag(hueBar.current!, x => setHue(x * 360));\n    }, []);\n\n    const onMouseDownPicker = React.useCallback((e: React.MouseEvent<EventTarget>) => {\n        startDrag(picker.current!, (x, y) => {\n            setSaturation(x * 100);\n            setValue(100 - y * 100);\n        });\n    }, []);\n\n    const onChangeHue = React.useCallback(\n        (e: React.KeyboardEvent<EventTarget>) => {\n            let newHue = hue;\n            switch (e.which) {\n                case Keys.Left:\n                    newHue += isRtl ? 1 : -1;\n                    break;\n                case Keys.Up:\n                    newHue--;\n                    break;\n                case Keys.Right:\n                    newHue += isRtl ? -1 : 1;\n                    break;\n                case Keys.Down:\n                    newHue++;\n                    break;\n                case Keys.PageUp:\n                    newHue -= 10;\n                    break;\n                case Keys.PageDown:\n                    newHue += 10;\n                    break;\n                case Keys.Home:\n                    newHue = 0;\n                    break;\n                case Keys.End:\n                    newHue = 360;\n                    break;\n            }\n            setHue(Math.max(Math.min(newHue, 360), 0));\n        },\n        [hue, isRtl]\n    );\n\n    const onChangeColor = React.useCallback(\n        (e: React.KeyboardEvent<EventTarget>) => {\n            let newSaturation = saturation;\n            let newValue = value;\n            switch (e.which) {\n                case Keys.Left:\n                    newSaturation += isRtl ? 1 : -1;\n                    break;\n                case Keys.Right:\n                    newSaturation += isRtl ? -1 : 1;\n                    break;\n                case Keys.Home:\n                    newSaturation = 0;\n                    break;\n                case Keys.End:\n                    newSaturation = 100;\n                    break;\n                case Keys.Up:\n                    newValue++;\n                    break;\n                case Keys.Down:\n                    newValue--;\n                    break;\n                case Keys.PageUp:\n                    newValue += 10;\n                    break;\n                case Keys.PageDown:\n                    newValue -= 10;\n                    break;\n            }\n            setSaturation(Math.max(Math.min(newSaturation, 100), 0));\n            setValue(Math.max(Math.min(newValue, 100), 0));\n        },\n        [saturation, value, isRtl]\n    );\n\n    React.useEffect(() => {\n        props.onSelect?.(props.initColor);\n    }, []);\n\n    React.useEffect(() => {\n        props.onSelect?.(Color.hsv(hue, saturation, value).rgb());\n    }, [hue, saturation, value]);\n\n    return (\n        <div className={styles.container}>\n            <div\n                tabIndex={0}\n                className={styles.picker}\n                ref={picker}\n                style={{\n                    backgroundColor: Color.hsv(hue, 100, 100).rgb().toString(),\n                }}\n                onKeyDown={onChangeColor}\n                onMouseDown={onMouseDownPicker}>\n                <div className={styles.layer1}>\n                    <div className={styles.layer2} />\n                </div>\n                <div\n                    className={styles.currentColor}\n                    style={{\n                        left: saturation + '%',\n                        top: 100 - value + '%',\n                    }}>\n                    <div />\n                </div>\n            </div>\n\n            <div\n                className={styles.newColor}\n                style={{ backgroundColor: Color.hsv(hue, saturation, value).rgb().toString() }}\n            />\n            <div\n                className={styles.initColor}\n                style={{ backgroundColor: props.initColor.toString() }}\n            />\n\n            <div\n                className={styles.hueBar}\n                ref={hueBar}\n                tabIndex={0}\n                onMouseDown={onMouseDownHueBar}\n                onKeyDown={onChangeHue}>\n                <div\n                    className={styles.currentColor}\n                    style={{\n                        left: hue / 3.6 + '%',\n                    }}>\n                    <div />\n                </div>\n            </div>\n        </div>\n    );\n}\n\nfunction startDrag(element: HTMLElement, callback: (x: number, y: number) => void) {\n    const rect = element.getBoundingClientRect();\n    const document = element.ownerDocument;\n\n    const onMouseChange = (e: MouseEvent) => {\n        const left = e.pageX - rect.left;\n        const top = e.pageY - rect.top;\n        let x = Math.round((left * 100) / rect.width) / 100;\n        let y = Math.round((top * 100) / rect.height) / 100;\n        x = Math.min(Math.max(x, 0), 1);\n        y = Math.min(Math.max(y, 0), 1);\n\n        callback(x, y);\n\n        if (e.type == 'mouseup') {\n            document.removeEventListener('mousemove', onMouseChange, true /*useCapture*/);\n            document.removeEventListener('mouseup', onMouseChange, true /*useCapture*/);\n        } else {\n            e.stopPropagation();\n            e.preventDefault();\n        }\n    };\n\n    document.addEventListener('mousemove', onMouseChange, true /*useCapture*/);\n    document.addEventListener('mouseup', onMouseChange, true /*useCapture*/);\n}\n","import * as React from 'react';\nimport { css } from '@fluentui/react/lib/Utilities';\n\nconst styles = require('./ButtonGroup.scss');\n\nexport function ButtonGroup(props: {\n    hasFormat: boolean;\n    hasContent: boolean;\n    hasDataset: boolean;\n    bodyState: 'children' | 'format' | 'json' | 'collapsed' | 'dataset';\n    toggleVisual: () => void;\n    toggleFormat: () => void;\n    toggleJson: () => void;\n    toggleMetadata: () => void;\n}) {\n    const {\n        hasContent,\n        hasFormat,\n        hasDataset,\n        bodyState,\n        toggleFormat,\n        toggleJson,\n        toggleVisual,\n        toggleMetadata,\n    } = props;\n\n    return (\n        <div>\n            {hasContent ? (\n                <button\n                    onClick={toggleVisual}\n                    title=\"Content\"\n                    className={css(styles.button, {\n                        [styles.buttonChecked]: bodyState == 'children',\n                    })}>\n                    \n                </button>\n            ) : null}\n            {hasFormat ? (\n                <button\n                    onClick={toggleFormat}\n                    title=\"Format\"\n                    className={css(styles.button, {\n                        [styles.buttonChecked]: bodyState == 'format',\n                    })}>\n                    \n                </button>\n            ) : null}\n            {hasDataset ? (\n                <button\n                    onClick={toggleMetadata}\n                    title=\"Dataset\"\n                    className={css(styles.button, {\n                        [styles.buttonChecked]: bodyState == 'dataset',\n                    })}>\n                    \n                </button>\n            ) : null}\n            <button\n                onClick={toggleJson}\n                title=\"JSON\"\n                className={css(styles.button, {\n                    [styles.buttonChecked]: bodyState == 'json',\n                })}>\n                \n            </button>\n        </div>\n    );\n}\n","import * as React from 'react';\nimport { ButtonGroup } from './ButtonGroup';\nimport { ContentModelJson } from './model/ContentModelJson';\nimport { css } from '@fluentui/react/lib/Utilities';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\nimport { useProperty } from '../hooks/useProperty';\nimport {\n    ContentModelBlockWithCache,\n    ContentModelEntity,\n    ContentModelGeneralBlock,\n    ContentModelWithDataset,\n    DatasetFormat,\n} from 'roosterjs-content-model-types';\n\nconst styles = require('./ContentModelView.scss');\nconst MetadataKey = 'editingInfo';\n\nexport function ContentModelView(props: {\n    className: string;\n    title: string;\n    subTitle?: string;\n    hasSelection?: boolean;\n    isSelected?: boolean;\n    jsonSource: Object;\n    getContent?: (() => JSX.Element) | null;\n    getFormat?: (() => JSX.Element) | null;\n    getMetadata?: (() => JSX.Element) | null;\n    isExpanded?: boolean;\n}) {\n    const {\n        title,\n        subTitle,\n        isExpanded,\n        className,\n        hasSelection,\n        isSelected: isSelection,\n        jsonSource,\n        getContent,\n        getFormat,\n        getMetadata,\n    } = props;\n    const [bodyState, setBodyState] = useProperty<\n        'collapsed' | 'children' | 'format' | 'json' | 'dataset'\n    >(isExpanded ? 'children' : 'collapsed');\n    const highlightBorder = React.useRef<HTMLElement>(null);\n\n    const toggleVisual = React.useCallback(() => {\n        setBodyState(bodyState == 'children' ? 'collapsed' : 'children');\n    }, [bodyState]);\n\n    const toggleFormat = React.useCallback(() => {\n        setBodyState(bodyState == 'format' ? 'collapsed' : 'format');\n    }, [bodyState]);\n\n    const toggleJson = React.useCallback(() => {\n        setBodyState(bodyState == 'json' ? 'collapsed' : 'json');\n    }, [bodyState]);\n\n    const toggleDataset = React.useCallback(() => {\n        setBodyState(bodyState == 'dataset' ? 'collapsed' : 'dataset');\n    }, [bodyState]);\n\n    const getCachedElement = React.useCallback(() => {\n        return (\n            (jsonSource as ContentModelBlockWithCache)?.cachedElement ||\n            (jsonSource as ContentModelGeneralBlock)?.element ||\n            (jsonSource as ContentModelEntity)?.wrapper\n        );\n    }, [jsonSource]);\n    const onMouseOver = React.useCallback(\n        (e: React.MouseEvent) => {\n            const cachedElement = getCachedElement();\n            const doc = cachedElement?.ownerDocument;\n\n            if (cachedElement && doc) {\n                onMouseOut();\n\n                const rect = cachedElement.getBoundingClientRect();\n                const div = doc.createElement('div');\n\n                if (div) {\n                    div.style.position = 'fixed';\n                    div.style.zIndex = '10000';\n                    div.style.left = rect.left + 'px';\n                    div.style.top = rect.top + 'px';\n                    div.style.width = rect.width + 'px';\n                    div.style.height = rect.height + 'px';\n                    div.style.border = 'solid 2px #8888ff';\n                    div.style.boxSizing = 'border-box';\n                    doc.body.appendChild(div);\n\n                    highlightBorder.current = div;\n                }\n\n                e.stopPropagation();\n            }\n        },\n        [getCachedElement]\n    );\n    const onMouseOut = React.useCallback(() => {\n        if (highlightBorder.current) {\n            highlightBorder.current.parentNode?.removeChild(highlightBorder.current);\n            highlightBorder.current = null;\n        }\n    }, [getCachedElement]);\n\n    const dataset = (jsonSource as ContentModelWithDataset<any>).dataset;\n\n    React.useEffect(() => () => {\n        onMouseOut();\n    });\n\n    return (\n        <div\n            className={css(styles.modelWrapper, className, {\n                [styles.childSelected]: hasSelection,\n                [styles.selected]: isSelection,\n            })}\n            onMouseOver={onMouseOver}\n            onMouseOut={onMouseOut}>\n            <div className={styles.titleBar}>\n                <div\n                    className={css(styles.title, {\n                        [styles.titleWithBorder]: bodyState != 'collapsed',\n                    })}>\n                    {title}\n                </div>\n                <div className={styles.buttonGroup}>\n                    <ButtonGroup\n                        hasContent={!!getContent}\n                        hasFormat={!!getFormat}\n                        hasDataset={!!dataset}\n                        bodyState={bodyState}\n                        toggleJson={toggleJson}\n                        toggleFormat={toggleFormat}\n                        toggleVisual={toggleVisual}\n                        toggleMetadata={toggleDataset}\n                    />\n                </div>\n                <div\n                    className={css(styles.subTitle, {\n                        [styles.titleWithBorder]: bodyState != 'collapsed',\n                    })}\n                    title={subTitle || ''}>\n                    {subTitle || '\\u00a0'}\n                </div>\n            </div>\n            {bodyState == 'json' ? (\n                <div className={styles.expandedBody}>\n                    <ContentModelJson jsonSource={jsonSource} />\n                </div>\n            ) : bodyState == 'children' && !!getContent ? (\n                <div className={styles.expandedBody}>{getContent()}</div>\n            ) : bodyState == 'format' && !!getFormat ? (\n                <div className={styles.expandedBody}>{getFormat()}</div>\n            ) : bodyState == 'dataset' && !!dataset ? (\n                <div className={styles.expandedBody}>\n                    <DatasetView dataset={dataset} getMetadata={getMetadata} />\n                </div>\n            ) : null}\n        </div>\n    );\n}\n\nfunction DatasetView(props: { dataset: DatasetFormat; getMetadata?: (() => JSX.Element) | null }) {\n    const { dataset, getMetadata } = props;\n\n    return (\n        <>\n            {getObjectKeys(dataset).map(name =>\n                !getMetadata || name != MetadataKey ? (\n                    <DatasetItemView dataset={dataset} name={name} />\n                ) : null\n            )}\n            {getMetadata ? (\n                <>\n                    <div>Metadata:</div>\n                    {getMetadata()}\n                </>\n            ) : null}\n        </>\n    );\n}\n\nfunction DatasetItemView(props: { dataset: DatasetFormat; name: string }) {\n    const { dataset, name } = props;\n    const [value, setValue] = useProperty(dataset[name]);\n    const inputRef = React.useRef<HTMLInputElement>(null);\n    const onChange = React.useCallback(() => {\n        const newValue = inputRef.current.value;\n        dataset[name] = newValue;\n        setValue(newValue);\n    }, [value, setValue]);\n\n    return (\n        <div>\n            {name}\n            <input type=\"text\" ref={inputRef} value={value} onChange={onChange} />\n        </div>\n    );\n}\n","import * as React from 'react';\nimport { BackgroundColorFormatRenderer } from './formatPart/BackgroundColorFormatRenderer';\nimport { BorderFormatRenderers } from './formatPart/BorderFormatRenderers';\nimport { ContentModelBlockFormat, ContentModelSegmentFormat } from 'roosterjs-content-model-types';\nimport { DirectionFormatRenderer } from './formatPart/DirectionFormatRenderer';\nimport { FormatRenderer } from './utils/FormatRenderer';\nimport { FormatView } from './FormatView';\nimport { HtmlAlignFormatRenderer } from './formatPart/HtmlAlignFormatRenderer';\nimport { LineHeightFormatRenderer } from './formatPart/LineHeightFormatRenderer';\nimport { MarginFormatRenderer } from './formatPart/MarginFormatRenderer';\nimport { PaddingFormatRenderer } from './formatPart/PaddingFormatRenderer';\nimport { TextAlignFormatRenderer } from './formatPart/TextAlignFormatRenderer';\nimport { TextIndentFormatRenderer } from './formatPart/TextIndentFormatRenderer';\nimport { WhiteSpaceFormatRenderer } from './formatPart/WhiteSpaceFormatRenderer';\n\nconst BlockFormatRenders: FormatRenderer<ContentModelBlockFormat>[] = [\n    BackgroundColorFormatRenderer,\n    DirectionFormatRenderer,\n    TextAlignFormatRenderer,\n    HtmlAlignFormatRenderer,\n    MarginFormatRenderer,\n    PaddingFormatRenderer,\n    LineHeightFormatRenderer,\n    WhiteSpaceFormatRenderer,\n    TextIndentFormatRenderer,\n    ...BorderFormatRenderers,\n];\n\nexport function BlockFormatView(props: { format: ContentModelSegmentFormat }) {\n    const { format } = props;\n    return <FormatView format={format} renderers={BlockFormatRenders} />;\n}\n","import * as React from 'react';\nimport { FormatRenderer } from './utils/FormatRenderer';\n\nconst styles = require('./FormatView.scss');\n\nexport function FormatView<T>(props: {\n    format: T;\n    renderers: FormatRenderer<T>[];\n    onUpdate?: () => void;\n}) {\n    const { format, renderers, onUpdate } = props;\n\n    return <div className={styles.formatTable}>{renderers.map(x => x(format, onUpdate))}</div>;\n}\n","import * as React from 'react';\nimport { ContentModelHyperLinkFormat, LinkFormat } from 'roosterjs-content-model-types';\nimport { createTextFormatRenderer } from './utils/createTextFormatRenderer';\nimport { DisplayFormatRenderer } from './formatPart/DisplayFormatRenderer';\nimport { FormatRenderer } from './utils/FormatRenderer';\nimport { FormatView } from './FormatView';\nimport { MarginFormatRenderer } from './formatPart/MarginFormatRenderer';\nimport { PaddingFormatRenderer } from './formatPart/PaddingFormatRenderer';\nimport { TextColorFormatRenderer } from './formatPart/TextColorFormatRenderer';\nimport { UnderlineFormatRenderer } from './formatPart/BasicFormatRenderers';\n\nconst LinkFormatRenderers: FormatRenderer<ContentModelHyperLinkFormat>[] = [\n    createTextFormatRenderer<LinkFormat>(\n        'Name',\n        format => format.name,\n        (format, value) => (format.name = value)\n    ),\n    createTextFormatRenderer<LinkFormat>(\n        'Href',\n        format => format.href,\n        (format, value) => (format.href = value)\n    ),\n    createTextFormatRenderer<LinkFormat>(\n        'Target',\n        format => format.target,\n        (format, value) => (format.target = value)\n    ),\n    createTextFormatRenderer<LinkFormat>(\n        'AnchorId',\n        format => format.anchorId,\n        (format, value) => (format.anchorId = value)\n    ),\n    createTextFormatRenderer<LinkFormat>(\n        'AnchorClass',\n        format => format.anchorClass,\n        (format, value) => (format.anchorClass = value)\n    ),\n    createTextFormatRenderer<LinkFormat>(\n        'AnchorTitle',\n        format => format.anchorTitle,\n        (format, value) => (format.anchorTitle = value)\n    ),\n    createTextFormatRenderer<LinkFormat>(\n        'Relationship',\n        format => format.relationship,\n        (format, value) => (format.relationship = value)\n    ),\n    TextColorFormatRenderer,\n    UnderlineFormatRenderer,\n    DisplayFormatRenderer,\n    MarginFormatRenderer,\n    PaddingFormatRenderer,\n];\n\nexport function LinkFormatView(props: { format: LinkFormat }) {\n    const { format } = props;\n    return <FormatView format={format} renderers={LinkFormatRenderers} />;\n}\n","import * as React from 'react';\nimport { ContentModelWithDataset } from 'roosterjs-content-model-types';\nimport { FormatRenderer } from './utils/FormatRenderer';\n\nconst styles = require('./FormatView.scss');\n\nexport function MetadataView<T>(props: {\n    model: ContentModelWithDataset<T>;\n    renderers: FormatRenderer<T>[];\n    updater: (model: ContentModelWithDataset<T>, callback: (format: T | null) => T | null) => void;\n}) {\n    const { model, renderers, updater } = props;\n    const metadata = React.useRef<T>(null);\n\n    const onUpdate = React.useCallback(() => {\n        updater(model, () => metadata.current);\n    }, [model]);\n\n    let result: JSX.Element | null = null;\n\n    updater(model, format => {\n        metadata.current = format;\n        result = format ? (\n            <div className={styles.formatTable}>{renderers.map(x => x(format, onUpdate))}</div>\n        ) : null;\n\n        return format;\n    });\n\n    return result;\n}\n","import * as React from 'react';\nimport { BackgroundColorFormatRenderer } from './formatPart/BackgroundColorFormatRenderer';\nimport { ContentModelSegmentFormat } from 'roosterjs-content-model-types';\nimport { FontFamilyFormatRenderer } from './formatPart/FontFamilyFormatRenderer';\nimport { FontSizeFormatRenderer } from './formatPart/FontSizeFormatRenderer';\nimport { FormatRenderer } from './utils/FormatRenderer';\nimport { FormatView } from './FormatView';\nimport { LetterSpacingFormatRenderer } from './formatPart/LetterSpacingFormatRenderer';\nimport { LineHeightFormatRenderer } from './formatPart/LineHeightFormatRenderer';\nimport { TextColorFormatRenderer } from './formatPart/TextColorFormatRenderer';\nimport {\n    BoldFormatRenderer,\n    ItalicFormatRenderer,\n    StrikeFormatRenderer,\n    UnderlineFormatRenderer,\n    SuperOrSubScriptFormatRenderer,\n} from './formatPart/BasicFormatRenderers';\n\nconst SegmentFormatRenders: FormatRenderer<ContentModelSegmentFormat>[] = [\n    TextColorFormatRenderer,\n    BackgroundColorFormatRenderer,\n    FontSizeFormatRenderer,\n    FontFamilyFormatRenderer,\n    BoldFormatRenderer,\n    ItalicFormatRenderer,\n    UnderlineFormatRenderer,\n    StrikeFormatRenderer,\n    SuperOrSubScriptFormatRenderer,\n    LineHeightFormatRenderer,\n    LetterSpacingFormatRenderer,\n];\n\nexport function SegmentFormatView(props: { format: ContentModelSegmentFormat }) {\n    const { format } = props;\n    return <FormatView format={format} renderers={SegmentFormatRenders} />;\n}\n","import { BackgroundColorFormat } from 'roosterjs-content-model-types';\nimport { createColorFormatRenderer } from '../utils/createColorFormatRender';\nimport { FormatRenderer } from '../utils/FormatRenderer';\n\nexport const BackgroundColorFormatRenderer: FormatRenderer<BackgroundColorFormat> = createColorFormatRenderer<\n    BackgroundColorFormat\n>(\n    'Back color',\n    format => format.backgroundColor,\n    (format, value) => (format.backgroundColor = value)\n);\n","import { createCheckboxFormatRenderer } from '../utils/createCheckboxFormatRenderer';\nimport { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport {\n    BoldFormat,\n    ItalicFormat,\n    StrikeFormat,\n    SuperOrSubScriptFormat,\n    UnderlineFormat,\n} from 'roosterjs-content-model-types';\n\nexport const BoldFormatRenderer: FormatRenderer<BoldFormat> = createTextFormatRenderer<BoldFormat>(\n    'Bold',\n    format => format.fontWeight,\n    (format, value) => (format.fontWeight = value)\n);\n\nexport const ItalicFormatRenderer: FormatRenderer<ItalicFormat> = createCheckboxFormatRenderer<\n    ItalicFormat\n>(\n    'Italic',\n    format => format.italic,\n    (format, value) => (format.italic = value)\n);\n\nexport const UnderlineFormatRenderer: FormatRenderer<UnderlineFormat> = createCheckboxFormatRenderer<\n    UnderlineFormat\n>(\n    'Underline',\n    format => format.underline,\n    (format, value) => (format.underline = value)\n);\n\nexport const StrikeFormatRenderer: FormatRenderer<StrikeFormat> = createCheckboxFormatRenderer<\n    StrikeFormat\n>(\n    'Strike',\n    format => format.strikethrough,\n    (format, value) => (format.strikethrough = value)\n);\n\nexport const SuperOrSubScriptFormatRenderer: FormatRenderer<SuperOrSubScriptFormat> = createTextFormatRenderer<\n    SuperOrSubScriptFormat\n>(\n    'SuperOrSubScript',\n    format => format.superOrSubScriptSequence,\n    (format, value) => (format.superOrSubScriptSequence = value)\n);\n","import { BorderBoxFormat } from 'roosterjs-content-model-types';\nimport { createCheckboxFormatRenderer } from '../utils/createCheckboxFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\n\nexport const BorderBoxFormatRenderer: FormatRenderer<BorderBoxFormat> = createCheckboxFormatRenderer<\n    BorderBoxFormat\n>(\n    'UseBorderBox',\n    format => format.useBorderBox,\n    (format, value) => (format.useBorderBox = value)\n);\n","import { BorderFormat } from 'roosterjs-content-model-types';\nimport { combineBorderValue, extractBorderValues } from 'roosterjs-content-model-core';\nimport { createDropDownFormatRenderer } from '../utils/createDropDownFormatRenderer';\nimport { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\n\ntype BorderStyle =\n    | 'dashed'\n    | 'dotted'\n    | 'double'\n    | 'groove'\n    | 'none'\n    | 'outset'\n    | 'solid'\n    | 'hidden'\n    | 'ridge'\n    | 'inset';\nconst BorderStyles: BorderStyle[] = [\n    'none',\n    'hidden',\n    'dotted',\n    'dashed',\n    'solid',\n    'double',\n    'groove',\n    'ridge',\n    'inset',\n    'outset',\n];\n\nfunction createBorderRenderer(position: keyof BorderFormat): FormatRenderer<BorderFormat>[] {\n    return [\n        createTextFormatRenderer<BorderFormat>(\n            position + 'Width',\n            format => extractBorderValues(format[position]).width,\n            (format, newValue) => {\n                const border = extractBorderValues(format[position]);\n                border.width = newValue;\n                format[position] = combineBorderValue(border);\n            }\n        ),\n        createDropDownFormatRenderer<BorderFormat, BorderStyle>(\n            position + 'Style',\n            BorderStyles,\n            format => extractBorderValues(format[position]).style as BorderStyle,\n            (format, newValue) => {\n                const border = extractBorderValues(format[position]);\n                border.style = newValue;\n                format[position] = combineBorderValue(border);\n            }\n        ),\n        createTextFormatRenderer<BorderFormat>(\n            position + 'Color',\n            format => extractBorderValues(format[position]).color,\n            (format, newValue) => {\n                const border = extractBorderValues(format[position]);\n                border.color = newValue;\n                format[position] = combineBorderValue(border);\n            }\n        ),\n    ];\n}\n\nexport const BorderFormatRenderers: FormatRenderer<BorderFormat>[] = [\n    ...createBorderRenderer('borderTop'),\n    ...createBorderRenderer('borderRight'),\n    ...createBorderRenderer('borderBottom'),\n    ...createBorderRenderer('borderLeft'),\n];\n","import { createDropDownFormatRenderer } from '../utils/createDropDownFormatRenderer';\nimport { DirectionFormat } from 'roosterjs-content-model-types';\n\nexport const DirectionFormatRenderer = createDropDownFormatRenderer<DirectionFormat, 'ltr' | 'rtl'>(\n    'Direction',\n    ['ltr', 'rtl'],\n    format => format.direction,\n    (format, value) => (format.direction = value)\n);\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { DisplayFormat } from 'roosterjs-content-model-types';\nimport { FormatRenderer } from '../utils/FormatRenderer';\n\nexport const DisplayFormatRenderer: FormatRenderer<DisplayFormat> = createTextFormatRenderer<\n    DisplayFormat\n>(\n    'Display',\n    format => format.display,\n    (format, value) => (format.display = value)\n);\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FloatFormat } from 'roosterjs-content-model-types';\nimport { FormatRenderer } from '../utils/FormatRenderer';\n\nexport const FloatFormatRenderer: FormatRenderer<FloatFormat> = createTextFormatRenderer<\n    FloatFormat\n>(\n    'Float',\n    format => format.float,\n    (format, value) => (format.float = value)\n);\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FontFamilyFormat } from 'roosterjs-content-model-types';\nimport { FormatRenderer } from '../utils/FormatRenderer';\n\nexport const FontFamilyFormatRenderer: FormatRenderer<FontFamilyFormat> = createTextFormatRenderer<\n    FontFamilyFormat\n>(\n    'Font family',\n    format => format.fontFamily,\n    (format, value) => {\n        format.fontFamily = value;\n        return undefined;\n    }\n);\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FontSizeFormat } from 'roosterjs-content-model-types';\nimport { FormatRenderer } from '../utils/FormatRenderer';\n\nexport const FontSizeFormatRenderer: FormatRenderer<FontSizeFormat> = createTextFormatRenderer<\n    FontSizeFormat\n>(\n    'Font size',\n    format => format.fontSize,\n    (format, value) => {\n        format.fontSize = value;\n        return undefined;\n    }\n);\n","import { createDropDownFormatRenderer } from '../utils/createDropDownFormatRenderer';\nimport { HtmlAlignFormat } from 'roosterjs-content-model-types';\n\nexport const HtmlAlignFormatRenderer = createDropDownFormatRenderer<\n    HtmlAlignFormat,\n    'start' | 'center' | 'end' | 'justify' | 'initial'\n>(\n    'HTML align',\n    ['start', 'center', 'end'],\n    format => format.htmlAlign,\n    (format, value) => (format.htmlAlign = value)\n);\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { IdFormat } from 'roosterjs-content-model-types';\n\nexport const IdFormatRenderer: FormatRenderer<IdFormat> = createTextFormatRenderer<IdFormat>(\n    'Id',\n    format => format.id,\n    (format, value) => (format.id = value)\n);\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { ImageMetadataFormat } from 'roosterjs-content-model-types';\n\nexport const ImageMetadataFormatRenderers: FormatRenderer<ImageMetadataFormat>[] = [\n    createTextFormatRenderer<ImageMetadataFormat>(\n        'MetadataWidth',\n        format => (format.widthPx || '') + '',\n        (format, value) => (format.widthPx = parseFloat(value)),\n        'number'\n    ),\n    createTextFormatRenderer<ImageMetadataFormat>(\n        'MetadataHeight',\n        format => (format.heightPx || '') + '',\n        (format, value) => (format.heightPx = parseFloat(value)),\n        'number'\n    ),\n    createTextFormatRenderer<ImageMetadataFormat>(\n        'MetadataLeft',\n        format => (format.leftPercent || '') + '',\n        (format, value) => (format.leftPercent = parseFloat(value)),\n        'number'\n    ),\n    createTextFormatRenderer<ImageMetadataFormat>(\n        'MetadataRight',\n        format => (format.rightPercent || '') + '',\n        (format, value) => (format.rightPercent = parseFloat(value)),\n        'number'\n    ),\n    createTextFormatRenderer<ImageMetadataFormat>(\n        'MetadataTop',\n        format => (format.topPercent || '') + '',\n        (format, value) => (format.topPercent = parseFloat(value)),\n        'number'\n    ),\n    createTextFormatRenderer<ImageMetadataFormat>(\n        'MetadataBottom',\n        format => (format.bottomPercent || '') + '',\n        (format, value) => (format.bottomPercent = parseFloat(value)),\n        'number'\n    ),\n    createTextFormatRenderer<ImageMetadataFormat>(\n        'MetadataAngle',\n        format => (format.angleRad || '') + '',\n        (format, value) => (format.angleRad = parseFloat(value)),\n        'number'\n    ),\n    createTextFormatRenderer<ImageMetadataFormat>(\n        'OriginalSrc',\n        format => format.src,\n        () => {},\n        'multiline'\n    ),\n    createTextFormatRenderer<ImageMetadataFormat>(\n        'NaturalWidth',\n        format => (format.naturalWidth || '') + '',\n        () => {},\n        'number'\n    ),\n    createTextFormatRenderer<ImageMetadataFormat>(\n        'NaturalHeight',\n        format => (format.naturalHeight || '') + '',\n        () => {},\n        'number'\n    ),\n];\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { LetterSpacingFormat } from 'roosterjs-content-model-types';\n\nexport const LetterSpacingFormatRenderer: FormatRenderer<LetterSpacingFormat> = createTextFormatRenderer<\n    LetterSpacingFormat\n>(\n    'Letter spacing',\n    format => format.letterSpacing,\n    (format, value) => {\n        format.letterSpacing = value;\n    }\n);\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { LineHeightFormat } from 'roosterjs-content-model-types';\n\nexport const LineHeightFormatRenderer: FormatRenderer<LineHeightFormat> = createTextFormatRenderer<\n    LineHeightFormat\n>(\n    'LineHeight',\n    format => format.lineHeight,\n    (format, value) => (format.lineHeight = value)\n);\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { ListMetadataFormat } from 'roosterjs-content-model-types';\n\nexport const ListMetadataFormatRenderers: FormatRenderer<ListMetadataFormat>[] = [\n    createTextFormatRenderer(\n        'Ordered style',\n        format => format.orderedStyleType + '',\n        (format, value) => (format.orderedStyleType = parseInt(value)),\n        'number'\n    ),\n    createTextFormatRenderer(\n        'Unordered style',\n        format => format.unorderedStyleType + '',\n        (format, value) => (format.unorderedStyleType = parseInt(value)),\n        'number'\n    ),\n];\n","import { createDropDownFormatRenderer } from '../utils/createDropDownFormatRenderer';\nimport { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { ListStyleFormat } from 'roosterjs-content-model-types';\n\nexport const ListStylePositionFormatRenderers: FormatRenderer<ListStyleFormat>[] = [\n    createDropDownFormatRenderer(\n        'List position',\n        ['inside', 'outside'],\n        format => format.listStylePosition,\n        (format, value) => (format.listStylePosition = value)\n    ),\n    createTextFormatRenderer(\n        'List style type',\n        format => format.listStyleType,\n        (format, value) => (format.listStyleType = value)\n    ),\n];\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { ListThreadFormat } from 'roosterjs-content-model-types';\n\nexport const ListThreadFormatRenderers: FormatRenderer<ListThreadFormat>[] = [\n    createTextFormatRenderer(\n        'Start number',\n        format => format.startNumberOverride + '',\n        (format, value) => (format.startNumberOverride = parseInt(value)),\n        'number'\n    ),\n];\n","import { createTextFormatRendererGroup } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { MarginFormat } from 'roosterjs-content-model-types';\n\ntype MarginName = keyof MarginFormat;\nconst MarginNames: MarginName[] = ['marginTop', 'marginRight', 'marginBottom', 'marginLeft'];\n\nexport const MarginFormatRenderer: FormatRenderer<MarginFormat> = createTextFormatRendererGroup<\n    MarginFormat,\n    MarginName\n>(\n    MarginNames,\n    format => MarginNames.map(name => format[name]),\n    (format, name, value) => {\n        format[name] = value;\n    }\n);\n","import { createTextFormatRendererGroup } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { PaddingFormat } from 'roosterjs-content-model-types';\n\ntype PaddingName = keyof PaddingFormat;\nconst PaddingNames: PaddingName[] = ['paddingTop', 'paddingRight', 'paddingBottom', 'paddingLeft'];\n\nexport const PaddingFormatRenderer: FormatRenderer<PaddingFormat> = createTextFormatRendererGroup<\n    PaddingFormat,\n    PaddingName\n>(\n    PaddingNames,\n    format => PaddingNames.map(name => format[name]),\n    (format, name, value) => {\n        format[name] = value;\n    }\n);\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { SizeFormat } from 'roosterjs-content-model-types';\n\nexport const SizeFormatRenderers: FormatRenderer<SizeFormat>[] = [\n    createTextFormatRenderer<SizeFormat>(\n        'Width',\n        format => format.width,\n        (format, value) => (format.width = value)\n    ),\n    createTextFormatRenderer<SizeFormat>(\n        'Height',\n        format => format.height,\n        (format, value) => (format.height = value)\n    ),\n    createTextFormatRenderer<SizeFormat>(\n        'MaxWidth',\n        format => format.maxWidth,\n        (format, value) => (format.maxWidth = value)\n    ),\n    createTextFormatRenderer<SizeFormat>(\n        'MaxHeight',\n        format => format.maxHeight,\n        (format, value) => (format.maxHeight = value)\n    ),\n    createTextFormatRenderer<SizeFormat>(\n        'MinWidth',\n        format => format.minWidth,\n        (format, value) => (format.minWidth = value)\n    ),\n    createTextFormatRenderer<SizeFormat>(\n        'MinHeight',\n        format => format.minHeight,\n        (format, value) => (format.minHeight = value)\n    ),\n];\n","import { createCheckboxFormatRenderer } from '../utils/createCheckboxFormatRenderer';\nimport { SpacingFormat } from 'roosterjs-content-model-types';\n\nexport const SpacingFormatRenderer = createCheckboxFormatRenderer<SpacingFormat>(\n    'BorderCollapsed',\n    format => format.borderCollapse,\n    (format, value) => (format.borderCollapse = value)\n);\n","import { createCheckboxFormatRenderer } from '../utils/createCheckboxFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { TableCellMetadataFormat } from 'roosterjs-editor-types';\n\nexport const TableCellMetadataFormatRenders: FormatRenderer<TableCellMetadataFormat>[] = [\n    createCheckboxFormatRenderer<TableCellMetadataFormat>(\n        'BgColorOverride',\n        format => format.bgColorOverride,\n        (format, value) => (format.bgColorOverride = value)\n    ),\n    createCheckboxFormatRenderer<TableCellMetadataFormat>(\n        'VAlignOverride',\n        format => format.vAlignOverride,\n        (format, value) => (format.vAlignOverride = value)\n    ),\n    createCheckboxFormatRenderer<TableCellMetadataFormat>(\n        'BorderOverride',\n        format => format.borderOverride,\n        (format, value) => (format.borderOverride = value)\n    ),\n];\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { TableLayoutFormat } from 'roosterjs-content-model-types';\n\nexport const TableLayoutFormatRenderer: FormatRenderer<TableLayoutFormat> = createTextFormatRenderer<\n    TableLayoutFormat\n>(\n    'TableLayout',\n    format => format.tableLayout,\n    (format, value) => (format.tableLayout = value)\n);\n","import { createCheckboxFormatRenderer } from '../utils/createCheckboxFormatRenderer';\nimport { createColorFormatRenderer } from '../utils/createColorFormatRender';\nimport { createDropDownFormatRenderer } from '../utils/createDropDownFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { getObjectKeys } from 'roosterjs-content-model-dom';\nimport { TableBorderFormat } from 'roosterjs-content-model-core';\nimport { TableMetadataFormat } from 'roosterjs-content-model-types';\n\nexport const TableMetadataFormatRenders: FormatRenderer<TableMetadataFormat>[] = [\n    createColorFormatRenderer<TableMetadataFormat>(\n        'TopBorderColor',\n        format => format.topBorderColor,\n        (format, value) => {\n            format.topBorderColor = value;\n        }\n    ),\n    createColorFormatRenderer<TableMetadataFormat>(\n        'BottomBorderColor',\n        format => format.bottomBorderColor,\n        (format, value) => (format.bottomBorderColor = value)\n    ),\n    createColorFormatRenderer<TableMetadataFormat>(\n        'VerticalBorderColor',\n        format => format.verticalBorderColor,\n        (format, value) => (format.verticalBorderColor = value)\n    ),\n    createCheckboxFormatRenderer<TableMetadataFormat>(\n        'HasHeaderRow',\n        format => format.hasHeaderRow,\n        (format, value) => (format.hasHeaderRow = value)\n    ),\n    createColorFormatRenderer<TableMetadataFormat>(\n        'HeaderRowColor',\n        format => format.headerRowColor,\n        (format, value) => (format.headerRowColor = value)\n    ),\n    createCheckboxFormatRenderer<TableMetadataFormat>(\n        'HasFirstColumn',\n        format => format.hasFirstColumn,\n        (format, value) => (format.hasFirstColumn = value)\n    ),\n    createCheckboxFormatRenderer<TableMetadataFormat>(\n        'HasBandedColumns',\n        format => format.hasBandedColumns,\n        (format, value) => (format.hasBandedColumns = value)\n    ),\n    createCheckboxFormatRenderer<TableMetadataFormat>(\n        'HasBandedRows',\n        format => format.hasBandedRows,\n        (format, value) => (format.hasBandedRows = value)\n    ),\n    createColorFormatRenderer<TableMetadataFormat>(\n        'BgColorEven',\n        format => format.bgColorEven,\n        (format, value) => (format.bgColorEven = value)\n    ),\n    createColorFormatRenderer<TableMetadataFormat>(\n        'BgColorOdd',\n        format => format.bgColorOdd,\n        (format, value) => (format.bgColorOdd = value)\n    ),\n    createDropDownFormatRenderer<TableMetadataFormat, keyof typeof TableBorderFormat>(\n        'TableBorderFormat',\n        [\n            'Default',\n            'ListWithSideBorders',\n            'NoHeaderBorders',\n            'NoSideBorders',\n            'FirstColumnHeaderExternal',\n            'EspecialType1',\n            'EspecialType2',\n            'EspecialType3',\n            'Clear',\n        ],\n        format =>\n            getObjectKeys(TableBorderFormat)[\n                Object.values(TableBorderFormat).indexOf(format.tableBorderFormat)\n            ],\n        (format, newValue) => (format.tableBorderFormat = TableBorderFormat[newValue])\n    ),\n];\n","import { createDropDownFormatRenderer } from '../utils/createDropDownFormatRenderer';\nimport { TextAlignFormat } from 'roosterjs-content-model-types';\n\nexport const TextAlignFormatRenderer = createDropDownFormatRenderer<\n    TextAlignFormat,\n    'start' | 'center' | 'end' | 'justify' | 'initial'\n>(\n    'Text align',\n    ['start', 'center', 'end'],\n    format => format.textAlign,\n    (format, value) => (format.textAlign = value)\n);\n","import * as Color from 'color';\nimport { createColorFormatRenderer } from '../utils/createColorFormatRender';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { TextColorFormat } from 'roosterjs-content-model-types';\n\nexport const TextColorFormatRenderer: FormatRenderer<TextColorFormat> = createColorFormatRenderer<\n    TextColorFormat\n>(\n    'Text color',\n    format => (format.textColor ? Color(format.textColor).hex() : ''),\n    (format, value) => {\n        format.textColor = value;\n        return undefined;\n    }\n);\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { FormatRenderer } from '../utils/FormatRenderer';\nimport { TextIndentFormat } from 'roosterjs-content-model-types';\n\nexport const TextIndentFormatRenderer: FormatRenderer<TextIndentFormat> = createTextFormatRenderer<\n    TextIndentFormat\n>(\n    'Text indent',\n    format => format.textIndent,\n    (format, value) => (format.textIndent = value)\n);\n","import { createDropDownFormatRenderer } from '../utils/createDropDownFormatRenderer';\nimport { VerticalAlignFormat } from 'roosterjs-content-model-types';\n\nexport const VerticalAlignFormatRenderer = createDropDownFormatRenderer<\n    VerticalAlignFormat,\n    'top' | 'middle' | 'bottom'\n>(\n    'Vertical align',\n    ['top', 'middle', 'bottom'],\n    format => format.verticalAlign,\n    (format, value) => (format.verticalAlign = value)\n);\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\nimport { WhiteSpaceFormat } from 'roosterjs-content-model-types';\n\nexport const WhiteSpaceFormatRenderer = createTextFormatRenderer<WhiteSpaceFormat>(\n    'White space',\n    format => format.whiteSpace,\n    (format, value) => (format.whiteSpace = value)\n);\n","import { createTextFormatRenderer } from '../utils/createTextFormatRenderer';\r\nimport { WordBreakFormat } from 'roosterjs-content-model-types';\r\n\r\nexport const WordBreakFormatRenderer = createTextFormatRenderer<WordBreakFormat>(\r\n    'Word break',\r\n    format => format.wordBreak,\r\n    (format, value) => (format.wordBreak = value)\r\n);\r\n","import * as React from 'react';\nimport { FormatRenderer } from './FormatRenderer';\nimport { useProperty } from '../../../hooks/useProperty';\n\nconst styles = require('../FormatView.scss');\n\nfunction CheckboxFormatItem<TFormat>(props: {\n    name: string;\n    format: TFormat;\n    getter: (format: TFormat) => boolean;\n    setter?: (format: TFormat, newValue: boolean) => void;\n    onUpdate?: () => void;\n}) {\n    const { name, getter, setter, format, onUpdate } = props;\n    const checkbox = React.useRef<HTMLInputElement>(null);\n    const [value, setValue] = useProperty<boolean>(getter(format));\n\n    const onChange = React.useCallback(() => {\n        const newValue = checkbox.current.checked;\n        setValue(newValue);\n        setter?.(format, newValue);\n        onUpdate?.();\n    }, [format, setter, setValue]);\n\n    return (\n        <div className={styles.formatRow}>\n            <div className={styles.formatName}>{name}</div>\n            <div className={styles.formatValue}>\n                <input type=\"checkbox\" ref={checkbox} checked={value} onChange={onChange} />\n            </div>\n        </div>\n    );\n}\n\nexport function createCheckboxFormatRenderer<T>(\n    name: string,\n    getter: (format: T) => boolean,\n    setter?: (format: T, newValue: boolean) => void\n): FormatRenderer<T> {\n    return (format: T, onUpdate?: () => void) => (\n        <CheckboxFormatItem\n            name={name}\n            getter={getter}\n            setter={setter}\n            format={format}\n            onUpdate={onUpdate}\n            key={name}\n        />\n    );\n}\n","import * as Color from 'color';\nimport * as React from 'react';\nimport { FormatRenderer } from './FormatRenderer';\nimport { useProperty } from '../../../hooks/useProperty';\n\nconst styles = require('../FormatView.scss');\nconst Transparent = 'transparent';\n\nfunction ColorFormatItem<T>(props: {\n    name: string;\n    format: T;\n    getter: (format: T) => string;\n    setter?: (format: T, newValue: string) => void;\n    onUpdate?: () => void;\n}) {\n    const { name, getter, setter, format, onUpdate } = props;\n    const colorPickerBox = React.useRef<HTMLInputElement & HTMLTextAreaElement>(null);\n    const colorValueBox = React.useRef<HTMLInputElement>(null);\n    const transparentCheckBox = React.useRef<HTMLInputElement>(null);\n\n    let initValue = getter(format);\n\n    if (initValue && initValue != Transparent) {\n        try {\n            const color = Color(initValue);\n            initValue = color.hex();\n        } catch {}\n    }\n\n    const [value, setValue] = useProperty(initValue);\n\n    const updateValue = React.useCallback(\n        (newValue: string) => {\n            if (newValue != Transparent) {\n                try {\n                    const color = Color(newValue);\n                    newValue = color.hex();\n                } catch {}\n            }\n\n            setValue(newValue);\n            setter?.(format, newValue);\n            onUpdate?.();\n        },\n        [setter, format]\n    );\n\n    const onTextBoxChange = React.useCallback(() => {\n        updateValue(colorPickerBox.current.value);\n    }, [updateValue]);\n\n    const onColorValueChange = React.useCallback(() => {\n        updateValue(colorValueBox.current.value);\n    }, [updateValue]);\n\n    const onToggleTransparent = React.useCallback(() => {\n        updateValue(\n            transparentCheckBox.current.checked ? Transparent : colorPickerBox.current.value\n        );\n    }, [updateValue]);\n\n    let content = (\n        <>\n            <input type=\"color\" ref={colorPickerBox} value={value} onChange={onTextBoxChange} />\n            <input\n                type=\"text\"\n                className={styles.colorValue}\n                ref={colorValueBox}\n                value={value}\n                onChange={onColorValueChange}\n            />\n            <input\n                type=\"checkbox\"\n                ref={transparentCheckBox}\n                checked={value == Transparent}\n                onChange={onToggleTransparent}\n            />\n            {Transparent}\n        </>\n    );\n\n    return (\n        <div className={styles.formatRow}>\n            <div className={styles.formatName}>{name}</div>\n            <div className={styles.formatValue}>{content}</div>\n        </div>\n    );\n}\n\nexport function createColorFormatRenderer<T>(\n    name: string,\n    getter: (format: T) => string,\n    setter?: (format: T, newValue: string) => void\n): FormatRenderer<T> {\n    return (format: T, onUpdate?: () => void) => (\n        <ColorFormatItem\n            name={name}\n            getter={getter}\n            setter={setter}\n            format={format}\n            key={name}\n            onUpdate={onUpdate}\n        />\n    );\n}\n\nexport function createColorFormatRendererGroup<T, V extends string>(\n    names: V[],\n    getter: (format: T) => string[],\n    setter?: (format: T, name: V, newValue: string) => void\n): FormatRenderer<T> {\n    return (format: T, onUpdate?: () => void) => {\n        const initValues = getter(format);\n\n        return (\n            <>\n                {names.map((name, index) => (\n                    <ColorFormatItem\n                        name={name}\n                        getter={() => initValues[index]}\n                        setter={(format, newValue) => setter?.(format, name, newValue)}\n                        format={format}\n                        onUpdate={onUpdate}\n                        key={name}\n                    />\n                ))}\n            </>\n        );\n    };\n}\n","import * as React from 'react';\nimport { FormatRenderer } from './FormatRenderer';\nimport { useProperty } from '../../../hooks/useProperty';\n\nconst styles = require('../FormatView.scss');\n\nfunction DropDownFormatItem<TFormat, TOption extends string>(props: {\n    name: string;\n    format: TFormat;\n    options: TOption[];\n    getter: (format: TFormat) => TOption | undefined;\n    setter?: (format: TFormat, newValue: TOption | undefined) => void;\n    onUpdate?: () => void;\n}) {\n    const { name, getter, setter, format, options, onUpdate } = props;\n    const dropDown = React.useRef<HTMLSelectElement>(null);\n    const [value, setValue] = useProperty(getter(format));\n\n    const onChange = React.useCallback(() => {\n        const newValue =\n            dropDown.current.value == '' ? undefined : (dropDown.current.value as TOption);\n        setValue(newValue);\n        setter?.(format, newValue);\n        onUpdate?.();\n    }, [format, setter]);\n\n    return (\n        <div className={styles.formatRow}>\n            <div className={styles.formatName}>{name}</div>\n            <div className={styles.formatValue}>\n                <select ref={dropDown} value={value === undefined ? '' : value} onChange={onChange}>\n                    <option value=\"\"></option>\n                    {options.map(o => (\n                        <option value={o} key={o}>\n                            {o}\n                        </option>\n                    ))}\n                </select>\n            </div>\n        </div>\n    );\n}\n\nexport function createDropDownFormatRenderer<T, O extends string>(\n    name: string,\n    options: O[],\n    getter: (format: T) => O,\n    setter?: (format: T, newValue: O) => void\n): FormatRenderer<T> {\n    return (format: T, onUpdate?: () => void) => (\n        <DropDownFormatItem\n            name={name}\n            getter={getter}\n            setter={setter}\n            format={format}\n            options={options}\n            onUpdate={onUpdate}\n            key={name}\n        />\n    );\n}\n\nexport function createDropDownFormatRendererGroup<T, O extends string, V extends string>(\n    names: V[],\n    options: O[],\n    getter: (format: T) => O[],\n    setter?: (format: T, name: V, newValue: O) => void\n): FormatRenderer<T> {\n    return (format: T, onUpdate?: () => void) => {\n        const initValues = getter(format);\n        return (\n            <>\n                {names.map((name, index) => (\n                    <DropDownFormatItem\n                        name={name}\n                        getter={() => initValues[index]}\n                        setter={(format, newValue) => setter?.(format, name, newValue)}\n                        format={format}\n                        options={options}\n                        onUpdate={onUpdate}\n                        key={name}\n                    />\n                ))}\n            </>\n        );\n    };\n}\n","import * as React from 'react';\nimport { FormatRenderer } from './FormatRenderer';\nimport { useProperty } from '../../../hooks/useProperty';\n\nconst styles = require('../FormatView.scss');\n\nfunction TextFormatItem<T>(props: {\n    name: string;\n    format: T;\n    getter: (format: T) => string;\n    setter?: (format: T, newValue: string) => void;\n    onUpdate?: () => void;\n    type: 'text' | 'number' | 'multiline';\n}) {\n    const { name, getter, setter, format, type, onUpdate } = props;\n    const textBox = React.useRef<HTMLInputElement & HTMLTextAreaElement>(null);\n    const [value, setValue] = useProperty(getter(format));\n\n    const updateValue = React.useCallback(\n        (newValue: string) => {\n            setValue(newValue);\n            setter?.(format, newValue);\n            onUpdate();\n        },\n        [setter, format]\n    );\n\n    const onTextBoxChange = React.useCallback(() => {\n        updateValue(textBox.current.value);\n    }, [updateValue]);\n\n    let content: JSX.Element;\n\n    switch (type) {\n        case 'multiline':\n            content = (\n                <textarea\n                    ref={textBox}\n                    onChange={onTextBoxChange}\n                    className={styles.multiLineValue}\n                    value={value}\n                />\n            );\n            break;\n        case 'number':\n            content = (\n                <input\n                    type=\"number\"\n                    className={styles.numberValue}\n                    ref={textBox}\n                    value={value}\n                    onChange={onTextBoxChange}\n                />\n            );\n            break;\n        case 'text':\n            content = (\n                <input\n                    type=\"text\"\n                    className={styles.textValue}\n                    ref={textBox}\n                    value={value}\n                    onChange={onTextBoxChange}\n                />\n            );\n            break;\n    }\n\n    return (\n        <div className={styles.formatRow}>\n            <div className={styles.formatName}>{name}</div>\n            <div className={styles.formatValue}>{content}</div>\n        </div>\n    );\n}\n\nexport function createTextFormatRenderer<T>(\n    name: string,\n    getter: (format: T) => string,\n    setter?: (format: T, newValue: string) => void,\n    type: 'text' | 'number' | 'multiline' = 'text'\n): FormatRenderer<T> {\n    return (format: T, onUpdate?: () => void) => (\n        <TextFormatItem\n            name={name}\n            getter={getter}\n            setter={setter}\n            format={format}\n            type={type}\n            onUpdate={onUpdate}\n            key={name}\n        />\n    );\n}\n\nexport function createTextFormatRendererGroup<T, V extends string>(\n    names: V[],\n    getter: (format: T) => string[],\n    setter?: (format: T, name: V, newValue: string) => void,\n    type: 'text' | 'number' | 'multiline' = 'text'\n): FormatRenderer<T> {\n    return (format: T, onUpdate?: () => void) => {\n        const initValues = getter(format);\n\n        return (\n            <>\n                {names.map((name, index) => (\n                    <TextFormatItem\n                        name={name}\n                        getter={() => initValues[index]}\n                        setter={(format, newValue) => setter?.(format, name, newValue)}\n                        format={format}\n                        type={type}\n                        onUpdate={onUpdate}\n                        key={name}\n                    />\n                ))}\n            </>\n        );\n    };\n}\n","import * as React from 'react';\nimport { ContentModelBlockGroup } from 'roosterjs-content-model-types';\nimport { ContentModelBlockView } from './ContentModelBlockView';\n\nexport function BlockGroupContentView(props: { group: ContentModelBlockGroup }) {\n    const { group } = props;\n\n    return (\n        <>\n            {group.blocks.map((block, index) => (\n                <ContentModelBlockView block={block} key={index} />\n            ))}\n        </>\n    );\n}\n","import * as React from 'react';\nimport { ContentModelBlockGroup } from 'roosterjs-content-model-types';\nimport { ContentModelDocumentView } from './ContentModelDocumentView';\nimport { ContentModelFormatContainerView } from './ContentModelFormatContainerView';\nimport { ContentModelGeneralView } from './ContentModelGeneralView';\nimport { ContentModelListItemView } from './ContentModelListItemView';\nimport { ContentModelTableCellView } from './ContentModelTableCellView';\n\nexport function ContentModelBlockGroupView(props: { group: ContentModelBlockGroup }) {\n    const { group } = props;\n\n    switch (group.blockGroupType) {\n        case 'Document':\n            return <ContentModelDocumentView doc={group} />;\n\n        case 'General':\n            return <ContentModelGeneralView model={group} />;\n\n        case 'ListItem':\n            return <ContentModelListItemView listItem={group} />;\n\n        case 'FormatContainer':\n            return <ContentModelFormatContainerView container={group} />;\n\n        case 'TableCell':\n            return <ContentModelTableCellView cell={group} />;\n    }\n}\n","import * as React from 'react';\nimport { ContentModelBlock } from 'roosterjs-content-model-types';\nimport { ContentModelBlockGroupView } from './ContentModelBlockGroupView';\nimport { ContentModelDividerView } from './ContentModelDividerView';\nimport { ContentModelEntityView } from './ContentModelEntityView';\nimport { ContentModelParagraphView } from './ContentModelParagraphView';\nimport { ContentModelTableView } from './ContentModelTableView';\n\nexport function ContentModelBlockView(props: { block: ContentModelBlock }) {\n    const { block } = props;\n\n    switch (block.blockType) {\n        case 'BlockGroup':\n            return <ContentModelBlockGroupView group={block} />;\n\n        case 'Paragraph':\n            return <ContentModelParagraphView paragraph={block} />;\n\n        case 'Table':\n            return <ContentModelTableView table={block} />;\n\n        case 'Entity':\n            return <ContentModelEntityView entity={block} />;\n\n        case 'Divider':\n            return <ContentModelDividerView divider={block} />;\n    }\n}\n","import * as React from 'react';\nimport { ContentModelBr } from 'roosterjs-content-model-types';\nimport { ContentModelView } from '../ContentModelView';\nimport { SegmentFormatView } from '../format/SegmentFormatView';\n\nconst styles = require('./ContentModelBrView.scss');\n\nexport function ContentModelBrView(props: { br: ContentModelBr }) {\n    const { br } = props;\n    const getFormat = React.useCallback(() => {\n        return <SegmentFormatView format={br.format} />;\n    }, [br.format]);\n\n    return (\n        <ContentModelView\n            title=\"BR\"\n            className={styles.modelBr}\n            isSelected={br.isSelected}\n            jsonSource={br}\n            getFormat={getFormat}\n        />\n    );\n}\n","import * as React from 'react';\nimport { ContentModelCode, ContentModelCodeFormat } from 'roosterjs-content-model-types';\nimport { ContentModelView } from '../ContentModelView';\nimport { DisplayFormatRenderer } from '../format/formatPart/DisplayFormatRenderer';\nimport { FontFamilyFormatRenderer } from '../format/formatPart/FontFamilyFormatRenderer';\nimport { FormatRenderer } from '../format/utils/FormatRenderer';\nimport { FormatView } from '../format/FormatView';\n\nconst CodeRenderers: FormatRenderer<ContentModelCodeFormat>[] = [\n    FontFamilyFormatRenderer,\n    DisplayFormatRenderer,\n];\n\nconst styles = require('./ContentModelCodeView.scss');\n\nexport function ContentModelCodeView(props: { code: ContentModelCode }) {\n    const { code } = props;\n\n    const getFormat = React.useCallback(() => {\n        return <FormatView format={code.format} renderers={CodeRenderers} />;\n    }, [code.format]);\n\n    return (\n        <ContentModelView\n            title=\"Code\"\n            className={styles.modelCode}\n            jsonSource={code}\n            getFormat={getFormat}\n        />\n    );\n}\n","import * as React from 'react';\nimport { BackgroundColorFormatRenderer } from '../format/formatPart/BackgroundColorFormatRenderer';\nimport { BorderFormatRenderers } from '../format/formatPart/BorderFormatRenderers';\nimport { ContentModelDivider, ContentModelDividerFormat } from 'roosterjs-content-model-types';\nimport { ContentModelView } from '../ContentModelView';\nimport { DirectionFormatRenderer } from '../format/formatPart/DirectionFormatRenderer';\nimport { DisplayFormatRenderer } from '../format/formatPart/DisplayFormatRenderer';\nimport { FormatRenderer } from '../format/utils/FormatRenderer';\nimport { FormatView } from '../format/FormatView';\nimport { LineHeightFormatRenderer } from '../format/formatPart/LineHeightFormatRenderer';\nimport { MarginFormatRenderer } from '../format/formatPart/MarginFormatRenderer';\nimport { PaddingFormatRenderer } from '../format/formatPart/PaddingFormatRenderer';\nimport { SizeFormatRenderers } from '../format/formatPart/SizeFormatRenderers';\nimport { useProperty } from '../../hooks/useProperty';\nimport { WhiteSpaceFormatRenderer } from '../format/formatPart/WhiteSpaceFormatRenderer';\n\nconst styles = require('./ContentModelDividerView.scss');\nconst DividerFormatRenders: FormatRenderer<ContentModelDividerFormat>[] = [\n    BackgroundColorFormatRenderer,\n    DirectionFormatRenderer,\n    MarginFormatRenderer,\n    PaddingFormatRenderer,\n    LineHeightFormatRenderer,\n    WhiteSpaceFormatRenderer,\n    ...BorderFormatRenderers,\n    DisplayFormatRenderer,\n    ...SizeFormatRenderers,\n];\n\nexport function ContentModelDividerView(props: { divider: ContentModelDivider }) {\n    const { divider } = props;\n    const [tagName, setTagName] = useProperty(divider.tagName);\n    const tagNameDropDown = React.useRef<HTMLSelectElement>(null);\n    const onTagNameChange = React.useCallback(() => {\n        const newValue = tagNameDropDown.current.value as 'hr' | 'div';\n        divider.tagName = newValue;\n        setTagName(newValue);\n    }, [divider, setTagName]);\n\n    const getContent = React.useCallback(() => {\n        return (\n            <div>\n                TagName:\n                <select value={tagName} ref={tagNameDropDown} onChange={onTagNameChange}>\n                    <option value=\"hr\">HR</option>\n                    <option value=\"div\">DIV</option>\n                </select>\n            </div>\n        );\n    }, [tagName]);\n\n    const getFormat = React.useCallback(() => {\n        return <FormatView format={divider.format} renderers={DividerFormatRenders} />;\n    }, [divider.format]);\n\n    return (\n        <ContentModelView\n            title=\"Divider\"\n            className={styles.modelDivider}\n            isSelected={divider.isSelected}\n            jsonSource={divider}\n            getContent={getContent}\n            getFormat={getFormat}\n        />\n    );\n}\n","import * as React from 'react';\nimport { BlockGroupContentView } from './BlockGroupContentView';\nimport { ContentModelDocument } from 'roosterjs-content-model-types';\nimport { ContentModelView } from '../ContentModelView';\nimport { hasSelectionInBlockGroup } from 'roosterjs-content-model-core';\n\nconst styles = require('./ContentModelDocumentView.scss');\n\nexport function ContentModelDocumentView(props: { doc: ContentModelDocument }) {\n    const { doc } = props;\n    const getContent = React.useCallback(() => {\n        return <BlockGroupContentView group={doc} />;\n    }, [doc]);\n\n    return (\n        <ContentModelView\n            title=\"Document\"\n            className={styles.modelDocument}\n            hasSelection={hasSelectionInBlockGroup(doc)}\n            jsonSource={doc}\n            getContent={getContent}\n        />\n    );\n}\n","import * as React from 'react';\nimport { BlockFormatView } from '../format/BlockFormatView';\nimport { ContentModelEntity } from 'roosterjs-content-model-types';\nimport { ContentModelView } from '../ContentModelView';\nimport { SegmentFormatView } from '../format/SegmentFormatView';\nimport { useProperty } from '../../hooks/useProperty';\n\nconst styles = require('./ContentModelEntityView.scss');\n\nexport function ContentModelEntityView(props: { entity: ContentModelEntity }) {\n    const { entity } = props;\n\n    const [id, setId] = useProperty(entity.entityFormat.id);\n    const [isReadonly, setIsReadonly] = useProperty(entity.entityFormat.isReadonly);\n    const [type, setType] = useProperty(entity.entityFormat.entityType);\n\n    const idTextBox = React.useRef<HTMLInputElement>(null);\n    const isReadonlyCheckBox = React.useRef<HTMLInputElement>(null);\n    const typeTextBox = React.useRef<HTMLInputElement>(null);\n\n    const onIdChange = React.useCallback(() => {\n        const newValue = idTextBox.current.value;\n        entity.entityFormat.id = newValue;\n        setId(newValue);\n    }, [id, setId]);\n    const onTypeChange = React.useCallback(() => {\n        const newValue = typeTextBox.current.value;\n        entity.entityFormat.entityType = newValue;\n        setType(newValue);\n    }, [type, setType]);\n    const onReadonlyChange = React.useCallback(() => {\n        const newValue = isReadonlyCheckBox.current.checked;\n        entity.entityFormat.isReadonly = newValue;\n        setIsReadonly(newValue);\n    }, [id, setId]);\n\n    const getContent = React.useCallback(() => {\n        return (\n            <>\n                <div>\n                    Id: <input type=\"text\" value={id} ref={idTextBox} onChange={onIdChange} />\n                </div>\n                <div>\n                    Type:\n                    <input type=\"text\" value={type} ref={typeTextBox} onChange={onTypeChange} />\n                </div>\n                <div>\n                    IsReadonly:\n                    <input\n                        type=\"checkbox\"\n                        checked={isReadonly}\n                        ref={isReadonlyCheckBox}\n                        onChange={onReadonlyChange}\n                    />\n                </div>\n            </>\n        );\n    }, [type, isReadonly, id]);\n\n    const getFormat = React.useCallback(() => {\n        return (\n            <>\n                <SegmentFormatView format={entity.format} />\n                <BlockFormatView format={entity.format} />\n            </>\n        );\n    }, [entity.format]);\n\n    return (\n        <ContentModelView\n            title=\"Entity\"\n            subTitle={id}\n            className={styles.modelEntity}\n            isSelected={entity.isSelected}\n            jsonSource={entity}\n            getContent={getContent}\n            getFormat={getFormat}\n        />\n    );\n}\n","import * as React from 'react';\nimport { BlockFormatView } from '../format/BlockFormatView';\nimport { BlockGroupContentView } from './BlockGroupContentView';\nimport { ContentModelView } from '../ContentModelView';\nimport { DisplayFormatRenderer } from '../format/formatPart/DisplayFormatRenderer';\nimport { FormatRenderer } from '../format/utils/FormatRenderer';\nimport { FormatView } from '../format/FormatView';\nimport { hasSelectionInBlock } from 'roosterjs-content-model-core';\nimport { SegmentFormatView } from '../format/SegmentFormatView';\nimport { SizeFormatRenderers } from '../format/formatPart/SizeFormatRenderers';\nimport {\n    ContentModelFormatContainer,\n    ContentModelFormatContainerFormat,\n} from 'roosterjs-content-model-types';\n\nconst styles = require('./ContentModelFormatContainerView.scss');\n\nconst FormatContainerFormatRenderers: FormatRenderer<ContentModelFormatContainerFormat>[] = [\n    ...SizeFormatRenderers,\n    DisplayFormatRenderer,\n];\n\nexport function ContentModelFormatContainerView(props: { container: ContentModelFormatContainer }) {\n    const { container } = props;\n    const getContent = React.useCallback(() => {\n        return <BlockGroupContentView group={container} />;\n    }, [container]);\n\n    const getFormat = React.useCallback(() => {\n        return (\n            <>\n                <BlockFormatView format={container.format} />\n                <SegmentFormatView format={container.format} />\n                <FormatView format={container.format} renderers={FormatContainerFormatRenderers} />\n            </>\n        );\n    }, [container]);\n\n    return (\n        <ContentModelView\n            title=\"FormatContainer\"\n            subTitle={container.tagName}\n            className={styles.modelFormatContainer}\n            hasSelection={hasSelectionInBlock(container)}\n            jsonSource={container}\n            getContent={getContent}\n            getFormat={getFormat}\n        />\n    );\n}\n","import * as React from 'react';\nimport { BlockGroupContentView } from './BlockGroupContentView';\nimport { ContentModelCodeView } from './ContentModelCodeView';\nimport { ContentModelLinkView } from './ContentModelLinkView';\nimport { ContentModelView } from '../ContentModelView';\nimport { hasSelectionInBlock } from 'roosterjs-content-model-core';\nimport { SegmentFormatView } from '../format/SegmentFormatView';\nimport {\n    ContentModelGeneralBlock,\n    ContentModelGeneralSegment,\n} from 'roosterjs-content-model-types';\n\nconst styles = require('./ContentModelGeneralView.scss');\n\nexport function ContentModelGeneralView(props: { model: ContentModelGeneralBlock }) {\n    const { model } = props;\n    const segment = isGeneralSegment(model) ? model : undefined;\n    const link = segment?.link;\n    const code = segment?.code;\n    const getContent = React.useCallback(() => {\n        return (\n            <>\n                {link ? <ContentModelLinkView link={link} /> : null}\n                {code ? <ContentModelCodeView code={code} /> : null}\n                <BlockGroupContentView group={model} />\n            </>\n        );\n    }, [model, link]);\n\n    const getFormat = React.useCallback(() => {\n        return <SegmentFormatView format={model.format} />;\n    }, [segment?.format]);\n\n    return (\n        <ContentModelView\n            title=\"General\"\n            subTitle={model.element?.tagName || 'NULL'}\n            className={styles.modelGeneral}\n            hasSelection={hasSelectionInBlock(model)}\n            isSelected={isGeneralSegment(model) ? model.isSelected : false}\n            jsonSource={model}\n            getContent={getContent}\n            getFormat={segment ? getFormat : undefined}\n        />\n    );\n}\n\nfunction isGeneralSegment(block: ContentModelGeneralBlock): block is ContentModelGeneralSegment {\n    return (block as ContentModelGeneralSegment).segmentType == 'General';\n}\n","import * as React from 'react';\nimport { ContentModelCodeView } from './ContentModelCodeView';\nimport { ContentModelImage, ContentModelImageFormat } from 'roosterjs-content-model-types';\nimport { ContentModelLinkView } from './ContentModelLinkView';\nimport { ContentModelView } from '../ContentModelView';\nimport { FloatFormatRenderer } from '../format/formatPart/FloatFormatRenderer';\nimport { FormatRenderer } from '../format/utils/FormatRenderer';\nimport { FormatView } from '../format/FormatView';\nimport { IdFormatRenderer } from '../format/formatPart/IdFormatRenderer';\nimport { ImageMetadataFormatRenderers } from '../format/formatPart/ImageMetadataFormatRenderers';\nimport { MarginFormatRenderer } from '../format/formatPart/MarginFormatRenderer';\nimport { MetadataView } from '../format/MetadataView';\nimport { PaddingFormatRenderer } from '../format/formatPart/PaddingFormatRenderer';\nimport { SegmentFormatView } from '../format/SegmentFormatView';\nimport { SizeFormatRenderers } from '../format/formatPart/SizeFormatRenderers';\nimport { updateImageMetadata } from 'roosterjs-content-model-core';\nimport { useProperty } from '../../hooks/useProperty';\n\nconst styles = require('./ContentModelImageView.scss');\n\nconst ImageFormatRenderers: FormatRenderer<ContentModelImageFormat>[] = [\n    IdFormatRenderer,\n    ...SizeFormatRenderers,\n    MarginFormatRenderer,\n    PaddingFormatRenderer,\n    FloatFormatRenderer,\n];\n\nexport function ContentModelImageView(props: { image: ContentModelImage }) {\n    const { image } = props;\n    const srcTextArea = React.useRef<HTMLTextAreaElement>(null);\n    const imageSelectionCheckBox = React.useRef<HTMLInputElement>(null);\n\n    const [src, setSrc] = useProperty(image.src);\n    const [imageSelected, setImageSelected] = useProperty(\n        image.isSelectedAsImageSelection || false\n    );\n\n    const getFormat = React.useCallback(() => {\n        return (\n            <>\n                <SegmentFormatView format={image.format} />\n                <FormatView format={image.format} renderers={ImageFormatRenderers} />\n            </>\n        );\n    }, [image.format]);\n\n    const getContent = React.useCallback(() => {\n        return (\n            <>\n                <img src={src} className={styles.image} />\n                <textarea value={src} ref={srcTextArea} onChange={onSrcChange} />\n                <div>\n                    <input\n                        type=\"checkbox\"\n                        checked={imageSelected}\n                        ref={imageSelectionCheckBox}\n                        onChange={onImageSelectionChange}\n                    />\n                    Image selection\n                </div>\n                {image.link ? <ContentModelLinkView link={image.link} /> : null}{' '}\n                {image.code ? <ContentModelCodeView code={image.code} /> : null}\n            </>\n        );\n    }, [src, imageSelected, image.link]);\n\n    const getMetadata = React.useCallback(() => {\n        return (\n            <MetadataView\n                model={image}\n                renderers={ImageMetadataFormatRenderers}\n                updater={updateImageMetadata}\n            />\n        );\n    }, [image]);\n\n    const onSrcChange = React.useCallback(() => {\n        const newValue = srcTextArea.current.value;\n        image.src = newValue;\n        setSrc(newValue);\n    }, [src, setSrc]);\n\n    const onImageSelectionChange = React.useCallback(() => {\n        const newValue = imageSelectionCheckBox.current.checked;\n        image.isSelectedAsImageSelection = newValue;\n        setImageSelected(newValue);\n    }, [imageSelected, setImageSelected]);\n\n    return (\n        <ContentModelView\n            title=\"Image\"\n            subTitle={imageSelected ? '[ImageSelection]' : ''}\n            className={styles.modelImage}\n            isSelected={image.isSelected}\n            jsonSource={image}\n            getFormat={getFormat}\n            getContent={getContent}\n            getMetadata={getMetadata}\n        />\n    );\n}\n","import * as React from 'react';\nimport { safeInstanceOf } from 'roosterjs-editor-dom';\n\nconst styles = require('./ContentModelJson.scss');\n\nexport function ContentModelJson(props: { jsonSource: Object }) {\n    const { jsonSource } = props;\n    const json = JSON.stringify(\n        jsonSource,\n        (key, value) => {\n            if (safeInstanceOf(value, 'HTMLElement')) {\n                return (\n                    Object.prototype.toString.apply(value) +\n                    ': ' +\n                    (value.cloneNode() as HTMLElement).outerHTML\n                );\n            } else if (safeInstanceOf(value, 'Node')) {\n                return Object.prototype.toString.apply(value);\n            } else if (key == 'src' && typeof value == 'string') {\n                return value.length > 100 ? value.substring(0, 97) + '...' : value;\n            } else {\n                return value;\n            }\n        },\n        2\n    );\n\n    return <pre className={styles.json}>{json}</pre>;\n}\n","import * as React from 'react';\nimport { ContentModelLink } from 'roosterjs-content-model-types';\nimport { ContentModelView } from '../ContentModelView';\nimport { LinkFormatView } from '../format/LinkFormatView';\n\nconst styles = require('./ContentModelLinkView.scss');\n\nexport function ContentModelLinkView(props: { link: ContentModelLink }) {\n    const { link } = props;\n\n    const getFormat = React.useCallback(() => {\n        return <LinkFormatView format={link.format} />;\n    }, [link.format]);\n\n    return (\n        <ContentModelView\n            title=\"Link\"\n            subTitle={link.format.href}\n            className={styles.modelLink}\n            jsonSource={link}\n            getFormat={getFormat}\n        />\n    );\n}\n","import * as React from 'react';\nimport { ContentModelBlockView } from './ContentModelBlockView';\nimport { ContentModelListLevelView } from './ContentModelListLevelView';\nimport { ContentModelView } from '../ContentModelView';\nimport { DirectionFormatRenderer } from '../format/formatPart/DirectionFormatRenderer';\nimport { FontFamilyFormatRenderer } from '../format/formatPart/FontFamilyFormatRenderer';\nimport { FontSizeFormatRenderer } from '../format/formatPart/FontSizeFormatRenderer';\nimport { FormatRenderer } from '../format/utils/FormatRenderer';\nimport { FormatView } from '../format/FormatView';\nimport { hasSelectionInBlockGroup } from 'roosterjs-content-model-core';\nimport { LineHeightFormatRenderer } from '../format/formatPart/LineHeightFormatRenderer';\nimport { MarginFormatRenderer } from '../format/formatPart/MarginFormatRenderer';\nimport { TextAlignFormatRenderer } from '../format/formatPart/TextAlignFormatRenderer';\nimport { TextColorFormatRenderer } from '../format/formatPart/TextColorFormatRenderer';\nimport {\n    ContentModelListItem,\n    ContentModelListItemFormat,\n    ContentModelSegmentFormat,\n} from 'roosterjs-content-model-types';\n\nconst styles = require('./ContentModelListItemView.scss');\n\nconst ListItemFormatRenderers: FormatRenderer<ContentModelListItemFormat>[] = [\n    DirectionFormatRenderer,\n    TextAlignFormatRenderer,\n    LineHeightFormatRenderer,\n    MarginFormatRenderer,\n];\nconst ListItemFormatHolderRenderers: FormatRenderer<ContentModelSegmentFormat>[] = [\n    TextColorFormatRenderer,\n    FontSizeFormatRenderer,\n    FontFamilyFormatRenderer,\n];\n\nexport function ContentModelListItemView(props: { listItem: ContentModelListItem }) {\n    const { listItem } = props;\n    const getContent = React.useCallback(() => {\n        return (\n            <>\n                <div>List Levels</div>\n                {listItem.levels.map((level, index) => (\n                    <ContentModelListLevelView level={level} key={index} />\n                ))}\n\n                <div>List Contents</div>\n                {listItem.blocks.map((block, index) => (\n                    <ContentModelBlockView block={block} key={index} />\n                ))}\n            </>\n        );\n    }, [listItem]);\n\n    const getFormat = React.useCallback(() => {\n        return (\n            <>\n                <div>List item format:</div>\n                <FormatView format={listItem.format} renderers={ListItemFormatRenderers} />\n                <br />\n                <div>List marker format:</div>\n                <FormatView\n                    format={listItem.formatHolder.format}\n                    renderers={ListItemFormatHolderRenderers}\n                />\n            </>\n        );\n    }, [listItem.levels]);\n\n    return (\n        <ContentModelView\n            title=\"ListItem\"\n            isExpanded={false}\n            className={styles.modelListItem}\n            hasSelection={hasSelectionInBlockGroup(listItem)}\n            jsonSource={listItem}\n            getContent={getContent}\n            getFormat={getFormat}\n        />\n    );\n}\n","import * as React from 'react';\nimport { ContentModelView } from '../ContentModelView';\nimport { DirectionFormatRenderer } from '../format/formatPart/DirectionFormatRenderer';\nimport { FormatRenderer } from '../format/utils/FormatRenderer';\nimport { FormatView } from '../format/FormatView';\nimport { ListMetadataFormatRenderers } from '../format/formatPart/ListMetadataFormatRenderers';\nimport { ListStylePositionFormatRenderers } from '../format/formatPart/ListStylePositionFormatRenderers';\nimport { ListThreadFormatRenderers } from '../format/formatPart/ListThreadFormatRenderer';\nimport { MarginFormatRenderer } from '../format/formatPart/MarginFormatRenderer';\nimport { MetadataView } from '../format/MetadataView';\nimport { PaddingFormatRenderer } from '../format/formatPart/PaddingFormatRenderer';\nimport { TextAlignFormatRenderer } from '../format/formatPart/TextAlignFormatRenderer';\nimport { updateListMetadata } from 'roosterjs-content-model-core';\nimport { useProperty } from '../../hooks/useProperty';\nimport {\n    ContentModelListItemLevelFormat,\n    ContentModelListLevel,\n} from 'roosterjs-content-model-types';\n\nconst styles = require('./ContentModelListLevelView.scss');\n\nconst ListLevelFormatRenders: FormatRenderer<ContentModelListItemLevelFormat>[] = [\n    ...ListThreadFormatRenderers,\n    DirectionFormatRenderer,\n    TextAlignFormatRenderer,\n    MarginFormatRenderer,\n    PaddingFormatRenderer,\n    ...ListStylePositionFormatRenderers,\n];\n\nexport function ContentModelListLevelView(props: { level: ContentModelListLevel }) {\n    const { level } = props;\n    const [listType, setListType] = useProperty(level.listType);\n    const listTypeInput = React.useRef<HTMLSelectElement>(null);\n    const onListTypeChanged = React.useCallback(() => {\n        const newValue = listTypeInput.current.value as 'OL' | 'UL';\n\n        level.listType = newValue;\n        setListType(newValue);\n    }, [setListType, level]);\n\n    const getContent = React.useCallback(() => {\n        return (\n            <div>\n                ListType:{' '}\n                <select value={listType} onChange={onListTypeChanged} ref={listTypeInput}>\n                    <option value=\"OL\">OL</option>\n                    <option value=\"UL\">UL</option>\n                </select>\n            </div>\n        );\n    }, [level, listType]);\n\n    const getFormat = React.useCallback(() => {\n        return <FormatView format={level.format} renderers={ListLevelFormatRenders} />;\n    }, [level, listType]);\n\n    const getMetadata = React.useCallback(() => {\n        return (\n            <MetadataView\n                model={level}\n                renderers={ListMetadataFormatRenderers}\n                updater={updateListMetadata}\n            />\n        );\n    }, [level]);\n\n    return (\n        <ContentModelView\n            title=\"ListLevel\"\n            subTitle={listType}\n            isExpanded={false}\n            className={styles.modelListLevel}\n            jsonSource={level}\n            getContent={getContent}\n            getFormat={getFormat}\n            getMetadata={getMetadata}\n        />\n    );\n}\n","import * as React from 'react';\nimport { BlockFormatView } from '../format/BlockFormatView';\nimport { ContentModelSegmentView } from './ContentModelSegmentView';\nimport { ContentModelView } from '../ContentModelView';\nimport { hasSelectionInBlock } from 'roosterjs-content-model-core';\nimport { SegmentFormatView } from '../format/SegmentFormatView';\nimport { useProperty } from '../../hooks/useProperty';\nimport {\n    ContentModelParagraph,\n    ContentModelParagraphDecorator,\n} from 'roosterjs-content-model-types';\n\nconst styles = require('./ContentModelParagraphView.scss');\n\nexport function ContentModelParagraphView(props: { paragraph: ContentModelParagraph }) {\n    const { paragraph } = props;\n    const implicitCheckbox = React.useRef<HTMLInputElement>(null);\n    const [isImplicit, setIsImplicit] = useProperty(!!paragraph.isImplicit);\n\n    const onIsImplicitChange = React.useCallback(() => {\n        const newValue = implicitCheckbox.current.checked;\n        paragraph.isImplicit = newValue;\n        setIsImplicit(newValue);\n    }, [paragraph, setIsImplicit]);\n\n    const getContent = React.useCallback(() => {\n        return (\n            <>\n                <div>\n                    <input\n                        type=\"checkbox\"\n                        checked={isImplicit}\n                        ref={implicitCheckbox}\n                        onChange={onIsImplicitChange}\n                    />\n                    Implicit\n                </div>\n                {paragraph.decorator && (\n                    <ContentModelParagraphDecoratorView decorator={paragraph.decorator} />\n                )}\n                {paragraph.segments.map((segment, index) => (\n                    <ContentModelSegmentView segment={segment} key={index} />\n                ))}\n            </>\n        );\n    }, [paragraph, isImplicit]);\n\n    const getFormat = React.useCallback(() => {\n        return (\n            <>\n                <BlockFormatView format={paragraph.format} />\n                {paragraph.segmentFormat && <SegmentFormatView format={paragraph.segmentFormat} />}\n            </>\n        );\n    }, [paragraph.format]);\n\n    return (\n        <ContentModelView\n            title=\"Paragraph\"\n            subTitle={paragraph.isImplicit ? ' (Implicit)' : ''}\n            isExpanded={true}\n            className={styles.modelParagraph}\n            hasSelection={hasSelectionInBlock(paragraph)}\n            jsonSource={paragraph}\n            getContent={getContent}\n            getFormat={getFormat}\n        />\n    );\n}\n\nfunction ContentModelParagraphDecoratorView(props: { decorator: ContentModelParagraphDecorator }) {\n    const { decorator } = props;\n    const tagNameDropDown = React.useRef<HTMLSelectElement>(null);\n    const [tagName, setTagName] = useProperty(decorator.tagName || '');\n\n    const onTagNameChange = React.useCallback(() => {\n        const newValue = tagNameDropDown.current.value;\n\n        decorator.tagName = newValue;\n        setTagName(newValue);\n    }, [decorator, setTagName]);\n\n    const getContent = React.useCallback(() => {\n        return (\n            <div>\n                Tag name:\n                <select value={tagName} ref={tagNameDropDown} onChange={onTagNameChange}>\n                    <option value=\"p\">P</option>\n                    <option value=\"h1\">H1</option>\n                    <option value=\"h2\">H2</option>\n                    <option value=\"h3\">H3</option>\n                    <option value=\"h4\">H4</option>\n                    <option value=\"h5\">H5</option>\n                    <option value=\"h6\">H6</option>\n                </select>\n            </div>\n        );\n    }, [decorator, tagName]);\n\n    const getFormat = React.useCallback(() => {\n        return <SegmentFormatView format={decorator.format} />;\n    }, [decorator.format]);\n\n    return (\n        <ContentModelView\n            title=\"Decorator\"\n            subTitle={decorator.tagName}\n            className={styles.modelDecorator}\n            jsonSource={decorator}\n            getContent={getContent}\n            getFormat={getFormat}\n        />\n    );\n}\n","import * as React from 'react';\nimport { ContentModelBrView } from './ContentModelBrView';\nimport { ContentModelEntityView } from './ContentModelEntityView';\nimport { ContentModelGeneralView } from './ContentModelGeneralView';\nimport { ContentModelImageView } from './ContentModelImageView';\nimport { ContentModelSegment } from 'roosterjs-content-model-types';\nimport { ContentModelSelectionMarkerView } from './ContentModelSelectionMarkerView';\nimport { ContentModelTextView } from './ContentModelTextView';\n\nexport function ContentModelSegmentView(props: { segment: ContentModelSegment }) {\n    const { segment } = props;\n\n    switch (segment.segmentType) {\n        case 'Br':\n            return <ContentModelBrView br={segment} />;\n\n        case 'General':\n            return <ContentModelGeneralView model={segment} />;\n\n        case 'SelectionMarker':\n            return <ContentModelSelectionMarkerView marker={segment} />;\n\n        case 'Text':\n            return <ContentModelTextView text={segment} />;\n\n        case 'Entity':\n            return <ContentModelEntityView entity={segment} />;\n\n        case 'Image':\n            return <ContentModelImageView image={segment} />;\n    }\n}\n","import * as React from 'react';\nimport { ContentModelCodeView } from './ContentModelCodeView';\nimport { ContentModelLinkView } from './ContentModelLinkView';\nimport { ContentModelSelectionMarker } from 'roosterjs-content-model-types';\nimport { ContentModelView } from '../ContentModelView';\nimport { SegmentFormatView } from '../format/SegmentFormatView';\n\nconst styles = require('./ContentModelSelectionMarkerView.scss');\n\nexport function ContentModelSelectionMarkerView(props: { marker: ContentModelSelectionMarker }) {\n    const { marker } = props;\n\n    const getContent = React.useCallback(() => {\n        return (\n            <>\n                {marker.link ? <ContentModelLinkView link={marker.link} /> : null}\n                {marker.code ? <ContentModelCodeView code={marker.code} /> : null}\n            </>\n        );\n    }, [marker.link]);\n\n    const getFormat = React.useCallback(() => {\n        return <SegmentFormatView format={marker.format} />;\n    }, [marker.format]);\n\n    return (\n        <ContentModelView\n            title=\"SelectionMarker\"\n            className={styles.modelSelectionMarker}\n            isSelected={true}\n            jsonSource={marker}\n            getContent={getContent}\n            getFormat={getFormat}\n        />\n    );\n}\n","import * as React from 'react';\r\nimport { BackgroundColorFormatRenderer } from '../format/formatPart/BackgroundColorFormatRenderer';\r\nimport { BlockGroupContentView } from './BlockGroupContentView';\r\nimport { BorderBoxFormatRenderer } from '../format/formatPart/BorderBoxFormatRenderer';\r\nimport { BorderFormatRenderers } from '../format/formatPart/BorderFormatRenderers';\r\nimport { ContentModelTableCell, ContentModelTableCellFormat } from 'roosterjs-content-model-types';\r\nimport { ContentModelView } from '../ContentModelView';\r\nimport { DirectionFormatRenderer } from '../format/formatPart/DirectionFormatRenderer';\r\nimport { FormatRenderer } from '../format/utils/FormatRenderer';\r\nimport { FormatView } from '../format/FormatView';\r\nimport { hasSelectionInBlockGroup, updateTableCellMetadata } from 'roosterjs-content-model-core';\r\nimport { HtmlAlignFormatRenderer } from '../format/formatPart/HtmlAlignFormatRenderer';\r\nimport { MetadataView } from '../format/MetadataView';\r\nimport { PaddingFormatRenderer } from '../format/formatPart/PaddingFormatRenderer';\r\nimport { SizeFormatRenderers } from '../format/formatPart/SizeFormatRenderers';\r\nimport { TableCellMetadataFormatRenders } from '../format/formatPart/TableCellMetadataFormatRenders';\r\nimport { TextAlignFormatRenderer } from '../format/formatPart/TextAlignFormatRenderer';\r\nimport { TextColorFormatRenderer } from '../format/formatPart/TextColorFormatRenderer';\r\nimport { useProperty } from '../../hooks/useProperty';\r\nimport { VerticalAlignFormatRenderer } from '../format/formatPart/VerticalAlignFormatRenderer';\r\nimport { WordBreakFormatRenderer } from '../format/formatPart/WordBreakFormatRenderer';\r\n\r\nconst styles = require('./ContentModelTableCellView.scss');\r\n\r\nconst TableCellFormatRenderers: FormatRenderer<ContentModelTableCellFormat>[] = [\r\n    ...BorderFormatRenderers,\r\n    DirectionFormatRenderer,\r\n    TextAlignFormatRenderer,\r\n    HtmlAlignFormatRenderer,\r\n    BorderBoxFormatRenderer,\r\n    BackgroundColorFormatRenderer,\r\n    PaddingFormatRenderer,\r\n    VerticalAlignFormatRenderer,\r\n    WordBreakFormatRenderer,\r\n    TextColorFormatRenderer,\r\n    ...SizeFormatRenderers,\r\n];\r\n\r\nexport function ContentModelTableCellView(props: { cell: ContentModelTableCell }) {\r\n    const { cell } = props;\r\n    const checkboxHeader = React.useRef<HTMLInputElement>(null);\r\n    const checkboxSpanLeft = React.useRef<HTMLInputElement>(null);\r\n    const checkboxSpanAbove = React.useRef<HTMLInputElement>(null);\r\n    const [isHeader, setIsHeader] = useProperty(cell.isHeader);\r\n    const [spanLeft, setSpanLeft] = useProperty(cell.spanLeft);\r\n    const [spanAbove, setSpanAbove] = useProperty(cell.spanAbove);\r\n\r\n    const onHeaderChanged = React.useCallback(() => {\r\n        const value = checkboxHeader.current.checked;\r\n        cell.isHeader = value;\r\n        setIsHeader(value);\r\n    }, [cell, setIsHeader]);\r\n\r\n    const onSpanLeftChanged = React.useCallback(() => {\r\n        const value = checkboxSpanLeft.current.checked;\r\n        cell.spanLeft = value;\r\n        setSpanLeft(value);\r\n    }, [cell, setSpanLeft]);\r\n\r\n    const onSpanAboveChanged = React.useCallback(() => {\r\n        const value = checkboxSpanAbove.current.checked;\r\n        cell.spanAbove = value;\r\n        setSpanAbove(value);\r\n    }, [cell, setSpanAbove]);\r\n\r\n    const getContent = React.useCallback(() => {\r\n        return (\r\n            <>\r\n                <div>\r\n                    <input\r\n                        type=\"checkbox\"\r\n                        checked={isHeader}\r\n                        ref={checkboxHeader}\r\n                        onChange={onHeaderChanged}\r\n                    />\r\n                    Header\r\n                </div>\r\n                <div>\r\n                    <input\r\n                        type=\"checkbox\"\r\n                        checked={spanLeft}\r\n                        ref={checkboxSpanLeft}\r\n                        onChange={onSpanLeftChanged}\r\n                    />\r\n                    Span Left\r\n                </div>\r\n                <div>\r\n                    <input\r\n                        type=\"checkbox\"\r\n                        checked={spanAbove}\r\n                        ref={checkboxSpanAbove}\r\n                        onChange={onSpanAboveChanged}\r\n                    />\r\n                    Span Above\r\n                </div>\r\n                <BlockGroupContentView group={cell} />\r\n            </>\r\n        );\r\n    }, [cell, isHeader, spanAbove, spanLeft]);\r\n\r\n    const getMetadata = React.useCallback(() => {\r\n        return (\r\n            <MetadataView\r\n                model={cell}\r\n                renderers={TableCellMetadataFormatRenders}\r\n                updater={updateTableCellMetadata}\r\n            />\r\n        );\r\n    }, [cell]);\r\n\r\n    const getFormat = React.useCallback(() => {\r\n        return <FormatView format={cell.format} renderers={TableCellFormatRenderers} />;\r\n    }, [cell.format]);\r\n\r\n    const subTitle =\r\n        cell.spanAbove && cell.spanLeft ? '' : cell.spanLeft ? '' : cell.spanAbove ? '' : '';\r\n\r\n    return (\r\n        <ContentModelView\r\n            title={isHeader ? 'TableCellHeader' : 'TableCell'}\r\n            subTitle={subTitle}\r\n            className={styles.modelTableCell}\r\n            hasSelection={hasSelectionInBlockGroup(cell)}\r\n            isSelected={cell.isSelected}\r\n            jsonSource={cell}\r\n            getContent={getContent}\r\n            getFormat={getFormat}\r\n            getMetadata={getMetadata}\r\n        />\r\n    );\r\n}\r\n","import * as React from 'react';\nimport { BackgroundColorFormatRenderer } from '../format/formatPart/BackgroundColorFormatRenderer';\nimport { ContentModelBlockFormat, ContentModelTableRow } from 'roosterjs-content-model-types';\nimport { ContentModelBlockGroupView } from './ContentModelBlockGroupView';\nimport { ContentModelView } from '../ContentModelView';\nimport { FormatRenderer } from '../format/utils/FormatRenderer';\nimport { FormatView } from '../format/FormatView';\nimport { hasSelectionInBlockGroup } from 'roosterjs-content-model-core';\nimport { useProperty } from '../../hooks/useProperty';\n\nconst styles = require('./ContentModelTableRowView.scss');\n\nconst TableRowFormatRenderers: FormatRenderer<ContentModelBlockFormat>[] = [\n    BackgroundColorFormatRenderer,\n];\n\nexport function ContentModelTableRowView(props: { row: ContentModelTableRow }) {\n    const { row } = props;\n    const [height, setHeight] = useProperty(row.height);\n    const textBoxRef = React.useRef<HTMLInputElement>(null);\n    const onChange = React.useCallback(() => {\n        const newValue = parseInt(textBoxRef.current.value);\n        row.height = newValue;\n        setHeight(newValue);\n    }, [row]);\n\n    const getContent = React.useCallback(() => {\n        return (\n            <>\n                <div>\n                    Height:\n                    <input\n                        type=\"number\"\n                        value={height}\n                        onChange={onChange}\n                        ref={textBoxRef}\n                        className={styles.sizeInput}\n                    />\n                </div>\n                {row.cells.map((cell, j) => (\n                    <ContentModelBlockGroupView group={cell} key={j} />\n                ))}\n            </>\n        );\n    }, [row]);\n\n    const getFormat = React.useCallback(() => {\n        return <FormatView format={row.format} renderers={TableRowFormatRenderers} />;\n    }, [row.format]);\n\n    return (\n        <ContentModelView\n            title=\"Table Row\"\n            isExpanded={false}\n            className={styles.modelTableRow}\n            hasSelection={row.cells.some(cell => hasSelectionInBlockGroup(cell))}\n            jsonSource={row}\n            getContent={getContent}\n            getFormat={getFormat}\n        />\n    );\n}\n","import * as React from 'react';\nimport { BackgroundColorFormatRenderer } from '../format/formatPart/BackgroundColorFormatRenderer';\nimport { BorderBoxFormatRenderer } from '../format/formatPart/BorderBoxFormatRenderer';\nimport { BorderFormatRenderers } from '../format/formatPart/BorderFormatRenderers';\nimport { ContentModelTable, ContentModelTableFormat } from 'roosterjs-content-model-types';\nimport { ContentModelTableRowView } from './ContentModelTableRowView';\nimport { ContentModelView } from '../ContentModelView';\nimport { DisplayFormatRenderer } from '../format/formatPart/DisplayFormatRenderer';\nimport { FormatRenderer } from '../format/utils/FormatRenderer';\nimport { FormatView } from '../format/FormatView';\nimport { hasSelectionInBlock } from 'roosterjs-content-model-core';\nimport { IdFormatRenderer } from '../format/formatPart/IdFormatRenderer';\nimport { MarginFormatRenderer } from '../format/formatPart/MarginFormatRenderer';\nimport { MetadataView } from '../format/MetadataView';\nimport { SpacingFormatRenderer } from '../format/formatPart/SpacingFormatRenderer';\nimport { TableLayoutFormatRenderer } from '../format/formatPart/TableLayoutFormatRenderer';\nimport { TableMetadataFormatRenders } from '../format/formatPart/TableMetadataFormatRenders';\nimport { updateTableMetadata } from 'roosterjs-content-model-core';\nimport { useProperty } from '../../hooks/useProperty';\n\nconst styles = require('./ContentModelTableView.scss');\n\nconst TableFormatRenderers: FormatRenderer<ContentModelTableFormat>[] = [\n    IdFormatRenderer,\n    SpacingFormatRenderer,\n    BackgroundColorFormatRenderer,\n    MarginFormatRenderer,\n    ...BorderFormatRenderers,\n    BorderBoxFormatRenderer,\n    DisplayFormatRenderer,\n    TableLayoutFormatRenderer,\n];\n\nexport function ContentModelTableView(props: { table: ContentModelTable }) {\n    const { table } = props;\n    const getContent = React.useCallback(() => {\n        return (\n            <>\n                <div>\n                    Widths:\n                    {table.widths.map((_, index) => (\n                        <NumberView values={table.widths} index={index} key={index} />\n                    ))}\n                </div>\n                {table.rows.map((row, i) => (\n                    <ContentModelTableRowView row={row} key={i} />\n                ))}\n            </>\n        );\n    }, [table]);\n\n    const getFormat = React.useCallback(() => {\n        return <FormatView format={table.format} renderers={TableFormatRenderers} />;\n    }, [table.format]);\n\n    const getMetadata = React.useCallback(() => {\n        return (\n            <MetadataView\n                model={table}\n                renderers={TableMetadataFormatRenders}\n                updater={updateTableMetadata}\n            />\n        );\n    }, [table]);\n\n    return (\n        <ContentModelView\n            title=\"Table\"\n            subTitle={`${table.rows.length} x ${table.rows[0]?.cells.length || 0}`}\n            isExpanded={true}\n            className={styles.modelTable}\n            hasSelection={hasSelectionInBlock(table)}\n            jsonSource={table}\n            getContent={getContent}\n            getFormat={getFormat}\n            getMetadata={getMetadata}\n        />\n    );\n}\n\nfunction NumberView(props: { values: number[]; index: number }) {\n    const { values, index } = props;\n    const textBoxRef = React.useRef<HTMLInputElement>(null);\n    const [value, setValue] = useProperty(values[index]);\n    const onChange = React.useCallback(() => {\n        const newValue = parseInt(textBoxRef.current.value);\n        values[index] = newValue;\n        setValue(newValue);\n    }, [values, index]);\n\n    return (\n        <input\n            type=\"number\"\n            value={value}\n            onChange={onChange}\n            ref={textBoxRef}\n            className={styles.sizeInput}\n        />\n    );\n}\n","import * as React from 'react';\nimport { ContentModelCodeView } from './ContentModelCodeView';\nimport { ContentModelLinkView } from './ContentModelLinkView';\nimport { ContentModelText } from 'roosterjs-content-model-types';\nimport { ContentModelView } from '../ContentModelView';\nimport { SegmentFormatView } from '../format/SegmentFormatView';\nimport { useProperty } from '../../hooks/useProperty';\n\nconst styles = require('./ContentModelTextView.scss');\n\nexport function ContentModelTextView(props: { text: ContentModelText }) {\n    const { text } = props;\n    const [value, setValue] = useProperty(text.text);\n\n    const textArea = React.useRef<HTMLTextAreaElement>(null);\n    const onChange = React.useCallback(() => {\n        const newValue = textArea.current.value;\n        text.text = newValue;\n        setValue(newValue);\n    }, [text, setValue]);\n\n    const getContent = React.useCallback(() => {\n        return (\n            <>\n                <textarea ref={textArea} onChange={onChange} value={value} />\n                {text.link ? <ContentModelLinkView link={text.link} /> : null}\n                {text.code ? <ContentModelCodeView code={text.code} /> : null}\n            </>\n        );\n    }, [text, value, text.link]);\n\n    const getFormat = React.useCallback(() => {\n        return <SegmentFormatView format={text.format} />;\n    }, [text.format]);\n\n    return (\n        <ContentModelView\n            title=\"Text\"\n            subTitle={value}\n            className={styles.modelText}\n            isSelected={text.isSelected}\n            jsonSource={text}\n            getContent={getContent}\n            getFormat={getFormat}\n        />\n    );\n}\n","import * as React from 'react';\nimport { createUIUtilities, ReactEditorPlugin, UIUtilities } from 'roosterjs-react';\nimport { divProperties, getNativeProps } from '@fluentui/react/lib/Utilities';\nimport { EditorAdapter, EditorAdapterOptions } from 'roosterjs-editor-adapter';\nimport { EditorOptions, EditorPlugin, IEditor } from 'roosterjs-content-model-types';\nimport { useTheme } from '@fluentui/react/lib/Theme';\nimport type { EditorPlugin as LegacyEditorPlugin } from 'roosterjs-editor-types';\n\n/**\n * Properties for Rooster react component\n */\nexport interface ContentModelRoosterProps\n    extends EditorAdapterOptions,\n        React.HTMLAttributes<HTMLDivElement> {\n    /**\n     * Creator function used for creating the instance of roosterjs editor.\n     * Use this callback when you have your own sub class of roosterjs Editor or force trigging a reset of editor\n     */\n    editorCreator?: (div: HTMLDivElement, options: EditorOptions) => IEditor;\n\n    /**\n     * Whether editor should get focus once it is created\n     * Changing of this value after editor is created will not reset editor\n     */\n    focusOnInit?: boolean;\n}\n\n/**\n * Main component of react wrapper for roosterjs\n * @param props Properties of this component\n * @returns The react component\n */\nexport default function ContentModelRooster(props: ContentModelRoosterProps) {\n    const editorDiv = React.useRef<HTMLDivElement>(null);\n    const editor = React.useRef<IEditor | null>(null);\n    const theme = useTheme();\n\n    const { focusOnInit, editorCreator, inDarkMode, plugins, legacyPlugins } = props;\n\n    React.useEffect(() => {\n        if (editorDiv.current) {\n            const uiUtilities = createUIUtilities(editorDiv.current, theme);\n\n            setUIUtilities(uiUtilities, plugins);\n            setUIUtilities(uiUtilities, legacyPlugins);\n        }\n    }, [theme, editorCreator]);\n\n    React.useEffect(() => {\n        if (editorDiv.current) {\n            editor.current = (editorCreator || defaultEditorCreator)(editorDiv.current, props);\n        }\n\n        if (focusOnInit) {\n            editor.current?.focus();\n        }\n\n        return () => {\n            if (editor.current) {\n                editor.current.dispose();\n                editor.current = null;\n            }\n        };\n    }, [editorCreator]);\n\n    React.useEffect(() => {\n        editor.current?.setDarkModeState(!!inDarkMode);\n    }, [inDarkMode]);\n\n    const divProps = getNativeProps<React.HTMLAttributes<HTMLDivElement>>(props, divProperties);\n    return <div ref={editorDiv} tabIndex={0} {...(divProps || {})}></div>;\n}\n\nfunction setUIUtilities(\n    uiUtilities: UIUtilities,\n    plugins: (LegacyEditorPlugin | EditorPlugin)[] | undefined\n) {\n    plugins?.forEach(plugin => {\n        if (isReactEditorPlugin(plugin)) {\n            plugin.setUIUtilities(uiUtilities);\n        }\n    });\n}\n\nfunction defaultEditorCreator(div: HTMLDivElement, options: EditorAdapterOptions) {\n    return new EditorAdapter(div, options);\n}\n\nfunction isReactEditorPlugin(\n    plugin: LegacyEditorPlugin | EditorPlugin\n): plugin is ReactEditorPlugin {\n    return !!(plugin as ReactEditorPlugin)?.setUIUtilities;\n}\n","import * as React from 'react';\n\nexport function useProperty<V>(currentValue: V): [V, (value: V) => void] {\n    const [value, setValue] = React.useState(currentValue);\n\n    React.useEffect(() => {\n        setValue(currentValue);\n    }, [currentValue]);\n\n    return [value, setValue];\n}\n","import MainPaneBase from '../../MainPaneBase';\nimport { applySegmentFormat, getFormatState } from 'roosterjs-content-model-api';\nimport {\n    ContentModelSegmentFormat,\n    EditorPlugin,\n    IEditor,\n    PluginEvent,\n} from 'roosterjs-content-model-types';\n\nconst FORMATPAINTERCURSOR_SVG = require('./formatpaintercursor.svg');\nconst FORMATPAINTERCURSOR_STYLE = `cursor: url(\"${FORMATPAINTERCURSOR_SVG}\") 8.5 16, auto`;\n\nexport default class ContentModelFormatPainterPlugin implements EditorPlugin {\n    private editor: IEditor | null = null;\n    private styleNode: HTMLStyleElement | null = null;\n    private painterFormat: ContentModelSegmentFormat | null = null;\n    private static instance: ContentModelFormatPainterPlugin | undefined;\n\n    constructor() {\n        ContentModelFormatPainterPlugin.instance = this;\n    }\n\n    getName() {\n        return 'FormatPainter';\n    }\n\n    initialize(editor: IEditor) {\n        this.editor = editor;\n\n        const doc = this.editor.getDocument();\n        this.styleNode = doc.createElement('style');\n\n        doc.head.appendChild(this.styleNode);\n    }\n\n    dispose() {\n        this.editor = null;\n\n        if (this.styleNode) {\n            this.styleNode.parentNode?.removeChild(this.styleNode);\n            this.styleNode = null;\n        }\n    }\n\n    onPluginEvent(event: PluginEvent) {\n        if (this.editor && event.eventType == 'mouseUp') {\n            if (this.painterFormat) {\n                applySegmentFormat(this.editor, this.painterFormat);\n\n                this.setFormatPainterCursor(null);\n            }\n        }\n    }\n\n    private setFormatPainterCursor(format: ContentModelSegmentFormat | null) {\n        const sheet = this.styleNode.sheet;\n\n        if (this.painterFormat) {\n            for (let i = sheet.cssRules.length - 1; i >= 0; i--) {\n                sheet.deleteRule(i);\n            }\n        }\n\n        this.painterFormat = format;\n\n        if (this.painterFormat) {\n            sheet.insertRule(`#${MainPaneBase.editorDivId} {${FORMATPAINTERCURSOR_STYLE}}`);\n        }\n    }\n\n    static startFormatPainter() {\n        const format = getSegmentFormat(this.instance.editor);\n\n        if (format) {\n            this.instance.setFormatPainterCursor(format);\n        }\n    }\n}\n\nfunction getSegmentFormat(editor: IEditor): ContentModelSegmentFormat {\n    const formatState = getFormatState(editor);\n\n    return {\n        backgroundColor: formatState.backgroundColor,\n        fontFamily: formatState.fontName,\n        fontSize: formatState.fontSize,\n        fontWeight: formatState.isBold ? 'bold' : 'normal',\n        italic: formatState.isItalic,\n        letterSpacing: formatState.letterSpacing,\n        strikethrough: formatState.isStrikeThrough,\n        superOrSubScriptSequence: formatState.isSubscript\n            ? 'sub'\n            : formatState.isSuperscript\n            ? 'super'\n            : '',\n        textColor: formatState.textColor,\n        underline: formatState.isUnderline,\n    };\n}\n","import BuildInPluginState, { BuildInPluginList, UrlPlaceholder } from './BuildInPluginState';\nimport { Announce } from 'roosterjs-editor-plugins/lib/Announce';\nimport { AutoFormat } from 'roosterjs-editor-plugins/lib/AutoFormat';\nimport { ContentEdit } from 'roosterjs-editor-plugins/lib/ContentEdit';\nimport { CustomReplace as CustomReplacePlugin } from 'roosterjs-editor-plugins/lib/CustomReplace';\nimport { CutPasteListChain } from 'roosterjs-editor-plugins/lib/CutPasteListChain';\nimport { EditorPlugin, KnownAnnounceStrings } from 'roosterjs-editor-types';\nimport { HyperLink } from 'roosterjs-editor-plugins/lib/HyperLink';\nimport { ImageEdit } from 'roosterjs-editor-plugins/lib/ImageEdit';\nimport { Paste } from 'roosterjs-editor-plugins/lib/Paste';\nimport { TableCellSelection } from 'roosterjs-editor-plugins/lib/TableCellSelection';\nimport { Watermark } from 'roosterjs-editor-plugins/lib/Watermark';\nimport {\n    createContextMenuPlugin,\n    createImageEditMenuProvider,\n    createListEditMenuProvider,\n    createTableEditMenuProvider,\n} from 'roosterjs-react/lib/contextMenu';\n\nexport default function getToggleablePlugins(initState: BuildInPluginState) {\n    const { pluginList, linkTitle } = initState;\n    const imageEdit = pluginList.imageEdit\n        ? new ImageEdit({\n              preserveRatio: initState.forcePreserveRatio,\n              applyChangesOnMouseUp: initState.applyChangesOnMouseUp,\n          })\n        : null;\n\n    const plugins: Record<keyof BuildInPluginList, EditorPlugin | null> = {\n        contentEdit: pluginList.contentEdit ? new ContentEdit(initState.contentEditFeatures) : null,\n        hyperlink: pluginList.hyperlink\n            ? new HyperLink(\n                  linkTitle?.indexOf(UrlPlaceholder) >= 0\n                      ? url => linkTitle.replace(UrlPlaceholder, url)\n                      : linkTitle\n                      ? () => linkTitle\n                      : null\n              )\n            : null,\n        paste: pluginList.paste ? new Paste() : null,\n        watermark: pluginList.watermark ? new Watermark(initState.watermarkText) : null,\n        imageEdit,\n        cutPasteListChain: pluginList.cutPasteListChain ? new CutPasteListChain() : null,\n        tableCellSelection: pluginList.tableCellSelection ? new TableCellSelection() : null,\n        customReplace: pluginList.customReplace ? new CustomReplacePlugin() : null,\n        autoFormat: pluginList.autoFormat ? new AutoFormat() : null,\n        listEditMenu:\n            pluginList.contextMenu && pluginList.listEditMenu ? createListEditMenuProvider() : null,\n        imageEditMenu:\n            pluginList.contextMenu && pluginList.imageEditMenu && imageEdit\n                ? createImageEditMenuProvider(imageEdit)\n                : null,\n        tableEditMenu:\n            pluginList.contextMenu && pluginList.tableEditMenu\n                ? createTableEditMenuProvider()\n                : null,\n        contextMenu: pluginList.contextMenu ? createContextMenuPlugin() : null,\n        announce: pluginList.announce ? new Announce(getDefaultStringsMap()) : null,\n    };\n\n    return Object.values(plugins);\n}\n\nfunction getDefaultStringsMap(): Map<KnownAnnounceStrings, string> {\n    return new Map<KnownAnnounceStrings, string>([\n        [KnownAnnounceStrings.AnnounceListItemBullet, 'Autocorrected Bullet'],\n        [KnownAnnounceStrings.AnnounceListItemNumbering, 'Autocorrected {0}'],\n        [\n            KnownAnnounceStrings.AnnounceOnFocusLastCell,\n            'Warning, pressing tab here adds an extra row.',\n        ],\n    ]);\n}\n","import * as React from 'react';\nimport ContentModelRibbonButton from './ContentModelRibbonButton';\nimport RibbonPlugin from './RibbonPlugin';\nimport { CommandBar, ICommandBarItemProps, ICommandBarProps } from '@fluentui/react/lib/CommandBar';\nimport { FocusZoneDirection } from '@fluentui/react/lib/FocusZone';\nimport { FormatState } from 'roosterjs-editor-types';\nimport { getLocalizedString, LocalizedStrings } from 'roosterjs-react';\nimport { getObjectKeys } from 'roosterjs-content-model-dom';\nimport { IContextualMenuItem, IContextualMenuItemProps } from '@fluentui/react/lib/ContextualMenu';\nimport { IRenderFunction } from '@fluentui/react/lib/Utilities';\nimport { mergeStyles } from '@fluentui/react/lib/Styling';\nimport { moreCommands } from './moreCommands';\n\nconst ribbonClassName = mergeStyles({\n    '& .ms-CommandBar': {\n        padding: '0px',\n    },\n});\n\nconst rtlIcon = mergeStyles({\n    transform: 'scaleX(-1)',\n});\n\ninterface RibbonProps<T extends string> extends Partial<ICommandBarProps> {\n    /**\n     * The ribbon plugin used for connect editor and the ribbon\n     */\n    plugin: RibbonPlugin;\n\n    /**\n     * Buttons in this ribbon\n     */\n    buttons: ContentModelRibbonButton<T>[];\n\n    /**\n     * A dictionary of localized strings for all buttons.\n     * Key of the dictionary is the key of each button, value will be the string or a function to return the string\n     */\n    strings?: LocalizedStrings<T>;\n}\n\n/**\n * The format ribbon component of roosterjs-react\n * @param props Properties of format ribbon component\n * @returns The format ribbon component\n */\nexport function ContentModelRibbon<T extends string>(props: RibbonProps<T>) {\n    const { plugin, buttons, strings, dir } = props;\n    const [formatState, setFormatState] = React.useState<FormatState | null>(null);\n    const isRtl = dir == 'rtl';\n\n    const onClick = React.useCallback(\n        (_, item?: IContextualMenuItem) => {\n            if (item) {\n                plugin?.onButtonClick<string>(item.data, item.key, strings);\n            }\n        },\n        [plugin, strings]\n    );\n\n    const onHover = React.useCallback(\n        (button: ContentModelRibbonButton<T>, key: string) => {\n            plugin.startLivePreview<T>(button, key as T, strings);\n        },\n        [plugin, strings]\n    );\n\n    const onDismiss = React.useCallback(() => {\n        plugin.stopLivePreview();\n    }, [plugin]);\n\n    const flipIcon = React.useCallback(\n        (\n            props?: IContextualMenuItemProps,\n            defaultRender?: (props?: IContextualMenuItemProps) => JSX.Element | null\n        ): JSX.Element | null => {\n            if (!defaultRender) {\n                return null;\n            }\n            return <span className={rtlIcon}>{defaultRender(props)}</span>;\n        },\n        []\n    );\n\n    const commandBarItems = React.useMemo((): ICommandBarItemProps[] => {\n        return buttons.map(\n            (button): ICommandBarItemProps => {\n                const selectedItem =\n                    formatState && button.dropDownMenu?.getSelectedItemKey?.(formatState);\n                const dropDownMenu = button.dropDownMenu;\n\n                const result: ICommandBarItemProps = {\n                    key: button.key,\n                    data: button,\n                    iconProps: {\n                        iconName: button.iconName,\n                    },\n                    onRenderIcon: isRtl && button.flipWhenRtl ? flipIcon : undefined,\n                    iconOnly: true,\n                    text: getLocalizedString(strings, button.key, button.unlocalizedText),\n                    ariaLabel: getLocalizedString(strings, button.key, button.unlocalizedText),\n                    canCheck: true,\n                    checked: (formatState && button.isChecked?.(formatState)) || false,\n                    disabled: (formatState && button.isDisabled?.(formatState)) || false,\n                    ...(button.commandBarProperties || {}),\n                };\n\n                const contextMenuItemRenderer: IRenderFunction<IContextualMenuItem> = (\n                    props,\n                    defaultRenderer\n                ) =>\n                    props && defaultRenderer ? (\n                        <div onMouseOver={e => onHover(button, props.key)}>\n                            {defaultRenderer(props)}\n                        </div>\n                    ) : null;\n\n                if (dropDownMenu) {\n                    result.subMenuProps = {\n                        shouldFocusOnMount: true,\n                        focusZoneProps: { direction: FocusZoneDirection.bidirectional },\n                        onMenuDismissed: onDismiss,\n                        onItemClick: onClick,\n                        onRenderContextualMenuItem: dropDownMenu.allowLivePreview\n                            ? contextMenuItemRenderer\n                            : undefined,\n                        items: getObjectKeys(dropDownMenu.items).map(key => ({\n                            key: key,\n                            text: getLocalizedString<string, string>(\n                                strings,\n                                key,\n                                dropDownMenu.items[key]\n                            ),\n                            data: button,\n                            canCheck: !!dropDownMenu.getSelectedItemKey,\n                            checked: selectedItem == key || false,\n                            className: dropDownMenu.itemClassName,\n                            onRender: dropDownMenu.itemRender\n                                ? item => dropDownMenu.itemRender!(item, onClick)\n                                : undefined,\n                        })),\n                        ...(dropDownMenu.commandBarSubMenuProperties || {}),\n                    };\n                } else {\n                    result.onClick = onClick;\n                }\n\n                return result;\n            }\n        );\n    }, [buttons, formatState, isRtl, strings, onClick, onDismiss, onHover]);\n\n    React.useEffect(() => {\n        const disposer = plugin?.registerFormatChangedCallback(setFormatState);\n\n        return () => {\n            disposer?.();\n        };\n    }, [plugin]);\n\n    const moreCommandsBtn = moreCommands as ContentModelRibbonButton<string>;\n\n    return (\n        <CommandBar\n            items={commandBarItems}\n            {...props}\n            className={ribbonClassName + ' ' + (props?.className || '')}\n            overflowButtonProps={{\n                ariaLabel: getLocalizedString<string, string>(\n                    strings,\n                    moreCommandsBtn.key,\n                    moreCommandsBtn.unlocalizedText\n                ),\n                ...props?.overflowButtonProps,\n            }}\n        />\n    );\n}\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport RibbonPlugin from './RibbonPlugin';\nimport { FormatState } from 'roosterjs-editor-types';\nimport { getFormatState } from 'roosterjs-content-model-api';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\nimport { LocalizedStrings, UIUtilities } from 'roosterjs-react';\nimport { ContentModelFormatState, IEditor, PluginEvent } from 'roosterjs-content-model-types';\n\nexport class ContentModelRibbonPlugin implements RibbonPlugin {\n    private editor: IEditor | null = null;\n    private onFormatChanged: ((formatState: FormatState) => void) | null = null;\n    private timer = 0;\n    private formatState: ContentModelFormatState | null = null;\n    private uiUtilities: UIUtilities | null = null;\n\n    /**\n     * Construct a new instance of RibbonPlugin object\n     * @param delayUpdateTime The time to wait before refresh the button when user do some editing operation in editor\n     */\n    constructor(private delayUpdateTime: number = 200) {}\n\n    /**\n     * Get a friendly name of this plugin\n     */\n    getName() {\n        return 'Ribbon';\n    }\n\n    /**\n     * Initialize this plugin\n     * @param editor The editor instance\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n    }\n\n    /**\n     * Dispose this plugin\n     */\n    dispose() {\n        this.editor = null;\n    }\n\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    onPluginEvent(event: PluginEvent) {\n        switch (event.eventType) {\n            case 'editorReady':\n            case 'contentChanged':\n            case 'zoomChanged':\n                this.updateFormat();\n                break;\n\n            case 'keyDown':\n            case 'mouseUp':\n                this.delayUpdate();\n                break;\n        }\n    }\n\n    /**\n     * Set the UI utilities objects to this plugin to help render additional UI elements\n     * @param uiUtilities The UI utilities object to set\n     */\n    setUIUtilities(uiUtilities: UIUtilities) {\n        this.uiUtilities = uiUtilities;\n    }\n\n    /**\n     * Register a callback to be invoked when format state of editor is changed, returns a disposer function.\n     */\n    registerFormatChangedCallback(callback: (formatState: FormatState) => void) {\n        this.onFormatChanged = callback;\n\n        return () => {\n            this.onFormatChanged = null;\n        };\n    }\n\n    /**\n     * When user clicks on a button, call this method to let the plugin to handle this click event\n     * @param button The button that is clicked\n     * @param key Key of child menu item that is clicked if any\n     * @param strings The localized string map for this button\n     */\n    onButtonClick<T extends string>(\n        button: ContentModelRibbonButton<T>,\n        key: T,\n        strings?: LocalizedStrings<T>\n    ) {\n        if (this.editor && this.uiUtilities) {\n            this.editor.stopShadowEdit();\n\n            button.onClick(this.editor, key, strings, this.uiUtilities);\n\n            if (button.isChecked || button.isDisabled || button.dropDownMenu?.getSelectedItemKey) {\n                this.updateFormat();\n            }\n        }\n    }\n\n    /**\n     * Enter live preview state (shadow edit) of editor if there is a non-collapsed selection\n     * @param button The button that triggered this action\n     * @param key Key of the hovered button sub item\n     * @param strings The localized string map for this button\n     */\n    startLivePreview<T extends string>(\n        button: ContentModelRibbonButton<T>,\n        key: T,\n        strings?: LocalizedStrings<T>\n    ) {\n        if (this.editor && this.uiUtilities) {\n            const isInShadowEdit = this.editor.isInShadowEdit();\n\n            // If editor is already in shadow edit, no need to check again.\n            // And the check result may be incorrect because the content is changed from last shadow edit and the cached selection path won't apply\n            const range = !isInShadowEdit && this.editor.getDOMSelection();\n\n            if (isInShadowEdit || (range && (range.type != 'range' || !range.range.collapsed))) {\n                this.editor.startShadowEdit();\n                button.onClick(this.editor, key, strings, this.uiUtilities);\n            }\n        }\n    }\n\n    /**\n     * Leave live preview state (shadow edit) of editor\n     */\n    stopLivePreview() {\n        this.editor?.stopShadowEdit();\n    }\n\n    private delayUpdate() {\n        const window = this.editor?.getDocument().defaultView;\n\n        if (!window) {\n            return;\n        }\n\n        if (this.timer) {\n            window.clearTimeout(this.timer);\n        }\n\n        this.timer = window.setTimeout(() => {\n            this.timer = 0;\n            this.updateFormat?.();\n        }, this.delayUpdateTime);\n    }\n\n    private updateFormat() {\n        if (this.editor && this.onFormatChanged) {\n            const newFormatState = getFormatState(this.editor);\n\n            if (\n                !this.formatState ||\n                getObjectKeys(newFormatState).some(\n                    key => newFormatState[key] != this.formatState?.[key]\n                )\n            ) {\n                this.formatState = newFormatState;\n                this.onFormatChanged(newFormatState);\n            }\n        }\n    }\n}\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setAlignment } from 'roosterjs-content-model-api';\nimport { AlignCenterButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Align center\" button on the format ribbon\n */\nexport const alignCenterButton: ContentModelRibbonButton<AlignCenterButtonStringKey> = {\n    key: 'buttonNameAlignCenter',\n    unlocalizedText: 'Align center',\n    iconName: 'AlignCenter',\n    onClick: editor => {\n        setAlignment(editor, 'center');\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setAlignment } from 'roosterjs-content-model-api';\n\n/**\n * @internal\n * \"Align justify\" button on the format ribbon\n */\nexport const alignJustifyButton: ContentModelRibbonButton<'buttonNameAlignJustify'> = {\n    key: 'buttonNameAlignJustify',\n    unlocalizedText: 'Align justify',\n    iconName: 'AlignJustify',\n    onClick: editor => {\n        setAlignment(editor, 'justify');\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setAlignment } from 'roosterjs-content-model-api';\nimport { AlignLeftButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Align left\" button on the format ribbon\n */\nexport const alignLeftButton: ContentModelRibbonButton<AlignLeftButtonStringKey> = {\n    key: 'buttonNameAlignLeft',\n    unlocalizedText: 'Align left',\n    iconName: 'AlignLeft',\n    onClick: editor => {\n        setAlignment(editor, 'left');\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setAlignment } from 'roosterjs-content-model-api';\nimport { AlignRightButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Align right\" button on the format ribbon\n */\nexport const alignRightButton: ContentModelRibbonButton<AlignRightButtonStringKey> = {\n    key: 'buttonNameAlignRight',\n    unlocalizedText: 'Align right',\n    iconName: 'AlignRight',\n    onClick: editor => {\n        setAlignment(editor, 'right');\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setBackgroundColor } from 'roosterjs-content-model-api';\nimport {\n    BackgroundColorButtonStringKey,\n    getBackgroundColorValue,\n    getButtons,\n    KnownRibbonButtonKey,\n    RibbonButton,\n} from 'roosterjs-react';\n\nconst originalButton = getButtons([KnownRibbonButtonKey.BackgroundColor])[0] as RibbonButton<\n    BackgroundColorButtonStringKey\n>;\n\n/**\n * @internal\n * \"Background color\" button on the format ribbon\n */\nexport const backgroundColorButton: ContentModelRibbonButton<BackgroundColorButtonStringKey> = {\n    ...originalButton,\n    onClick: (editor, key) => {\n        // This check will always be true, add it here just to satisfy compiler\n        if (key != 'buttonNameBackgroundColor') {\n            setBackgroundColor(editor, getBackgroundColorValue(key).lightModeColor);\n        }\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { toggleBlockQuote } from 'roosterjs-content-model-api';\nimport { QuoteButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Block quote\" button on the format ribbon\n */\nexport const blockQuoteButton: ContentModelRibbonButton<QuoteButtonStringKey> = {\n    key: 'buttonNameQuote',\n    unlocalizedText: 'Quote',\n    iconName: 'RightDoubleQuote',\n    isChecked: formatState => !!formatState.isBlockQuote,\n    onClick: editor => {\n        toggleBlockQuote(editor);\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { BoldButtonStringKey } from 'roosterjs-react';\nimport { toggleBold } from 'roosterjs-content-model-api';\n\n/**\n * @internal\n * \"Bold\" button on the format ribbon\n */\nexport const boldButton: ContentModelRibbonButton<BoldButtonStringKey> = {\n    key: 'buttonNameBold',\n    unlocalizedText: 'Bold',\n    iconName: 'Bold',\n    isChecked: formatState => formatState.isBold,\n    onClick: editor => {\n        toggleBold(editor);\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { toggleBullet } from 'roosterjs-content-model-api';\nimport { BulletedListButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Bulleted list\" button on the format ribbon\n */\nexport const bulletedListButton: ContentModelRibbonButton<BulletedListButtonStringKey> = {\n    key: 'buttonNameBulletedList',\n    unlocalizedText: 'Bulleted list',\n    iconName: 'BulletedList',\n    isChecked: formatState => formatState.isBullet,\n    onClick: editor => {\n        toggleBullet(editor);\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { changeImage } from 'roosterjs-content-model-api';\nimport { createElement } from 'roosterjs-editor-dom';\nimport { CreateElementData } from 'roosterjs-editor-types';\n\nconst FileInput: CreateElementData = {\n    tag: 'input',\n    attributes: {\n        type: 'file',\n        accept: 'image/*',\n        display: 'none',\n    },\n};\n\n/**\n * @internal\n * \"Change Image\" button on the format ribbon\n */\nexport const changeImageButton: ContentModelRibbonButton<'buttonNameChangeImage'> = {\n    key: 'buttonNameChangeImage',\n    unlocalizedText: 'Change Image',\n    iconName: 'ImageSearch',\n    isDisabled: formatState => !formatState.canAddImageAltText,\n    onClick: editor => {\n        const document = editor.getDocument();\n        const fileInput = createElement(FileInput, document) as HTMLInputElement;\n        document.body.appendChild(fileInput);\n\n        fileInput.addEventListener('change', () => {\n            if (fileInput.files) {\n                for (let i = 0; i < fileInput.files.length; i++) {\n                    changeImage(editor, fileInput.files[i]);\n                }\n            }\n        });\n\n        try {\n            fileInput.click();\n        } finally {\n            document.body.removeChild(fileInput);\n        }\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { clearFormat } from 'roosterjs-content-model-api';\nimport { ClearFormatButtonStringKey } from 'roosterjs-react';\n\n/**\n * \"Clear format\" button on the format ribbon\n */\nexport const clearFormatButton: ContentModelRibbonButton<ClearFormatButtonStringKey> = {\n    key: 'buttonNameClearFormat',\n    unlocalizedText: 'Clear format',\n    iconName: 'ClearFormatting',\n    onClick: editor => {\n        clearFormat(editor);\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { toggleCode } from 'roosterjs-content-model-api';\nimport { CodeButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Code\" button on the format ribbon\n */\nexport const codeButton: ContentModelRibbonButton<CodeButtonStringKey> = {\n    key: 'buttonNameCode',\n    unlocalizedText: 'Code',\n    iconName: 'Code',\n    isChecked: formatState => !!formatState.isCodeInline,\n    onClick: editor => {\n        toggleCode(editor);\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport MainPaneBase from '../../MainPaneBase';\n\n/**\n * Key of localized strings of Dark mode button\n */\nexport type DarkModeButtonStringKey = 'buttonNameDarkMode';\n\n/**\n * \"Dark mode\" button on the format ribbon\n */\nexport const darkMode: ContentModelRibbonButton<DarkModeButtonStringKey> = {\n    key: 'buttonNameDarkMode',\n    unlocalizedText: 'Dark Mode',\n    iconName: 'ClearNight',\n    isChecked: formatState => formatState.isDarkMode,\n    onClick: editor => {\n        editor.focus();\n\n        // Let main pane know this state change so that it can be persisted when pop out/pop in\n        MainPaneBase.getInstance().toggleDarkMode();\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { changeFontSize } from 'roosterjs-content-model-api';\nimport { DecreaseFontSizeButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Decrease font size\" button on the format ribbon\n */\nexport const decreaseFontSizeButton: ContentModelRibbonButton<DecreaseFontSizeButtonStringKey> = {\n    key: 'buttonNameDecreaseFontSize',\n    unlocalizedText: 'Decrease font size',\n    iconName: 'FontDecrease',\n    onClick: editor => {\n        changeFontSize(editor, 'decrease');\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setIndentation } from 'roosterjs-content-model-api';\nimport { DecreaseIndentButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Decrease indent\" button on the format ribbon\n */\nexport const decreaseIndentButton: ContentModelRibbonButton<DecreaseIndentButtonStringKey> = {\n    key: 'buttonNameDecreaseIndent',\n    unlocalizedText: 'Decrease indent',\n    iconName: 'DecreaseIndentLegacy',\n    flipWhenRtl: true,\n    onClick: editor => {\n        setIndentation(editor, 'outdent');\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { exportContent as exportContentApi } from 'roosterjs-content-model-core';\n\n/**\n * Key of localized strings of Zoom button\n */\nexport type ExportButtonStringKey = 'buttonNameExport';\n\n/**\n * \"Export content\" button on the format ribbon\n */\nexport const exportContent: ContentModelRibbonButton<ExportButtonStringKey> = {\n    key: 'buttonNameExport',\n    unlocalizedText: 'Export',\n    iconName: 'Export',\n    flipWhenRtl: true,\n    onClick: editor => {\n        const win = editor.getDocument().defaultView.open();\n        const html = exportContentApi(editor);\n        win.document.write(editor.getTrustedHTMLHandler()(html));\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setFontName } from 'roosterjs-content-model-api';\nimport { FontButtonStringKey } from 'roosterjs-react';\n\ninterface FontName {\n    name: string;\n    family: string;\n    localizedName?: string;\n}\nconst FontNames: FontName[] = [\n    { name: 'Arial', family: 'Arial,Helvetica,sans-serif' },\n    { name: 'Arial Black', family: \"'Arial Black',Arial,sans-serif\" },\n    { name: 'Calibri', family: 'Calibri,Helvetica,sans-serif' },\n    { name: 'Calibri Light', family: \"'Calibri Light','Helvetica Light',sans-serif\" },\n    { name: 'Cambria', family: 'Cambria,Georgia,serif' },\n    { name: 'Candara', family: 'Candara,Optima,sans-serif' },\n    { name: 'Century Gothic', family: \"'Century Gothic',sans-serif\" },\n    { name: 'Comic Sans MS', family: \"'Comic Sans MS',Chalkboard,cursive\" },\n    { name: 'Consolas', family: 'Consolas,Courier,monospace' },\n    { name: 'Constantia', family: \"Constantia,'Hoefler Text',serif\" },\n    { name: 'Corbel', family: 'Corbel,Skia,sans-serif' },\n    { name: 'Courier New', family: \"'Courier New',monospace\" },\n    {\n        name: 'Franklin Gothic Book',\n        family: \"'Franklin Gothic Book','Avenir Next Condensed',sans-serif\",\n    },\n    {\n        name: 'Franklin Gothic Demi',\n        family: \"'Franklin Gothic Demi','Avenir Next Condensed Demi Bold',sans-serif\",\n    },\n    {\n        name: 'Franklin Gothic Medium',\n        family: \"'Franklin Gothic Medium','Avenir Next Condensed Medium',sans-serif\",\n    },\n    { name: 'Garamond', family: 'Garamond,Georgia,serif' },\n    { name: 'Georgia', family: 'Georgia,serif' },\n    { name: 'Impact', family: 'Impact,Charcoal,sans-serif' },\n    { name: 'Lucida Console', family: \"'Lucida Console',Monaco,monospace\" },\n    { name: 'Lucida Handwriting', family: \"'Lucida Handwriting','Apple Chancery',cursive\" },\n    { name: 'Lucida Sans Unicode', family: \"'Lucida Sans Unicode','Lucida Grande',sans-serif\" },\n    { name: 'Palatino Linotype', family: \"'Palatino Linotype','Book Antiqua',Palatino,serif\" },\n    {\n        name: 'Segoe UI',\n        family: \"'Segoe UI', 'Segoe UI Web (West European)', 'Helvetica Neue', sans-serif\",\n    },\n    { name: 'Sitka Heading', family: \"'Sitka Heading',Cochin,serif\" },\n    { name: 'Sitka Text', family: \"'Sitka Text',Cochin,serif\" },\n    { name: 'Tahoma', family: 'Tahoma,Geneva,sans-serif' },\n    { name: 'Times', family: \"Times,'Times New Roman',serif\" },\n    { name: 'Times New Roman', family: \"'Times New Roman',Times,serif\" },\n    { name: 'Trebuchet MS', family: \"'Trebuchet MS',Trebuchet,sans-serif\" },\n    { name: 'TW Cen MT', family: \"'TW Cen MT','Century Gothic',sans-serif\" },\n    { name: 'Verdana', family: 'Verdana,Geneva,sans-serif' },\n    { name: '-', family: 'FontDivider0' }, //divider between fonts for different scripts (order is by style)\n    {\n        name: 'Microsoft YaHei',\n        family: \"'Microsoft YaHei','',STHeiti,sans-serif\",\n        localizedName: '',\n    }, //chineseS Microsoft recommended font\n    { name: 'SimHei', family: \"SimHei,'',STHeiti,sans-serif\", localizedName: '' }, //chineseS\n    {\n        name: 'NSimSun',\n        family: \"NSimSun,'',SimSun,'',SimSun-ExtB,'-ExtB',STSong,serif\",\n        localizedName: '',\n    }, //chineseS\n    { name: 'FangSong', family: \"FangSong,'',STFangsong,serif\", localizedName: '' }, //chineseS\n    { name: 'SimLi', family: \"SimLi,'','Baoli SC',serif\", localizedName: '' }, //chineseS\n    { name: 'KaiTi', family: \"KaiTi,'',STKaiti,serif\", localizedName: '' }, //chineseS\n    { name: '-', family: 'FontDivider1' }, //divider between fonts for different scripts (order is by style)\n    {\n        name: 'Microsoft JhengHei',\n        family: \"'Microsoft JhengHei','','Apple LiGothic',sans-serif\",\n        localizedName: '',\n    }, //chineseT Microsoft recommended font\n    {\n        name: 'PMingLiU',\n        family: \"PMingLiU,'',PMingLiU-ExtB,'-ExtB','Apple LiSung',serif\",\n        localizedName: '',\n    }, //chineseT\n    { name: 'DFKai-SB', family: \"DFKai-SB,'','BiauKai',serif\", localizedName: '' }, //chineseT\n    { name: '-', family: 'FontDivider2' }, //divider between fonts for different scripts (order is alphabetical by foundry)\n    {\n        name: 'Meiryo',\n        family: \"Meiryo,'','Hiragino Sans',sans-serif\",\n        localizedName: '',\n    }, //japanese\n    {\n        name: 'MS PGothic',\n        family:\n            \"'MS PGothic',' ','MS Gothic',' ','Hiragino Kaku Gothic ProN',sans-serif\",\n        localizedName: ' ',\n    }, //japanese\n    {\n        name: 'MS PMincho',\n        family: \"'MS PMincho',' ','MS Mincho',' ','Hiragino Mincho ProN',serif\",\n        localizedName: ' ',\n    }, //japanese\n    {\n        name: 'Yu Gothic',\n        family: \"'Yu Gothic','','YuGothic',sans-serif\",\n        localizedName: '',\n    }, //japanese\n    { name: 'Yu Mincho', family: \"'Yu Mincho','','YuMincho',serif\", localizedName: '' }, //japanese\n    { name: '-', family: 'FontDivider3' }, //divider between fonts for different scripts (order is for legacy reasons)\n    {\n        name: 'Malgun Gothic',\n        family: \"'Malgun Gothic',' ',AppleGothic,sans-serif\",\n        localizedName: ' ',\n    }, //korean Microsoft recommended font\n    { name: 'Gulim', family: \"Gulim,'','Nanum Gothic',sans-serif\", localizedName: '' }, //korean\n    { name: 'Dotum', family: \"Dotum,'',AppleGothic,sans-serif\", localizedName: '' }, //korean\n    { name: 'Batang', family: \"Batang,'',AppleMyungjo,serif\", localizedName: '' }, //korean\n    { name: 'BatangChe', family: \"BatangChe,'',AppleMyungjo,serif\", localizedName: '' }, //korean\n    { name: 'Gungsuh', family: \"Gungsuh,'',GungSeo,serif\", localizedName: '' }, //korean\n    { name: '-', family: 'FontDivider4' }, //divider between fonts for different scripts (order is alphabetical)\n    { name: 'Leelawadee UI', family: \"'Leelawadee UI',Thonburi,sans-serif\" }, //thai Microsoft recommended font\n    { name: 'Angsana New', family: \"'Angsana New','Leelawadee UI',Sathu,serif\" }, //thai\n    { name: 'Cordia New', family: \"'Cordia New','Leelawadee UI',Silom,sans-serif\" }, //thai\n    { name: 'DaunPenh', family: \"DaunPenh,'Leelawadee UI','Khmer MN',sans-serif\" }, //khmer\n    { name: '-', family: 'FontDivider5' }, //divider between fonts for different scripts (order is alphabetical)\n    { name: 'Nirmala UI', family: \"'Nirmala UI',sans-serif\" }, //indic Microsoft recommended font\n    { name: 'Gautami', family: \"Gautami,'Nirmala UI','Telugu MN',sans-serif\" }, //indic\n    { name: 'Iskoola Pota', family: \"'Iskoola Pota','Nirmala UI','Sinhala MN',sans-serif\" }, //indic\n    { name: 'Kalinga', family: \"Kalinga,'Nirmala UI','Oriya MN',sans-serif\" }, //indic\n    { name: 'Kartika', family: \"Kartika,'Nirmala UI','Malayalam MN',sans-serif\" }, //indic\n    { name: 'Latha', family: \"Latha,'Nirmala UI','Tamil MN',sans-serif\" }, //indic\n    { name: 'Mangal', family: \"Mangal,'Nirmala UI','Devanagari Sangam MN',sans-serif\" }, //indic\n    { name: 'Raavi', family: \"Raavi,'Nirmala UI','Gurmukhi MN',sans-serif\" }, //indic\n    { name: 'Shruti', family: \"Shruti,'Nirmala UI','Gujarati Sangam MN',sans-serif\" }, //indic\n    { name: 'Tunga', family: \"Tunga,'Nirmala UI','Kannada MN',sans-serif\" }, //indic\n    { name: 'Vrinda', family: \"Vrinda,'Nirmala UI','Bangla MN',sans-serif\" }, //indic\n    { name: '-', family: 'FontDivider6' }, //divider between fonts for different scripts\n    { name: 'Nyala', family: 'Nyala,Kefa,sans-serif' }, //other-ethiopic\n    { name: 'Sylfaen', family: 'Sylfaen,Mshtakan,Menlo,serif' }, //other-armenian-georgian\n];\n\nconst DropDownItems = FontNames.reduce((items, font) => {\n    items[font.family] = font.localizedName || font.name;\n    return items;\n}, <Record<string, string>>{});\n\nconst LowerCaseFontMap = FontNames.reduce((items, font) => {\n    items[font.name.toLowerCase()] = font.family;\n    return items;\n}, <Record<string, string>>{});\n\nconst FirstFontRegex = /^['\"]?([^'\",]+)/i;\n\n/**\n * @internal\n * \"Font\" button on the format ribbon\n */\nexport const fontButton: ContentModelRibbonButton<FontButtonStringKey> = {\n    key: 'buttonNameFont',\n    unlocalizedText: 'Font',\n    iconName: 'Font',\n    dropDownMenu: {\n        items: DropDownItems,\n        getSelectedItemKey: formatState => {\n            const matches = formatState.fontName?.match(FirstFontRegex);\n            const firstName = matches?.[1]?.toLowerCase();\n            const selectedKey = (firstName && LowerCaseFontMap[firstName]) || '';\n\n            return selectedKey;\n        },\n        allowLivePreview: true,\n    },\n    onClick: (editor, font) => {\n        setFontName(editor, font);\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setFontSize } from 'roosterjs-content-model-api';\nimport { FontSizeButtonStringKey } from 'roosterjs-react';\n\nconst FONT_SIZES = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72];\n\n/**\n * @internal\n * \"Font Size\" button on the format ribbon\n */\nexport const fontSizeButton: ContentModelRibbonButton<FontSizeButtonStringKey> = {\n    key: 'buttonNameFontSize',\n    unlocalizedText: 'Font size',\n    iconName: 'FontSize',\n    dropDownMenu: {\n        items: FONT_SIZES.reduce((map, size) => {\n            map[size + 'pt'] = size.toString();\n            return map;\n        }, <Record<string, string>>{}),\n        getSelectedItemKey: formatState => formatState.fontSize,\n        allowLivePreview: true,\n    },\n    onClick: (editor, size) => {\n        setFontSize(editor, size);\n    },\n};\n","import ContentModelFormatPainterPlugin from '../../contentModel/plugins/ContentModelFormatPainterPlugin';\nimport ContentModelRibbonButton from './ContentModelRibbonButton';\n\n/**\n * @internal\n * \"Format Painter\" button on the format ribbon\n */\nexport const formatPainterButton: ContentModelRibbonButton<'formatPainter'> = {\n    key: 'formatPainter',\n    unlocalizedText: 'Format painter',\n    iconName: 'Brush',\n    onClick: editor => {\n        ContentModelFormatPainterPlugin.startFormatPainter();\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { formatTable } from 'roosterjs-content-model-api';\nimport { TableBorderFormat } from 'roosterjs-content-model-core';\nimport { TableMetadataFormat } from 'roosterjs-content-model-types';\n\nconst PREDEFINED_STYLES: Record<\n    string,\n    (color?: string, lightColor?: string) => TableMetadataFormat\n> = {\n    DEFAULT: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.Default /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    DEFAULT_WITH_BACKGROUND_COLOR: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.Default /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    GRID_WITHOUT_BORDER: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            true /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.NoSideBorders /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    LIST: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            null /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.Default /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    BANDED_ROWS_FIRST_COLUMN_NO_BORDER: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            true /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.FirstColumnHeaderExternal /** tableBorderFormat */,\n            '#B0B0B0' /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    EXTERNAL: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.ListWithSideBorders /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    NO_HEADER_VERTICAL: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.NoHeaderBorders /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    ESPECIAL_TYPE_1: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.EspecialType1 /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    ESPECIAL_TYPE_2: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.EspecialType2 /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    ESPECIAL_TYPE_3: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.EspecialType3 /** tableBorderFormat */,\n            lightColor /** bgColorEven */,\n            null /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    CLEAR: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.Clear /** tableBorderFormat */,\n            lightColor /** bgColorEven */,\n            null /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n};\n\nexport function createTableFormat(\n    topBorder?: string,\n    bottomBorder?: string,\n    verticalBorder?: string,\n    bandedRows?: boolean,\n    bandedColumns?: boolean,\n    headerRow?: boolean,\n    firstColumn?: boolean,\n    borderFormat?: number,\n    bgColorEven?: string,\n    bgColorOdd?: string,\n    headerRowColor?: string\n): TableMetadataFormat {\n    return {\n        topBorderColor: topBorder,\n        bottomBorderColor: bottomBorder,\n        verticalBorderColor: verticalBorder,\n        hasBandedRows: bandedRows,\n        bgColorEven: bgColorEven,\n        bgColorOdd: bgColorOdd,\n        hasBandedColumns: bandedColumns,\n        hasHeaderRow: headerRow,\n        headerRowColor: headerRowColor,\n        hasFirstColumn: firstColumn,\n        tableBorderFormat: borderFormat,\n    };\n}\n\nexport const formatTableButton: ContentModelRibbonButton<'ribbonButtonTableFormat'> = {\n    key: 'ribbonButtonTableFormat',\n    iconName: 'TableComputed',\n    unlocalizedText: 'Format Table',\n    isDisabled: formatState => !formatState.isInTable,\n    dropDownMenu: {\n        items: {\n            DEFAULT: 'Default',\n            DEFAULT_WITH_BACKGROUND_COLOR: 'Default with background color',\n            GRID_WITHOUT_BORDER: 'Gride without border',\n            LIST: 'list',\n            BANDED_ROWS_FIRST_COLUMN_NO_BORDER: 'Banded rows first column no border',\n            EXTERNAL: 'External',\n            NO_HEADER_VERTICAL: 'No header vertical',\n            ESPECIAL_TYPE_1: 'Especial type 1',\n            ESPECIAL_TYPE_2: 'Especial type 2',\n            ESPECIAL_TYPE_3: 'Especial type 3',\n            CLEAR: 'Clear',\n        },\n    },\n    onClick: (editor, key) => {\n        const format = PREDEFINED_STYLES[key]?.('#ABABAB', '#ABABAB20');\n\n        if (format) {\n            formatTable(editor, format);\n        }\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { getButtons, getTextColorValue, KnownRibbonButtonKey, RibbonButton } from 'roosterjs-react';\nimport { setImageBorder } from 'roosterjs-content-model-api';\n\nconst originalButton = getButtons([KnownRibbonButtonKey.TextColor])[0] as RibbonButton<\n    'buttonNameImageBorderColor'\n>;\n\n/**\n * @internal\n * \"Image Border Color\" button on the format ribbon\n */\nexport const imageBorderColorButton: ContentModelRibbonButton<'buttonNameImageBorderColor'> = {\n    ...originalButton,\n    unlocalizedText: 'Image Border Color',\n    iconName: 'Photo2',\n    isDisabled: formatState => !formatState.canAddImageAltText,\n    onClick: (editor, key) => {\n        // This check will always be true, add it here just to satisfy compiler\n        if (key != 'buttonNameImageBorderColor') {\n            setImageBorder(editor, { color: getTextColorValue(key).lightModeColor }, '5px');\n        }\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setImageBorder } from 'roosterjs-content-model-api';\n\n/**\n * @internal\n * \"Remove Image Border\" button on the format ribbon\n */\nexport const imageBorderRemoveButton: ContentModelRibbonButton<'buttonNameImageBorderRemove'> = {\n    key: 'buttonNameImageBorderRemove',\n    unlocalizedText: 'Remove Image Border',\n    iconName: 'Cancel',\n    isDisabled: formatState => !formatState.canAddImageAltText,\n    onClick: editor => {\n        setImageBorder(editor, null);\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setImageBorder } from 'roosterjs-content-model-api';\n\nconst STYLES: Record<string, string> = {\n    dashed: 'dashed',\n    dotted: 'dotted',\n    solid: 'solid',\n    double: 'doubled',\n    groove: 'groove',\n    ridge: 'ridge',\n    inset: 'inset',\n    outset: 'outset',\n};\n\n/**\n * @internal\n * \"Image Border Style\" button on the format ribbon\n */\nexport const imageBorderStyleButton: ContentModelRibbonButton<'buttonNameImageBorderStyle'> = {\n    key: 'buttonNameImageBorderStyle',\n    unlocalizedText: 'Image Border Style',\n    iconName: 'BorderDash',\n    isDisabled: formatState => !formatState.canAddImageAltText,\n    dropDownMenu: {\n        items: STYLES,\n        allowLivePreview: true,\n    },\n    onClick: (editor, style) => {\n        setImageBorder(editor, { style: style }, '5px');\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setImageBorder } from 'roosterjs-content-model-api';\n\nconst WIDTH = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72];\n\n/**\n * @internal\n * \"Image Border Width\" button on the format ribbon\n */\nexport const imageBorderWidthButton: ContentModelRibbonButton<'buttonNameImageBorderWidth'> = {\n    key: 'buttonNameImageBorderWidth',\n    unlocalizedText: 'Image Border Width',\n    iconName: 'Photo2',\n    isDisabled: formatState => !formatState.canAddImageAltText,\n    dropDownMenu: {\n        items: WIDTH.reduce((map, size) => {\n            map[size + 'pt'] = size.toString();\n            return map;\n        }, <Record<string, string>>{}),\n        allowLivePreview: true,\n    },\n    onClick: (editor, size) => {\n        setImageBorder(\n            editor,\n            {\n                width: size,\n            },\n            '5px'\n        );\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setImageBoxShadow } from 'roosterjs-content-model-api';\n\nconst STYLES_NAMES: Record<string, string> = {\n    noShadow: 'noShadow',\n    bottomRight: 'bottomRight',\n    bottom: 'bottom',\n    bottomLeft: 'bottomLeft',\n    right: 'right',\n    center: 'center',\n    left: 'left',\n    topRight: 'topRight',\n    top: 'top',\n    topLeft: 'topLeft',\n};\n\nconst STYLES: Record<string, string> = {\n    noShadow: '',\n    bottomRight: '4px 4px 3px #aaaaaa',\n    bottom: '0px 4px  3px 0px #aaaaaa',\n    bottomLeft: '-4px 4px 3px 3px #aaaaaa',\n    right: '4px 0px 3px 0px #aaaaaa',\n    center: '0px 0px 3px 3px #aaaaaa',\n    left: '-4px 0px 3px 0px #aaaaaa',\n    topRight: '4px -4px 3px 3px #aaaaaa',\n    top: '0px -4px 3px 0px #aaaaaa',\n    topLeft: '-4px -4px 3px 0px #aaaaaa',\n};\n\n/**\n * @internal\n * \"Image Shadow\" button on the format ribbon\n */\nexport const imageBoxShadowButton: ContentModelRibbonButton<'buttonNameImageBoxSHadow'> = {\n    key: 'buttonNameImageBoxSHadow',\n    unlocalizedText: 'Image Shadow',\n    iconName: 'Photo2',\n    isDisabled: formatState => !formatState.canAddImageAltText,\n    dropDownMenu: {\n        items: STYLES_NAMES,\n        allowLivePreview: true,\n    },\n    onClick: (editor, size) => {\n        setImageBoxShadow(editor, STYLES[size], STYLES[size].length ? '4px' : null);\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { changeFontSize } from 'roosterjs-content-model-api';\nimport { IncreaseFontSizeButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Increase font size\" button on the format ribbon\n */\nexport const increaseFontSizeButton: ContentModelRibbonButton<IncreaseFontSizeButtonStringKey> = {\n    key: 'buttonNameIncreaseFontSize',\n    unlocalizedText: 'Increase font size',\n    iconName: 'FontIncrease',\n    onClick: editor => {\n        changeFontSize(editor, 'increase');\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setIndentation } from 'roosterjs-content-model-api';\nimport { IncreaseIndentButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Increase indent\" button on the format ribbon\n */\nexport const increaseIndentButton: ContentModelRibbonButton<IncreaseIndentButtonStringKey> = {\n    key: 'buttonNameIncreaseIndent',\n    unlocalizedText: 'Increase indent',\n    iconName: 'IncreaseIndentLegacy',\n    flipWhenRtl: true,\n    onClick: editor => {\n        setIndentation(editor, 'indent');\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { createElement } from 'roosterjs-editor-dom';\nimport { CreateElementData } from 'roosterjs-editor-types';\nimport { insertImage } from 'roosterjs-content-model-api';\nimport { InsertImageButtonStringKey } from 'roosterjs-react';\n\nconst FileInput: CreateElementData = {\n    tag: 'input',\n    attributes: {\n        type: 'file',\n        accept: 'image/*',\n        display: 'none',\n    },\n};\n\n/**\n * @internal\n * \"Insert image\" button on the format ribbon\n */\nexport const insertImageButton: ContentModelRibbonButton<InsertImageButtonStringKey> = {\n    key: 'buttonNameInsertImage',\n    unlocalizedText: 'Insert image',\n    iconName: 'Photo2',\n    onClick: editor => {\n        const document = editor.getDocument();\n        const fileInput = createElement(FileInput, document) as HTMLInputElement;\n        document.body.appendChild(fileInput);\n\n        fileInput.addEventListener('change', () => {\n            if (fileInput.files) {\n                for (let i = 0; i < fileInput.files.length; i++) {\n                    insertImage(editor, fileInput.files[i]);\n                }\n            }\n        });\n\n        try {\n            fileInput.click();\n        } finally {\n            document.body.removeChild(fileInput);\n        }\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { adjustLinkSelection, insertLink } from 'roosterjs-content-model-api';\nimport { showInputDialog } from 'roosterjs-react/lib/inputDialog';\nimport { InsertLinkButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Insert link\" button on the format ribbon\n */\nexport const insertLinkButton: ContentModelRibbonButton<InsertLinkButtonStringKey> = {\n    key: 'buttonNameInsertLink',\n    unlocalizedText: 'Insert link',\n    iconName: 'Link',\n    // isDisabled: formatState => !!formatState.isMultilineSelection,\n    onClick: (editor, _, strings, uiUtilities) => {\n        const [displayText, url] = adjustLinkSelection(editor);\n        const items = {\n            url: {\n                autoFocus: true,\n                labelKey: 'insertLinkDialogUrl' as const,\n                unlocalizedLabel: 'Web address (URL)',\n                initValue: url,\n            },\n            displayText: {\n                labelKey: 'insertLinkDialogDisplayAs' as const,\n                unlocalizedLabel: 'Display as',\n                initValue: displayText,\n            },\n        };\n\n        showInputDialog(\n            uiUtilities,\n            'insertLinkTitle',\n            'Insert link',\n            items,\n            strings,\n            (itemName, newValue, values) => {\n                if (itemName == 'url' && values.displayText == values.url) {\n                    values.displayText = newValue;\n                    values.url = newValue;\n                    return values;\n                } else {\n                    return null;\n                }\n            }\n        ).then(result => {\n            editor.focus();\n\n            if (result && result.url && (result.displayText != displayText || result.url != url)) {\n                insertLink(editor, result.url, result.url, result.displayText);\n            }\n        });\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { getButtons, KnownRibbonButtonKey } from 'roosterjs-react';\nimport { insertTable } from 'roosterjs-content-model-api';\nimport { InsertTableButtonStringKey, RibbonButton } from 'roosterjs-react';\n\nconst originalPasteButton: RibbonButton<InsertTableButtonStringKey> = getButtons([\n    KnownRibbonButtonKey.InsertTable,\n])[0] as RibbonButton<InsertTableButtonStringKey>;\n\nexport const insertTableButton: ContentModelRibbonButton<InsertTableButtonStringKey> = {\n    ...originalPasteButton,\n    onClick: (editor, key) => {\n        const { row, col } = parseKey(key);\n        insertTable(editor, col, row);\n    },\n};\n\nfunction parseKey(key: string): { row: number; col: number } {\n    const [row, col] = key.split(',');\n    return {\n        row: parseInt(row),\n        col: parseInt(col),\n    };\n}\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { toggleItalic } from 'roosterjs-content-model-api';\nimport { ItalicButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Italic\" button on the format ribbon\n */\nexport const italicButton: ContentModelRibbonButton<ItalicButtonStringKey> = {\n    key: 'buttonNameItalic',\n    unlocalizedText: 'Italic',\n    iconName: 'Italic',\n    isChecked: formatState => formatState.isItalic,\n    onClick: editor => {\n        toggleItalic(editor);\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { CancelButtonStringKey, OkButtonStringKey } from 'roosterjs-react';\nimport { setListStartNumber } from 'roosterjs-content-model-api';\nimport { showInputDialog } from 'roosterjs-react/lib/inputDialog';\n\n/**\n * @internal\n * \"Bulleted list\" button on the format ribbon\n */\nexport const listStartNumberButton: ContentModelRibbonButton<\n    | 'ribbonButtonSetStartNumber'\n    | 'ribbonButtonSetStartNumberTo1'\n    | 'ribbonButtonSetStartNumberCustomize'\n    | OkButtonStringKey\n    | CancelButtonStringKey\n> = {\n    key: 'ribbonButtonSetStartNumber',\n    dropDownMenu: {\n        items: {\n            ribbonButtonSetStartNumberTo1: 'Restart at 1',\n            ribbonButtonSetStartNumberCustomize: 'Start numbering value',\n        },\n    },\n    unlocalizedText: 'Set list start number',\n    iconName: 'NumberSymbol',\n    isDisabled: formatState => !formatState.isNumbering,\n    onClick: (editor, key, strings, uiUtility) => {\n        if (key == 'ribbonButtonSetStartNumberCustomize') {\n            showInputDialog(\n                uiUtility,\n                'ribbonButtonSetStartNumberCustomize',\n                'Start numbering value',\n                {\n                    startNumber: {\n                        labelKey: null,\n                        unlocalizedLabel: null,\n                        initValue: '1',\n                    },\n                },\n                strings\n            ).then(values => {\n                const newValue = parseInt(values.startNumber);\n\n                if (newValue > 0) {\n                    setListStartNumber(editor, newValue);\n                }\n            });\n        } else {\n            setListStartNumber(editor, 1);\n        }\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setDirection } from 'roosterjs-content-model-api';\nimport { LtrButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Left to right\" button on the format ribbon\n */\nexport const ltrButton: ContentModelRibbonButton<LtrButtonStringKey> = {\n    key: 'buttonNameLtr',\n    unlocalizedText: 'Left to right',\n    iconName: 'BidiLtr',\n    onClick: editor => {\n        setDirection(editor, 'ltr');\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { MoreCommandsButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"More commands\" (overflow) button on the format ribbon\n */\nexport const moreCommands: ContentModelRibbonButton<MoreCommandsButtonStringKey> = {\n    key: 'buttonNameMoreCommands',\n    unlocalizedText: 'More commands',\n    iconName: 'MoreCommands',\n    onClick: () => {\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { toggleNumbering } from 'roosterjs-content-model-api';\nimport { NumberedListButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Numbering list\" button on the format ribbon\n */\nexport const numberedListButton: ContentModelRibbonButton<NumberedListButtonStringKey> = {\n    key: 'buttonNameNumberedList',\n    unlocalizedText: 'Numbered List',\n    iconName: 'NumberedList',\n    isChecked: formatState => formatState.isNumbering,\n    onClick: editor => {\n        toggleNumbering(editor);\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { extractClipboardItems } from 'roosterjs-editor-dom';\n\n/**\n * @internal\n * \"Paste\" button on the format ribbon\n */\nexport const pasteButton: ContentModelRibbonButton<'buttonNamePaste'> = {\n    key: 'buttonNamePaste',\n    unlocalizedText: 'Paste',\n    iconName: 'Paste',\n    onClick: async editor => {\n        const doc = editor.getDocument();\n        const clipboard = doc.defaultView.navigator.clipboard;\n        if (clipboard && clipboard.read) {\n            try {\n                const clipboardItems = await clipboard.read();\n                const dataTransferItems = await Promise.all(\n                    createDataTransferItems(clipboardItems)\n                );\n                const clipboardData = await extractClipboardItems(dataTransferItems);\n                editor.pasteFromClipboard(clipboardData);\n            } catch {}\n        }\n\n        return true;\n    },\n};\n\nconst createDataTransfer = (\n    kind: 'string' | 'file',\n    type: string,\n    blob: Blob\n): DataTransferItem => {\n    const file = blob as File;\n    return {\n        kind,\n        type,\n        getAsFile: () => file,\n        getAsString: (callback: (data: string) => void) => {\n            blob.text().then(callback);\n        },\n        webkitGetAsEntry: () => null,\n    };\n};\n\nconst createDataTransferItems = (data: ClipboardItems) => {\n    const isTEXT = (type: string) => type.startsWith('text/');\n    const isIMAGE = (type: string) => type.startsWith('image/');\n    const dataTransferItems: Promise<DataTransferItem>[] = [];\n    data.forEach(item => {\n        item.types.forEach(type => {\n            if (isTEXT(type) || isIMAGE(type)) {\n                dataTransferItems.push(\n                    item\n                        .getType(type)\n                        .then(blob =>\n                            createDataTransfer(isTEXT(type) ? 'string' : 'file', type, blob)\n                        )\n                );\n            }\n        });\n    });\n    return dataTransferItems;\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport MainPaneBase from '../../MainPaneBase';\n\n/**\n * Key of localized strings of Popout button\n */\nexport type PopoutButtonStringKey = 'buttonNamePopout';\n\n/**\n * \"Popout\" button on the format ribbon\n */\nexport const popout: ContentModelRibbonButton<PopoutButtonStringKey> = {\n    key: 'buttonNamePopout',\n    unlocalizedText: 'Open in a separate window',\n    iconName: 'OpenInNewWindow',\n    flipWhenRtl: true,\n    onClick: _ => {\n        MainPaneBase.getInstance().popout();\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { redo } from 'roosterjs-content-model-core';\nimport { RedoButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Undo\" button on the format ribbon\n */\nexport const redoButton: ContentModelRibbonButton<RedoButtonStringKey> = {\n    key: 'buttonNameRedo',\n    unlocalizedText: 'Redo',\n    iconName: 'Redo',\n    isDisabled: formatState => !formatState.canRedo,\n    onClick: editor => {\n        redo(editor);\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { removeLink } from 'roosterjs-content-model-api';\nimport { RemoveLinkButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Remove link\" button on the format ribbon\n */\nexport const removeLinkButton: ContentModelRibbonButton<RemoveLinkButtonStringKey> = {\n    key: 'buttonNameRemoveLink',\n    unlocalizedText: 'Remove link',\n    iconName: 'RemoveLink',\n    isDisabled: formatState => !formatState.canUnlink,\n    onClick: editor => {\n        removeLink(editor);\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { RtlButtonStringKey } from 'roosterjs-react';\nimport { setDirection } from 'roosterjs-content-model-api';\n\n/**\n * @internal\n * \"Right to left\" button on the format ribbon\n */\nexport const rtlButton: ContentModelRibbonButton<RtlButtonStringKey> = {\n    key: 'buttonNameRtl',\n    unlocalizedText: 'Right to left',\n    iconName: 'BidiRtl',\n    onClick: editor => {\n        setDirection(editor, 'rtl');\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { BulletListType } from 'roosterjs-content-model-core';\nimport { setListStyle } from 'roosterjs-content-model-api';\nconst dropDownMenuItems = {\n    [BulletListType.Disc]: 'Disc',\n    [BulletListType.Dash]: 'Dash',\n    [BulletListType.Square]: 'Square',\n    [BulletListType.ShortArrow]: 'ShortArrow',\n    [BulletListType.LongArrow]: 'LongArrow',\n    [BulletListType.UnfilledArrow]: 'UnfilledArrow',\n    [BulletListType.Hyphen]: 'Hyphen',\n    [BulletListType.DoubleLongArrow]: 'DoubleLongArrow',\n    [BulletListType.Circle]: 'Circle',\n};\n\nexport const setBulletedListStyleButton: ContentModelRibbonButton<'ribbonButtonBulletedListStyle'> = {\n    key: 'ribbonButtonBulletedListStyle',\n    dropDownMenu: { items: dropDownMenuItems },\n    unlocalizedText: 'Set unordered list style',\n    iconName: 'BulletedList',\n    isDisabled: formatState => !formatState.isBullet,\n    onClick: (editor, key) => {\n        const value = parseInt(key);\n\n        setListStyle(editor, {\n            unorderedStyleType: value,\n        });\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setHeadingLevel } from 'roosterjs-content-model-api';\nimport {\n    getButtons,\n    HeadingButtonStringKey,\n    KnownRibbonButtonKey,\n    RibbonButton,\n} from 'roosterjs-react';\n\nconst originalHeadingButton: RibbonButton<HeadingButtonStringKey> = getButtons([\n    KnownRibbonButtonKey.Heading,\n])[0] as RibbonButton<HeadingButtonStringKey>;\nconst keys: HeadingButtonStringKey[] = [\n    'buttonNameNoHeading',\n    'buttonNameHeading1',\n    'buttonNameHeading2',\n    'buttonNameHeading3',\n    'buttonNameHeading4',\n    'buttonNameHeading5',\n    'buttonNameHeading6',\n];\n\nexport const setHeadingLevelButton: ContentModelRibbonButton<HeadingButtonStringKey> = {\n    dropDownMenu: {\n        ...originalHeadingButton.dropDownMenu,\n    },\n    key: 'buttonNameHeading',\n    unlocalizedText: 'Heading',\n    iconName: 'Header1',\n    onClick: (editor, key) => {\n        const headingLevel = keys.indexOf(key);\n\n        setHeadingLevel(editor, headingLevel as 0 | 1 | 2 | 3 | 4 | 5 | 6);\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { NumberingListType } from 'roosterjs-content-model-core';\nimport { setListStyle } from 'roosterjs-content-model-api';\n\nconst dropDownMenuItems = {\n    [NumberingListType.Decimal]: 'Decimal',\n    [NumberingListType.DecimalDash]: 'DecimalDash',\n    [NumberingListType.DecimalParenthesis]: 'DecimalParenthesis',\n    [NumberingListType.DecimalDoubleParenthesis]: 'DecimalDoubleParenthesis',\n    [NumberingListType.LowerAlpha]: 'LowerAlpha',\n    [NumberingListType.LowerAlphaParenthesis]: 'LowerAlphaParenthesis',\n    [NumberingListType.LowerAlphaDoubleParenthesis]: 'LowerAlphaDoubleParenthesis',\n    [NumberingListType.LowerAlphaDash]: 'LowerAlphaDash',\n    [NumberingListType.UpperAlpha]: 'UpperAlpha',\n    [NumberingListType.UpperAlphaParenthesis]: 'UpperAlphaParenthesis',\n    [NumberingListType.UpperAlphaDoubleParenthesis]: 'UpperAlphaDoubleParenthesis',\n    [NumberingListType.UpperAlphaDash]: 'UpperAlphaDash',\n    [NumberingListType.LowerRoman]: 'LowerRoman',\n    [NumberingListType.LowerRomanParenthesis]: 'LowerRomanParenthesis',\n    [NumberingListType.LowerRomanDoubleParenthesis]: 'LowerRomanDoubleParenthesis',\n    [NumberingListType.LowerRomanDash]: 'LowerRomanDash',\n    [NumberingListType.UpperRoman]: 'UpperRoman',\n    [NumberingListType.UpperRomanParenthesis]: 'UpperRomanParenthesis',\n    [NumberingListType.UpperRomanDoubleParenthesis]: 'UpperRomanDoubleParenthesis',\n    [NumberingListType.UpperRomanDash]: 'UpperRomanDash',\n};\n\nexport const setNumberedListStyleButton: ContentModelRibbonButton<'ribbonButtonNumberedListStyle'> = {\n    key: 'ribbonButtonNumberedListStyle',\n    dropDownMenu: { items: dropDownMenuItems },\n    unlocalizedText: 'Set ordered list style',\n    iconName: 'NumberedList',\n    isDisabled: formatState => !formatState.isNumbering,\n    onClick: (editor, key) => {\n        const value = parseInt(key);\n\n        setListStyle(editor, {\n            orderedStyleType: value,\n        });\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setTableCellShade } from 'roosterjs-content-model-api';\nimport {\n    BackgroundColorKeys,\n    getBackgroundColorValue,\n    getButtons,\n    KnownRibbonButtonKey,\n    RibbonButton,\n} from 'roosterjs-react';\n\nconst originalBackgroundColorButton: RibbonButton<BackgroundColorKeys> = getButtons([\n    KnownRibbonButtonKey.BackgroundColor,\n])[0] as RibbonButton<BackgroundColorKeys>;\n\nexport const setTableCellShadeButton: ContentModelRibbonButton<\n    'ribbonButtonSetTableCellShade' | BackgroundColorKeys\n> = {\n    dropDownMenu: {\n        ...originalBackgroundColorButton.dropDownMenu,\n        allowLivePreview: true,\n    },\n    key: 'ribbonButtonSetTableCellShade',\n    unlocalizedText: 'Set table shade color',\n    iconName: 'BackgroundColor',\n    isDisabled: formatState => !formatState.isInTable,\n    onClick: (editor, key) => {\n        if (key != 'ribbonButtonSetTableCellShade') {\n            const color = getBackgroundColorValue(key);\n\n            // Content Model doesn't need dark mode color at this point, so always pass in light mode color\n            setTableCellShade(editor, color.lightModeColor);\n        }\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { formatTable, getFormatState } from 'roosterjs-content-model-api';\n\nexport const setTableHeaderButton: ContentModelRibbonButton<'ribbonButtonSetTableHeader'> = {\n    key: 'ribbonButtonSetTableHeader',\n    unlocalizedText: 'Toggle table header',\n    iconName: 'Header',\n    isDisabled: formatState => !formatState.isInTable,\n    onClick: editor => {\n        const format = getFormatState(editor);\n        formatTable(editor, { hasHeaderRow: !format.tableHasHeader }, true /*keepCellShade*/);\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { getFormatState, setParagraphMargin } from 'roosterjs-content-model-api';\n\nconst spaceAfterButtonKey = 'buttonNameSpaceAfter';\nconst spaceBeforeButtonKey = 'buttonNameSpaceBefore';\n\n/**\n * @internal\n * \"Add space after\" button on the format ribbon\n */\nexport const spaceAfterButton: ContentModelRibbonButton<typeof spaceAfterButtonKey> = {\n    key: spaceAfterButtonKey,\n    unlocalizedText: 'Remove space after',\n    iconName: 'CaretDown8',\n    isChecked: formatState => !formatState.marginBottom || parseInt(formatState.marginBottom) <= 0,\n    onClick: editor => {\n        const marginBottom = getFormatState(editor).marginBottom;\n        setParagraphMargin(\n            editor,\n            undefined /* marginTop */,\n            parseInt(marginBottom) ? null : '8pt'\n        );\n\n        return true;\n    },\n};\n\n/**\n * @internal\n * \"Add space before\" button on the format ribbon\n */\nexport const spaceBeforeButton: ContentModelRibbonButton<typeof spaceBeforeButtonKey> = {\n    key: spaceBeforeButtonKey,\n    unlocalizedText: 'Add space before',\n    iconName: 'CaretUp8',\n    isChecked: formatState => parseInt(formatState.marginTop) > 0,\n    onClick: editor => {\n        const marginTop = getFormatState(editor).marginTop;\n        setParagraphMargin(\n            editor,\n            parseInt(marginTop) ? null : '12pt',\n            undefined /* marginBottom */\n        );\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setSpacing } from 'roosterjs-content-model-api';\n\nconst SPACING_OPTIONS = ['1.0', '1.15', '1.5', '2.0'];\nconst NORMAL_SPACING = 1.2;\nconst spacingButtonKey = 'buttonNameSpacing';\n\nfunction findClosest(lineHeight?: string) {\n    if (Number.isNaN(+lineHeight)) {\n        return '';\n    }\n    const query = +lineHeight / NORMAL_SPACING;\n    return SPACING_OPTIONS.find(opt => Math.abs(query - +opt) < 0.05);\n}\n\n/**\n * @internal\n * \"Spacing\" button on the format ribbon\n */\nexport const spacingButton: ContentModelRibbonButton<typeof spacingButtonKey> = {\n    key: spacingButtonKey,\n    unlocalizedText: 'Spacing',\n    iconName: 'LineSpacing',\n    dropDownMenu: {\n        items: SPACING_OPTIONS.reduce((map, size) => {\n            map[size] = size;\n            return map;\n        }, <Record<string, string>>{}),\n        getSelectedItemKey: formatState => findClosest(formatState.lineHeight),\n        allowLivePreview: true,\n    },\n    onClick: (editor, size) => {\n        setSpacing(editor, +size * NORMAL_SPACING);\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { StrikethroughButtonStringKey } from 'roosterjs-react';\nimport { toggleStrikethrough } from 'roosterjs-content-model-api';\n\n/**\n * @internal\n * \"Strikethrough\" button on the format ribbon\n */\nexport const strikethroughButton: ContentModelRibbonButton<StrikethroughButtonStringKey> = {\n    key: 'buttonNameStrikethrough',\n    unlocalizedText: 'Strikethrough',\n    iconName: 'Strikethrough',\n    isChecked: formatState => formatState.isStrikeThrough,\n    onClick: editor => {\n        toggleStrikethrough(editor);\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { SubscriptButtonStringKey } from 'roosterjs-react';\nimport { toggleSubscript } from 'roosterjs-content-model-api';\n\n/**\n * @internal\n * \"Subscript\" button on the format ribbon\n */\nexport const subscriptButton: ContentModelRibbonButton<SubscriptButtonStringKey> = {\n    key: 'buttonNameSubscript',\n    unlocalizedText: 'Subscript',\n    iconName: 'Subscript',\n    isChecked: formatState => formatState.isSubscript,\n    onClick: editor => {\n        toggleSubscript(editor);\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { SuperscriptButtonStringKey } from 'roosterjs-react';\nimport { toggleSuperscript } from 'roosterjs-content-model-api';\n\n/**\n * @internal\n * \"Superscript\" button on the format ribbon\n */\nexport const superscriptButton: ContentModelRibbonButton<SuperscriptButtonStringKey> = {\n    key: 'buttonNameSuperscript',\n    unlocalizedText: 'Superscript',\n    iconName: 'Superscript',\n    isChecked: formatState => formatState.isSuperscript,\n    onClick: editor => {\n        toggleSuperscript(editor);\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport MainPaneBase from '../../MainPaneBase';\nimport { applyTableBorderFormat } from 'roosterjs-content-model-api';\nimport { BorderOperations } from 'roosterjs-content-model-types';\n\nconst TABLE_OPERATIONS: Record<string, BorderOperations> = {\n    menuNameTableAllBorder: 'allBorders',\n    menuNameTableNoBorder: 'noBorders',\n    menuNameTableLeftBorder: 'leftBorders',\n    menuNameTableRightBorder: 'rightBorders',\n    menuNameTableTopBorder: 'topBorders',\n    menuNameTableBottomBorder: 'bottomBorders',\n    menuNameTableInsideBorder: 'insideBorders',\n    menuNameTableOutsideBorder: 'outsideBorders',\n};\n\nexport const tableBorderApplyButton: ContentModelRibbonButton<'ribbonButtonTableBorder'> = {\n    key: 'ribbonButtonTableBorder',\n    iconName: 'TableComputed',\n    unlocalizedText: 'Table Border',\n    isDisabled: formatState => !formatState.isInTable,\n    dropDownMenu: {\n        items: {\n            menuNameTableAllBorder: 'All Borders',\n            menuNameTableNoBorder: 'No Borders',\n            menuNameTableLeftBorder: 'Left Borders',\n            menuNameTableRightBorder: 'Right Borders',\n            menuNameTableTopBorder: 'Top Borders',\n            menuNameTableBottomBorder: 'Bottom Borders',\n            menuNameTableInsideBorder: 'Inside Borders',\n            menuNameTableOutsideBorder: 'Outside Borders',\n        },\n    },\n    onClick: (editor, key) => {\n        const border = MainPaneBase.getInstance().getTableBorder();\n        applyTableBorderFormat(editor, border, TABLE_OPERATIONS[key]);\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport MainPaneBase from '../../MainPaneBase';\nimport { getButtons, getTextColorValue, KnownRibbonButtonKey, RibbonButton } from 'roosterjs-react';\n\nconst originalButton = getButtons([KnownRibbonButtonKey.TextColor])[0] as RibbonButton<\n    'buttonNameTableBorderColor'\n>;\n\n/**\n * @internal\n * \"Table Border Color\" button on the format ribbon\n */\nexport const tableBorderColorButton: ContentModelRibbonButton<'buttonNameTableBorderColor'> = {\n    ...originalButton,\n    unlocalizedText: 'Table Border Color',\n    iconName: 'ColorSolid',\n    isDisabled: formatState => !formatState.isInTable,\n    onClick: (editor, key) => {\n        // This check will always be true, add it here just to satisfy compiler\n        if (key != 'buttonNameTableBorderColor') {\n            MainPaneBase.getInstance().setTableBorderColor(getTextColorValue(key).lightModeColor);\n            editor.focus();\n        }\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport MainPaneBase from '../../MainPaneBase';\n\nconst STYLES: Record<string, string> = {\n    dashed: 'dashed',\n    dotted: 'dotted',\n    solid: 'solid',\n    double: 'doubled',\n    groove: 'groove',\n    ridge: 'ridge',\n    inset: 'inset',\n    outset: 'outset',\n};\n\n/**\n * @internal\n * \"Table Border Style\" button on the format ribbon\n */\nexport const tableBorderStyleButton: ContentModelRibbonButton<'buttonNameTableBorderStyle'> = {\n    key: 'buttonNameTableBorderStyle',\n    unlocalizedText: 'Table Border Style',\n    iconName: 'LineStyle',\n    isDisabled: formatState => !formatState.isInTable,\n    dropDownMenu: {\n        items: STYLES,\n        allowLivePreview: true,\n    },\n    onClick: (editor, style) => {\n        MainPaneBase.getInstance().setTableBorderStyle(style);\n        editor.focus();\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport MainPaneBase from '../../MainPaneBase';\n\nconst WIDTH = [0.25, 0.5, 0.75, 1, 1.5, 2.25, 3, 4.5, 6];\n\n/**\n * @internal\n * \"Table Border Width\" button on the format ribbon\n */\nexport const tableBorderWidthButton: ContentModelRibbonButton<'buttonNameTableBorderWidth'> = {\n    key: 'buttonNameTableBorderWidth',\n    unlocalizedText: 'Table Border Width',\n    iconName: 'LineThickness',\n    isDisabled: formatState => !formatState.isInTable,\n    dropDownMenu: {\n        items: WIDTH.reduce((map, size) => {\n            map[size + 'pt'] = size.toString();\n            return map;\n        }, <Record<string, string>>{}),\n        allowLivePreview: true,\n    },\n    onClick: (editor, width) => {\n        MainPaneBase.getInstance().setTableBorderWidth(width);\n        editor.focus();\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { editTable } from 'roosterjs-content-model-api';\nimport { TableOperation } from 'roosterjs-content-model-types';\nimport {\n    TableEditAlignMenuItemStringKey,\n    TableEditAlignTableMenuItemStringKey,\n    TableEditDeleteMenuItemStringKey,\n    TableEditInsertMenuItemStringKey,\n    TableEditMenuItemStringKey,\n    TableEditMergeMenuItemStringKey,\n    TableEditSplitMenuItemStringKey,\n} from 'roosterjs-react';\n\nconst TableEditOperationMap: Partial<Record<TableEditMenuItemStringKey, TableOperation>> = {\n    menuNameTableInsertAbove: 'insertAbove',\n    menuNameTableInsertBelow: 'insertBelow',\n    menuNameTableInsertLeft: 'insertLeft',\n    menuNameTableInsertRight: 'insertRight',\n    menuNameTableDeleteTable: 'deleteTable',\n    menuNameTableDeleteColumn: 'deleteColumn',\n    menuNameTableDeleteRow: 'deleteRow',\n    menuNameTableMergeAbove: 'mergeAbove',\n    menuNameTableMergeBelow: 'mergeBelow',\n    menuNameTableMergeLeft: 'mergeLeft',\n    menuNameTableMergeRight: 'mergeRight',\n    menuNameTableMergeCells: 'mergeCells',\n    menuNameTableSplitHorizontally: 'splitHorizontally',\n    menuNameTableSplitVertically: 'splitVertically',\n    menuNameTableAlignLeft: 'alignCellLeft',\n    menuNameTableAlignCenter: 'alignCellCenter',\n    menuNameTableAlignRight: 'alignCellRight',\n    menuNameTableAlignTop: 'alignCellTop',\n    menuNameTableAlignMiddle: 'alignCellMiddle',\n    menuNameTableAlignBottom: 'alignCellBottom',\n    menuNameTableAlignTableLeft: 'alignLeft',\n    menuNameTableAlignTableCenter: 'alignCenter',\n    menuNameTableAlignTableRight: 'alignRight',\n};\n\nexport const tableInsertButton: ContentModelRibbonButton<\n    'ribbonButtonTableInsert' | TableEditInsertMenuItemStringKey\n> = {\n    key: 'ribbonButtonTableInsert',\n    iconName: 'InsertColumnsRight',\n    unlocalizedText: 'Insert',\n    isDisabled: formatState => !formatState.isInTable,\n    dropDownMenu: {\n        items: {\n            menuNameTableInsertAbove: 'Insert above',\n            menuNameTableInsertBelow: 'Insert below',\n            menuNameTableInsertLeft: 'Insert left',\n            menuNameTableInsertRight: 'Insert right',\n        },\n    },\n    onClick: (editor, key) => {\n        if (key != 'ribbonButtonTableInsert') {\n            editTable(editor, TableEditOperationMap[key]);\n        }\n    },\n};\n\nexport const tableDeleteButton: ContentModelRibbonButton<\n    'ribbonButtonTableDelete' | TableEditDeleteMenuItemStringKey\n> = {\n    key: 'ribbonButtonTableDelete',\n    iconName: 'DeleteTable',\n    unlocalizedText: 'Delete',\n    isDisabled: formatState => !formatState.isInTable,\n    dropDownMenu: {\n        items: {\n            menuNameTableDeleteColumn: 'Delete column',\n            menuNameTableDeleteRow: 'Delete row',\n            menuNameTableDeleteTable: 'Delete table',\n        },\n    },\n    onClick: (editor, key) => {\n        if (key != 'ribbonButtonTableDelete') {\n            editTable(editor, TableEditOperationMap[key]);\n        }\n    },\n};\n\nexport const tableMergeButton: ContentModelRibbonButton<\n    'ribbonButtonTableMerge' | TableEditMergeMenuItemStringKey\n> = {\n    key: 'ribbonButtonTableMerge',\n    iconName: 'TableComputed',\n    unlocalizedText: 'Merge',\n    isDisabled: formatState => !formatState.isInTable,\n    dropDownMenu: {\n        items: {\n            menuNameTableMergeAbove: 'Merge above',\n            menuNameTableMergeBelow: 'Merge below',\n            menuNameTableMergeLeft: 'Merge left',\n            menuNameTableMergeRight: 'Merge right',\n            '-': '-',\n            menuNameTableMergeCells: 'Merge selected cells',\n        },\n    },\n    onClick: (editor, key) => {\n        if (key != 'ribbonButtonTableMerge') {\n            editTable(editor, TableEditOperationMap[key]);\n        }\n    },\n};\n\nexport const tableSplitButton: ContentModelRibbonButton<\n    'ribbonButtonTableSplit' | TableEditSplitMenuItemStringKey\n> = {\n    key: 'ribbonButtonTableSplit',\n    iconName: 'TableComputed',\n    unlocalizedText: 'Split',\n    isDisabled: formatState => !formatState.isInTable,\n    dropDownMenu: {\n        items: {\n            menuNameTableSplitHorizontally: 'Split horizontally',\n            menuNameTableSplitVertically: 'Split vertically',\n        },\n    },\n    onClick: (editor, key) => {\n        if (key != 'ribbonButtonTableSplit') {\n            editTable(editor, TableEditOperationMap[key]);\n        }\n    },\n};\n\nexport const tableAlignCellButton: ContentModelRibbonButton<\n    'ribbonButtonTableAlignCell' | TableEditAlignMenuItemStringKey\n> = {\n    key: 'ribbonButtonTableAlignCell',\n    iconName: 'TableComputed',\n    unlocalizedText: 'Align table cell',\n    isDisabled: formatState => !formatState.isInTable,\n    dropDownMenu: {\n        items: {\n            menuNameTableAlignLeft: 'Align left',\n            menuNameTableAlignCenter: 'Align center',\n            menuNameTableAlignRight: 'Align right',\n            '-': '-',\n            menuNameTableAlignTop: 'Align top',\n            menuNameTableAlignMiddle: 'Align middle',\n            menuNameTableAlignBottom: 'Align bottom',\n        },\n    },\n    onClick: (editor, key) => {\n        if (key != 'ribbonButtonTableAlignCell') {\n            editTable(editor, TableEditOperationMap[key]);\n        }\n    },\n};\n\nexport const tableAlignTableButton: ContentModelRibbonButton<\n    'ribbonButtonTableAlignTable' | TableEditAlignTableMenuItemStringKey\n> = {\n    key: 'ribbonButtonTableAlignTable',\n    iconName: 'TableComputed',\n    unlocalizedText: 'Align table',\n    isDisabled: formatState => !formatState.isInTable,\n    dropDownMenu: {\n        items: {\n            menuNameTableAlignTableLeft: 'Align left',\n            menuNameTableAlignTableCenter: 'Align center',\n            menuNameTableAlignTableRight: 'Align right',\n        },\n    },\n    onClick: (editor, key) => {\n        if (key != 'ribbonButtonTableAlignTable') {\n            editTable(editor, TableEditOperationMap[key]);\n        }\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { setTextColor } from 'roosterjs-content-model-api';\nimport {\n    getButtons,\n    getTextColorValue,\n    KnownRibbonButtonKey,\n    RibbonButton,\n    TextColorButtonStringKey,\n} from 'roosterjs-react';\n\nconst originalButton = getButtons([KnownRibbonButtonKey.TextColor])[0] as RibbonButton<\n    TextColorButtonStringKey\n>;\n\n/**\n * @internal\n * \"Text color\" button on the format ribbon\n */\nexport const textColorButton: ContentModelRibbonButton<TextColorButtonStringKey> = {\n    ...originalButton,\n    onClick: (editor, key) => {\n        // This check will always be true, add it here just to satisfy compiler\n        if (key != 'buttonNameTextColor') {\n            setTextColor(editor, getTextColorValue(key).lightModeColor);\n        }\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { toggleUnderline } from 'roosterjs-content-model-api';\nimport { UnderlineButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Underline\" button on the format ribbon\n */\nexport const underlineButton: ContentModelRibbonButton<UnderlineButtonStringKey> = {\n    key: 'buttonNameUnderline',\n    unlocalizedText: 'Underline',\n    iconName: 'Underline',\n    isChecked: formatState => formatState.isUnderline,\n    onClick: editor => {\n        toggleUnderline(editor);\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport { undo } from 'roosterjs-content-model-core';\nimport { UndoButtonStringKey } from 'roosterjs-react';\n\n/**\n * @internal\n * \"Undo\" button on the format ribbon\n */\nexport const undoButton: ContentModelRibbonButton<UndoButtonStringKey> = {\n    key: 'buttonNameUndo',\n    unlocalizedText: 'Undo',\n    iconName: 'undo',\n    isDisabled: formatState => !formatState.canUndo,\n    onClick: editor => {\n        undo(editor);\n\n        return true;\n    },\n};\n","import ContentModelRibbonButton from './ContentModelRibbonButton';\nimport MainPaneBase from '../../MainPaneBase';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\n\nconst DropDownItems = {\n    'zoom50%': '50%',\n    'zoom75%': '75%',\n    'zoom100%': '100%',\n    'zoom150%': '150%',\n    'zoom200%': '200%',\n};\n\nconst DropDownValues: { [key in keyof typeof DropDownItems]: number } = {\n    'zoom50%': 0.5,\n    'zoom75%': 0.75,\n    'zoom100%': 1,\n    'zoom150%': 1.5,\n    'zoom200%': 2,\n};\n\n/**\n * Key of localized strings of Zoom button\n */\nexport type ZoomButtonStringKey = 'buttonNameZoom';\n\n/**\n * \"Zoom\" button on the format ribbon\n */\nexport const zoom: ContentModelRibbonButton<ZoomButtonStringKey> = {\n    key: 'buttonNameZoom',\n    unlocalizedText: 'Zoom',\n    iconName: 'ZoomIn',\n    dropDownMenu: {\n        items: DropDownItems,\n        getSelectedItemKey: formatState =>\n            getObjectKeys(DropDownItems).filter(\n                key => DropDownValues[key] == formatState.zoomScale\n            )[0],\n    },\n    onClick: (editor, key) => {\n        const zoomScale = DropDownValues[key as keyof typeof DropDownItems];\n        editor.focus();\n\n        // Let main pane know this state change so that it can be persisted when pop out/pop in\n        MainPaneBase.getInstance().setScale(zoomScale);\n\n        editor.triggerEvent('zoomChanged', { newZoomScale: zoomScale });\n\n        return true;\n    },\n};\n","import MainPaneBase from '../MainPaneBase';\nimport { RibbonButton } from 'roosterjs-react';\n\n/**\n * Key of localized strings of Dark mode button\n */\nexport type DarkModeButtonStringKey = 'buttonNameDarkMode';\n\n/**\n * \"Dark mode\" button on the format ribbon\n */\nexport const darkMode: RibbonButton<DarkModeButtonStringKey> = {\n    key: 'buttonNameDarkMode',\n    unlocalizedText: 'Dark Mode',\n    iconName: 'ClearNight',\n    isChecked: formatState => formatState.isDarkMode,\n    onClick: editor => {\n        editor.setDarkModeState(!editor.isDarkMode());\n        editor.focus();\n\n        // Let main pane know this state change so that it can be persisted when pop out/pop in\n        MainPaneBase.getInstance().toggleDarkMode();\n        return true;\n    },\n};\n","import { RibbonButton } from 'roosterjs-react';\nimport { trustedHTMLHandler } from '../../utils/trustedHTMLHandler';\n\n/**\n * Key of localized strings of Zoom button\n */\nexport type ExportButtonStringKey = 'buttonNameExport';\n\n/**\n * \"Export content\" button on the format ribbon\n */\nexport const exportContent: RibbonButton<ExportButtonStringKey> = {\n    key: 'buttonNameExport',\n    unlocalizedText: 'Export',\n    iconName: 'Export',\n    flipWhenRtl: true,\n    onClick: editor => {\n        const win = editor.getDocument().defaultView.open();\n        win.document.write(trustedHTMLHandler(editor.getContent()));\n    },\n};\n","import MainPaneBase from '../MainPaneBase';\nimport { RibbonButton } from 'roosterjs-react';\n\n/**\n * Key of localized strings of Popout button\n */\nexport type PopoutButtonStringKey = 'buttonNamePopout';\n\n/**\n * \"Popout\" button on the format ribbon\n */\nexport const popout: RibbonButton<PopoutButtonStringKey> = {\n    key: 'buttonNamePopout',\n    unlocalizedText: 'Open in a separate window',\n    iconName: 'OpenInNewWindow',\n    flipWhenRtl: true,\n    onClick: _ => {\n        MainPaneBase.getInstance().popout();\n    },\n};\n","import MainPaneBase from '../MainPaneBase';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\nimport { RibbonButton } from 'roosterjs-react';\n\nconst DropDownItems = {\n    'zoom50%': '50%',\n    'zoom75%': '75%',\n    'zoom100%': '100%',\n    'zoom150%': '150%',\n    'zoom200%': '200%',\n};\n\nconst DropDownValues: { [key in keyof typeof DropDownItems]: number } = {\n    'zoom50%': 0.5,\n    'zoom75%': 0.75,\n    'zoom100%': 1,\n    'zoom150%': 1.5,\n    'zoom200%': 2,\n};\n\n/**\n * Key of localized strings of Zoom button\n */\nexport type ZoomButtonStringKey = 'buttonNameZoom';\n\n/**\n * \"Zoom\" button on the format ribbon\n */\nexport const zoom: RibbonButton<ZoomButtonStringKey> = {\n    key: 'buttonNameZoom',\n    unlocalizedText: 'Zoom',\n    iconName: 'ZoomIn',\n    dropDownMenu: {\n        items: DropDownItems,\n        getSelectedItemKey: formatState =>\n            getObjectKeys(DropDownItems).filter(\n                key => DropDownValues[key] == formatState.zoomScale\n            )[0],\n    },\n    onClick: (editor, key) => {\n        const zoomScale = DropDownValues[key as keyof typeof DropDownItems];\n        editor.setZoomScale(zoomScale);\n        editor.focus();\n\n        // Let main pane know this state change so that it can be persisted when pop out/pop in\n        MainPaneBase.getInstance().setScale(zoomScale);\n        return true;\n    },\n};\n","import { insertEntity } from 'roosterjs-editor-api';\nimport {\n    createNumberDefinition,\n    createObjectDefinition,\n    findClosestElementAncestor,\n    getEntityFromElement,\n    getEntitySelector,\n    getMetadata,\n    setMetadata,\n} from 'roosterjs-editor-dom';\nimport {\n    EditorPlugin,\n    Entity,\n    EntityOperation,\n    EntityState,\n    IEditor,\n    PluginEvent,\n    PluginEventType,\n} from 'roosterjs-editor-types';\n\nconst EntityType = 'SampleEntity';\n\ninterface EntityMetadata {\n    count: number;\n}\n\nconst EntityMetadataDefinition = createObjectDefinition<EntityMetadata>({\n    count: createNumberDefinition(),\n});\n\nexport default class SampleEntityPlugin implements EditorPlugin {\n    private editor: IEditor;\n\n    getName() {\n        return 'SampleEntity';\n    }\n\n    initialize(editor: IEditor) {\n        this.editor = editor;\n    }\n\n    dispose() {\n        this.editor = null;\n    }\n\n    onPluginEvent(event: PluginEvent) {\n        if (\n            event.eventType == PluginEventType.KeyDown &&\n            event.rawEvent.key == 'm' &&\n            event.rawEvent.ctrlKey\n        ) {\n            const entityNode = this.createEntity();\n            let entity: Entity | undefined;\n\n            this.editor.addUndoSnapshot(\n                () => {\n                    entity = insertEntity(this.editor, EntityType, entityNode, true, true);\n                },\n                undefined /*changeSource*/,\n                false /*canUndoByBackspace*/,\n                {\n                    getEntityState: () => this.getEntityStates(entity),\n                }\n            );\n\n            event.rawEvent.preventDefault();\n        } else if (\n            event.eventType == PluginEventType.EntityOperation &&\n            event.entity.type == EntityType\n        ) {\n            switch (event.operation) {\n                case EntityOperation.NewEntity:\n                    this.dehydrate(event.entity);\n                    this.hydrate(event.entity);\n\n                    event.shouldPersist = true;\n\n                    break;\n\n                case EntityOperation.RemoveFromEnd:\n                case EntityOperation.RemoveFromStart:\n                case EntityOperation.Overwrite:\n                case EntityOperation.ReplaceTemporaryContent:\n                    this.dehydrate(event.entity);\n\n                    break;\n\n                case EntityOperation.UpdateEntityState:\n                    if (event.state) {\n                        setMetadata(\n                            event.entity.wrapper,\n                            JSON.parse(event.state),\n                            EntityMetadataDefinition\n                        );\n                        this.updateEntity(event.entity);\n                    }\n\n                    break;\n            }\n        }\n    }\n\n    private hydrate(entity: Entity) {\n        const containerDiv = entity.wrapper.querySelector('div');\n\n        const span = document.createElement('span');\n        const button = document.createElement('button');\n\n        containerDiv.appendChild(span);\n        containerDiv.appendChild(button);\n\n        button.textContent = 'Test entity';\n        button.addEventListener('click', this.onClickEntity);\n\n        this.updateEntity(entity);\n    }\n\n    private dehydrate(entity: Entity) {\n        const containerDiv = entity.wrapper.querySelector('div');\n        const button = containerDiv.querySelector('button');\n\n        if (button) {\n            button.removeEventListener('click', this.onClickEntity);\n            containerDiv.removeChild(button);\n        }\n    }\n\n    private updateEntity(entity: Entity, increase: number = 0) {\n        const metadata = getMetadata<EntityMetadata>(entity.wrapper);\n        const count = (metadata?.count || 0) + increase;\n\n        setMetadata(entity.wrapper, {\n            count,\n        });\n\n        entity.wrapper.querySelector('span').textContent = 'Count: ' + count;\n    }\n\n    private createEntity() {\n        const div = document.createElement('div');\n\n        return div;\n    }\n\n    private onClickEntity = (e: MouseEvent) => {\n        const wrapper = findClosestElementAncestor(\n            e.target as Node,\n            undefined,\n            getEntitySelector(EntityType)\n        );\n        const entity = getEntityFromElement(wrapper);\n\n        if (entity) {\n            this.editor.addUndoSnapshot(\n                () => {\n                    this.updateEntity(entity, 1);\n                },\n                undefined /*changeSource*/,\n                false /*canUndoByBackspace*/,\n                {\n                    getEntityState: () => this.getEntityStates(entity),\n                }\n            );\n        }\n    };\n\n    private getEntityStates(entity: Entity | undefined): EntityState[] {\n        return entity\n            ? [\n                  {\n                      id: entity.id,\n                      type: entity.type,\n                      state: entity.wrapper.dataset.editingInfo,\n                  },\n              ]\n            : undefined;\n    }\n}\n","import * as React from 'react';\nimport SidePanePlugin from '../SidePanePlugin';\n\nconst classicStyles = require('./SidePane.scss');\nconst contentModelStyles = require('./ContentModelSidePane.scss');\nconst standaloneModelStyles = require('./StandaloneSidePane.scss');\n\nexport interface SidePaneProps {\n    plugins: SidePanePlugin[];\n    mode: 'classical' | 'contentModel' | 'standalone';\n    className?: string;\n}\n\nexport interface SidePaneState {\n    currentPane: SidePanePlugin;\n}\n\nexport default class SidePane extends React.Component<SidePaneProps, SidePaneState> {\n    private div = React.createRef<HTMLDivElement>();\n\n    constructor(props: SidePaneProps) {\n        super(props);\n        this.state = {\n            currentPane: this.props.plugins[0],\n        };\n\n        window.addEventListener('hashchange', this.updateStateFromHash);\n    }\n\n    componentDidMount() {\n        this.updateStateFromHash();\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('hashchange', this.updateStateFromHash);\n    }\n\n    render() {\n        const styles = this.getStyles();\n        const className = (this.props.className || '') + ' ' + styles.sidePane;\n\n        return (\n            <div className={className} ref={this.div}>\n                {this.props.plugins.map(this.renderSidePane)}\n            </div>\n        );\n    }\n\n    changeWidth(widthDelta: number) {\n        let div = this.div.current;\n        if (div) {\n            div.style.width = div.clientWidth + widthDelta + 'px';\n        }\n    }\n\n    updateHash = (pluginName?: string, path?: string[]) => {\n        window.location.hash =\n            (pluginName || this.state.currentPane.getName()) + (path ? '/' + path.join('/') : '');\n    };\n\n    private updateStateFromHash = () => {\n        let hash = window.location.hash;\n        let hashes = (hash ? hash.substr(1) : '').split('/');\n        let pluginName = hashes[0];\n        let plugin =\n            pluginName && this.props.plugins.filter(plugin => plugin.getName() == pluginName)[0];\n\n        if (plugin) {\n            this.setState({\n                currentPane: plugin,\n            });\n\n            window.setTimeout(() => {\n                hashes.splice(0, 1);\n                if (plugin.setHashPath) {\n                    plugin.setHashPath(hashes);\n                }\n            }, 0);\n        }\n    };\n\n    private renderSidePane = (plugin: SidePanePlugin): JSX.Element => {\n        const title = plugin.getTitle();\n        const isCurrent = this.state.currentPane == plugin;\n        const styles = this.getStyles();\n\n        return (\n            <div key={title} className={isCurrent ? styles.activePane : styles.inactivePane}>\n                <div className={styles.title} onClick={() => this.updateHash(plugin.getName())}>\n                    {title}\n                </div>\n                <div className={styles.bodyContainer}>\n                    <div className={styles.body}>{plugin.renderSidePane(this.updateHash)}</div>\n                </div>\n            </div>\n        );\n    };\n\n    private getStyles() {\n        return this.props.mode == 'contentModel'\n            ? contentModelStyles\n            : this.props.mode == 'standalone'\n            ? standaloneModelStyles\n            : classicStyles;\n    }\n}\n","import * as React from 'react';\nimport SidePanePlugin from '../SidePanePlugin';\nimport { IEditor } from 'roosterjs-editor-types';\nimport { SidePaneElement, SidePaneElementProps } from './SidePaneElement';\n\ninterface SidePaneComponent<P extends SidePaneElementProps>\n    extends React.Component<P, any>,\n        SidePaneElement {}\n\nexport default abstract class SidePanePluginImpl<\n    T extends SidePaneComponent<P>,\n    P extends SidePaneElementProps\n> implements SidePanePlugin {\n    protected editor: IEditor;\n    private component = React.createRef<T>();\n\n    constructor(\n        private readonly componentCtor: { new (props: P): T },\n        private readonly pluginName: string,\n        private readonly title: string\n    ) {}\n\n    getName() {\n        return this.pluginName;\n    }\n\n    initialize(editor: IEditor) {\n        this.editor = editor;\n    }\n\n    dispose() {\n        this.editor = null;\n    }\n\n    getTitle() {\n        return this.title;\n    }\n\n    renderSidePane(updateHash: (pluginName?: string, path?: string[]) => void) {\n        return React.createElement<P>(this.componentCtor, {\n            ...this.getComponentProps({\n                updateHash,\n            }),\n            ref: this.component,\n        });\n    }\n\n    setHashPath(path: string[]) {\n        if (this.component.current && this.component.current.setHashPath) {\n            this.component.current.setHashPath(path);\n        }\n    }\n\n    protected abstract getComponentProps(baseProps: SidePaneElementProps): P;\n\n    protected getComponent(callback: (component: T) => void) {\n        if (this.component.current) {\n            callback(this.component.current);\n        }\n    }\n}\n","import * as React from 'react';\nimport apiEntries, { ApiPlaygroundReactComponent } from './apiEntries';\nimport ApiPaneProps from './ApiPaneProps';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\nimport { PluginEvent } from 'roosterjs-editor-types';\nimport { SidePaneElement } from '../SidePaneElement';\n\nconst styles = require('./ApiPlaygroundPane.scss');\n\nexport interface ApiPlaygroundPaneState {\n    current: string;\n}\n\nexport default class ApiPlaygroundPane extends React.Component<ApiPaneProps, ApiPlaygroundPaneState>\n    implements SidePaneElement {\n    private select = React.createRef<HTMLSelectElement>();\n    private pane = React.createRef<ApiPlaygroundReactComponent>();\n    constructor(props: ApiPaneProps) {\n        super(props);\n        this.state = { current: 'empty' };\n    }\n\n    render() {\n        let componentClass = apiEntries[this.state.current].component;\n        let pane: JSX.Element = null;\n        if (componentClass) {\n            pane = React.createElement(componentClass, { ...this.props, ref: this.pane });\n        }\n\n        return (\n            <>\n                <div className={styles.header}>\n                    <h3>Select an API to try</h3>\n\n                    <select ref={this.select} value={this.state.current} onChange={this.onChange}>\n                        {getObjectKeys(apiEntries).map(key => (\n                            <option value={key} key={key}>\n                                {apiEntries[key].name}\n                            </option>\n                        ))}\n                    </select>\n                </div>\n                {pane}\n            </>\n        );\n    }\n\n    onPluginEvent(e: PluginEvent) {\n        if (this.pane.current && this.pane.current.onPluginEvent) {\n            this.pane.current.onPluginEvent(e);\n        }\n    }\n\n    setHashPath(path: string[]) {\n        let paneName = path && getObjectKeys(apiEntries).indexOf(path[0]) >= 0 ? path[0] : null;\n\n        if (paneName && paneName != this.state.current) {\n            this.setState({\n                current: paneName,\n            });\n        } else {\n            this.props.updateHash(null, [this.state.current]);\n        }\n    }\n\n    private onChange = () => {\n        this.props.updateHash(null, [this.select.current.value]);\n    };\n}\n","import ApiPaneProps from './ApiPaneProps';\nimport ApiPlaygroundPane from './ApiPlaygroundPane';\nimport SidePanePluginImpl from '../SidePanePluginImpl';\nimport { PluginEvent } from 'roosterjs-editor-types';\nimport { SidePaneElementProps } from '../SidePaneElement';\n\nexport default class ApiPlaygroundPlugin extends SidePanePluginImpl<\n    ApiPlaygroundPane,\n    ApiPaneProps\n> {\n    constructor() {\n        super(ApiPlaygroundPane, 'api', 'API Playground');\n    }\n\n    getComponentProps(base: SidePaneElementProps) {\n        return {\n            ...base,\n            getEditor: () => {\n                return this.editor;\n            },\n        };\n    }\n\n    onPluginEvent(e: PluginEvent) {\n        this.getComponent(component => component.onPluginEvent(e));\n    }\n}\n","import * as React from 'react';\nimport ApiPaneProps, { ApiPlaygroundComponent } from './ApiPaneProps';\nimport BlockElementsPane from './blockElements/BlockElementsPane';\nimport GetDarkColorPane from './darkColor/GetDarkColorPane';\nimport GetSelectedRegionsPane from './region/GetSelectedRegionsPane';\nimport GetSelectionPane from './getSelection/getSelectionPane';\nimport InsertContentPane from './insertContent/InsertContentPane';\nimport InsertEntityPane from './insertEntity/InsertEntityPane';\nimport MatchLinkPane from './matchLink/MatchLinkPane';\nimport SanitizerPane from './sanitizer/SanitizerPane';\nimport VListPane from './vlist/VListPane';\nimport VTablePane from './vtable/VTablePane';\n\nexport interface ApiPlaygroundReactComponent\n    extends React.Component<ApiPaneProps, any>,\n        ApiPlaygroundComponent {}\n\ninterface ApiEntry {\n    name: string;\n    component?: { new (prpos: ApiPaneProps): ApiPlaygroundReactComponent };\n}\n\nconst apiEntries: { [key: string]: ApiEntry } = {\n    empty: {\n        name: 'Please select',\n    },\n    block: {\n        name: 'Block Elements',\n        component: BlockElementsPane,\n    },\n    sanitizer: {\n        name: 'HTML Sanitizer',\n        component: SanitizerPane,\n    },\n    matchlink: {\n        name: 'Match Link',\n        component: MatchLinkPane,\n    },\n    insertContent: {\n        name: 'Insert Content',\n        component: InsertContentPane,\n    },\n    region: {\n        name: 'Get Selected Regions',\n        component: GetSelectedRegionsPane,\n    },\n    entity: {\n        name: 'Insert Entity',\n        component: InsertEntityPane,\n    },\n    vlist: {\n        name: 'VList',\n        component: VListPane,\n    },\n    vtable: {\n        name: 'VTable',\n        component: VTablePane,\n    },\n    getDarkColor: {\n        name: 'getDarkColor',\n        component: GetDarkColorPane,\n    },\n    getSelection: {\n        name: 'getSelection',\n        component: GetSelectionPane,\n    },\n    more: {\n        name: 'Coming soon...',\n    },\n};\n\nexport default apiEntries;\n","import * as React from 'react';\nimport ApiPaneProps from '../ApiPaneProps';\nimport { BlockElement, PluginEvent, PluginEventType, PositionType } from 'roosterjs-editor-types';\nimport { createRange, isBlockElement } from 'roosterjs-editor-dom';\n\nconst styles = require('./BlockElementsPane.scss');\n\nexport interface BlockElementPaneState {\n    blocks: BlockElement[];\n}\n\nexport default class BlockElementsPane extends React.Component<\n    ApiPaneProps,\n    BlockElementPaneState\n> {\n    private checkGetBlocks = React.createRef<HTMLInputElement>();\n\n    constructor(props: ApiPaneProps) {\n        super(props);\n        this.state = {\n            blocks: [],\n        };\n    }\n\n    render() {\n        return (\n            <div>\n                <button onClick={this.onGetBlocks}>Get blocks</button>\n                <input\n                    type=\"checkbox\"\n                    id=\"checkGetBlocks\"\n                    ref={this.checkGetBlocks}\n                    onClick={this.update}\n                />\n                <label htmlFor=\"checkGetBlocks\">Auto refresh</label>\n                {this.state.blocks.map((block, index) => (\n                    <pre\n                        key={index}\n                        className={styles.block}\n                        onMouseOver={() => this.onMouseOver(block)}>\n                        {isNodeBlockElement(block) ? (\n                            this.renderBlock(block)\n                        ) : (\n                            <i onDoubleClick={() => this.collapse(block)}>\n                                {this.renderBlock(block)}\n                            </i>\n                        )}\n                    </pre>\n                ))}\n            </div>\n        );\n    }\n\n    onPluginEvent(e: PluginEvent) {\n        if (\n            e.eventType == PluginEventType.KeyPress ||\n            e.eventType == PluginEventType.ContentChanged\n        ) {\n            if (this.checkGetBlocks.current.checked) {\n                this.update();\n            } else {\n                this.setBlocks([]);\n            }\n        }\n    }\n\n    private update = () => {\n        this.props.getEditor().runAsync(this.onGetBlocks);\n    };\n\n    private collapse(block: BlockElement) {\n        block.collapseToSingleElement();\n        this.props.getEditor().triggerContentChangedEvent();\n        if (!this.checkGetBlocks.current.checked) {\n            this.onGetBlocks();\n        }\n    }\n\n    private renderBlock(block: BlockElement): JSX.Element {\n        let isNodeBlock = isNodeBlockElement(block);\n        return (\n            <div\n                onDoubleClick={!isNodeBlock && (() => this.collapse(block))}\n                title={\n                    isNodeBlock\n                        ? 'This is a NodeBlockElement'\n                        : 'This is a StartEndBlockElement, double to collapse'\n                }\n                style={{ fontStyle: isNodeBlock ? 'normal' : 'italic' }}>\n                {getTextContent(block) || '<NO CONTENT>'}\n            </div>\n        );\n    }\n\n    private setBlocks(blocks: BlockElement[]) {\n        this.setState({\n            blocks: blocks,\n        });\n    }\n\n    private onGetBlocks = () => {\n        let traverser = this.props.getEditor().getBodyTraverser();\n        let block = traverser && traverser.currentBlockElement;\n        let blocks: BlockElement[] = [];\n\n        while (block) {\n            blocks.push(block);\n            block = traverser.getNextBlockElement();\n        }\n\n        this.setBlocks(blocks);\n    };\n\n    private onMouseOver = (block: BlockElement) => {\n        this.props\n            .getEditor()\n            .select(block.getStartNode(), 0, block.getEndNode(), PositionType.End);\n    };\n}\n\nfunction getTextContent(block: BlockElement): string {\n    return block.getStartNode() == block.getEndNode()\n        ? block.getStartNode().textContent\n        : createRange(block.getStartNode(), block.getEndNode()).toString();\n}\n\nfunction isNodeBlockElement(block: BlockElement): boolean {\n    return block.getStartNode() == block.getEndNode() && isBlockElement(block.getStartNode());\n}\n","import * as React from 'react';\nimport ApiPaneProps from '../ApiPaneProps';\nimport { getDarkColor } from 'roosterjs-color-utils';\n\ninterface GetDarkColorPaneState {\n    lightColor: string;\n    darkColor: string;\n}\n\nconst styles = require('./GetDarkColorPane.scss');\n\nexport default class GetDarkColorPane extends React.Component<ApiPaneProps, GetDarkColorPaneState> {\n    private lightColor = React.createRef<HTMLInputElement>();\n\n    constructor(props: ApiPaneProps) {\n        super(props);\n        this.state = {\n            lightColor: '',\n            darkColor: '',\n        };\n    }\n\n    render() {\n        return (\n            <>\n                <div>\n                    Light Color:{' '}\n                    <input\n                        type=\"input\"\n                        ref={this.lightColor}\n                        onChange={this.onInputChange}\n                        value={this.state.lightColor}\n                    />\n                </div>\n                <hr />\n                <div>\n                    Light Color:\n                    <div className={styles.lightBackground}>\n                        <div\n                            className={styles.result}\n                            style={{ backgroundColor: this.state.lightColor }}\n                        />\n                    </div>\n                </div>\n                <div>\n                    DarkColor: <span>{this.state.darkColor}</span>\n                    <div className={styles.darkBackground}>\n                        <div\n                            className={styles.result}\n                            style={{ backgroundColor: this.state.darkColor }}\n                        />\n                    </div>\n                </div>\n            </>\n        );\n    }\n\n    private onInputChange = () => {\n        let lightColor = this.lightColor.current.value;\n        let darkColor = '';\n\n        try {\n            darkColor = getDarkColor(lightColor);\n        } catch (e) {\n            darkColor = e;\n        }\n\n        this.setState({\n            lightColor: lightColor,\n            darkColor: darkColor,\n        });\n    };\n}\n","import * as React from 'react';\nimport ApiPaneProps from '../ApiPaneProps';\nimport {\n    PluginEvent,\n    PluginEventType,\n    SelectionRangeEx,\n    SelectionRangeTypes,\n    TableSelection,\n} from 'roosterjs-editor-types';\n\ninterface SelectionPaneState {\n    selection: SelectionRangeEx;\n    selectionMessage: string;\n    isImageSelectionOption: boolean;\n    manualSelect: boolean;\n}\n\nconst styles = require('./getSelectionPane.scss');\n\nexport default class GetSelectionPane extends React.Component<ApiPaneProps, SelectionPaneState> {\n    private selectInfo = React.createRef<HTMLInputElement>();\n    private editor = this.props.getEditor();\n    private firstCellX = React.createRef<HTMLInputElement>();\n    private firstCellY = React.createRef<HTMLInputElement>();\n    private lastCellX = React.createRef<HTMLInputElement>();\n    private lastCellY = React.createRef<HTMLInputElement>();\n    private selectionType: Record<string, string> = {\n        [SelectionRangeTypes.Normal]: 'Normal',\n        [SelectionRangeTypes.TableSelection]: 'Table Selection',\n        [SelectionRangeTypes.ImageSelection]: 'Image Selection',\n    };\n\n    constructor(props: ApiPaneProps) {\n        super(props);\n        this.state = {\n            selection: null,\n            selectionMessage: '',\n            isImageSelectionOption: true,\n            manualSelect: false,\n        };\n    }\n\n    onPluginEvent(e: PluginEvent) {\n        if (e.eventType == PluginEventType.SelectionChanged && !this.state.manualSelect) {\n            this.updateSelection();\n        }\n    }\n\n    private updateSelection = () => {\n        this.setState({\n            selection: this.editor ? this.editor.getSelectionRangeEx() : null,\n        });\n    };\n\n    private selectElement = () => {\n        const queryInfo = this.selectInfo.current.value;\n        if (queryInfo) {\n            if (this.state.isImageSelectionOption) {\n                const elementToSelect = this.editor\n                    .getDocument()\n                    .querySelector(`img[id$=\"${queryInfo}\"]`);\n                const select = elementToSelect ? this.editor.select(elementToSelect) : null;\n                this.setState({\n                    selection: select ? this.editor.getSelectionRangeEx() : null,\n                    selectionMessage: select ? 'Image Found' : 'Image not found',\n                });\n            } else {\n                const elementToSelect = this.editor\n                    .getDocument()\n                    .querySelector(`table[id$=\"${queryInfo}\"]`) as HTMLTableElement;\n                const coordinates = this.getCoordinates();\n                const select =\n                    elementToSelect && coordinates\n                        ? this.editor.select(elementToSelect, coordinates)\n                        : null;\n                this.setState({\n                    selection: select ? this.editor.getSelectionRangeEx() : null,\n                    selectionMessage: select ? 'Table found' : 'Table not found',\n                });\n            }\n        }\n    };\n\n    private getCoordinates = (): TableSelection => {\n        if (\n            this.firstCellX.current.value &&\n            this.firstCellY.current.value &&\n            this.lastCellX.current.value &&\n            this.lastCellY.current.value\n        ) {\n            const coordinates: TableSelection = {\n                firstCell: {\n                    x: parseInt(this.firstCellX.current.value),\n                    y: parseInt(this.firstCellY.current.value),\n                },\n                lastCell: {\n                    x: parseInt(this.lastCellX.current.value),\n                    y: parseInt(this.lastCellY.current.value),\n                },\n            };\n            return coordinates;\n        }\n        return null;\n    };\n\n    private createSelectionInfo = () => {\n        return (\n            <>\n                <div className={styles.containerInfo}>\n                    <span className={styles.title}>Selection Information</span>\n                    <div>Selection type: {this.selectionType[this.state.selection.type]}</div>\n                    <div>Are collapsed: {`${this.state.selection.areAllCollapsed}`}</div>\n                    {this.state.selection.type === SelectionRangeTypes.TableSelection && (\n                        <>\n                            <div>Coordinates</div>\n                            <div>\n                                First cell:\n                                <span> X: {this.state.selection.coordinates.firstCell.x}</span>\n                                <span> Y: {this.state.selection.coordinates.firstCell.y}</span>\n                            </div>\n                            <div>\n                                Last cell:\n                                <span> X: {this.state.selection.coordinates.lastCell.x}</span>\n                                <span> Y: {this.state.selection.coordinates.lastCell.y}</span>\n                            </div>\n                        </>\n                    )}\n                    {this.state.selection.type === SelectionRangeTypes.ImageSelection && (\n                        <>\n                            <div>Image Id: {this.state.selection.image.id}</div>\n                        </>\n                    )}\n                </div>\n            </>\n        );\n    };\n\n    private selectionOption = (label: string, checked: boolean, onChange: () => void) => {\n        return (\n            <>\n                <div>\n                    <label>\n                        <input\n                            className={styles.input}\n                            type=\"radio\"\n                            checked={checked}\n                            onChange={onChange}\n                        />\n                        {label}\n                    </label>\n                </div>\n            </>\n        );\n    };\n\n    private changeSelectionOption = () => {\n        this.setState({\n            isImageSelectionOption: !this.state.isImageSelectionOption,\n        });\n    };\n\n    private createCoordinatesInput = (\n        label: string,\n        coordinateRef: React.RefObject<HTMLInputElement>\n    ) => {\n        return (\n            <>\n                <div>\n                    <label>\n                        {label}\n                        <input\n                            className={styles.coordinates}\n                            min=\"0\"\n                            type=\"number\"\n                            ref={coordinateRef}\n                        />\n                    </label>\n                </div>\n            </>\n        );\n    };\n\n    private showManualSelection = () => {\n        this.setState({\n            manualSelect: !this.state.manualSelect,\n        });\n    };\n\n    render() {\n        return (\n            <>\n                {!this.state.manualSelect && (\n                    <span className={styles.title}>\n                        Click on the screen to get selection information\n                    </span>\n                )}\n                {this.state.selection && <span>{this.createSelectionInfo()}</span>}\n                {this.state.manualSelect && (\n                    <div className={styles.containerInfo}>\n                        <div>\n                            <span className={styles.title}>Select element type:</span>\n                            {this.selectionOption(\n                                'Image',\n                                this.state.isImageSelectionOption,\n                                this.changeSelectionOption\n                            )}\n                            {this.selectionOption(\n                                'Table',\n                                !this.state.isImageSelectionOption,\n                                this.changeSelectionOption\n                            )}\n                            <input\n                                className={styles.input}\n                                placeholder=\"Type element id:\"\n                                type=\"input\"\n                                ref={this.selectInfo}\n                            />\n                            {!this.state.isImageSelectionOption && (\n                                <div>\n                                    <div> Coordinates </div>\n                                    {this.createCoordinatesInput('First cell X', this.firstCellX)}\n                                    {this.createCoordinatesInput('First cell Y', this.firstCellY)}\n                                    {this.createCoordinatesInput('Last cell X', this.lastCellX)}\n                                    {this.createCoordinatesInput('Last cell X', this.lastCellY)}\n                                </div>\n                            )}\n                        </div>\n                        <div>{this.state.selectionMessage}</div>\n                        <div>\n                            {this.selectInfo && (\n                                <button className={styles.button} onClick={this.selectElement}>\n                                    Select Element\n                                </button>\n                            )}\n                        </div>\n                    </div>\n                )}\n\n                <button className={styles.button} onClick={this.showManualSelection}>\n                    {this.state.manualSelect ? 'Hide manual select' : 'Show manual select'}\n                </button>\n            </>\n        );\n    }\n}\n","import * as React from 'react';\nimport ApiPaneProps from '../ApiPaneProps';\nimport { ContentPosition, InsertOptionBasic } from 'roosterjs-editor-types';\n\nconst styles = require('./InsertContentPane.scss');\n\nexport interface InsertContentPaneState {\n    content: string;\n    position: ContentPosition;\n    updateCursor: boolean;\n    replaceSelection: boolean;\n    insertOnNewLine: boolean;\n}\n\nexport default class InsertContentPane extends React.Component<\n    ApiPaneProps,\n    InsertContentPaneState\n> {\n    private html = React.createRef<HTMLTextAreaElement>();\n\n    constructor(props: ApiPaneProps) {\n        super(props);\n        this.state = {\n            content: '',\n            position: ContentPosition.SelectionStart,\n            updateCursor: true,\n            replaceSelection: true,\n            insertOnNewLine: false,\n        };\n    }\n\n    render() {\n        return (\n            <table>\n                <tr>\n                    <td>HTML Content</td>\n                    <td>\n                        <textarea\n                            className={styles.text}\n                            ref={this.html}\n                            value={this.state.content}\n                            onChange={() => this.setState({ content: this.html.current.value })}\n                        />\n                    </td>\n                </tr>\n                <tr>\n                    <td>Insert at</td>\n                    <td>\n                        <div>\n                            <input\n                                type=\"radio\"\n                                name=\"position\"\n                                checked={this.state.position == ContentPosition.Begin}\n                                id=\"insertBegin\"\n                                onClick={() => this.setPosition(ContentPosition.Begin)}\n                            />\n                            <label htmlFor=\"insertBegin\">Begin</label>\n                        </div>\n                        <div>\n                            <input\n                                type=\"radio\"\n                                name=\"position\"\n                                checked={this.state.position == ContentPosition.End}\n                                id=\"insertEnd\"\n                                onClick={() => this.setPosition(ContentPosition.End)}\n                            />\n                            <label htmlFor=\"insertEnd\">End</label>\n                        </div>\n                        <div>\n                            <input\n                                type=\"radio\"\n                                name=\"position\"\n                                checked={this.state.position == ContentPosition.SelectionStart}\n                                id=\"insertSelectionStart\"\n                                onClick={() => this.setPosition(ContentPosition.SelectionStart)}\n                            />\n                            <label htmlFor=\"insertSelectionStart\">SelectionStart</label>\n                        </div>\n                        <div>\n                            <input\n                                type=\"radio\"\n                                name=\"position\"\n                                checked={this.state.position == ContentPosition.Outside}\n                                id=\"insertOutside\"\n                                onClick={() => this.setPosition(ContentPosition.Outside)}\n                            />\n                            <label htmlFor=\"insertOutside\">Outside</label>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>Cursor option</td>\n                    <td>\n                        <input\n                            type=\"checkbox\"\n                            id=\"insertUpdateCursor\"\n                            checked={this.state.updateCursor}\n                            onClick={() =>\n                                this.setState({ updateCursor: !this.state.updateCursor })\n                            }\n                        />\n                        <label htmlFor=\"insertUpdateCursor\">Update cursor</label>\n                    </td>\n                </tr>\n                <tr>\n                    <td>Replace option</td>\n                    <td>\n                        <input\n                            type=\"checkbox\"\n                            id=\"insertReplaceSelection\"\n                            checked={this.state.replaceSelection}\n                            onClick={() =>\n                                this.setState({ replaceSelection: !this.state.replaceSelection })\n                            }\n                        />\n                        <label htmlFor=\"insertReplaceSelection\">Replace selection</label>\n                    </td>\n                </tr>\n                <tr>\n                    <td>New line option</td>\n                    <td>\n                        <input\n                            type=\"checkbox\"\n                            id=\"insertOnNewLine\"\n                            checked={this.state.insertOnNewLine}\n                            onClick={() =>\n                                this.setState({ insertOnNewLine: !this.state.insertOnNewLine })\n                            }\n                        />\n                        <label htmlFor=\"insertOnNewLine\">Insert on new line</label>\n                    </td>\n                </tr>\n                <tr>\n                    <td colSpan={2} className={styles.buttonRow}>\n                        <button onClick={this.onClick}>Insert Content</button>\n                    </td>\n                </tr>\n            </table>\n        );\n    }\n\n    private setPosition(position: ContentPosition) {\n        this.setState({\n            position: position,\n        });\n    }\n\n    private onClick = () => {\n        let editor = this.props.getEditor();\n        if (this.state.position != ContentPosition.Range) {\n            const inputOption: InsertOptionBasic = {\n                position: this.state.position,\n                updateCursor: this.state.updateCursor,\n                replaceSelection: this.state.replaceSelection,\n                insertOnNewLine: this.state.insertOnNewLine,\n            };\n            editor.addUndoSnapshot(() => editor.insertContent(this.state.content, inputOption));\n        }\n    };\n}\n","import * as React from 'react';\nimport ApiPaneProps from '../ApiPaneProps';\nimport { Entity } from 'roosterjs-editor-types';\nimport { getEntityFromElement, getEntitySelector } from 'roosterjs-editor-dom';\nimport { insertEntity } from 'roosterjs-editor-api';\nimport { trustedHTMLHandler } from '../../../../utils/trustedHTMLHandler';\n\nconst styles = require('./InsertEntityPane.scss');\n\ninterface InsertEntityPaneState {\n    entities: Entity[];\n}\n\nexport default class InsertEntityPane extends React.Component<ApiPaneProps, InsertEntityPaneState> {\n    private entityType = React.createRef<HTMLInputElement>();\n    private html = React.createRef<HTMLTextAreaElement>();\n    private styleInline = React.createRef<HTMLInputElement>();\n    private styleBlock = React.createRef<HTMLInputElement>();\n    private isReadonly = React.createRef<HTMLInputElement>();\n    private insertAtRoot = React.createRef<HTMLInputElement>();\n    private focusAfterEntity = React.createRef<HTMLInputElement>();\n\n    constructor(props: ApiPaneProps) {\n        super(props);\n        this.state = {\n            entities: [],\n        };\n    }\n\n    render() {\n        return (\n            <>\n                <div>\n                    Type: <input type=\"input\" ref={this.entityType} />\n                </div>\n                <div>\n                    HTML: <textarea className={styles.textarea} ref={this.html}></textarea>\n                </div>\n                <div>\n                    Style:\n                    <input\n                        type=\"radio\"\n                        name=\"entityStyle\"\n                        ref={this.styleInline}\n                        id=\"styleInline\"\n                    />\n                    <label htmlFor=\"styleInline\">Inline</label>\n                    <input type=\"radio\" name=\"entityStyle\" ref={this.styleBlock} id=\"styleBlock\" />\n                    <label htmlFor=\"styleBlock\">Block</label>\n                </div>\n                <div>\n                    <input id=\"readonly\" type=\"checkbox\" ref={this.isReadonly} />\n                    <label htmlFor=\"readonly\">Readonly </label>\n                </div>\n                <div>\n                    <input id=\"insertAtRoot\" type=\"checkbox\" ref={this.insertAtRoot} />\n                    <label htmlFor=\"insertAtRoot\">Force insert at root of region</label>\n                </div>\n                <div>\n                    <input id=\"focusAfterEntity\" type=\"checkbox\" ref={this.focusAfterEntity} />\n                    <label htmlFor=\"focusAfterEntity\">Focus after entity</label>\n                </div>\n                <div>\n                    <button onClick={this.insertEntity}>Insert Entity</button>\n                </div>\n                <hr />\n                <div>\n                    <button onClick={this.onGetEntities}>Get all entities</button>\n                </div>\n                <div>\n                    {this.state.entities.map(entity => (\n                        <EntityButton key={entity.id} entity={entity} />\n                    ))}\n                </div>\n            </>\n        );\n    }\n\n    private insertEntity = () => {\n        const entityType = this.entityType.current.value;\n        const node = document.createElement('span');\n        node.innerHTML = trustedHTMLHandler(this.html.current.value);\n        const isBlock = this.styleBlock.current.checked;\n        const isReadonly = this.isReadonly.current.checked;\n        const insertAtRoot = this.insertAtRoot.current.checked;\n        const focusAfterEntity = this.focusAfterEntity.current.checked;\n\n        if (node) {\n            const editor = this.props.getEditor();\n\n            editor.addUndoSnapshot(() => {\n                insertEntity(\n                    editor,\n                    entityType,\n                    node,\n                    isBlock,\n                    isReadonly,\n                    undefined /*position*/,\n                    insertAtRoot,\n                    focusAfterEntity\n                );\n            });\n        }\n    };\n\n    private onGetEntities = () => {\n        const selector = getEntitySelector();\n        const nodes = this.props.getEditor().queryElements(selector);\n        const allEntities = nodes.map(node => getEntityFromElement(node));\n\n        this.setState({\n            entities: allEntities.filter(e => !!e),\n        });\n    };\n}\n\nfunction EntityButton({ entity }: { entity: Entity }) {\n    let background = '';\n    const onMouseOver = React.useCallback(() => {\n        background = entity.wrapper.style.backgroundColor;\n        entity.wrapper.style.backgroundColor = 'blue';\n    }, [entity]);\n\n    const onMouseOut = React.useCallback(() => {\n        entity.wrapper.style.backgroundColor = background;\n    }, [entity]);\n\n    return (\n        <div onMouseOver={onMouseOver} onMouseOut={onMouseOut}>\n            Type: {entity.type}\n            <br />\n            Id: {entity.id}\n            <br />\n            Readonly: {entity.isReadonly ? 'True' : 'False'}\n            <br />\n        </div>\n    );\n}\n","import * as React from 'react';\nimport ApiPaneProps from '../ApiPaneProps';\nimport { LinkData } from 'roosterjs-editor-types';\nimport { matchLink } from 'roosterjs-editor-dom';\n\ninterface MatchLinkState {\n    linkData: LinkData;\n}\n\nexport default class MatchLinkPane extends React.Component<ApiPaneProps, MatchLinkState> {\n    private url = React.createRef<HTMLInputElement>();\n\n    constructor(props: ApiPaneProps) {\n        super(props);\n        this.state = { linkData: undefined };\n    }\n\n    render() {\n        let { scheme, originalUrl, normalizedUrl } = this.state.linkData || ({} as LinkData);\n        return (\n            <>\n                <div>\n                    Url: <input type=\"input\" ref={this.url} />{' '}\n                    <button onClick={this.onMatchLink}>Match Link</button>\n                </div>\n                {this.state.linkData === null ? (\n                    <div>Not matched</div>\n                ) : (\n                    <>\n                        <div>Schema: {scheme || ''}</div>\n                        <div>Original Url: {originalUrl || ''}</div>\n                        <div>Normalized Url: {normalizedUrl || ''}</div>\n                    </>\n                )}\n            </>\n        );\n    }\n\n    private onMatchLink = () => {\n        let match = matchLink(this.url.current.value);\n        this.setState({\n            linkData: match,\n        });\n    };\n}\n","import * as React from 'react';\nimport ApiPaneProps from '../ApiPaneProps';\nimport { IEditor, PositionType, Region } from 'roosterjs-editor-types';\nimport {\n    createRange,\n    getSelectedBlockElementsInRegion,\n    getTagOfNode,\n    safeInstanceOf,\n} from 'roosterjs-editor-dom';\n\nconst styles = require('./GetSelectedRegionsPane.scss');\n\ninterface GetSelectedRegionsPaneState {\n    regions: Region[];\n}\n\nexport default class GetSelectedRegionsPane extends React.Component<\n    ApiPaneProps,\n    GetSelectedRegionsPaneState\n> {\n    constructor(props: ApiPaneProps) {\n        super(props);\n        this.state = { regions: [] };\n    }\n\n    render() {\n        const editor = this.props.getEditor();\n        return (\n            <>\n                <div>\n                    <button onClick={this.getSelectedRegions}>Get Selected Regions</button>&nbsp;\n                    <button onClick={this.clearAll}>Clear</button>\n                </div>\n                <div>\n                    {this.state.regions.map((region, i) => (\n                        <Region key={i} region={region} editor={editor} index={i} />\n                    ))}\n                </div>\n            </>\n        );\n    }\n\n    private getSelectedRegions = () => {\n        this.setState({\n            regions: this.props.getEditor().getSelectedRegions(),\n        });\n    };\n\n    private clearAll = () => {\n        this.setState({\n            regions: [],\n        });\n    };\n}\n\nfunction Region({ region, editor, index }: { region: Region; editor: IEditor; index: number }) {\n    const selectRegion = React.useCallback(() => {\n        const blocks = getSelectedBlockElementsInRegion(region);\n        if (blocks.length > 0) {\n            const range = createRange(\n                blocks[0].getStartNode(),\n                PositionType.Begin,\n                blocks[blocks.length - 1].getEndNode(),\n                PositionType.End\n            );\n            editor.focus();\n            editor.select(range);\n        }\n    }, [region]);\n\n    return (\n        <div>\n            <hr />\n            <div>\n                <b>Region {index}</b>\n            </div>\n            <div>\n                Root node: <NodeName node={region.rootNode} />\n            </div>\n            <div>\n                Node Before: <NodeName node={region.nodeBefore} />\n            </div>\n            <div>\n                Node After: <NodeName node={region.nodeAfter} />\n            </div>\n            <div>\n                Selected blocks: <button onClick={selectRegion}>Select</button>\n            </div>\n        </div>\n    );\n}\n\nfunction NodeName({ node }: { node: Node }) {\n    const mouseOver = React.useCallback(() => {\n        if (safeInstanceOf(node, 'HTMLElement')) {\n            node.className += ' ' + styles.hover;\n        }\n    }, [node]);\n\n    const mouseOut = React.useCallback(() => {\n        if (safeInstanceOf(node, 'HTMLElement')) {\n            let classNames = node.className.split(' ');\n            classNames = classNames.filter(name => name != styles.hover);\n            node.className = classNames.join(' ').trim();\n        }\n    }, [node]);\n\n    return node ? (\n        safeInstanceOf(node, 'HTMLElement') ? (\n            <span onMouseOver={mouseOver} onMouseOut={mouseOut} className={styles.regionNode}>\n                {getTagOfNode(node)}#{node.id}\n            </span>\n        ) : (\n            <span className={styles.regionNode}>{node.nodeValue.substr(0, 10)}</span>\n        )\n    ) : null;\n}\n","import * as React from 'react';\nimport ApiPaneProps from '../ApiPaneProps';\nimport { HtmlSanitizer } from 'roosterjs-editor-dom';\nimport { trustedHTMLHandler } from '../../../../utils/trustedHTMLHandler';\n\nconst styles = require('./SanitizerPane.scss');\n\nexport default class SanitizerPane extends React.Component<ApiPaneProps, {}> {\n    private source = React.createRef<HTMLTextAreaElement>();\n    private result = React.createRef<HTMLTextAreaElement>();\n    private sanitizer = new HtmlSanitizer();\n\n    render() {\n        return (\n            <>\n                <h3>Input</h3>\n                <textarea className={styles.textarea} ref={this.source} />\n                <div>\n                    <button className={styles.button} onClick={this.inline}>\n                        Inline CSS\n                    </button>\n                    <button className={styles.button} onClick={this.sanitize}>\n                        Sanitize\n                    </button>\n                </div>\n                <h3>Result</h3>\n                <textarea className={styles.textarea} ref={this.result} />\n            </>\n        );\n    }\n\n    private inline = () => {\n        const doc = this.getDOMDocument();\n\n        if (doc?.body) {\n            this.sanitizer.convertGlobalCssToInlineCss(doc);\n            this.result.current.value = doc.body.innerHTML;\n        }\n    };\n\n    private sanitize = () => {\n        const doc = this.getDOMDocument();\n\n        if (doc?.body) {\n            this.sanitizer.sanitize(doc.body.firstChild);\n            this.result.current.value = doc.body.innerHTML;\n        }\n    };\n\n    private getDOMDocument(): Document {\n        const parser = new DOMParser();\n        const html = trustedHTMLHandler(this.source.current.value) || '';\n        const doc = parser.parseFromString(html, 'text/html');\n        return doc;\n    }\n}\n","import * as React from 'react';\nimport ApiPaneProps from '../ApiPaneProps';\nimport VListItem from 'roosterjs-editor-dom/lib/list/VListItem';\nimport { createVListFromRegion, VList } from 'roosterjs-editor-dom';\nimport { ExperimentalFeatures, IEditor, ListType, PositionType } from 'roosterjs-editor-types';\n\ninterface VListPaneState {\n    vlist: VList;\n}\n\nconst ListTypeToString = {\n    [ListType.None]: 'None',\n    [ListType.Ordered]: 'Ordered',\n    [ListType.Unordered]: 'Unordered',\n};\n\nfunction VListItemPane(props: { editor: IEditor; item: VListItem; onChange: () => void }) {\n    const { item, editor, onChange } = props;\n    const type = item.getListType();\n\n    const onMouseOver = React.useCallback(() => {\n        const node = item.getNode();\n        editor.select(node);\n    }, [props.item, editor]);\n\n    const onOrdered = React.useCallback(() => {\n        item.changeListType(ListType.Ordered);\n        onChange();\n    }, [props.item, editor]);\n    const onUnrdered = React.useCallback(() => {\n        item.changeListType(ListType.Unordered);\n        onChange();\n    }, [props.item, editor]);\n    const onIndent = React.useCallback(() => {\n        item.indent();\n        onChange();\n    }, [props.item, editor]);\n    const onOutdent = React.useCallback(() => {\n        item.outdent();\n        onChange();\n    }, [props.item, editor]);\n\n    return (\n        <div>\n            <button onClick={onOrdered}>1.</button>\n            <button onClick={onUnrdered}>*</button>\n            <button onClick={onOutdent}>&lt;-</button>\n            <button onClick={onIndent}>-&gt;</button>\n            <span\n                style={{\n                    marginLeft: item.getLevel() * 20 + 'px',\n                    display: 'inline-block',\n                    cursor: 'pointer',\n                }}\n                onMouseOver={onMouseOver}>\n                {ListTypeToString[type]}\n            </span>\n        </div>\n    );\n}\n\nexport default class VListPane extends React.Component<ApiPaneProps, VListPaneState> {\n    constructor(props: ApiPaneProps) {\n        super(props);\n        this.state = {\n            vlist: null,\n        };\n    }\n\n    render() {\n        const editor = this.props.getEditor();\n        return (\n            <>\n                <button onClick={this.createVList}>Create VList from cursor</button>\n                {this.state.vlist && (\n                    <>\n                        {this.state.vlist.items.map(item => (\n                            <VListItemPane item={item} editor={editor} onChange={this.onChange} />\n                        ))}\n                        <button onClick={this.onWriteback}>Write back</button>\n                    </>\n                )}\n            </>\n        );\n    }\n\n    private createVList = () => {\n        const editor = this.props.getEditor();\n        const node = editor.getElementAtCursor();\n        const region = editor.getSelectedRegions()[0];\n        const vlist = node\n            ? createVListFromRegion(region, false /*includingSiblingList*/, node)\n            : null;\n\n        this.setState({\n            vlist: vlist,\n        });\n    };\n\n    private onWriteback = () => {\n        const editor = this.props.getEditor();\n        editor.addUndoSnapshot(() => {\n            this.state.vlist?.writeBack(\n                editor.isFeatureEnabled(ExperimentalFeatures.ReuseAllAncestorListElements),\n                editor.isFeatureEnabled(ExperimentalFeatures.DisableListChain)\n            );\n            editor.focus();\n            editor.select(this.state.vlist.items[0]?.getNode(), PositionType.Begin);\n        });\n        this.createVList();\n    };\n\n    private onChange = () => {\n        this.forceUpdate();\n    };\n}\n","import { TableBorderFormat, TableFormat } from 'roosterjs-editor-types';\n\nexport const PREDEFINED_STYLES: Record<\n    string,\n    (color?: string, lightColor?: string) => TableFormat\n> = {\n    DEFAULT: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.DEFAULT /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    DEFAULT_WITH_BACKGROUND_COLOR: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.DEFAULT /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    GRID_WITHOUT_BORDER: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            true /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.NO_SIDE_BORDERS /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    LIST: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            null /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.DEFAULT /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    BANDED_ROWS_FIRST_COLUMN_NO_BORDER: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.FIRST_COLUMN_HEADER_EXTERNAL /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    EXTERNAL: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.LIST_WITH_SIDE_BORDERS /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    NO_HEADER_VERTICAL: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.NO_HEADER_BORDERS /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    ESPECIAL_TYPE_1: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.ESPECIAL_TYPE_1 /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    ESPECIAL_TYPE_2: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.ESPECIAL_TYPE_2 /** tableBorderFormat */,\n            null /** bgColorEven */,\n            lightColor /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    ESPECIAL_TYPE_3: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.ESPECIAL_TYPE_3 /** tableBorderFormat */,\n            lightColor /** bgColorEven */,\n            null /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n    CLEAR: (color, lightColor) =>\n        createTableFormat(\n            color /**topBorder */,\n            color /**bottomBorder */,\n            color /** verticalColors*/,\n            false /** bandedRows */,\n            false /** bandedColumns */,\n            false /** headerRow */,\n            false /** firstColumn */,\n            TableBorderFormat.CLEAR /** tableBorderFormat */,\n            lightColor /** bgColorEven */,\n            null /** bgColorOdd */,\n            color /** headerRowColor */\n        ),\n};\n\nexport function createTableFormat(\n    topBorder?: string,\n    bottomBorder?: string,\n    verticalBorder?: string,\n    bandedRows?: boolean,\n    bandedColumns?: boolean,\n    headerRow?: boolean,\n    firstColumn?: boolean,\n    borderFormat?: TableBorderFormat,\n    bgColorEven?: string,\n    bgColorOdd?: string,\n    headerRowColor?: string\n): TableFormat {\n    return {\n        topBorderColor: topBorder,\n        bottomBorderColor: bottomBorder,\n        verticalBorderColor: verticalBorder,\n        hasBandedRows: bandedRows,\n        bgColorEven: bgColorEven,\n        bgColorOdd: bgColorOdd,\n        hasBandedColumns: bandedColumns,\n        hasHeaderRow: headerRow,\n        headerRowColor: headerRowColor,\n        hasFirstColumn: firstColumn,\n        tableBorderFormat: borderFormat,\n        keepCellShade: false,\n    };\n}\n","import * as Color from 'color';\nimport * as React from 'react';\nimport ApiPaneProps from '../ApiPaneProps';\nimport ColorPicker from '../../../colorPicker/ColorPicker';\nimport { createTableFormat, PREDEFINED_STYLES } from './PredefinedTableStyles';\nimport { editTable, formatTable } from 'roosterjs-editor-api';\nimport { getTagOfNode, VTable } from 'roosterjs-editor-dom';\nimport { IEditor, PositionType, TableFormat, TableOperation, VCell } from 'roosterjs-editor-types';\n\nconst PREDEFINED_STYLES_KEYS = {\n    default: 'DEFAULT',\n    gridWithoutBorder: 'GRID_WITHOUT_BORDER',\n    list: 'LIST',\n    bandedRowsFirstColumnNoBorder: 'BANDED_ROWS_FIRST_COLUMN_NO_BORDER',\n    defaultWithBackgroundColor: 'DEFAULT_WITH_BACKGROUND_COLOR',\n    external: 'EXTERNAL',\n    noHeader: 'NO_HEADER_VERTICAL',\n    especialType1: 'ESPECIAL_TYPE_1',\n    especialType2: 'ESPECIAL_TYPE_2',\n    especialType3: 'ESPECIAL_TYPE_3',\n    clear: 'CLEAR',\n};\n\nconst TABLE_COLORS: Record<string, string> = {\n    transparent: 'transparent',\n    black: '#000000',\n    blue: '#0C64C0',\n    orange: '#DE6A19',\n    yellow: '#DCBE22',\n    red: '#ED5C57',\n    purple: '#B36AE2',\n    green: '#0C882A',\n};\n\ninterface VTablePaneState {\n    vtable: VTable;\n}\n\nconst styles = require('./VTablePane.scss');\n\nfunction TableCell(props: {\n    cell: VCell;\n    editor: IEditor;\n    isCurrent: boolean;\n    onClickCell: (td: HTMLTableCellElement) => void;\n}) {\n    const { cell, editor, isCurrent } = props;\n    const onMouseOver = React.useCallback(() => {\n        editor.select(cell.td);\n    }, [cell, editor]);\n    const onClick = React.useCallback(() => {\n        if (cell.td) {\n            props.onClickCell(cell.td);\n        }\n    }, [cell, editor]);\n\n    const text = cell.td\n        ? getTagOfNode(cell.td)\n        : cell.spanAbove && cell.spanLeft\n        ? ''\n        : cell.spanAbove\n        ? ''\n        : cell.spanLeft\n        ? ''\n        : '';\n\n    return (\n        <div\n            style={{ cursor: 'pointer', border: isCurrent ? 'solid 2px black' : '' }}\n            onMouseOver={onMouseOver}\n            onClick={onClick}>\n            {text}\n        </div>\n    );\n}\n\nexport default class VTablePane extends React.Component<ApiPaneProps, VTablePaneState> {\n    private bgColor = React.createRef<HTMLInputElement>();\n    private topBorderColor = React.createRef<HTMLInputElement>();\n    private bottomBorderColor = React.createRef<HTMLInputElement>();\n    private verticalBorderColor = React.createRef<HTMLInputElement>();\n\n    constructor(props: ApiPaneProps) {\n        super(props);\n        this.state = {\n            vtable: null,\n        };\n    }\n\n    render() {\n        const editor = this.props.getEditor();\n        const currentTd = this.state.vtable?.getCurrentTd();\n        return (\n            <>\n                <button onClick={this.createVTable}>Create VTable from cursor</button>\n                {this.state.vtable && (\n                    <>\n                        <table\n                            style={{\n                                border: 'solid 1px black',\n                            }}>\n                            <tbody>\n                                {this.state.vtable.cells.map((row, rowIndex) => (\n                                    <tr key={'row' + rowIndex}>\n                                        {row.map((cell, cellIndex) => (\n                                            <td key={'cell' + cellIndex}>\n                                                <TableCell\n                                                    cell={cell}\n                                                    editor={editor}\n                                                    isCurrent={currentTd == cell.td}\n                                                    onClickCell={this.onClickCell}\n                                                />\n                                            </td>\n                                        ))}\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                        <table>\n                            <tbody>\n                                <tr>\n                                    <th colSpan={2}>Edit Table</th>\n                                </tr>\n                                <tr>\n                                    <td>Insert</td>\n                                    <td>\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Above',\n                                            TableOperation.InsertAbove\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Below',\n                                            TableOperation.InsertBelow\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Left',\n                                            TableOperation.InsertLeft\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Right',\n                                            TableOperation.InsertRight\n                                        )}\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>Delete</td>\n                                    <td>\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Table',\n                                            TableOperation.DeleteTable\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Column',\n                                            TableOperation.DeleteColumn\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Row',\n                                            TableOperation.DeleteRow\n                                        )}\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>Merge</td>\n                                    <td>\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Above',\n                                            TableOperation.MergeAbove\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Below',\n                                            TableOperation.MergeBelow\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Left',\n                                            TableOperation.MergeLeft\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Right',\n                                            TableOperation.MergeRight\n                                        )}\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>Split</td>\n                                    <td>\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Horizontally',\n                                            TableOperation.SplitHorizontally\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Vertically',\n                                            TableOperation.SplitVertically\n                                        )}\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>Align</td>\n                                    <td>\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Left',\n                                            TableOperation.AlignLeft\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Center',\n                                            TableOperation.AlignCenter\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Right',\n                                            TableOperation.AlignRight\n                                        )}\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>Align Cell</td>\n                                    <td>\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Left',\n                                            TableOperation.AlignCellLeft\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Center',\n                                            TableOperation.AlignCellCenter\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Right',\n                                            TableOperation.AlignCellRight\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Top',\n                                            TableOperation.AlignCellTop\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Middle',\n                                            TableOperation.AlignCellMiddle\n                                        )}\n                                        {this.renderEditTableButton(\n                                            editor,\n                                            'Bottom',\n                                            TableOperation.AlignCellBottom\n                                        )}\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <th colSpan={2}>Format Table</th>\n                                </tr>\n                                <tr>\n                                    <td>State:</td>\n                                    <td>\n                                        {this.renderSetHeaderRowButton(editor)}\n                                        {this.renderSetFirstColumnButton(editor)}\n                                        {this.renderSetBandedColumnButton(editor)}\n                                        {this.renderSetBandedRowButton(editor)}\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>Predefined:</td>\n                                    <td>\n                                        {this.renderFormatTableButton(\n                                            'Default',\n                                            PREDEFINED_STYLES[PREDEFINED_STYLES_KEYS.default](\n                                                TABLE_COLORS.blue,\n                                                `${TABLE_COLORS.blue}20`\n                                            ),\n                                            editor\n                                        )}\n\n                                        {this.renderFormatTableButton(\n                                            'Grid without border',\n                                            PREDEFINED_STYLES[\n                                                PREDEFINED_STYLES_KEYS.gridWithoutBorder\n                                            ](TABLE_COLORS.blue, `${TABLE_COLORS.blue}20`),\n                                            editor\n                                        )}\n\n                                        {this.renderFormatTableButton(\n                                            'List',\n                                            PREDEFINED_STYLES[PREDEFINED_STYLES_KEYS.list](\n                                                TABLE_COLORS.blue,\n                                                `${TABLE_COLORS.blue}20`\n                                            ),\n                                            editor\n                                        )}\n                                        {this.renderFormatTableButton(\n                                            'Banded Row and first column and no border',\n                                            PREDEFINED_STYLES[\n                                                PREDEFINED_STYLES_KEYS.bandedRowsFirstColumnNoBorder\n                                            ](TABLE_COLORS.blue, `${TABLE_COLORS.blue}20`),\n                                            editor\n                                        )}\n                                        {this.renderFormatTableButton(\n                                            'Default with background color',\n                                            PREDEFINED_STYLES[\n                                                PREDEFINED_STYLES_KEYS.defaultWithBackgroundColor\n                                            ](TABLE_COLORS.blue, `${TABLE_COLORS.blue}20`),\n                                            editor\n                                        )}\n                                        {this.renderFormatTableButton(\n                                            'External',\n                                            PREDEFINED_STYLES[PREDEFINED_STYLES_KEYS.external](\n                                                TABLE_COLORS.blue,\n                                                `${TABLE_COLORS.blue}20`\n                                            ),\n                                            editor\n                                        )}\n                                        {this.renderFormatTableButton(\n                                            'No Header Vertical',\n                                            PREDEFINED_STYLES[PREDEFINED_STYLES_KEYS.noHeader](\n                                                TABLE_COLORS.blue,\n                                                `${TABLE_COLORS.blue}20`\n                                            ),\n                                            editor\n                                        )}\n                                        {this.renderFormatTableButton(\n                                            'Especial type 1',\n                                            PREDEFINED_STYLES[PREDEFINED_STYLES_KEYS.especialType1](\n                                                TABLE_COLORS.blue,\n                                                `${TABLE_COLORS.blue}20`\n                                            ),\n                                            editor\n                                        )}\n                                        {this.renderFormatTableButton(\n                                            'Especial type 2',\n                                            PREDEFINED_STYLES[PREDEFINED_STYLES_KEYS.especialType2](\n                                                TABLE_COLORS.blue,\n                                                `${TABLE_COLORS.blue}20`\n                                            ),\n                                            editor\n                                        )}\n                                        {this.renderFormatTableButton(\n                                            'Especial type 3',\n                                            PREDEFINED_STYLES[PREDEFINED_STYLES_KEYS.especialType3](\n                                                TABLE_COLORS.blue,\n                                                `${TABLE_COLORS.blue}20`\n                                            ),\n                                            editor\n                                        )}\n                                        {this.renderFormatTableButton(\n                                            'Clear',\n                                            PREDEFINED_STYLES[PREDEFINED_STYLES_KEYS.clear](\n                                                TABLE_COLORS.transparent\n                                            ),\n                                            editor\n                                        )}\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <th colSpan={2} className={styles.buttonRow}>\n                                        Customized Colors:\n                                    </th>\n                                </tr>\n                                <CustomizeFormatRow\n                                    text=\"BackgroundColor\"\n                                    inputRef={this.bgColor}\n                                />\n                                <CustomizeFormatRow\n                                    text=\"Top border\"\n                                    inputRef={this.topBorderColor}\n                                />\n                                <CustomizeFormatRow\n                                    text=\"Bottom border\"\n                                    inputRef={this.bottomBorderColor}\n                                />\n                                <CustomizeFormatRow\n                                    text=\"Vertical border\"\n                                    inputRef={this.verticalBorderColor}\n                                />\n\n                                <tr>\n                                    <td\n                                        colSpan={2}\n                                        className={styles.buttonRow}\n                                        onClick={this.onCustomizeFormat}>\n                                        <button className={styles.button}>Apply Format</button>\n                                    </td>\n                                </tr>\n\n                                <tr>\n                                    <th colSpan={2} className={styles.buttonRow}>\n                                        Style Info:\n                                    </th>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <button onClick={this.onWriteBack}>Write back</button>\n                    </>\n                )}\n            </>\n        );\n    }\n\n    private createVTable = () => {\n        const editor = this.props.getEditor();\n        const node = editor.getElementAtCursor('td,th') as HTMLTableCellElement;\n        const vtable = node ? new VTable(node) : null;\n\n        this.setState({ vtable });\n    };\n\n    private onClickCell = (td: HTMLTableCellElement) => {\n        const vtable = new VTable(td);\n        this.setState({ vtable });\n    };\n\n    private renderEditTableButton(\n        editor: IEditor,\n        text: string,\n        operation: TableOperation\n    ): JSX.Element {\n        return (\n            <button\n                className={styles.button}\n                onClick={() => {\n                    editTable(editor, operation);\n                    this.forceUpdate();\n                }}>\n                {text}\n            </button>\n        );\n    }\n\n    private renderSetHeaderRowButton(editor: IEditor): JSX.Element {\n        return (\n            <button\n                className={styles.button}\n                onClick={() => {\n                    formatTable(\n                        editor,\n                        setHeaderRow(this.state.vtable.table),\n                        this.state.vtable.table\n                    );\n\n                    this.forceUpdate();\n                }}>\n                Header Row\n            </button>\n        );\n    }\n\n    private renderSetFirstColumnButton(editor: IEditor): JSX.Element {\n        return (\n            <button\n                className={styles.button}\n                onClick={() => {\n                    formatTable(\n                        editor,\n                        setFirstColumn(this.state.vtable.table),\n                        this.state.vtable.table\n                    );\n\n                    this.forceUpdate();\n                }}>\n                First Column\n            </button>\n        );\n    }\n    private renderSetBandedColumnButton(editor: IEditor): JSX.Element {\n        return (\n            <button\n                className={styles.button}\n                onClick={() => {\n                    formatTable(\n                        editor,\n                        setBandedColumn(this.state.vtable.table),\n                        this.state.vtable.table\n                    );\n\n                    this.forceUpdate();\n                }}>\n                Banded Column\n            </button>\n        );\n    }\n    private renderSetBandedRowButton(editor: IEditor): JSX.Element {\n        return (\n            <button\n                className={styles.button}\n                onClick={() => {\n                    formatTable(\n                        editor,\n                        setBandedRow(this.state.vtable.table),\n                        this.state.vtable.table\n                    );\n\n                    this.forceUpdate();\n                }}>\n                Banded Row\n            </button>\n        );\n    }\n\n    private renderFormatTableButton(\n        text: string,\n        format: TableFormat,\n        editor: IEditor\n    ): JSX.Element {\n        return (\n            <button\n                className={styles.button}\n                onClick={() => {\n                    formatTable(editor, format, this.state.vtable.table);\n                    this.forceUpdate();\n                }}>\n                {text}\n            </button>\n        );\n    }\n\n    private onCustomizeFormat = () => {\n        const format = createTableFormat(\n            this.topBorderColor.current.value || undefined,\n            this.bottomBorderColor.current.value || undefined,\n            this.verticalBorderColor.current.value || undefined\n        );\n\n        this.state.vtable.applyFormat(format);\n        this.forceUpdate();\n    };\n\n    private onWriteBack = () => {\n        const editor = this.props.getEditor();\n        editor.addUndoSnapshot(() => {\n            const vtable = this.state.vtable;\n            const td = vtable.getCurrentTd();\n            vtable.writeBack();\n            editor.focus();\n            editor.select(td, PositionType.Begin);\n        });\n        this.createVTable();\n    };\n}\n\nfunction setHeaderRow(table: HTMLTableElement): TableFormat {\n    const vtable = new VTable(table);\n    const format = vtable.formatInfo;\n    format.keepCellShade = true;\n    format.hasHeaderRow = !format.hasHeaderRow;\n\n    return format;\n}\n\nfunction setFirstColumn(table: HTMLTableElement): TableFormat {\n    const vtable = new VTable(table);\n    const format = vtable.formatInfo;\n    format.keepCellShade = true;\n    format.hasFirstColumn = !format.hasFirstColumn;\n    return format;\n}\n\nfunction setBandedColumn(table: HTMLTableElement): TableFormat {\n    const vtable = new VTable(table);\n    const format = vtable.formatInfo;\n    format.keepCellShade = true;\n    format.hasBandedColumns = !format.hasBandedColumns;\n    return format;\n}\n\nfunction setBandedRow(table: HTMLTableElement): TableFormat {\n    const vtable = new VTable(table);\n    const format = vtable.formatInfo;\n    format.keepCellShade = true;\n    format.hasBandedRows = !format.hasBandedRows;\n    return format;\n}\n\nfunction CustomizeFormatRow(props: { text: string; inputRef: React.RefObject<HTMLInputElement> }) {\n    const [isColorPickerShowing, setIsColorPickerShowing] = React.useState(false);\n    const onShowColorPicker = React.useCallback(() => {\n        setIsColorPickerShowing(!isColorPickerShowing);\n    }, [isColorPickerShowing]);\n    const setColor = React.useCallback((color: Color) => {\n        props.inputRef.current.value = color.hex().toString();\n    }, []);\n    let color: Color;\n    try {\n        color = Color(props.inputRef.current.value);\n    } catch {\n        color = Color('white');\n    }\n    return (\n        <>\n            <tr>\n                <td className={styles.label}>\n                    <button onClick={onShowColorPicker}>{props.text}</button>\n                </td>\n                <td>\n                    <input type=\"text\" ref={props.inputRef} />\n                </td>\n            </tr>\n            {isColorPickerShowing && (\n                <tr>\n                    <td colSpan={2}>\n                        <ColorPicker initColor={color} onSelect={setColor} />\n                    </td>\n                </tr>\n            )}\n        </>\n    );\n}\n","import * as React from 'react';\nimport ContentModelRibbonButton from '../../ribbonButtons/contentModel/ContentModelRibbonButton';\nimport { ContentModelDocument } from 'roosterjs-content-model-types';\nimport { ContentModelDocumentView } from '../../contentModel/components/model/ContentModelDocumentView';\nimport { ContentModelRibbon } from '../../ribbonButtons/contentModel/ContentModelRibbon';\nimport { ContentModelRibbonPlugin } from '../../ribbonButtons/contentModel/ContentModelRibbonPlugin';\nimport { exportButton } from './buttons/exportButton';\nimport { refreshButton } from './buttons/refreshButton';\nimport { SidePaneElementProps } from '../SidePaneElement';\n\nconst styles = require('./ContentModelPane.scss');\n\nexport interface ContentModelPaneState {\n    model: ContentModelDocument;\n}\n\nexport interface ContentModelPaneProps extends ContentModelPaneState, SidePaneElementProps {\n    ribbonPlugin: ContentModelRibbonPlugin;\n}\n\nexport default class ContentModelPane extends React.Component<\n    ContentModelPaneProps,\n    ContentModelPaneState\n> {\n    private contentModelButtons: ContentModelRibbonButton<any>[];\n\n    constructor(props: ContentModelPaneProps) {\n        super(props);\n\n        this.contentModelButtons = [refreshButton, exportButton];\n\n        this.state = {\n            model: null,\n        };\n    }\n\n    setContentModel(model: ContentModelDocument) {\n        this.setState({\n            model: model,\n        });\n    }\n\n    render() {\n        return (\n            <>\n                <ContentModelRibbon\n                    buttons={this.contentModelButtons}\n                    plugin={this.props.ribbonPlugin}\n                />\n                <div className={styles.contentModel}>\n                    {this.state.model ? <ContentModelDocumentView doc={this.state.model} /> : null}\n                </div>\n            </>\n        );\n    }\n}\n","import ContentModelPane, { ContentModelPaneProps } from './ContentModelPane';\nimport SidePanePluginImpl from '../SidePanePluginImpl';\nimport { ContentModelRibbonPlugin } from '../../ribbonButtons/contentModel/ContentModelRibbonPlugin';\nimport { IEditor as ILegacyEditor, PluginEvent, PluginEventType } from 'roosterjs-editor-types';\nimport { IEditor } from 'roosterjs-content-model-types';\nimport { setCurrentContentModel } from './currentModel';\nimport { SidePaneElementProps } from '../SidePaneElement';\n\nexport default class ContentModelPanePlugin extends SidePanePluginImpl<\n    ContentModelPane,\n    ContentModelPaneProps\n> {\n    private contentModelRibbon: ContentModelRibbonPlugin;\n\n    constructor() {\n        super(ContentModelPane, 'contentModel', 'Content Model (Under development)');\n        this.contentModelRibbon = new ContentModelRibbonPlugin();\n    }\n\n    initialize(editor: ILegacyEditor): void {\n        super.initialize(editor);\n\n        this.contentModelRibbon.initialize(editor as ILegacyEditor & IEditor); //  TODO: Port side pane to use IStandaloneEditor\n        editor.getDocument().addEventListener('selectionchange', this.onModelChangeFromSelection);\n    }\n\n    dispose(): void {\n        this.contentModelRibbon.dispose();\n        this.editor\n            .getDocument()\n            .removeEventListener('selectionchange', this.onModelChangeFromSelection);\n\n        super.dispose();\n    }\n\n    onPluginEvent(e: PluginEvent) {\n        if (e.eventType == PluginEventType.ContentChanged && e.source == 'RefreshModel') {\n            this.getComponent(component => {\n                const model = (this.editor as ILegacyEditor & IEditor).getContentModelCopy(\n                    'connected'\n                );\n                component.setContentModel(model);\n                setCurrentContentModel(model);\n            });\n        } else if (\n            e.eventType == PluginEventType.Input ||\n            e.eventType == PluginEventType.ContentChanged\n        ) {\n            this.onModelChange();\n        }\n\n        // this.contentModelRibbon.onPluginEvent(e);\n    }\n\n    getInnerRibbonPlugin() {\n        return this.contentModelRibbon;\n    }\n\n    protected getComponentProps(baseProps: SidePaneElementProps): ContentModelPaneProps {\n        return {\n            ...baseProps,\n            model: null,\n            ribbonPlugin: this.contentModelRibbon,\n        };\n    }\n\n    private onModelChangeFromSelection = () => {\n        if (this.editor.hasFocus()) {\n            this.onModelChange();\n        }\n    };\n\n    private onModelChange = () => {\n        this.getComponent(component => {\n            // TODO: Port to use IStandaloneEditor and remove type cast here\n            const model = (this.editor as ILegacyEditor & IEditor).getContentModelCopy('connected');\n            component.setContentModel(model);\n            setCurrentContentModel(model);\n        });\n    };\n}\n","import ContentModelRibbonButton from '../../../ribbonButtons/contentModel/ContentModelRibbonButton';\nimport { getCurrentContentModel } from '../currentModel';\n\nexport const exportButton: ContentModelRibbonButton<'buttonNameExport'> = {\n    key: 'buttonNameExport',\n    unlocalizedText: 'Create DOM tree',\n    iconName: 'DOM',\n    onClick: editor => {\n        const model = getCurrentContentModel();\n\n        if (model) {\n            editor.formatContentModel(currentModel => {\n                currentModel.blocks = model.blocks;\n\n                return true;\n            });\n        }\n    },\n};\n","import ContentModelRibbonButton from '../../../ribbonButtons/contentModel/ContentModelRibbonButton';\n\nexport const refreshButton: ContentModelRibbonButton<'buttonNameRefresh'> = {\n    key: 'buttonNameRefresh',\n    unlocalizedText: 'Refresh',\n    iconName: 'Refresh',\n    onClick: editor => {\n        editor.triggerEvent('contentChanged', {\n            source: 'RefreshModel',\n        });\n    },\n};\n","import { ContentModelDocument } from 'roosterjs-content-model-types';\n\nlet currentModel: ContentModelDocument | null = null;\n\nexport function getCurrentContentModel(): ContentModelDocument | null {\n    return currentModel;\n}\n\nexport function setCurrentContentModel(model: ContentModelDocument | null) {\n    currentModel = model;\n}\n","import * as React from 'react';\nimport apiEntries, { ApiPlaygroundReactComponent } from './apiEntries';\nimport ApiPaneProps from './ApiPaneProps';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\nimport { PluginEvent } from 'roosterjs-editor-types';\nimport { SidePaneElement } from '../SidePaneElement';\n\nconst styles = require('./ApiPlaygroundPane.scss');\n\nexport interface ApiPlaygroundPaneState {\n    current: string;\n}\n\nexport default class ApiPlaygroundPane extends React.Component<ApiPaneProps, ApiPlaygroundPaneState>\n    implements SidePaneElement {\n    private select = React.createRef<HTMLSelectElement>();\n    private pane = React.createRef<ApiPlaygroundReactComponent>();\n    constructor(props: ApiPaneProps) {\n        super(props);\n        this.state = { current: 'empty' };\n    }\n\n    render() {\n        let componentClass = apiEntries[this.state.current].component;\n        let pane: JSX.Element = null;\n        if (componentClass) {\n            pane = React.createElement(componentClass, { ...this.props, ref: this.pane });\n        }\n\n        return (\n            <>\n                <div className={styles.header}>\n                    <h3>Select an API to try</h3>\n\n                    <select ref={this.select} value={this.state.current} onChange={this.onChange}>\n                        {getObjectKeys(apiEntries).map(key => (\n                            <option value={key} key={key}>\n                                {apiEntries[key].name}\n                            </option>\n                        ))}\n                    </select>\n                </div>\n                {pane}\n            </>\n        );\n    }\n\n    onPluginEvent(e: PluginEvent) {\n        if (this.pane.current && this.pane.current.onPluginEvent) {\n            this.pane.current.onPluginEvent(e);\n        }\n    }\n\n    setHashPath(path: string[]) {\n        let paneName = path && getObjectKeys(apiEntries).indexOf(path[0]) >= 0 ? path[0] : null;\n\n        if (paneName && paneName != this.state.current) {\n            this.setState({\n                current: paneName,\n            });\n        } else {\n            this.props.updateHash(null, [this.state.current]);\n        }\n    }\n\n    private onChange = () => {\n        this.props.updateHash(null, [this.select.current.value]);\n    };\n}\n","import ApiPaneProps from './ApiPaneProps';\nimport ApiPlaygroundPane from './ApiPlaygroundPane';\nimport SidePanePluginImpl from '../SidePanePluginImpl';\nimport { PluginEvent } from 'roosterjs-editor-types';\nimport { SidePaneElementProps } from '../SidePaneElement';\n\nexport default class ApiPlaygroundPlugin extends SidePanePluginImpl<\n    ApiPlaygroundPane,\n    ApiPaneProps\n> {\n    constructor() {\n        super(ApiPlaygroundPane, 'api', 'API Playground');\n    }\n\n    getComponentProps(base: SidePaneElementProps) {\n        return {\n            ...base,\n            getEditor: () => {\n                return this.editor;\n            },\n        };\n    }\n\n    onPluginEvent(e: PluginEvent) {\n        this.getComponent(component => component.onPluginEvent(e));\n    }\n}\n","import * as React from 'react';\nimport ApiPaneProps, { ApiPlaygroundComponent } from './ApiPaneProps';\nimport InsertEntityPane from './insertEntity/InsertEntityPane';\n\nexport interface ApiPlaygroundReactComponent\n    extends React.Component<ApiPaneProps, any>,\n        ApiPlaygroundComponent {}\n\ninterface ApiEntry {\n    name: string;\n    component?: { new (prpos: ApiPaneProps): ApiPlaygroundReactComponent };\n}\n\nconst apiEntries: { [key: string]: ApiEntry } = {\n    empty: {\n        name: 'Please select',\n    },\n    entity: {\n        name: 'Insert Entity',\n        component: InsertEntityPane,\n    },\n    more: {\n        name: 'Coming soon...',\n    },\n};\n\nexport default apiEntries;\n","import * as React from 'react';\nimport ApiPaneProps from '../ApiPaneProps';\nimport { Entity, IEditor as ILegacyEditor } from 'roosterjs-editor-types';\nimport { getEntityFromElement, getEntitySelector } from 'roosterjs-editor-dom';\nimport { IEditor, InsertEntityOptions } from 'roosterjs-content-model-types';\nimport { insertEntity } from 'roosterjs-content-model-api';\nimport { trustedHTMLHandler } from '../../../../utils/trustedHTMLHandler';\n\nconst styles = require('./InsertEntityPane.scss');\n\ninterface InsertEntityPaneState {\n    entities: Entity[];\n}\n\nexport default class InsertEntityPane extends React.Component<ApiPaneProps, InsertEntityPaneState> {\n    private entityType = React.createRef<HTMLInputElement>();\n    private html = React.createRef<HTMLTextAreaElement>();\n    private styleInline = React.createRef<HTMLInputElement>();\n    private styleBlock = React.createRef<HTMLInputElement>();\n    private focusAfterEntity = React.createRef<HTMLInputElement>();\n\n    private posFocus = React.createRef<HTMLInputElement>();\n    private posTop = React.createRef<HTMLInputElement>();\n    private posBottom = React.createRef<HTMLInputElement>();\n    private posRegionRoot = React.createRef<HTMLInputElement>();\n\n    constructor(props: ApiPaneProps) {\n        super(props);\n        this.state = {\n            entities: [],\n        };\n    }\n\n    render() {\n        return (\n            <>\n                <div>\n                    Type: <input type=\"input\" ref={this.entityType} />\n                </div>\n                <div>\n                    HTML: <textarea className={styles.textarea} ref={this.html}></textarea>\n                </div>\n                <div>\n                    Style:\n                    <input\n                        type=\"radio\"\n                        name=\"entityStyle\"\n                        ref={this.styleInline}\n                        id=\"styleInline\"\n                    />\n                    <label htmlFor=\"styleInline\">Inline</label>\n                    <input type=\"radio\" name=\"entityStyle\" ref={this.styleBlock} id=\"styleBlock\" />\n                    <label htmlFor=\"styleBlock\">Block</label>\n                </div>\n                <div>\n                    Position:\n                    <br />\n                    <input type=\"radio\" name=\"position\" ref={this.posFocus} id=\"posFocus\" />\n                    <label htmlFor=\"posFocus\">Current focus</label>\n                    <br />\n                    <input type=\"radio\" name=\"position\" ref={this.posTop} id=\"posTop\" />\n                    <label htmlFor=\"posTop\">Top</label>\n                    <br />\n                    <input type=\"radio\" name=\"position\" ref={this.posBottom} id=\"posBottom\" />\n                    <label htmlFor=\"posBottom\">Bottom</label>\n                    <br />\n                    <input\n                        type=\"radio\"\n                        name=\"position\"\n                        ref={this.posRegionRoot}\n                        id=\"posRegionRoot\"\n                    />\n                    <label htmlFor=\"posRegionRoot\">Region root</label>\n                    <br />\n                </div>\n                <div>\n                    <input id=\"focusAfterEntity\" type=\"checkbox\" ref={this.focusAfterEntity} />\n                    <label htmlFor=\"focusAfterEntity\">Focus after entity</label>\n                </div>\n                <div>\n                    <button onClick={this.insertEntity}>Insert Entity</button>\n                </div>\n                <hr />\n                <div>\n                    <button onClick={this.onGetEntities}>Get all entities</button>\n                </div>\n                <div>\n                    {this.state.entities.map(entity => (\n                        <EntityButton key={entity.id} entity={entity} />\n                    ))}\n                </div>\n            </>\n        );\n    }\n\n    private insertEntity = () => {\n        const entityType = this.entityType.current.value;\n        const node = document.createElement('span');\n        node.innerHTML = trustedHTMLHandler(this.html.current.value);\n        const isBlock = this.styleBlock.current.checked;\n        const focusAfterEntity = this.focusAfterEntity.current.checked;\n        const insertAtTop = this.posTop.current.checked;\n        const insertAtBottom = this.posBottom.current.checked;\n        const insertAtRoot = this.posRegionRoot.current.checked;\n\n        if (node) {\n            const editor = this.props.getEditor();\n            const options: InsertEntityOptions = {\n                contentNode: node,\n                focusAfterEntity: focusAfterEntity,\n            };\n\n            editor.focus();\n\n            if (isBlock) {\n                insertEntity(\n                    editor as IEditor & ILegacyEditor,\n                    entityType,\n                    true,\n                    insertAtRoot\n                        ? 'root'\n                        : insertAtTop\n                        ? 'begin'\n                        : insertAtBottom\n                        ? 'end'\n                        : 'focus',\n                    options\n                );\n            } else {\n                insertEntity(\n                    editor as IEditor & ILegacyEditor,\n                    entityType,\n                    isBlock,\n                    insertAtTop ? 'begin' : insertAtBottom ? 'end' : 'focus',\n                    options\n                );\n            }\n        }\n    };\n\n    private onGetEntities = () => {\n        const selector = getEntitySelector();\n        const nodes = this.props.getEditor().queryElements(selector);\n        const allEntities = nodes.map(node => getEntityFromElement(node));\n\n        this.setState({\n            entities: allEntities.filter(e => !!e),\n        });\n    };\n}\n\nfunction EntityButton({ entity }: { entity: Entity }) {\n    let background = '';\n    const onMouseOver = React.useCallback(() => {\n        background = entity.wrapper.style.backgroundColor;\n        entity.wrapper.style.backgroundColor = 'blue';\n    }, [entity]);\n\n    const onMouseOut = React.useCallback(() => {\n        entity.wrapper.style.backgroundColor = background;\n    }, [entity]);\n\n    return (\n        <div onMouseOver={onMouseOver} onMouseOut={onMouseOut}>\n            Type: {entity.type}\n            <br />\n            Id: {entity.id}\n            <br />\n            Readonly: {entity.isReadonly ? 'True' : 'False'}\n            <br />\n        </div>\n    );\n}\n","import * as React from 'react';\nimport BuildInPluginState from '../../BuildInPluginState';\nimport EditorCode from './codes/EditorCode';\n\nexport interface CodeProps {\n    state: BuildInPluginState;\n}\n\nexport default class Code extends React.Component<CodeProps, {}> {\n    render() {\n        let editor = new EditorCode(this.props.state);\n        return (\n            <div>\n                <pre>{editor.getCode()}</pre>\n            </div>\n        );\n    }\n}\n","import * as React from 'react';\nimport BuildInPluginState from '../../BuildInPluginState';\nimport { ContentEditFeatureSettings } from 'roosterjs-editor-types';\nimport { getAllFeatures } from 'roosterjs-editor-plugins/lib/ContentEdit';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\n\ntype ContentEditItemId = keyof ContentEditFeatureSettings;\n\nconst styles = require('./OptionsPane.scss');\nconst EditFeatureDescriptionMap: Record<keyof ContentEditFeatureSettings, string> = {\n    autoBullet: 'Auto Bullet / Numbering',\n    indentWhenTab: 'Indent list when Tab',\n    outdentWhenShiftTab: 'Outdent list when Shift + Tab',\n    outdentWhenBackspaceOnEmptyFirstLine: 'Outdent list when Backspace on empty first Line',\n    outdentWhenEnterOnEmptyLine: 'Outdent list when Enter on empty line',\n    mergeInNewLineWhenBackspaceOnFirstChar:\n        'Merge in new line when Backspace on first char in list',\n    maintainListChain: 'Maintain the continued list numbers',\n    unquoteWhenBackspaceOnEmptyFirstLine: 'Unquote when Backspace on empty first line',\n    unquoteWhenEnterOnEmptyLine: 'Unquote when Enter on empty line',\n    tabInTable: 'Tab to jump cell in table',\n    upDownInTable: 'Up / Down to jump cell in table',\n    insertLineBeforeStructuredNodeFeature:\n        'Enter to create new line before table/list at beginning of editor content',\n    autoLink: 'Auto link',\n    unlinkWhenBackspaceAfterLink: 'Auto unlink when backspace right after a hyperlink',\n    defaultShortcut: 'Default Shortcuts',\n    noCycleCursorMove: 'Avoid moving cycle moving cursor when Ctrl+Left/Right',\n    clickOnEntity: 'Fire an event when click on a readonly entity',\n    escapeFromEntity: 'Fire an event when Escape from a readonly entity',\n    enterBeforeReadonlyEntity: 'Start a new line when Enter before an event',\n    backspaceAfterEntity: 'Fire an event when Backspace after an entity',\n    deleteBeforeEntity: 'Fire an event when Delete before an event',\n    markdownBold: 'Markdown style Bolding',\n    markdownItalic: 'Markdown style Italics',\n    markdownStrikethru: 'Markdown style Strikethrough',\n    markdownInlineCode: 'Markdown style Code blocks',\n    maintainListChainWhenDelete:\n        'Maintain the list of number in the right order after press delete before the first item',\n    indentTableOnTab: 'Indent the table if it is all cells are selected.',\n    indentWhenTabText:\n        'On Tab indent the selection or add Tab, requires TabKeyFeatures Experimental Feature',\n    outdentWhenTabText:\n        'On Shift + Tab outdent the selection, requires TabKeyFeatures Experimental Feature',\n    autoHyphen: 'Automatically transform -- into hyphen, if typed between two words.',\n    autoBulletList:\n        'When press space after *, -, --, ->, -->, >, =>  in an empty line, toggle bullet',\n    autoNumberingList:\n        'When press space after an number, a letter or roman number followed by ), ., -, or between parenthesis in an empty line, toggle numbering',\n    mergeListOnBackspaceAfterList: 'When backspacing between lists, merge the lists',\n    deleteTableWithBackspace: 'Delete table with backspace key with whole table is selected',\n    moveBetweenDelimitersFeature:\n        'Content edit feature to move the cursor from Delimiters around Entities when using Right or Left Arrow Keys',\n    removeEntityBetweenDelimiters:\n        'When using BACKSPACE or DELETE in a Readonly inline entity delimeter, trigger a Entity Operation',\n    removeCodeWhenEnterOnEmptyLine: 'Remove code line when enter on empty line',\n    removeCodeWhenBackspaceOnEmptyFirstLine: 'Remove code line when backspace on empty first line',\n    indentWhenAltShiftRight: 'Indent list item using Alt + Shift + Right',\n    outdentWhenAltShiftLeft: 'Outdent list item using Alt + Shift + Left',\n};\n\nexport interface ContentEditFeaturessProps {\n    state: ContentEditFeatureSettings;\n    resetState: (callback: (state: BuildInPluginState) => void, resetEditor: boolean) => void;\n}\n\nexport default class ContentEditFeatures extends React.Component<ContentEditFeaturessProps, {}> {\n    render() {\n        const features = getAllFeatures();\n        return (\n            <table>\n                <tbody>\n                    {getObjectKeys(features).map(key =>\n                        this.renderContentEditItem(key, EditFeatureDescriptionMap[key])\n                    )}\n                </tbody>\n            </table>\n        );\n    }\n\n    private renderContentEditItem(\n        id: ContentEditItemId,\n        text: string,\n        moreOptions?: JSX.Element\n    ): JSX.Element {\n        const checked = this.props.state[id];\n\n        return (\n            <tr key={id}>\n                <td className={styles.checkboxColumn}>\n                    <input\n                        type=\"checkbox\"\n                        id={id}\n                        checked={checked}\n                        title={id}\n                        onChange={() => this.onContentEditClick(id)}\n                    />\n                </td>\n                <td>\n                    <div>\n                        <label htmlFor={id} title={id}>\n                            {text}\n                        </label>\n                    </div>\n                    {checked && moreOptions}\n                </td>\n            </tr>\n        );\n    }\n\n    private onContentEditClick = (id: ContentEditItemId) => {\n        this.props.resetState(state => {\n            let checkbox = document.getElementById(id) as HTMLInputElement;\n            state.contentEditFeatures[id] = checkbox.checked;\n        }, true);\n    };\n}\n","import BuildInPluginState, { BuildInPluginProps, UrlPlaceholder } from '../../BuildInPluginState';\nimport ContentModelOptionsPane from './ContentModelOptionsPane';\nimport getDefaultContentEditFeatureSettings from './getDefaultContentEditFeatureSettings';\nimport SidePanePluginImpl from '../SidePanePluginImpl';\nimport { SidePaneElementProps } from '../SidePaneElement';\n\nconst listFeatures = {\n    autoBullet: false,\n    indentWhenTab: false,\n    outdentWhenShiftTab: false,\n    outdentWhenBackspaceOnEmptyFirstLine: false,\n    outdentWhenEnterOnEmptyLine: false,\n    mergeInNewLineWhenBackspaceOnFirstChar: false,\n    maintainListChain: false,\n    maintainListChainWhenDelete: false,\n    autoNumberingList: false,\n    autoBulletList: false,\n    mergeListOnBackspaceAfterList: false,\n    outdentWhenAltShiftLeft: false,\n    indentWhenAltShiftRight: false,\n};\n\nconst initialState: BuildInPluginState = {\n    pluginList: {\n        contentEdit: true,\n        hyperlink: true,\n        paste: false,\n        watermark: false,\n        imageEdit: true,\n        cutPasteListChain: false,\n        tableCellSelection: true,\n        customReplace: true,\n        listEditMenu: true,\n        imageEditMenu: true,\n        tableEditMenu: true,\n        contextMenu: true,\n        autoFormat: true,\n        announce: true,\n    },\n    contentEditFeatures: { ...getDefaultContentEditFeatureSettings(), ...listFeatures },\n    defaultFormat: {},\n    linkTitle: 'Ctrl+Click to follow the link:' + UrlPlaceholder,\n    watermarkText: 'Type content here ...',\n    forcePreserveRatio: false,\n    applyChangesOnMouseUp: false,\n    experimentalFeatures: [],\n    isRtl: false,\n    cacheModel: true,\n    tableFeaturesContainerSelector: '#' + 'EditorContainer',\n};\n\nexport default class ContentModelEditorOptionsPlugin extends SidePanePluginImpl<\n    ContentModelOptionsPane,\n    BuildInPluginProps\n> {\n    constructor() {\n        super(ContentModelOptionsPane, 'options', 'Editor Options');\n    }\n\n    getBuildInPluginState(): BuildInPluginState {\n        let result: BuildInPluginState;\n        this.getComponent(component => (result = component.getState()));\n        return result || initialState;\n    }\n\n    getComponentProps(base: SidePaneElementProps) {\n        return {\n            ...initialState,\n            ...base,\n        };\n    }\n}\n","import * as React from 'react';\nimport BuildInPluginState from '../../BuildInPluginState';\nimport { ExperimentalFeatures } from 'roosterjs-editor-types';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\n\nexport interface ExperimentalFeaturesProps {\n    state: ExperimentalFeatures[];\n    resetState: (callback: (state: BuildInPluginState) => void, resetEditor: boolean) => void;\n}\n\nconst FeatureNames: Partial<Record<ExperimentalFeatures, string>> = {\n    [ExperimentalFeatures.TabKeyTextFeatures]: 'Additional functionality to Tab Key',\n    [ExperimentalFeatures.ReuseAllAncestorListElements]:\n        \"Reuse ancestor list elements even if they don't match the types from the list item.\",\n    [ExperimentalFeatures.DeleteTableWithBackspace]:\n        'Delete a table selected with the table selector pressing Backspace key',\n    [ExperimentalFeatures.DisableListChain]: 'Disable list chain functionality',\n};\n\nexport default class ContentModelExperimentalFeaturesPane extends React.Component<\n    ExperimentalFeaturesProps,\n    {}\n> {\n    render() {\n        return <>{getObjectKeys(FeatureNames).map(name => this.renderFeature(name))}</>;\n    }\n\n    private renderFeature(name: keyof typeof FeatureNames): JSX.Element {\n        let checked = this.props.state.indexOf(name) >= 0;\n        return (\n            <div key={name}>\n                <input\n                    type=\"checkbox\"\n                    checked={checked}\n                    id={name}\n                    onChange={() => this.onClick(name)}\n                />\n                <label htmlFor={name}>{name + ': ' + FeatureNames[name]}</label>\n            </div>\n        );\n    }\n\n    private onClick = (name: keyof typeof FeatureNames) => {\n        this.props.resetState(state => {\n            let checkbox = document.getElementById(name) as HTMLInputElement;\n            let index = state.experimentalFeatures.indexOf(name);\n\n            if (checkbox.checked && index < 0) {\n                state.experimentalFeatures.push(name);\n            } else if (!checkbox.checked && index >= 0) {\n                state.experimentalFeatures.splice(index, 1);\n            }\n        }, true);\n    };\n}\n","import * as React from 'react';\nimport BuildInPluginState, { BuildInPluginProps } from '../../BuildInPluginState';\nimport Code from './Code';\nimport ContentEditFeatures from './ContentEditFeatures';\nimport ContentModelEditorCode from './codes/ContentModelEditorCode';\nimport ContentModelExperimentalFeaturesPane from './ContentModelExperimentalFeatures';\nimport ContentModelPlugins from './ContentModelPlugins';\nimport DefaultFormatPane from './DefaultFormat';\nimport MainPaneBase from '../../MainPaneBase';\n\nconst htmlStart =\n    '<html>\\n' +\n    '<body>\\n' +\n    '<div id=\"contentDiv\" style=\"width: 800px; height: 400px; border: solid 1px black; overflow: auto\"></div>\\n';\nconst htmlButtons =\n    '<button id=buttonB><b>B</b></button>\\n' +\n    '<button id=buttonI><i>I</i></button>\\n' +\n    '<button id=buttonU><u>U</u></button>\\n' +\n    '<button id=buttonBullet>Bullet</button>\\n' +\n    '<button id=buttonNumbering>Numbering</button>\\n' +\n    '<button id=buttonUndo>Undo</button>\\n' +\n    '<button id=buttonRedo>Redo</button>\\n';\nconst darkButton = '<button id=buttonDark>Dark Mode</button>\\n';\nconst htmlEnd =\n    '<script src=\"https://microsoft.github.io/roosterjs/rooster-min.js\"></script>\\n' +\n    '<script src=\"https://microsoft.github.io/roosterjs/rooster-content-model-min.js\"></script>\\n' +\n    '</body>\\n' +\n    '</html>';\n\nexport default class ContentModelOptionsPane extends React.Component<\n    BuildInPluginProps,\n    BuildInPluginState\n> {\n    private exportForm = React.createRef<HTMLFormElement>();\n    private exportData = React.createRef<HTMLInputElement>();\n    private rtl = React.createRef<HTMLInputElement>();\n    private cacheModel = React.createRef<HTMLInputElement>();\n\n    constructor(props: BuildInPluginProps) {\n        super(props);\n        this.state = { ...props };\n    }\n    render() {\n        return (\n            <div>\n                <div>\n                    <button onClick={this.onExportRoosterContentModel}>\n                        Try roosterjs Content Model Editor in CodePen\n                    </button>\n                </div>\n                <div>\n                    <br />\n                </div>\n                <details>\n                    <summary>\n                        <b>Plugins:</b>\n                    </summary>\n                    <ContentModelPlugins state={this.state} resetState={this.resetState} />\n                </details>\n                <details>\n                    <summary>\n                        <b>Content edit features:</b>\n                    </summary>\n                    <ContentEditFeatures\n                        state={this.state.contentEditFeatures}\n                        resetState={this.resetState}\n                    />\n                </details>\n                <details>\n                    <summary>\n                        <b>Default Format:</b>\n                    </summary>\n                    <DefaultFormatPane\n                        state={this.state.defaultFormat}\n                        resetState={this.resetState}\n                    />\n                </details>\n                <details>\n                    <summary>\n                        <b>Experimental features:</b>\n                    </summary>\n                    <ContentModelExperimentalFeaturesPane\n                        state={this.state.experimentalFeatures}\n                        resetState={this.resetState}\n                    />\n                </details>\n                <div>\n                    <br />\n                </div>\n                <div>\n                    <input\n                        id=\"pageRtl\"\n                        type=\"checkbox\"\n                        checked={this.state.isRtl}\n                        onChange={this.onToggleDirection}\n                        ref={this.rtl}\n                    />\n                    <label htmlFor=\"pageRtl\">Show controls from right to left</label>\n                </div>\n                <div>\n                    <input\n                        id=\"cacheModel\"\n                        type=\"checkbox\"\n                        checked={this.state.cacheModel}\n                        onChange={this.onToggleCacheModel}\n                        ref={this.cacheModel}\n                    />\n                    <label htmlFor=\"cacheModel\">Use Content Model Cache</label>\n                </div>\n                <hr />\n                <details>\n                    <summary>\n                        <b>HTML Code:</b>\n                    </summary>\n                    <div>\n                        <code>\n                            <pre>{this.getHtml()}</pre>\n                        </code>\n                    </div>\n                </details>\n                <details>\n                    <summary>\n                        <b>Typescript Code:</b>\n                    </summary>\n                    <Code state={this.state} />\n                </details>\n                <form\n                    ref={this.exportForm}\n                    method=\"POST\"\n                    action=\"https://codepen.io/pen/define\"\n                    target=\"_blank\">\n                    <input name=\"data\" type=\"hidden\" ref={this.exportData} />\n                </form>\n            </div>\n        );\n    }\n\n    getState(): BuildInPluginState {\n        return { ...this.state };\n    }\n\n    private resetState = (callback: (state: BuildInPluginState) => void, resetEditor: boolean) => {\n        let state: BuildInPluginState = {\n            linkTitle: this.state.linkTitle,\n            watermarkText: this.state.watermarkText,\n            pluginList: { ...this.state.pluginList },\n            contentEditFeatures: { ...this.state.contentEditFeatures },\n            defaultFormat: { ...this.state.defaultFormat },\n            experimentalFeatures: this.state.experimentalFeatures,\n            forcePreserveRatio: this.state.forcePreserveRatio,\n            applyChangesOnMouseUp: this.state.applyChangesOnMouseUp,\n            isRtl: this.state.isRtl,\n            cacheModel: this.state.cacheModel,\n            tableFeaturesContainerSelector: this.state.tableFeaturesContainerSelector,\n        };\n\n        if (callback) {\n            callback(state);\n            this.setState(state);\n        }\n\n        if (resetEditor) {\n            MainPaneBase.getInstance().resetEditorPlugin(state);\n        }\n    };\n\n    private onExportRoosterContentModel = () => {\n        let editor = new ContentModelEditorCode(this.state);\n        let code = editor.getCode();\n        let json = {\n            title: 'RoosterJs',\n            html: this.getHtml(),\n            head: '',\n            js: code,\n            js_pre_processor: 'typescript',\n        };\n        this.exportData.current.value = JSON.stringify(json);\n        this.exportForm.current.submit();\n    };\n\n    private onToggleDirection = () => {\n        let isRtl = this.rtl.current.checked;\n        this.setState({\n            isRtl: isRtl,\n        });\n        MainPaneBase.getInstance().setPageDirection(isRtl);\n    };\n\n    private onToggleCacheModel = () => {\n        this.resetState(state => {\n            state.cacheModel = this.cacheModel.current.checked;\n        }, true);\n    };\n\n    private getHtml() {\n        return `${htmlStart}${htmlButtons}${darkButton}${htmlEnd}`;\n    }\n}\n","import * as React from 'react';\nimport BuildInPluginState, { BuildInPluginList, UrlPlaceholder } from '../../BuildInPluginState';\n\ntype PluginItemId = keyof BuildInPluginList;\n\nconst styles = require('./OptionsPane.scss');\n\nexport interface PluginsProps {\n    state: BuildInPluginState;\n    resetState: (callback: (state: BuildInPluginState) => void, resetEditor: boolean) => void;\n}\n\nexport default class ContentModelPlugins extends React.Component<PluginsProps, {}> {\n    private linkTitle = React.createRef<HTMLInputElement>();\n    private watermarkText = React.createRef<HTMLInputElement>();\n    private forcePreserveRatio = React.createRef<HTMLInputElement>();\n    private applyChangesOnMouseUp = React.createRef<HTMLInputElement>();\n\n    render() {\n        return (\n            <table>\n                <tbody>\n                    {this.renderPluginItem('contentEdit', 'Content Edit')}\n                    {this.renderPluginItem(\n                        'hyperlink',\n                        'Hyperlink Plugin',\n                        this.renderInputBox(\n                            'Label title: ',\n                            this.linkTitle,\n                            this.props.state.linkTitle,\n                            'Use \"' + UrlPlaceholder + '\" for the url string',\n                            (state, value) => (state.linkTitle = value)\n                        )\n                    )}\n                    {this.renderPluginItem(\n                        'watermark',\n                        'Watermark Plugin',\n                        this.renderInputBox(\n                            'Watermark text: ',\n                            this.watermarkText,\n                            this.props.state.watermarkText,\n                            '',\n                            (state, value) => (state.watermarkText = value)\n                        )\n                    )}\n                    {this.renderPluginItem(\n                        'imageEdit',\n                        'Image Edit Plugin',\n                        this.renderCheckBox(\n                            'Force preserve ratio',\n                            this.forcePreserveRatio,\n                            this.props.state.forcePreserveRatio,\n                            (state, value) => (state.forcePreserveRatio = value)\n                        )\n                    )}\n                    {this.renderPluginItem(\n                        'imageEdit',\n                        'Image Edit Plugin',\n                        this.renderCheckBox(\n                            'Apply changed on mouse up',\n                            this.applyChangesOnMouseUp,\n                            this.props.state.applyChangesOnMouseUp,\n                            (state, value) => (state.applyChangesOnMouseUp = value)\n                        )\n                    )}\n                    {this.renderPluginItem('customReplace', 'Custom Replace Plugin (autocomplete)')}\n                    {this.renderPluginItem(\n                        'contextMenu',\n                        'Show customized context menu for special cases'\n                    )}\n                    {this.renderPluginItem('tableCellSelection', 'Table Cell Selection')}\n                </tbody>\n            </table>\n        );\n    }\n\n    private renderPluginItem(\n        id: PluginItemId,\n        text: string,\n        moreOptions?: JSX.Element\n    ): JSX.Element {\n        const checked = this.props.state.pluginList[id];\n\n        return (\n            <tr>\n                <td className={styles.checkboxColumn}>\n                    <input\n                        type=\"checkbox\"\n                        id={id}\n                        checked={checked}\n                        onChange={() => this.onPluginClick(id)}\n                    />\n                </td>\n                <td>\n                    <div>\n                        <label htmlFor={id}>{text}</label>\n                    </div>\n                    {checked && moreOptions}\n                </td>\n            </tr>\n        );\n    }\n\n    private renderInputBox(\n        label: string,\n        ref: React.RefObject<HTMLInputElement>,\n        value: string,\n        placeholder: string,\n        onChange: (state: BuildInPluginState, value: string) => void\n    ): JSX.Element {\n        return (\n            <div>\n                {label}\n                <input\n                    type=\"text\"\n                    ref={ref}\n                    value={value}\n                    placeholder={placeholder}\n                    onChange={() =>\n                        this.props.resetState(state => onChange(state, ref.current.value), false)\n                    }\n                    onBlur={() => this.props.resetState(null, true)}\n                />\n            </div>\n        );\n    }\n\n    private renderCheckBox(\n        label: string,\n        ref: React.RefObject<HTMLInputElement>,\n        value: boolean,\n        onChange: (state: BuildInPluginState, value: boolean) => void\n    ): JSX.Element {\n        return (\n            <div>\n                <input\n                    type=\"checkbox\"\n                    ref={ref}\n                    checked={value}\n                    onChange={() =>\n                        this.props.resetState(state => onChange(state, ref.current.checked), true)\n                    }\n                    onBlur={() => this.props.resetState(null, true)}\n                />\n                {label}\n            </div>\n        );\n    }\n\n    private onPluginClick = (id: PluginItemId) => {\n        this.props.resetState(state => {\n            let checkbox = document.getElementById(id) as HTMLInputElement;\n            state.pluginList[id] = checkbox.checked;\n        }, true);\n    };\n}\n","import * as React from 'react';\nimport BuildInPluginState from '../../BuildInPluginState';\nimport { DefaultFormat } from 'roosterjs-editor-types';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\n\ntype ToggleFormatId = 'bold' | 'italic' | 'underline';\ntype ModeIndependentColorId = 'textColors' | 'backgroundColors';\ntype SelectFormatId = Exclude<keyof DefaultFormat, ToggleFormatId | ModeIndependentColorId>;\n\nconst styles = require('./OptionsPane.scss');\nconst NOT_SET = 'NotSet';\n\nexport interface DefaultFormatProps {\n    state: DefaultFormat;\n    resetState: (callback: (state: BuildInPluginState) => void, resetEditor: boolean) => void;\n}\n\nexport default class DefaultFormatPane extends React.Component<DefaultFormatProps, {}> {\n    render() {\n        return (\n            <>\n                <table>\n                    <tbody>\n                        {this.renderFormatItem('bold', 'Bold')}\n                        {this.renderFormatItem('italic', 'Italic')}\n                        {this.renderFormatItem('underline', 'Underline')}\n                    </tbody>\n                </table>\n                <table>\n                    <tbody>\n                        {this.renderSelectItem('fontFamily', 'Font family: ', {\n                            [NOT_SET]: 'Not Set',\n                            Arial: 'Arial',\n                            Calibri: 'Calibri',\n                            'Courier New': 'Courier New',\n                            Tahoma: 'Tahoma',\n                            'Times New Roman': 'Times New Roman',\n                        })}\n                        {this.renderSelectItem('fontSize', 'Font size: ', {\n                            [NOT_SET]: 'Not Set',\n                            '8pt': '8',\n                            '10pt': '10',\n                            '12pt': '12',\n                            '16pt': '16',\n                            '20pt': '20',\n                            '36pt': '36',\n                            '72pt': '72',\n                        })}\n                        {this.renderSelectItem('textColor', 'Text color: ', {\n                            [NOT_SET]: 'Not Set',\n                            '#757b80': 'Gray',\n                            '#bd1398': 'Violet',\n                            '#7232ad': 'Purple',\n                            '#006fc9': 'Blue',\n                            '#4ba524': 'Green',\n                            '#e2c501': 'Yellow',\n                            '#d05c12': 'Orange',\n                            '#ff0000': 'Red',\n                            '#ffffff': 'White',\n                            '#000000': 'Black',\n                        })}\n                        {this.renderSelectItem('backgroundColor', 'Back color: ', {\n                            [NOT_SET]: 'Not Set',\n                            '#ffff00': 'Yellow',\n                            '#00ff00': 'Green',\n                            '#00ffff': 'Cyan',\n                            '#ff00ff': 'Purple',\n                            '#0000ff': 'Blue',\n                            '#ff0000': 'Red',\n                            '#bebebe': 'Gray',\n                            '#666666': 'Dark Gray',\n                            '#ffffff': 'White',\n                            '#000000': 'Black',\n                        })}\n                    </tbody>\n                </table>\n            </>\n        );\n    }\n\n    private renderFormatItem(id: ToggleFormatId, text: string): JSX.Element {\n        let checked = (this.props.state[id] as boolean) || false;\n        return (\n            <tr>\n                <td className={styles.checkboxColumn}>\n                    <input\n                        type=\"checkbox\"\n                        id={id}\n                        checked={checked}\n                        onChange={() => this.onFormatClick(id)}\n                    />\n                </td>\n                <td>\n                    <div>\n                        <label htmlFor={id}>{text}</label>\n                    </div>\n                </td>\n            </tr>\n        );\n    }\n\n    private renderSelectItem(\n        id: SelectFormatId,\n        label: string,\n        items: { [key: string]: string }\n    ): JSX.Element {\n        return (\n            <tr>\n                <td className={styles.defaultFormatLabel}>{label}</td>\n                <td>\n                    <select\n                        id={id}\n                        onChange={() => this.onSelectChanged(id)}\n                        defaultValue={(this.props.state[id] || NOT_SET) as string}>\n                        {getObjectKeys(items).map(key => (\n                            <option value={key} key={key}>\n                                {items[key]}\n                            </option>\n                        ))}\n                    </select>\n                </td>\n            </tr>\n        );\n    }\n\n    private onFormatClick = (id: ToggleFormatId) => {\n        this.props.resetState(state => {\n            let checkbox = document.getElementById(id) as HTMLInputElement;\n            state.defaultFormat[id] = checkbox.checked;\n        }, true);\n    };\n\n    private onSelectChanged = (id: SelectFormatId) => {\n        this.props.resetState(state => {\n            let value = (document.getElementById(id) as HTMLSelectElement).value;\n            state.defaultFormat[id] = value == NOT_SET ? null : value;\n        }, true);\n    };\n}\n","import BuildInPluginState, { BuildInPluginProps, UrlPlaceholder } from '../../BuildInPluginState';\nimport getDefaultContentEditFeatureSettings from './getDefaultContentEditFeatureSettings';\nimport OptionsPane from './OptionsPane';\nimport SidePanePluginImpl from '../SidePanePluginImpl';\nimport { SidePaneElementProps } from '../SidePaneElement';\n\nconst initialState: BuildInPluginState = {\n    pluginList: {\n        contentEdit: true,\n        hyperlink: true,\n        paste: true,\n        watermark: false,\n        imageEdit: true,\n        cutPasteListChain: true,\n        tableCellSelection: true,\n        customReplace: true,\n        listEditMenu: true,\n        imageEditMenu: true,\n        tableEditMenu: true,\n        contextMenu: true,\n        autoFormat: true,\n        announce: true,\n    },\n    contentEditFeatures: getDefaultContentEditFeatureSettings(),\n    defaultFormat: {},\n    linkTitle: 'Ctrl+Click to follow the link:' + UrlPlaceholder,\n    watermarkText: 'Type content here ...',\n    forcePreserveRatio: false,\n    experimentalFeatures: [],\n    isRtl: false,\n    tableFeaturesContainerSelector: '#' + 'EditorContainer',\n};\n\nexport default class EditorOptionsPlugin extends SidePanePluginImpl<\n    OptionsPane,\n    BuildInPluginProps\n> {\n    constructor() {\n        super(OptionsPane, 'options', 'Editor Options');\n    }\n\n    getBuildInPluginState(): BuildInPluginState {\n        let result: BuildInPluginState;\n        this.getComponent(component => (result = component.getState()));\n        return result || initialState;\n    }\n\n    getComponentProps(base: SidePaneElementProps) {\n        return {\n            ...initialState,\n            ...base,\n        };\n    }\n}\n","import * as React from 'react';\nimport BuildInPluginState from '../../BuildInPluginState';\nimport { ExperimentalFeatures } from 'roosterjs-editor-types';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\n\nexport interface ExperimentalFeaturesProps {\n    state: ExperimentalFeatures[];\n    resetState: (callback: (state: BuildInPluginState) => void, resetEditor: boolean) => void;\n}\n\nconst FeatureNames: Partial<Record<ExperimentalFeatures, string>> = {\n    [ExperimentalFeatures.TabKeyTextFeatures]: 'Additional functionality to Tab Key',\n    [ExperimentalFeatures.ReuseAllAncestorListElements]:\n        \"Reuse ancestor list elements even if they don't match the types from the list item.\",\n    [ExperimentalFeatures.DeleteTableWithBackspace]:\n        'Delete a table selected with the table selector pressing Backspace key',\n    [ExperimentalFeatures.DisableListChain]: 'Disable list chain functionality',\n};\n\nexport default class ExperimentalFeaturesPane extends React.Component<\n    ExperimentalFeaturesProps,\n    {}\n> {\n    render() {\n        return <>{getObjectKeys(FeatureNames).map(name => this.renderFeature(name))}</>;\n    }\n\n    private renderFeature(name: keyof typeof FeatureNames): JSX.Element {\n        let checked = this.props.state.indexOf(name) >= 0;\n        return (\n            <div key={name}>\n                <input\n                    type=\"checkbox\"\n                    checked={checked}\n                    id={name}\n                    onChange={() => this.onClick(name)}\n                />\n                <label htmlFor={name}>{FeatureNames[name]}</label>\n            </div>\n        );\n    }\n\n    private onClick = (name: keyof typeof FeatureNames) => {\n        this.props.resetState(state => {\n            let checkbox = document.getElementById(name) as HTMLInputElement;\n            let index = state.experimentalFeatures.indexOf(name);\n\n            if (checkbox.checked && index < 0) {\n                state.experimentalFeatures.push(name);\n            } else if (!checkbox.checked && index >= 0) {\n                state.experimentalFeatures.splice(index, 1);\n            }\n        }, true);\n    };\n}\n","import * as React from 'react';\nimport BuildInPluginState, { BuildInPluginProps } from '../../BuildInPluginState';\nimport Code from './Code';\nimport ContentEditFeatures from './ContentEditFeatures';\nimport DefaultFormatPane from './DefaultFormat';\nimport EditorCode from './codes/EditorCode';\nimport ExperimentalFeaturesPane from './ExperimentalFeatures';\nimport MainPaneBase from '../../MainPaneBase';\nimport Plugins from './Plugins';\nimport ReactEditorCode from './codes/ReactEditorCode';\n\nconst htmlStart =\n    '<html>\\n' +\n    '<body>\\n' +\n    '<div id=\"contentDiv\" style=\"width: 800px; height: 400px; border: solid 1px black; overflow: auto\"></div>\\n';\nconst htmlButtons =\n    '<button id=buttonB><b>B</b></button>\\n' +\n    '<button id=buttonI><i>I</i></button>\\n' +\n    '<button id=buttonU><u>U</u></button>\\n' +\n    '<button id=buttonBullet>Bullet</button>\\n' +\n    '<button id=buttonNumbering>Numbering</button>\\n' +\n    '<button id=buttonUndo>Undo</button>\\n' +\n    '<button id=buttonRedo>Redo</button>\\n';\nconst darkButton = '<button id=buttonDark>Dark Mode</button>\\n';\nconst htmlEnd =\n    '<script src=\"https://microsoft.github.io/roosterjs/rooster-min.js\"></script>\\n' +\n    '</body>\\n' +\n    '</html>';\n\nconst htmlRoosterReact =\n    '<html>\\n' +\n    '<body>\\n' +\n    '<div id=\"root\"></div>\\n' +\n    '<script src=\"https://unpkg.com/react@16/umd/react.development.js\"></script>\\n' +\n    '<script src=\"https://unpkg.com/react-dom@16/umd/react-dom.development.js\"></script>\\n' +\n    '<script src=\"https://cdnjs.cloudflare.com/ajax/libs/fluentui-react/8.60.1/fluentui-react.min.js\"></script>\\n' +\n    '<script src=\"https://microsoft.github.io/roosterjs/rooster-min.js\"></script>\\n' +\n    '<script src=\"https://microsoft.github.io/roosterjs/rooster-react-min.js\"></script>\\n' +\n    '</body>\\n' +\n    '</html>';\n\nconst cssRoosterReact = '.editor { border: solid 1px black; width: 100%; height: 600px}';\nexport default class OptionsPane extends React.Component<BuildInPluginProps, BuildInPluginState> {\n    private exportForm = React.createRef<HTMLFormElement>();\n    private exportData = React.createRef<HTMLInputElement>();\n    private rtl = React.createRef<HTMLInputElement>();\n\n    constructor(props: BuildInPluginProps) {\n        super(props);\n        this.state = { ...props };\n    }\n    render() {\n        return (\n            <div>\n                <div>\n                    <button onClick={this.onExportRooster}>Try roosterjs in CodePen</button>\n                </div>\n                <div>\n                    <button onClick={this.onExportRoosterReact}>\n                        Try roosterjs-react in CodePen\n                    </button>\n                </div>\n                <div>\n                    <br />\n                </div>\n                <details>\n                    <summary>\n                        <b>Plugins:</b>\n                    </summary>\n                    <Plugins state={this.state} resetState={this.resetState} />\n                </details>\n                <details>\n                    <summary>\n                        <b>Content edit features:</b>\n                    </summary>\n                    <ContentEditFeatures\n                        state={this.state.contentEditFeatures}\n                        resetState={this.resetState}\n                    />\n                </details>\n                <details>\n                    <summary>\n                        <b>Default Format:</b>\n                    </summary>\n                    <DefaultFormatPane\n                        state={this.state.defaultFormat}\n                        resetState={this.resetState}\n                    />\n                </details>\n                <details>\n                    <summary>\n                        <b>Experimental features:</b>\n                    </summary>\n                    <ExperimentalFeaturesPane\n                        state={this.state.experimentalFeatures}\n                        resetState={this.resetState}\n                    />\n                </details>\n                <div>\n                    <br />\n                </div>\n                <div>\n                    <input\n                        id=\"pageRtl\"\n                        type=\"checkbox\"\n                        checked={this.state.isRtl}\n                        onChange={this.onToggleDirection}\n                        ref={this.rtl}\n                    />\n                    <label htmlFor=\"pageRtl\">Show controls from right to left</label>\n                </div>\n                <hr />\n                <details>\n                    <summary>\n                        <b>HTML Code:</b>\n                    </summary>\n                    <div>\n                        <code>\n                            <pre>{this.getHtml()}</pre>\n                        </code>\n                    </div>\n                </details>\n                <details>\n                    <summary>\n                        <b>Typescript Code:</b>\n                    </summary>\n                    <Code state={this.state} />\n                </details>\n                <form\n                    ref={this.exportForm}\n                    method=\"POST\"\n                    action=\"https://codepen.io/pen/define\"\n                    target=\"_blank\">\n                    <input name=\"data\" type=\"hidden\" ref={this.exportData} />\n                </form>\n            </div>\n        );\n    }\n\n    getState(): BuildInPluginState {\n        return { ...this.state };\n    }\n\n    private resetState = (callback: (state: BuildInPluginState) => void, resetEditor: boolean) => {\n        let state: BuildInPluginState = {\n            linkTitle: this.state.linkTitle,\n            watermarkText: this.state.watermarkText,\n            pluginList: { ...this.state.pluginList },\n            contentEditFeatures: { ...this.state.contentEditFeatures },\n            defaultFormat: { ...this.state.defaultFormat },\n            experimentalFeatures: this.state.experimentalFeatures,\n            forcePreserveRatio: this.state.forcePreserveRatio,\n            isRtl: this.state.isRtl,\n            tableFeaturesContainerSelector: this.state.tableFeaturesContainerSelector,\n        };\n\n        if (callback) {\n            callback(state);\n            this.setState(state);\n        }\n\n        if (resetEditor) {\n            MainPaneBase.getInstance().resetEditorPlugin(state);\n        }\n    };\n\n    private onExportRooster = () => {\n        let editor = new EditorCode(this.state);\n        let code = editor.getCode();\n        let json = {\n            title: 'RoosterJs',\n            html: this.getHtml(),\n            head: '',\n            js: code,\n            js_pre_processor: 'typescript',\n        };\n        this.exportData.current.value = JSON.stringify(json);\n        this.exportForm.current.submit();\n    };\n\n    private onExportRoosterReact = () => {\n        let editor = new ReactEditorCode(this.state);\n        let code = editor.getCode();\n        let json = {\n            title: 'RoosterJs React',\n            html: htmlRoosterReact,\n            css: cssRoosterReact,\n            head: '',\n            js: code,\n            js_pre_processor: 'typescript',\n        };\n        this.exportData.current.value = JSON.stringify(json);\n        this.exportForm.current.submit();\n    };\n\n    private onToggleDirection = () => {\n        let isRtl = this.rtl.current.checked;\n        this.setState({\n            isRtl: isRtl,\n        });\n        MainPaneBase.getInstance().setPageDirection(isRtl);\n    };\n\n    private getHtml() {\n        return `${htmlStart}${htmlButtons}${darkButton}${htmlEnd}`;\n    }\n}\n","import * as React from 'react';\nimport BuildInPluginState, { BuildInPluginList, UrlPlaceholder } from '../../BuildInPluginState';\n\ntype PluginItemId = keyof BuildInPluginList;\n\nconst styles = require('./OptionsPane.scss');\n\nexport interface PluginsProps {\n    state: BuildInPluginState;\n    resetState: (callback: (state: BuildInPluginState) => void, resetEditor: boolean) => void;\n}\n\nexport default class Plugins extends React.Component<PluginsProps, {}> {\n    private linkTitle = React.createRef<HTMLInputElement>();\n    private watermarkText = React.createRef<HTMLInputElement>();\n    private forcePreserveRatio = React.createRef<HTMLInputElement>();\n\n    render() {\n        return (\n            <table>\n                <tbody>\n                    {this.renderPluginItem('contentEdit', 'Content Edit')}\n                    {this.renderPluginItem(\n                        'hyperlink',\n                        'Hyperlink Plugin',\n                        this.renderInputBox(\n                            'Label title: ',\n                            this.linkTitle,\n                            this.props.state.linkTitle,\n                            'Use \"' + UrlPlaceholder + '\" for the url string',\n                            (state, value) => (state.linkTitle = value)\n                        )\n                    )}\n                    {this.renderPluginItem('paste', 'Paste Plugin')}\n                    {this.renderPluginItem(\n                        'watermark',\n                        'Watermark Plugin',\n                        this.renderInputBox(\n                            'Watermark text: ',\n                            this.watermarkText,\n                            this.props.state.watermarkText,\n                            '',\n                            (state, value) => (state.watermarkText = value)\n                        )\n                    )}\n                    {this.renderPluginItem(\n                        'imageEdit',\n                        'Image Edit Plugin',\n                        this.renderCheckBox(\n                            'Force preserve ratio',\n                            this.forcePreserveRatio,\n                            this.props.state.forcePreserveRatio,\n                            (state, value) => (state.forcePreserveRatio = value)\n                        )\n                    )}\n                    {this.renderPluginItem('cutPasteListChain', 'CutPasteListChainPlugin')}\n                    {this.renderPluginItem('customReplace', 'Custom Replace Plugin (autocomplete)')}\n                    {this.renderPluginItem(\n                        'contextMenu',\n                        'Show customized context menu for special cases'\n                    )}\n                    {this.renderPluginItem('tableCellSelection', 'Table Cell Selection')}\n                    {this.renderPluginItem('announce', 'Announce')}\n                </tbody>\n            </table>\n        );\n    }\n\n    private renderPluginItem(\n        id: PluginItemId,\n        text: string,\n        moreOptions?: JSX.Element\n    ): JSX.Element {\n        const checked = this.props.state.pluginList[id];\n\n        return (\n            <tr>\n                <td className={styles.checkboxColumn}>\n                    <input\n                        type=\"checkbox\"\n                        id={id}\n                        checked={checked}\n                        onChange={() => this.onPluginClick(id)}\n                    />\n                </td>\n                <td>\n                    <div>\n                        <label htmlFor={id}>{text}</label>\n                    </div>\n                    {checked && moreOptions}\n                </td>\n            </tr>\n        );\n    }\n\n    private renderInputBox(\n        label: string,\n        ref: React.RefObject<HTMLInputElement>,\n        value: string,\n        placeholder: string,\n        onChange: (state: BuildInPluginState, value: string) => void\n    ): JSX.Element {\n        return (\n            <div>\n                {label}\n                <input\n                    type=\"text\"\n                    ref={ref}\n                    value={value}\n                    placeholder={placeholder}\n                    onChange={() =>\n                        this.props.resetState(state => onChange(state, ref.current.value), false)\n                    }\n                    onBlur={() => this.props.resetState(null, true)}\n                />\n            </div>\n        );\n    }\n\n    private renderCheckBox(\n        label: string,\n        ref: React.RefObject<HTMLInputElement>,\n        value: boolean,\n        onChange: (state: BuildInPluginState, value: boolean) => void\n    ): JSX.Element {\n        return (\n            <div>\n                <input\n                    type=\"checkbox\"\n                    ref={ref}\n                    checked={value}\n                    onChange={() =>\n                        this.props.resetState(state => onChange(state, ref.current.checked), true)\n                    }\n                    onBlur={() => this.props.resetState(null, true)}\n                />\n                {label}\n            </div>\n        );\n    }\n\n    private onPluginClick = (id: PluginItemId) => {\n        this.props.resetState(state => {\n            let checkbox = document.getElementById(id) as HTMLInputElement;\n            state.pluginList[id] = checkbox.checked;\n        }, true);\n    };\n}\n","import CodeElement from './CodeElement';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\n\nconst codeMap: { [id: string]: string } = {\n    buttonB: 'roosterjs.toggleBold(editor)',\n    buttonI: 'roosterjs.toggleItalic(editor)',\n    buttonU: 'roosterjs.toggleUnderline(editor)',\n    buttonBullet: 'roosterjs.toggleBullet(editor)',\n    buttonNumbering: 'roosterjs.toggleNumbering(editor)',\n    buttonUndo: 'editor.undo()',\n    buttonRedo: 'editor.redo()',\n};\nconst buttonDark = 'editor.setDarkModeState(!editor.isDarkMode())';\n\nexport default class ButtonsCode extends CodeElement {\n    getCode() {\n        const map = { ...codeMap, buttonDark: buttonDark };\n        return getObjectKeys(map)\n            .map(\n                id =>\n                    `document.getElementById('${id}').addEventListener('click', () => ${map[id]});\\n`\n            )\n            .join('');\n    }\n}\n","export default abstract class CodeElement {\n    abstract getCode(): string;\n\n    protected encode(src: string): string {\n        return src.replace(/\\\\/g, '\\\\\\\\').replace(/'/g, \"\\\\'\");\n    }\n\n    protected indent(src: string): string {\n        return src\n            .split('\\n')\n            .map(line => (line == '' ? '' : '    ' + line + '\\n'))\n            .join('');\n    }\n}\n","import CodeElement from './CodeElement';\nimport ContentEditFeaturesCode from './ContentEditFeaturesCode';\nimport { ContentEditFeatureSettings } from 'roosterjs-editor-types';\n\nexport default class ContentEditCode extends CodeElement {\n    private features: ContentEditFeaturesCode;\n    constructor(settings: ContentEditFeatureSettings) {\n        super();\n        this.features = new ContentEditFeaturesCode(settings);\n    }\n\n    getCode() {\n        return 'new roosterjs.ContentEdit(' + this.features.getCode() + ')';\n    }\n}\n","import CodeElement from './CodeElement';\nimport getDefaultContentEditFeatureSettings from '../getDefaultContentEditFeatureSettings';\nimport { ContentEditFeatureSettings } from 'roosterjs-editor-types';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\n\nexport default class ContentEditFeaturesCode extends CodeElement {\n    constructor(private state: ContentEditFeatureSettings) {\n        super();\n    }\n\n    getCode() {\n        let defaultValues = getDefaultContentEditFeatureSettings();\n        let features = getObjectKeys(defaultValues)\n            .map(key => {\n                let checked = this.state[key];\n\n                return typeof checked != 'boolean' || checked == defaultValues[key]\n                    ? null\n                    : `${key}: ${checked ? 'true' : 'false'},\\n`;\n            })\n            .filter(line => !!line);\n        return features.length > 0 ? '{\\n' + this.indent(features.join('')) + '}' : '';\n    }\n}\n","import CodeElement from './CodeElement';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\n\nconst codeMap: { [id: string]: string } = {\n    buttonB: 'roosterjsContentModel.toggleBold(editor)',\n    buttonI: 'roosterjsContentModel.toggleItalic(editor)',\n    buttonU: 'roosterjsContentModel.toggleUnderline(editor)',\n    buttonBullet: 'roosterjsContentModel.toggleBullet(editor)',\n    buttonNumbering: 'roosterjsContentModel.toggleNumbering(editor)',\n    buttonUndo: 'editor.undo()',\n    buttonRedo: 'editor.redo()',\n};\nconst buttonDark = 'editor.setDarkModeState(!editor.isDarkMode())';\n\nexport default class ContentModelButtonsCode extends CodeElement {\n    getCode() {\n        const map = { ...codeMap, buttonDark: buttonDark };\n        return getObjectKeys(map)\n            .map(\n                id =>\n                    `document.getElementById('${id}').addEventListener('click', () => ${map[id]});\\n`\n            )\n            .join('');\n    }\n}\n","import BuildInPluginState from '../../../BuildInPluginState';\nimport CodeElement from './CodeElement';\nimport ContentModelButtonsCode from './ContentModelButtonsCode';\nimport DarkModeCode from './DarkModeCode';\nimport DefaultFormatCode from './DefaultFormatCode';\nimport ExperimentalFeaturesCode from './ExperimentalFeaturesCode';\nimport PluginsCode from './PluginsCode';\n\nexport default class ContentModelEditorCode extends CodeElement {\n    private plugins: PluginsCode;\n    private defaultFormat: DefaultFormatCode;\n    private buttons: ContentModelButtonsCode;\n    private experimentalFeatures: ExperimentalFeaturesCode;\n    private darkMode: DarkModeCode;\n\n    constructor(state: BuildInPluginState) {\n        super();\n\n        this.plugins = new PluginsCode(state);\n        this.defaultFormat = new DefaultFormatCode(state.defaultFormat);\n        this.buttons = new ContentModelButtonsCode();\n        this.experimentalFeatures = new ExperimentalFeaturesCode(state.experimentalFeatures);\n        this.darkMode = new DarkModeCode();\n    }\n\n    getCode() {\n        let defaultFormat = this.defaultFormat.getCode();\n        let expermientalFeatures = this.experimentalFeatures.getCode();\n        let darkMode = this.darkMode.getCode();\n        let code = \"let contentDiv = document.getElementById('contentDiv') as HTMLDivElement;\\n\";\n        code += `let plugins = ${this.plugins.getCode()};\\n`;\n        code += defaultFormat ? `let defaultFormat: DefaultFormat = ${defaultFormat};\\n` : '';\n        code += 'let options: roosterjs.EditorOptions = {\\n';\n        code += this.indent('plugins: plugins,\\n');\n        code += defaultFormat ? this.indent('defaultFormat: defaultFormat,\\n') : '';\n        code += expermientalFeatures\n            ? this.indent(`experimentalFeatures: [\\n${expermientalFeatures}],\\n`)\n            : '';\n        code += darkMode ? this.indent(`getDarkColor: ${darkMode},\\n`) : '';\n        code += '};\\n';\n        code += 'let editor = new roosterjsContentModel.StandaloneEditor(contentDiv, options);\\n';\n        code += this.buttons ? this.buttons.getCode() : '';\n\n        return code;\n    }\n}\n","import CodeElement from './CodeElement';\n\nexport default class DarkModeCode extends CodeElement {\n    getCode() {\n        return 'roosterjs.getDarkColor';\n    }\n}\n","import CodeElement from './CodeElement';\nimport { DefaultFormat } from 'roosterjs-editor-types';\n\nexport default class DefaultFormatCode extends CodeElement {\n    constructor(private defaultFormat: DefaultFormat) {\n        super();\n    }\n\n    getCode() {\n        let {\n            bold,\n            italic,\n            underline,\n            fontFamily,\n            fontSize,\n            textColor,\n            backgroundColor,\n        } = this.defaultFormat;\n        let lines = [\n            bold ? 'bold: true,\\n' : null,\n            italic ? 'italic: true,\\n' : null,\n            underline ? 'underline: true,\\n' : null,\n            fontFamily ? `fontFamily: '${this.encode(fontFamily)}',\\n` : null,\n            fontSize ? `fontSize: '${this.encode(fontSize)}',\\n` : null,\n            textColor ? `textColor: '${this.encode(textColor)}',\\n` : null,\n            backgroundColor ? `backgroundColor: '${this.encode(backgroundColor)}',\\n` : null,\n        ].filter(line => !!line);\n\n        return lines.length > 0 ? '{\\n' + this.indent(lines.join('')) + '}' : '';\n    }\n}\n","import BuildInPluginState from '../../../BuildInPluginState';\nimport ButtonsCode from './ButtonsCode';\nimport CodeElement from './CodeElement';\nimport DarkModeCode from './DarkModeCode';\nimport DefaultFormatCode from './DefaultFormatCode';\nimport ExperimentalFeaturesCode from './ExperimentalFeaturesCode';\nimport PluginsCode from './PluginsCode';\n\nexport default class EditorCode extends CodeElement {\n    private plugins: PluginsCode;\n    private defaultFormat: DefaultFormatCode;\n    private buttons: ButtonsCode;\n    private experimentalFeatures: ExperimentalFeaturesCode;\n    private darkMode: DarkModeCode;\n\n    constructor(state: BuildInPluginState) {\n        super();\n\n        this.plugins = new PluginsCode(state);\n        this.defaultFormat = new DefaultFormatCode(state.defaultFormat);\n        this.buttons = new ButtonsCode();\n        this.experimentalFeatures = new ExperimentalFeaturesCode(state.experimentalFeatures);\n        this.darkMode = new DarkModeCode();\n    }\n\n    getCode() {\n        let defaultFormat = this.defaultFormat.getCode();\n        let expermientalFeatures = this.experimentalFeatures.getCode();\n        let darkMode = this.darkMode.getCode();\n        let code = \"let contentDiv = document.getElementById('contentDiv') as HTMLDivElement;\\n\";\n        code += `let plugins = ${this.plugins.getCode()};\\n`;\n        code += defaultFormat ? `let defaultFormat: DefaultFormat = ${defaultFormat};\\n` : '';\n        code += 'let options: roosterjs.EditorOptions = {\\n';\n        code += this.indent('plugins: plugins,\\n');\n        code += defaultFormat ? this.indent('defaultFormat: defaultFormat,\\n') : '';\n        code += expermientalFeatures\n            ? this.indent(`experimentalFeatures: [\\n${expermientalFeatures}],\\n`)\n            : '';\n        code += darkMode ? this.indent(`getDarkColor: ${darkMode},\\n`) : '';\n        code += '};\\n';\n        code += 'let editor = new roosterjs.Editor(contentDiv, options);\\n';\n        code += this.buttons ? this.buttons.getCode() : '';\n\n        return code;\n    }\n}\n","import CodeElement from './CodeElement';\nimport { ExperimentalFeatures } from 'roosterjs-editor-types';\n\nexport default class ExperimentalFeaturesCode extends CodeElement {\n    constructor(private experimentalFeatures: ExperimentalFeatures[]) {\n        super();\n    }\n\n    getCode() {\n        return (this.experimentalFeatures || [])\n            .map(name => this.indent(\"'\" + name + \"',\"))\n            .join('\\n');\n    }\n}\n","import CodeElement from './CodeElement';\nimport { UrlPlaceholder } from '../../../BuildInPluginState';\n\nexport default class HyperLinkCode extends CodeElement {\n    constructor(private linkTitle: string) {\n        super();\n    }\n\n    getCode() {\n        return 'new roosterjs.HyperLink(' + this.getLinkCallback() + ')';\n    }\n\n    private getLinkCallback() {\n        if (!this.linkTitle) {\n            return '';\n        }\n\n        let index = this.linkTitle.indexOf(UrlPlaceholder);\n        if (index >= 0) {\n            let left = this.linkTitle.substr(0, index);\n            let right = this.linkTitle.substr(index + UrlPlaceholder.length);\n            return (\n                'url => ' +\n                (left ? `'${this.encode(left)}' + ` : '') +\n                'url' +\n                (right ? ` + '${this.encode(right)}'` : '')\n            );\n        } else {\n            return `() => '${this.linkTitle}'`;\n        }\n    }\n}\n","import BuildInPluginState from '../../../BuildInPluginState';\nimport CodeElement from './CodeElement';\nimport ContentEditCode from './ContentEditCode';\nimport HyperLinkCode from './HyperLinkCode';\nimport TableCellSelectionCode from './TableCellSelectionCode';\nimport WatermarkCode from './WatermarkCode';\nimport {\n    CustomReplaceCode,\n    CutPasteListChainCode,\n    ImageEditCode,\n    ContentModelPasteCode,\n} from './SimplePluginCode';\n\nexport default class PluginsCode extends CodeElement {\n    private plugins: CodeElement[];\n\n    constructor(private state: BuildInPluginState, private additionalPlugins?: string[]) {\n        super();\n\n        let pluginList = state.pluginList;\n        this.plugins = [\n            pluginList.contentEdit && new ContentEditCode(state.contentEditFeatures),\n            pluginList.hyperlink && new HyperLinkCode(state.linkTitle),\n            new ContentModelPasteCode(),\n            pluginList.watermark && new WatermarkCode(this.state.watermarkText),\n            pluginList.imageEdit && new ImageEditCode(),\n            pluginList.cutPasteListChain && new CutPasteListChainCode(),\n            pluginList.customReplace && new CustomReplaceCode(),\n            pluginList.tableCellSelection && new TableCellSelectionCode(),\n        ].filter(plugin => !!plugin);\n    }\n\n    getCode() {\n        let code = '[\\n';\n        code += this.indent(this.plugins.map(plugin => plugin.getCode() + ',\\n').join(''));\n\n        if (this.additionalPlugins) {\n            code += this.indent(this.additionalPlugins.map(p => p + ',\\n').join(''));\n        }\n        code += ']';\n        return code;\n    }\n}\n","import BuildInPluginState from '../../../BuildInPluginState';\nimport CodeElement from './CodeElement';\nimport DarkModeCode from './DarkModeCode';\nimport DefaultFormatCode from './DefaultFormatCode';\nimport ExperimentalFeaturesCode from './ExperimentalFeaturesCode';\nimport PluginsCode from './PluginsCode';\nimport RibbonButtonCode from './RibbonButtonCode';\nimport RibbonCode from './RibbonCode';\n\nconst RibbonPluginVarName = 'ribbonPlugin';\n\nexport default class ReactEditorCode extends CodeElement {\n    private plugins: PluginsCode;\n    private defaultFormat: DefaultFormatCode;\n    private ribbon: RibbonCode;\n    private ribbonButton: RibbonButtonCode;\n    private experimentalFeatures: ExperimentalFeaturesCode;\n    private darkMode: DarkModeCode;\n    private isRtl: boolean;\n\n    constructor(state: BuildInPluginState) {\n        super();\n\n        this.ribbonButton = new RibbonButtonCode();\n        this.ribbon = new RibbonCode(state, this.ribbonButton);\n        this.plugins = new PluginsCode(state, this.ribbon ? [RibbonPluginVarName] : undefined);\n        this.defaultFormat = new DefaultFormatCode(state.defaultFormat);\n        this.experimentalFeatures = new ExperimentalFeaturesCode(state.experimentalFeatures);\n        this.darkMode = new DarkModeCode();\n        this.isRtl = state.isRtl;\n    }\n\n    getCode() {\n        let defaultFormat = this.defaultFormat.getCode();\n        let expermientalFeatures = this.experimentalFeatures.getCode();\n        let darkMode = this.darkMode.getCode();\n        let code = \"let root = document.getElementById('root');\\n\";\n\n        if (this.ribbonButton) {\n            code += `let ${RibbonPluginVarName} = roosterjsReact.createRibbonPlugin();\\n`;\n        }\n\n        code += `let plugins = ${this.plugins.getCode()};\\n`;\n        code += defaultFormat ? `let defaultFormat: DefaultFormat = ${defaultFormat};\\n` : '';\n        code += 'let options: roosterjs.EditorOptions = {\\n';\n        code += this.indent('plugins: plugins,\\n');\n        code += defaultFormat ? this.indent('defaultFormat: defaultFormat,\\n') : '';\n        code += expermientalFeatures\n            ? this.indent(`experimentalFeatures: [\\n${expermientalFeatures}],\\n`)\n            : '';\n        code += darkMode ? this.indent(`getDarkColor: ${darkMode},\\n`) : '';\n        code += '};\\n';\n\n        code += `let editor = <roosterjsReact.Rooster className=\"editor\" {...options} ${\n            this.isRtl ? 'dir=\"rtl\" ' : ''\n        }/>;\\n`;\n        let componentCode: string;\n\n        if (this.ribbon && this.ribbonButton) {\n            code += this.ribbonButton.getCode();\n            code += 'let ribbon = ' + this.ribbon.getCode();\n            componentCode = '<>{ribbon}{editor}</>';\n        } else {\n            componentCode = 'editor';\n        }\n\n        code += 'ReactDOM.render(' + componentCode + ', root);\\n';\n\n        return code;\n    }\n}\n","import CodeElement from './CodeElement';\n\nconst ButtonVarName = 'buttons';\n\nexport default class RibbonButtonCode extends CodeElement {\n    private supportDarkMode: boolean;\n\n    getCode() {\n        let code = `let ${ButtonVarName} = roosterjsReact.getButtons();\\n`;\n\n        if (this.supportDarkMode) {\n            code += `${ButtonVarName}.push({\\n`;\n            code += this.indent('key: \"buttonNameDarkMode\",\\n');\n            code += this.indent('unlocalizedText: \"Dark Mode\",\\n');\n            code += this.indent('iconName: \"ClearNight\",\\n');\n            code += this.indent('isChecked: formatState => formatState.isDarkMode,\\n');\n            code += this.indent('onClick: editor => {\\n');\n            code += this.indent('    editor.setDarkModeState(!editor.isDarkMode());\\n');\n            code += this.indent('    editor.focus();\\n');\n            code += this.indent('},\\n');\n            code += '});\\n';\n        }\n\n        return code;\n    }\n\n    getButtonVarName() {\n        return ButtonVarName;\n    }\n}\n","import BuildInPluginState from '../../../BuildInPluginState';\nimport CodeElement from './CodeElement';\nimport RibbonButtonCode from './RibbonButtonCode';\n\nexport default class RibbonCode extends CodeElement {\n    private buttonsVarName: string;\n    private isRtl: boolean;\n\n    constructor(state: BuildInPluginState, ribbonButton: RibbonButtonCode) {\n        super();\n        this.buttonsVarName = ribbonButton.getButtonVarName();\n        this.isRtl = state.isRtl;\n    }\n\n    getCode() {\n        return `<roosterjsReact.Ribbon buttons={${this.buttonsVarName}} plugin={ribbonPlugin} ${\n            this.isRtl ? 'dir=\"rtl\" ' : ''\n        }/>;\\n`;\n    }\n}\n","import CodeElement from './CodeElement';\n\nclass SimplePluginCode extends CodeElement {\n    constructor(private name: string, private namespace: string = 'roosterjs') {\n        super();\n    }\n\n    getCode() {\n        return `new ${this.namespace}.${this.name}()`;\n    }\n}\n\nexport class PasteCode extends SimplePluginCode {\n    constructor() {\n        super('Paste');\n    }\n}\n\nexport class ContentModelPasteCode extends SimplePluginCode {\n    constructor() {\n        super('PastePlugin', 'roosterjsContentModel');\n    }\n}\n\nexport class ImageEditCode extends SimplePluginCode {\n    constructor() {\n        super('ImageEdit');\n    }\n}\n\nexport class CutPasteListChainCode extends SimplePluginCode {\n    constructor() {\n        super('CutPasteListChain');\n    }\n}\n\nexport class TableResizeCode extends SimplePluginCode {\n    constructor() {\n        super('TableResize');\n    }\n}\n\nexport class CustomReplaceCode extends SimplePluginCode {\n    constructor() {\n        super('CustomReplace');\n    }\n}\n","import CodeElement from './CodeElement';\n\nexport default class TableCellSelectionCode extends CodeElement {\n    constructor() {\n        super();\n    }\n\n    getCode() {\n        return 'new roosterjs.TableCellSelection()';\n    }\n}\n","import CodeElement from './CodeElement';\n\nexport default class WatermarkCode extends CodeElement {\n    constructor(private watermarkText: string) {\n        super();\n    }\n\n    getCode() {\n        return `new roosterjs.Watermark('${this.encode(this.watermarkText)}')`;\n    }\n}\n","import { ContentEditFeatureSettings } from 'roosterjs-editor-types';\nimport { getAllFeatures } from 'roosterjs-editor-plugins/lib/ContentEdit';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\n\nexport default function getDefaultContentEditFeatureSettings(): ContentEditFeatureSettings {\n    const allFeatures = getAllFeatures();\n\n    return {\n        ...getObjectKeys(allFeatures).reduce((settings, key) => {\n            settings[key] = !allFeatures[key].defaultDisabled;\n            return settings;\n        }, <ContentEditFeatureSettings>{}),\n    };\n}\n","import * as React from 'react';\nimport { EntityOperation, PluginEvent, PluginEventType } from 'roosterjs-editor-types';\nimport { SidePaneElementProps } from '../SidePaneElement';\nimport {\n    getObjectKeys,\n    getTagOfNode,\n    HtmlSanitizer,\n    readFile,\n    safeInstanceOf,\n} from 'roosterjs-editor-dom';\n\nconst styles = require('./EventViewPane.scss');\n\nexport interface EventEntry {\n    index: number;\n    time: Date;\n    event: PluginEvent;\n}\n\nexport interface EventViewPaneState {\n    displayCount: number;\n    currentIndex: number;\n}\n\nconst EventTypeMap: { [key in PluginEventType]: string } = {\n    [PluginEventType.BeforeDispose]: 'BeforeDispose',\n    [PluginEventType.BeforePaste]: 'BeforePaste',\n    [PluginEventType.CompositionEnd]: 'CompositionEnd',\n    [PluginEventType.ContentChanged]: 'ContentChanged',\n    [PluginEventType.EditorReady]: 'EditorReady',\n    [PluginEventType.EntityOperation]: 'EntityOperation',\n    [PluginEventType.ExtractContentWithDom]: 'ExtractContentWithDom',\n    [PluginEventType.KeyDown]: 'KeyDown',\n    [PluginEventType.KeyPress]: 'KeyPress',\n    [PluginEventType.KeyUp]: 'KeyUp',\n    [PluginEventType.MouseDown]: 'MouseDown',\n    [PluginEventType.MouseUp]: 'MouseUp',\n    [PluginEventType.Input]: 'Input',\n    [PluginEventType.PendingFormatStateChanged]: 'PendingFormatStateChanged',\n    [PluginEventType.Scroll]: 'Scroll',\n    [PluginEventType.BeforeCutCopy]: 'BeforeCutCopy',\n    [PluginEventType.ContextMenu]: 'ContextMenu',\n    [PluginEventType.EnteredShadowEdit]: 'EnteredShadowEdit',\n    [PluginEventType.LeavingShadowEdit]: 'LeavingShadowEdit',\n    [PluginEventType.EditImage]: 'EditImage',\n    [PluginEventType.BeforeSetContent]: 'BeforeSetContent',\n    [PluginEventType.ZoomChanged]: 'ZoomChanged',\n    [PluginEventType.SelectionChanged]: 'SelectionChanged',\n    [PluginEventType.BeforeKeyboardEditing]: 'BeforeKeyboardEditing',\n};\n\nconst EntityOperationMap: { [key in EntityOperation]: string } = {\n    [EntityOperation.AddShadowRoot]: 'AddShadowRoot',\n    [EntityOperation.RemoveShadowRoot]: 'RemoveShadowRoot',\n    [EntityOperation.Click]: 'Click',\n    [EntityOperation.ContextMenu]: 'ContextMenu',\n    [EntityOperation.Escape]: 'Escape',\n    [EntityOperation.NewEntity]: 'NewEntity',\n    [EntityOperation.Overwrite]: 'Overwrite',\n    [EntityOperation.PartialOverwrite]: 'PartialOverwrite',\n    [EntityOperation.RemoveFromEnd]: 'RemoveFromEnd',\n    [EntityOperation.RemoveFromStart]: 'RemoveFromStart',\n    [EntityOperation.ReplaceTemporaryContent]: 'ReplaceTemporaryContent',\n    [EntityOperation.UpdateEntityState]: 'UpdateEntityState',\n};\n\nexport default class ContentModelEventViewPane extends React.Component<\n    SidePaneElementProps,\n    EventViewPaneState\n> {\n    private events: EventEntry[] = [];\n    private displayCount = React.createRef<HTMLSelectElement>();\n    private lastIndex = 0;\n\n    constructor(props: SidePaneElementProps) {\n        super(props);\n        this.state = {\n            displayCount: 20,\n            currentIndex: -1,\n        };\n    }\n\n    render() {\n        let displayCount = Math.min(this.events.length, this.state.displayCount);\n        let displayedEvents =\n            displayCount > 0 ? this.events.slice(this.events.length - displayCount) : [];\n        displayedEvents = displayedEvents.reverse();\n\n        return (\n            <>\n                <div>\n                    Show item count:\n                    <select\n                        defaultValue={this.state.displayCount.toString()}\n                        ref={this.displayCount}\n                        onChange={this.onDisplayCountChanged}>\n                        <option value={'0'}>Disabled</option>\n                        <option value={'20'}>20</option>\n                        <option value={'50'}>50</option>\n                        <option value={'100'}>100</option>\n                    </select>{' '}\n                    <button onClick={this.clear}>Clear all</button>\n                </div>\n                <div>\n                    {displayedEvents.map(event => (\n                        <details key={event.index.toString()}>\n                            <summary>\n                                {`${event.time.getHours()}:${event.time.getMinutes()}:${event.time.getSeconds()}.${event.time.getMilliseconds()} `}\n                                {EventTypeMap[event.event.eventType]}\n                            </summary>\n                            <div className={styles.eventContent}>\n                                {this.renderEvent(event.event)}\n                            </div>\n                        </details>\n                    ))}\n                </div>\n            </>\n        );\n    }\n\n    addEvent(event: PluginEvent) {\n        if (this.state.displayCount > 0) {\n            if (event.eventType == PluginEventType.BeforePaste) {\n                const sanitizer = new HtmlSanitizer(event.sanitizingOption);\n                const fragment = event.fragment.cloneNode(true /*deep*/) as DocumentFragment;\n\n                sanitizer.convertGlobalCssToInlineCss(fragment);\n                sanitizer.sanitize(fragment);\n                (event.clipboardData as any).html = this.getHtml(fragment);\n            }\n\n            this.events.push({\n                time: new Date(),\n                event: event,\n                index: this.lastIndex++,\n            });\n\n            while (this.events.length > 100) {\n                this.events.shift();\n            }\n            this.setState({\n                currentIndex: this.lastIndex,\n            });\n        }\n    }\n\n    private renderEvent(event: PluginEvent): JSX.Element {\n        switch (event.eventType) {\n            case PluginEventType.KeyDown:\n            case PluginEventType.KeyPress:\n            case PluginEventType.KeyUp:\n                return (\n                    <span>\n                        Key=\n                        {event.rawEvent.which}\n                    </span>\n                );\n\n            case PluginEventType.MouseDown:\n            case PluginEventType.MouseUp:\n            case PluginEventType.ContextMenu:\n                return (\n                    <span>\n                        Button=\n                        {event.rawEvent.button}, SrcElement=\n                        {event.rawEvent.target && getTagOfNode(event.rawEvent.target as Node)},\n                        PageX=\n                        {event.rawEvent.pageX}, PageY=\n                        {event.rawEvent.pageY}\n                    </span>\n                );\n\n            case PluginEventType.ContentChanged:\n                return (\n                    <span>\n                        Source=\n                        {event.source}, Data=\n                        {event.data && event.data.toString && event.data.toString()}\n                    </span>\n                );\n\n            case PluginEventType.BeforePaste:\n                return (\n                    <span>\n                        Types=\n                        {event.clipboardData.types.join()}\n                        {this.renderPasteContent('Plain text', event.clipboardData.text)}\n                        {this.renderPasteContent(\n                            'Sanitized HTML',\n                            (event.clipboardData as any).html\n                        )}\n                        {this.renderPasteContent('Original HTML', event.clipboardData.rawHtml)}\n                        {this.renderPasteContent('Image', event.clipboardData.image, img => (\n                            <img\n                                ref={ref => ref && this.renderImage(ref, img)}\n                                className={styles.img}\n                            />\n                        ))}\n                        {this.renderPasteContent(\n                            'LinkPreview',\n                            event.clipboardData.linkPreview\n                                ? JSON.stringify(event.clipboardData.linkPreview)\n                                : ''\n                        )}\n                        Paste from keyboard or native context menu:\n                        {event.clipboardData.pasteNativeEvent ? ' true' : ' false'}\n                        {getObjectKeys(event.clipboardData.customValues).map(contentType =>\n                            this.renderPasteContent(\n                                contentType,\n                                event.clipboardData.customValues[contentType]\n                            )\n                        )}\n                    </span>\n                );\n            case PluginEventType.PendingFormatStateChanged:\n                const formatState = event.formatState;\n                const keys = getObjectKeys(formatState);\n                return <span>{keys.map(key => `${key}=${event.formatState[key]}; `)}</span>;\n\n            case PluginEventType.EntityOperation:\n                const {\n                    operation,\n                    entity: { id, type },\n                } = event;\n                return (\n                    <span>\n                        Operation={EntityOperationMap[operation]} Type={type}; Id={id}\n                    </span>\n                );\n\n            case PluginEventType.BeforeCutCopy:\n                const { isCut } = event;\n                return <span>isCut={isCut ? 'true' : 'false'}</span>;\n\n            case PluginEventType.EditImage:\n                return (\n                    <>\n                        <span>new src={event.newSrc.substr(0, 100)}</span>\n                    </>\n                );\n\n            case PluginEventType.ZoomChanged:\n                return (\n                    <span>\n                        Old value={event.oldZoomScale} New value={event.newZoomScale}\n                    </span>\n                );\n\n            case PluginEventType.BeforeKeyboardEditing:\n                return <span>Key code={event.rawEvent.which}</span>;\n\n            case PluginEventType.Input:\n                return <span>Input type={event.rawEvent.inputType}</span>;\n\n            default:\n                return null;\n        }\n    }\n\n    private clear = () => {\n        this.events = [];\n        this.setState({\n            currentIndex: -1,\n        });\n    };\n\n    private renderImage = (img: HTMLImageElement, imageFile: File) => {\n        readFile(imageFile, dataUrl => (img.src = dataUrl));\n    };\n\n    private onDisplayCountChanged = () => {\n        let value = parseInt(this.displayCount.current.value);\n        this.setState({\n            displayCount: value,\n        });\n    };\n\n    private renderPasteContent(\n        title: string,\n        content: any,\n        renderer: (content: any) => JSX.Element = content => <span>{content}</span>\n    ): JSX.Element {\n        return (\n            content && (\n                <details>\n                    <summary>{title}</summary>\n                    <div className={styles.pasteContent}>{renderer(content)}</div>\n                </details>\n            )\n        );\n    }\n\n    private getHtml(fragment: DocumentFragment) {\n        const stringArray: string[] = [];\n        for (let child = fragment.firstChild; child; child = child.nextSibling) {\n            stringArray.push(\n                safeInstanceOf(child, 'HTMLElement')\n                    ? child.outerHTML\n                    : safeInstanceOf(child, 'Text')\n                    ? child.nodeValue\n                    : ''\n            );\n        }\n\n        return stringArray.join('');\n    }\n}\n","import ContentModelEventViewPane from './ContentModelEventViewPane';\nimport SidePanePluginImpl from '../SidePanePluginImpl';\nimport { PluginEvent } from 'roosterjs-editor-types';\nimport { SidePaneElementProps } from '../SidePaneElement';\n\nexport default class ContentModelEventViewPlugin extends SidePanePluginImpl<\n    ContentModelEventViewPane,\n    SidePaneElementProps\n> {\n    constructor() {\n        super(ContentModelEventViewPane, 'event', 'Event Viewer');\n    }\n\n    onPluginEvent(e: PluginEvent) {\n        this.getComponent(component => component.addEvent(e));\n    }\n\n    getComponentProps(base: SidePaneElementProps) {\n        return base;\n    }\n}\n","import * as React from 'react';\nimport { EntityOperation, PluginEvent, PluginEventType } from 'roosterjs-editor-types';\nimport { SidePaneElementProps } from '../SidePaneElement';\nimport {\n    getObjectKeys,\n    getTagOfNode,\n    HtmlSanitizer,\n    readFile,\n    safeInstanceOf,\n} from 'roosterjs-editor-dom';\n\nconst styles = require('./EventViewPane.scss');\n\nexport interface EventEntry {\n    index: number;\n    time: Date;\n    event: PluginEvent;\n}\n\nexport interface EventViewPaneState {\n    displayCount: number;\n    currentIndex: number;\n}\n\nconst EventTypeMap: { [key in PluginEventType]: string } = {\n    [PluginEventType.BeforeDispose]: 'BeforeDispose',\n    [PluginEventType.BeforePaste]: 'BeforePaste',\n    [PluginEventType.CompositionEnd]: 'CompositionEnd',\n    [PluginEventType.ContentChanged]: 'ContentChanged',\n    [PluginEventType.EditorReady]: 'EditorReady',\n    [PluginEventType.EntityOperation]: 'EntityOperation',\n    [PluginEventType.ExtractContentWithDom]: 'ExtractContentWithDom',\n    [PluginEventType.KeyDown]: 'KeyDown',\n    [PluginEventType.KeyPress]: 'KeyPress',\n    [PluginEventType.KeyUp]: 'KeyUp',\n    [PluginEventType.MouseDown]: 'MouseDown',\n    [PluginEventType.MouseUp]: 'MouseUp',\n    [PluginEventType.Input]: 'Input',\n    [PluginEventType.PendingFormatStateChanged]: 'PendingFormatStateChanged',\n    [PluginEventType.Scroll]: 'Scroll',\n    [PluginEventType.BeforeCutCopy]: 'BeforeCutCopy',\n    [PluginEventType.ContextMenu]: 'ContextMenu',\n    [PluginEventType.EnteredShadowEdit]: 'EnteredShadowEdit',\n    [PluginEventType.LeavingShadowEdit]: 'LeavingShadowEdit',\n    [PluginEventType.EditImage]: 'EditImage',\n    [PluginEventType.BeforeSetContent]: 'BeforeSetContent',\n    [PluginEventType.ZoomChanged]: 'ZoomChanged',\n    [PluginEventType.SelectionChanged]: 'SelectionChanged',\n    [PluginEventType.BeforeKeyboardEditing]: 'BeforeKeyboardEditing',\n};\n\nconst EntityOperationMap: { [key in EntityOperation]: string } = {\n    [EntityOperation.AddShadowRoot]: 'AddShadowRoot',\n    [EntityOperation.RemoveShadowRoot]: 'RemoveShadowRoot',\n    [EntityOperation.Click]: 'Click',\n    [EntityOperation.ContextMenu]: 'ContextMenu',\n    [EntityOperation.Escape]: 'Escape',\n    [EntityOperation.NewEntity]: 'NewEntity',\n    [EntityOperation.Overwrite]: 'Overwrite',\n    [EntityOperation.PartialOverwrite]: 'PartialOverwrite',\n    [EntityOperation.RemoveFromEnd]: 'RemoveFromEnd',\n    [EntityOperation.RemoveFromStart]: 'RemoveFromStart',\n    [EntityOperation.ReplaceTemporaryContent]: 'ReplaceTemporaryContent',\n    [EntityOperation.UpdateEntityState]: 'UpdateEntityState',\n};\n\nexport default class EventViewPane extends React.Component<\n    SidePaneElementProps,\n    EventViewPaneState\n> {\n    private events: EventEntry[] = [];\n    private displayCount = React.createRef<HTMLSelectElement>();\n    private lastIndex = 0;\n\n    constructor(props: SidePaneElementProps) {\n        super(props);\n        this.state = {\n            displayCount: 20,\n            currentIndex: -1,\n        };\n    }\n\n    render() {\n        let displayCount = Math.min(this.events.length, this.state.displayCount);\n        let displayedEvents =\n            displayCount > 0 ? this.events.slice(this.events.length - displayCount) : [];\n        displayedEvents = displayedEvents.reverse();\n\n        return (\n            <>\n                <div>\n                    Show item count:\n                    <select\n                        defaultValue={this.state.displayCount.toString()}\n                        ref={this.displayCount}\n                        onChange={this.onDisplayCountChanged}>\n                        <option value={'0'}>Disabled</option>\n                        <option value={'20'}>20</option>\n                        <option value={'50'}>50</option>\n                        <option value={'100'}>100</option>\n                    </select>{' '}\n                    <button onClick={this.clear}>Clear all</button>\n                </div>\n                <div>\n                    {displayedEvents.map(event => (\n                        <details key={event.index.toString()}>\n                            <summary>\n                                {`${event.time.getHours()}:${event.time.getMinutes()}:${event.time.getSeconds()}.${event.time.getMilliseconds()} `}\n                                {EventTypeMap[event.event.eventType]}\n                            </summary>\n                            <div className={styles.eventContent}>\n                                {this.renderEvent(event.event)}\n                            </div>\n                        </details>\n                    ))}\n                </div>\n            </>\n        );\n    }\n\n    addEvent(event: PluginEvent) {\n        if (this.state.displayCount > 0) {\n            if (event.eventType == PluginEventType.BeforePaste) {\n                const sanitizer = new HtmlSanitizer(event.sanitizingOption);\n                const fragment = event.fragment.cloneNode(true /*deep*/) as DocumentFragment;\n\n                sanitizer.convertGlobalCssToInlineCss(fragment);\n                sanitizer.sanitize(fragment);\n                (event.clipboardData as any).html = this.getHtml(fragment);\n            }\n\n            this.events.push({\n                time: new Date(),\n                event: event,\n                index: this.lastIndex++,\n            });\n\n            while (this.events.length > 100) {\n                this.events.shift();\n            }\n            this.setState({\n                currentIndex: this.lastIndex,\n            });\n        }\n    }\n\n    private renderEvent(event: PluginEvent): JSX.Element {\n        switch (event.eventType) {\n            case PluginEventType.KeyDown:\n            case PluginEventType.KeyPress:\n            case PluginEventType.KeyUp:\n                return (\n                    <span>\n                        Key=\n                        {event.rawEvent.which}\n                    </span>\n                );\n\n            case PluginEventType.MouseDown:\n            case PluginEventType.MouseUp:\n            case PluginEventType.ContextMenu:\n                return (\n                    <span>\n                        Button=\n                        {event.rawEvent.button}, SrcElement=\n                        {event.rawEvent.target && getTagOfNode(event.rawEvent.target as Node)},\n                        PageX=\n                        {event.rawEvent.pageX}, PageY=\n                        {event.rawEvent.pageY}\n                    </span>\n                );\n\n            case PluginEventType.ContentChanged:\n                return (\n                    <span>\n                        Source=\n                        {event.source}, Data=\n                        {event.data && event.data.toString && event.data.toString()}\n                    </span>\n                );\n\n            case PluginEventType.BeforePaste:\n                return (\n                    <span>\n                        Types=\n                        {event.clipboardData.types.join()}\n                        {this.renderPasteContent('Plain text', event.clipboardData.text)}\n                        {this.renderPasteContent(\n                            'Sanitized HTML',\n                            (event.clipboardData as any).html\n                        )}\n                        {this.renderPasteContent('Original HTML', event.clipboardData.rawHtml)}\n                        {this.renderPasteContent('Image', event.clipboardData.image, img => (\n                            <img\n                                ref={ref => ref && this.renderImage(ref, img)}\n                                className={styles.img}\n                            />\n                        ))}\n                        {this.renderPasteContent(\n                            'LinkPreview',\n                            event.clipboardData.linkPreview\n                                ? JSON.stringify(event.clipboardData.linkPreview)\n                                : ''\n                        )}\n                        Paste from keyboard or native context menu:\n                        {event.clipboardData.pasteNativeEvent ? ' true' : ' false'}\n                        {getObjectKeys(event.clipboardData.customValues).map(contentType =>\n                            this.renderPasteContent(\n                                contentType,\n                                event.clipboardData.customValues[contentType]\n                            )\n                        )}\n                    </span>\n                );\n            case PluginEventType.PendingFormatStateChanged:\n                const formatState = event.formatState;\n                const keys = getObjectKeys(formatState);\n                return <span>{keys.map(key => `${key}=${event.formatState[key]}; `)}</span>;\n\n            case PluginEventType.EntityOperation:\n                const {\n                    operation,\n                    entity: { id, type },\n                } = event;\n                return (\n                    <span>\n                        Operation={EntityOperationMap[operation]} Type={type}; Id={id}\n                    </span>\n                );\n\n            case PluginEventType.BeforeCutCopy:\n                const { isCut } = event;\n                return <span>isCut={isCut ? 'true' : 'false'}</span>;\n\n            case PluginEventType.EditImage:\n                return (\n                    <>\n                        <span>new src={event.newSrc.substr(0, 100)}</span>\n                    </>\n                );\n\n            case PluginEventType.ZoomChanged:\n                return (\n                    <span>\n                        Old value={event.oldZoomScale} New value={event.newZoomScale}\n                    </span>\n                );\n\n            case PluginEventType.BeforeKeyboardEditing:\n                return <span>Key code={event.rawEvent.which}</span>;\n\n            default:\n                return null;\n        }\n    }\n\n    private clear = () => {\n        this.events = [];\n        this.setState({\n            currentIndex: -1,\n        });\n    };\n\n    private renderImage = (img: HTMLImageElement, imageFile: File) => {\n        readFile(imageFile, dataUrl => (img.src = dataUrl));\n    };\n\n    private onDisplayCountChanged = () => {\n        let value = parseInt(this.displayCount.current.value);\n        this.setState({\n            displayCount: value,\n        });\n    };\n\n    private renderPasteContent(\n        title: string,\n        content: any,\n        renderer: (content: any) => JSX.Element = content => <span>{content}</span>\n    ): JSX.Element {\n        return (\n            content && (\n                <details>\n                    <summary>{title}</summary>\n                    <div className={styles.pasteContent}>{renderer(content)}</div>\n                </details>\n            )\n        );\n    }\n\n    private getHtml(fragment: DocumentFragment) {\n        const stringArray: string[] = [];\n        for (let child = fragment.firstChild; child; child = child.nextSibling) {\n            stringArray.push(\n                safeInstanceOf(child, 'HTMLElement')\n                    ? child.outerHTML\n                    : safeInstanceOf(child, 'Text')\n                    ? child.nodeValue\n                    : ''\n            );\n        }\n\n        return stringArray.join('');\n    }\n}\n","import EventViewPane from './EventViewPane';\nimport SidePanePluginImpl from '../SidePanePluginImpl';\nimport { PluginEvent } from 'roosterjs-editor-types';\nimport { SidePaneElementProps } from '../SidePaneElement';\n\nexport default class EventViewPlugin extends SidePanePluginImpl<\n    EventViewPane,\n    SidePaneElementProps\n> {\n    constructor() {\n        super(EventViewPane, 'event', 'Event Viewer');\n    }\n\n    onPluginEvent(e: PluginEvent) {\n        this.getComponent(component => component.addEvent(e));\n    }\n\n    getComponentProps(base: SidePaneElementProps) {\n        return base;\n    }\n}\n","import FormatStatePlugin from './FormatStatePlugin';\nimport { FormatState, IEditor as ILegacyEditor } from 'roosterjs-editor-types';\nimport { getFormatState } from 'roosterjs-content-model-api';\nimport { getPositionRect } from 'roosterjs-editor-dom';\nimport { IEditor } from 'roosterjs-content-model-types';\n\nexport default class ContentModelFormatStatePlugin extends FormatStatePlugin {\n    protected getFormatState() {\n        if (!this.editor) {\n            return null;\n        }\n\n        const format = (getFormatState(\n            this.editor as IEditor & ILegacyEditor\n        ) as any) as FormatState;\n        const position = this.editor && this.editor.getFocusedPosition();\n        const rect = position && getPositionRect(position);\n        return {\n            format,\n            inIME: this.editor && this.editor.isInIME(),\n            x: rect ? rect.left : 0,\n            y: rect ? rect.top : 0,\n        };\n    }\n}\n","import * as React from 'react';\nimport { Browser } from 'roosterjs-editor-dom';\nimport { FormatState } from 'roosterjs-editor-types';\nimport { SidePaneElementProps } from '../SidePaneElement';\n\nconst styles = require('./FormatStatePane.scss');\n\nexport interface FormatStatePaneState {\n    format: FormatState;\n    inIME: boolean;\n    x: number;\n    y: number;\n}\nexport interface FormatStatePaneProps extends FormatStatePaneState, SidePaneElementProps {}\n\nexport default class FormatStatePane extends React.Component<\n    FormatStatePaneProps,\n    FormatStatePaneState\n> {\n    constructor(props: FormatStatePaneProps) {\n        super(props);\n        this.state = {\n            format: props.format,\n            inIME: props.inIME,\n            x: props.x,\n            y: props.y,\n        };\n    }\n\n    setFormatState(state: FormatStatePaneState) {\n        this.setState(state);\n    }\n\n    render() {\n        let { format, x, y } = this.state;\n        return format ? (\n            <table>\n                <tbody>\n                    <tr>\n                        <td className={styles.title}>Position</td>\n                        <td>{`${x},${y}`}</td>\n                    </tr>\n                    <tr>\n                        <td className={styles.title}>Font</td>\n                        <td>\n                            <span>{`${format.fontName}, ${format.fontSize}`}</span>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td className={styles.title}>Colors</td>\n                        <td>\n                            <span\n                                style={{\n                                    color: format.textColor,\n                                    backgroundColor: format.backgroundColor,\n                                }}>{`${format.textColor} / ${format.backgroundColor}`}</span>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td className={styles.title}>IME</td>\n                        <td>{this.renderSpan(this.state.inIME, 'InIME')}</td>\n                    </tr>\n                    <tr>\n                        <td className={styles.title}>Formats</td>\n                        <td>\n                            {this.renderSpan(format.isBold, 'Bold')}\n                            {this.renderSpan(format.isItalic, 'Italic')}\n                            {this.renderSpan(format.isUnderline, 'Underline')}\n                            {this.renderSpan(format.isStrikeThrough, 'Strike')}\n                            {this.renderSpan(format.isSubscript, 'Subscript')}\n                            {this.renderSpan(format.isSuperscript, 'Superscript')}\n                            {`Font-weight: ${format.fontWeight}`}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td className={styles.title}>Structure</td>\n                        <td>\n                            {this.renderSpan(format.isBullet, 'Bullet')}\n                            {this.renderSpan(format.isNumbering, 'Numbering')}\n                            {this.renderSpan(format.isBlockQuote, 'Quote')}\n                            {this.renderSpan(format.canUnlink, 'In Link')}\n                            {this.renderSpan(format.canAddImageAltText, 'In Image')}\n                            {this.renderSpan(format.isInTable, 'In Table')}\n                            {this.renderSpan(format.tableHasHeader, 'Table Has Header')}\n                            <span\n                                className={\n                                    format.headingLevel == 0 && styles.inactive\n                                }>{`Heading ${format.headingLevel}`}</span>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td className={styles.title}>Undo</td>\n                        <td>\n                            {this.renderSpan(format.canUndo, 'Can Undo')}\n                            {this.renderSpan(format.canRedo, 'Can Redo')}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td className={styles.title}>Browser</td>\n                        <td>\n                            {this.renderSpan(Browser.isChrome, 'Chrome')}\n                            {this.renderSpan(Browser.isFirefox, 'Firefox')}\n                            {this.renderSpan(Browser.isSafari, 'Safari')}\n                            {this.renderSpan(Browser.isWebKit, 'Webkit')}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td className={styles.title}>OS</td>\n                        <td>\n                            {this.renderSpan(Browser.isMac, 'MacOS')}\n                            {this.renderSpan(Browser.isWin, 'Windows')}\n                            {this.renderSpan(Browser.isAndroid, 'Android')}\n                            {this.renderSpan(Browser.isMobileOrTablet, 'Mobile/Tablet')}\n                        </td>\n                    </tr>\n                    <tr>\n                        <td className={styles.title}>User Agent</td>\n                        <td>{window.navigator.userAgent}</td>\n                    </tr>\n                    <tr>\n                        <td className={styles.title}>App Version</td>\n                        <td>{window.navigator.appVersion}</td>\n                    </tr>\n                </tbody>\n            </table>\n        ) : (\n            <div>Please focus into editor</div>\n        );\n    }\n\n    private renderSpan(formatState: boolean, text: string): JSX.Element {\n        return <span className={formatState ? '' : styles.inactive}>{text + ' '}</span>;\n    }\n}\n","import FormatStatePane, { FormatStatePaneProps } from './FormatStatePane';\nimport SidePanePluginImpl from '../SidePanePluginImpl';\nimport { getFormatState } from 'roosterjs-editor-api';\nimport { getPositionRect } from 'roosterjs-editor-dom';\nimport { IEditor, PluginEvent, PluginEventType } from 'roosterjs-editor-types';\nimport { SidePaneElementProps } from '../SidePaneElement';\n\nexport default class FormatStatePlugin extends SidePanePluginImpl<\n    FormatStatePane,\n    FormatStatePaneProps\n> {\n    constructor() {\n        super(FormatStatePane, 'format', 'Format State');\n    }\n\n    initialize(editor: IEditor) {\n        super.initialize(editor);\n        this.editor.runAsync(editor => {\n            editor.focus();\n\n            this.updateFormatState();\n        });\n    }\n\n    getComponentProps(base: SidePaneElementProps) {\n        return {\n            ...base,\n            ...this.getFormatState(),\n        };\n    }\n\n    onPluginEvent(event: PluginEvent) {\n        if (\n            event.eventType == PluginEventType.KeyUp ||\n            event.eventType == PluginEventType.MouseUp ||\n            event.eventType == PluginEventType.ContentChanged\n        ) {\n            this.updateFormatState();\n        }\n    }\n\n    updateFormatState() {\n        this.getComponent(component => component.setFormatState(this.getFormatState()));\n    }\n\n    protected getFormatState() {\n        if (!this.editor) {\n            return null;\n        }\n\n        const format = getFormatState(this.editor);\n        const position = this.editor && this.editor.getFocusedPosition();\n        const rect = position && getPositionRect(position);\n        return {\n            format,\n            inIME: this.editor && this.editor.isInIME(),\n            x: rect ? rect.left : 0,\n            y: rect ? rect.top : 0,\n        };\n    }\n}\n","import * as React from 'react';\nimport { EntityState, Snapshot, SnapshotSelection } from 'roosterjs-content-model-types';\n\nconst styles = require('./SnapshotPane.scss');\n\nexport interface ContentModelSnapshotPaneProps {\n    onTakeSnapshot: () => Snapshot;\n    onRestoreSnapshot: (snapshot: Snapshot, triggerContentChangedEvent: boolean) => void;\n    onMove: (moveStep: number) => void;\n}\n\nexport interface ContentModelSnapshotPaneState {\n    snapshots: Snapshot[];\n    currentIndex: number;\n    autoCompleteIndex: number;\n}\n\nexport default class ContentModelSnapshotPane extends React.Component<\n    ContentModelSnapshotPaneProps,\n    ContentModelSnapshotPaneState\n> {\n    private html = React.createRef<HTMLTextAreaElement>();\n    private entityStates = React.createRef<HTMLTextAreaElement>();\n    private isDarkColor = React.createRef<HTMLInputElement>();\n    private selection = React.createRef<HTMLTextAreaElement>();\n\n    constructor(props: ContentModelSnapshotPaneProps) {\n        super(props);\n\n        this.state = {\n            snapshots: [],\n            currentIndex: -1,\n            autoCompleteIndex: -1,\n        };\n    }\n\n    render() {\n        return (\n            <div className={styles.snapshotPane} onPaste={this.onPaste}>\n                <h3>Undo Snapshots</h3>\n                <div className={styles.snapshotList}>\n                    {this.state.snapshots.map(this.renderItem)}\n                </div>\n                <h3>Selected Snapshot</h3>\n                <div className={styles.buttons}>\n                    <button onClick={this.takeSnapshot}>{'Take snapshot'}</button>{' '}\n                    <button onClick={this.onClickRestoreSnapshot}>{'Restore snapshot'}</button>\n                    <button onClick={this.onCopy}>{'Copy snapshot with metadata'}</button>\n                </div>\n                <div>HTML:</div>\n                <textarea ref={this.html} className={styles.textarea} spellCheck={false} />\n                <div>Selection:</div>\n                <textarea ref={this.selection} className={styles.textarea} spellCheck={false} />\n                <div>Entity states:</div>\n                <textarea ref={this.entityStates} className={styles.textarea} spellCheck={false} />\n                <div>\n                    <input type=\"checkbox\" ref={this.isDarkColor} id=\"isUndoInDarkColor\" />\n                    <label htmlFor=\"isUndoInDarkColor\">Is in dark mode</label>\n                </div>\n            </div>\n        );\n    }\n\n    private getCurrentSnapshot(): Snapshot {\n        const html = this.html.current.value;\n        const selection = this.selection.current.value\n            ? (JSON.parse(this.selection.current.value) as SnapshotSelection)\n            : undefined;\n        const entityStates = this.entityStates.current.value\n            ? (JSON.parse(this.entityStates.current.value) as EntityState[])\n            : undefined;\n        const isDarkMode = !!this.isDarkColor.current.checked;\n\n        return {\n            html,\n            entityStates,\n            isDarkMode,\n            selection,\n        };\n    }\n\n    private onClickRestoreSnapshot = () => {\n        const snapshot = this.getCurrentSnapshot();\n\n        this.props.onRestoreSnapshot(snapshot, true);\n    };\n\n    private onCopy = () => {\n        const snapshot = this.getCurrentSnapshot();\n        const metadata = {\n            ...snapshot.selection,\n            isDarkMode: snapshot.isDarkMode,\n        };\n        const textToCopy = snapshot.html + `<!--${JSON.stringify(metadata)}-->`;\n\n        navigator.clipboard.writeText(textToCopy);\n    };\n\n    private onPaste = (event: React.ClipboardEvent) => {\n        const str = event.clipboardData.getData('text/plain');\n\n        if (str) {\n            const idx = str.lastIndexOf('<!--');\n\n            if (idx >= 0 && str.endsWith('-->')) {\n                const html = str.substring(0, idx);\n                const json = str.substring(idx + 4, str.length - 3);\n\n                try {\n                    const metadata = JSON.parse(json);\n                    const isDarkMode = !!metadata.isDarkMode;\n\n                    delete metadata.isDarkMode;\n\n                    this.setSnapshot({\n                        html: html,\n                        entityStates: [],\n                        isDarkMode: isDarkMode,\n                        selection: metadata as SnapshotSelection,\n                    });\n\n                    event.preventDefault();\n                } catch {}\n            }\n        }\n    };\n\n    updateSnapshots(snapshots: Snapshot[], currentIndex: number, autoCompleteIndex: number) {\n        this.setState({\n            snapshots,\n            currentIndex,\n            autoCompleteIndex,\n        });\n    }\n\n    snapshotToString(snapshot: Snapshot) {\n        return (\n            snapshot.html +\n            (snapshot.selection ? `<!--${JSON.stringify(snapshot.selection)}-->` : '')\n        );\n    }\n\n    private takeSnapshot = () => {\n        const snapshot = this.props.onTakeSnapshot();\n        this.setSnapshot(snapshot);\n    };\n\n    private setSnapshot = (snapshot: Snapshot) => {\n        this.html.current.value = snapshot.html;\n        this.entityStates.current.value = snapshot.entityStates\n            ? JSON.stringify(snapshot.entityStates)\n            : '';\n        this.selection.current.value = snapshot.selection ? JSON.stringify(snapshot.selection) : '';\n        this.isDarkColor.current.checked = !!snapshot.isDarkMode;\n    };\n\n    private renderItem = (snapshot: Snapshot, index: number) => {\n        let className = '';\n        if (index == this.state.currentIndex) {\n            className += ' ' + styles.current;\n        }\n        if (index == this.state.autoCompleteIndex) {\n            className += ' ' + styles.autoComplete;\n        }\n\n        const snapshotStr = this.snapshotToString(snapshot);\n        return (\n            <pre\n                className={className}\n                key={index}\n                onClick={() => this.setSnapshot(snapshot)}\n                onDoubleClick={() => this.props.onMove(index - this.state.currentIndex)}>\n                {(snapshotStr || '<EMPTY SNAPSHOT>').substring(0, 1000)}\n            </pre>\n        );\n    };\n}\n","import * as React from 'react';\nimport ContentModelSnapshotPane from './ContentModelSnapshotPane';\nimport SidePanePlugin from '../../SidePanePlugin';\nimport { IEditor as ILegacyEDitor, PluginEvent, PluginEventType } from 'roosterjs-editor-types';\nimport { IEditor, Snapshot, Snapshots } from 'roosterjs-content-model-types';\n\nexport default class ContentModelSnapshotPlugin implements SidePanePlugin {\n    private editorInstance: ILegacyEDitor & IEditor;\n    private component: ContentModelSnapshotPane;\n\n    constructor(private snapshots: Snapshots) {\n        this.snapshots.onChanged = () => this.updateSnapshots();\n    }\n\n    getName() {\n        return 'Snapshot';\n    }\n\n    initialize(editor: ILegacyEDitor) {\n        this.editorInstance = editor as ILegacyEDitor & IEditor;\n    }\n\n    dispose() {\n        this.editorInstance = null;\n    }\n\n    onPluginEvent(e: PluginEvent) {\n        if (e.eventType == PluginEventType.EditorReady) {\n            this.updateSnapshots();\n        }\n    }\n\n    getTitle() {\n        return 'Undo Snapshots';\n    }\n\n    renderSidePane() {\n        return <ContentModelSnapshotPane {...this.getComponentProps()} ref={this.refCallback} />;\n    }\n\n    getSnapshots() {\n        return this.snapshots;\n    }\n\n    private refCallback = (ref: ContentModelSnapshotPane) => {\n        this.component = ref;\n        if (ref) {\n            this.updateSnapshots();\n        }\n    };\n\n    private getComponentProps() {\n        return {\n            onRestoreSnapshot: this.onRestoreSnapshot,\n            onTakeSnapshot: this.onTakeSnapshot,\n            onMove: this.onMove,\n        };\n    }\n\n    private onTakeSnapshot = (): Snapshot => {\n        return this.editorInstance.takeSnapshot();\n    };\n\n    private onMove = (step: number) => {\n        const snapshotsManager = this.editorInstance.getSnapshotsManager();\n        const snapshot = snapshotsManager.move(step);\n        this.onRestoreSnapshot(snapshot);\n    };\n\n    private onRestoreSnapshot = (snapshot: Snapshot) => {\n        this.editorInstance.focus();\n        this.editorInstance.restoreSnapshot(snapshot);\n    };\n\n    private updateSnapshots = () => {\n        if (!this.component) {\n            return;\n        }\n\n        this.component.updateSnapshots(\n            this.snapshots.snapshots,\n            this.snapshots.currentIndex,\n            this.snapshots.autoCompleteIndex\n        );\n    };\n}\n","import * as React from 'react';\nimport { Snapshot } from 'roosterjs-editor-types';\n\nconst styles = require('./SnapshotPane.scss');\n\nexport interface SnapshotPaneProps {\n    onTakeSnapshot: () => Snapshot;\n    onRestoreSnapshot: (snapshot: Snapshot, triggerContentChangedEvent: boolean) => void;\n    onMove: (moveStep: number) => void;\n}\n\nexport interface SnapshotPaneState {\n    snapshots: Snapshot[];\n    currentIndex: number;\n    autoCompleteIndex: number;\n}\n\nexport default class SnapshotPane extends React.Component<SnapshotPaneProps, SnapshotPaneState> {\n    private textarea: HTMLTextAreaElement;\n\n    constructor(props: SnapshotPaneProps) {\n        super(props);\n\n        this.state = {\n            snapshots: [],\n            currentIndex: -1,\n            autoCompleteIndex: -1,\n        };\n    }\n\n    render() {\n        return (\n            <div className={styles.snapshotPane}>\n                <h3>Undo Snapshots</h3>\n                <div className={styles.snapshotList}>\n                    {this.state.snapshots.map(this.renderItem)}\n                </div>\n                <h3>Selected Snapshot</h3>\n                <div className={styles.buttons}>\n                    <button onClick={this.takeSnapshot}>{'Take snapshot'}</button>{' '}\n                    <button\n                        onClick={() =>\n                            this.props.onRestoreSnapshot(\n                                {\n                                    html: this.textarea.value,\n                                    metadata: null,\n                                    knownColors: [],\n                                },\n                                true\n                            )\n                        }>\n                        {'Restore snapshot'}\n                    </button>\n                </div>\n                <textarea\n                    ref={ref => (this.textarea = ref)}\n                    className={styles.textarea}\n                    spellCheck={false}\n                />\n            </div>\n        );\n    }\n\n    updateSnapshots(snapshots: Snapshot[], currentIndex: number, autoCompleteIndex: number) {\n        this.setState({\n            snapshots,\n            currentIndex,\n            autoCompleteIndex,\n        });\n    }\n\n    snapshotToString(snapshot: Snapshot) {\n        return (\n            snapshot.html + (snapshot.metadata ? `<!--${JSON.stringify(snapshot.metadata)}-->` : '')\n        );\n    }\n\n    private takeSnapshot = () => {\n        const snapshot = this.props.onTakeSnapshot();\n        this.setSnapshot(this.snapshotToString(snapshot));\n    };\n\n    private setSnapshot = (snapshot: string) => {\n        this.textarea.value = snapshot;\n    };\n\n    private renderItem = (snapshot: Snapshot, index: number) => {\n        let className = '';\n        if (index == this.state.currentIndex) {\n            className += ' ' + styles.current;\n        }\n        if (index == this.state.autoCompleteIndex) {\n            className += ' ' + styles.autoComplete;\n        }\n\n        const snapshotStr = this.snapshotToString(snapshot);\n        return (\n            <pre\n                className={className}\n                key={index}\n                onClick={() => this.setSnapshot(snapshotStr)}\n                onDoubleClick={() => this.props.onMove(index - this.state.currentIndex)}>\n                {(snapshotStr || '<EMPTY SNAPSHOT>').substring(0, 1000)}\n            </pre>\n        );\n    };\n}\n","import * as React from 'react';\nimport SidePanePlugin from '../../SidePanePlugin';\nimport SnapshotPane from './SnapshotPane';\nimport UndoSnapshots from './UndoSnapshots';\nimport { createSnapshots } from 'roosterjs-editor-dom';\nimport { IEditor, PluginEvent, PluginEventType } from 'roosterjs-editor-types';\nimport { Snapshot } from 'roosterjs-editor-types';\n\nexport default class SnapshotPlugin implements SidePanePlugin {\n    private editorInstance: IEditor;\n    private component: SnapshotPane;\n    private snapshotService: UndoSnapshots;\n    private static snapshots = createSnapshots<Snapshot>(1e7);\n\n    constructor() {\n        this.snapshotService = new UndoSnapshots(SnapshotPlugin.snapshots, this.updateSnapshots);\n    }\n\n    getName() {\n        return 'Snapshot';\n    }\n\n    initialize(editor: IEditor) {\n        this.editorInstance = editor;\n    }\n\n    dispose() {\n        this.editorInstance = null;\n    }\n\n    onPluginEvent(e: PluginEvent) {\n        if (e.eventType == PluginEventType.EditorReady) {\n            this.updateSnapshots();\n        }\n    }\n\n    getTitle() {\n        return 'Undo Snapshots';\n    }\n\n    renderSidePane() {\n        return <SnapshotPane {...this.getComponentProps()} ref={this.refCallback} />;\n    }\n\n    getSnapshotService() {\n        return this.snapshotService;\n    }\n\n    private refCallback = (ref: SnapshotPane) => {\n        this.component = ref;\n        if (ref) {\n            this.updateSnapshots();\n        }\n    };\n\n    private getComponentProps() {\n        return {\n            onRestoreSnapshot: this.onRestoreSnapshot,\n            onTakeSnapshot: this.onTakeSnapshot,\n            onMove: this.onMove,\n        };\n    }\n\n    private onTakeSnapshot = (): Snapshot => {\n        let newSnapshot: Snapshot;\n\n        try {\n            this.snapshotService.startHijackUndoSnapshot(snapshot => {\n                newSnapshot = snapshot;\n            });\n            this.editorInstance.addUndoSnapshot();\n        } finally {\n            this.snapshotService.stopHijackUndoSnapshot();\n        }\n\n        return newSnapshot;\n    };\n\n    private onMove = (step: number) => {\n        const snapshot = this.snapshotService.move(step);\n        this.onRestoreSnapshot(snapshot, false);\n    };\n\n    private onRestoreSnapshot = (snapshot: Snapshot, triggerContentChangedEvent: boolean) => {\n        this.editorInstance.focus();\n        this.editorInstance.setContent(\n            this.component.snapshotToString(snapshot),\n            triggerContentChangedEvent\n        );\n    };\n\n    private updateSnapshots = () => {\n        if (!this.component) {\n            return;\n        }\n\n        this.component.updateSnapshots(\n            this.snapshotService.getSnapshots(),\n            this.snapshotService.getCurrentIndex(),\n            this.snapshotService.getAutoCompleteIndex()\n        );\n    };\n}\n","import { Snapshot, Snapshots, UndoSnapshotsService } from 'roosterjs-editor-types';\nimport {\n    addSnapshotV2,\n    canMoveCurrentSnapshot,\n    moveCurrentSnapshot,\n    clearProceedingSnapshotsV2,\n    canUndoAutoComplete,\n} from 'roosterjs-editor-dom';\n\nexport default class UndoSnapshots implements UndoSnapshotsService<Snapshot> {\n    private hijackUndoSnapshotCallback: undefined | ((snapshot: Snapshot) => void);\n\n    constructor(private snapshots: Snapshots<Snapshot>, private onChange: () => void) {}\n\n    public isUndoSnapshotServiceV2(): true {\n        return true;\n    }\n\n    public startHijackUndoSnapshot(callback: (snapshot: Snapshot) => void) {\n        this.hijackUndoSnapshotCallback = callback;\n    }\n\n    public stopHijackUndoSnapshot() {\n        this.hijackUndoSnapshotCallback = undefined;\n    }\n\n    public canMove(delta: number): boolean {\n        return canMoveCurrentSnapshot(this.snapshots, delta);\n    }\n\n    public move(delta: number): Snapshot {\n        const result = moveCurrentSnapshot(this.snapshots, delta);\n        this.onChange();\n        return result;\n    }\n\n    public addSnapshot(snapshot: Snapshot, isAutoCompleteSnapshot: boolean) {\n        if (this.hijackUndoSnapshotCallback) {\n            this.hijackUndoSnapshotCallback(snapshot);\n        } else {\n            addSnapshotV2(this.snapshots, snapshot, isAutoCompleteSnapshot);\n            this.onChange();\n        }\n    }\n\n    public clearRedo() {\n        clearProceedingSnapshotsV2(this.snapshots);\n        this.onChange();\n    }\n\n    public getSnapshots() {\n        return this.snapshots.snapshots;\n    }\n\n    public getCurrentIndex() {\n        return this.snapshots.currentIndex;\n    }\n\n    public getAutoCompleteIndex() {\n        return this.snapshots.autoCompleteIndex;\n    }\n\n    public canUndoAutoComplete() {\n        return canUndoAutoComplete(this.snapshots);\n    }\n}\n","import * as React from 'react';\n\nconst classicalStyles = require('./TitleBar.scss');\nconst contentModelStyles = require('./ContentModelTitleBar.scss');\nconst standaloneStyles = require('./StandaloneTitleBar.scss');\n\nconst github = require('./iconmonstr-github-1.svg');\n\nexport interface TitleBarProps {\n    className?: string;\n    mode: 'classical' | 'contentModel' | 'standalone';\n}\n\nexport default class TitleBar extends React.Component<TitleBarProps, {}> {\n    render() {\n        const { mode, className: baseClassName } = this.props;\n        const styles =\n            mode == 'contentModel'\n                ? contentModelStyles\n                : mode == 'standalone'\n                ? standaloneStyles\n                : classicalStyles;\n        const className = styles.titleBar + ' ' + (baseClassName || '');\n        const titleText =\n            mode == 'contentModel'\n                ? 'RoosterJs Content Model Demo Site'\n                : mode == 'classical'\n                ? 'RoosterJs Demo Site'\n                : 'RoosterJs Standalone Demo Site';\n        const switchLink =\n            mode == 'contentModel' ? (\n                <a className={styles.link} href=\"?cm=0\">\n                    Switch to classical demo\n                </a>\n            ) : (\n                <a className={styles.link} href=\"?cm=1\">\n                    Switch to Content Model demo\n                </a>\n            );\n\n        return (\n            <div className={className}>\n                <div className={styles.title}>\n                    <span className={styles.titleText}>{titleText}</span>\n                </div>\n                <div className={styles.version}></div>\n                <div className={styles.links}>\n                    {switchLink} {' | '}\n                    <a\n                        href=\"https://github.com/Microsoft/roosterjs/wiki\"\n                        target=\"_blank\"\n                        className={styles.link}>\n                        Wiki\n                    </a>\n                    {' | '}\n                    <a href=\"docs/index.html\" target=\"_blank\" className={styles.link}>\n                        References\n                    </a>\n                    {' | '}\n                    <a href=\"coverage/index.html\" target=\"_blank\" className={styles.link}>\n                        Test\n                    </a>\n                    {' | '}\n                    <a\n                        href=\"https://github.com/microsoft/roosterjs/actions/workflows/build-and-deploy.yml\"\n                        target=\"_blank\">\n                        <img\n                            className={styles.externalLink}\n                            src=\"https://github.com/microsoft/roosterjs/actions/workflows/build-and-deploy.yml/badge.svg\"\n                            alt=\"Build Status\"\n                        />\n                    </a>{' '}\n                    <a href=\"http://badge.fury.io/js/roosterjs\" target=\"_blank\">\n                        <img\n                            src=\"https://badge.fury.io/js/roosterjs.svg\"\n                            alt=\"NPM Version\"\n                            className={styles.externalLink}\n                        />\n                    </a>{' '}\n                    <a\n                        href=\"https://github.com/microsoft/roosterjs\"\n                        target=\"_blank\"\n                        className={styles.link}\n                        title=\"RoosterJs on Github\">\n                        <img className={styles.externalLink} src={github} />\n                    </a>\n                </div>\n            </div>\n        );\n    }\n}\n","import { Stylesheet } from '@fluentui/merge-styles/lib/Stylesheet';\n\nlet isCssMonitorStarted: boolean = false;\nconst activeWindows: Window[] = [];\n\nfunction startCssMonitor() {\n    if (!isCssMonitorStarted) {\n        isCssMonitorStarted = true;\n        Stylesheet.getInstance().setConfig({\n            onInsertRule: (cssText: string) => {\n                activeWindows.forEach(win => {\n                    const style = win.document.createElement('style');\n                    style.textContent = cssText;\n                    win.document.head.appendChild(style);\n                });\n            },\n        });\n    }\n}\n\nexport function registerWindowForCss(win: Window) {\n    startCssMonitor();\n\n    activeWindows.push(win);\n\n    const styles = document.getElementsByTagName('STYLE');\n    const fragment = win.document.createDocumentFragment();\n\n    for (let i = 0; i < styles.length; i++) {\n        const style = win.document.createElement('style');\n        fragment.appendChild(style);\n\n        const originalStyle = styles[i] as HTMLStyleElement;\n        const rules = originalStyle.sheet.cssRules;\n        let cssText = '';\n\n        for (let j = 0; j < rules.length; j++) {\n            const rule = rules[j] as CSSStyleRule;\n            cssText += rule.cssText;\n        }\n\n        style.textContent = cssText;\n    }\n\n    win.document.head.appendChild(fragment);\n}\n\nexport function unregisterWindowForCss(win: Window) {\n    const index = activeWindows.indexOf(win);\n\n    if (index >= 0) {\n        activeWindows.splice(index, 1);\n    }\n}\n","import * as DOMPurify from 'dompurify';\n\nexport function trustedHTMLHandler(html: string): string {\n    const result = DOMPurify.sanitize(html, {\n        ADD_TAGS: ['head', 'meta', '#comment', 'iframe'],\n        ADD_ATTR: ['name', 'content'],\n        WHOLE_DOCUMENT: true,\n        RETURN_TRUSTED_TYPE: true,\n        ALLOW_UNKNOWN_PROTOCOLS: true,\n    });\n    return <string>(<any>result);\n}\n","export { default as insertTable } from './publicApi/table/insertTable';\nexport { default as formatTable } from './publicApi/table/formatTable';\nexport { default as setTableCellShade } from './publicApi/table/setTableCellShade';\nexport { default as editTable } from './publicApi/table/editTable';\nexport { default as applyTableBorderFormat } from './publicApi/table/applyTableBorderFormat';\nexport { default as toggleBullet } from './publicApi/list/toggleBullet';\nexport { default as toggleNumbering } from './publicApi/list/toggleNumbering';\nexport { default as toggleBold } from './publicApi/segment/toggleBold';\nexport { default as toggleItalic } from './publicApi/segment/toggleItalic';\nexport { default as toggleUnderline } from './publicApi/segment/toggleUnderline';\nexport { default as toggleStrikethrough } from './publicApi/segment/toggleStrikethrough';\nexport { default as toggleSubscript } from './publicApi/segment/toggleSubscript';\nexport { default as toggleSuperscript } from './publicApi/segment/toggleSuperscript';\nexport { default as setBackgroundColor } from './publicApi/segment/setBackgroundColor';\nexport { default as setFontName } from './publicApi/segment/setFontName';\nexport { default as setFontSize } from './publicApi/segment/setFontSize';\nexport { default as setTextColor } from './publicApi/segment/setTextColor';\nexport { default as changeFontSize } from './publicApi/segment/changeFontSize';\nexport { default as applySegmentFormat } from './publicApi/segment/applySegmentFormat';\nexport { default as changeCapitalization } from './publicApi/segment/changeCapitalization';\nexport { default as insertImage } from './publicApi/image/insertImage';\nexport { default as setListStyle } from './publicApi/list/setListStyle';\nexport { default as setListStartNumber } from './publicApi/list/setListStartNumber';\nexport { default as setIndentation } from './publicApi/block/setIndentation';\nexport { default as setAlignment } from './publicApi/block/setAlignment';\nexport { default as setDirection } from './publicApi/block/setDirection';\nexport { default as setHeadingLevel } from './publicApi/block/setHeadingLevel';\nexport { default as toggleBlockQuote } from './publicApi/block/toggleBlockQuote';\nexport { default as setSpacing } from './publicApi/block/setSpacing';\nexport { default as setImageBorder } from './publicApi/image/setImageBorder';\nexport { default as setImageBoxShadow } from './publicApi/image/setImageBoxShadow';\nexport { default as changeImage } from './publicApi/image/changeImage';\nexport { default as getFormatState } from './publicApi/format/getFormatState';\nexport { default as clearFormat } from './publicApi/format/clearFormat';\nexport { default as insertLink } from './publicApi/link/insertLink';\nexport { default as removeLink } from './publicApi/link/removeLink';\nexport { default as adjustLinkSelection } from './publicApi/link/adjustLinkSelection';\nexport { default as setImageAltText } from './publicApi/image/setImageAltText';\nexport { default as adjustImageSelection } from './publicApi/image/adjustImageSelection';\nexport { default as setParagraphMargin } from './publicApi/block/setParagraphMargin';\nexport { default as toggleCode } from './publicApi/segment/toggleCode';\nexport { default as insertEntity } from './publicApi/entity/insertEntity';\nexport { insertTableRow } from './modelApi/table/insertTableRow';\nexport { insertTableColumn } from './modelApi/table/insertTableColumn';\n\nexport { formatTableWithContentModel } from './publicApi/utils/formatTableWithContentModel';\nexport { setListType } from './modelApi/list/setListType';\nexport { findListItemsInSameThread } from './modelApi/list/findListItemsInSameThread';\nexport { setModelIndentation } from './modelApi/block/setModelIndentation';\n","import { alignTable } from '../table/alignTable';\nimport { getOperationalBlocks } from 'roosterjs-content-model-core';\nimport type {\n    ContentModelDocument,\n    ContentModelListItem,\n    TableAlignOperation,\n} from 'roosterjs-content-model-types';\n\nconst ResultMap: Record<\n    'left' | 'center' | 'right' | 'justify',\n    Record<'ltr' | 'rtl', 'start' | 'center' | 'end' | 'justify'>\n> = {\n    left: {\n        ltr: 'start',\n        rtl: 'end',\n    },\n    center: {\n        ltr: 'center',\n        rtl: 'center',\n    },\n    right: {\n        ltr: 'end',\n        rtl: 'start',\n    },\n    justify: {\n        ltr: 'justify',\n        rtl: 'justify',\n    },\n};\n\nconst TableAlignMap: Record<\n    'left' | 'center' | 'right',\n    Record<'ltr' | 'rtl', TableAlignOperation>\n> = {\n    left: {\n        ltr: 'alignLeft',\n        rtl: 'alignRight',\n    },\n    center: {\n        ltr: 'alignCenter',\n        rtl: 'alignCenter',\n    },\n    right: {\n        ltr: 'alignRight',\n        rtl: 'alignLeft',\n    },\n};\n\n/**\n * @internal\n */\nexport function setModelAlignment(\n    model: ContentModelDocument,\n    alignment: 'left' | 'center' | 'right' | 'justify'\n) {\n    const paragraphOrListItemOrTable = getOperationalBlocks<ContentModelListItem>(\n        model,\n        ['ListItem'],\n        ['TableCell']\n    );\n\n    paragraphOrListItemOrTable.forEach(({ block }) => {\n        const newAlignment = ResultMap[alignment][block.format.direction == 'rtl' ? 'rtl' : 'ltr'];\n        if (block.blockType === 'Table' && alignment !== 'justify') {\n            alignTable(\n                block,\n                TableAlignMap[alignment][block.format.direction == 'rtl' ? 'rtl' : 'ltr']\n            );\n        } else if (block) {\n            if (block.blockType === 'BlockGroup' && block.blockGroupType === 'ListItem') {\n                block.blocks.forEach(b => {\n                    const { format } = b;\n                    format.textAlign = newAlignment;\n                });\n            }\n            const { format } = block;\n            format.textAlign = newAlignment;\n        }\n    });\n\n    return paragraphOrListItemOrTable.length > 0;\n}\n","import { findListItemsInSameThread } from '../list/findListItemsInSameThread';\nimport {\n    applyTableFormat,\n    getOperationalBlocks,\n    isBlockGroupOfType,\n    updateTableCellMetadata,\n} from 'roosterjs-content-model-core';\nimport type {\n    BorderFormat,\n    ContentModelBlock,\n    ContentModelBlockFormat,\n    ContentModelDocument,\n    ContentModelListItem,\n    MarginFormat,\n    PaddingFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function setModelDirection(model: ContentModelDocument, direction: 'ltr' | 'rtl') {\n    const paragraphOrListItemOrTable = getOperationalBlocks<ContentModelListItem>(\n        model,\n        ['ListItem'],\n        ['TableCell']\n    );\n\n    paragraphOrListItemOrTable.forEach(({ block }) => {\n        if (isBlockGroupOfType<ContentModelListItem>(block, 'ListItem')) {\n            const items = findListItemsInSameThread(model, block);\n\n            items.forEach(item => {\n                item.levels.forEach(level => {\n                    level.format.direction = direction;\n                });\n\n                item.blocks.forEach(block => internalSetDirection(block.format, direction));\n            });\n        } else if (block) {\n            internalSetDirection(block.format, direction, block);\n        }\n    });\n\n    return paragraphOrListItemOrTable.length > 0;\n}\n\nfunction internalSetDirection(\n    format: ContentModelBlockFormat,\n    direction: 'ltr' | 'rtl',\n    block?: ContentModelBlock\n) {\n    const wasRtl = format.direction == 'rtl';\n    const isRtl = direction == 'rtl';\n\n    if (wasRtl != isRtl) {\n        format.direction = direction;\n\n        // Adjust margin when change direction\n        const marginLeft = format.marginLeft;\n        const paddingLeft = format.paddingLeft;\n\n        setProperty(format, 'marginLeft', format.marginRight);\n        setProperty(format, 'marginRight', marginLeft);\n        setProperty(format, 'paddingLeft', format.paddingRight);\n        setProperty(format, 'paddingRight', paddingLeft);\n\n        // If whole Table direction changed, flip cell side borders\n        if (block && block.blockType == 'Table') {\n            block.rows.forEach(row => {\n                row.cells.forEach(cell => {\n                    // Optimise by skipping cells with unchanged borders\n                    updateTableCellMetadata(cell, metadata => {\n                        if (metadata?.borderOverride) {\n                            const storeBorderLeft = cell.format.borderLeft;\n                            setProperty(cell.format, 'borderLeft', cell.format.borderRight);\n                            setProperty(cell.format, 'borderRight', storeBorderLeft);\n                        }\n                        return metadata;\n                    });\n                });\n            });\n\n            // Apply changed borders\n            applyTableFormat(block, undefined /* newFormat */, true /* keepCellShade*/);\n        }\n    }\n}\n\nfunction setProperty(\n    format: MarginFormat & PaddingFormat & BorderFormat,\n    key: keyof (MarginFormat & PaddingFormat & BorderFormat),\n    value: string | undefined\n) {\n    if (value) {\n        format[key] = value;\n    } else {\n        delete format[key];\n    }\n}\n","import { createListLevel, parseValueWithUnit } from 'roosterjs-content-model-dom';\nimport { findListItemsInSameThread } from '../list/findListItemsInSameThread';\nimport {\n    getOperationalBlocks,\n    isBlockGroupOfType,\n    updateListMetadata,\n} from 'roosterjs-content-model-core';\n\nimport type {\n    ContentModelBlock,\n    ContentModelBlockFormat,\n    ContentModelBlockGroup,\n    ContentModelDocument,\n    ContentModelListItem,\n    ContentModelListLevel,\n} from 'roosterjs-content-model-types';\n\nconst IndentStepInPixel = 40;\n\n/**\n * @param model The content model to set indentation\n * @param indentation The indentation type, 'indent' to indent, 'outdent' to outdent\n * @param length The length of indentation in pixel, default value is 40\n * Set indentation for selected list items or paragraphs\n */\nexport function setModelIndentation(\n    model: ContentModelDocument,\n    indentation: 'indent' | 'outdent',\n    length: number = IndentStepInPixel\n) {\n    const paragraphOrListItem = getOperationalBlocks<ContentModelListItem>(\n        model,\n        ['ListItem'],\n        ['TableCell']\n    );\n    const isIndent = indentation == 'indent';\n    const modifiedBlocks: ContentModelBlock[] = [];\n\n    paragraphOrListItem.forEach(({ block, parent, path }) => {\n        if (isBlockGroupOfType<ContentModelListItem>(block, 'ListItem')) {\n            const thread = findListItemsInSameThread(model, block);\n            const firstItem = thread[0];\n            //if the first item is selected and has only one level, we should add margin to the whole list\n            if (isSelected(firstItem) && firstItem.levels.length == 1) {\n                const level = block.levels[0];\n                const { format } = level;\n                const { marginLeft, marginRight } = format;\n                const newValue = calculateMarginValue(format, isIndent, length);\n                const isRtl = format.direction == 'rtl';\n                const originalValue = parseValueWithUnit(isRtl ? marginRight : marginLeft);\n\n                if (!isIndent && originalValue == 0) {\n                    block.levels.pop();\n                } else if (newValue !== null) {\n                    if (isRtl) {\n                        level.format.marginRight = newValue + 'px';\n                    } else {\n                        level.format.marginLeft = newValue + 'px';\n                    }\n                }\n                //if block has only one level, there is not need to check if it is multilevel selection\n            } else if (block.levels.length == 1 || !isMultilevelSelection(model, block, parent)) {\n                if (isIndent) {\n                    const lastLevel = block.levels[block.levels.length - 1];\n                    const newLevel: ContentModelListLevel = createListLevel(\n                        lastLevel?.listType || 'UL',\n                        lastLevel?.format\n                    );\n\n                    updateListMetadata(newLevel, metadata => {\n                        metadata = metadata || {};\n                        metadata.applyListStyleFromLevel = true;\n                        return metadata;\n                    });\n\n                    // New level is totally new, no need to have these attributes for now\n                    delete newLevel.format.startNumberOverride;\n\n                    block.levels.push(newLevel);\n                } else {\n                    block.levels.pop();\n                }\n            }\n        } else if (block) {\n            let currentBlock: ContentModelBlock = block;\n            let currentParent: ContentModelBlockGroup = parent;\n\n            while (currentParent && modifiedBlocks.indexOf(currentBlock) < 0) {\n                const index = path.indexOf(currentParent);\n                const { format } = currentBlock;\n                const newValue = calculateMarginValue(format, isIndent, length);\n\n                if (newValue !== null) {\n                    const isRtl = format.direction == 'rtl';\n\n                    if (isRtl) {\n                        format.marginRight = newValue + 'px';\n                    } else {\n                        format.marginLeft = newValue + 'px';\n                    }\n\n                    modifiedBlocks.push(currentBlock);\n\n                    break;\n                } else if (currentParent.blockGroupType == 'FormatContainer' && index >= 0) {\n                    delete currentParent.cachedElement;\n\n                    currentBlock = currentParent;\n                    currentParent = path[index + 1];\n                } else {\n                    break;\n                }\n            }\n        }\n    });\n\n    return paragraphOrListItem.length > 0;\n}\n\nfunction isSelected(listItem: ContentModelListItem) {\n    return listItem.blocks.some(block => {\n        if (block.blockType == 'Paragraph') {\n            return block.segments.some(segment => segment.isSelected);\n        }\n    });\n}\n\n/*\n * Check if the selection has list items with different levels and the first item of the list is selected, do not create a sub list.\n * Otherwise, the margin of the first item will be changed, and the sub list will be created, creating a unintentional margin difference between the list items.\n */\nfunction isMultilevelSelection(\n    model: ContentModelDocument,\n    listItem: ContentModelListItem,\n    parent: ContentModelBlockGroup\n) {\n    const listIndex = parent.blocks.indexOf(listItem);\n    for (let i = listIndex - 1; i >= 0; i--) {\n        const block = parent.blocks[i];\n        if (\n            isBlockGroupOfType<ContentModelListItem>(block, 'ListItem') &&\n            block.levels.length == 1 &&\n            isSelected(block)\n        ) {\n            const firstItem = findListItemsInSameThread(model, block)[0];\n            return isSelected(firstItem);\n        }\n\n        if (!isBlockGroupOfType<ContentModelListItem>(block, 'ListItem')) {\n            return false;\n        }\n    }\n    return false;\n}\n\nfunction calculateMarginValue(\n    format: ContentModelBlockFormat,\n    isIndent: boolean,\n    length: number = IndentStepInPixel\n): number | null {\n    const { marginLeft, marginRight, direction } = format;\n    const isRtl = direction == 'rtl';\n    const originalValue = parseValueWithUnit(isRtl ? marginRight : marginLeft);\n    let newValue = (isIndent ? Math.ceil : Math.floor)(originalValue / length) * length;\n\n    if (newValue == originalValue) {\n        newValue = Math.max(newValue + length * (isIndent ? 1 : -1), 0);\n    }\n\n    if (newValue == originalValue) {\n        // Return null to let caller know nothing is changed\n        return null;\n    } else {\n        return newValue;\n    }\n}\n","import { areSameFormats, createFormatContainer, unwrapBlock } from 'roosterjs-content-model-dom';\nimport { getOperationalBlocks, isBlockGroupOfType } from 'roosterjs-content-model-core';\nimport { wrapBlockStep1, wrapBlockStep2 } from '../common/wrapBlock';\nimport type { OperationalBlocks } from 'roosterjs-content-model-core';\nimport type { WrapBlockStep1Result } from '../common/wrapBlock';\nimport type {\n    ContentModelBlock,\n    ContentModelBlockGroup,\n    ContentModelDocument,\n    ContentModelFormatContainer,\n    ContentModelFormatContainerFormat,\n    ContentModelListItem,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function toggleModelBlockQuote(\n    model: ContentModelDocument,\n    formatLtr: ContentModelFormatContainerFormat,\n    formatRtl: ContentModelFormatContainerFormat\n): boolean {\n    const paragraphOfQuote = getOperationalBlocks<\n        ContentModelFormatContainer | ContentModelListItem\n    >(model, ['FormatContainer', 'ListItem'], ['TableCell'], true /*deepFirst*/);\n\n    if (areAllBlockQuotes(paragraphOfQuote)) {\n        // All selections are already in quote, we need to unquote them\n        paragraphOfQuote.forEach(({ block, parent }) => {\n            unwrapBlock(parent, block);\n        });\n    } else {\n        const step1Results: WrapBlockStep1Result<ContentModelFormatContainer>[] = [];\n        const creator = (isRtl: boolean) =>\n            createFormatContainer('blockquote', isRtl ? formatRtl : formatLtr);\n        const canMerge = (\n            isRtl: boolean,\n            target: ContentModelBlock,\n            current?: ContentModelFormatContainer\n        ): target is ContentModelFormatContainer =>\n            canMergeQuote(target, current?.format || (isRtl ? formatRtl : formatLtr));\n\n        paragraphOfQuote.forEach(({ block, parent }) => {\n            if (isQuote(block)) {\n                // Already in quote, no op\n            } else {\n                wrapBlockStep1(step1Results, parent, block, creator, canMerge);\n            }\n        });\n\n        wrapBlockStep2(step1Results, canMerge);\n    }\n\n    return paragraphOfQuote.length > 0;\n}\n\nfunction canMergeQuote(\n    target: ContentModelBlock,\n    format: ContentModelFormatContainerFormat\n): target is ContentModelFormatContainer {\n    return isQuote(target) && areSameFormats(format, target.format);\n}\n\nfunction isQuote(block: ContentModelBlock): block is ContentModelFormatContainer {\n    return (\n        isBlockGroupOfType<ContentModelFormatContainer>(block, 'FormatContainer') &&\n        block.tagName == 'blockquote'\n    );\n}\n\nfunction areAllBlockQuotes(\n    blockAndParents: OperationalBlocks<ContentModelFormatContainer | ContentModelListItem>[]\n): blockAndParents is {\n    block: ContentModelFormatContainer;\n    parent: ContentModelBlockGroup;\n    path: ContentModelBlockGroup[];\n}[] {\n    return blockAndParents.every(blockAndParent => isQuote(blockAndParent.block));\n}\n","import { adjustWordSelection } from '../selection/adjustWordSelection';\nimport { createFormatContainer } from 'roosterjs-content-model-dom';\nimport {\n    iterateSelections,\n    applyTableFormat,\n    getClosestAncestorBlockGroupIndex,\n    updateTableCellMetadata,\n    updateTableMetadata,\n} from 'roosterjs-content-model-core';\nimport type {\n    ContentModelBlock,\n    ContentModelBlockGroup,\n    ContentModelDocument,\n    ContentModelFormatContainer,\n    ContentModelListItem,\n    ContentModelSegment,\n    ContentModelSegmentFormat,\n    ContentModelTable,\n    Selectable,\n    TableSelectionContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function clearModelFormat(\n    model: ContentModelDocument,\n    blocksToClear: [ContentModelBlockGroup[], ContentModelBlock][],\n    segmentsToClear: ContentModelSegment[],\n    tablesToClear: [ContentModelTable, boolean][]\n) {\n    iterateSelections(\n        model,\n        (path, tableContext, block, segments) => {\n            if (segments) {\n                segmentsToClear.push(...segments);\n            }\n\n            if (block) {\n                blocksToClear.push([path, block]);\n            } else if (tableContext) {\n                clearTableCellFormat(tableContext, tablesToClear);\n            }\n        },\n        {\n            // When there is a default format to apply, we know how to handle segment format under list.\n            // So no need to clear format of list number.\n            // Otherwise, we will clear all format of selected text. And since they are under LI tag, we\n            // also need to clear the format of LI (format holder) so that the format is really cleared\n            includeListFormatHolder: model.format ? 'never' : 'anySegment',\n        }\n    );\n\n    const marker = segmentsToClear[0];\n\n    // 2. If selection is collapsed, add selection to whole word to clear if any\n    if (\n        blocksToClear.length == 1 &&\n        isOnlySelectionMarkerSelected(blocksToClear[0][1]) &&\n        blocksToClear.length == 1\n    ) {\n        segmentsToClear.splice(0, segmentsToClear.length, ...adjustWordSelection(model, marker));\n        clearListFormat(blocksToClear[0][0]);\n    } else if (blocksToClear.length > 1 || blocksToClear.some(x => isWholeBlockSelected(x[1]))) {\n        // 2. If a full block or multiple blocks are selected, clear block format\n        for (let i = blocksToClear.length - 1; i >= 0; i--) {\n            const [path, block] = blocksToClear[i];\n\n            clearBlockFormat(path, block);\n            clearListFormat(path);\n            clearContainerFormat(path, block);\n        }\n    }\n\n    // 3. Finally clear format for segments\n    clearSegmentsFormat(segmentsToClear, model.format);\n\n    // 4. Clear format for table if any\n    createTablesFormat(tablesToClear);\n}\n\nfunction createTablesFormat(tablesToClear: [ContentModelTable, boolean][]) {\n    tablesToClear.forEach(x => {\n        const [table, isWholeTableSelected] = x;\n        if (isWholeTableSelected) {\n            table.format = {\n                useBorderBox: table.format.useBorderBox,\n                borderCollapse: table.format.borderCollapse,\n            };\n            updateTableMetadata(table, () => null);\n        }\n\n        applyTableFormat(table, undefined /*newFormat*/, true);\n    });\n}\n\nfunction clearSegmentsFormat(\n    segmentsToClear: ContentModelSegment[],\n    defaultSegmentFormat: ContentModelSegmentFormat | undefined\n) {\n    segmentsToClear.forEach(x => {\n        x.format = { ...(defaultSegmentFormat || {}) };\n\n        if (x.link) {\n            delete x.link.format.textColor;\n        }\n\n        delete x.code;\n    });\n}\n\nfunction clearTableCellFormat(\n    tableContext: TableSelectionContext | undefined,\n    tablesToClear: [ContentModelTable, boolean][]\n) {\n    if (tableContext) {\n        const { table, colIndex, rowIndex, isWholeTableSelected } = tableContext;\n        const cell = table.rows[rowIndex].cells[colIndex];\n\n        if (cell.isSelected) {\n            updateTableCellMetadata(cell, () => null);\n            cell.isHeader = false;\n            cell.format = {\n                useBorderBox: cell.format.useBorderBox,\n            };\n        }\n\n        if (!tablesToClear.find(x => x[0] == table)) {\n            tablesToClear.push([table, isWholeTableSelected]);\n        }\n    }\n}\n\nfunction clearContainerFormat(path: ContentModelBlockGroup[], block: ContentModelBlock) {\n    const containerPathIndex = getClosestAncestorBlockGroupIndex(\n        path,\n        ['FormatContainer'],\n        ['TableCell']\n    );\n\n    if (containerPathIndex >= 0 && containerPathIndex < path.length - 1) {\n        const container = path[containerPathIndex] as ContentModelFormatContainer;\n        const containerIndex = path[containerPathIndex + 1].blocks.indexOf(container);\n        const blockIndex = container.blocks.indexOf(block);\n\n        if (blockIndex >= 0 && containerIndex >= 0) {\n            const newContainer = createFormatContainer(container.tagName, container.format);\n\n            container.blocks.splice(blockIndex, 1);\n            newContainer.blocks = container.blocks.splice(blockIndex);\n\n            path[containerPathIndex + 1].blocks.splice(containerIndex + 1, 0, block, newContainer);\n        }\n    }\n}\n\nfunction clearListFormat(path: ContentModelBlockGroup[]) {\n    const listItem = path[getClosestAncestorBlockGroupIndex(path, ['ListItem'], ['TableCell'])] as\n        | ContentModelListItem\n        | undefined;\n\n    if (listItem) {\n        listItem.levels = [];\n    }\n}\n\nfunction clearBlockFormat(path: ContentModelBlockGroup[], block: ContentModelBlock) {\n    if (block.blockType == 'Divider') {\n        const index = path[0].blocks.indexOf(block);\n\n        if (index >= 0) {\n            path[0].blocks.splice(index, 1);\n        }\n    } else if (block.blockType == 'Paragraph') {\n        block.format = {};\n        delete block.decorator;\n    }\n}\n\nfunction isOnlySelectionMarkerSelected(block: ContentModelBlock) {\n    const segments = block.blockType == 'Paragraph' ? block.segments.filter(x => x.isSelected) : [];\n\n    return segments.length == 1 && segments[0].segmentType == 'SelectionMarker';\n}\n\nfunction isWholeBlockSelected(block: ContentModelBlock) {\n    return (\n        (block as Selectable).isSelected ||\n        (block.blockType == 'Paragraph' && block.segments.every(x => x.isSelected))\n    );\n}\n","import { addBlock, setParagraphNotImplicit } from 'roosterjs-content-model-dom';\nimport type { ContentModelBlock, ContentModelBlockGroup } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport interface WrapBlockStep1Result<T extends ContentModelBlockGroup & ContentModelBlock> {\n    parent: ContentModelBlockGroup;\n    wrapper: T;\n}\n\n/**\n * @internal\n */\nexport function wrapBlockStep1<T extends ContentModelBlockGroup & ContentModelBlock>(\n    step1Result: WrapBlockStep1Result<T>[],\n    parent: ContentModelBlockGroup | null,\n    blockToWrap: ContentModelBlock,\n    creator: (isRtl: boolean) => T,\n    canMerge: (isRtl: boolean, target: ContentModelBlock) => target is T\n) {\n    const index = parent?.blocks.indexOf(blockToWrap) ?? -1;\n\n    if (parent && index >= 0) {\n        parent.blocks.splice(index, 1);\n\n        const prevBlock: ContentModelBlock = parent.blocks[index - 1];\n        const isRtl = blockToWrap.format.direction == 'rtl';\n        const wrapper = canMerge(isRtl, prevBlock)\n            ? prevBlock\n            : createAndAdd(parent, index, creator, isRtl);\n\n        setParagraphNotImplicit(blockToWrap);\n        addBlock(wrapper, blockToWrap);\n\n        // Use reverse order, so that we can merge from last to first to avoid modifying unmerged quotes\n        step1Result.unshift({ parent, wrapper });\n    }\n}\n\n/**\n * @internal\n */\nexport function wrapBlockStep2<T extends ContentModelBlockGroup & ContentModelBlock>(\n    step1Result: WrapBlockStep1Result<T>[],\n    canMerge: (isRtl: boolean, target: ContentModelBlock, current: T) => target is T\n) {\n    step1Result.forEach(({ parent, wrapper }) => {\n        const index = parent.blocks.indexOf(wrapper);\n        const nextBlock = parent.blocks[index + 1];\n        const isRtl = wrapper.format.direction == 'rtl';\n\n        if (index >= 0 && canMerge(isRtl, nextBlock, wrapper)) {\n            wrapper.blocks.forEach(setParagraphNotImplicit);\n            wrapper.blocks.push(...nextBlock.blocks);\n            parent.blocks.splice(index + 1, 1);\n        }\n    });\n}\n\nfunction createAndAdd<T extends ContentModelBlockGroup & ContentModelBlock>(\n    parent: ContentModelBlockGroup,\n    index: number,\n    creator: (isRtl: boolean) => T,\n    isRtl: boolean\n): T {\n    const block = creator(isRtl);\n\n    parent.blocks.splice(index, 0, block);\n    return block;\n}\n","import {\n    deleteSelection,\n    getClosestAncestorBlockGroupIndex,\n    setSelection,\n} from 'roosterjs-content-model-core';\nimport {\n    createBr,\n    createParagraph,\n    createSelectionMarker,\n    normalizeContentModel,\n} from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelBlock,\n    ContentModelBlockGroup,\n    ContentModelDocument,\n    ContentModelEntity,\n    ContentModelParagraph,\n    DeleteSelectionResult,\n    FormatContentModelContext,\n    InsertEntityPosition,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function insertEntityModel(\n    model: ContentModelDocument,\n    entityModel: ContentModelEntity,\n    position: InsertEntityPosition,\n    isBlock: boolean,\n    focusAfterEntity?: boolean,\n    context?: FormatContentModelContext\n) {\n    let blockParent: ContentModelBlockGroup | undefined;\n    let blockIndex = -1;\n    let deleteResult: DeleteSelectionResult;\n\n    if (position == 'begin' || position == 'end') {\n        blockParent = model;\n        blockIndex = position == 'begin' ? 0 : model.blocks.length;\n\n        if (!isBlock) {\n            Object.assign(entityModel.format, model.format);\n        }\n    } else if ((deleteResult = deleteSelection(model, [], context)).insertPoint) {\n        const { marker, paragraph, path } = deleteResult.insertPoint;\n\n        if (deleteResult.deleteResult == 'range') {\n            normalizeContentModel(model);\n        }\n\n        if (!isBlock) {\n            const index = paragraph.segments.indexOf(marker);\n\n            Object.assign(entityModel.format, marker.format);\n\n            if (index >= 0) {\n                paragraph.segments.splice(focusAfterEntity ? index : index + 1, 0, entityModel);\n            }\n        } else {\n            const pathIndex =\n                position == 'root'\n                    ? getClosestAncestorBlockGroupIndex(path, ['TableCell', 'Document'])\n                    : 0;\n            blockParent = path[pathIndex];\n            const child = path[pathIndex - 1];\n            const directChild: ContentModelBlock =\n                child?.blockGroupType == 'FormatContainer' ||\n                child?.blockGroupType == 'General' ||\n                child?.blockGroupType == 'ListItem'\n                    ? child\n                    : paragraph;\n            const childIndex = blockParent.blocks.indexOf(directChild);\n            blockIndex = childIndex >= 0 ? childIndex + 1 : -1;\n        }\n    }\n\n    if (blockIndex >= 0 && blockParent) {\n        const blocksToInsert: ContentModelBlock[] = [];\n        let nextParagraph: ContentModelParagraph | undefined;\n\n        if (isBlock) {\n            const nextBlock = blockParent.blocks[blockIndex];\n\n            blocksToInsert.push(entityModel);\n\n            if (nextBlock?.blockType == 'Paragraph') {\n                nextParagraph = nextBlock;\n            } else if (!nextBlock || nextBlock.blockType == 'Entity' || focusAfterEntity) {\n                nextParagraph = createParagraph(false /*isImplicit*/, {}, model.format);\n                nextParagraph.segments.push(createBr(model.format));\n                blocksToInsert.push(nextParagraph);\n            }\n        } else {\n            nextParagraph = createParagraph(\n                false /*isImplicit*/,\n                undefined /*format*/,\n                model.format\n            );\n\n            nextParagraph.segments.push(entityModel);\n            blocksToInsert.push(nextParagraph);\n        }\n\n        blockParent.blocks.splice(blockIndex, 0, ...blocksToInsert);\n\n        if (focusAfterEntity && nextParagraph) {\n            const marker = createSelectionMarker(nextParagraph.segments[0]?.format || model.format);\n            const segments = nextParagraph.segments;\n\n            isBlock ? segments.unshift(marker) : segments.push(marker);\n            setSelection(model, marker, marker);\n        }\n    }\n}\n","import { extractBorderValues } from 'roosterjs-content-model-core';\nimport { parseValueWithUnit } from 'roosterjs-content-model-dom';\nimport type { Border, ContentModelImage } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport default function applyImageBorderFormat(\n    image: ContentModelImage,\n    border: Border | null,\n    borderRadius?: string\n) {\n    if (border) {\n        const format = image.format;\n        const { width, style, color } = border;\n        const borderKey = 'borderTop';\n        const extractedBorder = extractBorderValues(format[borderKey]);\n        const borderColor = extractedBorder.color;\n        const borderWidth = extractedBorder.width;\n        const borderStyle = extractedBorder.style;\n        let borderFormat = '';\n\n        if (width) {\n            borderFormat = parseValueWithUnit(width) + 'px';\n        } else if (borderWidth) {\n            borderFormat = borderWidth;\n        } else {\n            borderFormat = '1px';\n        }\n\n        if (style) {\n            borderFormat = `${borderFormat} ${style}`;\n        } else if (borderStyle) {\n            borderFormat = `${borderFormat} ${borderStyle}`;\n        } else {\n            borderFormat = `${borderFormat} solid`;\n        }\n\n        if (color) {\n            borderFormat = `${borderFormat} ${color}`;\n        } else if (borderColor) {\n            borderFormat = `${borderFormat} ${borderColor}`;\n        }\n        image.format.borderLeft = borderFormat;\n        image.format.borderTop = borderFormat;\n        image.format.borderBottom = borderFormat;\n        image.format.borderRight = borderFormat;\n    } else {\n        delete image.format.borderLeft;\n        delete image.format.borderTop;\n        delete image.format.borderBottom;\n        delete image.format.borderRight;\n    }\n\n    if (borderRadius) {\n        image.format.borderRadius = borderRadius;\n    }\n}\n","import { getObjectKeys } from 'roosterjs-content-model-dom';\n\n/**\n * @internal\n */\nexport interface LinkData {\n    /**\n     * Schema of a hyperlink\n     */\n    scheme: string;\n\n    /**\n     * Original url of a hyperlink\n     */\n    originalUrl: string;\n\n    /**\n     * Normalized url of a hyperlink\n     */\n    normalizedUrl: string;\n}\n\ninterface LinkMatchRule {\n    match: RegExp;\n    except?: RegExp;\n    normalizeUrl?: (url: string) => string;\n}\n\n// http exclude matching regex\n// invalid URL example (in particular on IE and Edge):\n// - http://www.bing.com%00, %00 before ? (question mark) is considered invalid. IE/Edge throws invalid argument exception\n// - http://www.bing.com%1, %1 is invalid\n// - http://www.bing.com%g, %g is invalid (IE and Edge expects a two hex value after a %)\n// - http://www.bing.com%, % as ending is invalid (IE and Edge expects a two hex value after a %)\n// All above % cases if they're after ? (question mark) is then considered valid again\n// Similar for @, it needs to be after / (forward slash), or ? (question mark). Otherwise IE/Edge will throw security exception\n// - http://www.bing.com@name, @name before ? (question mark) is considered invalid\n// - http://www.bing.com/@name, is valid sine it is after / (forward slash)\n// - http://www.bing.com?@name, is also valid since it is after ? (question mark)\n// The regex below is essentially a break down of:\n// ^[^?]+%[^0-9a-f]+ => to exclude URL like www.bing.com%%\n// ^[^?]+%[0-9a-f][^0-9a-f]+ => to exclude URL like www.bing.com%1\n// ^[^?]+%00 => to exclude URL like www.bing.com%00\n// ^[^?]+%$ => to exclude URL like www.bing.com%\n// ^https?:\\/\\/[^?\\/]+@ => to exclude URL like http://www.bing.com@name\n// ^www\\.[^?\\/]+@ => to exclude URL like www.bing.com@name\n// , => to exclude url like www.bing,,com\nconst httpExcludeRegEx = /^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\\/\\/[^?\\/]+@|^www\\.[^?\\/]+@/i;\n\n// via https://tools.ietf.org/html/rfc1035 Page 7\nconst labelRegEx = '[a-z0-9](?:[a-z0-9-]*[a-z0-9])?'; // We're using case insensitive regexps below so don't bother including A-Z\nconst domainNameRegEx = `(?:${labelRegEx}\\\\.)*${labelRegEx}`;\nconst domainPortRegEx = `${domainNameRegEx}(?:\\\\:[0-9]+)?`;\nconst domainPortWithUrlRegEx = `${domainPortRegEx}(?:[\\\\/\\\\?]\\\\S*)?`;\n\nconst linkMatchRules: Record<string, LinkMatchRule> = {\n    http: {\n        match: new RegExp(\n            `^(?:microsoft-edge:)?http:\\\\/\\\\/${domainPortWithUrlRegEx}|www\\\\.${domainPortWithUrlRegEx}`,\n            'i'\n        ),\n        except: httpExcludeRegEx,\n        normalizeUrl: url =>\n            new RegExp('^(?:microsoft-edge:)?http:\\\\/\\\\/', 'i').test(url) ? url : 'http://' + url,\n    },\n    https: {\n        match: new RegExp(`^(?:microsoft-edge:)?https:\\\\/\\\\/${domainPortWithUrlRegEx}`, 'i'),\n        except: httpExcludeRegEx,\n    },\n    mailto: { match: new RegExp('^mailto:\\\\S+@\\\\S+\\\\.\\\\S+', 'i') },\n    notes: { match: new RegExp('^notes:\\\\/\\\\/\\\\S+', 'i') },\n    file: { match: new RegExp('^file:\\\\/\\\\/\\\\/?\\\\S+', 'i') },\n    unc: { match: new RegExp('^\\\\\\\\\\\\\\\\\\\\S+', 'i') },\n    ftp: {\n        match: new RegExp(\n            `^ftp:\\\\/\\\\/${domainPortWithUrlRegEx}|ftp\\\\.${domainPortWithUrlRegEx}`,\n            'i'\n        ),\n        normalizeUrl: url => (new RegExp('^ftp:\\\\/\\\\/', 'i').test(url) ? url : 'ftp://' + url),\n    },\n    news: { match: new RegExp(`^news:(\\\\/\\\\/)?${domainPortWithUrlRegEx}`, 'i') },\n    telnet: { match: new RegExp(`^telnet:(\\\\/\\\\/)?${domainPortWithUrlRegEx}`, 'i') },\n    gopher: { match: new RegExp(`^gopher:\\\\/\\\\/${domainPortWithUrlRegEx}`, 'i') },\n    wais: { match: new RegExp(`^wais:(\\\\/\\\\/)?${domainPortWithUrlRegEx}`, 'i') },\n};\n\n/**\n * @internal\n * Try to match a given string with link match rules, return matched link\n * @param url Input url to match\n * @param option Link match option, exact or partial. If it is exact match, we need\n * to check the length of matched link and url\n * @param rules Optional link match rules, if not passed, only the default link match\n * rules will be applied\n * @returns The matched link data, or null if no match found.\n * The link data includes an original url and a normalized url\n */\nexport function matchLink(url: string): LinkData | null {\n    if (url) {\n        for (const schema of getObjectKeys(linkMatchRules)) {\n            const rule = linkMatchRules[schema];\n            const matches = url.match(rule.match);\n            if (matches && matches[0] == url && (!rule.except || !rule.except.test(url))) {\n                return {\n                    scheme: schema,\n                    originalUrl: url,\n                    normalizedUrl: rule.normalizeUrl ? rule.normalizeUrl(url) : url,\n                };\n            }\n        }\n    }\n\n    return null;\n}\n","import type {\n    ContentModelBlockGroup,\n    ContentModelDocument,\n    ContentModelListItem,\n} from 'roosterjs-content-model-types';\n\n/**\n * @param model The content model\n * @param currentItem The current list item\n * Search for all list items in the same thread as the current list item\n */\nexport function findListItemsInSameThread(\n    model: ContentModelDocument,\n    currentItem: ContentModelListItem\n): ContentModelListItem[] {\n    const items: (ContentModelListItem | null)[] = [];\n\n    findListItems(model, items);\n\n    return filterListItems(items, currentItem);\n}\n\nfunction findListItems(group: ContentModelBlockGroup, result: (ContentModelListItem | null)[]) {\n    group.blocks.forEach(block => {\n        switch (block.blockType) {\n            case 'BlockGroup':\n                if (block.blockGroupType == 'ListItem') {\n                    result.push(block);\n                } else {\n                    pushNullIfNecessary(result);\n                    findListItems(block, result);\n                    pushNullIfNecessary(result);\n                }\n                break;\n\n            case 'Paragraph':\n                pushNullIfNecessary(result);\n\n                block.segments.forEach(segment => {\n                    if (segment.segmentType == 'General') {\n                        findListItems(segment, result);\n                    }\n                });\n\n                pushNullIfNecessary(result);\n                break;\n\n            case 'Table':\n                pushNullIfNecessary(result);\n\n                block.rows.forEach(row =>\n                    row.cells.forEach(cell => {\n                        findListItems(cell, result);\n                    })\n                );\n                pushNullIfNecessary(result);\n\n                break;\n        }\n    });\n}\n\nfunction pushNullIfNecessary(result: (ContentModelListItem | null)[]) {\n    const last = result[result.length - 1];\n\n    if (!last || last !== null) {\n        result.push(null);\n    }\n}\n\nfunction filterListItems(\n    items: (ContentModelListItem | null)[],\n    currentItem: ContentModelListItem\n) {\n    const result: ContentModelListItem[] = [];\n    const currentIndex = items.indexOf(currentItem);\n    const levelLength = currentItem.levels.length;\n    const isOrderedList = currentItem.levels[levelLength - 1]?.listType == 'OL';\n\n    if (currentIndex >= 0) {\n        for (let i = currentIndex; i >= 0; i--) {\n            const item = items[i];\n\n            if (!item) {\n                if (isOrderedList) {\n                    continue;\n                } else {\n                    break;\n                }\n            }\n\n            const startNumberOverride = hasStartNumberOverride(item, levelLength);\n\n            if (areListTypesCompatible(items, currentIndex, i)) {\n                result.unshift(item);\n\n                if (isOrderedList && startNumberOverride) {\n                    break;\n                }\n            } else if (!isOrderedList || startNumberOverride) {\n                break;\n            }\n        }\n\n        for (let i = currentIndex + 1; i < items.length; i++) {\n            const item = items[i];\n\n            if (!item) {\n                if (isOrderedList) {\n                    continue;\n                } else {\n                    break;\n                }\n            }\n\n            const startNumberOverride = hasStartNumberOverride(item, levelLength);\n\n            if (areListTypesCompatible(items, currentIndex, i) && !startNumberOverride) {\n                result.push(item);\n            } else if (!isOrderedList || startNumberOverride) {\n                break;\n            }\n        }\n    }\n\n    return result;\n}\n\nfunction areListTypesCompatible(\n    listItems: (ContentModelListItem | null)[],\n    currentIndex: number,\n    compareToIndex: number\n): boolean {\n    const currentLevels = listItems[currentIndex]!.levels;\n    const compareToLevels = listItems[compareToIndex]!.levels;\n\n    return (\n        currentLevels.length <= compareToLevels.length &&\n        currentLevels.every(\n            (currentLevel, i) => currentLevel.listType == compareToLevels[i].listType\n        )\n    );\n}\n\nfunction hasStartNumberOverride(item: ContentModelListItem, levelLength: number): boolean {\n    return item.levels\n        .slice(0, levelLength)\n        .some(level => level.format.startNumberOverride !== undefined);\n}\n","import { getOperationalBlocks, isBlockGroupOfType } from 'roosterjs-content-model-core';\nimport {\n    createListItem,\n    createListLevel,\n    normalizeContentModel,\n    setParagraphNotImplicit,\n} from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelBlock,\n    ContentModelDocument,\n    ContentModelListItem,\n} from 'roosterjs-content-model-types';\n\n/**\n * Set a list type to content model\n * @param model the model document\n * @param listType the list type OL | UL\n * @param removeMargins true to remove margins, false to keep margins @default false\n */\nexport function setListType(\n    model: ContentModelDocument,\n    listType: 'OL' | 'UL',\n    removeMargins: boolean = false\n) {\n    const paragraphOrListItems = getOperationalBlocks<ContentModelListItem>(\n        model,\n        ['ListItem'],\n        [] // Set stop types to be empty so we can find list items even cross the boundary of table, then we can always operation on the list item if any\n    );\n    const alreadyInExpectedType = paragraphOrListItems.every(({ block }) =>\n        isBlockGroupOfType<ContentModelListItem>(block, 'ListItem')\n            ? block.levels[block.levels.length - 1]?.listType == listType\n            : shouldIgnoreBlock(block)\n    );\n    let existingListItems: ContentModelListItem[] = [];\n\n    paragraphOrListItems.forEach(({ block, parent }, itemIndex) => {\n        if (isBlockGroupOfType<ContentModelListItem>(block, 'ListItem')) {\n            const level = block.levels.pop();\n\n            if (!alreadyInExpectedType && level) {\n                level.listType = listType;\n                block.levels.push(level);\n            } else if (block.blocks.length == 1) {\n                setParagraphNotImplicit(block.blocks[0]);\n            }\n\n            if (alreadyInExpectedType) {\n                //if the list item has margins or textAlign, we need to apply them to the block to preserve the indention and alignment\n                block.blocks.forEach(x => {\n                    if (block.format.marginLeft) {\n                        x.format.marginLeft = block.format.marginLeft;\n                    }\n\n                    if (block.format.marginRight) {\n                        x.format.marginRight = block.format.marginRight;\n                    }\n\n                    if (block.format.textAlign) {\n                        x.format.textAlign = block.format.textAlign;\n                    }\n                });\n            }\n        } else {\n            const index = parent.blocks.indexOf(block);\n\n            if (index >= 0) {\n                if (paragraphOrListItems.length == 1 || !shouldIgnoreBlock(block)) {\n                    const prevBlock = parent.blocks[index - 1];\n                    const segmentFormat =\n                        (block.blockType == 'Paragraph' && block.segments[0]?.format) || {};\n                    const newListItem = createListItem(\n                        [\n                            createListLevel(listType, {\n                                startNumberOverride:\n                                    itemIndex > 0 ||\n                                    (prevBlock?.blockType == 'BlockGroup' &&\n                                        prevBlock.blockGroupType == 'ListItem' &&\n                                        prevBlock.levels[0]?.listType == 'OL')\n                                        ? undefined\n                                        : 1,\n                                direction: block.format.direction,\n                                textAlign: block.format.textAlign,\n                                marginBottom: removeMargins ? '0px' : undefined,\n                                marginTop: removeMargins ? '0px' : undefined,\n                            }),\n                        ],\n                        // For list bullet, we only want to carry over these formats from segments:\n                        {\n                            fontFamily: segmentFormat.fontFamily,\n                            fontSize: segmentFormat.fontSize,\n                            textColor: segmentFormat.textColor,\n                        }\n                    );\n\n                    if (block.blockType == 'Paragraph') {\n                        setParagraphNotImplicit(block);\n                    }\n\n                    newListItem.blocks.push(block);\n\n                    if (block.format.marginRight) {\n                        newListItem.format.marginRight = block.format.marginRight;\n                        block.format.marginRight = undefined;\n                    }\n\n                    if (block.format.marginLeft) {\n                        newListItem.format.marginLeft = block.format.marginLeft;\n                        block.format.marginLeft = undefined;\n                    }\n\n                    if (block.format.textAlign) {\n                        newListItem.format.textAlign = block.format.textAlign;\n                    }\n\n                    parent.blocks.splice(index, 1, newListItem);\n                    existingListItems.push(newListItem);\n                } else {\n                    existingListItems.forEach(x => (x.levels[0].format.marginBottom = '0px'));\n                    existingListItems = [];\n                }\n            }\n        }\n    });\n\n    normalizeContentModel(model);\n\n    return paragraphOrListItems.length > 0;\n}\n\nfunction shouldIgnoreBlock(block: ContentModelBlock) {\n    switch (block.blockType) {\n        case 'Table':\n            return false;\n        case 'Paragraph':\n            return block.segments.every(\n                x => x.segmentType == 'Br' || x.segmentType == 'SelectionMarker'\n            );\n        default:\n            return true;\n    }\n}\n","import { getSelectedParagraphs, setSelection } from 'roosterjs-content-model-core';\nimport type { ContentModelDocument, ContentModelSegment } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function adjustSegmentSelection(\n    model: ContentModelDocument,\n    firstMatcher: (target: ContentModelSegment) => boolean,\n    siblingMatcher: (target: ContentModelSegment, ref: ContentModelSegment) => boolean\n): boolean {\n    const paragraphs = getSelectedParagraphs(model);\n    let first: ContentModelSegment | undefined;\n    let last: ContentModelSegment | undefined;\n    let changed = false;\n\n    paragraphs.forEach(p => {\n        const index = first ? 0 : p.segments.findIndex(x => firstMatcher(x));\n        const segments = p.segments;\n\n        if (!first) {\n            first = segments[index];\n\n            for (let i = index; i > 0; i--) {\n                if (siblingMatcher(segments[i - 1], first)) {\n                    first = segments[i - 1];\n                    changed = changed || !segments[i - 1].isSelected;\n                } else {\n                    changed = changed || !!segments[i - 1].isSelected;\n                    break;\n                }\n            }\n        }\n\n        if (first) {\n            for (let i = index; i < p.segments.length; i++) {\n                if (i == index || siblingMatcher(segments[i], last || segments[index])) {\n                    last = segments[i];\n                    changed = changed || !segments[i].isSelected;\n                } else {\n                    changed = changed || !!segments[i].isSelected;\n                    break;\n                }\n            }\n        }\n    });\n\n    if (first && last) {\n        setSelection(model, first, last);\n    }\n\n    return changed;\n}\n","import { createText } from 'roosterjs-content-model-dom';\nimport { iterateSelections } from 'roosterjs-content-model-core';\nimport type {\n    ContentModelDocument,\n    ContentModelParagraph,\n    ContentModelText,\n} from 'roosterjs-content-model-types';\n\n/**\n * If a format cannot be applied to be applied to a trailing space, split the trailing space into a separate segment\n * @internal\n */\nexport function adjustTrailingSpaceSelection(model: ContentModelDocument) {\n    iterateSelections(model, (_, __, block, segments) => {\n        if (block?.blockType === 'Paragraph' && segments && segments.length > 0) {\n            if (\n                segments.length === 1 &&\n                segments[0].segmentType === 'Text' &&\n                shouldSplitTrailingSpace(segments[0])\n            ) {\n                splitTextSegment(block, segments[0]);\n            } else {\n                const lastTextSegment =\n                    segments[segments.length - 1].segmentType === 'SelectionMarker'\n                        ? segments[segments.length - 2]\n                        : segments[segments.length - 1];\n                if (\n                    lastTextSegment &&\n                    lastTextSegment.segmentType === 'Text' &&\n                    shouldSplitTrailingSpace(lastTextSegment)\n                ) {\n                    splitTextSegment(block, lastTextSegment);\n                }\n            }\n        }\n\n        return false;\n    });\n}\n\nfunction shouldSplitTrailingSpace(segment: ContentModelText) {\n    return segment.isSelected && hasTrailingSpace(segment.text) && !isTrailingSpace(segment.text);\n}\n\nfunction hasTrailingSpace(text: string) {\n    return text.trimRight() !== text;\n}\n\nfunction isTrailingSpace(text: string) {\n    return text.trimRight().length == 0;\n}\n\nfunction splitTextSegment(block: ContentModelParagraph, textSegment: Readonly<ContentModelText>) {\n    const text = textSegment.text.trimRight();\n    const trailingSpace = textSegment.text.substring(text.length);\n    const newText = createText(text, textSegment.format, textSegment.link, textSegment.code);\n    newText.isSelected = true;\n    const trailingSpaceLink = textSegment.link\n        ? {\n              ...textSegment.link,\n              format: {\n                  ...textSegment.link?.format,\n                  underline: false, // Remove underline for trailing space link\n              },\n          }\n        : undefined;\n    const trailingSpaceSegment = createText(\n        trailingSpace,\n        undefined,\n        trailingSpaceLink,\n        textSegment.code\n    );\n    trailingSpaceSegment.isSelected = true;\n    const index = block.segments.indexOf(textSegment);\n    block.segments.splice(index, 1, newText, trailingSpaceSegment);\n}\n","import { createText } from 'roosterjs-content-model-dom';\nimport { isPunctuation, isSpace, iterateSelections } from 'roosterjs-content-model-core';\nimport type {\n    ContentModelDocument,\n    ContentModelParagraph,\n    ContentModelSegment,\n    ContentModelText,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function adjustWordSelection(\n    model: ContentModelDocument,\n    marker: ContentModelSegment\n): ContentModelSegment[] {\n    let markerBlock: ContentModelParagraph | undefined;\n\n    iterateSelections(model, (_, __, block, segments) => {\n        //Find the block with the selection marker\n        if (block?.blockType == 'Paragraph' && segments?.length == 1 && segments[0] == marker) {\n            markerBlock = block;\n        }\n        return true;\n    });\n\n    const tempSegments = markerBlock ? [...markerBlock.segments] : undefined;\n\n    if (tempSegments && markerBlock) {\n        const segments: ContentModelSegment[] = [];\n        let markerSelectionIndex = tempSegments.indexOf(marker);\n        for (let i = markerSelectionIndex - 1; i >= 0; i--) {\n            const currentSegment = tempSegments[i];\n            if (currentSegment.segmentType == 'Text') {\n                const found = findDelimiter(currentSegment, false /*moveRightward*/);\n                if (found > -1) {\n                    if (found == currentSegment.text.length) {\n                        break;\n                    }\n\n                    splitTextSegment(tempSegments, currentSegment, i, found);\n\n                    segments.push(tempSegments[i + 1]);\n\n                    break;\n                } else {\n                    segments.push(tempSegments[i]);\n                }\n            } else {\n                break;\n            }\n        }\n\n        markerSelectionIndex = tempSegments.indexOf(marker);\n        segments.push(marker);\n\n        // Marker is at start of word\n        if (segments.length <= 1) {\n            return segments;\n        }\n\n        for (let i = markerSelectionIndex + 1; i < tempSegments.length; i++) {\n            const currentSegment = tempSegments[i];\n            if (currentSegment.segmentType == 'Text') {\n                const found = findDelimiter(currentSegment, true /*moveRightward*/);\n                if (found > -1) {\n                    if (found == 0) {\n                        break;\n                    }\n                    splitTextSegment(tempSegments, currentSegment, i, found);\n                    segments.push(tempSegments[i]);\n                    break;\n                } else {\n                    segments.push(tempSegments[i]);\n                }\n            } else {\n                break;\n            }\n        }\n\n        // Marker is at end of word\n        if (segments[segments.length - 1] == marker) {\n            return [marker];\n        }\n\n        markerBlock.segments = tempSegments;\n        return segments;\n    } else {\n        return [marker];\n    }\n}\n\n/*\n// These are unicode characters mostly from the Category Space Separator (Zs)\nhttps://unicode.org/Public/UNIDATA/Scripts.txt\n\n\\u2000 = EN QUAD\n\\u2009 = THIN SPACE\n\\u200a = HAIR SPACE\n\\u200b = ZERO WIDTH SPACE\n\\u202f = NARROW NO-BREAK SPACE\n\\u205f = MEDIUM MATHEMATICAL SPACE\n\\u3000 = IDEOGRAPHIC SPACE\n*/\nfunction findDelimiter(segment: ContentModelText, moveRightward: boolean): number {\n    const word = segment.text;\n    let offset = -1;\n    if (moveRightward) {\n        for (let i = 0; i < word.length; i++) {\n            const char = word[i];\n\n            if (isPunctuation(char) || isSpace(char)) {\n                offset = i;\n                break;\n            }\n        }\n    } else {\n        for (let i = word.length - 1; i >= 0; i--) {\n            const char = word[i];\n\n            if (isPunctuation(char) || isSpace(char)) {\n                offset = i + 1;\n                break;\n            }\n        }\n    }\n    return offset;\n}\n\nfunction splitTextSegment(\n    segments: ContentModelSegment[],\n    textSegment: Readonly<ContentModelText>,\n    index: number,\n    found: number\n) {\n    const text = textSegment.text;\n    const newSegmentLeft = createText(\n        text.substring(0, found),\n        textSegment.format,\n        textSegment.link,\n        textSegment.code\n    );\n    const newSegmentRight = createText(\n        text.substring(found, text.length),\n        textSegment.format,\n        textSegment.link,\n        textSegment.code\n    );\n    segments.splice(index, 1, newSegmentLeft, newSegmentRight);\n}\n","import { addSegment, createSelectionMarker } from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelTableRow,\n    TableSelectionCoordinates,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function collapseTableSelection(\n    rows: ContentModelTableRow[],\n    selection: TableSelectionCoordinates\n) {\n    const { firstColumn, firstRow } = selection;\n    const cell = rows[firstRow]?.cells[firstColumn];\n    if (cell) {\n        addSegment(cell, createSelectionMarker());\n    }\n}\n","import type { ContentModelTable, TableAlignOperation } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function alignTable(table: ContentModelTable, operation: TableAlignOperation) {\n    table.format.marginLeft = operation == 'alignLeft' ? '' : 'auto';\n    table.format.marginRight = operation == 'alignRight' ? '' : 'auto';\n\n    delete table.cachedElement;\n}\n","import { getSelectedCells, updateTableCellMetadata } from 'roosterjs-content-model-core';\nimport type {\n    ContentModelTable,\n    ContentModelTableCell,\n    TableCellHorizontalAlignOperation,\n    TableCellVerticalAlignOperation,\n} from 'roosterjs-content-model-types';\n\nconst TextAlignValueMap: Partial<Record<\n    TableCellHorizontalAlignOperation,\n    'start' | 'center' | 'end'\n>> = {\n    alignCellLeft: 'start',\n    alignCellCenter: 'center',\n    alignCellRight: 'end',\n};\n\nconst VerticalAlignValueMap: Partial<Record<\n    TableCellVerticalAlignOperation,\n    'top' | 'middle' | 'bottom'\n>> = {\n    alignCellTop: 'top',\n    alignCellMiddle: 'middle',\n    alignCellBottom: 'bottom',\n};\n\n/**\n * @internal\n */\nexport function alignTableCellHorizontally(\n    table: ContentModelTable,\n    operation: TableCellHorizontalAlignOperation\n) {\n    alignTableCellInternal(table, cell => {\n        cell.format.textAlign = TextAlignValueMap[operation];\n    });\n}\n\n/**\n * @internal\n */\nexport function alignTableCellVertically(\n    table: ContentModelTable,\n    operation: TableCellVerticalAlignOperation\n) {\n    alignTableCellInternal(table, cell => {\n        cell.format.verticalAlign = VerticalAlignValueMap[operation];\n\n        updateTableCellMetadata(cell, metadata => {\n            metadata = metadata || {};\n            metadata.vAlignOverride = true;\n            return metadata;\n        });\n    });\n}\n\nfunction alignTableCellInternal(\n    table: ContentModelTable,\n    callback: (cell: ContentModelTableCell) => void\n) {\n    const sel = getSelectedCells(table);\n\n    if (sel) {\n        for (let rowIndex = sel.firstRow; rowIndex <= sel.lastRow; rowIndex++) {\n            for (let colIndex = sel.firstColumn; colIndex <= sel.lastColumn; colIndex++) {\n                const cell = table.rows[rowIndex]?.cells[colIndex];\n                const format = cell?.format;\n\n                if (format) {\n                    delete cell.cachedElement;\n\n                    callback(cell);\n\n                    cell.blocks.forEach(block => {\n                        if (block.blockType === 'Paragraph') {\n                            delete block.format.textAlign;\n                        }\n                    });\n                }\n            }\n        }\n    }\n}\n","import type { ContentModelTableRow } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function canMergeCells(\n    rows: ContentModelTableRow[],\n    firstRow: number,\n    firstCol: number,\n    lastRow: number,\n    lastCol: number\n): boolean {\n    const noSpanAbove =\n        firstCol == lastCol ||\n        rows[firstRow].cells.every(\n            (cell, colIndex) => colIndex < firstCol || colIndex > lastCol || !cell.spanAbove\n        );\n    const noSpanLeft =\n        firstRow == lastRow ||\n        rows.every(\n            (row, rowIndex) =>\n                rowIndex < firstRow || rowIndex > lastRow || !row.cells[firstCol].spanLeft\n        );\n\n    const noDifferentBelowSpan = rows[lastRow].cells\n        .map((_, colIndex) =>\n            colIndex >= firstCol && colIndex <= lastCol\n                ? getBelowSpanCount(rows, lastRow, colIndex)\n                : -1\n        )\n        .every((x, _, a) => x < 0 || x == a[firstCol]);\n    const noDifferentRightSpan = rows\n        .map((_, rowIndex) =>\n            rowIndex >= firstRow && rowIndex <= lastRow\n                ? getRightSpanCount(rows, rowIndex, lastCol)\n                : -1\n        )\n        .every((x, _, a) => x < 0 || x == a[firstRow]);\n\n    return noSpanAbove && noSpanLeft && noDifferentBelowSpan && noDifferentRightSpan;\n}\n\nfunction getBelowSpanCount(rows: ContentModelTableRow[], rowIndex: number, colIndex: number) {\n    let spanCount = 0;\n\n    for (let row = rowIndex + 1; row < rows.length; row++) {\n        if (rows[row]?.cells[colIndex]?.spanAbove) {\n            spanCount++;\n        } else {\n            break;\n        }\n    }\n\n    return spanCount;\n}\n\nfunction getRightSpanCount(rows: ContentModelTableRow[], rowIndex: number, colIndex: number) {\n    let spanCount = 0;\n\n    for (let col = colIndex + 1; col < rows[rowIndex]?.cells.length; col++) {\n        if (rows[rowIndex]?.cells[col]?.spanLeft) {\n            spanCount++;\n        } else {\n            break;\n        }\n    }\n\n    return spanCount;\n}\n","import { setSelection } from 'roosterjs-content-model-core';\nimport type { ContentModelTable, TableSelectionCoordinates } from 'roosterjs-content-model-types';\n\n/**\n * Clear selection of a table.\n * @internal\n * @param table The table model where the selection is to be cleared\n * @param sel The selection coordinates to be cleared\n */\nexport function clearSelectedCells(table: ContentModelTable, sel: TableSelectionCoordinates) {\n    if (\n        sel.firstColumn >= 0 &&\n        sel.firstRow >= 0 &&\n        sel.lastColumn < table.widths.length &&\n        sel.lastRow < table.rows.length\n    ) {\n        for (let i = sel.firstRow; i <= sel.lastRow; i++) {\n            const row = table.rows[i];\n            for (let j = sel.firstColumn; j <= sel.lastColumn; j++) {\n                const cell = row.cells[j];\n                cell.isSelected = false;\n                setSelection(cell);\n            }\n        }\n    }\n}\n","import { addBlock, createTable, createTableCell } from 'roosterjs-content-model-dom';\nimport type { ContentModelBlockGroup, ContentModelTable } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function createTableStructure(\n    parent: ContentModelBlockGroup,\n    columns: number,\n    rows: number\n): ContentModelTable {\n    const table = createTable(rows);\n\n    addBlock(parent, table);\n\n    table.rows.forEach(row => {\n        for (let i = 0; i < columns; i++) {\n            const cell = createTableCell();\n\n            row.cells.push(cell);\n        }\n    });\n\n    return table;\n}\n","import type { ContentModelTable } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function deleteTable(table: ContentModelTable) {\n    table.rows = [];\n    delete table.cachedElement;\n}\n","import { collapseTableSelection } from '../selection/collapseTableSelection';\nimport { getSelectedCells } from 'roosterjs-content-model-core';\nimport type { ContentModelTable } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function deleteTableColumn(table: ContentModelTable) {\n    const sel = getSelectedCells(table);\n\n    if (sel) {\n        for (let rowIndex = 0; rowIndex < table.rows.length; rowIndex++) {\n            const cellInNextCol = table.rows[rowIndex].cells[sel.lastColumn + 1];\n\n            if (cellInNextCol) {\n                cellInNextCol.spanLeft =\n                    cellInNextCol.spanLeft && table.rows[rowIndex].cells[sel.firstColumn].spanLeft;\n            }\n\n            table.rows[rowIndex].cells.splice(\n                sel.firstColumn,\n                sel.lastColumn - sel.firstColumn + 1\n            );\n        }\n\n        table.widths.splice(sel.firstColumn, sel.lastColumn - sel.firstColumn + 1);\n        collapseTableSelection(table.rows, sel);\n    }\n}\n","import { collapseTableSelection } from '../selection/collapseTableSelection';\nimport { getSelectedCells } from 'roosterjs-content-model-core';\nimport type { ContentModelTable } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function deleteTableRow(table: ContentModelTable) {\n    const sel = getSelectedCells(table);\n\n    if (sel) {\n        table.rows[sel.firstRow].cells.forEach((cell, colIndex) => {\n            const cellInNextRow = table.rows[sel.lastRow + 1]?.cells[colIndex];\n\n            if (cellInNextRow) {\n                cellInNextRow.spanAbove = cellInNextRow.spanAbove && cell.spanAbove;\n            }\n        });\n\n        table.rows.splice(sel.firstRow, sel.lastRow - sel.firstRow + 1);\n\n        collapseTableSelection(table.rows, sel);\n    }\n}\n","import { createBr, createParagraph } from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelBlock,\n    ContentModelBlockGroup,\n    ContentModelDocument,\n    ContentModelParagraph,\n    ContentModelTable,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * After edit table, it maybe in a abnormal state, e.g. selected table cell is removed, or all rows are removed causes no place to put cursor.\n * We need to make sure table is in normal state, and there is a place to put cursor.\n * @returns a new paragraph that can but put focus in, or undefined if not needed\n */\nexport function ensureFocusableParagraphForTable(\n    model: ContentModelDocument,\n    path: ContentModelBlockGroup[],\n    table: ContentModelTable\n): ContentModelParagraph | undefined {\n    let paragraph: ContentModelParagraph | undefined;\n    const firstCell = table.rows.filter(row => row.cells.length > 0)[0]?.cells[0];\n\n    if (firstCell) {\n        // When there is a valid cell to put focus, use it\n        paragraph = firstCell.blocks.filter(\n            (block): block is ContentModelParagraph => block.blockType == 'Paragraph'\n        )[0];\n\n        if (!paragraph) {\n            // If there is not a paragraph under this cell, create one\n            paragraph = createEmptyParagraph(model);\n            firstCell.blocks.push(paragraph);\n        }\n    } else {\n        // No table cell at all, which means the whole table is deleted. So we need to remove it from content model.\n        let block: ContentModelBlock = table;\n        let parent: ContentModelBlockGroup | undefined;\n        paragraph = createEmptyParagraph(model);\n\n        // If the table is the only block of its parent and parent is a FormatContainer, remove the parent as well.\n        // We need to do this in a loop in case there are multiple layer of FormatContainer that match this case\n        while ((parent = path.shift())) {\n            const index = parent.blocks.indexOf(block) ?? -1;\n\n            if (parent && index >= 0) {\n                parent.blocks.splice(index, 1, paragraph);\n            }\n\n            if (\n                parent.blockGroupType == 'FormatContainer' &&\n                parent.blocks.length == 1 &&\n                parent.blocks[0] == paragraph\n            ) {\n                // If the new paragraph is the only child of parent format container, unwrap parent as well\n                block = parent;\n            } else {\n                // Otherwise, just stop here and keep processing the new paragraph\n                break;\n            }\n        }\n    }\n\n    return paragraph;\n}\n\nfunction createEmptyParagraph(model: ContentModelDocument) {\n    const newPara = createParagraph(false /*isImplicit*/, undefined /*blockFormat*/, model.format);\n    const br = createBr(model.format);\n\n    newPara.segments.push(br);\n\n    return newPara;\n}\n","import { clearSelectedCells } from './clearSelectedCells';\nimport { createTableCell } from 'roosterjs-content-model-dom';\nimport { getSelectedCells } from 'roosterjs-content-model-core';\nimport type {\n    ContentModelTable,\n    TableHorizontalInsertOperation,\n} from 'roosterjs-content-model-types';\n\n/**\n * Insert a column to the table\n * @param table The table model where the column is to be inserted\n * @param operation The operation to be performed\n */\nexport function insertTableColumn(\n    table: ContentModelTable,\n    operation: TableHorizontalInsertOperation\n) {\n    const sel = getSelectedCells(table);\n    const insertLeft = operation == 'insertLeft';\n\n    if (sel) {\n        clearSelectedCells(table, sel);\n        for (let i = sel?.firstColumn; i <= sel.lastColumn; i++) {\n            table.rows.forEach(row => {\n                const cell = row.cells[insertLeft ? sel.firstColumn : sel.lastColumn];\n\n                const newCell = createTableCell(\n                    cell.spanLeft,\n                    cell.spanAbove,\n                    cell.isHeader,\n                    cell.format,\n                    cell.dataset\n                );\n                newCell.isSelected = true;\n\n                row.cells.splice(insertLeft ? sel.firstColumn : sel.lastColumn + 1, 0, newCell);\n            });\n            table.widths.splice(\n                insertLeft ? sel.firstColumn : sel.lastColumn + 1,\n                0,\n                table.widths[insertLeft ? sel.firstColumn : sel.lastColumn]\n            );\n        }\n    }\n}\n","import { clearSelectedCells } from './clearSelectedCells';\nimport { createTableCell } from 'roosterjs-content-model-dom';\nimport { getSelectedCells } from 'roosterjs-content-model-core';\nimport type {\n    ContentModelTable,\n    TableVerticalInsertOperation,\n} from 'roosterjs-content-model-types';\n\n/**\n * Insert a row to the table\n * @param table The table model where the row is to be inserted\n * @param operation The operation to be performed\n */\nexport function insertTableRow(table: ContentModelTable, operation: TableVerticalInsertOperation) {\n    const sel = getSelectedCells(table);\n    const insertAbove = operation == 'insertAbove';\n\n    if (sel) {\n        clearSelectedCells(table, sel);\n        for (let i = sel.firstRow; i <= sel.lastRow; i++) {\n            const sourceRow = table.rows[insertAbove ? sel.firstRow : sel.lastRow];\n\n            table.rows.splice(insertAbove ? sel.firstRow : sel.lastRow + 1, 0, {\n                format: { ...sourceRow.format },\n                cells: sourceRow.cells.map(cell => {\n                    const newCell = createTableCell(\n                        cell.spanLeft,\n                        cell.spanAbove,\n                        cell.isHeader,\n                        cell.format,\n                        cell.dataset\n                    );\n                    newCell.isSelected = true;\n                    return newCell;\n                }),\n                height: sourceRow.height,\n            });\n        }\n    }\n}\n","import { canMergeCells } from './canMergeCells';\nimport { getSelectedCells } from 'roosterjs-content-model-core';\nimport type { ContentModelTable } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function mergeTableCells(table: ContentModelTable) {\n    const sel = getSelectedCells(table);\n\n    if (\n        sel &&\n        canMergeCells(table.rows, sel.firstRow, sel.firstColumn, sel.lastRow, sel.lastColumn)\n    ) {\n        for (let rowIndex = sel.firstRow; rowIndex <= sel.lastRow; rowIndex++) {\n            for (let colIndex = sel.firstColumn; colIndex <= sel.lastColumn; colIndex++) {\n                const cell = table.rows[rowIndex].cells[colIndex];\n\n                if (cell) {\n                    cell.spanLeft = colIndex > sel.firstColumn;\n                    cell.spanAbove = rowIndex > sel.firstRow;\n\n                    delete cell.cachedElement;\n                }\n            }\n\n            delete table.rows[rowIndex].cachedElement;\n        }\n    }\n}\n","import { canMergeCells } from './canMergeCells';\nimport { getSelectedCells } from 'roosterjs-content-model-core';\nimport type {\n    ContentModelTable,\n    TableHorizontalMergeOperation,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function mergeTableColumn(\n    table: ContentModelTable,\n    operation: TableHorizontalMergeOperation\n) {\n    const sel = getSelectedCells(table);\n    const mergeLeft = operation == 'mergeLeft';\n\n    if (sel) {\n        const mergingColIndex = mergeLeft ? sel.firstColumn : sel.lastColumn + 1;\n\n        if (mergingColIndex > 0 && mergingColIndex < table.rows[0].cells.length) {\n            for (let rowIndex = sel.firstRow; rowIndex <= sel.lastRow; rowIndex++) {\n                const cell = table.rows[rowIndex]?.cells[mergingColIndex];\n\n                if (\n                    cell &&\n                    canMergeCells(\n                        table.rows,\n                        rowIndex,\n                        mergingColIndex - 1,\n                        rowIndex,\n                        mergingColIndex\n                    )\n                ) {\n                    cell.spanLeft = true;\n\n                    let newSelectedCol = mergingColIndex;\n\n                    while (table.rows[rowIndex]?.cells[newSelectedCol]?.spanLeft) {\n                        delete table.rows[rowIndex].cells[newSelectedCol].cachedElement;\n                        newSelectedCol--;\n                    }\n\n                    if (table.rows[rowIndex]?.cells[newSelectedCol]) {\n                        table.rows[rowIndex].cells[newSelectedCol].isSelected = true;\n\n                        delete table.rows[rowIndex].cells[newSelectedCol].cachedElement;\n                    }\n\n                    delete cell.cachedElement;\n                }\n\n                delete table.rows[rowIndex].cachedElement;\n            }\n        }\n    }\n}\n","import { canMergeCells } from './canMergeCells';\nimport { getSelectedCells } from 'roosterjs-content-model-core';\nimport type { ContentModelTable, TableVerticalMergeOperation } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function mergeTableRow(table: ContentModelTable, operation: TableVerticalMergeOperation) {\n    const sel = getSelectedCells(table);\n    const mergeAbove = operation == 'mergeAbove';\n\n    if (sel) {\n        const mergingRowIndex = mergeAbove ? sel.firstRow : sel.lastRow + 1;\n\n        if (mergingRowIndex > 0 && mergingRowIndex < table.rows.length) {\n            for (let colIndex = sel.firstColumn; colIndex <= sel.lastColumn; colIndex++) {\n                const cell = table.rows[mergingRowIndex].cells[colIndex];\n\n                if (\n                    cell &&\n                    canMergeCells(\n                        table.rows,\n                        mergingRowIndex - 1,\n                        colIndex,\n                        mergingRowIndex,\n                        colIndex\n                    )\n                ) {\n                    cell.spanAbove = true;\n\n                    let newSelectedRow = mergingRowIndex;\n\n                    while (table.rows[newSelectedRow]?.cells[colIndex]?.spanAbove) {\n                        delete table.rows[newSelectedRow].cells[colIndex].cachedElement;\n                        delete table.rows[newSelectedRow].cachedElement;\n                        newSelectedRow--;\n                    }\n\n                    if (table.rows[newSelectedRow]?.cells[colIndex]) {\n                        table.rows[newSelectedRow].cells[colIndex].isSelected = true;\n\n                        delete table.rows[newSelectedRow].cells[colIndex].cachedElement;\n                        delete table.rows[newSelectedRow].cachedElement;\n                    }\n\n                    delete cell.cachedElement;\n                }\n            }\n        }\n    }\n}\n","import { createTableCell } from 'roosterjs-content-model-dom';\nimport { getSelectedCells } from 'roosterjs-content-model-core';\nimport type { ContentModelTable } from 'roosterjs-content-model-types';\n\nconst MIN_WIDTH = 30;\n\n/**\n * @internal\n */\nexport function splitTableCellHorizontally(table: ContentModelTable) {\n    const sel = getSelectedCells(table);\n\n    if (sel) {\n        for (let colIndex = sel.lastColumn; colIndex >= sel.firstColumn; colIndex--) {\n            if (\n                table.rows.every(\n                    (row, rowIndex) =>\n                        rowIndex < sel.firstRow ||\n                        rowIndex > sel.lastRow ||\n                        row.cells[colIndex + 1]?.spanLeft\n                )\n            ) {\n                table.rows.forEach((row, rowIndex) => {\n                    delete row.cells[colIndex].cachedElement;\n\n                    if (rowIndex >= sel.firstRow && rowIndex <= sel.lastRow) {\n                        row.cells[colIndex + 1].spanLeft = false;\n                        delete row.cells[colIndex + 1].cachedElement;\n                    }\n                });\n            } else {\n                table.rows.forEach((row, rowIndex) => {\n                    const cell = row.cells[colIndex];\n                    if (cell) {\n                        const newCell = createTableCell(\n                            cell.spanLeft,\n                            cell.spanAbove,\n                            cell.isHeader,\n                            cell.format\n                        );\n\n                        newCell.dataset = { ...cell.dataset };\n\n                        if (rowIndex < sel.firstRow || rowIndex > sel.lastRow) {\n                            newCell.spanLeft = true;\n                        } else {\n                            newCell.isSelected = cell.isSelected;\n                        }\n                        row.cells.splice(colIndex + 1, 0, newCell);\n\n                        delete row.cells[colIndex].cachedElement;\n                    }\n                });\n\n                const newWidth = Math.max(table.widths[colIndex] / 2, MIN_WIDTH);\n\n                table.widths.splice(colIndex, 1, newWidth, newWidth);\n            }\n        }\n    }\n}\n","import { createTableCell } from 'roosterjs-content-model-dom';\nimport { getSelectedCells } from 'roosterjs-content-model-core';\nimport type { ContentModelTable, ContentModelTableRow } from 'roosterjs-content-model-types';\n\nconst MIN_HEIGHT = 22;\n\n/**\n * @internal\n */\nexport function splitTableCellVertically(table: ContentModelTable) {\n    const sel = getSelectedCells(table);\n\n    if (sel) {\n        for (let rowIndex = sel.lastRow; rowIndex >= sel.firstRow; rowIndex--) {\n            const row = table.rows[rowIndex];\n            const belowRow = table.rows[rowIndex + 1];\n\n            row.cells.forEach(cell => {\n                delete cell.cachedElement;\n            });\n\n            delete row.cachedElement;\n\n            if (\n                belowRow?.cells.every(\n                    (belowCell, colIndex) =>\n                        colIndex < sel.firstColumn ||\n                        colIndex > sel.lastColumn ||\n                        belowCell.spanAbove\n                )\n            ) {\n                belowRow.cells.forEach((belowCell, colIndex) => {\n                    if (colIndex >= sel.firstColumn && colIndex <= sel.lastColumn) {\n                        belowCell.spanAbove = false;\n                        delete belowCell.cachedElement;\n                    }\n                });\n\n                delete belowRow.cachedElement;\n            } else {\n                const newHeight = Math.max((row.height /= 2), MIN_HEIGHT);\n                const newRow: ContentModelTableRow = {\n                    format: { ...row.format },\n                    height: newHeight,\n                    cells: row.cells.map((cell, colIndex) => {\n                        const newCell = createTableCell(\n                            cell.spanLeft,\n                            cell.spanAbove,\n                            cell.isHeader,\n                            cell.format\n                        );\n\n                        newCell.dataset = { ...cell.dataset };\n\n                        if (colIndex < sel.firstColumn || colIndex > sel.lastColumn) {\n                            newCell.spanAbove = true;\n                        } else {\n                            newCell.isSelected = cell.isSelected;\n                        }\n\n                        return newCell;\n                    }),\n                };\n\n                row.height = newHeight;\n                table.rows.splice(rowIndex + 1, 0, newRow);\n            }\n        }\n    }\n}\n","import { setModelAlignment } from '../../modelApi/block/setModelAlignment';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Set text alignment of selected paragraphs\n * @param editor The editor to set alignment\n * @param alignment Alignment value: left, center or right\n */\nexport default function setAlignment(\n    editor: IEditor,\n    alignment: 'left' | 'center' | 'right' | 'justify'\n) {\n    editor.focus();\n\n    editor.formatContentModel(model => setModelAlignment(model, alignment), {\n        apiName: 'setAlignment',\n    });\n}\n","import { setModelDirection } from '../../modelApi/block/setModelDirection';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Set text direction of selected paragraphs (Left to right or Right to left)\n * @param editor The editor to set alignment\n * @param direction Direction value: ltr (Left to right) or rtl (Right to left)\n */\nexport default function setDirection(editor: IEditor, direction: 'ltr' | 'rtl') {\n    editor.focus();\n\n    editor.formatContentModel(model => setModelDirection(model, direction), {\n        apiName: 'setDirection',\n    });\n}\n","import { formatParagraphWithContentModel } from '../utils/formatParagraphWithContentModel';\nimport type { ContentModelParagraphDecorator, IEditor } from 'roosterjs-content-model-types';\n\ntype HeadingLevelTags = 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6';\n\nconst HeaderFontSizes: Record<HeadingLevelTags, string> = {\n    h1: '2em',\n    h2: '1.5em',\n    h3: '1.17em',\n    h4: '1em',\n    h5: '0.83em',\n    h6: '0.67em',\n};\n\n/**\n * Set heading level of selected paragraphs\n * @param editor The editor to set heading level to\n * @param headingLevel Level of heading, from 1 to 6. Set to 0 means set it back to a regular paragraph\n */\nexport default function setHeadingLevel(editor: IEditor, headingLevel: 0 | 1 | 2 | 3 | 4 | 5 | 6) {\n    editor.focus();\n\n    formatParagraphWithContentModel(editor, 'setHeadingLevel', para => {\n        const tagName =\n            headingLevel > 0\n                ? (('h' + headingLevel) as HeadingLevelTags | null)\n                : getExistingHeadingTag(para.decorator);\n\n        if (headingLevel > 0) {\n            para.decorator = {\n                tagName: tagName!,\n                format: tagName\n                    ? {\n                          fontWeight: 'bold',\n                          fontSize: HeaderFontSizes[tagName],\n                      }\n                    : {},\n            };\n\n            // Remove existing formats since tags have default font size and weight\n            para.segments.forEach(segment => {\n                delete segment.format.fontSize;\n                delete segment.format.fontWeight;\n            });\n        } else if (tagName) {\n            delete para.decorator;\n        }\n    });\n}\n\nfunction getExistingHeadingTag(\n    decorator?: ContentModelParagraphDecorator\n): HeadingLevelTags | null {\n    const tag = decorator?.tagName || '';\n    const level = parseInt(tag.substring(1));\n\n    return level >= 1 && level <= 6 ? (tag as HeadingLevelTags) : null;\n}\n","import { normalizeContentModel } from 'roosterjs-content-model-dom';\nimport { setModelIndentation } from '../../modelApi/block/setModelIndentation';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Indent or outdent to selected paragraphs\n * @param editor The editor to operate on\n * @param indentation Whether indent or outdent\n * @param length The length of pixel to indent/outdent @default 40\n */\nexport default function setIndentation(\n    editor: IEditor,\n    indentation: 'indent' | 'outdent',\n    length?: number\n) {\n    editor.focus();\n\n    editor.formatContentModel(\n        (model, context) => {\n            const result = setModelIndentation(model, indentation, length);\n\n            if (result) {\n                normalizeContentModel(model);\n            }\n\n            context.newPendingFormat = 'preserve';\n\n            return result;\n        },\n        {\n            apiName: 'setIndentation',\n        }\n    );\n}\n","import { createParagraphDecorator } from 'roosterjs-content-model-dom';\nimport { formatParagraphWithContentModel } from '../utils/formatParagraphWithContentModel';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Toggles the current block(s) margin properties.\n * null deletes any existing value, undefined is ignored\n * @param editor The editor to operate on\n * @param marginTop value for top margin\n * @param marginBottom value for bottom margin\n */\nexport default function setParagraphMargin(\n    editor: IEditor,\n    marginTop?: string | null,\n    marginBottom?: string | null\n) {\n    editor.focus();\n\n    formatParagraphWithContentModel(editor, 'setParagraphMargin', para => {\n        if (!para.decorator) {\n            para.decorator = createParagraphDecorator('p');\n        }\n\n        if (marginTop) {\n            para.format.marginTop = marginTop;\n        } else if (marginTop === null) {\n            delete para.format.marginTop;\n        }\n\n        if (marginBottom) {\n            para.format.marginBottom = marginBottom;\n        } else if (marginBottom === null) {\n            delete para.format.marginBottom;\n        }\n    });\n}\n","import { formatParagraphWithContentModel } from '../utils/formatParagraphWithContentModel';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Sets current selected block(s) line-height property and wipes such property from child segments\n * @param editor The editor to operate on\n * @param spacing Unitless/px value to set line height\n */\nexport default function setSpacing(editor: IEditor, spacing: number | string) {\n    editor.focus();\n\n    formatParagraphWithContentModel(editor, 'setSpacing', paragraph => {\n        paragraph.format.lineHeight = spacing.toString();\n        paragraph.segments.forEach(segment => {\n            if (segment.format.lineHeight) {\n                delete segment.format.lineHeight;\n            }\n        });\n    });\n}\n","import { toggleModelBlockQuote } from '../../modelApi/block/toggleModelBlockQuote';\nimport type { ContentModelFormatContainerFormat, IEditor } from 'roosterjs-content-model-types';\n\nconst DefaultQuoteFormatLtr: ContentModelFormatContainerFormat = {\n    borderLeft: '3px solid rgb(200, 200, 200)',\n    textColor: 'rgb(102, 102, 102)',\n};\nconst DefaultQuoteFormatRtl: ContentModelFormatContainerFormat = {\n    borderRight: '3px solid rgb(200, 200, 200)',\n    textColor: 'rgb(102, 102, 102)',\n};\nconst BuildInQuoteFormat: ContentModelFormatContainerFormat = {\n    marginTop: '1em',\n    marginBottom: '1em',\n    marginLeft: '40px',\n    marginRight: '40px',\n};\n\n/**\n * Toggle BLOCKQUOTE state of selected paragraphs.\n * If any selected paragraph is not under a BLOCKQUOTE, wrap them into a BLOCKQUOTE.\n * Otherwise, unwrap all related BLOCKQUOTEs.\n * @param editor The editor object to toggle BLOCKQUOTE onto\n * @param quoteFormat @optional Block format for the new quote object\n */\nexport default function toggleBlockQuote(\n    editor: IEditor,\n    quoteFormat?: ContentModelFormatContainerFormat,\n    quoteFormatRtl?: ContentModelFormatContainerFormat\n) {\n    const fullQuoteFormatLtr: ContentModelFormatContainerFormat = {\n        ...BuildInQuoteFormat,\n        paddingLeft: '10px',\n        ...(quoteFormat ?? DefaultQuoteFormatLtr),\n    };\n    const fullQuoteFormatRtl: ContentModelFormatContainerFormat = {\n        ...BuildInQuoteFormat,\n        paddingRight: '10px',\n        direction: 'rtl',\n        ...(quoteFormatRtl ?? quoteFormat ?? DefaultQuoteFormatRtl),\n    };\n\n    editor.focus();\n\n    editor.formatContentModel(\n        (model, context) => {\n            context.newPendingFormat = 'preserve';\n\n            return toggleModelBlockQuote(model, fullQuoteFormatLtr, fullQuoteFormatRtl);\n        },\n        {\n            apiName: 'toggleBlockQuote',\n        }\n    );\n}\n","import { ChangeSource } from 'roosterjs-content-model-core';\nimport { insertEntityModel } from '../../modelApi/entity/insertEntityModel';\nimport {\n    createEntity,\n    normalizeContentModel,\n    parseEntityFormat,\n} from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelEntity,\n    DOMSelection,\n    InsertEntityPosition,\n    InsertEntityOptions,\n    IEditor,\n    EntityState,\n} from 'roosterjs-content-model-types';\n\nconst BlockEntityTag = 'div';\nconst InlineEntityTag = 'span';\n\n/**\n * Insert an entity into editor\n * @param editor The editor object\n * @param type Type of entity\n * @param isBlock True to insert a block entity, false to insert an inline entity\n * @param position Position of the entity to insert. It can be\n * Value of InsertEntityPosition: see InsertEntityPosition\n * selectionRangeEx: Use this range instead of current focus position to insert. After insert, focus will be moved to\n * the beginning of this range (when focusAfterEntity is not set to true) or after the new entity (when focusAfterEntity is set to true)\n * @param options Move options to insert. See InsertEntityOptions\n */\nexport default function insertEntity(\n    editor: IEditor,\n    type: string,\n    isBlock: boolean,\n    position: 'focus' | 'begin' | 'end' | DOMSelection,\n    options?: InsertEntityOptions\n): ContentModelEntity | null;\n\n/**\n * Insert a block entity into editor\n * @param editor The editor object\n * @param type Type of entity\n * @param isBlock Must be true for a block entity\n * @param position Position of the entity to insert. It can be\n * Value of InsertEntityPosition: see InsertEntityPosition\n * selectionRangeEx: Use this range instead of current focus position to insert. After insert, focus will be moved to\n * the beginning of this range (when focusAfterEntity is not set to true) or after the new entity (when focusAfterEntity is set to true)\n * @param options Move options to insert. See InsertEntityOptions\n */\nexport default function insertEntity(\n    editor: IEditor,\n    type: string,\n    isBlock: true,\n    position: InsertEntityPosition | DOMSelection,\n    options?: InsertEntityOptions\n): ContentModelEntity | null;\n\nexport default function insertEntity(\n    editor: IEditor,\n    type: string,\n    isBlock: boolean,\n    position?: InsertEntityPosition | DOMSelection,\n    options?: InsertEntityOptions\n): ContentModelEntity | null {\n    const { contentNode, focusAfterEntity, wrapperDisplay, skipUndoSnapshot, initialEntityState } =\n        options || {};\n    const document = editor.getDocument();\n    const wrapper = document.createElement(isBlock ? BlockEntityTag : InlineEntityTag);\n    const display = wrapperDisplay ?? (isBlock ? undefined : 'inline-block');\n\n    wrapper.style.setProperty('display', display || null);\n\n    if (display == undefined && isBlock) {\n        wrapper.style.setProperty('width', '100%');\n        wrapper.style.setProperty('display', 'inline-block');\n    }\n\n    if (contentNode) {\n        wrapper.appendChild(contentNode);\n    }\n\n    const entityModel = createEntity(wrapper, true /* isReadonly */, undefined /*format*/, type);\n\n    if (!skipUndoSnapshot) {\n        editor.takeSnapshot();\n    }\n\n    editor.formatContentModel(\n        (model, context) => {\n            insertEntityModel(\n                model,\n                entityModel,\n                typeof position == 'string' ? position : 'focus',\n                isBlock,\n                focusAfterEntity,\n                context\n            );\n\n            normalizeContentModel(model);\n\n            context.skipUndoSnapshot = true;\n            context.newEntities.push(entityModel);\n\n            return true;\n        },\n        {\n            selectionOverride: typeof position === 'object' ? position : undefined,\n            changeSource: ChangeSource.InsertEntity,\n            getChangeData: () => ({\n                wrapper,\n                type,\n                id: '',\n                isReadonly: true,\n            }),\n            apiName: 'insertEntity',\n        }\n    );\n\n    if (!skipUndoSnapshot) {\n        let entityState: EntityState | undefined;\n\n        if (initialEntityState) {\n            const format = parseEntityFormat(wrapper);\n            const { id, entityType } = format;\n\n            entityState =\n                id && entityType\n                    ? {\n                          id: id,\n                          type: entityType,\n                          state: initialEntityState,\n                      }\n                    : undefined;\n        }\n\n        editor.takeSnapshot(entityState);\n    }\n\n    return entityModel;\n}\n","import { clearModelFormat } from '../../modelApi/common/clearModelFormat';\nimport { normalizeContentModel } from 'roosterjs-content-model-dom';\nimport type {\n    IEditor,\n    ContentModelBlock,\n    ContentModelBlockGroup,\n    ContentModelSegment,\n    ContentModelTable,\n} from 'roosterjs-content-model-types';\n\n/**\n * Clear format of selection\n * @param editor The editor to clear format from\n */\nexport default function clearFormat(editor: IEditor) {\n    editor.focus();\n\n    editor.formatContentModel(\n        model => {\n            const blocksToClear: [ContentModelBlockGroup[], ContentModelBlock][] = [];\n            const segmentsToClear: ContentModelSegment[] = [];\n            const tablesToClear: [ContentModelTable, boolean][] = [];\n\n            clearModelFormat(model, blocksToClear, segmentsToClear, tablesToClear);\n\n            normalizeContentModel(model);\n\n            return (\n                blocksToClear.length > 0 || segmentsToClear.length > 0 || tablesToClear.length > 0\n            );\n        },\n        {\n            apiName: 'clearFormat',\n        }\n    );\n}\n","import { retrieveModelFormatState } from 'roosterjs-content-model-core';\nimport type { IEditor, ContentModelFormatState } from 'roosterjs-content-model-types';\n\n/**\n * Get current format state\n * @param editor The editor to get format from\n */\nexport default function getFormatState(editor: IEditor): ContentModelFormatState {\n    const pendingFormat = editor.getPendingFormat();\n    const model = editor.getContentModelCopy('reduced');\n    const manager = editor.getSnapshotsManager();\n    const result: ContentModelFormatState = {\n        canUndo: manager.hasNewContent || manager.canMove(-1),\n        canRedo: manager.canMove(1),\n        isDarkMode: editor.isDarkMode(),\n    };\n\n    retrieveModelFormatState(model, pendingFormat, result);\n\n    return result;\n}\n","import { adjustSegmentSelection } from '../../modelApi/selection/adjustSegmentSelection';\nimport type { ContentModelImage, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Adjust selection to make sure select an image if any\n * @return Content Model Image object if an image is select, or null\n */\nexport default function adjustImageSelection(editor: IEditor): ContentModelImage | null {\n    let image: ContentModelImage | null = null;\n\n    editor.formatContentModel(\n        model =>\n            adjustSegmentSelection(\n                model,\n                target => {\n                    if (target.isSelected && target.segmentType == 'Image') {\n                        image = target;\n                        return true;\n                    } else {\n                        return false;\n                    }\n                },\n                (target, ref) => target == ref\n            ),\n        {\n            apiName: 'adjustImageSelection',\n        }\n    );\n\n    return image;\n}\n","import formatImageWithContentModel from '../utils/formatImageWithContentModel';\nimport { readFile, updateImageMetadata } from 'roosterjs-content-model-core';\nimport type { ContentModelImage, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Change the selected image src\n * @param editor The editor instance\n * @param file The image file\n */\nexport default function changeImage(editor: IEditor, file: File) {\n    editor.focus();\n\n    const selection = editor.getDOMSelection();\n    readFile(file, dataUrl => {\n        if (dataUrl && !editor.isDisposed() && selection?.type === 'image') {\n            formatImageWithContentModel(editor, 'changeImage', (image: ContentModelImage) => {\n                const originalSrc = updateImageMetadata(image)?.src ?? '';\n                const previousSrc = image.src;\n\n                image.src = dataUrl;\n                image.dataset = {};\n                image.format.width = '';\n                image.format.height = '';\n                image.alt = '';\n\n                editor.triggerEvent('editImage', {\n                    image: selection.image,\n                    previousSrc,\n                    newSrc: dataUrl,\n                    originalSrc,\n                });\n            });\n        }\n    });\n}\n","import { addSegment, createContentModelDocument, createImage } from 'roosterjs-content-model-dom';\nimport { mergeModel, readFile } from 'roosterjs-content-model-core';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Insert an image into current selected position\n * @param editor The editor to operate on\n * @param file Image Blob file or source string\n */\nexport default function insertImage(editor: IEditor, imageFileOrSrc: File | string) {\n    editor.focus();\n\n    if (typeof imageFileOrSrc == 'string') {\n        insertImageWithSrc(editor, imageFileOrSrc);\n    } else {\n        readFile(imageFileOrSrc, dataUrl => {\n            if (dataUrl && !editor.isDisposed()) {\n                insertImageWithSrc(editor, dataUrl);\n            }\n        });\n    }\n}\n\nfunction insertImageWithSrc(editor: IEditor, src: string) {\n    editor.formatContentModel(\n        (model, context) => {\n            const image = createImage(src, { backgroundColor: '' });\n            const doc = createContentModelDocument();\n\n            addSegment(doc, image);\n            mergeModel(model, doc, context, {\n                mergeFormat: 'mergeAll',\n            });\n\n            return true;\n        },\n        {\n            apiName: 'insertImage',\n        }\n    );\n}\n","import formatImageWithContentModel from '../utils/formatImageWithContentModel';\nimport type { ContentModelImage, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Set image alt text for all selected images at selection. If no images is contained\n * in selection, do nothing.\n * @param editor The editor instance\n * @param altText The image alt text\n */\nexport default function setImageAltText(editor: IEditor, altText: string) {\n    editor.focus();\n\n    formatImageWithContentModel(editor, 'setImageAltText', (image: ContentModelImage) => {\n        image.alt = altText;\n    });\n}\n","import applyImageBorderFormat from '../../modelApi/image/applyImageBorderFormat';\nimport formatImageWithContentModel from '../utils/formatImageWithContentModel';\nimport type { Border, ContentModelImage, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Set image border style for all selected images at selection.\n * @param editor The editor instance\n * @param border the border format object. Ex: { color: 'red', width: '10px', style: 'solid'}, if one of the value in object is undefined\n * its value will not be changed. Passing null instead of an object will remove the border\n * @param borderRadius the border radius value, if undefined, the border radius will keep the actual value\n */\nexport default function setImageBorder(\n    editor: IEditor,\n    border: Border | null,\n    borderRadius?: string\n) {\n    editor.focus();\n\n    formatImageWithContentModel(editor, 'setImageBorder', (image: ContentModelImage) => {\n        applyImageBorderFormat(image, border, borderRadius);\n    });\n}\n","import formatImageWithContentModel from '../utils/formatImageWithContentModel';\nimport type { ContentModelImage, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Set image box shadow for all selected images at selection.\n * @param editor The editor instance\n * @param boxShadow The image box boxShadow\n * @param margin The image margin for all sides (eg. \"4px\"), null to remove margin\n */\nexport default function setImageBoxShadow(\n    editor: IEditor,\n    boxShadow: string,\n    margin?: string | null\n) {\n    editor.focus();\n\n    formatImageWithContentModel(editor, 'setImageBoxShadow', (image: ContentModelImage) => {\n        image.format.boxShadow = boxShadow;\n        if (margin) {\n            image.format.marginBottom = margin;\n            image.format.marginLeft = margin;\n            image.format.marginRight = margin;\n            image.format.marginTop = margin;\n        } else if (margin === null) {\n            delete image.format.marginBottom;\n            delete image.format.marginLeft;\n            delete image.format.marginRight;\n            delete image.format.marginTop;\n        }\n    });\n}\n","import { adjustSegmentSelection } from '../../modelApi/selection/adjustSegmentSelection';\nimport { adjustWordSelection } from '../../modelApi/selection/adjustWordSelection';\nimport { getSelectedSegments, setSelection } from 'roosterjs-content-model-core';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Adjust selection to make sure select a hyperlink if any, or a word if original selection is collapsed\n * @return A combination of existing link display text and url if any. If there is no existing link, return selected text and null\n */\nexport default function adjustLinkSelection(editor: IEditor): [string, string | null] {\n    let text = '';\n    let url: string | null = null;\n\n    editor.formatContentModel(\n        model => {\n            let changed = adjustSegmentSelection(\n                model,\n                target => !!target.isSelected && !!target.link,\n                (target, ref) => !!target.link && target.link.format.href == ref.link!.format.href\n            );\n            let segments = getSelectedSegments(model, false /*includingFormatHolder*/);\n            const firstSegment = segments[0];\n\n            if (segments.length == 1 && firstSegment.segmentType == 'SelectionMarker') {\n                segments = adjustWordSelection(model, firstSegment);\n\n                if (segments.length > 1) {\n                    changed = true;\n                    setSelection(model, segments[0], segments[segments.length - 1]);\n                }\n            }\n\n            text = segments.map(x => (x.segmentType == 'Text' ? x.text : '')).join('');\n            url = segments[0]?.link?.format.href || null;\n\n            return changed;\n        },\n        {\n            apiName: 'adjustLinkSelection',\n        }\n    );\n\n    return [text, url];\n}\n","import { adjustTrailingSpaceSelection } from '../../modelApi/selection/adjustTrailingSpaceSelection';\nimport { ChangeSource, getSelectedSegments, mergeModel } from 'roosterjs-content-model-core';\nimport { matchLink } from '../../modelApi/link/matchLink';\nimport type { ContentModelLink, IEditor } from 'roosterjs-content-model-types';\nimport {\n    addLink,\n    addSegment,\n    createContentModelDocument,\n    createText,\n} from 'roosterjs-content-model-dom';\n\n// Regex matching Uri scheme\nconst URI_REGEX = /^[a-zA-Z]+:/i;\n// Regex matching begin of email address\nconst MAILTO_REGEX = /^[\\w.%+-]+@/i;\n// Regex matching begin of ftp, i.e. ftp.microsoft.com\nconst FTP_REGEX = /^ftp\\./i;\n\n/**\n * Insert a hyperlink at cursor.\n * When there is a selection, hyperlink will be applied to the selection,\n * otherwise a hyperlink will be inserted to the cursor position.\n * @param editor Editor object\n * @param link Link address, can be http(s), mailto, notes, file, unc, ftp, news, telnet, gopher, wais.\n * When protocol is not specified, a best matched protocol will be predicted.\n * @param anchorTitle Optional alt text of the link, will be shown when hover on the link\n * @param displayText Optional display text for the link.\n * @param target Optional display target for the link (\"_blank\"|\"_self\"|\"_parent\"|\"_top\"|\"{framename}\")\n * If specified, the display text of link will be replaced with this text.\n * If not specified and there wasn't a link, the link url will be used as display text.\n */\nexport default function insertLink(\n    editor: IEditor,\n    link: string,\n    anchorTitle?: string,\n    displayText?: string,\n    target?: string\n) {\n    editor.focus();\n\n    const url = (checkXss(link) || '').trim();\n    if (url) {\n        const linkData = matchLink(url);\n        const linkUrl = linkData ? linkData.normalizedUrl : applyLinkPrefix(url);\n        const links: ContentModelLink[] = [];\n        let anchorNode: Node | undefined;\n\n        editor.formatContentModel(\n            (model, context) => {\n                const segments = getSelectedSegments(model, false /*includingFormatHolder*/);\n                const originalText = segments\n                    .map(x => (x.segmentType == 'Text' ? x.text : ''))\n                    .join('');\n                const text = displayText || originalText || '';\n\n                if (\n                    segments.some(x => x.segmentType != 'SelectionMarker') &&\n                    originalText == text\n                ) {\n                    segments.forEach(x => {\n                        const link = createLink(\n                            linkUrl,\n                            anchorTitle,\n                            target,\n                            x.segmentType == 'Text'\n                        );\n                        addLink(x, link);\n                        if (x.link) {\n                            links.push(x.link);\n                        }\n                    });\n                } else if (\n                    segments.every(x => x.segmentType == 'SelectionMarker') ||\n                    (!!text && text != originalText)\n                ) {\n                    const segment = createText(text || (linkData ? linkData.originalUrl : url), {\n                        ...segments[0]?.format,\n                        ...editor.getPendingFormat(),\n                    });\n                    const doc = createContentModelDocument();\n                    const link = createLink(linkUrl, anchorTitle, target);\n\n                    addLink(segment, link);\n                    addSegment(doc, segment);\n\n                    if (segment.link) {\n                        links.push(segment.link);\n                    }\n\n                    mergeModel(model, doc, context, {\n                        mergeFormat: 'mergeAll',\n                    });\n                }\n\n                adjustTrailingSpaceSelection(model);\n                return segments.length > 0;\n            },\n            {\n                changeSource: ChangeSource.CreateLink,\n                onNodeCreated: (modelElement, node) => {\n                    if (!anchorNode && links.indexOf(modelElement as ContentModelLink) >= 0) {\n                        anchorNode = node;\n                    }\n                },\n                getChangeData: () => anchorNode,\n                apiName: 'insertLink',\n            }\n        );\n    }\n}\n\nconst createLink = (\n    url: string,\n    anchorTitle?: string,\n    target?: string,\n    underline: boolean = true\n): ContentModelLink => {\n    return {\n        dataset: {},\n        format: {\n            href: url,\n            anchorTitle,\n            target,\n            underline: underline,\n        },\n    };\n};\n\nfunction applyLinkPrefix(url: string): string {\n    if (!url) {\n        return url;\n    }\n\n    // Add link prefix per rule:\n    // (a) if the url always starts with a URI scheme, leave it as it is\n    // (b) if the url is an email address, xxx@... add mailto: prefix\n    // (c) if the url starts with ftp., add ftp:// prefix\n    // (d) rest, add http:// prefix\n    let prefix = '';\n    if (url.search(URI_REGEX) < 0) {\n        if (url.search(MAILTO_REGEX) == 0) {\n            prefix = 'mailto:';\n        } else if (url.search(FTP_REGEX) == 0) {\n            prefix = 'ftp://';\n        } else {\n            // fallback to http://\n            prefix = 'http://';\n        }\n    }\n\n    return prefix + url;\n}\n\nfunction checkXss(link: string): string {\n    return link.match(/s\\n*c\\n*r\\n*i\\n*p\\n*t\\n*:/i) ? '' : link;\n}\n","import { adjustSegmentSelection } from '../../modelApi/selection/adjustSegmentSelection';\nimport { getSelectedSegments } from 'roosterjs-content-model-core';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Remove link at selection. If no links at selection, do nothing.\n * If selection contains multiple links, all of the link styles will be removed.\n * If only part of a link is selected, the whole link style will be removed.\n * @param editor The editor instance\n */\nexport default function removeLink(editor: IEditor) {\n    editor.focus();\n\n    editor.formatContentModel(\n        model => {\n            adjustSegmentSelection(\n                model,\n                target => !!target.isSelected && !!target.link,\n                (target, ref) =>\n                    target.isSelected || // Expand the selection to any link that is involved. So we can remove multiple links together\n                    (!!target.link && target.link.format.href == ref.link!.format.href)\n            );\n\n            const segments = getSelectedSegments(model, false /*includingFormatHolder*/);\n            let isChanged = false;\n\n            segments.forEach(segment => {\n                if (segment.link) {\n                    isChanged = true;\n\n                    delete segment.link;\n                }\n            });\n\n            return isChanged;\n        },\n        {\n            apiName: 'removeLink',\n        }\n    );\n}\n","import { getFirstSelectedListItem } from 'roosterjs-content-model-core';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Set start number of a list item\n * @param editor The editor to operate on\n * @param value The number to set to, must be equal or greater than 1\n */\nexport default function setListStartNumber(editor: IEditor, value: number) {\n    editor.focus();\n\n    editor.formatContentModel(\n        model => {\n            const listItem = getFirstSelectedListItem(model);\n            const level = listItem?.levels[listItem?.levels.length - 1];\n\n            if (level) {\n                level.format.startNumberOverride = value;\n\n                return true;\n            } else {\n                return false;\n            }\n        },\n        {\n            apiName: 'setListStartNumber',\n        }\n    );\n}\n","import { findListItemsInSameThread } from '../../modelApi/list/findListItemsInSameThread';\nimport { getFirstSelectedListItem, updateListMetadata } from 'roosterjs-content-model-core';\nimport type { IEditor, ListMetadataFormat } from 'roosterjs-content-model-types';\n\n/**\n * Set style of list items with in same thread of current item\n * @param editor The editor to operate on\n * @param style The target list item style to set\n */\nexport default function setListStyle(editor: IEditor, style: ListMetadataFormat) {\n    editor.focus();\n\n    editor.formatContentModel(\n        model => {\n            const listItem = getFirstSelectedListItem(model);\n\n            if (listItem) {\n                const listItems = findListItemsInSameThread(model, listItem);\n                const levelIndex = listItem.levels.length - 1;\n\n                listItems.forEach(listItem => {\n                    const level = listItem.levels[levelIndex];\n\n                    if (level) {\n                        updateListMetadata(level, metadata => Object.assign({}, metadata, style));\n                    }\n                });\n\n                return true;\n            } else {\n                return false;\n            }\n        },\n        {\n            apiName: 'setListStyle',\n        }\n    );\n}\n","import { setListType } from '../../modelApi/list/setListType';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Toggle bullet list type\n * - When there are some blocks not in bullet list, set all blocks to the given type\n * - When all blocks are already in bullet list, turn off / outdent there list type\n * @param editor The editor to operate on\n * @param removeMargins true to remove margins, false to keep margins @default false\n */\nexport default function toggleBullet(editor: IEditor, removeMargins: boolean = false) {\n    editor.focus();\n\n    editor.formatContentModel(\n        (model, context) => {\n            context.newPendingFormat = 'preserve';\n\n            return setListType(model, 'UL', removeMargins);\n        },\n        {\n            apiName: 'toggleBullet',\n        }\n    );\n}\n","import { setListType } from '../../modelApi/list/setListType';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Toggle numbering list type\n * - When there are some blocks not in numbering list, set all blocks to the given type\n * - When all blocks are already in numbering list, turn off / outdent there list type\n * @param editor The editor to operate on\n * @param removeMargins true to remove margins, false to keep margins @default false\n */\nexport default function toggleNumbering(editor: IEditor, removeMargins: boolean = false) {\n    editor.focus();\n\n    editor.formatContentModel(\n        (model, context) => {\n            context.newPendingFormat = 'preserve';\n\n            return setListType(model, 'OL', removeMargins);\n        },\n        {\n            apiName: 'toggleNumbering',\n        }\n    );\n}\n","import { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport type { ContentModelSegmentFormat, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Bulk apply segment format to all selected content. This is usually used for format painter.\n * @param editor The editor to operate on\n * @param newFormat The segment format to apply\n */\nexport default function applySegmentFormat(editor: IEditor, newFormat: ContentModelSegmentFormat) {\n    formatSegmentWithContentModel(\n        editor,\n        'applySegmentFormat',\n        format => {\n            format.backgroundColor = newFormat.backgroundColor;\n            format.fontFamily = newFormat.fontFamily;\n            format.fontSize = newFormat.fontSize;\n            format.fontWeight = newFormat.fontWeight;\n            format.italic = newFormat.italic;\n            format.strikethrough = newFormat.strikethrough;\n            format.superOrSubScriptSequence = newFormat.superOrSubScriptSequence;\n            format.textColor = newFormat.textColor;\n            format.underline = newFormat.underline;\n        },\n        undefined /* segmentHasStyleCallback*/,\n        true /*includingFormatHandler*/\n    );\n}\n","import { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Change the capitalization of text in the selection\n * @param editor The editor instance\n * @param capitalization The case option\n * @param language Optional parameter for language string that should comply to \"IETF BCP 47 Tags for\n * Identifying Languages\". For example: 'en' or 'en-US' for English, 'tr' for Turkish.\n * Default is the host environments current locale.\n */\nexport default function changeCapitalization(\n    editor: IEditor,\n    capitalization: 'sentence' | 'lowerCase' | 'upperCase' | 'capitalize',\n    language?: string\n) {\n    editor.focus();\n\n    formatSegmentWithContentModel(editor, 'changeCapitalization', (_, __, segment) => {\n        if (segment?.segmentType == 'Text') {\n            switch (capitalization) {\n                case 'lowerCase':\n                    segment.text = segment.text.toLocaleLowerCase(language);\n                    break;\n\n                case 'upperCase':\n                    segment.text = segment.text.toLocaleUpperCase(language);\n                    break;\n\n                case 'capitalize':\n                    const wordArray = segment.text.toLocaleLowerCase(language).split(' ');\n\n                    for (let i = 0; i < wordArray.length; i++) {\n                        wordArray[i] =\n                            wordArray[i].charAt(0).toLocaleUpperCase(language) +\n                            wordArray[i].slice(1);\n                    }\n\n                    segment.text = wordArray.join(' ');\n                    break;\n\n                case 'sentence':\n                    const punctuationMarks = '[\\\\.\\\\!\\\\?]';\n                    // Find a match of a word character either:\n                    // - At the beginning of a string with or without preceding whitespace, for\n                    // example: '  hello world' and 'hello world' strings would both match 'h'.\n                    // - Or preceded by a punctuation mark and at least one whitespace, for\n                    // example 'yes. hello world' would match 'y' and 'h'.\n                    const regex = new RegExp('^\\\\s*\\\\w|' + punctuationMarks + '\\\\s+\\\\w', 'g');\n\n                    segment.text = segment.text\n                        .toLocaleLowerCase(language)\n                        .replace(regex, match => match.toLocaleUpperCase(language));\n                    break;\n            }\n        }\n    });\n}\n","import { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport { parseValueWithUnit } from 'roosterjs-content-model-dom';\nimport { setFontSizeInternal } from './setFontSize';\nimport type {\n    ContentModelParagraph,\n    ContentModelSegmentFormat,\n    IEditor,\n} from 'roosterjs-content-model-types';\n\n/**\n * Default font size sequence, in pt. Suggest editor UI use this sequence as your font size list,\n * So that when increase/decrease font size, the font size can match the sequence of your font size picker\n */\nconst FONT_SIZES = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72];\nconst MIN_FONT_SIZE = 1;\nconst MAX_FONT_SIZE = 1000;\n\n/**\n * Increase or decrease font size in selection\n * @param editor The editor instance\n * @param change Whether increase or decrease font size\n * @param fontSizes A sorted font size array, in pt. Default value is FONT_SIZES\n */\nexport default function changeFontSize(editor: IEditor, change: 'increase' | 'decrease') {\n    editor.focus();\n\n    formatSegmentWithContentModel(\n        editor,\n        'changeFontSize',\n        (format, _, __, paragraph) => changeFontSizeInternal(change, format, paragraph),\n        undefined /* segmentHasStyleCallback*/,\n        true /*includingFormatHandler*/\n    );\n}\n\nfunction changeFontSizeInternal(\n    change: 'increase' | 'decrease',\n    format: ContentModelSegmentFormat,\n    paragraph: ContentModelParagraph | null\n) {\n    if (format.fontSize) {\n        const sizeInPt = parseValueWithUnit(format.fontSize, undefined /*element*/, 'pt');\n\n        if (sizeInPt > 0) {\n            const newSize = getNewFontSize(sizeInPt, change == 'increase' ? 1 : -1, FONT_SIZES);\n\n            setFontSizeInternal(newSize + 'pt', format, paragraph);\n        }\n    }\n}\n\nfunction getNewFontSize(pt: number, changeBase: 1 | -1, fontSizes: number[]): number {\n    pt = changeBase == 1 ? Math.floor(pt) : Math.ceil(pt);\n    const last = fontSizes[fontSizes.length - 1];\n    if (pt <= fontSizes[0]) {\n        pt = Math.max(pt + changeBase, MIN_FONT_SIZE);\n    } else if (pt > last || (pt == last && changeBase == 1)) {\n        pt = pt / 10;\n        pt = changeBase == 1 ? Math.floor(pt) : Math.ceil(pt);\n        pt = Math.min(Math.max((pt + changeBase) * 10, last), MAX_FONT_SIZE);\n    } else if (changeBase == 1) {\n        for (let i = 0; i < fontSizes.length; i++) {\n            if (pt < fontSizes[i]) {\n                pt = fontSizes[i];\n                break;\n            }\n        }\n    } else {\n        for (let i = fontSizes.length - 1; i >= 0; i--) {\n            if (pt > fontSizes[i]) {\n                pt = fontSizes[i];\n                break;\n            }\n        }\n    }\n    return pt;\n}\n","import { createSelectionMarker } from 'roosterjs-content-model-dom';\nimport { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport { setSelection } from 'roosterjs-content-model-core';\nimport type { ContentModelParagraph, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Set background color\n * @param editor The editor to operate on\n * @param backgroundColor The color to set. Pass null to remove existing color.\n */\nexport default function setBackgroundColor(editor: IEditor, backgroundColor: string | null) {\n    editor.focus();\n\n    let lastParagraph: ContentModelParagraph | null = null;\n    let lastSegmentIndex: number = -1;\n\n    formatSegmentWithContentModel(\n        editor,\n        'setBackgroundColor',\n        (format, _, segment, paragraph) => {\n            if (backgroundColor === null) {\n                delete format.backgroundColor;\n            } else {\n                format.backgroundColor = backgroundColor;\n            }\n\n            if (segment && paragraph && segment.segmentType != 'SelectionMarker') {\n                lastParagraph = paragraph;\n                lastSegmentIndex = lastParagraph.segments.indexOf(segment);\n            }\n        },\n        undefined /*segmentHasStyleCallback*/,\n        undefined /*includingFormatHolder*/,\n        model => {\n            if (lastParagraph && lastSegmentIndex >= 0) {\n                const marker = createSelectionMarker(\n                    lastParagraph.segments[lastSegmentIndex]?.format\n                );\n\n                lastParagraph.segments.splice(lastSegmentIndex + 1, 0, marker);\n                setSelection(model, marker, marker);\n            }\n        }\n    );\n}\n","import { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Set font name\n * @param editor The editor to operate on\n * @param fontName The font name to set\n */\nexport default function setFontName(editor: IEditor, fontName: string) {\n    editor.focus();\n\n    formatSegmentWithContentModel(\n        editor,\n        'setFontName',\n        (format, _, segment) => {\n            format.fontFamily = fontName;\n\n            if (segment?.code) {\n                segment.code.format.fontFamily = fontName;\n            }\n        },\n        undefined /* segmentHasStyleCallback*/,\n        true /*includingFormatHandler*/\n    );\n}\n","import { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport type {\n    ContentModelParagraph,\n    ContentModelSegmentFormat,\n    IEditor,\n} from 'roosterjs-content-model-types';\n\n/**\n * Set font size\n * @param editor The editor to operate on\n * @param fontSize The font size to set\n */\nexport default function setFontSize(editor: IEditor, fontSize: string) {\n    editor.focus();\n\n    formatSegmentWithContentModel(\n        editor,\n        'setFontSize',\n        (format, _, __, paragraph) => setFontSizeInternal(fontSize, format, paragraph),\n        undefined /* segmentHasStyleCallback*/,\n        true /*includingFormatHandler*/\n    );\n}\n\n/**\n * @internal\n * Internal set font function shared by setFontSize and changeFontSize\n */\nexport function setFontSizeInternal(\n    fontSize: string,\n    format: ContentModelSegmentFormat,\n    paragraph: ContentModelParagraph | null\n) {\n    format.fontSize = fontSize;\n\n    // Since we have set font size to segment, it can be smaller than the one in paragraph format, so delete font size from paragraph\n    if (paragraph?.segmentFormat?.fontSize) {\n        const size = paragraph.segmentFormat.fontSize;\n\n        paragraph.segments.forEach(segment => {\n            if (!segment.format.fontSize) {\n                segment.format.fontSize = size;\n            }\n        });\n\n        delete paragraph.segmentFormat.fontSize;\n    }\n}\n","import { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Set text color\n * @param editor The editor to operate on\n * @param textColor The text color to set. Pass null to remove existing color.\n */\nexport default function setTextColor(editor: IEditor, textColor: string | null) {\n    editor.focus();\n\n    formatSegmentWithContentModel(\n        editor,\n        'setTextColor',\n        textColor === null\n            ? (format, _, segment) => {\n                  delete format.textColor;\n\n                  if (segment?.link) {\n                      delete segment.link.format.textColor;\n                  }\n              }\n            : (format, _, segment) => {\n                  format.textColor = textColor;\n\n                  if (segment?.link) {\n                      segment.link.format.textColor = textColor;\n                  }\n              },\n        undefined /* segmentHasStyleCallback*/,\n        true /*includingFormatHandler*/\n    );\n}\n","import { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport { isBold } from 'roosterjs-content-model-core';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Toggle bold style\n * @param editor The editor to operate on\n */\nexport default function toggleBold(editor: IEditor) {\n    editor.focus();\n\n    formatSegmentWithContentModel(\n        editor,\n        'toggleBold',\n        (format, isTurningOn) => {\n            format.fontWeight = isTurningOn ? 'bold' : 'normal';\n        },\n        (format, _, paragraph) =>\n            isBold(\n                typeof format.fontWeight == 'undefined'\n                    ? paragraph?.decorator?.format.fontWeight\n                    : format.fontWeight\n            )\n    );\n}\n","import { addCode } from 'roosterjs-content-model-dom';\nimport { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport type { ContentModelCode, IEditor } from 'roosterjs-content-model-types';\n\nconst DefaultCode: ContentModelCode = {\n    format: {\n        fontFamily: 'monospace',\n    },\n};\n\n/**\n * Toggle italic style\n * @param editor The editor to operate on\n */\nexport default function toggleCode(editor: IEditor) {\n    editor.focus();\n\n    formatSegmentWithContentModel(\n        editor,\n        'toggleCode',\n        (_, isTurningOn, segment) => {\n            if (segment) {\n                if (isTurningOn) {\n                    addCode(segment, DefaultCode);\n                } else {\n                    delete segment.code;\n                }\n            }\n        },\n        (_, segment) => !!segment?.code\n    );\n}\n","import { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Toggle italic style\n * @param editor The editor to operate on\n */\nexport default function toggleItalic(editor: IEditor) {\n    editor.focus();\n\n    formatSegmentWithContentModel(\n        editor,\n        'toggleItalic',\n        (format, isTurningOn) => {\n            format.italic = !!isTurningOn;\n        },\n        format => !!format.italic\n    );\n}\n","import { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Toggle strikethrough style\n * @param editor The editor to operate on\n */\nexport default function toggleStrikethrough(editor: IEditor) {\n    editor.focus();\n\n    formatSegmentWithContentModel(\n        editor,\n        'toggleStrikethrough',\n        (format, isTurningOn) => {\n            format.strikethrough = !!isTurningOn;\n        },\n        format => !!format.strikethrough\n    );\n}\n","import { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Toggle subscript style\n * @param editor The editor to operate on\n */\nexport default function toggleSubscript(editor: IEditor) {\n    editor.focus();\n\n    formatSegmentWithContentModel(\n        editor,\n        'toggleSubscript',\n        (format, isTurningOn) => {\n            format.superOrSubScriptSequence = isTurningOn ? 'sub' : '';\n        },\n        format => format.superOrSubScriptSequence?.split(' ').pop() == 'sub'\n    );\n}\n","import { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Toggle superscript style\n * @param editor The editor to operate on\n */\nexport default function toggleSuperscript(editor: IEditor) {\n    editor.focus();\n\n    formatSegmentWithContentModel(\n        editor,\n        'toggleSuperscript',\n        (format, isTurningOn) => {\n            format.superOrSubScriptSequence = isTurningOn ? 'super' : '';\n        },\n        format => format.superOrSubScriptSequence?.split(' ').pop() == 'super'\n    );\n}\n","import { adjustTrailingSpaceSelection } from '../../modelApi/selection/adjustTrailingSpaceSelection';\nimport { formatSegmentWithContentModel } from '../utils/formatSegmentWithContentModel';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Toggle underline style\n * @param editor The editor to operate on\n */\nexport default function toggleUnderline(editor: IEditor) {\n    editor.focus();\n\n    formatSegmentWithContentModel(\n        editor,\n        'toggleUnderline',\n        (format, isTurningOn, segment) => {\n            format.underline = !!isTurningOn;\n\n            if (segment?.link) {\n                segment.link.format.underline = !!isTurningOn;\n            }\n        },\n        (format, segment) => !!format.underline || !!segment?.link?.format?.underline,\n        false /*includingFormatHolder*/,\n        adjustTrailingSpaceSelection\n    );\n}\n","import { parseValueWithUnit } from 'roosterjs-content-model-dom';\nimport {\n    extractBorderValues,\n    getFirstSelectedTable,\n    getSelectedCells,\n    updateTableCellMetadata,\n} from 'roosterjs-content-model-core';\nimport type {\n    IEditor,\n    Border,\n    ContentModelTable,\n    ContentModelTableCell,\n    BorderOperations,\n    TableSelectionCoordinates,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Border positions\n */\ntype BorderPositions = 'borderTop' | 'borderBottom' | 'borderLeft' | 'borderRight';\n\n/**\n * @internal\n * Perimeter of the table selection\n * Used to determine where to apply border to the cells adjacent to the selection.\n */\ntype Perimeter = {\n    Top: boolean;\n    Bottom: boolean;\n    Left: boolean;\n    Right: boolean;\n};\n\n/**\n * Operations to apply border\n * @param editor The editor instance\n * @param border The border to apply\n * @param operation The operation to apply\n */\nexport default function applyTableBorderFormat(\n    editor: IEditor,\n    border: Border,\n    operation: BorderOperations\n) {\n    editor.formatContentModel(\n        model => {\n            const [tableModel] = getFirstSelectedTable(model);\n\n            if (tableModel) {\n                const sel = getSelectedCells(tableModel);\n                const perimeter: Perimeter = {\n                    Top: false,\n                    Bottom: false,\n                    Left: false,\n                    Right: false,\n                };\n\n                // Create border format with table format as backup\n                let borderFormat = '';\n                const format = tableModel.format;\n                const { width, style, color } = border;\n                const extractedBorder = extractBorderValues(format.borderTop);\n                const borderColor = extractedBorder.color;\n                const borderWidth = extractedBorder.width;\n                const borderStyle = extractedBorder.style;\n\n                if (width) {\n                    borderFormat = parseValueWithUnit(width) + 'px';\n                } else if (borderWidth) {\n                    borderFormat = borderWidth;\n                } else {\n                    borderFormat = '1px';\n                }\n\n                if (style) {\n                    borderFormat = `${borderFormat} ${style}`;\n                } else if (borderStyle) {\n                    borderFormat = `${borderFormat} ${borderStyle}`;\n                } else {\n                    borderFormat = `${borderFormat} solid`;\n                }\n\n                if (color) {\n                    borderFormat = `${borderFormat} ${color}`;\n                } else if (borderColor) {\n                    borderFormat = `${borderFormat} ${borderColor}`;\n                }\n\n                // undefined is treated as Left to Right\n                const isRtl = tableModel.format.direction == 'rtl';\n\n                if (sel) {\n                    const operations: BorderOperations[] = [operation];\n                    while (operations.length) {\n                        switch (operations.pop()) {\n                            case 'noBorders':\n                                // Do All borders but with empty border format\n                                borderFormat = '';\n                                operations.push('allBorders');\n                                break;\n                            case 'allBorders':\n                                const allBorders: BorderPositions[] = [\n                                    'borderTop',\n                                    'borderBottom',\n                                    'borderLeft',\n                                    'borderRight',\n                                ];\n                                for (\n                                    let rowIndex = sel.firstRow;\n                                    rowIndex <= sel.lastRow;\n                                    rowIndex++\n                                ) {\n                                    for (\n                                        let colIndex = sel.firstColumn;\n                                        colIndex <= sel.lastColumn;\n                                        colIndex++\n                                    ) {\n                                        const cell = tableModel.rows[rowIndex].cells[colIndex];\n                                        // Format cells - All borders\n                                        applyBorderFormat(cell, borderFormat, allBorders);\n                                    }\n                                }\n\n                                // Format perimeter\n                                perimeter.Top = true;\n                                perimeter.Bottom = true;\n                                perimeter.Left = true;\n                                perimeter.Right = true;\n                                break;\n                            case 'leftBorders':\n                                const leftBorder: BorderPositions[] = ['borderLeft'];\n                                for (\n                                    let rowIndex = sel.firstRow;\n                                    rowIndex <= sel.lastRow;\n                                    rowIndex++\n                                ) {\n                                    const cell =\n                                        tableModel.rows[rowIndex].cells[\n                                            isRtl ? sel.lastColumn : sel.firstColumn\n                                        ];\n                                    // Format cells - Left border\n                                    applyBorderFormat(cell, borderFormat, leftBorder);\n                                }\n\n                                // Format perimeter\n                                isRtl ? (perimeter.Right = true) : (perimeter.Left = true);\n                                break;\n                            case 'rightBorders':\n                                const rightBorder: BorderPositions[] = ['borderRight'];\n                                for (\n                                    let rowIndex = sel.firstRow;\n                                    rowIndex <= sel.lastRow;\n                                    rowIndex++\n                                ) {\n                                    const cell =\n                                        tableModel.rows[rowIndex].cells[\n                                            isRtl ? sel.firstColumn : sel.lastColumn\n                                        ];\n                                    // Format cells - Right border\n                                    applyBorderFormat(cell, borderFormat, rightBorder);\n                                }\n\n                                // Format perimeter\n                                isRtl ? (perimeter.Left = true) : (perimeter.Right = true);\n                                break;\n                            case 'topBorders':\n                                const topBorder: BorderPositions[] = ['borderTop'];\n                                for (\n                                    let colIndex = sel.firstColumn;\n                                    colIndex <= sel.lastColumn;\n                                    colIndex++\n                                ) {\n                                    const cell = tableModel.rows[sel.firstRow].cells[colIndex];\n                                    // Format cells - Top border\n                                    applyBorderFormat(cell, borderFormat, topBorder);\n                                }\n\n                                // Format perimeter\n                                perimeter.Top = true;\n                                break;\n                            case 'bottomBorders':\n                                const bottomBorder: BorderPositions[] = ['borderBottom'];\n                                for (\n                                    let colIndex = sel.firstColumn;\n                                    colIndex <= sel.lastColumn;\n                                    colIndex++\n                                ) {\n                                    const cell = tableModel.rows[sel.lastRow].cells[colIndex];\n                                    // Format cells - Bottom border\n                                    applyBorderFormat(cell, borderFormat, bottomBorder);\n                                }\n\n                                // Format perimeter\n                                perimeter.Bottom = true;\n                                break;\n                            case 'insideBorders':\n                                // Format cells - Inside borders\n                                const singleCol = sel.lastColumn == sel.firstColumn;\n                                const singleRow = sel.lastRow == sel.firstRow;\n                                // Single cell selection\n                                if (singleCol && singleRow) {\n                                    break;\n                                }\n                                // Single column selection\n                                if (singleCol) {\n                                    applyBorderFormat(\n                                        tableModel.rows[sel.firstRow].cells[sel.firstColumn],\n                                        borderFormat,\n                                        ['borderBottom']\n                                    );\n                                    for (\n                                        let rowIndex = sel.firstRow + 1;\n                                        rowIndex <= sel.lastRow - 1;\n                                        rowIndex++\n                                    ) {\n                                        const cell =\n                                            tableModel.rows[rowIndex].cells[sel.firstColumn];\n                                        applyBorderFormat(cell, borderFormat, [\n                                            'borderTop',\n                                            'borderBottom',\n                                        ]);\n                                    }\n                                    applyBorderFormat(\n                                        tableModel.rows[sel.lastRow].cells[sel.firstColumn],\n                                        borderFormat,\n                                        ['borderTop']\n                                    );\n                                    break;\n                                }\n                                // Single row selection\n                                if (singleRow) {\n                                    applyBorderFormat(\n                                        tableModel.rows[sel.firstRow].cells[\n                                            isRtl ? sel.lastColumn : sel.firstColumn\n                                        ],\n                                        borderFormat,\n                                        ['borderRight']\n                                    );\n                                    for (\n                                        let colIndex = sel.firstColumn + 1;\n                                        colIndex <= sel.lastColumn - 1;\n                                        colIndex++\n                                    ) {\n                                        const cell = tableModel.rows[sel.firstRow].cells[colIndex];\n                                        applyBorderFormat(cell, borderFormat, [\n                                            'borderLeft',\n                                            'borderRight',\n                                        ]);\n                                    }\n                                    applyBorderFormat(\n                                        tableModel.rows[sel.firstRow].cells[\n                                            isRtl ? sel.firstColumn : sel.lastColumn\n                                        ],\n                                        borderFormat,\n                                        ['borderLeft']\n                                    );\n                                    break;\n                                }\n\n                                // For multiple rows and columns selections\n                                // Top left cell\n                                applyBorderFormat(\n                                    tableModel.rows[sel.firstRow].cells[\n                                        isRtl ? sel.lastColumn : sel.firstColumn\n                                    ],\n                                    borderFormat,\n                                    ['borderBottom', 'borderRight']\n                                );\n                                // Top right cell\n                                applyBorderFormat(\n                                    tableModel.rows[sel.firstRow].cells[\n                                        isRtl ? sel.firstColumn : sel.lastColumn\n                                    ],\n                                    borderFormat,\n                                    ['borderBottom', 'borderLeft']\n                                );\n                                // Bottom left cell\n                                applyBorderFormat(\n                                    tableModel.rows[sel.lastRow].cells[\n                                        isRtl ? sel.lastColumn : sel.firstColumn\n                                    ],\n                                    borderFormat,\n                                    ['borderTop', 'borderRight']\n                                );\n                                // Bottom right cell\n                                applyBorderFormat(\n                                    tableModel.rows[sel.lastRow].cells[\n                                        isRtl ? sel.firstColumn : sel.lastColumn\n                                    ],\n                                    borderFormat,\n                                    ['borderTop', 'borderLeft']\n                                );\n                                // First row\n                                for (\n                                    let colIndex = sel.firstColumn + 1;\n                                    colIndex < sel.lastColumn;\n                                    colIndex++\n                                ) {\n                                    const cell = tableModel.rows[sel.firstRow].cells[colIndex];\n                                    applyBorderFormat(cell, borderFormat, [\n                                        'borderBottom',\n                                        'borderLeft',\n                                        'borderRight',\n                                    ]);\n                                }\n                                // Last row\n                                for (\n                                    let colIndex = sel.firstColumn + 1;\n                                    colIndex < sel.lastColumn;\n                                    colIndex++\n                                ) {\n                                    const cell = tableModel.rows[sel.lastRow].cells[colIndex];\n                                    applyBorderFormat(cell, borderFormat, [\n                                        'borderTop',\n                                        'borderLeft',\n                                        'borderRight',\n                                    ]);\n                                }\n                                // First column\n                                for (\n                                    let rowIndex = sel.firstRow + 1;\n                                    rowIndex < sel.lastRow;\n                                    rowIndex++\n                                ) {\n                                    const cell = tableModel.rows[rowIndex].cells[sel.firstColumn];\n                                    applyBorderFormat(cell, borderFormat, [\n                                        'borderTop',\n                                        'borderBottom',\n                                        isRtl ? 'borderLeft' : 'borderRight',\n                                    ]);\n                                }\n                                // Last column\n                                for (\n                                    let rowIndex = sel.firstRow + 1;\n                                    rowIndex < sel.lastRow;\n                                    rowIndex++\n                                ) {\n                                    const cell = tableModel.rows[rowIndex].cells[sel.lastColumn];\n                                    applyBorderFormat(cell, borderFormat, [\n                                        'borderTop',\n                                        'borderBottom',\n                                        isRtl ? 'borderRight' : 'borderLeft',\n                                    ]);\n                                }\n                                // Inner cells\n                                sel.firstColumn++;\n                                sel.firstRow++;\n                                sel.lastColumn--;\n                                sel.lastRow--;\n                                operations.push('allBorders');\n                                break;\n                            case 'outsideBorders':\n                                // Format cells - Outside borders\n                                operations.push('topBorders');\n                                operations.push('bottomBorders');\n                                operations.push('leftBorders');\n                                operations.push('rightBorders');\n                                break;\n                            default:\n                                break;\n                        }\n                    }\n\n                    //Format perimeter if necessary or possible\n                    modifyPerimeter(tableModel, sel, borderFormat, perimeter, isRtl);\n                }\n\n                return true;\n            } else {\n                return false;\n            }\n        },\n        {\n            apiName: 'tableBorder',\n        }\n    );\n}\n\n/**\n * @internal\n * Apply border format to a cell\n * @param cell The cell to apply border format\n * @param borderFormat The border format to apply\n * @param positions The positions to apply\n */\nfunction applyBorderFormat(\n    cell: ContentModelTableCell,\n    borderFormat: string,\n    positions: BorderPositions[]\n) {\n    positions.forEach(pos => {\n        cell.format[pos] = borderFormat;\n    });\n\n    updateTableCellMetadata(cell, metadata => {\n        metadata = metadata || {};\n        metadata.borderOverride = true;\n        return metadata;\n    });\n\n    // Cell was modified, so delete cached element\n    delete cell.cachedElement;\n}\n\n/**\n * @internal\n * Modify the perimeter of the table selection\n * @param tableModel The table model\n * @param sel The table selection\n * @param borderFormat The border format to apply\n * If borderFormat is empty, the border will be removed\n * @param perimeter Where in the perimeter to apply\n */\nfunction modifyPerimeter(\n    tableModel: ContentModelTable,\n    sel: TableSelectionCoordinates,\n    borderFormat: string,\n    perimeter: Perimeter,\n    isRtl: boolean\n) {\n    // Top of selection\n    if (perimeter.Top && sel.firstRow - 1 >= 0) {\n        for (let colIndex = sel.firstColumn; colIndex <= sel.lastColumn; colIndex++) {\n            const cell = tableModel.rows[sel.firstRow - 1].cells[colIndex];\n            applyBorderFormat(cell, borderFormat, ['borderBottom']);\n        }\n    }\n    // Bottom of selection\n    if (perimeter.Bottom && sel.lastRow + 1 < tableModel.rows.length) {\n        for (let colIndex = sel.firstColumn; colIndex <= sel.lastColumn; colIndex++) {\n            const cell = tableModel.rows[sel.lastRow + 1].cells[colIndex];\n            applyBorderFormat(cell, borderFormat, ['borderTop']);\n        }\n    }\n    // Left of selection\n    if (perimeter.Left && sel.firstColumn - 1 >= 0) {\n        for (let rowIndex = sel.firstRow; rowIndex <= sel.lastRow; rowIndex++) {\n            const cell = tableModel.rows[rowIndex].cells[sel.firstColumn - 1];\n            applyBorderFormat(cell, borderFormat, [isRtl ? 'borderLeft' : 'borderRight']);\n        }\n    }\n    // Right of selection\n    if (perimeter.Right && sel.lastColumn + 1 < tableModel.rows[0].cells.length) {\n        for (let rowIndex = sel.firstRow; rowIndex <= sel.lastRow; rowIndex++) {\n            const cell = tableModel.rows[rowIndex].cells[sel.lastColumn + 1];\n            applyBorderFormat(cell, borderFormat, [isRtl ? 'borderRight' : 'borderLeft']);\n        }\n    }\n}\n","import { alignTable } from '../../modelApi/table/alignTable';\nimport { deleteTable } from '../../modelApi/table/deleteTable';\nimport { deleteTableColumn } from '../../modelApi/table/deleteTableColumn';\nimport { deleteTableRow } from '../../modelApi/table/deleteTableRow';\nimport { formatTableWithContentModel } from '../utils/formatTableWithContentModel';\nimport { insertTableColumn } from '../../modelApi/table/insertTableColumn';\nimport { insertTableRow } from '../../modelApi/table/insertTableRow';\nimport { mergeTableCells } from '../../modelApi/table/mergeTableCells';\nimport { mergeTableColumn } from '../../modelApi/table/mergeTableColumn';\nimport { mergeTableRow } from '../../modelApi/table/mergeTableRow';\nimport { splitTableCellHorizontally } from '../../modelApi/table/splitTableCellHorizontally';\nimport { splitTableCellVertically } from '../../modelApi/table/splitTableCellVertically';\nimport type { TableOperation, IEditor } from 'roosterjs-content-model-types';\nimport {\n    alignTableCellHorizontally,\n    alignTableCellVertically,\n} from '../../modelApi/table/alignTableCell';\n\n/**\n * Format current focused table with the given format\n * @param editor The editor instance\n * @param operation The table operation to apply\n */\nexport default function editTable(editor: IEditor, operation: TableOperation) {\n    editor.focus();\n\n    formatTableWithContentModel(editor, 'editTable', tableModel => {\n        switch (operation) {\n            case 'alignCellLeft':\n            case 'alignCellCenter':\n            case 'alignCellRight':\n                alignTableCellHorizontally(tableModel, operation);\n                break;\n            case 'alignCellTop':\n            case 'alignCellMiddle':\n            case 'alignCellBottom':\n                alignTableCellVertically(tableModel, operation);\n                break;\n            case 'alignCenter':\n            case 'alignLeft':\n            case 'alignRight':\n                alignTable(tableModel, operation);\n                break;\n\n            case 'deleteColumn':\n                deleteTableColumn(tableModel);\n                break;\n\n            case 'deleteRow':\n                deleteTableRow(tableModel);\n                break;\n\n            case 'deleteTable':\n                deleteTable(tableModel);\n                break;\n\n            case 'insertAbove':\n            case 'insertBelow':\n                insertTableRow(tableModel, operation);\n                break;\n\n            case 'insertLeft':\n            case 'insertRight':\n                insertTableColumn(tableModel, operation);\n                break;\n\n            case 'mergeAbove':\n            case 'mergeBelow':\n                mergeTableRow(tableModel, operation);\n                break;\n\n            case 'mergeCells':\n                mergeTableCells(tableModel);\n                break;\n\n            case 'mergeLeft':\n            case 'mergeRight':\n                mergeTableColumn(tableModel, operation);\n                break;\n\n            case 'splitHorizontally':\n                splitTableCellHorizontally(tableModel);\n                break;\n\n            case 'splitVertically':\n                splitTableCellVertically(tableModel);\n                break;\n        }\n    });\n}\n","import {\n    applyTableFormat,\n    getFirstSelectedTable,\n    updateTableCellMetadata,\n} from 'roosterjs-content-model-core';\nimport type { IEditor, TableMetadataFormat } from 'roosterjs-content-model-types';\n\n/**\n * Format current focused table with the given format\n * @param editor The editor instance\n * @param format The table format to apply\n * @param keepCellShade Whether keep existing shade color when apply format if there is a manually set shade color\n */\nexport default function formatTable(\n    editor: IEditor,\n    format: TableMetadataFormat,\n    keepCellShade?: boolean\n) {\n    editor.focus();\n\n    editor.formatContentModel(\n        model => {\n            const [tableModel] = getFirstSelectedTable(model);\n\n            if (tableModel) {\n                // Wipe border metadata\n                tableModel.rows.forEach(row => {\n                    row.cells.forEach(cell => {\n                        updateTableCellMetadata(cell, metadata => {\n                            if (metadata) {\n                                delete metadata.borderOverride;\n                            }\n                            return metadata;\n                        });\n                    });\n                });\n                applyTableFormat(tableModel, format, keepCellShade);\n                return true;\n            } else {\n                return false;\n            }\n        },\n        {\n            apiName: 'formatTable',\n        }\n    );\n}\n","import { createContentModelDocument, createSelectionMarker } from 'roosterjs-content-model-dom';\nimport { createTableStructure } from '../../modelApi/table/createTableStructure';\nimport {\n    applyTableFormat,\n    deleteSelection,\n    mergeModel,\n    normalizeTable,\n    setSelection,\n} from 'roosterjs-content-model-core';\nimport type { IEditor, TableMetadataFormat } from 'roosterjs-content-model-types';\n\n/**\n * Insert table into editor at current selection\n * @param editor The editor instance\n * @param columns Number of columns in table, it also controls the default table cell width:\n * if columns &lt;= 4, width = 120px; if columns &lt;= 6, width = 100px; else width = 70px\n * @param rows Number of rows in table\n * @param format (Optional) The table format. If not passed, the default format will be applied:\n * background color: #FFF; border color: #ABABAB\n */\nexport default function insertTable(\n    editor: IEditor,\n    columns: number,\n    rows: number,\n    format?: Partial<TableMetadataFormat>\n) {\n    editor.focus();\n\n    editor.formatContentModel(\n        (model, context) => {\n            const insertPosition = deleteSelection(model, [], context).insertPoint;\n\n            if (insertPosition) {\n                const doc = createContentModelDocument();\n                const table = createTableStructure(doc, columns, rows);\n\n                normalizeTable(table, editor.getPendingFormat() || insertPosition.marker.format);\n                // Assign default vertical align\n                format = format || { verticalAlign: 'top' };\n                applyTableFormat(table, format);\n                mergeModel(model, doc, context, {\n                    insertPosition,\n                    mergeFormat: 'mergeAll',\n                });\n\n                const firstBlock = table.rows[0]?.cells[0]?.blocks[0];\n\n                if (firstBlock?.blockType == 'Paragraph') {\n                    const marker = createSelectionMarker(firstBlock.segments[0]?.format);\n                    firstBlock.segments.unshift(marker);\n                    setSelection(model, marker);\n                }\n\n                return true;\n            } else {\n                return false;\n            }\n        },\n        {\n            apiName: 'insertTable',\n        }\n    );\n}\n","import {\n    hasSelectionInBlockGroup,\n    getFirstSelectedTable,\n    normalizeTable,\n    setTableCellBackgroundColor,\n} from 'roosterjs-content-model-core';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Set table cell shade color\n * @param editor The editor instance\n * @param color The color to set. Pass null to remove existing shade color\n */\nexport default function setTableCellShade(editor: IEditor, color: string | null) {\n    editor.focus();\n\n    editor.formatContentModel(\n        model => {\n            const [table] = getFirstSelectedTable(model);\n\n            if (table) {\n                normalizeTable(table);\n\n                table.rows.forEach(row =>\n                    row.cells.forEach(cell => {\n                        if (hasSelectionInBlockGroup(cell)) {\n                            setTableCellBackgroundColor(cell, color, true /*isColorOverride*/);\n                        }\n                    })\n                );\n\n                return true;\n            } else {\n                return false;\n            }\n        },\n        {\n            apiName: 'setTableCellShade',\n        }\n    );\n}\n","import { formatSegmentWithContentModel } from './formatSegmentWithContentModel';\nimport type { ContentModelImage, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport default function formatImageWithContentModel(\n    editor: IEditor,\n    apiName: string,\n    callback: (segment: ContentModelImage) => void\n) {\n    formatSegmentWithContentModel(\n        editor,\n        apiName,\n        (_, __, segment) => {\n            if (segment?.segmentType == 'Image') {\n                callback(segment);\n            }\n        },\n        undefined /** segmentHasStyleCallback **/,\n        undefined /** includingFormatHolder */\n    );\n}\n","import { getSelectedParagraphs } from 'roosterjs-content-model-core';\nimport type { ContentModelParagraph, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function formatParagraphWithContentModel(\n    editor: IEditor,\n    apiName: string,\n    setStyleCallback: (paragraph: ContentModelParagraph) => void\n) {\n    editor.formatContentModel(\n        (model, context) => {\n            const paragraphs = getSelectedParagraphs(model);\n\n            paragraphs.forEach(setStyleCallback);\n            context.newPendingFormat = 'preserve';\n\n            return paragraphs.length > 0;\n        },\n        {\n            apiName,\n        }\n    );\n}\n","import { adjustWordSelection } from '../../modelApi/selection/adjustWordSelection';\nimport { getSelectedSegmentsAndParagraphs } from 'roosterjs-content-model-core';\nimport type {\n    ContentModelDocument,\n    ContentModelParagraph,\n    ContentModelSegment,\n    ContentModelSegmentFormat,\n    IEditor,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function formatSegmentWithContentModel(\n    editor: IEditor,\n    apiName: string,\n    toggleStyleCallback: (\n        format: ContentModelSegmentFormat,\n        isTuringOn: boolean,\n        segment: ContentModelSegment | null,\n        paragraph: ContentModelParagraph | null\n    ) => void,\n    segmentHasStyleCallback?: (\n        format: ContentModelSegmentFormat,\n        segment: ContentModelSegment | null,\n        paragraph: ContentModelParagraph | null\n    ) => boolean,\n    includingFormatHolder?: boolean,\n    afterFormatCallback?: (model: ContentModelDocument) => void\n) {\n    editor.formatContentModel(\n        (model, context) => {\n            let segmentAndParagraphs = getSelectedSegmentsAndParagraphs(\n                model,\n                !!includingFormatHolder\n            );\n            let isCollapsedSelection =\n                segmentAndParagraphs.length == 1 &&\n                segmentAndParagraphs[0][0].segmentType == 'SelectionMarker';\n\n            if (isCollapsedSelection) {\n                const para = segmentAndParagraphs[0][1];\n\n                segmentAndParagraphs = adjustWordSelection(\n                    model,\n                    segmentAndParagraphs[0][0]\n                ).map(x => [x, para]);\n\n                if (segmentAndParagraphs.length > 1) {\n                    isCollapsedSelection = false;\n                }\n            }\n\n            const formatsAndSegments: [\n                ContentModelSegmentFormat,\n                ContentModelSegment | null,\n                ContentModelParagraph | null\n            ][] = segmentAndParagraphs.map(item => [item[0].format, item[0], item[1]]);\n\n            const isTurningOff = segmentHasStyleCallback\n                ? formatsAndSegments.every(([format, segment, paragraph]) =>\n                      segmentHasStyleCallback(format, segment, paragraph)\n                  )\n                : false;\n\n            formatsAndSegments.forEach(([format, segment, paragraph]) =>\n                toggleStyleCallback(format, !isTurningOff, segment, paragraph)\n            );\n\n            afterFormatCallback?.(model);\n\n            if (isCollapsedSelection) {\n                context.newPendingFormat = segmentAndParagraphs[0][0].format;\n                editor.focus();\n                return false;\n            } else {\n                return formatsAndSegments.length > 0;\n            }\n        },\n        {\n            apiName,\n        }\n    );\n}\n","import { ensureFocusableParagraphForTable } from '../../modelApi/table/ensureFocusableParagraphForTable';\nimport {\n    createSelectionMarker,\n    hasMetadata,\n    setParagraphNotImplicit,\n} from 'roosterjs-content-model-dom';\nimport {\n    hasSelectionInBlock,\n    applyTableFormat,\n    getFirstSelectedTable,\n    normalizeTable,\n    setSelection,\n} from 'roosterjs-content-model-core';\nimport type { ContentModelTable, IEditor, TableSelection } from 'roosterjs-content-model-types';\n\n/**\n * Invoke a callback to format the selected table using Content Model\n * @param editor The editor object\n * @param apiName Name of API this calling this function. This is mostly for logging.\n * @param callback The callback to format the table. It will be called with current selected table. If no table is selected, it will not be called.\n * @param selectionOverride Override the current selection. If we want to format a table even currently it is not selected, we can use this parameter to override current selection\n */\nexport function formatTableWithContentModel(\n    editor: IEditor,\n    apiName: string,\n    callback: (tableModel: ContentModelTable) => void,\n    selectionOverride?: TableSelection\n) {\n    editor.formatContentModel(\n        model => {\n            const [tableModel, path] = getFirstSelectedTable(model);\n\n            if (tableModel) {\n                callback(tableModel);\n\n                if (!hasSelectionInBlock(tableModel)) {\n                    const paragraph = ensureFocusableParagraphForTable(model, path, tableModel);\n\n                    if (paragraph) {\n                        const marker = createSelectionMarker(model.format);\n\n                        paragraph.segments.unshift(marker);\n                        setParagraphNotImplicit(paragraph);\n                        setSelection(model, marker);\n                    }\n                }\n\n                normalizeTable(tableModel, model.format);\n\n                if (hasMetadata(tableModel)) {\n                    applyTableFormat(tableModel, undefined /*newFormat*/, true /*keepCellShade*/);\n                }\n\n                return true;\n            } else {\n                return false;\n            }\n        },\n        {\n            apiName,\n            selectionOverride,\n        }\n    );\n}\n","/**\n *  Enum used to control the different types of bullet list\n */\nexport const BulletListType = {\n    /**\n     * Minimum value of the enum\n     */\n    Min: 1,\n    /**\n     * Bullet triggered by *\n     */\n    Disc: 1,\n    /**\n     * Bullet triggered by -\n     */\n    Dash: 2,\n    /**\n     * Bullet triggered by --\n     */\n    Square: 3,\n    /**\n     * Bullet triggered by >\n     */\n    ShortArrow: 4,\n    /**\n     * Bullet triggered by ->\n     */\n    LongArrow: 5,\n    /**\n     * Bullet triggered by =>\n     */\n    UnfilledArrow: 6,\n    /**\n     * Bullet triggered by \n     */\n    Hyphen: 7,\n    /**\n     * Bullet triggered by -->\n     */\n    DoubleLongArrow: 8,\n    /**\n     * Bullet type circle\n     */\n    Circle: 9,\n    /**\n     * Maximum value of the enum\n     */\n    Max: 9,\n};\n","/**\n * Possible change sources. Here are the predefined sources.\n * It can also be other string if the change source can't fall into these sources.\n */\nexport const ChangeSource = {\n    /**\n     * Content changed by auto link\n     */\n    AutoLink: 'AutoLink',\n    /**\n     * Content changed by create link\n     */\n    CreateLink: 'CreateLink',\n    /**\n     * Content changed by format\n     */\n    Format: 'Format',\n    /**\n     * Content changed by image resize\n     */\n    ImageResize: 'ImageResize',\n    /**\n     * Content changed by paste\n     */\n    Paste: 'Paste',\n    /**\n     * Content changed by setContent API\n     */\n    SetContent: 'SetContent',\n    /**\n     * Content changed by cut operation\n     */\n    Cut: 'Cut',\n    /**\n     * Content changed by drag & drop operation\n     */\n    Drop: 'Drop',\n    /**\n     * Insert a new entity into editor\n     */\n    InsertEntity: 'InsertEntity',\n    /**\n     * Editor is switched to dark mode, content color is changed\n     */\n    SwitchToDarkMode: 'SwitchToDarkMode',\n    /**\n     * Editor is switched to light mode, content color is changed\n     */\n    SwitchToLightMode: 'SwitchToLightMode',\n    /**\n     * List chain reorganized numbers of lists\n     */\n    ListChain: 'ListChain',\n    /**\n     * Keyboard event, used by Content Model.\n     * Data of this event will be the key code number\n     */\n    Keyboard: 'Keyboard',\n};\n","/**\n *  Enum used to control the different types of numbering list\n */\nexport const NumberingListType = {\n    /**\n     * Minimum value of the enum\n     */\n    Min: 1,\n    /**\n     * Numbering triggered by 1.\n     */\n    Decimal: 1,\n    /**\n     * Numbering triggered by 1-\n     */\n    DecimalDash: 2,\n    /**\n     * Numbering triggered by 1)\n     */\n    DecimalParenthesis: 3,\n    /**\n     * Numbering triggered by (1)\n     */\n    DecimalDoubleParenthesis: 4,\n    /**\n     * Numbering triggered by a.\n     */\n    LowerAlpha: 5,\n    /**\n     * Numbering triggered by a)\n     */\n    LowerAlphaParenthesis: 6,\n    /**\n     * Numbering triggered by (a)\n     */\n    LowerAlphaDoubleParenthesis: 7,\n    /**\n     * Numbering triggered by a-\n     */\n    LowerAlphaDash: 8,\n    /**\n     * Numbering triggered by A.\n     */\n    UpperAlpha: 9,\n    /**\n     * Numbering triggered by A)\n     */\n    UpperAlphaParenthesis: 10,\n    /**\n     * Numbering triggered by (A)\n     */\n    UpperAlphaDoubleParenthesis: 11,\n    /**\n     * Numbering triggered by A-\n     */\n    UpperAlphaDash: 12,\n    /**\n     * Numbering triggered by i.\n     */\n    LowerRoman: 13,\n    /**\n     * Numbering triggered by i)\n     */\n    LowerRomanParenthesis: 14,\n    /**\n     * Numbering triggered by (i)\n     */\n    LowerRomanDoubleParenthesis: 15,\n    /**\n     * Numbering triggered by i-\n     */\n    LowerRomanDash: 16,\n    /**\n     * Numbering triggered by I.\n     */\n    UpperRoman: 17,\n    /**\n     * Numbering triggered by I)\n     */\n    UpperRomanParenthesis: 18,\n    /**\n     * Numbering triggered by (I)\n     */\n    UpperRomanDoubleParenthesis: 19,\n    /**\n     * Numbering triggered by I-\n     */\n    UpperRomanDash: 20,\n    /**\n     * Maximum value of the enum\n     */\n    Max: 20,\n};\n","/**\n * Table format border\n */\nexport const TableBorderFormat = {\n    /**\n     * Minimum value\n     */\n    Min: 0,\n\n    /**\n     * All border of the table are displayed\n     *  __ __ __\n     * |__|__|__|\n     * |__|__|__|\n     * |__|__|__|\n     */\n    Default: 0,\n\n    /**\n     * Middle vertical border are not displayed\n     *  __ __ __\n     * |__ __ __|\n     * |__ __ __|\n     * |__ __ __|\n     */\n    ListWithSideBorders: 1,\n\n    /**\n     * All borders except header rows borders are displayed\n     *  __ __ __\n     *  __|__|__\n     *  __|__|__\n     */\n    NoHeaderBorders: 2,\n\n    /**\n     * The left and right border of the table are not displayed\n     *  __ __ __\n     *  __|__|__\n     *  __|__|__\n     *  __|__|__\n     */\n    NoSideBorders: 3,\n\n    /**\n     * Only the borders that divides the header row, first column and externals are displayed\n     *  __ __ __\n     * |__ __ __|\n     * |  |     |\n     * |__|__ __|\n     */\n    FirstColumnHeaderExternal: 4,\n\n    /**\n     * The header row has no vertical border, except for the first one\n     * The first column has no horizontal border, except for the first one\n     *  __ __ __\n     * |__ __ __\n     * |  |__|__|\n     * |  |__|__|\n     */\n    EspecialType1: 5,\n\n    /**\n     * The header row has no vertical border, except for the first one\n     * The only horizontal border of the table is the top and bottom of header row\n     *  __ __ __\n     * |__ __ __\n     * |  |     |\n     * |  |     |\n     */\n    EspecialType2: 6,\n\n    /**\n     * The only borders are the bottom of header row and the right border of first column\n     *  __ __ __\n     *    |\n     *    |\n     */\n    EspecialType3: 7,\n\n    /**\n     * No border\n     */\n    Clear: 8,\n\n    /**\n     * Maximum value\n     */\n    Max: 8,\n};\n","import { createSnapshotSelection } from '../utils/createSnapshotSelection';\nimport type { AddUndoSnapshot, Snapshot } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Add an undo snapshot to current undo snapshot stack\n * @param core The EditorCore object\n * @param canUndoByBackspace True if this action can be undone when user press Backspace key (aka Auto Complete).\n * @param entityStates @optional Entity states related to this snapshot.\n * Each entity state will cause an EntityOperation event with operation = EntityOperation.UpdateEntityState\n * when undo/redo to this snapshot\n */\nexport const addUndoSnapshot: AddUndoSnapshot = (core, canUndoByBackspace, entityStates) => {\n    const { lifecycle, physicalRoot, undo } = core;\n    let snapshot: Snapshot | null = null;\n\n    if (!lifecycle.shadowEditFragment) {\n        // Need to create snapshot selection before retrieve innerHTML since HTML can be changed during creating selection when normalize table\n        const selection = createSnapshotSelection(core);\n        const html = physicalRoot.innerHTML;\n\n        snapshot = {\n            html,\n            entityStates,\n            isDarkMode: !!lifecycle.isDarkMode,\n            selection,\n        };\n\n        undo.snapshotsManager.addSnapshot(snapshot, !!canUndoByBackspace);\n        undo.snapshotsManager.hasNewContent = false;\n    }\n\n    return snapshot;\n};\n","import { getObjectKeys } from 'roosterjs-content-model-dom';\nimport type { AttachDomEvent, PluginEvent } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Attach a DOM event to the editor content DIV\n * @param core The EditorCore object\n * @param eventName The DOM event name\n * @param pluginEventType Optional event type. When specified, editor will trigger a plugin event with this name when the DOM event is triggered\n * @param beforeDispatch Optional callback function to be invoked when the DOM event is triggered before trigger plugin event\n */\nexport const attachDomEvent: AttachDomEvent = (core, eventMap) => {\n    const disposers = getObjectKeys(eventMap || {}).map(key => {\n        const { pluginEventType, beforeDispatch } = eventMap[key];\n        const eventName = key as keyof HTMLElementEventMap;\n        const onEvent = (event: HTMLElementEventMap[typeof eventName]) => {\n            if (beforeDispatch) {\n                beforeDispatch(event);\n            }\n\n            if (pluginEventType != null) {\n                core.api.triggerEvent(\n                    core,\n                    <PluginEvent>{\n                        eventType: pluginEventType,\n                        rawEvent: event,\n                    },\n                    false /*broadcast*/\n                );\n            }\n        };\n\n        core.logicalRoot.addEventListener(eventName, onEvent);\n\n        return () => {\n            core.logicalRoot.removeEventListener(eventName, onEvent);\n        };\n    });\n\n    return () => disposers.forEach(disposers => disposers());\n};\n","import { cloneModel } from '../publicApi/model/cloneModel';\nimport {\n    createDomToModelContext,\n    createDomToModelContextWithConfig,\n    domToContentModel,\n} from 'roosterjs-content-model-dom';\nimport type { CreateContentModel } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Create Content Model from DOM tree in this editor\n * @param core The editor core object\n * @param option The option to customize the behavior of DOM to Content Model conversion\n * @param selectionOverride When passed, use this selection range instead of current selection in editor\n */\nexport const createContentModel: CreateContentModel = (core, option, selectionOverride) => {\n    // Flush all mutations if any, so that we can get an up-to-date Content Model\n    core.cache.textMutationObserver?.flushMutations();\n\n    let cachedModel = selectionOverride ? null : core.cache.cachedModel;\n\n    if (cachedModel && core.lifecycle.shadowEditFragment) {\n        // When in shadow edit, use a cloned model so we won't pollute the cached one\n        cachedModel = cloneModel(cachedModel, { includeCachedElement: true });\n    }\n\n    if (cachedModel) {\n        return cachedModel;\n    } else {\n        const selection = selectionOverride || core.api.getDOMSelection(core) || undefined;\n        const saveIndex = !option && !selectionOverride;\n        const editorContext = core.api.createEditorContext(core, saveIndex);\n        const domToModelContext = option\n            ? createDomToModelContext(\n                  editorContext,\n                  core.domToModelSettings.builtIn,\n                  core.domToModelSettings.customized,\n                  option\n              )\n            : createDomToModelContextWithConfig(core.domToModelSettings.calculated, editorContext);\n\n        const model = domToContentModel(core.logicalRoot, domToModelContext, selection);\n\n        if (saveIndex) {\n            core.cache.cachedModel = model;\n            core.cache.cachedSelection = selection;\n        }\n\n        return model;\n    }\n};\n","import { getRootComputedStyleForContext } from '../utils/getRootComputedStyleForContext';\nimport type { EditorContext, CreateEditorContext } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Create a EditorContext object used by ContentModel API\n */\nexport const createEditorContext: CreateEditorContext = (core, saveIndex) => {\n    const { lifecycle, format, darkColorHandler, logicalRoot, cache, domHelper } = core;\n\n    const context: EditorContext = {\n        isDarkMode: lifecycle.isDarkMode,\n        defaultFormat: format.defaultFormat,\n        pendingFormat: format.pendingFormat ?? undefined,\n        darkColorHandler: darkColorHandler,\n        addDelimiterForEntity: true,\n        allowCacheElement: true,\n        domIndexer: saveIndex ? cache.domIndexer : undefined,\n        zoomScale: domHelper.calculateZoomScale(),\n        ...getRootComputedStyleForContext(logicalRoot.ownerDocument),\n    };\n\n    checkRootRtl(logicalRoot, context);\n\n    return context;\n};\n\nfunction checkRootRtl(element: HTMLElement, context: EditorContext) {\n    const style = element?.ownerDocument.defaultView?.getComputedStyle(element);\n\n    if (style?.direction == 'rtl') {\n        context.isRootRtl = true;\n    }\n}\n","import type { Focus } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Focus to editor. If there is a cached selection range, use it as current selection\n * @param core The EditorCore object\n */\nexport const focus: Focus = core => {\n    if (!core.lifecycle.shadowEditFragment) {\n        const { api, selection } = core;\n\n        if (!api.hasFocus(core) && selection.selection?.type == 'range') {\n            api.setDOMSelection(core, selection.selection, true /*skipSelectionChangedEvent*/);\n        }\n\n        // fallback, in case editor still have no focus\n        if (!core.api.hasFocus(core)) {\n            core.logicalRoot.focus();\n        }\n    }\n};\n","import { ChangeSource } from '../constants/ChangeSource';\nimport type {\n    ChangedEntity,\n    ContentChangedEvent,\n    DOMSelection,\n    FormatContentModel,\n    FormatContentModelContext,\n    EditorCore,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * The general API to do format change with Content Model\n * It will grab a Content Model for current editor content, and invoke a callback function\n * to do format change. Then according to the return value, write back the modified content model into editor.\n * If there is cached model, it will be used and updated.\n * @param core The EditorCore object\n * @param formatter Formatter function, see ContentModelFormatter\n * @param options More options, see FormatContentModelOptions\n */\nexport const formatContentModel: FormatContentModel = (core, formatter, options) => {\n    const { apiName, onNodeCreated, getChangeData, changeSource, rawEvent, selectionOverride } =\n        options || {};\n    const model = core.api.createContentModel(core, undefined /*option*/, selectionOverride);\n    const context: FormatContentModelContext = {\n        newEntities: [],\n        deletedEntities: [],\n        rawEvent,\n        newImages: [],\n    };\n\n    const hasFocus = core.api.hasFocus(core);\n\n    const changed = formatter(model, context);\n    const { skipUndoSnapshot, clearModelCache, entityStates, canUndoByBackspace } = context;\n\n    if (changed) {\n        const isNested = core.undo.isNested;\n        const shouldAddSnapshot = !skipUndoSnapshot && !isNested;\n        let selection: DOMSelection | undefined;\n\n        if (shouldAddSnapshot) {\n            core.undo.isNested = true;\n\n            core.api.addUndoSnapshot(core, !!canUndoByBackspace, entityStates);\n        }\n\n        try {\n            handleImages(core, context);\n\n            selection =\n                core.api.setContentModel(\n                    core,\n                    model,\n                    hasFocus ? undefined : { ignoreSelection: true }, // If editor did not have focus before format, do not set focus after format\n                    onNodeCreated\n                ) ?? undefined;\n\n            handlePendingFormat(core, context, selection);\n\n            const eventData: ContentChangedEvent = {\n                eventType: 'contentChanged',\n                contentModel: clearModelCache ? undefined : model,\n                selection: clearModelCache ? undefined : selection,\n                source: changeSource || ChangeSource.Format,\n                data: getChangeData?.(),\n                formatApiName: apiName,\n                changedEntities: getChangedEntities(context, rawEvent),\n            };\n\n            core.api.triggerEvent(core, eventData, true /*broadcast*/);\n\n            if (canUndoByBackspace && selection?.type == 'range') {\n                core.undo.posContainer = selection.range.startContainer;\n                core.undo.posOffset = selection.range.startOffset;\n            }\n\n            if (shouldAddSnapshot) {\n                core.api.addUndoSnapshot(core, !!canUndoByBackspace, entityStates);\n            } else {\n                core.undo.snapshotsManager.hasNewContent = true;\n            }\n        } finally {\n            if (!isNested) {\n                core.undo.isNested = false;\n            }\n        }\n    } else {\n        if (clearModelCache) {\n            core.cache.cachedModel = undefined;\n            core.cache.cachedSelection = undefined;\n        }\n\n        handlePendingFormat(core, context, core.api.getDOMSelection(core));\n    }\n};\n\nfunction handleImages(core: EditorCore, context: FormatContentModelContext) {\n    if (context.newImages.length > 0) {\n        const viewport = core.api.getVisibleViewport(core);\n\n        if (viewport) {\n            const { left, right } = viewport;\n            const minMaxImageSize = 10;\n            const maxWidth = Math.max(right - left, minMaxImageSize);\n            context.newImages.forEach(image => {\n                image.format.maxWidth = `${maxWidth}px`;\n            });\n        }\n    }\n}\n\nfunction handlePendingFormat(\n    core: EditorCore,\n    context: FormatContentModelContext,\n    selection?: DOMSelection | null\n) {\n    const pendingFormat =\n        context.newPendingFormat == 'preserve'\n            ? core.format.pendingFormat?.format\n            : context.newPendingFormat;\n\n    if (pendingFormat && selection?.type == 'range' && selection.range.collapsed) {\n        core.format.pendingFormat = {\n            format: { ...pendingFormat },\n            posContainer: selection.range.startContainer,\n            posOffset: selection.range.startOffset,\n        };\n    }\n}\n\nfunction getChangedEntities(context: FormatContentModelContext, rawEvent?: Event): ChangedEntity[] {\n    return context.newEntities\n        .map(\n            (entity): ChangedEntity => ({\n                entity,\n                operation: 'newEntity',\n                rawEvent,\n            })\n        )\n        .concat(\n            context.deletedEntities.map(entry => ({\n                entity: entry.entity,\n                operation: entry.operation,\n                rawEvent,\n            }))\n        );\n}\n","import type { DOMSelection, GetDOMSelection, EditorCore } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const getDOMSelection: GetDOMSelection = core => {\n    if (core.lifecycle.shadowEditFragment) {\n        return null;\n    } else {\n        const selection = core.selection.selection;\n\n        return selection && (selection.type != 'range' || !core.api.hasFocus(core))\n            ? selection\n            : getNewSelection(core);\n    }\n};\n\nfunction getNewSelection(core: EditorCore): DOMSelection | null {\n    const selection = core.logicalRoot.ownerDocument.defaultView?.getSelection();\n    const range = selection && selection.rangeCount > 0 ? selection.getRangeAt(0) : null;\n\n    return range && core.logicalRoot.contains(range.commonAncestorContainer)\n        ? {\n              type: 'range',\n              range,\n              isReverted: isSelectionReverted(selection),\n          }\n        : null;\n}\n\nfunction isSelectionReverted(selection: Selection | null | undefined): boolean {\n    if (selection && selection.rangeCount > 0) {\n        const range = selection.getRangeAt(0);\n        return (\n            !range.collapsed &&\n            selection.focusNode != range.endContainer &&\n            selection.focusOffset != range.endOffset\n        );\n    }\n\n    return false;\n}\n","import type { GetVisibleViewport, Rect } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Retrieves the rect of the visible viewport of the editor.\n * @param core The EditorCore object\n */\nexport const getVisibleViewport: GetVisibleViewport = core => {\n    const scrollContainer = core.domEvent.scrollContainer;\n\n    return getIntersectedRect(\n        scrollContainer == core.physicalRoot\n            ? [scrollContainer]\n            : [scrollContainer, core.physicalRoot]\n    );\n};\n\n/**\n * Get the intersected Rect of elements provided\n *\n * @example\n * The result of the following Elements Rects would be:\n    {\n        top: Element2.top,\n        bottom: Element1.bottom,\n        left: Element2.left,\n        right: Element2.right\n    }\n    +-------------------------+\n    | Element 1               |\n    |   +-----------------+   |\n    |   | Element2        |   |\n    |   |                 |   |\n    |   |                 |   |\n    +-------------------------+\n        |                 |\n        +-----------------+\n\n * @param elements Elements to use.\n * @param additionalRects additional rects to use\n * @returns If the Rect is valid return the rect, if not, return null.\n */\nfunction getIntersectedRect(elements: HTMLElement[], additionalRects: Rect[] = []): Rect | null {\n    const rects = elements\n        .map(element => normalizeRect(element.getBoundingClientRect()))\n        .concat(additionalRects)\n        .filter((rect: Rect | null): rect is Rect => !!rect);\n\n    const result: Rect = {\n        top: Math.max(...rects.map(r => r.top)),\n        bottom: Math.min(...rects.map(r => r.bottom)),\n        left: Math.max(...rects.map(r => r.left)),\n        right: Math.min(...rects.map(r => r.right)),\n    };\n\n    return result.top < result.bottom && result.left < result.right ? result : null;\n}\n\nfunction normalizeRect(clientRect: DOMRect): Rect | null {\n    const { left, right, top, bottom } =\n        clientRect || <DOMRect>{ left: 0, right: 0, top: 0, bottom: 0 };\n    return left === 0 && right === 0 && top === 0 && bottom === 0\n        ? null\n        : {\n              left: Math.round(left),\n              right: Math.round(right),\n              top: Math.round(top),\n              bottom: Math.round(bottom),\n          };\n}\n","import type { HasFocus } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Check if the editor has focus now\n * @param core The EditorCore object\n * @returns True if the editor has focus, otherwise false\n */\nexport const hasFocus: HasFocus = core => {\n    const activeElement = core.logicalRoot.ownerDocument.activeElement;\n    return !!(activeElement && core.logicalRoot.contains(activeElement));\n};\n","import { cloneModel } from '../publicApi/model/cloneModel';\nimport { convertInlineCss } from '../utils/convertInlineCss';\nimport { createPasteFragment } from '../utils/paste/createPasteFragment';\nimport { generatePasteOptionFromPlugins } from '../utils/paste/generatePasteOptionFromPlugins';\nimport { mergePasteContent } from '../utils/paste/mergePasteContent';\nimport { retrieveHtmlInfo } from '../utils/paste/retrieveHtmlInfo';\nimport type { CloneModelOptions } from '../publicApi/model/cloneModel';\nimport type {\n    PasteType,\n    ClipboardData,\n    Paste,\n    EditorCore,\n    TrustedHTMLHandler,\n} from 'roosterjs-content-model-types';\n\nconst CloneOption: CloneModelOptions = {\n    includeCachedElement: (node, type) => (type == 'cache' ? undefined : node),\n};\n\n/**\n * @internal\n * Paste into editor using a clipboardData object\n * @param core The EditorCore object.\n * @param clipboardData Clipboard data retrieved from clipboard\n * @param pasteType Type of content to paste. @default normal\n */\nexport const paste: Paste = (\n    core: EditorCore,\n    clipboardData: ClipboardData,\n    pasteType: PasteType = 'normal'\n) => {\n    core.api.focus(core);\n\n    if (clipboardData.modelBeforePaste) {\n        core.api.setContentModel(core, cloneModel(clipboardData.modelBeforePaste, CloneOption));\n    } else {\n        clipboardData.modelBeforePaste = cloneModel(core.api.createContentModel(core), CloneOption);\n    }\n\n    // 1. Prepare variables\n    const doc = createDOMFromHtml(clipboardData.rawHtml, core.trustedHTMLHandler);\n\n    // 2. Handle HTML from clipboard\n    const htmlFromClipboard = retrieveHtmlInfo(doc, clipboardData);\n\n    // 3. Create target fragment\n    const sourceFragment = createPasteFragment(\n        core.physicalRoot.ownerDocument,\n        clipboardData,\n        pasteType,\n        (clipboardData.rawHtml == clipboardData.html\n            ? doc\n            : createDOMFromHtml(clipboardData.html, core.trustedHTMLHandler)\n        )?.body\n    );\n\n    // 4. Trigger BeforePaste event to allow plugins modify the fragment\n    const eventResult = generatePasteOptionFromPlugins(\n        core,\n        clipboardData,\n        sourceFragment,\n        htmlFromClipboard,\n        pasteType\n    );\n\n    // 5. Convert global CSS to inline CSS\n    convertInlineCss(eventResult.fragment, htmlFromClipboard.globalCssRules);\n\n    // 6. Merge pasted content into main Content Model\n    mergePasteContent(core, eventResult, clipboardData);\n};\n\nfunction createDOMFromHtml(\n    html: string | null | undefined,\n    trustedHTMLHandler: TrustedHTMLHandler\n): Document | null {\n    return html ? new DOMParser().parseFromString(trustedHTMLHandler(html), 'text/html') : null;\n}\n","import { ChangeSource } from '../constants/ChangeSource';\nimport { restoreSnapshotColors } from '../utils/restoreSnapshotColors';\nimport { restoreSnapshotHTML } from '../utils/restoreSnapshotHTML';\nimport { restoreSnapshotSelection } from '../utils/restoreSnapshotSelection';\nimport type { ContentChangedEvent, RestoreUndoSnapshot } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Restore an undo snapshot into editor\n * @param core The editor core object\n * @param step Steps to move, can be 0, positive or negative\n */\nexport const restoreUndoSnapshot: RestoreUndoSnapshot = (core, snapshot) => {\n    core.api.triggerEvent(\n        core,\n        {\n            eventType: 'beforeSetContent',\n            newContent: snapshot.html,\n        },\n        true /*broadcast*/\n    );\n\n    try {\n        core.undo.isRestoring = true;\n\n        restoreSnapshotHTML(core, snapshot);\n        restoreSnapshotSelection(core, snapshot);\n        restoreSnapshotColors(core, snapshot);\n\n        const event: ContentChangedEvent = {\n            eventType: 'contentChanged',\n            entityStates: snapshot.entityStates,\n            source: ChangeSource.SetContent,\n        };\n\n        core.api.triggerEvent(core, event, false /*broadcast*/);\n    } finally {\n        core.undo.isRestoring = false;\n    }\n};\n","import {\n    contentModelToDom,\n    createModelToDomContext,\n    createModelToDomContextWithConfig,\n} from 'roosterjs-content-model-dom';\nimport type { SetContentModel } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Set content with content model\n * @param core The editor core object\n * @param model The content model to set\n * @param option Additional options to customize the behavior of Content Model to DOM conversion\n */\nexport const setContentModel: SetContentModel = (core, model, option, onNodeCreated) => {\n    const editorContext = core.api.createEditorContext(core, true /*saveIndex*/);\n    const modelToDomContext = option\n        ? createModelToDomContext(\n              editorContext,\n              core.modelToDomSettings.builtIn,\n              core.modelToDomSettings.customized,\n              option\n          )\n        : createModelToDomContextWithConfig(core.modelToDomSettings.calculated, editorContext);\n\n    modelToDomContext.onNodeCreated = onNodeCreated;\n\n    const selection = contentModelToDom(\n        core.logicalRoot.ownerDocument,\n        core.logicalRoot,\n        model,\n        modelToDomContext\n    );\n\n    if (!core.lifecycle.shadowEditFragment) {\n        core.cache.cachedSelection = selection || undefined;\n\n        if (!option?.ignoreSelection && selection) {\n            core.api.setDOMSelection(core, selection);\n        } else {\n            core.selection.selection = selection;\n        }\n\n        // Clear pending mutations since we will use our latest model object to replace existing cache\n        core.cache.textMutationObserver?.flushMutations();\n        core.cache.cachedModel = model;\n    }\n\n    return selection;\n};\n","import { addRangeToSelection } from '../corePlugin/utils/addRangeToSelection';\nimport { isNodeOfType, toArray } from 'roosterjs-content-model-dom';\nimport { parseTableCells } from '../publicApi/domUtils/tableCellUtils';\nimport type {\n    SelectionChangedEvent,\n    SetDOMSelection,\n    TableSelection,\n} from 'roosterjs-content-model-types';\n\nconst IMAGE_ID = 'image';\nconst TABLE_ID = 'table';\nconst CONTENT_DIV_ID = 'contentDiv';\nconst DEFAULT_SELECTION_BORDER_COLOR = '#DB626C';\nconst TABLE_CSS_RULE = '{background-color: rgb(198,198,198) !important;}';\nconst CARET_CSS_RULE = '{caret-color: transparent}';\nconst MAX_RULE_SELECTOR_LENGTH = 9000;\n\n/**\n * @internal\n */\nexport const setDOMSelection: SetDOMSelection = (core, selection, skipSelectionChangedEvent) => {\n    // We are applying a new selection, so we don't need to apply cached selection in DOMEventPlugin.\n    // Set skipReselectOnFocus to skip this behavior\n    const skipReselectOnFocus = core.selection.skipReselectOnFocus;\n\n    const doc = core.physicalRoot.ownerDocument;\n    const sheet = core.selection.selectionStyleNode?.sheet;\n\n    core.selection.skipReselectOnFocus = true;\n\n    try {\n        let selectionRules: string[] | undefined;\n        const rootSelector = '#' + addUniqueId(core.physicalRoot, CONTENT_DIV_ID);\n\n        switch (selection?.type) {\n            case 'image':\n                const image = selection.image;\n\n                selectionRules = buildImageCSS(\n                    rootSelector,\n                    addUniqueId(image, IMAGE_ID),\n                    core.selection.imageSelectionBorderColor\n                );\n                core.selection.selection = selection;\n\n                setRangeSelection(doc, image);\n                break;\n            case 'table':\n                const { table, firstColumn, firstRow } = selection;\n\n                selectionRules = buildTableCss(\n                    rootSelector,\n                    addUniqueId(table, TABLE_ID),\n                    selection\n                );\n                core.selection.selection = selection;\n\n                setRangeSelection(doc, table.rows[firstRow]?.cells[firstColumn]);\n                break;\n            case 'range':\n                addRangeToSelection(doc, selection.range, selection.isReverted);\n\n                core.selection.selection = core.api.hasFocus(core) ? null : selection;\n                break;\n\n            default:\n                core.selection.selection = null;\n                break;\n        }\n\n        if (sheet) {\n            for (let i = sheet.cssRules.length - 1; i >= 0; i--) {\n                sheet.deleteRule(i);\n            }\n\n            if (selectionRules) {\n                for (let i = 0; i < selectionRules.length; i++) {\n                    sheet.insertRule(selectionRules[i]);\n                }\n            }\n        }\n    } finally {\n        core.selection.skipReselectOnFocus = skipReselectOnFocus;\n    }\n\n    if (!skipSelectionChangedEvent) {\n        const eventData: SelectionChangedEvent = {\n            eventType: 'selectionChanged',\n            newSelection: selection,\n        };\n\n        core.api.triggerEvent(core, eventData, true /*broadcast*/);\n    }\n};\n\nfunction buildImageCSS(editorSelector: string, imageId: string, borderColor?: string): string[] {\n    const color = borderColor || DEFAULT_SELECTION_BORDER_COLOR;\n\n    return [\n        `${editorSelector} #${imageId} {outline-style:auto!important;outline-color:${color}!important;}`,\n        `${editorSelector} ${CARET_CSS_RULE}`,\n    ];\n}\n\nfunction buildTableCss(\n    editorSelector: string,\n    tableId: string,\n    selection: TableSelection\n): string[] {\n    const { firstColumn, firstRow, lastColumn, lastRow } = selection;\n    const cells = parseTableCells(selection.table);\n    const isAllTableSelected =\n        firstRow == 0 &&\n        firstColumn == 0 &&\n        lastRow == cells.length - 1 &&\n        lastColumn == (cells[lastRow]?.length ?? 0) - 1;\n    const rootSelector = editorSelector + ' #' + tableId;\n    const selectors = isAllTableSelected\n        ? [rootSelector, `${rootSelector} *`]\n        : handleTableSelected(rootSelector, selection, cells);\n\n    const cssRules: string[] = [`${editorSelector} ${CARET_CSS_RULE}`];\n    let currentRules: string = '';\n\n    for (let i = 0; i < selectors.length; i++) {\n        currentRules += (currentRules.length > 0 ? ',' : '') + selectors[i] || '';\n\n        if (\n            currentRules.length + (selectors[0]?.length || 0) > MAX_RULE_SELECTOR_LENGTH ||\n            i == selectors.length - 1\n        ) {\n            cssRules.push(currentRules + ' ' + TABLE_CSS_RULE);\n            currentRules = '';\n        }\n    }\n\n    return cssRules;\n}\n\nfunction handleTableSelected(\n    rootSelector: string,\n    selection: TableSelection,\n    cells: (HTMLTableCellElement | null)[][]\n) {\n    const { firstRow, firstColumn, lastRow, lastColumn, table } = selection;\n    const selectors: string[] = [];\n\n    // Get whether table has thead, tbody or tfoot, then Set the start and end of each of the table children,\n    // so we can build the selector according the element between the table and the row.\n    let cont = 0;\n    const indexes = toArray(table.childNodes)\n        .filter(\n            (node): node is HTMLTableSectionElement =>\n                ['THEAD', 'TBODY', 'TFOOT'].indexOf(\n                    isNodeOfType(node, 'ELEMENT_NODE') ? node.tagName : ''\n                ) > -1\n        )\n        .map(node => {\n            const result = {\n                el: node.tagName,\n                start: cont,\n                end: node.childNodes.length + cont,\n            };\n\n            cont = result.end;\n            return result;\n        });\n\n    cells.forEach((row, rowIndex) => {\n        let tdCount = 0;\n\n        //Get current TBODY/THEAD/TFOOT\n        const midElement = indexes.filter(ind => ind.start <= rowIndex && ind.end > rowIndex)[0];\n        const middleElSelector = midElement ? '>' + midElement.el + '>' : '>';\n        const currentRow =\n            midElement && rowIndex + 1 >= midElement.start\n                ? rowIndex + 1 - midElement.start\n                : rowIndex + 1;\n\n        for (let cellIndex = 0; cellIndex < row.length; cellIndex++) {\n            const cell = row[cellIndex];\n\n            if (cell) {\n                tdCount++;\n\n                if (\n                    rowIndex >= firstRow &&\n                    rowIndex <= lastRow &&\n                    cellIndex >= firstColumn &&\n                    cellIndex <= lastColumn\n                ) {\n                    const selector = `${rootSelector}${middleElSelector} tr:nth-child(${currentRow})>${cell.tagName}:nth-child(${tdCount})`;\n\n                    selectors.push(selector, selector + ' *');\n                }\n            }\n        }\n    });\n\n    return selectors;\n}\n\nfunction setRangeSelection(doc: Document, element: HTMLElement | undefined) {\n    if (element && doc.contains(element)) {\n        const range = doc.createRange();\n\n        range.selectNode(element);\n        range.collapse();\n\n        addRangeToSelection(doc, range);\n    }\n}\n\nfunction addUniqueId(element: HTMLElement, idPrefix: string): string {\n    idPrefix = element.id || idPrefix;\n\n    const doc = element.ownerDocument;\n    let i = 0;\n\n    while (!element.id || doc.querySelectorAll('#' + element.id).length > 1) {\n        element.id = idPrefix + '_' + i++;\n    }\n\n    return element.id;\n}\n","import { iterateSelections } from '../publicApi/selection/iterateSelections';\nimport { moveChildNodes } from 'roosterjs-content-model-dom';\nimport type { SwitchShadowEdit } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Switch the Shadow Edit mode of editor On/Off\n * @param editorCore The EditorCore object\n * @param isOn True to switch On, False to switch Off\n */\nexport const switchShadowEdit: SwitchShadowEdit = (editorCore, isOn): void => {\n    const core = editorCore;\n\n    if (isOn != !!core.lifecycle.shadowEditFragment) {\n        if (isOn) {\n            const model = !core.cache.cachedModel ? core.api.createContentModel(core) : null;\n            const fragment = core.logicalRoot.ownerDocument.createDocumentFragment();\n            const clonedRoot = core.logicalRoot.cloneNode(true /*deep*/);\n\n            moveChildNodes(fragment, clonedRoot);\n\n            core.api.triggerEvent(\n                core,\n                {\n                    eventType: 'enteredShadowEdit',\n                },\n                false /*broadcast*/\n            );\n\n            // This need to be done after EnteredShadowEdit event is triggered since EnteredShadowEdit event will cause a SelectionChanged event\n            // if current selection is table selection or image selection\n            if (!core.cache.cachedModel && model) {\n                core.cache.cachedModel = model;\n            }\n\n            core.lifecycle.shadowEditFragment = fragment;\n        } else {\n            core.lifecycle.shadowEditFragment = null;\n\n            core.api.triggerEvent(\n                core,\n                {\n                    eventType: 'leavingShadowEdit',\n                },\n                false /*broadcast*/\n            );\n\n            if (core.cache.cachedModel) {\n                // Force clear cached element from selected block\n                iterateSelections(core.cache.cachedModel, () => {});\n\n                core.api.setContentModel(core, core.cache.cachedModel, {\n                    ignoreSelection: true, // Do not set focus and selection when quit shadow edit, focus may remain in UI control (picker, ...)\n                });\n            }\n        }\n    }\n};\n","import type {\n    EditorPlugin,\n    PluginEvent,\n    PluginEventType,\n    TriggerEvent,\n} from 'roosterjs-content-model-types';\n\nconst allowedEventsInShadowEdit: PluginEventType[] = [\n    'editorReady',\n    'beforeDispose',\n    'extractContentWithDom',\n    'zoomChanged',\n];\n\n/**\n * @internal\n * Trigger a plugin event\n * @param core The EditorCore object\n * @param pluginEvent The event object to trigger\n * @param broadcast Set to true to skip the shouldHandleEventExclusively check\n */\nexport const triggerEvent: TriggerEvent = (core, pluginEvent, broadcast) => {\n    if (\n        (!core.lifecycle.shadowEditFragment ||\n            allowedEventsInShadowEdit.indexOf(pluginEvent.eventType as PluginEventType) >= 0) &&\n        (broadcast || !core.plugins.some(plugin => handledExclusively(pluginEvent, plugin)))\n    ) {\n        core.plugins.forEach(plugin => {\n            if (plugin.onPluginEvent) {\n                plugin.onPluginEvent(pluginEvent);\n            }\n        });\n    }\n};\n\nfunction handledExclusively(event: PluginEvent, plugin: EditorPlugin): boolean {\n    if (plugin.onPluginEvent && plugin.willHandleEventExclusively?.(event)) {\n        plugin.onPluginEvent(event);\n        return true;\n    }\n\n    return false;\n}\n","import { areSameSelection } from './utils/areSameSelection';\nimport { createTextMutationObserver } from './utils/textMutationObserver';\nimport { domIndexerImpl } from './utils/domIndexerImpl';\nimport type {\n    CachePluginState,\n    IEditor,\n    PluginEvent,\n    PluginWithState,\n    EditorOptions,\n} from 'roosterjs-content-model-types';\n\n/**\n * ContentModel cache plugin manages cached Content Model, and refresh the cache when necessary\n */\nclass CachePlugin implements PluginWithState<CachePluginState> {\n    private editor: IEditor | null = null;\n    private state: CachePluginState;\n\n    /**\n     * Construct a new instance of CachePlugin class\n     * @param option The editor option\n     * @param contentDiv The editor content DIV\n     */\n    constructor(option: EditorOptions, contentDiv: HTMLDivElement) {\n        this.state = option.cacheModel\n            ? {\n                  domIndexer: domIndexerImpl,\n                  textMutationObserver: createTextMutationObserver(contentDiv, this.onMutation),\n              }\n            : {};\n    }\n\n    /**\n     * Get name of this plugin\n     */\n    getName() {\n        return 'Cache';\n    }\n\n    /**\n     * The first method that editor will call to a plugin when editor is initializing.\n     * It will pass in the editor instance, plugin should take this chance to save the\n     * editor reference so that it can call to any editor method or format API later.\n     * @param editor The editor object\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n        this.editor.getDocument().addEventListener('selectionchange', this.onNativeSelectionChange);\n\n        this.state.textMutationObserver?.startObserving();\n    }\n\n    /**\n     * The last method that editor will call to a plugin before it is disposed.\n     * Plugin can take this chance to clear the reference to editor. After this method is\n     * called, plugin should not call to any editor method since it will result in error.\n     */\n    dispose() {\n        this.state.textMutationObserver?.stopObserving();\n\n        if (this.editor) {\n            this.editor\n                .getDocument()\n                .removeEventListener('selectionchange', this.onNativeSelectionChange);\n            this.editor = null;\n        }\n    }\n\n    /**\n     * Get plugin state object\n     */\n    getState(): CachePluginState {\n        return this.state;\n    }\n\n    /**\n     * Core method for a plugin. Once an event happens in editor, editor will call this\n     * method of each plugin to handle the event as long as the event is not handled\n     * exclusively by another plugin.\n     * @param event The event to handle:\n     */\n    onPluginEvent(event: PluginEvent) {\n        if (!this.editor) {\n            return;\n        }\n\n        switch (event.eventType) {\n            case 'keyDown':\n            case 'input':\n                if (!this.state.textMutationObserver) {\n                    // When updating cache is not enabled, need to clear the cache to make sure other plugins can get an up-to-date content model\n                    this.invalidateCache();\n                }\n                break;\n\n            case 'selectionChanged':\n                this.updateCachedModel(this.editor);\n                break;\n\n            case 'contentChanged':\n                const { contentModel, selection } = event;\n\n                if (contentModel && this.state.domIndexer) {\n                    this.state.cachedModel = contentModel;\n                    this.state.cachedSelection = selection;\n                } else {\n                    this.invalidateCache();\n                }\n\n                break;\n        }\n    }\n\n    private onMutation = (isTextChangeOnly: boolean) => {\n        if (this.editor) {\n            if (isTextChangeOnly) {\n                this.updateCachedModel(this.editor, true /*forceUpdate*/);\n            } else {\n                this.invalidateCache();\n            }\n        }\n    };\n\n    private onNativeSelectionChange = () => {\n        if (this.editor?.hasFocus()) {\n            this.updateCachedModel(this.editor);\n        }\n    };\n\n    private invalidateCache() {\n        if (!this.editor?.isInShadowEdit()) {\n            this.state.cachedModel = undefined;\n            this.state.cachedSelection = undefined;\n        }\n    }\n\n    private updateCachedModel(editor: IEditor, forceUpdate?: boolean) {\n        const cachedSelection = this.state.cachedSelection;\n        this.state.cachedSelection = undefined; // Clear it to force getDOMSelection() retrieve the latest selection range\n\n        const newRangeEx = editor.getDOMSelection() || undefined;\n        const model = this.state.cachedModel;\n        const isSelectionChanged =\n            forceUpdate ||\n            !cachedSelection ||\n            !newRangeEx ||\n            !areSameSelection(newRangeEx, cachedSelection);\n\n        if (isSelectionChanged) {\n            if (\n                !model ||\n                !newRangeEx ||\n                !this.state.domIndexer?.reconcileSelection(model, newRangeEx, cachedSelection)\n            ) {\n                this.invalidateCache();\n            } else {\n                this.state.cachedSelection = newRangeEx;\n            }\n        } else {\n            this.state.cachedSelection = cachedSelection;\n        }\n    }\n}\n\n/**\n * @internal\n * Create a new instance of CachePlugin class.\n * @param option The editor option\n * @param contentDiv The editor content DIV\n */\nexport function createCachePlugin(\n    option: EditorOptions,\n    contentDiv: HTMLDivElement\n): PluginWithState<CachePluginState> {\n    return new CachePlugin(option, contentDiv);\n}\n","import { getSelectionRootNode } from '../publicApi/selection/getSelectionRootNode';\nimport type {\n    ContextMenuPluginState,\n    ContextMenuProvider,\n    IEditor,\n    PluginWithState,\n    EditorOptions,\n} from 'roosterjs-content-model-types';\n\nconst ContextMenuButton = 2;\n\n/**\n * Edit Component helps handle Content edit features\n */\nclass ContextMenuPlugin implements PluginWithState<ContextMenuPluginState> {\n    private editor: IEditor | null = null;\n    private state: ContextMenuPluginState;\n    private disposer: (() => void) | null = null;\n\n    /**\n     * Construct a new instance of EditPlugin\n     * @param options The editor options\n     */\n    constructor(options: EditorOptions) {\n        this.state = {\n            contextMenuProviders:\n                options.plugins?.filter<ContextMenuProvider<any>>(isContextMenuProvider) || [],\n        };\n    }\n\n    /**\n     * Get a friendly name of  this plugin\n     */\n    getName() {\n        return 'ContextMenu';\n    }\n\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n        this.disposer = this.editor.attachDomEvent({\n            contextmenu: {\n                beforeDispatch: this.onContextMenuEvent,\n            },\n        });\n    }\n\n    /**\n     * Dispose this plugin\n     */\n    dispose() {\n        this.disposer?.();\n        this.disposer = null;\n        this.editor = null;\n    }\n\n    /**\n     * Get plugin state object\n     */\n    getState() {\n        return this.state;\n    }\n\n    private onContextMenuEvent = (e: Event) => {\n        if (this.editor) {\n            const allItems: any[] = [];\n            const mouseEvent = e as MouseEvent;\n\n            // ContextMenu event can be triggered from mouse right click or keyboard (e.g. Shift+F10 on Windows)\n            // Need to check if this is from keyboard, we need to get target node from selection because in that case\n            // event.target is always the element that attached context menu event, here it will be editor content div.\n            const targetNode =\n                mouseEvent.button == ContextMenuButton\n                    ? (mouseEvent.target as Node)\n                    : this.getFocusedNode(this.editor);\n\n            if (targetNode) {\n                this.state.contextMenuProviders.forEach(provider => {\n                    const items = provider.getContextMenuItems(targetNode) ?? [];\n                    if (items?.length > 0) {\n                        if (allItems.length > 0) {\n                            allItems.push(null);\n                        }\n\n                        allItems.push(...items);\n                    }\n                });\n            }\n\n            this.editor?.triggerEvent('contextMenu', {\n                rawEvent: mouseEvent,\n                items: allItems,\n            });\n        }\n    };\n\n    private getFocusedNode(editor: IEditor) {\n        const selection = editor.getDOMSelection();\n\n        if (selection) {\n            if (selection.type == 'range') {\n                selection.range.collapse(true /*toStart*/);\n            }\n\n            return getSelectionRootNode(selection) || null;\n        } else {\n            return null;\n        }\n    }\n}\n\nfunction isContextMenuProvider(source: unknown): source is ContextMenuProvider<any> {\n    return !!(<ContextMenuProvider<any>>source)?.getContextMenuItems;\n}\n\n/**\n * @internal\n * Create a new instance of EditPlugin.\n */\nexport function createContextMenuPlugin(\n    options: EditorOptions\n): PluginWithState<ContextMenuPluginState> {\n    return new ContextMenuPlugin(options);\n}\n","import { addRangeToSelection } from './utils/addRangeToSelection';\nimport { ChangeSource } from '../constants/ChangeSource';\nimport { deleteEmptyList } from './utils/deleteEmptyList';\nimport { deleteSelection } from '../publicApi/selection/deleteSelection';\nimport { extractClipboardItems } from '../utils/extractClipboardItems';\nimport { getSelectedCells } from '../publicApi/table/getSelectedCells';\nimport { iterateSelections } from '../publicApi/selection/iterateSelections';\nimport { onCreateCopyEntityNode } from '../override/pasteCopyBlockEntityParser';\n\nimport {\n    contentModelToDom,\n    createModelToDomContext,\n    isElementOfType,\n    isNodeOfType,\n    moveChildNodes,\n    normalizeContentModel,\n    toArray,\n    wrap,\n} from 'roosterjs-content-model-dom';\nimport type {\n    ClipboardData,\n    CopyPastePluginState,\n    ContentModelTable,\n    DOMSelection,\n    IEditor,\n    OnNodeCreated,\n    EditorOptions,\n    PluginWithState,\n    ContentModelDocument,\n    ContentModelParagraph,\n    TableSelectionContext,\n    ContentModelSegment,\n} from 'roosterjs-content-model-types';\n\n/**\n * Copy and paste plugin for handling onCopy and onPaste event\n */\nclass CopyPastePlugin implements PluginWithState<CopyPastePluginState> {\n    private editor: IEditor | null = null;\n    private disposer: (() => void) | null = null;\n    private state: CopyPastePluginState;\n\n    /**\n     * Construct a new instance of CopyPastePlugin\n     * @param option The editor option\n     */\n    constructor(option: EditorOptions) {\n        this.state = {\n            allowedCustomPasteType: option.allowedCustomPasteType || [],\n            tempDiv: null,\n            defaultPasteType: option.defaultPasteType,\n        };\n    }\n\n    /**\n     * Get a friendly name of  this plugin\n     */\n    getName() {\n        return 'CopyPaste';\n    }\n\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n        this.disposer = this.editor.attachDomEvent({\n            paste: {\n                beforeDispatch: e => this.onPaste(e),\n            },\n            copy: {\n                beforeDispatch: e => this.onCutCopy(e, false /*isCut*/),\n            },\n            cut: {\n                beforeDispatch: e => this.onCutCopy(e, true /*isCut*/),\n            },\n        });\n    }\n\n    /**\n     * Dispose this plugin\n     */\n    dispose() {\n        if (this.state.tempDiv) {\n            this.state.tempDiv.parentNode?.removeChild(this.state.tempDiv);\n            this.state.tempDiv = null;\n        }\n\n        if (this.disposer) {\n            this.disposer();\n        }\n        this.disposer = null;\n        this.editor = null;\n    }\n\n    /**\n     * Get plugin state object\n     */\n    getState() {\n        return this.state;\n    }\n\n    private onCutCopy(event: Event, isCut: boolean) {\n        if (!this.editor) {\n            return;\n        }\n\n        const doc = this.editor.getDocument();\n        const selection = this.editor.getDOMSelection();\n\n        if (selection && (selection.type != 'range' || !selection.range.collapsed)) {\n            const pasteModel = this.editor.getContentModelCopy('disconnected');\n\n            if (selection.type === 'table') {\n                iterateSelections(pasteModel, (_, tableContext) => {\n                    if (tableContext?.table) {\n                        preprocessTable(tableContext.table);\n\n                        return true;\n                    }\n                    return false;\n                });\n            } else if (selection.type === 'range') {\n                adjustSelectionForCopyCut(pasteModel);\n            }\n\n            const tempDiv = this.getTempDiv(this.editor.getDocument());\n            const context = createModelToDomContext();\n\n            context.onNodeCreated = onNodeCreated;\n\n            const selectionForCopy = contentModelToDom(\n                tempDiv.ownerDocument,\n                tempDiv,\n                pasteModel,\n                context\n            );\n\n            let newRange: Range | null = selectionForCopy\n                ? domSelectionToRange(doc, selectionForCopy)\n                : null;\n\n            if (newRange) {\n                newRange = this.editor.triggerEvent('beforeCutCopy', {\n                    clonedRoot: tempDiv,\n                    range: newRange,\n                    rawEvent: event as ClipboardEvent,\n                    isCut,\n                }).range;\n\n                if (newRange) {\n                    addRangeToSelection(doc, newRange);\n                }\n\n                doc.defaultView?.requestAnimationFrame(() => {\n                    if (!this.editor) {\n                        return;\n                    }\n\n                    cleanUpAndRestoreSelection(tempDiv);\n                    this.editor.focus();\n                    this.editor.setDOMSelection(selection);\n\n                    if (isCut) {\n                        this.editor.formatContentModel(\n                            (model, context) => {\n                                if (\n                                    deleteSelection(model, [deleteEmptyList], context)\n                                        .deleteResult == 'range'\n                                ) {\n                                    normalizeContentModel(model);\n                                }\n\n                                return true;\n                            },\n                            {\n                                apiName: 'cut',\n                                changeSource: ChangeSource.Cut,\n                            }\n                        );\n                    }\n                });\n            } else {\n                cleanUpAndRestoreSelection(tempDiv);\n            }\n        }\n    }\n\n    private onPaste = (event: Event) => {\n        if (this.editor && isClipboardEvent(event)) {\n            const editor = this.editor;\n\n            const dataTransfer = event.clipboardData;\n\n            if (dataTransfer?.items) {\n                event.preventDefault();\n                extractClipboardItems(\n                    toArray(dataTransfer.items),\n                    this.state.allowedCustomPasteType\n                ).then((clipboardData: ClipboardData) => {\n                    if (!editor.isDisposed()) {\n                        editor.pasteFromClipboard(clipboardData, this.state.defaultPasteType);\n                    }\n                });\n            }\n        }\n    };\n\n    private getTempDiv(doc: Document) {\n        if (!this.state.tempDiv) {\n            const tempDiv = doc.createElement('div');\n\n            tempDiv.style.width = '600px';\n            tempDiv.style.height = '1px';\n            tempDiv.style.overflow = 'hidden';\n            tempDiv.style.position = 'fixed';\n            tempDiv.style.top = '0';\n            tempDiv.style.left = '0';\n            tempDiv.style.userSelect = 'text';\n            tempDiv.contentEditable = 'true';\n\n            doc.body.appendChild(tempDiv);\n\n            this.state.tempDiv = tempDiv;\n        }\n\n        const div = this.state.tempDiv;\n\n        div.style.backgroundColor = 'white';\n        div.style.color = 'black';\n        div.childNodes.forEach(node => div.removeChild(node));\n\n        div.style.display = '';\n        div.focus();\n\n        return div;\n    }\n}\n\n/**\n * @internal\n * Exported only for unit testing\n */\nexport function adjustSelectionForCopyCut(pasteModel: ContentModelDocument) {\n    let selectionMarker: ContentModelSegment | undefined;\n    let firstBlock: ContentModelParagraph | undefined;\n    let tableContext: TableSelectionContext | undefined;\n\n    iterateSelections(pasteModel, (_, tableCtxt, block, segments) => {\n        if (selectionMarker) {\n            if (tableCtxt != tableContext && firstBlock?.segments.includes(selectionMarker)) {\n                firstBlock.segments.splice(firstBlock.segments.indexOf(selectionMarker), 1);\n            }\n            return true;\n        }\n\n        const marker = segments?.find(segment => segment.segmentType == 'SelectionMarker');\n        if (!selectionMarker && marker) {\n            tableContext = tableCtxt;\n            firstBlock = block?.blockType == 'Paragraph' ? block : undefined;\n            selectionMarker = marker;\n        }\n\n        return false;\n    });\n}\n\nfunction cleanUpAndRestoreSelection(tempDiv: HTMLDivElement) {\n    tempDiv.style.backgroundColor = '';\n    tempDiv.style.color = '';\n    tempDiv.style.display = 'none';\n    moveChildNodes(tempDiv);\n}\n\nfunction isClipboardEvent(event: Event): event is ClipboardEvent {\n    return !!(event as ClipboardEvent).clipboardData;\n}\n\nfunction domSelectionToRange(doc: Document, selection: DOMSelection): Range | null {\n    let newRange: Range | null = null;\n\n    if (selection.type === 'table') {\n        const table = selection.table;\n        const elementToSelect =\n            table.parentElement?.childElementCount == 1 ? table.parentElement : table;\n\n        newRange = doc.createRange();\n        newRange.selectNode(elementToSelect);\n    } else if (selection.type === 'image') {\n        newRange = doc.createRange();\n        newRange.selectNode(selection.image);\n    } else {\n        newRange = selection.range;\n    }\n\n    return newRange;\n}\n\n/**\n * @internal\n * Exported only for unit testing\n */\nexport const onNodeCreated: OnNodeCreated = (modelElement, node): void => {\n    if (isNodeOfType(node, 'ELEMENT_NODE') && isElementOfType(node, 'table')) {\n        wrap(node.ownerDocument, node, 'div');\n    }\n    if (isNodeOfType(node, 'ELEMENT_NODE') && !node.isContentEditable) {\n        node.removeAttribute('contenteditable');\n    }\n    onCreateCopyEntityNode(modelElement, node);\n};\n\n/**\n * @internal\n * Exported only for unit testing\n */\nexport function preprocessTable(table: ContentModelTable) {\n    const sel = getSelectedCells(table);\n    table.rows = table.rows\n        .map(row => {\n            return {\n                ...row,\n                cells: row.cells.filter(cell => cell.isSelected),\n            };\n        })\n        .filter(row => row.cells.length > 0);\n\n    delete table.format.width;\n\n    table.widths = sel\n        ? table.widths.filter((_, index) => index >= sel?.firstColumn && index <= sel?.lastColumn)\n        : [];\n}\n\n/**\n * @internal\n * Create a new instance of CopyPastePlugin\n * @param option The editor option\n */\nexport function createCopyPastePlugin(\n    option: EditorOptions\n): PluginWithState<CopyPastePluginState> {\n    return new CopyPastePlugin(option);\n}\n","import { ChangeSource } from '../constants/ChangeSource';\nimport { isCharacterValue, isCursorMovingKey } from '../publicApi/domUtils/eventUtils';\nimport { isNodeOfType } from 'roosterjs-content-model-dom';\nimport type {\n    DOMEventPluginState,\n    IEditor,\n    DOMEventRecord,\n    EditorOptions,\n    PluginWithState,\n} from 'roosterjs-content-model-types';\n\nconst EventTypeMap: Record<string, 'keyDown' | 'keyUp' | 'keyPress'> = {\n    keydown: 'keyDown',\n    keyup: 'keyUp',\n    keypress: 'keyPress',\n};\n\n/**\n * DOMEventPlugin handles customized DOM events, including:\n * 1. Keyboard event\n * 2. Mouse event\n * 3. IME state\n * 4. Drop event\n * 5. Focus and blur event\n * 6. Input event\n * 7. Scroll event\n * It contains special handling for Safari since Safari cannot get correct selection when onBlur event is triggered in editor.\n */\nclass DOMEventPlugin implements PluginWithState<DOMEventPluginState> {\n    private editor: IEditor | null = null;\n    private disposer: (() => void) | null = null;\n    private state: DOMEventPluginState;\n\n    /**\n     * Construct a new instance of DOMEventPlugin\n     * @param options The editor options\n     * @param contentDiv The editor content DIV\n     */\n    constructor(options: EditorOptions, contentDiv: HTMLDivElement) {\n        this.state = {\n            isInIME: false,\n            scrollContainer: options.scrollContainer || contentDiv,\n            mouseDownX: null,\n            mouseDownY: null,\n            mouseUpEventListerAdded: false,\n        };\n    }\n\n    /**\n     * Get a friendly name of  this plugin\n     */\n    getName() {\n        return 'DOMEvent';\n    }\n\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n\n        const document = this.editor.getDocument();\n        const eventHandlers: Partial<\n            { [P in keyof HTMLElementEventMap]: DOMEventRecord<HTMLElementEventMap[P]> }\n        > = {\n            // 1. Keyboard event\n            keypress: this.keyboardEventHandler,\n            keydown: this.keyboardEventHandler,\n            keyup: this.keyboardEventHandler,\n            input: this.inputEventHandler,\n\n            // 2. Mouse event\n            mousedown: { beforeDispatch: this.onMouseDown },\n\n            // 3. IME state management\n            compositionstart: { beforeDispatch: this.onCompositionStart },\n            compositionend: { beforeDispatch: this.onCompositionEnd },\n\n            // 4. Drag and Drop event\n            dragstart: { beforeDispatch: this.onDragStart },\n            drop: { beforeDispatch: this.onDrop },\n        };\n\n        this.disposer = this.editor.attachDomEvent(<Record<string, DOMEventRecord>>eventHandlers);\n\n        // 7. Scroll event\n        this.state.scrollContainer.addEventListener('scroll', this.onScroll);\n        document.defaultView?.addEventListener('scroll', this.onScroll);\n        document.defaultView?.addEventListener('resize', this.onScroll);\n    }\n\n    /**\n     * Dispose this plugin\n     */\n    dispose() {\n        this.removeMouseUpEventListener();\n\n        const document = this.editor?.getDocument();\n\n        document?.defaultView?.removeEventListener('resize', this.onScroll);\n        document?.defaultView?.removeEventListener('scroll', this.onScroll);\n        this.state.scrollContainer.removeEventListener('scroll', this.onScroll);\n        this.disposer?.();\n        this.disposer = null;\n        this.editor = null;\n    }\n\n    /**\n     * Get plugin state object\n     */\n    getState() {\n        return this.state;\n    }\n\n    private onDragStart = (e: Event) => {\n        const dragEvent = e as DragEvent;\n        const node = dragEvent.target as Node;\n        const element = isNodeOfType(node, 'ELEMENT_NODE') ? node : node.parentElement;\n\n        if (element && !element.isContentEditable) {\n            dragEvent.preventDefault();\n        }\n    };\n\n    private onDrop = () => {\n        const doc = this.editor?.getDocument();\n\n        doc?.defaultView?.requestAnimationFrame(() => {\n            if (this.editor) {\n                this.editor.takeSnapshot();\n                this.editor.triggerEvent('contentChanged', {\n                    source: ChangeSource.Drop,\n                });\n            }\n        });\n    };\n\n    private onScroll = (e: Event) => {\n        this.editor?.triggerEvent('scroll', {\n            rawEvent: e,\n            scrollContainer: this.state.scrollContainer,\n        });\n    };\n\n    private keyboardEventHandler: DOMEventRecord<KeyboardEvent> = {\n        beforeDispatch: event => {\n            const eventType = EventTypeMap[event.type];\n\n            if (isCharacterValue(event) || isCursorMovingKey(event)) {\n                // Stop propagation for Character keys and Up/Down/Left/Right/Home/End/PageUp/PageDown\n                // since editor already handles these keys and no need to propagate to parents\n                event.stopPropagation();\n            }\n\n            if (this.editor && eventType && !event.isComposing && !this.state.isInIME) {\n                this.editor.triggerEvent(eventType, {\n                    rawEvent: event,\n                });\n            }\n        },\n    };\n\n    private inputEventHandler: DOMEventRecord<Event> = {\n        beforeDispatch: event => {\n            event.stopPropagation();\n\n            if (this.editor && !(event as InputEvent).isComposing && !this.state.isInIME) {\n                this.editor.triggerEvent('input', {\n                    rawEvent: event as InputEvent,\n                });\n            }\n        },\n    };\n\n    private onMouseDown = (event: MouseEvent) => {\n        if (this.editor) {\n            if (!this.state.mouseUpEventListerAdded) {\n                this.editor\n                    .getDocument()\n                    .addEventListener('mouseup', this.onMouseUp, true /*setCapture*/);\n                this.state.mouseUpEventListerAdded = true;\n                this.state.mouseDownX = event.pageX;\n                this.state.mouseDownY = event.pageY;\n            }\n\n            this.editor.triggerEvent('mouseDown', {\n                rawEvent: event,\n            });\n        }\n    };\n\n    private onMouseUp = (rawEvent: MouseEvent) => {\n        if (this.editor) {\n            this.removeMouseUpEventListener();\n            this.editor.triggerEvent('mouseUp', {\n                rawEvent,\n                isClicking:\n                    this.state.mouseDownX == rawEvent.pageX &&\n                    this.state.mouseDownY == rawEvent.pageY,\n            });\n        }\n    };\n\n    private onCompositionStart = () => {\n        this.state.isInIME = true;\n    };\n\n    private onCompositionEnd = (rawEvent: CompositionEvent) => {\n        this.state.isInIME = false;\n        this.editor?.triggerEvent('compositionEnd', {\n            rawEvent,\n        });\n    };\n\n    private removeMouseUpEventListener() {\n        if (this.editor && this.state.mouseUpEventListerAdded) {\n            this.state.mouseUpEventListerAdded = false;\n            this.editor.getDocument().removeEventListener('mouseup', this.onMouseUp, true);\n        }\n    }\n}\n\n/**\n * @internal\n * Create a new instance of DOMEventPlugin.\n * @param option The editor option\n * @param contentDiv The editor content DIV element\n */\nexport function createDOMEventPlugin(\n    option: EditorOptions,\n    contentDiv: HTMLDivElement\n): PluginWithState<DOMEventPluginState> {\n    return new DOMEventPlugin(option, contentDiv);\n}\n","import { findAllEntities } from './utils/findAllEntities';\nimport { transformColor } from '../publicApi/color/transformColor';\nimport {\n    handleCompositionEndEvent,\n    handleDelimiterContentChangedEvent,\n    handleDelimiterKeyDownEvent,\n} from './utils/entityDelimiterUtils';\nimport {\n    createEntity,\n    generateEntityClassNames,\n    getAllEntityWrappers,\n    getObjectKeys,\n    isEntityElement,\n    parseEntityFormat,\n} from 'roosterjs-content-model-dom';\nimport type {\n    ChangedEntity,\n    ContentChangedEvent,\n    EntityOperation,\n    EntityPluginState,\n    IEditor,\n    MouseUpEvent,\n    PluginEvent,\n    PluginWithState,\n} from 'roosterjs-content-model-types';\n\nconst ENTITY_ID_REGEX = /_(\\d{1,8})$/;\n\n/**\n * Entity Plugin helps handle all operations related to an entity and generate entity specified events\n */\nclass EntityPlugin implements PluginWithState<EntityPluginState> {\n    private editor: IEditor | null = null;\n    private state: EntityPluginState;\n\n    /**\n     * Construct a new instance of EntityPlugin\n     */\n    constructor() {\n        this.state = {\n            entityMap: {},\n        };\n    }\n\n    /**\n     * Get a friendly name of  this plugin\n     */\n    getName() {\n        return 'Entity';\n    }\n\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n    }\n\n    /**\n     * Dispose this plugin\n     */\n    dispose() {\n        this.editor = null;\n        this.state.entityMap = {};\n    }\n\n    /**\n     * Get plugin state object\n     */\n    getState() {\n        return this.state;\n    }\n\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    onPluginEvent(event: PluginEvent) {\n        if (this.editor) {\n            switch (event.eventType) {\n                case 'mouseUp':\n                    this.handleMouseUpEvent(this.editor, event);\n                    break;\n                case 'contentChanged':\n                    this.handleContentChangedEvent(this.editor, event);\n                    break;\n                case 'keyDown':\n                    handleDelimiterKeyDownEvent(this.editor, event);\n                    break;\n                case 'compositionEnd':\n                    handleCompositionEndEvent(this.editor, event);\n                    break;\n                case 'editorReady':\n                    this.handleContentChangedEvent(this.editor);\n                    break;\n                case 'extractContentWithDom':\n                    this.handleExtractContentWithDomEvent(this.editor, event.clonedRoot);\n                    break;\n            }\n        }\n    }\n\n    private handleMouseUpEvent(editor: IEditor, event: MouseUpEvent) {\n        const { rawEvent, isClicking } = event;\n        let node: Node | null = rawEvent.target as Node;\n\n        if (isClicking && this.editor) {\n            while (node && this.editor.getDOMHelper().isNodeInEditor(node)) {\n                if (isEntityElement(node)) {\n                    this.triggerEvent(editor, node as HTMLElement, 'click', rawEvent);\n                    break;\n                } else {\n                    node = node.parentNode;\n                }\n            }\n        }\n    }\n\n    private handleContentChangedEvent(editor: IEditor, event?: ContentChangedEvent) {\n        const modifiedEntities: ChangedEntity[] =\n            event?.changedEntities ?? this.getChangedEntities(editor);\n        const entityStates = event?.entityStates;\n\n        modifiedEntities.forEach(entry => {\n            const { entity, operation, rawEvent } = entry;\n            const {\n                entityFormat: { id, entityType, isFakeEntity },\n                wrapper,\n            } = entity;\n\n            if (entityType && !isFakeEntity) {\n                if (operation == 'newEntity') {\n                    entity.entityFormat.id = this.ensureUniqueId(entityType, id ?? '', wrapper);\n                    wrapper.className = generateEntityClassNames(entity.entityFormat);\n\n                    if (entity.entityFormat.isReadonly) {\n                        wrapper.contentEditable = 'false';\n                    }\n\n                    const eventResult = this.triggerEvent(editor, wrapper, operation, rawEvent);\n\n                    this.state.entityMap[entity.entityFormat.id] = {\n                        element: wrapper,\n                        canPersist: eventResult?.shouldPersist,\n                    };\n\n                    if (editor.isDarkMode()) {\n                        transformColor(\n                            wrapper,\n                            true /*includeSelf*/,\n                            'lightToDark',\n                            editor.getColorManager()\n                        );\n                    }\n                } else if (id) {\n                    const mapEntry = this.state.entityMap[id];\n\n                    if (mapEntry) {\n                        mapEntry.isDeleted = true;\n                    }\n\n                    this.triggerEvent(editor, wrapper, operation, rawEvent);\n                }\n            }\n        });\n\n        entityStates?.forEach(entityState => {\n            const { id, state } = entityState;\n            const wrapper = this.state.entityMap[id]?.element;\n\n            if (wrapper) {\n                this.triggerEvent(\n                    editor,\n                    wrapper,\n                    'updateEntityState',\n                    undefined /*rawEvent*/,\n                    state\n                );\n            }\n        });\n\n        handleDelimiterContentChangedEvent(editor);\n    }\n\n    private getChangedEntities(editor: IEditor): ChangedEntity[] {\n        const result: ChangedEntity[] = [];\n\n        editor.formatContentModel(model => {\n            findAllEntities(model, result);\n            return false;\n        });\n\n        getObjectKeys(this.state.entityMap).forEach(id => {\n            const entry = this.state.entityMap[id];\n\n            if (!entry.isDeleted) {\n                const index = result.findIndex(\n                    x =>\n                        x.operation == 'newEntity' &&\n                        x.entity.entityFormat.id == id &&\n                        x.entity.wrapper == entry.element\n                );\n\n                if (index >= 0) {\n                    // Found matched entity in editor, so there is no change to this entity,\n                    // we can safely remove it from the new entity array\n                    result.splice(index, 1);\n                } else {\n                    // Entity is not in editor, which means it is deleted, use a temporary entity here to represent this entity\n                    const format = parseEntityFormat(entry.element);\n\n                    if (!format.isFakeEntity) {\n                        const entity = createEntity(\n                            entry.element,\n                            format.isReadonly,\n                            {},\n                            format.entityType,\n                            format.id\n                        );\n\n                        result.push({\n                            entity: entity,\n                            operation: 'overwrite',\n                        });\n                    }\n                }\n            }\n        });\n\n        return result;\n    }\n\n    private handleExtractContentWithDomEvent(editor: IEditor, root: HTMLElement) {\n        getAllEntityWrappers(root).forEach(element => {\n            element.removeAttribute('contentEditable');\n\n            this.triggerEvent(editor, element, 'replaceTemporaryContent');\n        });\n    }\n\n    private triggerEvent(\n        editor: IEditor,\n        wrapper: HTMLElement,\n        operation: EntityOperation,\n        rawEvent?: Event,\n        state?: string\n    ) {\n        const format = parseEntityFormat(wrapper);\n\n        return format.id && format.entityType && !format.isFakeEntity\n            ? editor.triggerEvent('entityOperation', {\n                  operation: operation,\n                  rawEvent,\n                  entity: {\n                      id: format.id,\n                      type: format.entityType,\n                      isReadonly: !!format.isReadonly,\n                      wrapper,\n                  },\n                  state: operation == 'updateEntityState' ? state : undefined,\n              })\n            : null;\n    }\n\n    private ensureUniqueId(type: string, id: string, wrapper: HTMLElement): string {\n        const match = ENTITY_ID_REGEX.exec(id);\n        const baseId = (match ? id.substr(0, id.length - match[0].length) : id) || type;\n\n        // Make sure entity id is unique\n        let newId = '';\n\n        for (let num = (match && parseInt(match[1])) || 0; ; num++) {\n            newId = num > 0 ? `${baseId}_${num}` : baseId;\n\n            const item = this.state.entityMap[newId];\n\n            if (!item || item.element == wrapper) {\n                break;\n            }\n        }\n\n        return newId;\n    }\n}\n\n/**\n * @internal\n * Create a new instance of EntityPlugin.\n */\nexport function createEntityPlugin(): PluginWithState<EntityPluginState> {\n    return new EntityPlugin();\n}\n","import { applyDefaultFormat } from './utils/applyDefaultFormat';\nimport { applyPendingFormat } from './utils/applyPendingFormat';\nimport { getObjectKeys, isBlockElement, isNodeOfType } from 'roosterjs-content-model-dom';\nimport { isCharacterValue, isCursorMovingKey } from '../publicApi/domUtils/eventUtils';\nimport type {\n    BackgroundColorFormat,\n    FontFamilyFormat,\n    FontSizeFormat,\n    FormatPluginState,\n    IEditor,\n    PluginEvent,\n    PluginWithState,\n    EditorOptions,\n    TextColorFormat,\n} from 'roosterjs-content-model-types';\n\n// During IME input, KeyDown event will have \"Process\" as key\nconst ProcessKey = 'Process';\nconst DefaultStyleKeyMap: Record<\n    keyof (FontFamilyFormat & FontSizeFormat & TextColorFormat & BackgroundColorFormat),\n    keyof CSSStyleDeclaration\n> = {\n    backgroundColor: 'backgroundColor',\n    textColor: 'color',\n    fontFamily: 'fontFamily',\n    fontSize: 'fontSize',\n};\n\n/**\n * FormatPlugin plugins helps editor to do formatting on top of content model.\n * This includes:\n * 1. Handle pending format changes when selection is collapsed\n */\nclass FormatPlugin implements PluginWithState<FormatPluginState> {\n    private editor: IEditor | null = null;\n    private defaultFormatKeys: Set<keyof CSSStyleDeclaration>;\n    private state: FormatPluginState;\n    private lastCheckedNode: Node | null = null;\n\n    /**\n     * Construct a new instance of FormatPlugin class\n     * @param option The editor option\n     */\n    constructor(option: EditorOptions) {\n        this.state = {\n            defaultFormat: { ...option.defaultSegmentFormat },\n            pendingFormat: null,\n        };\n\n        this.defaultFormatKeys = new Set<keyof CSSStyleDeclaration>();\n\n        getObjectKeys(DefaultStyleKeyMap).forEach(key => {\n            if (this.state.defaultFormat[key]) {\n                this.defaultFormatKeys.add(DefaultStyleKeyMap[key]);\n            }\n        });\n    }\n\n    /**\n     * Get name of this plugin\n     */\n    getName() {\n        return 'Format';\n    }\n\n    /**\n     * The first method that editor will call to a plugin when editor is initializing.\n     * It will pass in the editor instance, plugin should take this chance to save the\n     * editor reference so that it can call to any editor method or format API later.\n     * @param editor The editor object\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n    }\n\n    /**\n     * The last method that editor will call to a plugin before it is disposed.\n     * Plugin can take this chance to clear the reference to editor. After this method is\n     * called, plugin should not call to any editor method since it will result in error.\n     */\n    dispose() {\n        this.editor = null;\n    }\n\n    /**\n     * Get plugin state object\n     */\n    getState(): FormatPluginState {\n        return this.state;\n    }\n\n    /**\n     * Core method for a plugin. Once an event happens in editor, editor will call this\n     * method of each plugin to handle the event as long as the event is not handled\n     * exclusively by another plugin.\n     * @param event The event to handle:\n     */\n    onPluginEvent(event: PluginEvent) {\n        if (!this.editor) {\n            return;\n        }\n\n        switch (event.eventType) {\n            case 'input':\n                this.checkAndApplyPendingFormat(event.rawEvent.data);\n\n                break;\n\n            case 'compositionEnd':\n                this.checkAndApplyPendingFormat(event.rawEvent.data);\n                break;\n\n            case 'keyDown':\n                if (isCursorMovingKey(event.rawEvent)) {\n                    this.clearPendingFormat();\n                    this.lastCheckedNode = null;\n                } else if (\n                    this.defaultFormatKeys.size > 0 &&\n                    (isCharacterValue(event.rawEvent) || event.rawEvent.key == ProcessKey) &&\n                    this.shouldApplyDefaultFormat(this.editor)\n                ) {\n                    applyDefaultFormat(this.editor, this.state.defaultFormat);\n                }\n\n                break;\n\n            case 'mouseUp':\n            case 'contentChanged':\n                this.lastCheckedNode = null;\n\n                if (!this.canApplyPendingFormat()) {\n                    this.clearPendingFormat();\n                }\n                break;\n        }\n    }\n\n    private checkAndApplyPendingFormat(data: string | null) {\n        if (this.editor && data && this.state.pendingFormat) {\n            applyPendingFormat(this.editor, data, this.state.pendingFormat.format);\n            this.clearPendingFormat();\n        }\n    }\n\n    private clearPendingFormat() {\n        this.state.pendingFormat = null;\n    }\n\n    /**\n     * @internal\n     * Check if this editor can apply pending format\n     * @param editor The editor to get format from\n     */\n    private canApplyPendingFormat(): boolean {\n        let result = false;\n\n        if (this.state.pendingFormat && this.editor) {\n            const selection = this.editor.getDOMSelection();\n            const range =\n                selection?.type == 'range' && selection.range.collapsed ? selection.range : null;\n            const { posContainer, posOffset } = this.state.pendingFormat;\n\n            if (range && range.startContainer == posContainer && range.startOffset == posOffset) {\n                result = true;\n            }\n        }\n\n        return result;\n    }\n\n    private shouldApplyDefaultFormat(editor: IEditor): boolean {\n        const selection = editor.getDOMSelection();\n        const range = selection?.type == 'range' ? selection.range : null;\n        const posContainer = range?.startContainer ?? null;\n\n        if (posContainer && posContainer != this.lastCheckedNode) {\n            // Cache last checked parent node so no need to check it again if user is keep typing under the same node\n            this.lastCheckedNode = posContainer;\n\n            const domHelper = editor.getDOMHelper();\n            let element: HTMLElement | null = isNodeOfType(posContainer, 'ELEMENT_NODE')\n                ? posContainer\n                : posContainer.parentElement;\n            const foundFormatKeys = new Set<keyof CSSStyleDeclaration>();\n\n            while (element?.parentElement && domHelper.isNodeInEditor(element.parentElement)) {\n                if (element.getAttribute?.('style')) {\n                    const style = element.style;\n                    this.defaultFormatKeys.forEach(key => {\n                        if (style[key]) {\n                            foundFormatKeys.add(key);\n                        }\n                    });\n\n                    if (foundFormatKeys.size == this.defaultFormatKeys.size) {\n                        return false;\n                    }\n                }\n\n                if (isBlockElement(element)) {\n                    break;\n                }\n\n                element = element.parentElement;\n            }\n\n            return true;\n        } else {\n            return false;\n        }\n    }\n}\n\n/**\n * @internal\n * Create a new instance of FormatPlugin.\n * @param option The editor option\n */\nexport function createFormatPlugin(option: EditorOptions): PluginWithState<FormatPluginState> {\n    return new FormatPlugin(option);\n}\n","import { ChangeSource } from '../constants/ChangeSource';\nimport { setColor } from 'roosterjs-content-model-dom';\nimport type {\n    IEditor,\n    LifecyclePluginState,\n    PluginEvent,\n    PluginWithState,\n    EditorOptions,\n} from 'roosterjs-content-model-types';\n\nconst ContentEditableAttributeName = 'contenteditable';\nconst DefaultTextColor = '#000000';\nconst DefaultBackColor = '#ffffff';\n\n/**\n * Lifecycle plugin handles editor initialization and disposing\n */\nclass LifecyclePlugin implements PluginWithState<LifecyclePluginState> {\n    private editor: IEditor | null = null;\n    private state: LifecyclePluginState;\n    private initializer: (() => void) | null = null;\n    private disposer: (() => void) | null = null;\n    private adjustColor: () => void;\n\n    /**\n     * Construct a new instance of LifecyclePlugin\n     * @param options The editor options\n     * @param contentDiv The editor content DIV\n     */\n    constructor(options: EditorOptions, contentDiv: HTMLDivElement) {\n        // Make the container editable and set its selection styles\n        if (contentDiv.getAttribute(ContentEditableAttributeName) === null) {\n            this.initializer = () => {\n                contentDiv.contentEditable = 'true';\n                contentDiv.style.userSelect = 'text';\n            };\n            this.disposer = () => {\n                contentDiv.style.userSelect = '';\n                contentDiv.removeAttribute(ContentEditableAttributeName);\n            };\n        }\n        this.adjustColor = options.doNotAdjustEditorColor\n            ? () => {}\n            : () => {\n                  this.adjustContainerColor(contentDiv);\n              };\n\n        this.state = {\n            isDarkMode: !!options.inDarkMode,\n            shadowEditFragment: null,\n        };\n    }\n\n    /**\n     * Get a friendly name of  this plugin\n     */\n    getName() {\n        return 'Lifecycle';\n    }\n\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n\n        // Set content DIV to be editable\n        this.initializer?.();\n\n        // Set editor background color for dark mode\n        this.adjustColor();\n\n        // Let other plugins know that we are ready\n        this.editor.triggerEvent('editorReady', {}, true /*broadcast*/);\n    }\n\n    /**\n     * Dispose this plugin\n     */\n    dispose() {\n        this.editor?.triggerEvent('beforeDispose', {}, true /*broadcast*/);\n\n        if (this.disposer) {\n            this.disposer();\n            this.disposer = null;\n            this.initializer = null;\n        }\n\n        this.editor = null;\n    }\n\n    /**\n     * Get plugin state object\n     */\n    getState() {\n        return this.state;\n    }\n\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    onPluginEvent(event: PluginEvent) {\n        if (\n            event.eventType == 'contentChanged' &&\n            (event.source == ChangeSource.SwitchToDarkMode ||\n                event.source == ChangeSource.SwitchToLightMode)\n        ) {\n            this.adjustColor();\n        }\n    }\n\n    private adjustContainerColor(contentDiv: HTMLElement) {\n        if (this.editor) {\n            const { isDarkMode } = this.state;\n            const darkColorHandler = this.editor.getColorManager();\n\n            setColor(\n                contentDiv,\n                DefaultTextColor,\n                false /*isBackground*/,\n                isDarkMode,\n                darkColorHandler\n            );\n            setColor(\n                contentDiv,\n                DefaultBackColor,\n                true /*isBackground*/,\n                isDarkMode,\n                darkColorHandler\n            );\n        }\n    }\n}\n\n/**\n * @internal\n * Create a new instance of LifecyclePlugin.\n * @param option The editor option\n * @param contentDiv The editor content DIV element\n */\nexport function createLifecyclePlugin(\n    option: EditorOptions,\n    contentDiv: HTMLDivElement\n): PluginWithState<LifecyclePluginState> {\n    return new LifecyclePlugin(option, contentDiv);\n}\n","import { isElementOfType, isNodeOfType, toArray } from 'roosterjs-content-model-dom';\nimport { isModifierKey } from '../publicApi/domUtils/eventUtils';\nimport type {\n    DOMSelection,\n    IEditor,\n    PluginEvent,\n    PluginWithState,\n    SelectionPluginState,\n    EditorOptions,\n} from 'roosterjs-content-model-types';\n\nconst MouseMiddleButton = 1;\nconst MouseRightButton = 2;\n\nclass SelectionPlugin implements PluginWithState<SelectionPluginState> {\n    private editor: IEditor | null = null;\n    private state: SelectionPluginState;\n    private disposer: (() => void) | null = null;\n    private isSafari = false;\n    private isMac = false;\n\n    constructor(options: EditorOptions) {\n        this.state = {\n            selection: null,\n            selectionStyleNode: null,\n            imageSelectionBorderColor: options.imageSelectionBorderColor,\n        };\n    }\n\n    getName() {\n        return 'Selection';\n    }\n\n    initialize(editor: IEditor) {\n        this.editor = editor;\n\n        const doc = this.editor.getDocument();\n        const styleNode = doc.createElement('style');\n\n        doc.head.appendChild(styleNode);\n        this.state.selectionStyleNode = styleNode;\n\n        const env = this.editor.getEnvironment();\n        const document = this.editor.getDocument();\n\n        this.isSafari = !!env.isSafari;\n        this.isMac = !!env.isMac;\n\n        if (this.isSafari) {\n            document.addEventListener('selectionchange', this.onSelectionChangeSafari);\n            this.disposer = this.editor.attachDomEvent({ focus: { beforeDispatch: this.onFocus } });\n        } else {\n            this.disposer = this.editor.attachDomEvent({\n                focus: { beforeDispatch: this.onFocus },\n                blur: { beforeDispatch: this.onBlur },\n            });\n        }\n    }\n\n    dispose() {\n        this.editor\n            ?.getDocument()\n            .removeEventListener('selectionchange', this.onSelectionChangeSafari);\n\n        if (this.state.selectionStyleNode) {\n            this.state.selectionStyleNode.parentNode?.removeChild(this.state.selectionStyleNode);\n            this.state.selectionStyleNode = null;\n        }\n\n        if (this.disposer) {\n            this.disposer();\n            this.disposer = null;\n        }\n\n        this.editor = null;\n    }\n\n    getState(): SelectionPluginState {\n        return this.state;\n    }\n\n    onPluginEvent(event: PluginEvent) {\n        if (!this.editor) {\n            return;\n        }\n\n        let image: HTMLImageElement | null;\n        let selection: DOMSelection | null;\n\n        switch (event.eventType) {\n            case 'mouseUp':\n                if (\n                    (image = this.getClickingImage(event.rawEvent)) &&\n                    image.isContentEditable &&\n                    event.rawEvent.button != MouseMiddleButton &&\n                    (event.rawEvent.button ==\n                        MouseRightButton /* it's not possible to drag using right click */ ||\n                        event.isClicking)\n                ) {\n                    this.selectImage(this.editor, image);\n                }\n                break;\n\n            case 'mouseDown':\n                selection = this.editor.getDOMSelection();\n                if (\n                    event.rawEvent.button === MouseRightButton &&\n                    (image =\n                        this.getClickingImage(event.rawEvent) ??\n                        this.getContainedTargetImage(event.rawEvent, selection)) &&\n                    image.isContentEditable\n                ) {\n                    this.selectImage(this.editor, image);\n                } else if (\n                    selection?.type == 'image' &&\n                    selection.image !== event.rawEvent.target\n                ) {\n                    this.selectBeforeImage(this.editor, selection.image);\n                }\n                break;\n\n            case 'keyDown':\n                const rawEvent = event.rawEvent;\n                const key = rawEvent.key;\n                selection = this.editor.getDOMSelection();\n\n                if (\n                    !isModifierKey(rawEvent) &&\n                    !rawEvent.shiftKey &&\n                    selection?.type == 'image' &&\n                    selection.image.parentNode\n                ) {\n                    if (key === 'Escape') {\n                        this.selectBeforeImage(this.editor, selection.image);\n                        event.rawEvent.stopPropagation();\n                    } else if (key !== 'Delete' && key !== 'Backspace') {\n                        this.selectBeforeImage(this.editor, selection.image);\n                    }\n                }\n                break;\n        }\n    }\n\n    private selectImage(editor: IEditor, image: HTMLImageElement) {\n        editor.setDOMSelection({\n            type: 'image',\n            image: image,\n        });\n    }\n\n    private selectBeforeImage(editor: IEditor, image: HTMLImageElement) {\n        const doc = editor.getDocument();\n        const parent = image.parentNode;\n        const index = parent && toArray(parent.childNodes).indexOf(image);\n\n        if (parent && index !== null && index >= 0) {\n            const range = doc.createRange();\n            range.setStart(parent, index);\n            range.collapse();\n\n            editor.setDOMSelection({\n                type: 'range',\n                range: range,\n                isReverted: false,\n            });\n        }\n    }\n\n    private getClickingImage(event: UIEvent): HTMLImageElement | null {\n        const target = event.target as Node;\n\n        return isNodeOfType(target, 'ELEMENT_NODE') && isElementOfType(target, 'img')\n            ? target\n            : null;\n    }\n\n    //MacOS will not create a mouseUp event if contextMenu event is not prevent defaulted.\n    //Make sure we capture image target even if image is wrapped\n    private getContainedTargetImage = (\n        event: MouseEvent,\n        previousSelection: DOMSelection | null\n    ): HTMLImageElement | null => {\n        if (!this.isMac || !previousSelection || previousSelection.type !== 'image') {\n            return null;\n        }\n\n        const target = event.target as Node;\n        if (\n            isNodeOfType(target, 'ELEMENT_NODE') &&\n            isElementOfType(target, 'span') &&\n            target.firstChild === previousSelection.image\n        ) {\n            return previousSelection.image;\n        }\n        return null;\n    };\n\n    private onFocus = () => {\n        if (!this.state.skipReselectOnFocus && this.state.selection) {\n            this.editor?.setDOMSelection(this.state.selection);\n        }\n\n        if (this.state.selection?.type == 'range' && !this.isSafari) {\n            // Editor is focused, now we can get live selection. So no need to keep a selection if the selection type is range.\n            this.state.selection = null;\n        }\n    };\n\n    private onBlur = () => {\n        if (!this.state.selection && this.editor) {\n            this.state.selection = this.editor.getDOMSelection();\n        }\n    };\n\n    private onSelectionChangeSafari = () => {\n        if (this.editor?.hasFocus() && !this.editor.isInShadowEdit()) {\n            // Safari has problem to handle onBlur event. When blur, we cannot get the original selection from editor.\n            // So we always save a selection whenever editor has focus. Then after blur, we can still use this cached selection.\n            const newSelection = this.editor.getDOMSelection();\n\n            if (newSelection?.type == 'range') {\n                this.state.selection = newSelection;\n            }\n        }\n    };\n}\n\n/**\n * @internal\n * Create a new instance of SelectionPlugin.\n * @param option The editor option\n */\nexport function createSelectionPlugin(\n    options: EditorOptions\n): PluginWithState<SelectionPluginState> {\n    return new SelectionPlugin(options);\n}\n","import { ChangeSource } from '../constants/ChangeSource';\nimport { createSnapshotsManager } from '../editor/SnapshotsManagerImpl';\nimport { isCursorMovingKey } from '../publicApi/domUtils/eventUtils';\nimport { undo } from '../publicApi/undo/undo';\nimport type {\n    ContentChangedEvent,\n    IEditor,\n    PluginEvent,\n    PluginWithState,\n    EditorOptions,\n    UndoPluginState,\n} from 'roosterjs-content-model-types';\n\nconst Backspace = 'Backspace';\nconst Delete = 'Delete';\nconst Enter = 'Enter';\n\n/**\n * Provides snapshot based undo service for Editor\n */\nclass UndoPlugin implements PluginWithState<UndoPluginState> {\n    private editor: IEditor | null = null;\n    private state: UndoPluginState;\n\n    /**\n     * Construct a new instance of UndoPlugin\n     * @param options The wrapper of the state object\n     */\n    constructor(options: EditorOptions) {\n        this.state = {\n            snapshotsManager: createSnapshotsManager(options.snapshots),\n            isRestoring: false,\n            isNested: false,\n            posContainer: null,\n            posOffset: null,\n            lastKeyPress: null,\n        };\n    }\n\n    /**\n     * Get a friendly name of  this plugin\n     */\n    getName() {\n        return 'Undo';\n    }\n\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    initialize(editor: IEditor): void {\n        this.editor = editor;\n    }\n\n    /**\n     * Dispose this plugin\n     */\n    dispose() {\n        this.editor = null;\n    }\n\n    /**\n     * Get plugin state object\n     */\n    getState() {\n        return this.state;\n    }\n\n    /**\n     * Check if the plugin should handle the given event exclusively.\n     * @param event The event to check\n     */\n    willHandleEventExclusively(event: PluginEvent) {\n        return (\n            !!this.editor &&\n            event.eventType == 'keyDown' &&\n            event.rawEvent.key == Backspace &&\n            !event.rawEvent.ctrlKey &&\n            this.canUndoAutoComplete(this.editor)\n        );\n    }\n\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    onPluginEvent(event: PluginEvent): void {\n        if (!this.editor) {\n            return;\n        }\n\n        switch (event.eventType) {\n            case 'editorReady':\n                const manager = this.state.snapshotsManager;\n                const canUndo = manager.hasNewContent || manager.canMove(-1);\n                const canRedo = manager.canMove(1);\n\n                if (!canUndo && !canRedo) {\n                    // Only add initial snapshot when there is no existing snapshot\n                    // Otherwise preserved undo/redo state may be ruined\n                    this.addUndoSnapshot();\n                }\n                break;\n            case 'keyDown':\n                this.onKeyDown(this.editor, event.rawEvent);\n                break;\n            case 'keyPress':\n                this.onKeyPress(this.editor, event.rawEvent);\n                break;\n            case 'compositionEnd':\n                this.clearRedoForInput();\n                this.addUndoSnapshot();\n                break;\n            case 'contentChanged':\n                this.onContentChanged(event);\n                break;\n            case 'beforeKeyboardEditing':\n                this.onBeforeKeyboardEditing(event.rawEvent);\n                break;\n        }\n    }\n\n    private onKeyDown(editor: IEditor, evt: KeyboardEvent): void {\n        const { snapshotsManager } = this.state;\n\n        // Handle backspace/delete when there is a selection to take a snapshot\n        // since we want the state prior to deletion restorable\n        // Ignore if keycombo is ALT+BACKSPACE\n        if ((evt.key == Backspace && !evt.altKey) || evt.key == Delete) {\n            if (evt.key == Backspace && !evt.ctrlKey && this.canUndoAutoComplete(editor)) {\n                evt.preventDefault();\n                undo(editor);\n                this.state.posContainer = null;\n                this.state.posOffset = null;\n                this.state.lastKeyPress = evt.key;\n            } else if (!evt.defaultPrevented) {\n                const selection = editor.getDOMSelection();\n\n                // Add snapshot when\n                // 1. Something has been selected (not collapsed), or\n                // 2. It has a different key code from the last keyDown event (to prevent adding too many snapshot when keeping press the same key), or\n                // 3. Ctrl/Meta key is pressed so that a whole word will be deleted\n                if (\n                    selection &&\n                    (selection.type != 'range' ||\n                        !selection.range.collapsed ||\n                        this.state.lastKeyPress != evt.key ||\n                        this.isCtrlOrMetaPressed(editor, evt))\n                ) {\n                    this.addUndoSnapshot();\n                }\n\n                // Since some content is deleted, always set hasNewContent to true so that we will take undo snapshot next time\n                snapshotsManager.hasNewContent = true;\n                this.state.lastKeyPress = evt.key;\n            }\n        } else if (isCursorMovingKey(evt)) {\n            // PageUp, PageDown, Home, End, Left, Right, Up, Down\n            if (snapshotsManager.hasNewContent) {\n                this.addUndoSnapshot();\n            }\n            this.state.lastKeyPress = null;\n        } else if (this.state.lastKeyPress == Backspace || this.state.lastKeyPress == Delete) {\n            if (snapshotsManager.hasNewContent) {\n                this.addUndoSnapshot();\n            }\n        }\n    }\n\n    private onKeyPress(editor: IEditor, evt: KeyboardEvent): void {\n        if (evt.metaKey) {\n            // if metaKey is pressed, simply return since no actual effect will be taken on the editor.\n            // this is to prevent changing hasNewContent to true when meta + v to paste on Safari.\n            return;\n        }\n\n        const selection = editor.getDOMSelection();\n\n        if (\n            (selection && (selection.type != 'range' || !selection.range.collapsed)) ||\n            (evt.key == ' ' && this.state.lastKeyPress != ' ') ||\n            evt.key == Enter\n        ) {\n            this.addUndoSnapshot();\n\n            if (evt.key == Enter) {\n                // Treat ENTER as new content so if there is no input after ENTER and undo,\n                // we restore the snapshot before ENTER\n                this.state.snapshotsManager.hasNewContent = true;\n            }\n        } else {\n            this.clearRedoForInput();\n        }\n\n        this.state.lastKeyPress = evt.key;\n    }\n\n    private onBeforeKeyboardEditing(event: KeyboardEvent) {\n        // For keyboard event (triggered from Content Model), we can get its keycode from event.data\n        // And when user is keep pressing the same key, mark editor with \"hasNewContent\" so that next time user\n        // do some other action or press a different key, we will add undo snapshot\n        if (event.key != this.state.lastKeyPress) {\n            this.addUndoSnapshot();\n        }\n\n        this.state.lastKeyPress = event.key;\n        this.state.snapshotsManager.hasNewContent = true;\n    }\n\n    private onContentChanged(event: ContentChangedEvent) {\n        if (\n            !(\n                this.state.isRestoring ||\n                event.source == ChangeSource.SwitchToDarkMode ||\n                event.source == ChangeSource.SwitchToLightMode ||\n                event.source == ChangeSource.Keyboard\n            )\n        ) {\n            this.clearRedoForInput();\n        }\n    }\n\n    private clearRedoForInput() {\n        this.state.snapshotsManager.clearRedo();\n        this.state.lastKeyPress = null;\n        this.state.snapshotsManager.hasNewContent = true;\n    }\n\n    private canUndoAutoComplete(editor: IEditor) {\n        const selection = editor.getDOMSelection();\n\n        return (\n            this.state.snapshotsManager.canUndoAutoComplete() &&\n            selection?.type == 'range' &&\n            selection.range.collapsed &&\n            selection.range.startContainer == this.state.posContainer &&\n            selection.range.startOffset == this.state.posOffset\n        );\n    }\n\n    private addUndoSnapshot() {\n        this.editor?.takeSnapshot();\n        this.state.posContainer = null;\n        this.state.posOffset = null;\n    }\n\n    private isCtrlOrMetaPressed(editor: IEditor, event: KeyboardEvent) {\n        const env = editor.getEnvironment();\n\n        return env.isMac ? event.metaKey : event.ctrlKey;\n    }\n}\n\n/**\n * @internal\n * Create a new instance of UndoPlugin.\n * @param option The editor option\n */\nexport function createUndoPlugin(option: EditorOptions): PluginWithState<UndoPluginState> {\n    return new UndoPlugin(option);\n}\n","import { createCachePlugin } from './CachePlugin';\nimport { createContextMenuPlugin } from './ContextMenuPlugin';\nimport { createCopyPastePlugin } from './CopyPastePlugin';\nimport { createDOMEventPlugin } from './DOMEventPlugin';\nimport { createEntityPlugin } from './EntityPlugin';\nimport { createFormatPlugin } from './FormatPlugin';\nimport { createLifecyclePlugin } from './LifecyclePlugin';\nimport { createSelectionPlugin } from './SelectionPlugin';\nimport { createUndoPlugin } from './UndoPlugin';\nimport type { EditorCorePlugins, EditorOptions } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Create core plugins for editor\n * @param options Options of editor\n */\nexport function createEditorCorePlugins(\n    options: EditorOptions,\n    contentDiv: HTMLDivElement\n): EditorCorePlugins {\n    return {\n        cache: createCachePlugin(options, contentDiv),\n        format: createFormatPlugin(options),\n        copyPaste: createCopyPastePlugin(options),\n        domEvent: createDOMEventPlugin(options, contentDiv),\n        lifecycle: createLifecyclePlugin(options, contentDiv),\n        entity: createEntityPlugin(),\n        selection: createSelectionPlugin(options),\n        contextMenu: createContextMenuPlugin(options),\n        undo: createUndoPlugin(options),\n    };\n}\n","/**\n * @internal\n */\nexport function addRangeToSelection(doc: Document, range: Range, isReverted: boolean = false) {\n    const selection = doc.defaultView?.getSelection();\n\n    if (selection) {\n        selection.removeAllRanges();\n\n        if (!isReverted) {\n            selection.addRange(range);\n        } else {\n            selection.setBaseAndExtent(\n                range.endContainer,\n                range.endOffset,\n                range.startContainer,\n                range.startOffset\n            );\n        }\n    }\n}\n","import { deleteSelection } from '../../publicApi/selection/deleteSelection';\nimport { normalizeContentModel } from 'roosterjs-content-model-dom';\nimport type { ContentModelSegmentFormat, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * When necessary, set default format as current pending format so it will be applied when Input event is fired\n * @param editor The editor object\n * @param defaultFormat The default segment format to apply\n */\nexport function applyDefaultFormat(editor: IEditor, defaultFormat: ContentModelSegmentFormat) {\n    editor.formatContentModel((model, context) => {\n        const result = deleteSelection(model, [], context);\n\n        if (result.deleteResult == 'range') {\n            normalizeContentModel(model);\n\n            editor.takeSnapshot();\n\n            return true;\n        } else if (result.deleteResult == 'notDeleted' && result.insertPoint) {\n            const { paragraph, path, marker } = result.insertPoint;\n            const blocks = path[0].blocks;\n            const blockCount = blocks.length;\n            const blockIndex = blocks.indexOf(paragraph);\n\n            if (\n                paragraph.isImplicit &&\n                paragraph.segments.length == 1 &&\n                paragraph.segments[0] == marker &&\n                blockCount > 0 &&\n                blockIndex == blockCount - 1\n            ) {\n                // Focus is in the last paragraph which is implicit and there is not other segments.\n                // This can happen when focus is moved after all other content under current block group.\n                // We need to check if browser will merge focus into previous paragraph by checking if\n                // previous block is block. If previous block is paragraph, browser will most likely merge\n                // the input into previous paragraph, then nothing need to do here. Otherwise we need to\n                // apply pending format since this input event will start a new real paragraph.\n                const previousBlock = blocks[blockIndex - 1];\n\n                if (previousBlock?.blockType != 'Paragraph') {\n                    context.newPendingFormat = getNewPendingFormat(\n                        editor,\n                        defaultFormat,\n                        marker.format\n                    );\n                }\n            } else if (paragraph.segments.every(x => x.segmentType != 'Text')) {\n                context.newPendingFormat = getNewPendingFormat(\n                    editor,\n                    defaultFormat,\n                    marker.format\n                );\n            }\n        }\n\n        // We didn't do any change but just apply default format to pending format, so no need to write back\n        return false;\n    });\n}\n\nfunction getNewPendingFormat(\n    editor: IEditor,\n    defaultFormat: ContentModelSegmentFormat,\n    markerFormat: ContentModelSegmentFormat\n): ContentModelSegmentFormat {\n    return {\n        ...defaultFormat,\n        ...editor.getPendingFormat(),\n        ...markerFormat,\n    };\n}\n","import { iterateSelections } from '../../publicApi/selection/iterateSelections';\nimport type { ContentModelSegmentFormat, IEditor } from 'roosterjs-content-model-types';\nimport {\n    createText,\n    normalizeContentModel,\n    setParagraphNotImplicit,\n} from 'roosterjs-content-model-dom';\n\nconst ANSI_SPACE = '\\u0020';\nconst NON_BREAK_SPACE = '\\u00A0';\n\n/**\n * @internal\n * Apply pending format to the text user just input\n * @param editor The editor to get format from\n * @param data The text user just input\n */\nexport function applyPendingFormat(\n    editor: IEditor,\n    data: string,\n    format: ContentModelSegmentFormat\n) {\n    let isChanged = false;\n\n    editor.formatContentModel(\n        (model, context) => {\n            iterateSelections(model, (_, __, block, segments) => {\n                if (\n                    block?.blockType == 'Paragraph' &&\n                    segments?.length == 1 &&\n                    segments[0].segmentType == 'SelectionMarker'\n                ) {\n                    const marker = segments[0];\n                    const index = block.segments.indexOf(marker);\n                    const previousSegment = block.segments[index - 1];\n\n                    if (previousSegment?.segmentType == 'Text') {\n                        const text = previousSegment.text;\n                        const subStr = text.substr(-data.length, data.length);\n\n                        // For space, there can be &#32 (space) or &#160 (&nbsp;), we treat them as the same\n                        if (subStr == data || (data == ANSI_SPACE && subStr == NON_BREAK_SPACE)) {\n                            marker.format = { ...format };\n                            previousSegment.text = text.substring(0, text.length - data.length);\n\n                            const newText = createText(\n                                data == ANSI_SPACE ? NON_BREAK_SPACE : data,\n                                {\n                                    ...previousSegment.format,\n                                    ...format,\n                                }\n                            );\n\n                            block.segments.splice(index, 0, newText);\n                            setParagraphNotImplicit(block);\n                            isChanged = true;\n                        }\n                    }\n                }\n                return true;\n            });\n\n            if (isChanged) {\n                normalizeContentModel(model);\n                context.skipUndoSnapshot = true;\n            }\n\n            return isChanged;\n        },\n        {\n            apiName: 'applyPendingFormat',\n        }\n    );\n}\n","import type { DOMSelection } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Check if the given selections are the same\n */\nexport function areSameSelection(sel1: DOMSelection, sel2: DOMSelection): boolean {\n    if (sel1 == sel2) {\n        return true;\n    }\n\n    switch (sel1.type) {\n        case 'image':\n            return sel2.type == 'image' && sel2.image == sel1.image;\n\n        case 'table':\n            return (\n                sel2.type == 'table' &&\n                sel2.table == sel1.table &&\n                sel2.firstColumn == sel1.firstColumn &&\n                sel2.lastColumn == sel1.lastColumn &&\n                sel2.firstRow == sel1.firstRow &&\n                sel2.lastRow == sel1.lastRow\n            );\n\n        case 'range':\n        default:\n            return sel2.type == 'range' && areSameRanges(sel2.range, sel1.range);\n    }\n}\n\nfunction areSameRanges(r1?: Range, r2?: Range): boolean {\n    return !!(\n        r1 &&\n        r2 &&\n        r1.startContainer == r2.startContainer &&\n        r1.startOffset == r2.startOffset &&\n        r1.endContainer == r2.endContainer &&\n        r1.endOffset == r2.endOffset\n    );\n}\n","import hasSelectionInBlock from '../../publicApi/selection/hasSelectionInBlock';\nimport hasSelectionInBlockGroup from '../../publicApi/selection/hasSelectionInBlockGroup';\nimport { getClosestAncestorBlockGroupIndex } from '../../publicApi/model/getClosestAncestorBlockGroupIndex';\nimport type {\n    ContentModelBlock,\n    DeleteSelectionContext,\n    DeleteSelectionStep,\n} from 'roosterjs-content-model-types';\n\nfunction isEmptyBlock(block: ContentModelBlock | undefined): boolean {\n    if (block && block.blockType == 'Paragraph') {\n        return block.segments.every(\n            segment => segment.segmentType !== 'SelectionMarker' && segment.segmentType == 'Br'\n        );\n    }\n\n    if (block && block.blockType == 'BlockGroup') {\n        return block.blocks.every(isEmptyBlock);\n    }\n\n    return !!block;\n}\n\n/**\n * @internal\n * If the first item o the list is selected in a expanded selection, we need to remove the list item levels\n * @param context A context object provided by formatContentModel API\n */\nexport const deleteEmptyList: DeleteSelectionStep = (context: DeleteSelectionContext) => {\n    const { insertPoint, deleteResult } = context;\n    if (deleteResult == 'range' && insertPoint?.path) {\n        const index = getClosestAncestorBlockGroupIndex(\n            insertPoint.path,\n            ['ListItem'],\n            ['TableCell']\n        );\n        const item = insertPoint.path[index];\n        if (index >= 0 && item && item.blockGroupType == 'ListItem') {\n            const listItemIndex = insertPoint.path[index + 1].blocks.indexOf(item);\n            const previousBlock =\n                listItemIndex > -1\n                    ? insertPoint.path[index + 1].blocks[listItemIndex - 1]\n                    : undefined;\n            const nextBlock =\n                listItemIndex > -1\n                    ? insertPoint.path[index + 1].blocks[listItemIndex + 1]\n                    : undefined;\n            if (\n                hasSelectionInBlockGroup(item) &&\n                (!previousBlock || hasSelectionInBlock(previousBlock)) &&\n                nextBlock &&\n                isEmptyBlock(nextBlock)\n            ) {\n                item.levels = [];\n            }\n        }\n    }\n};\n","import { createSelectionMarker, createText, isNodeOfType } from 'roosterjs-content-model-dom';\nimport { setSelection } from '../../publicApi/selection/setSelection';\nimport type {\n    ContentModelDocument,\n    ContentModelParagraph,\n    ContentModelSegment,\n    ContentModelSelectionMarker,\n    ContentModelTable,\n    ContentModelTableRow,\n    ContentModelText,\n    DomIndexer,\n    DOMSelection,\n    Selectable,\n} from 'roosterjs-content-model-types';\n\ninterface SegmentItem {\n    paragraph: ContentModelParagraph;\n    segments: ContentModelSegment[];\n}\n\ninterface TableItem {\n    tableRows: ContentModelTableRow[];\n}\n\ninterface IndexedSegmentNode extends Node {\n    __roosterjsContentModel: SegmentItem;\n}\n\ninterface IndexedTableElement extends HTMLTableElement {\n    __roosterjsContentModel: TableItem;\n}\n\nfunction isIndexedSegment(node: Node): node is IndexedSegmentNode {\n    const { paragraph, segments } = (node as IndexedSegmentNode).__roosterjsContentModel ?? {};\n\n    return (\n        paragraph &&\n        paragraph.blockType == 'Paragraph' &&\n        Array.isArray(paragraph.segments) &&\n        Array.isArray(segments)\n    );\n}\n\nfunction onSegment(\n    segmentNode: Node,\n    paragraph: ContentModelParagraph,\n    segment: ContentModelSegment[]\n) {\n    const indexedText = segmentNode as IndexedSegmentNode;\n    indexedText.__roosterjsContentModel = {\n        paragraph,\n        segments: segment,\n    };\n}\n\nfunction onParagraph(paragraphElement: HTMLElement) {\n    let previousText: Text | null = null;\n\n    for (let child = paragraphElement.firstChild; child; child = child.nextSibling) {\n        if (isNodeOfType(child, 'TEXT_NODE')) {\n            if (!previousText) {\n                previousText = child;\n            } else {\n                const item = isIndexedSegment(previousText)\n                    ? previousText.__roosterjsContentModel\n                    : undefined;\n\n                if (item && isIndexedSegment(child)) {\n                    item.segments = item.segments.concat(child.__roosterjsContentModel.segments);\n                    child.__roosterjsContentModel.segments = [];\n                }\n            }\n        } else if (isNodeOfType(child, 'ELEMENT_NODE')) {\n            previousText = null;\n\n            onParagraph(child);\n        } else {\n            previousText = null;\n        }\n    }\n}\n\nfunction onTable(tableElement: HTMLTableElement, table: ContentModelTable) {\n    const indexedTable = tableElement as IndexedTableElement;\n    indexedTable.__roosterjsContentModel = { tableRows: table.rows };\n}\n\nfunction reconcileSelection(\n    model: ContentModelDocument,\n    newSelection: DOMSelection,\n    oldSelection?: DOMSelection\n): boolean {\n    if (oldSelection) {\n        if (\n            oldSelection.type == 'range' &&\n            oldSelection.range.collapsed &&\n            isNodeOfType(oldSelection.range.startContainer, 'TEXT_NODE')\n        ) {\n            if (isIndexedSegment(oldSelection.range.startContainer)) {\n                reconcileTextSelection(oldSelection.range.startContainer);\n            }\n        } else {\n            setSelection(model);\n        }\n    }\n\n    switch (newSelection.type) {\n        case 'image':\n        case 'table':\n            // For image and table selection, we just clear the cached model since during selecting the element id might be changed\n            return false;\n\n        case 'range':\n            const newRange = newSelection.range;\n            if (newRange) {\n                const {\n                    startContainer,\n                    startOffset,\n                    endContainer,\n                    endOffset,\n                    collapsed,\n                } = newRange;\n\n                if (collapsed) {\n                    return !!reconcileNodeSelection(startContainer, startOffset);\n                } else if (\n                    startContainer == endContainer &&\n                    isNodeOfType(startContainer, 'TEXT_NODE')\n                ) {\n                    return (\n                        isIndexedSegment(startContainer) &&\n                        !!reconcileTextSelection(startContainer, startOffset, endOffset)\n                    );\n                } else {\n                    const marker1 = reconcileNodeSelection(startContainer, startOffset);\n                    const marker2 = reconcileNodeSelection(endContainer, endOffset);\n\n                    if (marker1 && marker2) {\n                        setSelection(model, marker1, marker2);\n                        return true;\n                    } else {\n                        return false;\n                    }\n                }\n            }\n\n            break;\n    }\n\n    return false;\n}\n\nfunction reconcileNodeSelection(node: Node, offset: number): Selectable | undefined {\n    if (isNodeOfType(node, 'TEXT_NODE')) {\n        return isIndexedSegment(node) ? reconcileTextSelection(node, offset) : undefined;\n    } else if (offset >= node.childNodes.length) {\n        return insertMarker(node.lastChild, true /*isAfter*/);\n    } else {\n        return insertMarker(node.childNodes[offset], false /*isAfter*/);\n    }\n}\n\nfunction insertMarker(node: Node | null, isAfter: boolean): Selectable | undefined {\n    let marker: ContentModelSelectionMarker | undefined;\n\n    if (node && isIndexedSegment(node)) {\n        const { paragraph, segments } = node.__roosterjsContentModel;\n        const index = paragraph.segments.indexOf(segments[0]);\n\n        if (index >= 0) {\n            const formatSegment =\n                (!isAfter && paragraph.segments[index - 1]) || paragraph.segments[index];\n            marker = createSelectionMarker(formatSegment.format);\n\n            paragraph.segments.splice(isAfter ? index + 1 : index, 0, marker);\n        }\n    }\n\n    return marker;\n}\n\nfunction reconcileTextSelection(\n    textNode: IndexedSegmentNode,\n    startOffset?: number,\n    endOffset?: number\n) {\n    const { paragraph, segments } = textNode.__roosterjsContentModel;\n    const first = segments[0];\n    const last = segments[segments.length - 1];\n    let selectable: Selectable | undefined;\n\n    if (first?.segmentType == 'Text' && last?.segmentType == 'Text') {\n        const newSegments: ContentModelSegment[] = [];\n        const txt = textNode.nodeValue || '';\n        const textSegments: ContentModelText[] = [];\n\n        if (startOffset === undefined) {\n            first.text = txt;\n            newSegments.push(first);\n            textSegments.push(first);\n        } else {\n            if (startOffset > 0) {\n                first.text = txt.substring(0, startOffset);\n                newSegments.push(first);\n                textSegments.push(first);\n            }\n\n            if (endOffset === undefined) {\n                const marker = createSelectionMarker(first.format);\n                newSegments.push(marker);\n\n                selectable = marker;\n                endOffset = startOffset;\n            } else if (endOffset > startOffset) {\n                const middle = createText(\n                    txt.substring(startOffset, endOffset),\n                    first.format,\n                    first.link,\n                    first.code\n                );\n\n                middle.isSelected = true;\n                newSegments.push(middle);\n                textSegments.push(middle);\n                selectable = middle;\n            }\n\n            if (endOffset < txt.length) {\n                const newLast = createText(\n                    txt.substring(endOffset),\n                    first.format,\n                    first.link,\n                    first.code\n                );\n                newSegments.push(newLast);\n                textSegments.push(newLast);\n            }\n        }\n\n        let firstIndex = paragraph.segments.indexOf(first);\n        let lastIndex = paragraph.segments.indexOf(last);\n\n        if (firstIndex >= 0 && lastIndex >= 0) {\n            while (\n                firstIndex > 0 &&\n                paragraph.segments[firstIndex - 1].segmentType == 'SelectionMarker'\n            ) {\n                firstIndex--;\n            }\n\n            while (\n                lastIndex < paragraph.segments.length - 1 &&\n                paragraph.segments[lastIndex + 1].segmentType == 'SelectionMarker'\n            ) {\n                lastIndex++;\n            }\n\n            paragraph.segments.splice(firstIndex, lastIndex - firstIndex + 1, ...newSegments);\n        }\n\n        onSegment(textNode, paragraph, textSegments);\n\n        delete paragraph.cachedElement;\n    }\n\n    return selectable;\n}\n\n/**\n * @internal\n * Implementation of DomIndexer\n */\nexport const domIndexerImpl: DomIndexer = {\n    onSegment,\n    onParagraph,\n    onTable,\n    reconcileSelection,\n};\n","import { isCharacterValue } from '../../publicApi/domUtils/eventUtils';\nimport { iterateSelections } from '../../publicApi/selection/iterateSelections';\nimport type {\n    CompositionEndEvent,\n    ContentModelBlockGroup,\n    ContentModelFormatter,\n    ContentModelParagraph,\n    ContentModelSegmentFormat,\n    IEditor,\n    KeyDownEvent,\n    RangeSelection,\n} from 'roosterjs-content-model-types';\nimport {\n    addDelimiters,\n    createBr,\n    createModelToDomContext,\n    createParagraph,\n    isEntityDelimiter,\n    isEntityElement,\n    isNodeOfType,\n} from 'roosterjs-content-model-dom';\n\nconst DelimiterBefore = 'entityDelimiterBefore';\nconst DelimiterAfter = 'entityDelimiterAfter';\nconst DelimiterSelector = '.' + DelimiterAfter + ',.' + DelimiterBefore;\nconst ZeroWidthSpace = '\\u200B';\nconst EntityInfoName = '_Entity';\nconst InlineEntitySelector = 'span.' + EntityInfoName;\nconst BlockEntityContainer = '_E_EBlockEntityContainer';\nconst BlockEntityContainerSelector = '.' + BlockEntityContainer;\n\n/**\n * @internal exported only for unit test\n */\nexport function preventTypeInDelimiter(node: HTMLElement, editor: IEditor) {\n    const isAfter = node.classList.contains(DelimiterAfter);\n    const entitySibling = isAfter ? node.previousElementSibling : node.nextElementSibling;\n    if (entitySibling && isEntityElement(entitySibling)) {\n        removeInvalidDelimiters(\n            [entitySibling.previousElementSibling, entitySibling.nextElementSibling].filter(\n                element => !!element\n            ) as HTMLElement[]\n        );\n        editor.formatContentModel((model, context) => {\n            iterateSelections(model, (_path, _tableContext, block, _segments) => {\n                if (block?.blockType == 'Paragraph') {\n                    block.segments.forEach(segment => {\n                        if (segment.segmentType == 'Text') {\n                            segment.text = segment.text.replace(ZeroWidthSpace, '');\n                        }\n                    });\n                }\n            });\n\n            context.skipUndoSnapshot = true;\n\n            return true;\n        });\n    }\n}\n\nfunction addDelimitersIfNeeded(\n    nodes: Element[] | NodeListOf<Element>,\n    format: ContentModelSegmentFormat | null\n) {\n    if (nodes.length > 0) {\n        const context = createModelToDomContext();\n        nodes.forEach(node => {\n            if (\n                isNodeOfType(node, 'ELEMENT_NODE') &&\n                isEntityElement(node) &&\n                !node.isContentEditable\n            ) {\n                addDelimiters(node.ownerDocument, node as HTMLElement, format, context);\n            }\n        });\n    }\n}\n\nfunction removeNode(el: Node | undefined | null) {\n    el?.parentElement?.removeChild(el);\n}\n\nfunction removeInvalidDelimiters(nodes: Element[] | NodeListOf<Element>) {\n    nodes.forEach(node => {\n        if (!isNodeOfType(node, 'ELEMENT_NODE')) {\n            return;\n        }\n        if (isEntityDelimiter(node)) {\n            const sibling = node.classList.contains(DelimiterBefore)\n                ? node.nextElementSibling\n                : node.previousElementSibling;\n            if (!(isNodeOfType(sibling, 'ELEMENT_NODE') && isEntityElement(sibling))) {\n                removeNode(node);\n            }\n        } else {\n            removeDelimiterAttr(node);\n        }\n    });\n}\n\nfunction removeDelimiterAttr(node: Element | undefined | null, checkEntity: boolean = true) {\n    if (!node) {\n        return;\n    }\n\n    const isAfter = node.classList.contains(DelimiterAfter);\n    const entitySibling = isAfter ? node.previousElementSibling : node.nextElementSibling;\n    if (checkEntity && entitySibling && isEntityElement(entitySibling)) {\n        return;\n    }\n\n    node.classList.remove(DelimiterAfter, DelimiterBefore);\n\n    node.normalize();\n    node.childNodes.forEach(cn => {\n        const index = cn.textContent?.indexOf(ZeroWidthSpace) ?? -1;\n        if (index >= 0) {\n            const range = new Range();\n            range.setStart(cn, index);\n            range.setEnd(cn, index + 1);\n            range.deleteContents();\n        }\n    });\n}\n\nfunction getFocusedElement(\n    selection: RangeSelection,\n    existingTextInDelimiter?: string\n): HTMLElement | null {\n    const { range, isReverted } = selection;\n    let node: Node | null = isReverted ? range.startContainer : range.endContainer;\n    let offset = isReverted ? range.startOffset : range.endOffset;\n\n    while (node?.lastChild) {\n        if (offset == node.childNodes.length) {\n            node = node.lastChild;\n            offset = node.childNodes.length;\n        } else {\n            node = node.childNodes[offset];\n            offset = 0;\n        }\n    }\n\n    if (!isNodeOfType(node, 'ELEMENT_NODE')) {\n        const textToCheck = existingTextInDelimiter\n            ? ZeroWidthSpace + existingTextInDelimiter\n            : ZeroWidthSpace;\n\n        if (node.textContent != textToCheck && (node.textContent || '').length == offset) {\n            node = node.nextSibling ?? node.parentElement?.closest(DelimiterSelector) ?? null;\n        } else {\n            node = node?.parentElement?.closest(DelimiterSelector) ?? null;\n        }\n    } else {\n        node = node.childNodes.length == offset ? node : node.childNodes.item(offset);\n    }\n    if (node && !node.hasChildNodes()) {\n        node = node.nextSibling;\n    }\n    return isNodeOfType(node, 'ELEMENT_NODE') ? node : null;\n}\n\n/**\n * @internal\n */\nexport function handleDelimiterContentChangedEvent(editor: IEditor) {\n    const helper = editor.getDOMHelper();\n    removeInvalidDelimiters(helper.queryElements(DelimiterSelector));\n    addDelimitersIfNeeded(helper.queryElements(InlineEntitySelector), editor.getPendingFormat());\n}\n\n/**\n * @internal\n */\nexport function handleCompositionEndEvent(editor: IEditor, event: CompositionEndEvent) {\n    const selection = editor.getDOMSelection();\n\n    if (selection?.type == 'range' && selection.range.collapsed) {\n        const node = getFocusedElement(selection, event.rawEvent.data);\n\n        if (\n            node?.firstChild &&\n            isNodeOfType(node.firstChild, 'TEXT_NODE') &&\n            node.matches(DelimiterSelector) &&\n            node.textContent == ZeroWidthSpace + event.rawEvent.data\n        ) {\n            preventTypeInDelimiter(node, editor);\n        }\n    }\n}\n\n/**\n * @internal\n */\nexport function handleDelimiterKeyDownEvent(editor: IEditor, event: KeyDownEvent) {\n    const selection = editor.getDOMSelection();\n\n    const { rawEvent } = event;\n    if (!selection || selection.type != 'range') {\n        return;\n    }\n    const isEnter = rawEvent.key === 'Enter';\n    if (selection.range.collapsed && (isCharacterValue(rawEvent) || isEnter)) {\n        const helper = editor.getDOMHelper();\n        const node = getFocusedElement(selection);\n        if (node && isEntityDelimiter(node) && helper.isNodeInEditor(node)) {\n            const blockEntityContainer = node.closest(BlockEntityContainerSelector);\n            if (blockEntityContainer && helper.isNodeInEditor(blockEntityContainer)) {\n                const isAfter = node.classList.contains(DelimiterAfter);\n\n                if (isAfter) {\n                    selection.range.setStartAfter(blockEntityContainer);\n                } else {\n                    selection.range.setStartBefore(blockEntityContainer);\n                }\n                selection.range.collapse(true /* toStart */);\n\n                if (isEnter) {\n                    event.rawEvent.preventDefault();\n                }\n\n                editor.formatContentModel(handleKeyDownInBlockDelimiter, {\n                    selectionOverride: {\n                        type: 'range',\n                        isReverted: false,\n                        range: selection.range,\n                    },\n                });\n            } else {\n                if (isEnter) {\n                    event.rawEvent.preventDefault();\n                    editor.formatContentModel(handleEnterInlineEntity);\n                } else {\n                    editor.takeSnapshot();\n                    editor\n                        .getDocument()\n                        .defaultView?.requestAnimationFrame(() =>\n                            preventTypeInDelimiter(node, editor)\n                        );\n                }\n            }\n        }\n    }\n}\n\n/**\n * @internal Exported Only for unit test\n * @returns\n */\nexport const handleKeyDownInBlockDelimiter: ContentModelFormatter = (model, context) => {\n    iterateSelections(model, (_path, _tableContext, block) => {\n        if (block?.blockType == 'Paragraph') {\n            delete block.isImplicit;\n            const selectionMarker = block.segments.find(w => w.segmentType == 'SelectionMarker');\n            if (selectionMarker?.segmentType == 'SelectionMarker') {\n                block.segmentFormat = { ...selectionMarker.format };\n                context.newPendingFormat = { ...selectionMarker.format };\n            }\n            block.segments.unshift(createBr());\n        }\n    });\n    return true;\n};\n\n/**\n * @internal Exported Only for unit test\n * @returns\n */\nexport const handleEnterInlineEntity: ContentModelFormatter = model => {\n    let selectionBlock: ContentModelParagraph | undefined;\n    let selectionBlockParent: ContentModelBlockGroup | undefined;\n\n    iterateSelections(model, (path, _tableContext, block) => {\n        if (block?.blockType == 'Paragraph') {\n            selectionBlock = block;\n            selectionBlockParent = path[path.length - 1];\n        }\n    });\n\n    if (selectionBlock && selectionBlockParent) {\n        const selectionMarker = selectionBlock.segments.find(\n            segment => segment.segmentType == 'SelectionMarker'\n        );\n        if (selectionMarker) {\n            const markerIndex = selectionBlock.segments.indexOf(selectionMarker);\n            const segmentsAfterMarker = selectionBlock.segments.splice(markerIndex);\n\n            const newPara = createParagraph(\n                false,\n                selectionBlock.format,\n                selectionBlock.segmentFormat,\n                selectionBlock.decorator\n            );\n            newPara.segments.push(...segmentsAfterMarker);\n\n            const selectionBlockIndex = selectionBlockParent.blocks.indexOf(selectionBlock);\n            if (selectionBlockIndex >= 0) {\n                selectionBlockParent.blocks.splice(selectionBlockIndex + 1, 0, newPara);\n            }\n        }\n    }\n\n    return true;\n};\n","import type { ChangedEntity, ContentModelBlockGroup } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function findAllEntities(group: ContentModelBlockGroup, entities: ChangedEntity[]) {\n    group.blocks.forEach(block => {\n        switch (block.blockType) {\n            case 'BlockGroup':\n                findAllEntities(block, entities);\n                break;\n\n            case 'Entity':\n                entities.push({\n                    entity: block,\n                    operation: 'newEntity',\n                });\n                break;\n\n            case 'Paragraph':\n                block.segments.forEach(segment => {\n                    switch (segment.segmentType) {\n                        case 'Entity':\n                            entities.push({\n                                entity: segment,\n                                operation: 'newEntity',\n                            });\n                            break;\n\n                        case 'General':\n                            findAllEntities(segment, entities);\n                            break;\n                    }\n                });\n                break;\n\n            case 'Table':\n                block.rows.forEach(row =>\n                    row.cells.forEach(cell => findAllEntities(cell, entities))\n                );\n                break;\n        }\n    });\n}\n","import type { TextMutationObserver } from 'roosterjs-content-model-types';\n\nclass TextMutationObserverImpl implements TextMutationObserver {\n    private observer: MutationObserver;\n\n    constructor(\n        private contentDiv: HTMLDivElement,\n        private onMutation: (isTextChangeOnly: boolean) => void\n    ) {\n        this.observer = new MutationObserver(this.onMutationInternal);\n    }\n\n    startObserving() {\n        this.observer.observe(this.contentDiv, {\n            subtree: true,\n            childList: true,\n            attributes: true,\n            characterData: true,\n        });\n    }\n\n    stopObserving() {\n        this.observer.disconnect();\n    }\n\n    flushMutations() {\n        const mutations = this.observer.takeRecords();\n\n        this.onMutationInternal(mutations);\n    }\n\n    private onMutationInternal = (mutations: MutationRecord[]) => {\n        const firstTarget = mutations[0]?.target;\n\n        if (firstTarget) {\n            const isTextChangeOnly = mutations.every(\n                mutation => mutation.type == 'characterData' && mutation.target == firstTarget\n            );\n\n            this.onMutation(isTextChangeOnly);\n        }\n    };\n}\n\n/**\n * @internal\n */\nexport function createTextMutationObserver(\n    contentDiv: HTMLDivElement,\n    onMutation: (isTextChangeOnly: boolean) => void\n): TextMutationObserver {\n    return new TextMutationObserverImpl(contentDiv, onMutation);\n}\n","import { toArray } from 'roosterjs-content-model-dom';\nimport type { DOMHelper } from 'roosterjs-content-model-types';\n\nclass DOMHelperImpl implements DOMHelper {\n    constructor(private contentDiv: HTMLElement) {}\n\n    queryElements(selector: string): HTMLElement[] {\n        return toArray(this.contentDiv.querySelectorAll(selector)) as HTMLElement[];\n    }\n\n    getTextContent(): string {\n        return this.contentDiv.textContent || '';\n    }\n\n    isNodeInEditor(node: Node): boolean {\n        return this.contentDiv.contains(node);\n    }\n\n    calculateZoomScale(): number {\n        const originalWidth = this.contentDiv.getBoundingClientRect()?.width || 0;\n        const visualWidth = this.contentDiv.offsetWidth;\n\n        return visualWidth > 0 && originalWidth > 0\n            ? Math.round((originalWidth / visualWidth) * 100) / 100\n            : 1;\n    }\n\n    setDomAttribute(name: string, value: string | null) {\n        if (value === null) {\n            this.contentDiv.removeAttribute(name);\n        } else {\n            this.contentDiv.setAttribute(name, value);\n        }\n    }\n\n    getDomAttribute(name: string): string | null {\n        return this.contentDiv.getAttribute(name);\n    }\n\n    getDomStyle<T extends keyof CSSStyleDeclaration>(style: T): CSSStyleDeclaration[T] {\n        return this.contentDiv.style[style];\n    }\n}\n\n/**\n * @internal Create new instance of DOMHelper\n */\nexport function createDOMHelper(contentDiv: HTMLElement): DOMHelper {\n    return new DOMHelperImpl(contentDiv);\n}\n","import type {\n    DarkColorHandler,\n    ColorTransformFunction,\n    Colors,\n} from 'roosterjs-content-model-types';\n\nclass DarkColorHandlerImpl implements DarkColorHandler {\n    constructor(\n        private readonly root: HTMLElement,\n        public getDarkColor: ColorTransformFunction,\n        public readonly knownColors: Record<string, Colors>\n    ) {}\n\n    updateKnownColor(isDarkMode: boolean, key?: string, colorPair?: Colors): void {\n        if (key && colorPair) {\n            // Has values to set\n            // When in light mode: Update the value to known values, do not touch container property\n            // When in dark mode: Update the value to known colors, set value to container\n            if (!this.knownColors[key]) {\n                this.knownColors[key] = colorPair;\n            }\n\n            if (isDarkMode) {\n                this.root.style.setProperty(key, colorPair.darkModeColor);\n            }\n        } else {\n            // No value to set\n            // When in light mode: No op\n            // When in dark mode: Set all values to container, do not touch known values\n            if (isDarkMode) {\n                Object.keys(this.knownColors).forEach(key => {\n                    this.root.style.setProperty(key, this.knownColors[key].darkModeColor);\n                });\n            }\n        }\n    }\n\n    reset() {\n        Object.keys(this.knownColors).forEach(key => {\n            this.root.style.removeProperty(key);\n        });\n    }\n}\n\n/**\n * @internal\n */\nexport function createDarkColorHandler(\n    root: HTMLElement,\n    getDarkColor: ColorTransformFunction,\n    knownColors: Record<string, Colors> = {}\n): DarkColorHandler {\n    return new DarkColorHandlerImpl(root, getDarkColor, knownColors);\n}\n","import { ChangeSource } from '../constants/ChangeSource';\nimport { cloneModel } from '../publicApi/model/cloneModel';\nimport { createEditorCore } from './createEditorCore';\nimport { createEmptyModel, tableProcessor } from 'roosterjs-content-model-dom';\nimport { reducedModelChildProcessor } from '../override/reducedModelChildProcessor';\nimport { transformColor } from '../publicApi/color/transformColor';\nimport type { CachedElementHandler } from '../publicApi/model/cloneModel';\nimport type {\n    ClipboardData,\n    ContentModelDocument,\n    ContentModelFormatter,\n    ContentModelSegmentFormat,\n    DarkColorHandler,\n    DOMEventRecord,\n    DOMHelper,\n    DOMSelection,\n    EditorEnvironment,\n    FormatContentModelOptions,\n    IEditor,\n    PasteType,\n    PluginEventData,\n    PluginEventFromType,\n    PluginEventType,\n    Snapshot,\n    SnapshotsManager,\n    EditorCore,\n    EditorOptions,\n    TrustedHTMLHandler,\n    Rect,\n    EntityState,\n} from 'roosterjs-content-model-types';\n\n/**\n * The main editor class based on Content Model\n */\nexport class Editor implements IEditor {\n    private core: EditorCore | null = null;\n\n    /**\n     * Creates an instance of Editor\n     * @param contentDiv The DIV HTML element which will be the container element of editor\n     * @param options An optional options object to customize the editor\n     */\n    constructor(contentDiv: HTMLDivElement, options: EditorOptions = {}) {\n        this.core = createEditorCore(contentDiv, options);\n\n        const initialModel = options.initialModel ?? createEmptyModel(options.defaultSegmentFormat);\n\n        this.core.api.setContentModel(this.core, initialModel, { ignoreSelection: true });\n        this.core.plugins.forEach(plugin => plugin.initialize(this));\n    }\n\n    /**\n     * Dispose this editor, dispose all plugins and custom data\n     */\n    dispose() {\n        const core = this.getCore();\n\n        for (let i = core.plugins.length - 1; i >= 0; i--) {\n            const plugin = core.plugins[i];\n\n            try {\n                plugin.dispose();\n            } catch (e) {\n                // Cache the error and pass it out, then keep going since dispose should always succeed\n                core.disposeErrorHandler?.(plugin, e as Error);\n            }\n        }\n\n        core.darkColorHandler.reset();\n\n        this.core = null;\n    }\n\n    /**\n     * Get whether this editor is disposed\n     * @returns True if editor is disposed, otherwise false\n     */\n    isDisposed(): boolean {\n        return !this.core;\n    }\n\n    /**\n     * Create Content Model from DOM tree in this editor\n     * @param mode What kind of Content Model we want. Currently we support the following values:\n     * - connected: Returns a connect Content Model object. \"Connected\" means if there is any entity inside editor, the returned Content Model will\n     * contain the same wrapper element for entity. This option should only be used in some special cases. In most cases we should use \"disconnected\"\n     * to get a fully disconnected Content Model so that any change to the model will not impact editor content.\n     * - disconnected: Returns a disconnected clone of Content Model from editor which you can do any change on it and it won't impact the editor content.\n     * If there is any entity in editor, the returned object will contain cloned copy of entity wrapper element.\n     * If editor is in dark mode, the cloned entity will be converted back to light mode.\n     * - reduced: Returns a reduced Content Model that only contains the model of current selection. If there is already a up-to-date cached model, use it\n     * instead to improve performance. This is mostly used for retrieve current format state.\n     */\n    getContentModelCopy(mode: 'connected' | 'disconnected' | 'reduced'): ContentModelDocument {\n        const core = this.getCore();\n\n        switch (mode) {\n            case 'connected':\n                return core.api.createContentModel(core, {\n                    processorOverride: {\n                        table: tableProcessor, // Use the original table processor to create Content Model with real table content but not just an entity\n                    },\n                });\n\n            case 'disconnected':\n                return cloneModel(core.api.createContentModel(core), {\n                    includeCachedElement: this.cloneOptionCallback,\n                });\n            case 'reduced':\n                return core.api.createContentModel(core, {\n                    processorOverride: {\n                        child: reducedModelChildProcessor,\n                    },\n                });\n        }\n    }\n\n    /**\n     * Get current running environment, such as if editor is running on Mac\n     */\n    getEnvironment(): EditorEnvironment {\n        return this.getCore().environment;\n    }\n\n    /**\n     * Get current DOM selection\n     */\n    getDOMSelection(): DOMSelection | null {\n        const core = this.getCore();\n\n        return core.api.getDOMSelection(core);\n    }\n\n    /**\n     * Set DOMSelection into editor content.\n     * @param selection The selection to set\n     */\n    setDOMSelection(selection: DOMSelection | null) {\n        const core = this.getCore();\n\n        core.api.setDOMSelection(core, selection);\n    }\n\n    /**\n     * The general API to do format change with Content Model\n     * It will grab a Content Model for current editor content, and invoke a callback function\n     * to do format change. Then according to the return value, write back the modified content model into editor.\n     * If there is cached model, it will be used and updated.\n     * @param formatter Formatter function, see ContentModelFormatter\n     * @param options More options, see FormatContentModelOptions\n     */\n    formatContentModel(\n        formatter: ContentModelFormatter,\n        options?: FormatContentModelOptions\n    ): void {\n        const core = this.getCore();\n\n        core.api.formatContentModel(core, formatter, options);\n    }\n\n    /**\n     * Get pending format of editor if any, or return null\n     */\n    getPendingFormat(): ContentModelSegmentFormat | null {\n        return this.getCore().format.pendingFormat?.format ?? null;\n    }\n\n    /**\n     * Get a DOM Helper object to help access DOM tree in editor\n     */\n    getDOMHelper(): DOMHelper {\n        return this.getCore().domHelper;\n    }\n\n    /**\n     * Add a single undo snapshot to undo stack\n     * @param entityState @optional State for entity if we want to add entity state for this snapshot\n     */\n    takeSnapshot(entityState?: EntityState): Snapshot | null {\n        const core = this.getCore();\n\n        return core.api.addUndoSnapshot(\n            core,\n            false /*canUndoByBackspace*/,\n            entityState ? [entityState] : undefined\n        );\n    }\n\n    /**\n     * Restore an undo snapshot into editor\n     * @param snapshot The snapshot to restore\n     */\n    restoreSnapshot(snapshot: Snapshot): void {\n        const core = this.getCore();\n\n        core.api.restoreUndoSnapshot(core, snapshot);\n    }\n\n    /**\n     * Get document which contains this editor\n     * @returns The HTML document which contains this editor\n     */\n    getDocument(): Document {\n        return this.getCore().physicalRoot.ownerDocument;\n    }\n\n    /**\n     * Focus to this editor, the selection was restored to where it was before, no unexpected scroll.\n     */\n    focus() {\n        const core = this.getCore();\n        core.api.focus(core);\n    }\n\n    /**\n     * Check if focus is in editor now\n     * @returns true if focus is in editor, otherwise false\n     */\n    hasFocus(): boolean {\n        const core = this.getCore();\n        return core.api.hasFocus(core);\n    }\n\n    /**\n     * Trigger an event to be dispatched to all plugins\n     * @param eventType Type of the event\n     * @param data data of the event with given type, this is the rest part of PluginEvent with the given type\n     * @param broadcast indicates if the event needs to be dispatched to all plugins\n     * True means to all, false means to allow exclusive handling from one plugin unless no one wants that\n     * @returns the event object which is really passed into plugins. Some plugin may modify the event object so\n     * the result of this function provides a chance to read the modified result\n     */\n    triggerEvent<T extends PluginEventType>(\n        eventType: T,\n        data: PluginEventData<T>,\n        broadcast: boolean = false\n    ): PluginEventFromType<T> {\n        const core = this.getCore();\n        const event = ({\n            eventType,\n            ...data,\n        } as any) as PluginEventFromType<T>;\n        core.api.triggerEvent(core, event, broadcast);\n\n        return event;\n    }\n\n    /**\n     * Attach a DOM event to the editor content DIV\n     * @param eventMap A map from event name to its handler\n     */\n    attachDomEvent(eventMap: Record<string, DOMEventRecord>): () => void {\n        const core = this.getCore();\n        return core.api.attachDomEvent(core, eventMap);\n    }\n\n    /**\n     * Get undo snapshots manager\n     */\n    getSnapshotsManager(): SnapshotsManager {\n        const core = this.getCore();\n\n        return core.undo.snapshotsManager;\n    }\n\n    /**\n     * Check if the editor is in dark mode\n     * @returns True if the editor is in dark mode, otherwise false\n     */\n    isDarkMode(): boolean {\n        return this.getCore().lifecycle.isDarkMode;\n    }\n\n    /**\n     * Set the dark mode state and transforms the content to match the new state.\n     * @param isDarkMode The next status of dark mode. True if the editor should be in dark mode, false if not.\n     */\n    setDarkModeState(isDarkMode?: boolean) {\n        const core = this.getCore();\n\n        if (!!isDarkMode != core.lifecycle.isDarkMode) {\n            transformColor(\n                core.physicalRoot,\n                false /*includeSelf*/,\n                isDarkMode ? 'lightToDark' : 'darkToLight',\n                core.darkColorHandler\n            );\n\n            core.lifecycle.isDarkMode = !!isDarkMode;\n\n            core.api.triggerEvent(\n                core,\n                {\n                    eventType: 'contentChanged',\n                    source: isDarkMode\n                        ? ChangeSource.SwitchToDarkMode\n                        : ChangeSource.SwitchToLightMode,\n                },\n                true\n            );\n        }\n    }\n\n    /**\n     * Check if editor is in Shadow Edit mode\n     */\n    isInShadowEdit() {\n        return !!this.getCore().lifecycle.shadowEditFragment;\n    }\n\n    /**\n     * Make the editor in \"Shadow Edit\" mode.\n     * In Shadow Edit mode, all format change will finally be ignored.\n     * This can be used for building a live preview feature for format button, to allow user\n     * see format result without really apply it.\n     * This function can be called repeated. If editor is already in shadow edit mode, we can still\n     * use this function to do more shadow edit operation.\n     */\n    startShadowEdit() {\n        const core = this.getCore();\n        core.api.switchShadowEdit(core, true /*isOn*/);\n    }\n\n    /**\n     * Leave \"Shadow Edit\" mode, all changes made during shadow edit will be discarded\n     */\n    stopShadowEdit() {\n        const core = this.getCore();\n        core.api.switchShadowEdit(core, false /*isOn*/);\n    }\n\n    /**\n     * Paste into editor using a clipboardData object\n     * @param clipboardData Clipboard data retrieved from clipboard\n     * @param pasteType Type of paste\n     */\n    pasteFromClipboard(clipboardData: ClipboardData, pasteType: PasteType = 'normal') {\n        const core = this.getCore();\n\n        core.api.paste(core, clipboardData, pasteType);\n    }\n\n    /**\n     * Get a color manager object for this editor.\n     */\n    getColorManager(): DarkColorHandler {\n        return this.getCore().darkColorHandler;\n    }\n\n    /**\n     * Get a function to convert HTML string to trusted HTML string.\n     * By default it will just return the input HTML directly. To override this behavior,\n     * pass your own trusted HTML handler to EditorOptions.trustedHTMLHandler\n     * See https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/trusted-types\n     */\n    getTrustedHTMLHandler(): TrustedHTMLHandler {\n        return this.getCore().trustedHTMLHandler;\n    }\n\n    /**\n     * Get the scroll container of the editor\n     */\n    getScrollContainer(): HTMLElement {\n        return this.getCore().domEvent.scrollContainer;\n    }\n\n    /**\n     * Retrieves the rect of the visible viewport of the editor.\n     */\n    getVisibleViewport(): Rect | null {\n        return this.getCore().api.getVisibleViewport(this.getCore());\n    }\n\n    /**\n     * @returns the current EditorCore object\n     * @throws a standard Error if there's no core object\n     */\n    protected getCore(): EditorCore {\n        if (!this.core) {\n            throw new Error('Editor is already disposed');\n        }\n        return this.core;\n    }\n\n    private cloneOptionCallback: CachedElementHandler = (node, type) => {\n        if (type == 'cache') {\n            return undefined;\n        }\n\n        const result = node.cloneNode(true /*deep*/) as HTMLElement;\n\n        if (this.isDarkMode()) {\n            const colorHandler = this.getColorManager();\n\n            transformColor(result, true /*includeSelf*/, 'darkToLight', colorHandler);\n\n            result.style.color = result.style.color || 'inherit';\n            result.style.backgroundColor = result.style.backgroundColor || 'inherit';\n        }\n\n        return result;\n    };\n}\n","import type { Snapshot, Snapshots, SnapshotsManager } from 'roosterjs-content-model-types';\n\n// Max stack size that cannot be exceeded. When exceeded, old undo history will be dropped\n// to keep size under limit. This is kept at 10MB\nconst MAX_SIZE_LIMIT = 1e7;\n\nclass SnapshotsManagerImpl implements SnapshotsManager {\n    private snapshots: Snapshots;\n    private hasNewContentValue: boolean = false;\n\n    constructor(snapshots?: Snapshots) {\n        this.snapshots = snapshots ?? {\n            snapshots: [],\n            totalSize: 0,\n            currentIndex: -1,\n            autoCompleteIndex: -1,\n            maxSize: MAX_SIZE_LIMIT,\n        };\n    }\n\n    get hasNewContent(): boolean {\n        return this.hasNewContentValue;\n    }\n\n    set hasNewContent(value: boolean) {\n        this.hasNewContentValue = value;\n    }\n\n    canMove(step: number): boolean {\n        const newIndex = this.snapshots.currentIndex + step;\n        return newIndex >= 0 && newIndex < this.snapshots.snapshots.length;\n    }\n\n    move(step: number): Snapshot | null {\n        let result: Snapshot | null = null;\n\n        if (this.canMove(step)) {\n            this.snapshots.currentIndex += step;\n            this.snapshots.autoCompleteIndex = -1;\n            result = this.snapshots.snapshots[this.snapshots.currentIndex];\n        }\n\n        this.snapshots.onChanged?.('move');\n\n        return result;\n    }\n\n    addSnapshot(snapshot: Snapshot, isAutoCompleteSnapshot: boolean): void {\n        const currentSnapshot = this.snapshots.snapshots[this.snapshots.currentIndex];\n        const isSameSnapshot =\n            currentSnapshot &&\n            currentSnapshot.html == snapshot.html &&\n            !currentSnapshot.entityStates &&\n            !snapshot.entityStates;\n        const addSnapshot = !currentSnapshot || shouldAddSnapshot(currentSnapshot, snapshot);\n\n        if (this.snapshots.currentIndex < 0 || addSnapshot) {\n            this.clearRedo();\n            this.snapshots.snapshots.push(snapshot);\n            this.snapshots.currentIndex++;\n            this.snapshots.totalSize += this.getSnapshotLength(snapshot);\n\n            let removeCount = 0;\n            while (\n                removeCount < this.snapshots.snapshots.length &&\n                this.snapshots.totalSize > this.snapshots.maxSize\n            ) {\n                this.snapshots.totalSize -= this.getSnapshotLength(\n                    this.snapshots.snapshots[removeCount]\n                );\n                removeCount++;\n            }\n\n            if (removeCount > 0) {\n                this.snapshots.snapshots.splice(0, removeCount);\n                this.snapshots.currentIndex -= removeCount;\n\n                if (this.snapshots.autoCompleteIndex >= 0) {\n                    this.snapshots.autoCompleteIndex -= removeCount;\n                }\n            }\n\n            if (isAutoCompleteSnapshot) {\n                this.snapshots.autoCompleteIndex = this.snapshots.currentIndex;\n            }\n        } else if (isSameSnapshot) {\n            // replace the currentSnapshot's metadata so the selection is updated\n            this.snapshots.snapshots.splice(this.snapshots.currentIndex, 1, snapshot);\n        }\n\n        this.snapshots.onChanged?.('add');\n    }\n\n    clearRedo(): void {\n        if (this.canMove(1)) {\n            let removedSize = 0;\n            for (\n                let i = this.snapshots.currentIndex + 1;\n                i < this.snapshots.snapshots.length;\n                i++\n            ) {\n                removedSize += this.getSnapshotLength(this.snapshots.snapshots[i]);\n            }\n\n            this.snapshots.snapshots.splice(this.snapshots.currentIndex + 1);\n            this.snapshots.totalSize -= removedSize;\n            this.snapshots.autoCompleteIndex = -1;\n\n            this.snapshots.onChanged?.('clear');\n        }\n    }\n\n    canUndoAutoComplete(): boolean {\n        return (\n            this.snapshots.autoCompleteIndex >= 0 &&\n            this.snapshots.currentIndex - this.snapshots.autoCompleteIndex == 1\n        );\n    }\n\n    private getSnapshotLength(snapshot: Snapshot) {\n        return snapshot.html?.length ?? 0;\n    }\n}\n\n/**\n * @internal\n * Create a new instance of Undo Snapshots Manager\n * @param snapshots @optional Snapshots object for storing undo snapshots. If not passed, default implementation will be used\n */\nexport function createSnapshotsManager(snapshots?: Snapshots): SnapshotsManager {\n    return new SnapshotsManagerImpl(snapshots);\n}\n\nfunction shouldAddSnapshot(currentSnapshot: Snapshot, snapshot: Snapshot) {\n    return (\n        currentSnapshot.html !== snapshot.html ||\n        (currentSnapshot.entityStates &&\n            snapshot.entityStates &&\n            currentSnapshot.entityStates !== snapshot.entityStates) ||\n        (!currentSnapshot.entityStates && snapshot.entityStates)\n    );\n}\n","import { addUndoSnapshot } from '../coreApi/addUndoSnapshot';\nimport { attachDomEvent } from '../coreApi/attachDomEvent';\nimport { createContentModel } from '../coreApi/createContentModel';\nimport { createEditorContext } from '../coreApi/createEditorContext';\nimport { focus } from '../coreApi/focus';\nimport { formatContentModel } from '../coreApi/formatContentModel';\nimport { getDOMSelection } from '../coreApi/getDOMSelection';\nimport { getVisibleViewport } from '../coreApi/getVisibleViewport';\nimport { hasFocus } from '../coreApi/hasFocus';\nimport { paste } from '../coreApi/paste';\nimport { restoreUndoSnapshot } from '../coreApi/restoreUndoSnapshot';\nimport { setContentModel } from '../coreApi/setContentModel';\nimport { setDOMSelection } from '../coreApi/setDOMSelection';\nimport { switchShadowEdit } from '../coreApi/switchShadowEdit';\nimport { triggerEvent } from '../coreApi/triggerEvent';\nimport type { CoreApiMap } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Core API map for Editor\n */\nexport const coreApiMap: CoreApiMap = {\n    createContentModel: createContentModel,\n    createEditorContext: createEditorContext,\n    formatContentModel: formatContentModel,\n    getDOMSelection: getDOMSelection,\n    setContentModel: setContentModel,\n    setDOMSelection: setDOMSelection,\n    switchShadowEdit: switchShadowEdit,\n    getVisibleViewport: getVisibleViewport,\n    focus: focus,\n    hasFocus: hasFocus,\n    addUndoSnapshot: addUndoSnapshot,\n    restoreUndoSnapshot: restoreUndoSnapshot,\n    attachDomEvent: attachDomEvent,\n    triggerEvent: triggerEvent,\n    paste: paste,\n};\n","import { coreApiMap } from './coreApiMap';\nimport { createDarkColorHandler } from './DarkColorHandlerImpl';\nimport { createDOMHelper } from './DOMHelperImpl';\nimport { createEditorCorePlugins } from '../corePlugin/createEditorCorePlugins';\nimport { createDomToModelSettings, createModelToDomSettings } from './createEditorDefaultSettings';\nimport type {\n    EditorEnvironment,\n    PluginState,\n    EditorCore,\n    EditorCorePlugins,\n    EditorOptions,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal Create core object for editor\n * @param contentDiv Editor content DIV\n * @param options Editor options\n */\nexport function createEditorCore(contentDiv: HTMLDivElement, options: EditorOptions): EditorCore {\n    const corePlugins = createEditorCorePlugins(options, contentDiv);\n\n    return {\n        physicalRoot: contentDiv,\n        logicalRoot: contentDiv,\n        api: { ...coreApiMap, ...options.coreApiOverride },\n        originalApi: { ...coreApiMap },\n        plugins: [\n            corePlugins.cache,\n            corePlugins.format,\n            corePlugins.copyPaste,\n            corePlugins.domEvent,\n            corePlugins.selection,\n            corePlugins.entity,\n            ...(options.plugins ?? []).filter(x => !!x),\n            corePlugins.undo,\n            corePlugins.contextMenu,\n            corePlugins.lifecycle,\n        ],\n        environment: createEditorEnvironment(contentDiv),\n        darkColorHandler: createDarkColorHandler(\n            contentDiv,\n            options.getDarkColor ?? getDarkColorFallback,\n            options.knownColors\n        ),\n        trustedHTMLHandler: options.trustedHTMLHandler || defaultTrustHtmlHandler,\n        domToModelSettings: createDomToModelSettings(options),\n        modelToDomSettings: createModelToDomSettings(options),\n        domHelper: createDOMHelper(contentDiv),\n        ...getPluginState(corePlugins),\n        disposeErrorHandler: options.disposeErrorHandler,\n    };\n}\n\nfunction createEditorEnvironment(contentDiv: HTMLElement): EditorEnvironment {\n    const navigator = contentDiv.ownerDocument.defaultView?.navigator;\n    const userAgent = navigator?.userAgent ?? '';\n    const appVersion = navigator?.appVersion ?? '';\n\n    return {\n        isMac: appVersion.indexOf('Mac') != -1,\n        isAndroid: /android/i.test(userAgent),\n        isSafari:\n            userAgent.indexOf('Safari') >= 0 &&\n            userAgent.indexOf('Chrome') < 0 &&\n            userAgent.indexOf('Android') < 0,\n        isMobileOrTablet: getIsMobileOrTablet(userAgent),\n    };\n}\n\nfunction getIsMobileOrTablet(userAgent: string) {\n    // Reference: http://detectmobilebrowsers.com/\n    // The default regex on the website doesn't consider tablet.\n    // To support tablet, add |android|ipad|playbook|silk to the first regex according to the info in /about page\n    if (\n        /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(\n            userAgent\n        ) ||\n        /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(\n            userAgent.substring(0, 4)\n        )\n    ) {\n        return true;\n    }\n    return false;\n}\n\n/**\n * @internal export for test only\n */\nexport function defaultTrustHtmlHandler(html: string) {\n    return html;\n}\n\nfunction getPluginState(corePlugins: EditorCorePlugins): PluginState {\n    return {\n        domEvent: corePlugins.domEvent.getState(),\n        copyPaste: corePlugins.copyPaste.getState(),\n        cache: corePlugins.cache.getState(),\n        format: corePlugins.format.getState(),\n        lifecycle: corePlugins.lifecycle.getState(),\n        entity: corePlugins.entity.getState(),\n        selection: corePlugins.selection.getState(),\n        contextMenu: corePlugins.contextMenu.getState(),\n        undo: corePlugins.undo.getState(),\n    };\n}\n\n/**\n * @internal Export for test only\n * A fallback function, always return original color\n */\nexport function getDarkColorFallback(color: string) {\n    return color;\n}\n","import { createDomToModelConfig, createModelToDomConfig } from 'roosterjs-content-model-dom';\nimport { listItemMetadataApplier, listLevelMetadataApplier } from '../metadata/updateListMetadata';\nimport { tablePreProcessor } from '../override/tablePreProcessor';\nimport type {\n    ContentModelSettings,\n    DomToModelOption,\n    DomToModelSettings,\n    ModelToDomOption,\n    ModelToDomSettings,\n    EditorOptions,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Create default DOM to Content Model conversion settings for an editor\n * @param options The editor options\n */\nexport function createDomToModelSettings(\n    options: EditorOptions\n): ContentModelSettings<DomToModelOption, DomToModelSettings> {\n    const builtIn: DomToModelOption = {\n        processorOverride: {\n            table: tablePreProcessor,\n        },\n    };\n    const customized: DomToModelOption = options.defaultDomToModelOptions ?? {};\n\n    return {\n        builtIn,\n        customized,\n        calculated: createDomToModelConfig([builtIn, customized]),\n    };\n}\n\n/**\n * @internal\n * Create default Content Model to DOM conversion settings for an editor\n * @param options The editor options\n */\nexport function createModelToDomSettings(\n    options: EditorOptions\n): ContentModelSettings<ModelToDomOption, ModelToDomSettings> {\n    const builtIn: ModelToDomOption = {\n        metadataAppliers: {\n            listItem: listItemMetadataApplier,\n            listLevel: listLevelMetadataApplier,\n        },\n    };\n    const customized: ModelToDomOption = options.defaultModelToDomOptions ?? {};\n\n    return {\n        builtIn,\n        customized,\n        calculated: createModelToDomConfig([builtIn, customized]),\n    };\n}\n","export { CachedElementHandler, CloneModelOptions, cloneModel } from './publicApi/model/cloneModel';\nexport { mergeModel, MergeModelOption } from './publicApi/model/mergeModel';\nexport { isBlockGroupOfType } from './publicApi/model/isBlockGroupOfType';\nexport {\n    getClosestAncestorBlockGroupIndex,\n    TypeOfBlockGroup,\n} from './publicApi/model/getClosestAncestorBlockGroupIndex';\nexport { isBold } from './publicApi/model/isBold';\nexport { createModelFromHtml } from './publicApi/model/createModelFromHtml';\nexport { exportContent } from './publicApi/model/exportContent';\n\nexport {\n    iterateSelections,\n    IterateSelectionsCallback,\n    IterateSelectionsOption,\n} from './publicApi/selection/iterateSelections';\nexport { getSelectionRootNode } from './publicApi/selection/getSelectionRootNode';\nexport { deleteSelection } from './publicApi/selection/deleteSelection';\nexport { deleteSegment } from './publicApi/selection/deleteSegment';\nexport { deleteBlock } from './publicApi/selection/deleteBlock';\nexport { default as hasSelectionInBlock } from './publicApi/selection/hasSelectionInBlock';\nexport { default as hasSelectionInSegment } from './publicApi/selection/hasSelectionInSegment';\nexport { default as hasSelectionInBlockGroup } from './publicApi/selection/hasSelectionInBlockGroup';\nexport {\n    OperationalBlocks,\n    getFirstSelectedListItem,\n    getFirstSelectedTable,\n    getOperationalBlocks,\n    getSelectedParagraphs,\n    getSelectedSegments,\n    getSelectedSegmentsAndParagraphs,\n} from './publicApi/selection/collectSelections';\nexport { setSelection } from './publicApi/selection/setSelection';\n\nexport { applyTableFormat } from './publicApi/table/applyTableFormat';\nexport { normalizeTable, MIN_ALLOWED_TABLE_CELL_WIDTH } from './publicApi/table/normalizeTable';\nexport { setTableCellBackgroundColor } from './publicApi/table/setTableCellBackgroundColor';\nexport { getSelectedCells } from './publicApi/table/getSelectedCells';\n\nexport { isCharacterValue, isModifierKey } from './publicApi/domUtils/eventUtils';\nexport { combineBorderValue, extractBorderValues } from './publicApi/domUtils/borderValues';\nexport { isPunctuation, isSpace, normalizeText } from './publicApi/domUtils/stringUtil';\nexport { parseTableCells, createTableRanges } from './publicApi/domUtils/tableCellUtils';\nexport { getSegmentTextFormat } from './publicApi/domUtils/getSegmentTextFormat';\nexport { readFile } from './publicApi/domUtils/readFile';\nexport { cacheGetEventData } from './publicApi/domUtils/cacheGetEventData';\n\nexport { undo } from './publicApi/undo/undo';\nexport { redo } from './publicApi/undo/redo';\nexport { transformColor } from './publicApi/color/transformColor';\n\nexport { retrieveModelFormatState } from './publicApi/format/retrieveModelFormatState';\n\nexport { updateImageMetadata } from './metadata/updateImageMetadata';\nexport { updateTableCellMetadata } from './metadata/updateTableCellMetadata';\nexport { updateTableMetadata } from './metadata/updateTableMetadata';\nexport { updateListMetadata, getListStyleTypeFromString } from './metadata/updateListMetadata';\n\nexport { ChangeSource } from './constants/ChangeSource';\nexport { BulletListType } from './constants/BulletListType';\nexport { NumberingListType } from './constants/NumberingListType';\nexport { TableBorderFormat } from './constants/TableBorderFormat';\n\nexport { Editor } from './editor/Editor';\n","import type {\n    ArrayDefinition,\n    BooleanDefinition,\n    Definition,\n    NumberDefinition,\n    ObjectDefinition,\n    ObjectPropertyDefinition,\n    StringDefinition,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Create a number definition\n * @param isOptional Whether this property is optional\n * @param value Optional value of the number\n * @param minValue Optional minimum value\n * @param maxValue Optional maximum value\n * @param allowNull Allow the property to be null\n * @returns The number definition object\n */\nexport function createNumberDefinition(\n    isOptional?: boolean,\n    value?: number,\n    minValue?: number,\n    maxValue?: number,\n    allowNull?: boolean\n): NumberDefinition {\n    return {\n        type: 'number',\n        isOptional,\n        value,\n        maxValue,\n        minValue,\n        allowNull,\n    };\n}\n\n/**\n * @internal\n * Create a boolean definition\n * @param isOptional  Whether this property is optional\n * @param value Optional expected boolean value\n * @param allowNull Allow the property to be null\n * @returns  The boolean definition object\n */\nexport function createBooleanDefinition(\n    isOptional?: boolean,\n    value?: boolean,\n    allowNull?: boolean\n): BooleanDefinition {\n    return {\n        type: 'boolean',\n        isOptional,\n        value,\n        allowNull,\n    };\n}\n\n/**\n * @internal\n * Create a string definition\n * @param isOptional  Whether this property is optional\n * @param value Optional expected string value\n * @param allowNull Allow the property to be null\n * @returns  The string definition object\n */\nexport function createStringDefinition(\n    isOptional?: boolean,\n    value?: string,\n    allowNull?: boolean\n): StringDefinition {\n    return {\n        type: 'string',\n        isOptional,\n        value,\n        allowNull,\n    };\n}\n\n/**\n * @internal\n * Create an array definition\n * @param itemDef Definition of each item of the related array\n * @param isOptional  Whether this property is optional\n * @param allowNull Allow the property to be null\n * @returns  The array definition object\n */\nexport function createArrayDefinition<T>(\n    itemDef: Definition<T>,\n    isOptional?: boolean,\n    minLength?: number,\n    maxLength?: number,\n    allowNull?: boolean\n): ArrayDefinition<T[]> {\n    return {\n        type: 'array',\n        isOptional,\n        itemDef,\n        minLength,\n        maxLength,\n        allowNull,\n    };\n}\n\n/**\n * @internal\n * Create an object definition\n * @param propertyDef Definition of each property of the related object\n * @param isOptional  Whether this property is optional\n * @param allowNull Allow the property to be null\n * @returns  The object definition object\n */\nexport function createObjectDefinition<T extends Object>(\n    propertyDef: ObjectPropertyDefinition<T>,\n    isOptional?: boolean,\n    allowNull?: boolean\n): ObjectDefinition<T> {\n    return {\n        type: 'object',\n        isOptional,\n        propertyDef,\n        allowNull,\n    };\n}\n","import { updateMetadata } from 'roosterjs-content-model-dom';\nimport {\n    createNumberDefinition,\n    createObjectDefinition,\n    createStringDefinition,\n} from './definitionCreators';\nimport type { ContentModelImage, ImageMetadataFormat } from 'roosterjs-content-model-types';\n\nconst NumberDefinition = createNumberDefinition();\n\nconst ImageMetadataFormatDefinition = createObjectDefinition<Required<ImageMetadataFormat>>({\n    widthPx: NumberDefinition,\n    heightPx: NumberDefinition,\n    leftPercent: NumberDefinition,\n    rightPercent: NumberDefinition,\n    topPercent: NumberDefinition,\n    bottomPercent: NumberDefinition,\n    angleRad: NumberDefinition,\n    src: createStringDefinition(),\n    naturalHeight: NumberDefinition,\n    naturalWidth: NumberDefinition,\n});\n\n/**\n * Update image metadata with a callback\n * @param image The image Content Model\n * @param callback The callback function used for updating metadata\n */\nexport function updateImageMetadata(\n    image: ContentModelImage,\n    callback?: (format: ImageMetadataFormat | null) => ImageMetadataFormat | null\n): ImageMetadataFormat | null {\n    return updateMetadata(image, callback, ImageMetadataFormatDefinition);\n}\n","import { BulletListType } from '../constants/BulletListType';\nimport { getObjectKeys, updateMetadata } from 'roosterjs-content-model-dom';\nimport { NumberingListType } from '../constants/NumberingListType';\nimport {\n    createBooleanDefinition,\n    createNumberDefinition,\n    createObjectDefinition,\n} from './definitionCreators';\nimport type {\n    ContentModelListItemFormat,\n    ContentModelListItemLevelFormat,\n    ContentModelWithDataset,\n    ListMetadataFormat,\n    MetadataApplier,\n} from 'roosterjs-content-model-types';\n\nconst DefaultOrderedListStyles = ['decimal', 'lower-alpha', 'lower-roman'];\nconst DefaultUnorderedListStyles = ['disc', 'circle', 'square'];\nconst OrderedMapPlaceholderRegex = /\\$\\{(\\w+)\\}/;\nconst CharCodeOfA = 65;\nconst RomanValues: Record<string, number> = {\n    M: 1000,\n    CM: 900,\n    D: 500,\n    CD: 400,\n    C: 100,\n    XC: 90,\n    L: 50,\n    XL: 40,\n    X: 10,\n    IX: 9,\n    V: 5,\n    IV: 4,\n    I: 1,\n};\nconst OrderedMap: Record<number, string> = {\n    [NumberingListType.Decimal]: 'decimal',\n    [NumberingListType.DecimalDash]: '\"${Number}- \"',\n    [NumberingListType.DecimalParenthesis]: '\"${Number}) \"',\n    [NumberingListType.DecimalDoubleParenthesis]: '\"(${Number}) \"',\n    [NumberingListType.LowerAlpha]: 'lower-alpha',\n    [NumberingListType.LowerAlphaDash]: '\"${LowerAlpha}- \"',\n    [NumberingListType.LowerAlphaParenthesis]: '\"${LowerAlpha}) \"',\n    [NumberingListType.LowerAlphaDoubleParenthesis]: '\"(${LowerAlpha}) \"',\n    [NumberingListType.UpperAlpha]: 'upper-alpha',\n    [NumberingListType.UpperAlphaDash]: '\"${UpperAlpha}- \"',\n    [NumberingListType.UpperAlphaParenthesis]: '\"${UpperAlpha}) \"',\n    [NumberingListType.UpperAlphaDoubleParenthesis]: '\"(${UpperAlpha}) \"',\n    [NumberingListType.LowerRoman]: 'lower-roman',\n    [NumberingListType.LowerRomanDash]: '\"${LowerRoman}- \"',\n    [NumberingListType.LowerRomanParenthesis]: '\"${LowerRoman}) \"',\n    [NumberingListType.LowerRomanDoubleParenthesis]: '\"(${LowerRoman}) \"',\n    [NumberingListType.UpperRoman]: 'upper-roman',\n    [NumberingListType.UpperRomanDash]: '\"${UpperRoman}- \"',\n    [NumberingListType.UpperRomanParenthesis]: '\"${UpperRoman}) \"',\n    [NumberingListType.UpperRomanDoubleParenthesis]: '\"(${UpperRoman}) \"',\n};\nconst UnorderedMap: Record<number, string> = {\n    [BulletListType.Disc]: 'disc',\n    [BulletListType.Square]: '\" \"',\n    [BulletListType.Circle]: 'circle',\n    [BulletListType.Dash]: '\"- \"',\n    [BulletListType.LongArrow]: '\" \"',\n    [BulletListType.DoubleLongArrow]: '\" \"',\n    [BulletListType.ShortArrow]: '\" \"',\n    [BulletListType.UnfilledArrow]: '\" \"',\n    [BulletListType.Hyphen]: '\" \"',\n};\n\nfunction getOrderedListStyleValue(\n    template: string | undefined,\n    listNumber: number\n): string | undefined {\n    return template\n        ? template.replace(OrderedMapPlaceholderRegex, (_, subStr) => {\n              switch (subStr) {\n                  case 'Number':\n                      return listNumber + '';\n                  case 'LowerAlpha':\n                      return convertDecimalsToAlpha(listNumber, true /*isLowerCase*/);\n                  case 'UpperAlpha':\n                      return convertDecimalsToAlpha(listNumber, false /*isLowerCase*/);\n                  case 'LowerRoman':\n                      return convertDecimalsToRoman(listNumber, true /*isLowerCase*/);\n                  case 'UpperRoman':\n                      return convertDecimalsToRoman(listNumber, false /*isLowerCase*/);\n              }\n\n              return '';\n          })\n        : undefined;\n}\n\nfunction convertDecimalsToAlpha(decimal: number, isLowerCase?: boolean): string {\n    let alpha = '';\n    decimal--;\n\n    while (decimal >= 0) {\n        alpha = String.fromCharCode((decimal % 26) + CharCodeOfA) + alpha;\n        decimal = Math.floor(decimal / 26) - 1;\n    }\n    return isLowerCase ? alpha.toLowerCase() : alpha;\n}\n\nfunction convertDecimalsToRoman(decimal: number, isLowerCase?: boolean) {\n    let romanValue = '';\n\n    for (const i of getObjectKeys(RomanValues)) {\n        const timesRomanCharAppear = Math.floor(decimal / RomanValues[i]);\n        decimal = decimal - timesRomanCharAppear * RomanValues[i];\n        romanValue = romanValue + i.repeat(timesRomanCharAppear);\n    }\n    return isLowerCase ? romanValue.toLocaleLowerCase() : romanValue;\n}\n\nconst listMetadataDefinition = createObjectDefinition<ListMetadataFormat>(\n    {\n        orderedStyleType: createNumberDefinition(\n            true /** isOptional */,\n            undefined /** value **/,\n            NumberingListType.Min,\n            NumberingListType.Max\n        ),\n        unorderedStyleType: createNumberDefinition(\n            true /** isOptional */,\n            undefined /** value **/,\n            BulletListType.Min,\n            BulletListType.Max\n        ),\n        applyListStyleFromLevel: createBooleanDefinition(true /*isOptional*/),\n    },\n    true /** isOptional */,\n    true /** allowNull */\n);\n\nfunction shouldApplyToItem(listStyleType: string) {\n    return listStyleType.indexOf('\"') >= 0;\n}\n\nfunction getRawListStyleType(listType: 'OL' | 'UL', metadata: ListMetadataFormat, depth: number) {\n    const { orderedStyleType, unorderedStyleType, applyListStyleFromLevel } = metadata;\n    if (listType == 'OL') {\n        return typeof orderedStyleType == 'number'\n            ? OrderedMap[orderedStyleType]\n            : applyListStyleFromLevel\n            ? DefaultOrderedListStyles[depth % DefaultOrderedListStyles.length]\n            : undefined;\n    } else {\n        return typeof unorderedStyleType == 'number'\n            ? UnorderedMap[unorderedStyleType]\n            : applyListStyleFromLevel\n            ? DefaultUnorderedListStyles[depth % DefaultUnorderedListStyles.length]\n            : undefined;\n    }\n}\n\n/**\n * Gets the list style type that the bullet is part of, using the Constant record\n * @param listType whether the list is ordered or unordered\n * @param bullet bullet string\n * @returns the number of the style override or undefined if was not found in the Record\n */\nexport function getListStyleTypeFromString(listType: 'OL' | 'UL', bullet: string) {\n    const map = listType == 'OL' ? OrderedMap : UnorderedMap;\n    const keys = getObjectKeys(map);\n    const result = keys.find(key => map[key] == bullet);\n    if (result) {\n        return typeof result == 'string' ? parseInt(result) : result;\n    }\n    return result;\n}\n\n/**\n * @internal\n */\nexport const listItemMetadataApplier: MetadataApplier<\n    ListMetadataFormat,\n    ContentModelListItemFormat\n> = {\n    metadataDefinition: listMetadataDefinition,\n    applierFunction: (metadata, format, context) => {\n        const depth = context.listFormat.nodeStack.length - 2; // Minus two for the parent element and convert length to index\n\n        if (depth >= 0) {\n            const listType = context.listFormat.nodeStack[depth + 1].listType ?? 'OL';\n            const listStyleType = getRawListStyleType(listType, metadata ?? {}, depth);\n\n            if (listStyleType) {\n                if (shouldApplyToItem(listStyleType)) {\n                    format.listStyleType =\n                        listType == 'OL'\n                            ? getOrderedListStyleValue(\n                                  listStyleType,\n                                  context.listFormat.threadItemCounts[depth]\n                              )\n                            : listStyleType;\n                } else {\n                    delete format.listStyleType;\n                }\n            }\n        }\n    },\n};\n\n/**\n * @internal\n */\nexport const listLevelMetadataApplier: MetadataApplier<\n    ListMetadataFormat,\n    ContentModelListItemLevelFormat\n> = {\n    metadataDefinition: listMetadataDefinition,\n    applierFunction: (metadata, format, context) => {\n        const depth = context.listFormat.nodeStack.length - 2; // Minus two for the parent element and convert length to index\n\n        if (depth >= 0) {\n            const listType = context.listFormat.nodeStack[depth + 1].listType ?? 'OL';\n            const listStyleType = getRawListStyleType(listType, metadata ?? {}, depth);\n\n            if (listStyleType) {\n                if (!shouldApplyToItem(listStyleType)) {\n                    format.listStyleType = listStyleType;\n                } else {\n                    delete format.listStyleType;\n                }\n            }\n        }\n    },\n};\n\n/**\n * Update list metadata with a callback\n * @param list The list Content Model (metadata holder)\n * @param callback The callback function used for updating metadata\n */\nexport function updateListMetadata(\n    list: ContentModelWithDataset<ListMetadataFormat>,\n    callback?: (format: ListMetadataFormat | null) => ListMetadataFormat | null\n): ListMetadataFormat | null {\n    return updateMetadata(list, callback, listMetadataDefinition);\n}\n","import { createBooleanDefinition, createObjectDefinition } from './definitionCreators';\nimport { updateMetadata } from 'roosterjs-content-model-dom';\nimport type { ContentModelTableCell, TableCellMetadataFormat } from 'roosterjs-content-model-types';\n\nconst TableCellMetadataFormatDefinition = createObjectDefinition<Required<TableCellMetadataFormat>>(\n    {\n        bgColorOverride: createBooleanDefinition(true /** isOptional */),\n        vAlignOverride: createBooleanDefinition(true /** isOptional */),\n        borderOverride: createBooleanDefinition(true /** isOptional */),\n    },\n    false /* isOptional */,\n    true /** allowNull */\n);\n\n/**\n * Update table cell metadata with a callback\n * @param cell The table cell Content Model\n * @param callback The callback function used for updating metadata\n */\nexport function updateTableCellMetadata(\n    cell: ContentModelTableCell,\n    callback?: (format: TableCellMetadataFormat | null) => TableCellMetadataFormat | null\n): TableCellMetadataFormat | null {\n    return updateMetadata(cell, callback, TableCellMetadataFormatDefinition);\n}\n","import { TableBorderFormat } from '../constants/TableBorderFormat';\nimport { updateMetadata } from 'roosterjs-content-model-dom';\nimport {\n    createBooleanDefinition,\n    createNumberDefinition,\n    createObjectDefinition,\n    createStringDefinition,\n} from './definitionCreators';\nimport type { ContentModelTable, TableMetadataFormat } from 'roosterjs-content-model-types';\n\nconst NullStringDefinition = createStringDefinition(\n    false /** isOptional */,\n    undefined /** value */,\n    true /** allowNull */\n);\n\nconst BooleanDefinition = createBooleanDefinition(false /** isOptional */);\n\nconst TableFormatDefinition = createObjectDefinition<Required<TableMetadataFormat>>(\n    {\n        topBorderColor: NullStringDefinition,\n        bottomBorderColor: NullStringDefinition,\n        verticalBorderColor: NullStringDefinition,\n        hasHeaderRow: BooleanDefinition,\n        headerRowColor: NullStringDefinition,\n        hasFirstColumn: BooleanDefinition,\n        hasBandedColumns: BooleanDefinition,\n        hasBandedRows: BooleanDefinition,\n        bgColorEven: NullStringDefinition,\n        bgColorOdd: NullStringDefinition,\n        tableBorderFormat: createNumberDefinition(\n            false /** isOptional */,\n            undefined /* value */,\n            TableBorderFormat.Min /* first table border format */,\n            TableBorderFormat.Max /* last table border format */\n        ),\n        verticalAlign: NullStringDefinition,\n    },\n    false /* isOptional */,\n    true /** allowNull */\n);\n\n/**\n * Update table metadata with a callback\n * @param table The table Content Model\n * @param callback The callback function used for updating metadata\n */\nexport function updateTableMetadata(\n    table: ContentModelTable,\n    callback?: (format: TableMetadataFormat | null) => TableMetadataFormat | null\n): TableMetadataFormat | null {\n    return updateMetadata(table, callback, TableFormatDefinition);\n}\n","import { deleteBlock } from '../../publicApi/selection/deleteBlock';\nimport { deleteSegment } from '../../publicApi/selection/deleteSegment';\nimport { getSegmentTextFormat } from '../../publicApi/domUtils/getSegmentTextFormat';\nimport { iterateSelections } from '../../publicApi/selection/iterateSelections';\nimport type { IterateSelectionsOption } from '../../publicApi/selection/iterateSelections';\nimport type {\n    ContentModelBlockGroup,\n    ContentModelDocument,\n    ContentModelParagraph,\n    ContentModelSelectionMarker,\n    DeleteSelectionContext,\n    FormatContentModelContext,\n    InsertPoint,\n    TableSelectionContext,\n} from 'roosterjs-content-model-types';\nimport {\n    createBr,\n    createParagraph,\n    createSelectionMarker,\n    setParagraphNotImplicit,\n} from 'roosterjs-content-model-dom';\n\nconst DeleteSelectionIteratingOptions: IterateSelectionsOption = {\n    contentUnderSelectedTableCell: 'ignoreForTableOrCell', // When a table cell is selected, we replace all content for this cell, so no need to go into its content\n    contentUnderSelectedGeneralElement: 'generalElementOnly', // When a general element is selected, we replace the whole element so no need to go into its content\n    includeListFormatHolder: 'never',\n};\n\n/**\n * @internal\n * Iterate the model and find all selected content if any, delete them, and keep/create an insert point\n * at the first deleted position so that we know where to put cursor to after delete\n */\nexport function deleteExpandedSelection(\n    model: ContentModelDocument,\n    formatContext?: FormatContentModelContext\n): DeleteSelectionContext {\n    const context: DeleteSelectionContext = {\n        deleteResult: 'notDeleted',\n        insertPoint: null,\n        formatContext,\n    };\n\n    iterateSelections(\n        model,\n        (path, tableContext, block, segments) => {\n            // Set paragraph, format and index for default position where we will put cursor to.\n            // Later we can overwrite these info when process the selections\n            let paragraph = createParagraph(\n                true /*implicit*/,\n                undefined /*blockFormat*/,\n                model.format\n            );\n            let markerFormat = model.format;\n            let insertMarkerIndex = 0;\n\n            if (segments) {\n                // Delete segments inside a paragraph\n                if (segments[0] && block?.blockType == 'Paragraph') {\n                    // Now that we have found a paragraph with selections, we can overwrite the default paragraph with this one\n                    // so we can put cursor here after delete\n                    paragraph = block;\n                    insertMarkerIndex = paragraph.segments.indexOf(segments[0]);\n                    markerFormat = getSegmentTextFormat(segments[0]);\n\n                    context.lastParagraph = paragraph;\n                    context.lastTableContext = tableContext;\n\n                    segments.forEach((segment, i) => {\n                        if (\n                            i == 0 &&\n                            !context.insertPoint &&\n                            segment.segmentType == 'SelectionMarker'\n                        ) {\n                            // First time we hit a selection and it is a selection marker, just mark it and not need to delete\n                            // because this is possible a collapsed selection, then it will be handled later\n                            context.insertPoint = createInsertPoint(\n                                segment,\n                                block,\n                                path,\n                                tableContext\n                            );\n                        } else if (deleteSegment(block, segment, context.formatContext)) {\n                            context.deleteResult = 'range';\n                        }\n                    });\n\n                    // Since we are operating on this paragraph and it possible we delete everything from this paragraph,\n                    // Need to make it \"not implicit\" so that it will always have a container element, so that when we do normalization\n                    // of this paragraph, a BR can be added if need\n                    if (context.deleteResult == 'range') {\n                        setParagraphNotImplicit(block);\n                    }\n                }\n            } else if (block) {\n                // Delete a whole block (divider, table, ...)\n                const blocks = path[0].blocks;\n\n                if (deleteBlock(blocks, block, paragraph, context.formatContext)) {\n                    context.deleteResult = 'range';\n                }\n            } else if (tableContext) {\n                // Delete a whole table cell\n                const { table, colIndex, rowIndex } = tableContext;\n                const row = table.rows[rowIndex];\n                const cell = row.cells[colIndex];\n\n                path = [cell, ...path];\n                paragraph.segments.push(createBr(model.format));\n                cell.blocks = [paragraph];\n\n                delete cell.cachedElement;\n                delete row.cachedElement;\n                context.deleteResult = 'range';\n            }\n\n            if (!context.insertPoint) {\n                // If we have not got a insert point after delete and we have a paragraph to put an insert point in, create insert point now\n                const marker = createSelectionMarker(markerFormat);\n\n                setParagraphNotImplicit(paragraph);\n                paragraph.segments.splice(insertMarkerIndex, 0, marker);\n                context.insertPoint = createInsertPoint(marker, paragraph, path, tableContext);\n            }\n        },\n        DeleteSelectionIteratingOptions\n    );\n\n    return context;\n}\n\nfunction createInsertPoint(\n    marker: ContentModelSelectionMarker,\n    paragraph: ContentModelParagraph,\n    path: ContentModelBlockGroup[],\n    tableContext: TableSelectionContext | undefined\n): InsertPoint {\n    return {\n        marker,\n        paragraph,\n        path,\n        tableContext,\n    };\n}\n","/**\n * @internal\n */\nexport function deleteSingleChar(text: string, isForward: boolean) {\n    // In case of emoji that occupies multiple characters, we need to delete the whole emoji\n    const array = [...text];\n    let deleteLength = 0;\n\n    for (\n        let i = isForward ? 0 : array.length - 1,\n            deleteState: 'notDeleted' | 'waiting' | 'done' = 'notDeleted';\n        i >= 0 && i < array.length && deleteState != 'done';\n        i += isForward ? 1 : -1\n    ) {\n        switch (array[i]) {\n            case '\\u200D': // ZERO WIDTH JOINER\n            case '\\u20E3': // COMBINING ENCLOSING KEYCAP\n            case '\\uFE0E': // VARIATION SELECTOR-15\n            case '\\uFE0F': // VARIATION SELECTOR-16\n                deleteState = 'notDeleted';\n                deleteLength++;\n                break;\n\n            default:\n                if (deleteState == 'notDeleted') {\n                    deleteState = 'waiting';\n                    deleteLength++;\n                } else if (deleteState == 'waiting') {\n                    deleteState = 'done';\n                }\n                break;\n        }\n    }\n\n    array.splice(isForward ? 0 : array.length - deleteLength, deleteLength);\n\n    return array.join('');\n}\n","import type { FormatParser, SizeFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal Do not paste width for Format Containers since it may be generated by browser according to temp div width\n */\nexport const containerSizeFormatParser: FormatParser<SizeFormat> = (format, element) => {\n    // For pasted content, there may be existing width generated by browser from the temp DIV. So we need to remove it.\n    if (element.tagName == 'DIV') {\n        delete format.width;\n        delete format.height;\n    }\n};\n","import { isBlockElement, isElementOfType, isNodeOfType } from 'roosterjs-content-model-dom';\r\nimport type {\r\n    ContentModelEntity,\r\n    EntityInfoFormat,\r\n    FormatParser,\r\n    OnNodeCreated,\r\n} from 'roosterjs-content-model-types';\r\n\r\nconst BlockEntityClass = '_EBlock';\r\nconst OneHundredPercent = '100%';\r\nconst InlineBlock = 'inline-block';\r\n\r\n/**\r\n * @internal\r\n */\r\nexport const onCreateCopyEntityNode: OnNodeCreated = (model, node) => {\r\n    const entityModel = model as ContentModelEntity;\r\n    if (\r\n        entityModel &&\r\n        entityModel.wrapper &&\r\n        entityModel.blockType == 'Entity' &&\r\n        isNodeOfType(node, 'ELEMENT_NODE') &&\r\n        isElementOfType(node, 'div') &&\r\n        !isBlockElement(entityModel.wrapper) &&\r\n        entityModel.wrapper.style.display == InlineBlock &&\r\n        entityModel.wrapper.style.width == OneHundredPercent\r\n    ) {\r\n        node.classList.add(BlockEntityClass);\r\n        node.style.display = 'block';\r\n        node.style.width = '';\r\n    }\r\n};\r\n\r\n/**\r\n * @internal\r\n */\r\nexport const pasteBlockEntityParser: FormatParser<EntityInfoFormat> = (_, element) => {\r\n    if (element.classList.contains(BlockEntityClass)) {\r\n        element.classList.remove(BlockEntityClass);\r\n        element.style.display = InlineBlock;\r\n        element.style.width = OneHundredPercent;\r\n    }\r\n};\r\n","import type { DisplayFormat, FormatParser } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const pasteDisplayFormatParser: FormatParser<DisplayFormat> = (format, element) => {\n    const display = element.style.display;\n\n    if (display && display != 'flex') {\n        format.display = display;\n    }\n};\n","import { AllowedTags, DisallowedTags, sanitizeElement } from '../utils/sanitizeElement';\nimport type {\n    DomToModelOptionForSanitizing,\n    ElementProcessor,\n    ValueSanitizer,\n} from 'roosterjs-content-model-types';\n\nconst DefaultStyleSanitizers: Readonly<Record<string, ValueSanitizer>> = {\n    position: false,\n};\n\n/**\n * @internal\n */\nexport function createPasteEntityProcessor(\n    options: DomToModelOptionForSanitizing\n): ElementProcessor<HTMLElement> {\n    const allowedTags = AllowedTags.concat(options.additionalAllowedTags);\n    const disallowedTags = DisallowedTags.concat(options.additionalDisallowedTags);\n    const styleSanitizers = Object.assign({}, DefaultStyleSanitizers, options.styleSanitizers);\n    const attrSanitizers = options.attributeSanitizers;\n\n    return (group, element, context) => {\n        const sanitizedElement = sanitizeElement(\n            element,\n            allowedTags,\n            disallowedTags,\n            styleSanitizers,\n            attrSanitizers\n        );\n\n        if (sanitizedElement) {\n            context.defaultElementProcessors.entity(group, sanitizedElement, context);\n        }\n    };\n}\n","import { AllowedTags, createSanitizedElement, DisallowedTags } from '../utils/sanitizeElement';\nimport { moveChildNodes } from 'roosterjs-content-model-dom';\nimport type {\n    DomToModelOptionForSanitizing,\n    ElementProcessor,\n    ValueSanitizer,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal Export for test only\n */\nexport const removeDisplayFlex: ValueSanitizer = value => {\n    return value == 'flex' ? null : value;\n};\n\nconst DefaultStyleSanitizers: Readonly<Record<string, ValueSanitizer>> = {\n    position: false,\n    display: removeDisplayFlex,\n};\n\n/**\n * @internal\n */\nexport function createPasteGeneralProcessor(\n    options: DomToModelOptionForSanitizing\n): ElementProcessor<HTMLElement> {\n    const allowedTags = AllowedTags.concat(options.additionalAllowedTags);\n    const disallowedTags = DisallowedTags.concat(options.additionalDisallowedTags);\n    const styleSanitizers = Object.assign({}, DefaultStyleSanitizers, options.styleSanitizers);\n    const attrSanitizers = options.attributeSanitizers;\n\n    return (group, element, context) => {\n        const tag = element.tagName.toLowerCase();\n        const processor: ElementProcessor<HTMLElement> | undefined =\n            allowedTags.indexOf(tag) >= 0\n                ? (group, element, context) => {\n                      const sanitizedElement = createSanitizedElement(\n                          element.ownerDocument,\n                          element.tagName,\n                          element.attributes,\n                          styleSanitizers,\n                          attrSanitizers\n                      );\n\n                      moveChildNodes(sanitizedElement, element);\n                      context.defaultElementProcessors['*']?.(group, sanitizedElement, context);\n                  }\n                : disallowedTags.indexOf(tag) >= 0\n                ? undefined // Ignore those disallowed tags\n                : context.defaultElementProcessors.span; // For other unknown tags, treat them as SPAN\n\n        processor?.(group, element, context);\n    };\n}\n","import { isWhiteSpacePreserved } from 'roosterjs-content-model-dom';\nimport type { ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const pasteTextProcessor: ElementProcessor<Text> = (group, text, context) => {\n    const whiteSpace = context.blockFormat.whiteSpace;\n\n    if (isWhiteSpacePreserved(whiteSpace)) {\n        text.nodeValue = text.nodeValue?.replace(/\\u0020\\u0020/g, '\\u0020\\u00A0') ?? '';\n    }\n\n    context.defaultElementProcessors['#text'](group, text, context);\n};\n","import { getSelectionRootNode } from '../publicApi/selection/getSelectionRootNode';\nimport {\n    getRegularSelectionOffsets,\n    handleRegularSelection,\n    isNodeOfType,\n    processChildNode,\n} from 'roosterjs-content-model-dom';\nimport type { ContentModelBlockGroup, DomToModelContext } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\ninterface FormatStateContext extends DomToModelContext {\n    /**\n     * An optional stack of parent elements to process. When provided, the child nodes of current parent element will be ignored,\n     * but use the top element in this stack instead in childProcessor.\n     */\n    nodeStack?: Node[];\n}\n\n/**\n * @internal\n * Export for test only\n * In order to get format, we can still use the regular child processor. However, to improve performance, we don't need to create\n * content model for the whole doc, instead we only need to traverse the tree path that can arrive current selected node.\n * This \"reduced\" child processor will first create a node stack that stores DOM node from root to current common ancestor node of selection,\n * then use this stack as a faked DOM tree to create a reduced content model which we can use to retrieve format state\n */\nexport function reducedModelChildProcessor(\n    group: ContentModelBlockGroup,\n    parent: ParentNode,\n    context: FormatStateContext\n) {\n    if (!context.nodeStack) {\n        const selectionRootNode = getSelectionRootNode(context.selection);\n        context.nodeStack = selectionRootNode ? createNodeStack(parent, selectionRootNode) : [];\n    }\n\n    const stackChild = context.nodeStack.pop();\n\n    if (stackChild) {\n        const [nodeStartOffset, nodeEndOffset] = getRegularSelectionOffsets(context, parent);\n\n        // If selection is not on this node, skip getting node index to save some time since we don't need it here\n        const index =\n            nodeStartOffset >= 0 || nodeEndOffset >= 0 ? getChildIndex(parent, stackChild) : -1;\n\n        if (index >= 0) {\n            handleRegularSelection(index, context, group, nodeStartOffset, nodeEndOffset);\n        }\n\n        processChildNode(group, stackChild, context);\n\n        if (index >= 0) {\n            handleRegularSelection(index + 1, context, group, nodeStartOffset, nodeEndOffset);\n        }\n    } else {\n        // No child node from node stack, that means we have reached the deepest node of selection.\n        // Now we can use default child processor to perform full sub tree scanning for content model,\n        // So that all selected node will be included.\n        context.defaultElementProcessors.child(group, parent, context);\n    }\n}\n\nfunction createNodeStack(root: Node, startNode: Node): Node[] {\n    const result: Node[] = [];\n    let node: Node | null = startNode;\n\n    while (node && root != node && root.contains(node)) {\n        if (isNodeOfType(node, 'ELEMENT_NODE') && node.tagName == 'TABLE') {\n            // For table, we can't do a reduced model creation since we need to handle their cells and indexes,\n            // so clean up whatever we already have, and just put table into the stack\n            result.splice(0, result.length, node);\n        } else {\n            result.push(node);\n        }\n\n        node = node.parentNode;\n    }\n\n    return result;\n}\n\nfunction getChildIndex(parent: ParentNode, stackChild: Node) {\n    let index = 0;\n    let child = parent.firstChild;\n\n    while (child && child != stackChild) {\n        index++;\n        child = child.nextSibling;\n    }\n    return index;\n}\n","import { entityProcessor, hasMetadata, tableProcessor } from 'roosterjs-content-model-dom';\nimport { getSelectionRootNode } from '../publicApi/selection/getSelectionRootNode';\nimport type { DomToModelContext, ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const tablePreProcessor: ElementProcessor<HTMLTableElement> = (group, element, context) => {\n    const processor = shouldUseTableProcessor(element, context) ? tableProcessor : entityProcessor;\n\n    processor(group, element, context);\n};\n\nfunction shouldUseTableProcessor(element: HTMLTableElement, context: DomToModelContext) {\n    const selectionRoot = getSelectionRootNode(context.selection);\n    // Treat table as a real table when:\n    // 1. It is a roosterjs table (has metadata)\n    // 2. Table is in selection\n    // 3. There is selection inside table (or whole table is selected)\n    // Otherwise, we treat the table as entity so we will not change it when write back\n    return (\n        hasMetadata(element) ||\n        context.isInSelection ||\n        (selectionRoot && element.contains(selectionRoot))\n    );\n}\n","import { getColor, setColor } from 'roosterjs-content-model-dom';\nimport type { DarkColorHandler } from 'roosterjs-content-model-types';\n\n/**\n * Edit and transform color of elements between light mode and dark mode\n * @param rootNode The root DOM node to transform\n * @param includeSelf True to transform the root node as well, otherwise false\n * @param direction To specify the transform direction, light to dark, or dark to light\n * @param darkColorHandler The dark color handler object to help do color transformation\n */\nexport function transformColor(\n    rootNode: Node,\n    includeSelf: boolean,\n    direction: 'lightToDark' | 'darkToLight',\n    darkColorHandler?: DarkColorHandler\n) {\n    const toDarkMode = direction == 'lightToDark';\n    const transformer = (element: HTMLElement) => {\n        const textColor = getColor(element, false /*isBackground*/, !toDarkMode, darkColorHandler);\n        const backColor = getColor(element, true /*isBackground*/, !toDarkMode, darkColorHandler);\n\n        setColor(element, textColor, false /*isBackground*/, toDarkMode, darkColorHandler);\n        setColor(element, backColor, true /*isBackground*/, toDarkMode, darkColorHandler);\n    };\n\n    iterateElements(rootNode, transformer, includeSelf);\n}\n\nfunction iterateElements(\n    root: Node,\n    transformer: (element: HTMLElement) => void,\n    includeSelf?: boolean\n) {\n    if (includeSelf && isHTMLElement(root)) {\n        transformer(root);\n    }\n\n    for (let child = root.firstChild; child; child = child.nextSibling) {\n        if (isHTMLElement(child)) {\n            transformer(child);\n        }\n\n        iterateElements(child, transformer);\n    }\n}\n\n// This is not a strict check, we just need to make sure this element has style so that we can set style to it\n// We don't use safeInstanceOf() here since this function will be called very frequently when extract html content\n// in dark mode, so we need to make sure this check is fast enough\nfunction isHTMLElement(node: Node): node is HTMLElement {\n    const htmlElement = <HTMLElement>node;\n    return node.nodeType == Node.ELEMENT_NODE && !!htmlElement.style;\n}\n","import type { Border } from 'roosterjs-content-model-types';\n\nconst BorderStyles = [\n    'none',\n    'hidden',\n    'dotted',\n    'dashed',\n    'solid',\n    'double',\n    'groove',\n    'ridge',\n    'inset',\n    'outset',\n];\nconst BorderSizeRegex = /^(thin|medium|thick|[\\d\\.]+\\w*)$/;\n\n/**\n * Extract an integrated border string with border width, style, color to value tuple\n * @param combinedBorder The integrated border style string\n * @returns An array with the splitted values\n */\nexport function extractBorderValues(combinedBorder?: string): Border {\n    const result: Border = {};\n    const values = (combinedBorder || '').replace(/, /g, ',').split(' ');\n\n    values.forEach(v => {\n        if (BorderStyles.indexOf(v) >= 0 && !result.style) {\n            result.style = v;\n        } else if (BorderSizeRegex.test(v) && !result.width) {\n            result.width = v;\n        } else if (v && !result.color) {\n            result.color = v;\n        }\n    });\n\n    return result;\n}\n\n/**\n * Combine border value array back to string\n * @param values Input string values\n * @param initialValue Initial value for those items without valid value\n */\nexport function combineBorderValue(value: Border): string {\n    return [value.width || '', value.style || '', value.color || ''].join(' ').trim() || 'none';\n}\n","import type { PluginEvent } from 'roosterjs-content-model-types';\n\n/**\n * Gets the cached event data by cache key from event object if there is already one.\n * Otherwise, call getter function to create one, and cache it.\n * @param event The event object\n * @param key Cache key string, need to be unique\n * @param getter Getter function to get the object when it is not in cache yet\n */\nexport function cacheGetEventData<T, E extends PluginEvent>(\n    event: E,\n    key: string,\n    getter: (event: E) => T\n): T {\n    const result =\n        event.eventDataCache && event.eventDataCache.hasOwnProperty(key)\n            ? <T>event.eventDataCache[key]\n            : getter(event);\n    event.eventDataCache = event.eventDataCache || {};\n    event.eventDataCache[key] = result;\n\n    return result;\n}\n","const CTRL_CHAR_CODE = 'Control';\nconst ALT_CHAR_CODE = 'Alt';\nconst META_CHAR_CODE = 'Meta';\n\nconst CursorMovingKeys = new Set<string>([\n    'ArrowUp',\n    'ArrowDown',\n    'ArrowLeft',\n    'ArrowRight',\n    'Home',\n    'End',\n    'PageUp',\n    'PageDown',\n]);\n\n/**\n * Returns true when the event was fired from a modifier key, otherwise false\n * @param event The keyboard event object\n */\nexport function isModifierKey(event: KeyboardEvent): boolean {\n    const isCtrlKey = event.ctrlKey || event.key === CTRL_CHAR_CODE;\n    const isAltKey = event.altKey || event.key === ALT_CHAR_CODE;\n    const isMetaKey = event.metaKey || event.key === META_CHAR_CODE;\n\n    return isCtrlKey || isAltKey || isMetaKey;\n}\n\n/**\n * Returns true when the event was fired from a key that produces a character value, otherwise false\n * This detection is not 100% accurate. event.key is not fully supported by all browsers, and in some browsers (e.g. IE),\n * event.key is longer than 1 for num pad input. But here we just want to improve performance as much as possible.\n * So if we missed some case here it is still acceptable.\n * @param event The keyboard event object\n */\nexport function isCharacterValue(event: KeyboardEvent): boolean {\n    return !isModifierKey(event) && !!event.key && event.key.length == 1;\n}\n\n/**\n * @internal\n * Returns true if the given event is a cursor moving event (Left, Right, Up, Down, Home, End, Page Up, Page Down).\n * This does not check modifier keys (Ctrl, Alt, Meta). So if there are modifier keys pressed, it can still return true if one of the modifier key is pressed\n * @param event The keyboard event to check\n */\nexport function isCursorMovingKey(event: KeyboardEvent): boolean {\n    return CursorMovingKeys.has(event.key);\n}\n","import type { ContentModelSegment, ContentModelSegmentFormat } from 'roosterjs-content-model-types';\n\n/**\n * Get the text format of a segment, this function will return only format that is applicable to text\n * @param segment The segment to get format from\n * @returns\n */\nexport function getSegmentTextFormat(segment: ContentModelSegment): ContentModelSegmentFormat {\n    const { fontFamily, fontSize, textColor, backgroundColor, letterSpacing, lineHeight } =\n        segment?.format ?? {};\n\n    const textFormat: ContentModelSegmentFormat = {\n        fontFamily,\n        fontSize,\n        textColor,\n        backgroundColor,\n        letterSpacing,\n        lineHeight,\n    };\n\n    return removeUndefinedValues(textFormat);\n}\n\nconst removeUndefinedValues = (format: ContentModelSegmentFormat): ContentModelSegmentFormat => {\n    const textFormat: Record<string, string | undefined | boolean> = {};\n    Object.keys(format).filter(key => {\n        const value = format[key as keyof ContentModelSegmentFormat];\n        if (value !== undefined) {\n            textFormat[key] = value;\n        }\n    });\n    return textFormat;\n};\n","/**\n * Read a file object and invoke a callback function with the data url of this file\n * @param file The file to read\n * @param callback the callback to invoke with data url of the file.\n * If fail to read, dataUrl will be null\n */\nexport function readFile(file: File, callback: (dataUrl: string | null) => void) {\n    if (file) {\n        const reader = new FileReader();\n        reader.onload = () => {\n            callback(reader.result as string);\n        };\n        reader.onerror = () => {\n            callback(null);\n        };\n        reader.readAsDataURL(file);\n    }\n}\n","const SPACES_REGEX = /[\\u2000\\u2009\\u200a\\u200b\\u202f\\u205f\\u3000\\s\\t\\r\\n]/gm;\nconst PUNCTUATIONS = '.,?!:\"()[]\\\\/';\n\n/**\n * Check if the given character is punctuation\n * @param char The character to check\n */\nexport function isPunctuation(char: string) {\n    return PUNCTUATIONS.indexOf(char) >= 0;\n}\n\n/**\n * Check if the give character is a space. A space can be normal ASCII pace (32) or non-break space (160) or other kinds of spaces\n * such as ZeroWidthSpace, ...\n * @param char The character to check\n */\nexport function isSpace(char: string) {\n    const code = char?.charCodeAt(0) ?? 0;\n    return code == 160 || code == 32 || SPACES_REGEX.test(char);\n}\n\n/**\n * Normalize spaces of the given string. After normalization, all leading (for forward) or trailing (for backward) spaces\n * will be replaces with non-break space (160)\n * @param txt The string to normalize\n * @param isForward Whether normalize forward or backward\n */\nexport function normalizeText(txt: string, isForward: boolean): string {\n    return txt.replace(isForward ? /^\\u0020+/ : /\\u0020+$/, '\\u00A0');\n}\n","import { toArray } from 'roosterjs-content-model-dom';\nimport type { TableSelection } from 'roosterjs-content-model-types';\n\n/**\n * Parse a table into a two dimensions array of TD elements. For those merged cells, the value will be null.\n * @param table Input HTML Table element\n * @returns Array of TD elements\n */\nexport function parseTableCells(table: HTMLTableElement): (HTMLTableCellElement | null)[][] {\n    const trs = toArray(table.rows);\n    const cells: (HTMLTableCellElement | null)[][] = trs.map(row => []);\n\n    trs.forEach((tr, rowIndex) => {\n        for (let sourceCol = 0, targetCol = 0; sourceCol < tr.cells.length; sourceCol++) {\n            // Skip the cells which already initialized\n            for (; cells[rowIndex][targetCol] !== undefined; targetCol++) {}\n\n            const td = tr.cells[sourceCol];\n\n            for (let colSpan = 0; colSpan < td.colSpan; colSpan++, targetCol++) {\n                for (let rowSpan = 0; rowSpan < td.rowSpan; rowSpan++) {\n                    if (cells[rowIndex + rowSpan]) {\n                        cells[rowIndex + rowSpan][targetCol] =\n                            colSpan == 0 && rowSpan == 0 ? td : null;\n                    }\n                }\n            }\n        }\n\n        for (let col = 0; col < cells[rowIndex].length; col++) {\n            cells[rowIndex][col] = cells[rowIndex][col] || null;\n        }\n    });\n\n    return cells;\n}\n\n/**\n * Create ranges from a table selection\n * @param selection The source table selection\n * @returns An array of DOM ranges of selected table cells\n */\nexport function createTableRanges(selection: TableSelection): Range[] {\n    const result: Range[] = [];\n    const { table, firstColumn, firstRow, lastColumn, lastRow } = selection;\n    const cells = parseTableCells(table);\n\n    for (let row = firstRow; row <= lastRow; row++) {\n        for (let col = firstColumn; col <= lastColumn; col++) {\n            const td = cells[row]?.[col];\n\n            if (td) {\n                const range = table.ownerDocument.createRange();\n\n                range.selectNode(td);\n                result.push(range);\n            }\n        }\n    }\n\n    return result;\n}\n","import { extractBorderValues } from '../domUtils/borderValues';\nimport { getClosestAncestorBlockGroupIndex } from '../model/getClosestAncestorBlockGroupIndex';\nimport { isBold } from '../model/isBold';\nimport { iterateSelections } from '../selection/iterateSelections';\nimport { parseValueWithUnit } from 'roosterjs-content-model-dom';\nimport { updateTableMetadata } from '../../metadata/updateTableMetadata';\nimport type {\n    ContentModelFormatState,\n    ContentModelBlock,\n    ContentModelBlockGroup,\n    ContentModelDocument,\n    ContentModelFormatContainer,\n    ContentModelImage,\n    ContentModelListItem,\n    ContentModelParagraph,\n    ContentModelSegmentFormat,\n    TableSelectionContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * Retrieve format state from the given Content Model\n * @param model The Content Model to retrieve format state from\n * @param pendingFormat Existing pending format, if any\n * @param formatState Existing format state object, used for receiving the result\n */\nexport function retrieveModelFormatState(\n    model: ContentModelDocument,\n    pendingFormat: ContentModelSegmentFormat | null,\n    formatState: ContentModelFormatState\n) {\n    let firstTableContext: TableSelectionContext | undefined;\n    let firstBlock: ContentModelBlock | undefined;\n    let isFirst = true;\n    let isFirstImage = true;\n    let isFirstSegment = true;\n\n    iterateSelections(\n        model,\n        (path, tableContext, block, segments) => {\n            // Structure formats\n            retrieveStructureFormat(formatState, path, isFirst);\n\n            // Multiple line format\n            if (block) {\n                if (firstBlock) {\n                    formatState.isMultilineSelection = true;\n                } else {\n                    firstBlock = block;\n                }\n            }\n\n            if (block?.blockType == 'Paragraph') {\n                // Paragraph formats\n                retrieveParagraphFormat(formatState, block, isFirst);\n\n                // Segment formats\n                segments?.forEach(segment => {\n                    if (isFirstSegment || segment.segmentType != 'SelectionMarker') {\n                        const modelFormat = Object.assign({}, model.format);\n                        delete modelFormat?.italic;\n                        delete modelFormat?.underline;\n                        delete modelFormat?.fontWeight;\n\n                        retrieveSegmentFormat(\n                            formatState,\n                            isFirst,\n                            Object.assign(\n                                {},\n                                modelFormat,\n                                block.format,\n                                block.decorator?.format,\n                                segment.format,\n                                segment.code?.format,\n                                segment.link?.format,\n                                pendingFormat\n                            )\n                        );\n\n                        mergeValue(formatState, 'isCodeInline', !!segment?.code, isFirst);\n                    }\n\n                    // We only care the format of selection marker when it is the first selected segment. This is because when selection marker\n                    // is after some other selected segments, it mostly like appears at the beginning of a seconde line when the whole first line\n                    // is selected (e.g. triple-click on a line) then the second selection marker doesn't contain a correct format, so we need to\n                    // ignore it\n                    isFirstSegment = false;\n\n                    formatState.canUnlink = formatState.canUnlink || !!segment.link;\n                    formatState.canAddImageAltText =\n                        formatState.canAddImageAltText ||\n                        segments.some(segment => segment.segmentType == 'Image');\n\n                    isFirst = false;\n\n                    if (segment.segmentType === 'Image') {\n                        if (isFirstImage) {\n                            retrieveImageFormat(segment, formatState);\n                            isFirstImage = false;\n                        } else {\n                            formatState.imageFormat = undefined;\n                        }\n                    }\n                });\n\n                isFirst = false;\n            }\n\n            if (tableContext) {\n                if (firstTableContext) {\n                    const { table, colIndex, rowIndex } = firstTableContext;\n\n                    // Merge table format\n                    if (\n                        tableContext.table == table &&\n                        (tableContext.colIndex != colIndex || tableContext.rowIndex != rowIndex)\n                    ) {\n                        formatState.canMergeTableCell = true;\n                        formatState.isMultilineSelection = true;\n                    }\n                } else {\n                    // Table formats\n                    retrieveTableFormat(tableContext, formatState);\n                    firstTableContext = tableContext;\n                }\n            }\n        },\n        {\n            includeListFormatHolder: 'never',\n        }\n    );\n\n    if (formatState.fontSize) {\n        formatState.fontSize = px2Pt(formatState.fontSize);\n    }\n}\n\nfunction retrieveSegmentFormat(\n    result: ContentModelFormatState,\n    isFirst: boolean,\n    mergedFormat: ContentModelSegmentFormat\n) {\n    const superOrSubscript = mergedFormat.superOrSubScriptSequence?.split(' ')?.pop();\n\n    mergeValue(result, 'isBold', isBold(mergedFormat.fontWeight), isFirst);\n    mergeValue(result, 'isItalic', mergedFormat.italic, isFirst);\n    mergeValue(result, 'isUnderline', mergedFormat.underline, isFirst);\n    mergeValue(result, 'isStrikeThrough', mergedFormat.strikethrough, isFirst);\n    mergeValue(result, 'isSuperscript', superOrSubscript == 'super', isFirst);\n    mergeValue(result, 'isSubscript', superOrSubscript == 'sub', isFirst);\n    mergeValue(result, 'letterSpacing', mergedFormat.letterSpacing, isFirst);\n\n    mergeValue(result, 'fontName', mergedFormat.fontFamily, isFirst);\n    mergeValue(\n        result,\n        'fontSize',\n        mergedFormat.fontSize,\n        isFirst,\n        val => parseValueWithUnit(val, undefined, 'pt') + 'pt'\n    );\n    mergeValue(result, 'backgroundColor', mergedFormat.backgroundColor, isFirst);\n    mergeValue(result, 'textColor', mergedFormat.textColor, isFirst);\n    mergeValue(result, 'fontWeight', mergedFormat.fontWeight, isFirst);\n    mergeValue(result, 'lineHeight', mergedFormat.lineHeight, isFirst);\n}\n\nfunction retrieveParagraphFormat(\n    result: ContentModelFormatState,\n    paragraph: ContentModelParagraph,\n    isFirst: boolean\n) {\n    const headingLevel = parseInt((paragraph.decorator?.tagName || '').substring(1));\n    const validHeadingLevel = headingLevel >= 1 && headingLevel <= 6 ? headingLevel : undefined;\n\n    mergeValue(result, 'marginBottom', paragraph.format.marginBottom, isFirst);\n    mergeValue(result, 'marginTop', paragraph.format.marginTop, isFirst);\n    mergeValue(result, 'headingLevel', validHeadingLevel, isFirst);\n    mergeValue(result, 'textAlign', paragraph.format.textAlign, isFirst);\n    mergeValue(result, 'direction', paragraph.format.direction, isFirst);\n}\n\nfunction retrieveStructureFormat(\n    result: ContentModelFormatState,\n    path: ContentModelBlockGroup[],\n    isFirst: boolean\n) {\n    const listItemIndex = getClosestAncestorBlockGroupIndex(path, ['ListItem'], []);\n    const containerIndex = getClosestAncestorBlockGroupIndex(path, ['FormatContainer'], []);\n\n    if (listItemIndex >= 0) {\n        const listItem = path[listItemIndex] as ContentModelListItem;\n        const listType = listItem?.levels[listItem.levels.length - 1]?.listType;\n\n        mergeValue(result, 'isBullet', listType == 'UL', isFirst);\n        mergeValue(result, 'isNumbering', listType == 'OL', isFirst);\n    }\n\n    mergeValue(\n        result,\n        'isBlockQuote',\n        containerIndex >= 0 &&\n            (path[containerIndex] as ContentModelFormatContainer)?.tagName == 'blockquote',\n        isFirst\n    );\n}\n\nfunction retrieveTableFormat(tableContext: TableSelectionContext, result: ContentModelFormatState) {\n    const tableFormat = updateTableMetadata(tableContext.table);\n\n    result.isInTable = true;\n    result.tableHasHeader = tableContext.table.rows.some(row =>\n        row.cells.some(cell => cell.isHeader)\n    );\n\n    if (tableFormat) {\n        result.tableFormat = tableFormat;\n    }\n}\n\nfunction retrieveImageFormat(image: ContentModelImage, result: ContentModelFormatState) {\n    const { format } = image;\n    const borderKey = 'borderTop';\n    const extractedBorder = extractBorderValues(format[borderKey]);\n    const borderColor = extractedBorder.color;\n    const borderWidth = extractedBorder.width;\n    const borderStyle = extractedBorder.style;\n    result.imageFormat = {\n        borderColor,\n        borderWidth,\n        borderStyle,\n        boxShadow: format.boxShadow,\n        borderRadius: format.borderRadius,\n    };\n}\n\nfunction mergeValue<K extends keyof ContentModelFormatState>(\n    format: ContentModelFormatState,\n    key: K,\n    newValue: ContentModelFormatState[K] | undefined,\n    isFirst: boolean,\n    parseFn: (val: ContentModelFormatState[K]) => ContentModelFormatState[K] = val => val\n) {\n    if (isFirst) {\n        if (newValue !== undefined) {\n            format[key] = newValue;\n        }\n    } else if (parseFn(newValue) !== parseFn(format[key])) {\n        delete format[key];\n    }\n}\n\nfunction px2Pt(px: string) {\n    if (px && px.indexOf('px') == px.length - 2) {\n        // Edge may not handle the floating computing well which causes the calculated value is a little less than actual value\n        // So add 0.05 to fix it\n        return Math.round(parseFloat(px) * 75 + 0.05) / 100 + 'pt';\n    }\n    return px;\n}\n","import type {\n    ContentModelBlock,\n    ContentModelBlockBase,\n    ContentModelBlockGroupBase,\n    ContentModelBlockGroupType,\n    ContentModelBlockType,\n    ContentModelDivider,\n    ContentModelDocument,\n    ContentModelEntity,\n    ContentModelFormatBase,\n    ContentModelFormatContainer,\n    ContentModelGeneralBlock,\n    ContentModelImage,\n    ContentModelListItem,\n    ContentModelParagraph,\n    ContentModelSegment,\n    ContentModelSegmentBase,\n    ContentModelSegmentType,\n    ContentModelSelectionMarker,\n    ContentModelTable,\n    ContentModelTableCell,\n    ContentModelWithDataset,\n    ContentModelWithFormat,\n    ContentModelGeneralSegment,\n    ContentModelText,\n    ContentModelTableRow,\n    ContentModelListLevel,\n} from 'roosterjs-content-model-types';\n\n/**\n * Function type used for cloneModel API to specify how to handle cached element when clone a model\n * @param node The cached node\n * @param type Type of the node, it can be\n * - general: DOM element of ContentModelGeneralSegment or ContentModelGeneralBlock\n * - entity: Wrapper element in ContentModelEntity\n * - cache: Cached node in other model element that supports cache\n */\nexport type CachedElementHandler = (\n    node: HTMLElement,\n    type: 'general' | 'entity' | 'cache'\n) => HTMLElement | undefined;\n\n/**\n *\n * Options for cloneModel API\n */\nexport interface CloneModelOptions {\n    /**\n     * Specify how to deal with cached element, including cached block element, element in General Model, and wrapper element in Entity\n     * - True: Cloned model will have the same reference to the cached element\n     * - False/Not passed: For cached block element, cached element will be undefined. For General Model and Entity, the element will have deep clone and assign to the cloned model\n     * - A callback: invoke the callback with the source cached element and a string to specify model type, let the callback return the expected value of cached element.\n     * For General Model and Entity, the callback must return a valid element, otherwise there will be exception thrown.\n     */\n    includeCachedElement?: boolean | CachedElementHandler;\n}\n\n/**\n * Clone a content model\n * @param model The content model to clone\n * @param options @optional Options to specify customize the clone behavior\n */\nexport function cloneModel(\n    model: ContentModelDocument,\n    options?: CloneModelOptions\n): ContentModelDocument {\n    const newModel: ContentModelDocument = cloneBlockGroupBase(model, options || {});\n\n    if (model.format) {\n        newModel.format = Object.assign({}, model.format);\n    }\n\n    return newModel;\n}\n\nfunction cloneBlock(block: ContentModelBlock, options: CloneModelOptions): ContentModelBlock {\n    switch (block.blockType) {\n        case 'BlockGroup':\n            switch (block.blockGroupType) {\n                case 'FormatContainer':\n                    return cloneFormatContainer(block, options);\n                case 'General':\n                    return cloneGeneralBlock(block, options);\n                case 'ListItem':\n                    return cloneListItem(block, options);\n            }\n            break;\n        case 'Divider':\n            return cloneDivider(block, options);\n        case 'Entity':\n            return cloneEntity(block, options);\n        case 'Paragraph':\n            return cloneParagraph(block, options);\n        case 'Table':\n            return cloneTable(block, options);\n    }\n}\n\nfunction cloneSegment(\n    segment: ContentModelSegment,\n    options: CloneModelOptions\n): ContentModelSegment {\n    switch (segment.segmentType) {\n        case 'Br':\n            return cloneSegmentBase(segment);\n        case 'Entity':\n            return cloneEntity(segment, options);\n        case 'General':\n            return cloneGeneralSegment(segment, options);\n        case 'Image':\n            return cloneImage(segment);\n        case 'SelectionMarker':\n            return cloneSelectionMarker(segment);\n        case 'Text':\n            return cloneText(segment);\n    }\n}\n\nfunction cloneModelWithFormat<T extends ContentModelFormatBase>(\n    model: ContentModelWithFormat<T>\n): ContentModelWithFormat<T> {\n    return {\n        format: Object.assign({}, model.format),\n    };\n}\n\nfunction cloneModelWithDataset<T>(model: ContentModelWithDataset<T>): ContentModelWithDataset<T> {\n    return {\n        dataset: Object.assign({}, model.dataset),\n    };\n}\n\nfunction cloneBlockBase<T extends ContentModelBlockType>(\n    block: ContentModelBlockBase<T>\n): ContentModelBlockBase<T> {\n    const { blockType } = block;\n\n    return Object.assign(\n        {\n            blockType,\n        },\n        cloneModelWithFormat(block)\n    );\n}\n\nfunction cloneBlockGroupBase<T extends ContentModelBlockGroupType>(\n    group: ContentModelBlockGroupBase<T>,\n    options: CloneModelOptions\n): ContentModelBlockGroupBase<T> {\n    const { blockGroupType, blocks } = group;\n\n    return {\n        blockGroupType: blockGroupType,\n        blocks: blocks.map(block => cloneBlock(block, options)),\n    };\n}\n\nfunction cloneSegmentBase<T extends ContentModelSegmentType>(\n    segment: ContentModelSegmentBase<T>\n): ContentModelSegmentBase<T> {\n    const { segmentType, isSelected, code, link } = segment;\n\n    const newSegment: ContentModelSegmentBase<T> = Object.assign(\n        {\n            segmentType,\n            isSelected,\n        },\n        cloneModelWithFormat(segment)\n    );\n\n    if (code) {\n        newSegment.code = cloneModelWithFormat(code);\n    }\n    if (link) {\n        newSegment.link = Object.assign(cloneModelWithFormat(link), cloneModelWithDataset(link));\n    }\n\n    return newSegment;\n}\n\nfunction cloneEntity(entity: ContentModelEntity, options: CloneModelOptions): ContentModelEntity {\n    const { wrapper, entityFormat } = entity;\n\n    return Object.assign(\n        {\n            wrapper: handleCachedElement(wrapper, 'entity', options),\n            entityFormat: { ...entityFormat },\n        },\n        cloneBlockBase(entity),\n        cloneSegmentBase(entity)\n    );\n}\n\nfunction cloneParagraph(\n    paragraph: ContentModelParagraph,\n    options: CloneModelOptions\n): ContentModelParagraph {\n    const { cachedElement, segments, isImplicit, decorator, segmentFormat } = paragraph;\n\n    const newParagraph: ContentModelParagraph = Object.assign(\n        {\n            cachedElement: handleCachedElement(cachedElement, 'cache', options),\n            isImplicit,\n            segments: segments.map(segment => cloneSegment(segment, options)),\n            segmentFormat: segmentFormat ? { ...segmentFormat } : undefined,\n        },\n        cloneBlockBase(paragraph),\n        cloneModelWithFormat(paragraph)\n    );\n\n    if (decorator) {\n        newParagraph.decorator = Object.assign(\n            {\n                tagName: decorator.tagName,\n            },\n            cloneModelWithFormat(decorator)\n        );\n    }\n\n    return newParagraph;\n}\n\nfunction cloneTable(table: ContentModelTable, options: CloneModelOptions): ContentModelTable {\n    const { cachedElement, widths, rows } = table;\n\n    return Object.assign(\n        {\n            cachedElement: handleCachedElement(cachedElement, 'cache', options),\n            widths: Array.from(widths),\n            rows: rows.map(row => cloneTableRow(row, options)),\n        },\n        cloneBlockBase(table),\n        cloneModelWithDataset(table)\n    );\n}\n\nfunction cloneTableRow(\n    row: ContentModelTableRow,\n    options: CloneModelOptions\n): ContentModelTableRow {\n    const { height, cells, cachedElement } = row;\n\n    return Object.assign(\n        {\n            height,\n            cachedElement: handleCachedElement(cachedElement, 'cache', options),\n            cells: cells.map(cell => cloneTableCell(cell, options)),\n        },\n        cloneModelWithFormat(row)\n    );\n}\n\nfunction cloneTableCell(\n    cell: ContentModelTableCell,\n    options: CloneModelOptions\n): ContentModelTableCell {\n    const { cachedElement, isSelected, spanAbove, spanLeft, isHeader } = cell;\n\n    return Object.assign(\n        {\n            cachedElement: handleCachedElement(cachedElement, 'cache', options),\n            isSelected,\n            spanAbove,\n            spanLeft,\n            isHeader,\n        },\n        cloneBlockGroupBase(cell, options),\n        cloneModelWithFormat(cell),\n        cloneModelWithDataset(cell)\n    );\n}\n\nfunction cloneFormatContainer(\n    container: ContentModelFormatContainer,\n    options: CloneModelOptions\n): ContentModelFormatContainer {\n    const { tagName, cachedElement } = container;\n    const newContainer: ContentModelFormatContainer = Object.assign(\n        { tagName, cachedElement: handleCachedElement(cachedElement, 'cache', options) },\n        cloneBlockBase(container),\n        cloneBlockGroupBase(container, options)\n    );\n\n    if (container.zeroFontSize) {\n        newContainer.zeroFontSize = true;\n    }\n\n    return newContainer;\n}\n\nfunction cloneListItem(\n    item: ContentModelListItem,\n    options: CloneModelOptions\n): ContentModelListItem {\n    const { formatHolder, levels } = item;\n\n    return Object.assign(\n        {\n            formatHolder: cloneSelectionMarker(formatHolder),\n            levels: levels.map(cloneListLevel),\n        },\n        cloneBlockBase(item),\n        cloneBlockGroupBase(item, options)\n    );\n}\n\nfunction cloneListLevel(level: ContentModelListLevel): ContentModelListLevel {\n    const { listType } = level;\n\n    return Object.assign({ listType }, cloneModelWithFormat(level), cloneModelWithDataset(level));\n}\nfunction cloneDivider(\n    divider: ContentModelDivider,\n    options: CloneModelOptions\n): ContentModelDivider {\n    const { tagName, isSelected, cachedElement } = divider;\n\n    return Object.assign(\n        {\n            isSelected,\n            tagName,\n            cachedElement: handleCachedElement(cachedElement, 'cache', options),\n        },\n        cloneBlockBase(divider)\n    );\n}\n\nfunction cloneGeneralBlock(\n    general: ContentModelGeneralBlock,\n    options: CloneModelOptions\n): ContentModelGeneralBlock {\n    const { element } = general;\n\n    return Object.assign(\n        {\n            element: handleCachedElement(element, 'general', options),\n        },\n        cloneBlockBase(general),\n        cloneBlockGroupBase(general, options)\n    );\n}\n\nfunction cloneSelectionMarker(marker: ContentModelSelectionMarker): ContentModelSelectionMarker {\n    return Object.assign({ isSelected: marker.isSelected }, cloneSegmentBase(marker));\n}\n\nfunction cloneImage(image: ContentModelImage): ContentModelImage {\n    const { src, alt, title, isSelectedAsImageSelection } = image;\n\n    return Object.assign(\n        { src, alt, title, isSelectedAsImageSelection },\n        cloneSegmentBase(image),\n        cloneModelWithDataset(image)\n    );\n}\n\nfunction cloneGeneralSegment(\n    general: ContentModelGeneralSegment,\n    options: CloneModelOptions\n): ContentModelGeneralSegment {\n    return Object.assign(cloneGeneralBlock(general, options), cloneSegmentBase(general));\n}\n\nfunction cloneText(textSegment: ContentModelText): ContentModelText {\n    const { text } = textSegment;\n    return Object.assign({ text }, cloneSegmentBase(textSegment));\n}\n\nfunction handleCachedElement<T extends HTMLElement>(\n    node: T,\n    type: 'general' | 'entity',\n    options: CloneModelOptions\n): T;\n\nfunction handleCachedElement<T extends HTMLElement>(\n    node: T | undefined,\n    type: 'cache',\n    options: CloneModelOptions\n): T | undefined;\n\nfunction handleCachedElement<T extends HTMLElement>(\n    node: T | undefined,\n    type: 'general' | 'entity' | 'cache',\n    options: CloneModelOptions\n): T | undefined {\n    const { includeCachedElement } = options;\n\n    if (!node) {\n        return undefined;\n    } else if (!includeCachedElement) {\n        return type == 'cache' ? undefined : (node.cloneNode(true /*deep*/) as T);\n    } else if (includeCachedElement === true) {\n        return node;\n    } else {\n        const result = includeCachedElement(node, type) as T | undefined;\n\n        if ((type == 'general' || type == 'entity') && !result) {\n            throw new Error('Entity and General Model must has wrapper element');\n        }\n\n        return result;\n    }\n}\n","import { convertInlineCss, retrieveCssRules } from '../../utils/convertInlineCss';\nimport { createDomToModelContextForSanitizing } from '../../utils/createDomToModelContextForSanitizing';\nimport { createEmptyModel, domToContentModel, parseFormat } from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelDocument,\n    ContentModelSegmentFormat,\n    DomToModelOption,\n    TrustedHTMLHandler,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create Content Model from HTML string\n * @param html The source HTML string\n * @param options Options for DOM to Content Model conversion\n * @param trustedHTMLHandler A string handler to convert string to trusted string\n * @returns A Content Model Document object that contains the Content Model from the give HTML, or undefined if failed to parse the source HTML\n */\nexport function createModelFromHtml(\n    html: string,\n    options?: DomToModelOption,\n    trustedHTMLHandler?: TrustedHTMLHandler,\n    defaultSegmentFormat?: ContentModelSegmentFormat\n): ContentModelDocument {\n    const doc = html\n        ? new DOMParser().parseFromString(trustedHTMLHandler?.(html) ?? html, 'text/html')\n        : null;\n\n    if (doc?.body) {\n        const context = createDomToModelContextForSanitizing(doc, defaultSegmentFormat, options);\n        const cssRules = doc ? retrieveCssRules(doc) : [];\n\n        convertInlineCss(doc, cssRules);\n        parseFormat(doc.body, context.formatParsers.segmentOnBlock, context.segmentFormat, context);\n\n        return domToContentModel(doc.body, context);\n    } else {\n        return createEmptyModel(defaultSegmentFormat);\n    }\n}\n","import {\n    contentModelToDom,\n    contentModelToText,\n    createModelToDomContext,\n} from 'roosterjs-content-model-dom';\nimport type { ExportContentMode, IEditor, ModelToDomOption } from 'roosterjs-content-model-types';\n\n/**\n * Export string content of editor\n * @param editor The editor to get content from\n * @param mode Mode of content to export. It supports:\n * - HTML: Export HTML content. If there are entities, this will cause EntityOperation event with option = 'replaceTemporaryContent' to get a dehydrated entity\n * - PlainText: Export plain text content\n * - PlainTextFast: Export plain text using editor's textContent property directly\n * @param options @optional Options for Model to DOM conversion\n */\nexport function exportContent(\n    editor: IEditor,\n    mode: ExportContentMode = 'HTML',\n    options?: ModelToDomOption\n): string {\n    if (mode == 'PlainTextFast') {\n        return editor.getDOMHelper().getTextContent();\n    } else {\n        const model = editor.getContentModelCopy('disconnected');\n\n        if (mode == 'PlainText') {\n            return contentModelToText(model);\n        } else {\n            const doc = editor.getDocument();\n            const div = doc.createElement('div');\n\n            contentModelToDom(\n                doc,\n                div,\n                model,\n                createModelToDomContext(undefined /*editorContext*/, options)\n            );\n\n            editor.triggerEvent('extractContentWithDom', { clonedRoot: div }, true /*broadcast*/);\n\n            return div.innerHTML;\n        }\n    }\n}\n","import type {\n    ContentModelBlockGroup,\n    ContentModelBlockGroupBase,\n    ContentModelBlockGroupType,\n} from 'roosterjs-content-model-types';\n\n/**\n * Retrieve block group type string from a given block group\n */\nexport type TypeOfBlockGroup<\n    T extends ContentModelBlockGroup\n> = T extends ContentModelBlockGroupBase<infer U> ? U : never;\n\n/**\n * Get index of closest ancestor block group of the expected block group type. If not found, return -1\n * @param path The block group path, from the closest one to root\n * @param blockGroupTypes The expected block group types\n * @param stopTypes @optional Block group types that will cause stop searching\n */\nexport function getClosestAncestorBlockGroupIndex<T extends ContentModelBlockGroup>(\n    path: ContentModelBlockGroup[],\n    blockGroupTypes: TypeOfBlockGroup<T>[],\n    stopTypes: ContentModelBlockGroupType[] = []\n): number {\n    for (let i = 0; i < path.length; i++) {\n        const group = path[i];\n\n        if ((blockGroupTypes as string[]).indexOf(group.blockGroupType) >= 0) {\n            return i;\n        } else if (stopTypes.indexOf(group.blockGroupType) >= 0) {\n            // Do not go across boundary specified by stopTypes.\n            // For example, in most case we will set table as the boundary,\n            // in order to allow modify list item under a table when the table itself is in another list item\n            // Although this is not very likely to happen in most case, but we still need to handle it\n            return -1;\n        }\n    }\n\n    return -1;\n}\n","import type { ContentModelBlock, ContentModelBlockGroup } from 'roosterjs-content-model-types';\nimport type { TypeOfBlockGroup } from './getClosestAncestorBlockGroupIndex';\n\n/**\n * Check if the given content model block or block group is of the expected block group type\n * @param input The object to check\n * @param type The expected type\n */\nexport function isBlockGroupOfType<T extends ContentModelBlockGroup>(\n    input: ContentModelBlock | ContentModelBlockGroup | null | undefined,\n    type: TypeOfBlockGroup<T>\n): input is T {\n    const item = <T | null | undefined>input;\n\n    return item?.blockGroupType == type;\n}\n","/**\n * Check if the given bold style represents a bold style\n * @param boldStyle The style to check\n */\nexport function isBold(boldStyle?: string): boolean {\n    return (\n        !!boldStyle && (boldStyle == 'bold' || boldStyle == 'bolder' || parseInt(boldStyle) >= 600)\n    );\n}\n","import { applyTableFormat } from '../table/applyTableFormat';\nimport { deleteSelection } from '../../publicApi/selection/deleteSelection';\nimport { getClosestAncestorBlockGroupIndex } from './getClosestAncestorBlockGroupIndex';\nimport { normalizeTable } from '../table/normalizeTable';\nimport {\n    addSegment,\n    createListItem,\n    createParagraph,\n    createSelectionMarker,\n    createTableCell,\n    getObjectKeys,\n    normalizeContentModel,\n} from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelBlock,\n    ContentModelBlockFormat,\n    ContentModelBlockGroup,\n    ContentModelDocument,\n    ContentModelListItem,\n    ContentModelParagraph,\n    ContentModelSegmentFormat,\n    ContentModelTable,\n    FormatContentModelContext,\n    InsertPoint,\n} from 'roosterjs-content-model-types';\n\nconst HeadingTags = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\n/**\n * Options to specify how to merge models\n */\nexport interface MergeModelOption {\n    /**\n     * When there is only a table to merge, whether merge this table into current table (if any), or just directly insert (nested table).\n     * This is usually used when paste table inside a table\n     * @default false\n     */\n    mergeTable?: boolean;\n\n    /**\n     * Use this insert position to merge instead of querying selection from target model\n     * @default undefined\n     */\n    insertPosition?: InsertPoint;\n\n    /**\n     * Use this to decide whether to change the source model format when doing the merge.\n     * 'mergeAll': segment format of the insert position will be merged into the content that is merged into current model.\n     * If the source model already has some format, it will not be overwritten.\n     * 'keepSourceEmphasisFormat': format of the insert position will be set into the content that is merged into current model.\n     * If the source model already has emphasis format, such as, fontWeight, Italic or underline different than the default style, it will not be overwritten.\n     * 'none' the source segment format will not be modified.\n     * @default undefined\n     */\n    mergeFormat?: 'mergeAll' | 'keepSourceEmphasisFormat' | 'none';\n}\n\n/**\n * Merge source model into target mode\n * @param target Target Content Model that will merge content into\n * @param source Source Content Model will be merged to target model\n * @param context Format context. When call this function inside formatContentModel, provide this context so that formatContentModel will do extra handling to the result\n * @param options More options, see MergeModelOption\n * @returns Insert point after merge, or null if there is no insert point\n */\nexport function mergeModel(\n    target: ContentModelDocument,\n    source: ContentModelDocument,\n    context?: FormatContentModelContext,\n    options?: MergeModelOption\n): InsertPoint | null {\n    const insertPosition =\n        options?.insertPosition ?? deleteSelection(target, [], context).insertPoint;\n\n    if (insertPosition) {\n        if (options?.mergeFormat && options.mergeFormat != 'none') {\n            const newFormat: ContentModelSegmentFormat = {\n                ...(target.format || {}),\n                ...insertPosition.marker.format,\n            };\n\n            applyDefaultFormat(source, newFormat, options?.mergeFormat);\n        }\n\n        for (let i = 0; i < source.blocks.length; i++) {\n            const block = source.blocks[i];\n\n            switch (block.blockType) {\n                case 'Paragraph':\n                    mergeParagraph(insertPosition, block, i == 0, context, options);\n                    break;\n\n                case 'Divider':\n                    insertBlock(insertPosition, block);\n                    break;\n\n                case 'Entity':\n                    insertBlock(insertPosition, block);\n                    context?.newEntities.push(block);\n                    break;\n\n                case 'Table':\n                    if (source.blocks.length == 1 && options?.mergeTable) {\n                        mergeTable(insertPosition, block, source);\n                    } else {\n                        insertBlock(insertPosition, block);\n                    }\n                    break;\n\n                case 'BlockGroup':\n                    switch (block.blockGroupType) {\n                        case 'General':\n                        case 'FormatContainer':\n                            insertBlock(insertPosition, block);\n                            break;\n                        case 'ListItem':\n                            mergeList(insertPosition, block);\n                            break;\n                    }\n                    break;\n            }\n        }\n    }\n\n    normalizeContentModel(target);\n\n    return insertPosition;\n}\n\nfunction mergeParagraph(\n    markerPosition: InsertPoint,\n    newPara: ContentModelParagraph,\n    mergeToCurrentParagraph: boolean,\n    context?: FormatContentModelContext,\n    option?: MergeModelOption\n) {\n    const { paragraph, marker } = markerPosition;\n    const newParagraph = mergeToCurrentParagraph\n        ? paragraph\n        : splitParagraph(markerPosition, newPara.format);\n    const segmentIndex = newParagraph.segments.indexOf(marker);\n\n    if (option?.mergeFormat == 'none' && mergeToCurrentParagraph) {\n        newParagraph.segments.forEach(segment => {\n            segment.format = { ...(newParagraph.segmentFormat || {}), ...segment.format };\n        });\n        delete newParagraph.segmentFormat;\n    }\n    if (segmentIndex >= 0) {\n        for (let i = 0; i < newPara.segments.length; i++) {\n            const segment = newPara.segments[i];\n\n            newParagraph.segments.splice(segmentIndex + i, 0, segment);\n\n            if (context) {\n                if (segment.segmentType == 'Entity') {\n                    context.newEntities.push(segment);\n                }\n\n                if (segment.segmentType == 'Image') {\n                    context.newImages.push(segment);\n                }\n            }\n        }\n    }\n\n    if (newPara.decorator) {\n        newParagraph.decorator = { ...newPara.decorator };\n        if (HeadingTags.indexOf(newParagraph.decorator.tagName) > -1) {\n            const sourceKeys: (keyof ContentModelSegmentFormat)[] = getObjectKeys(\n                newParagraph.decorator.format\n            );\n            const segmentDecoratorKeys: (keyof ContentModelSegmentFormat)[] = getObjectKeys(\n                newParagraph.segmentFormat || {}\n            );\n\n            sourceKeys.forEach(key => {\n                if (segmentDecoratorKeys.indexOf(key) > -1) {\n                    delete newParagraph.segmentFormat?.[key];\n                }\n            });\n        }\n    }\n\n    if (!mergeToCurrentParagraph) {\n        newParagraph.format = newPara.format;\n    }\n}\n\nfunction mergeTable(\n    markerPosition: InsertPoint,\n    newTable: ContentModelTable,\n    source: ContentModelDocument\n) {\n    const { tableContext, marker } = markerPosition;\n\n    if (tableContext && source.blocks.length == 1 && source.blocks[0] == newTable) {\n        const { table, colIndex, rowIndex } = tableContext;\n        for (let i = 0; i < newTable.rows.length; i++) {\n            for (let j = 0; j < newTable.rows[i].cells.length; j++) {\n                const newCell = newTable.rows[i].cells[j];\n\n                if (i == 0 && colIndex + j >= table.rows[0].cells.length) {\n                    for (let k = 0; k < table.rows.length; k++) {\n                        const leftCell = table.rows[k]?.cells[colIndex + j - 1];\n                        table.rows[k].cells[colIndex + j] = createTableCell(\n                            false /*spanLeft*/,\n                            false /*spanAbove*/,\n                            leftCell?.isHeader,\n                            leftCell?.format\n                        );\n                    }\n                }\n\n                if (j == 0 && rowIndex + i >= table.rows.length) {\n                    if (!table.rows[rowIndex + i]) {\n                        table.rows[rowIndex + i] = {\n                            cells: [],\n                            format: {},\n                            height: 0,\n                        };\n                    }\n\n                    for (let k = 0; k < table.rows[rowIndex].cells.length; k++) {\n                        const aboveCell = table.rows[rowIndex + i - 1]?.cells[k];\n                        table.rows[rowIndex + i].cells[k] = createTableCell(\n                            false /*spanLeft*/,\n                            false /*spanAbove*/,\n                            false /*isHeader*/,\n                            aboveCell?.format\n                        );\n                    }\n                }\n\n                const oldCell = table.rows[rowIndex + i].cells[colIndex + j];\n                table.rows[rowIndex + i].cells[colIndex + j] = newCell;\n\n                if (i == 0 && j == 0) {\n                    const newMarker = createSelectionMarker(marker.format);\n                    const newPara = addSegment(newCell, newMarker);\n\n                    if (markerPosition.path[0] == oldCell) {\n                        // Update insert point to match the change result\n                        markerPosition.path[0] = newCell;\n                        markerPosition.marker = newMarker;\n                        markerPosition.paragraph = newPara;\n                    }\n                }\n            }\n        }\n\n        normalizeTable(table, markerPosition.marker.format);\n        applyTableFormat(table, undefined /*newFormat*/, true /*keepCellShade*/);\n    } else {\n        insertBlock(markerPosition, newTable);\n    }\n}\n\nfunction mergeList(markerPosition: InsertPoint, newList: ContentModelListItem) {\n    splitParagraph(markerPosition, newList.format);\n\n    const { path, paragraph } = markerPosition;\n\n    const listItemIndex = getClosestAncestorBlockGroupIndex(path, ['ListItem']);\n    const listItem = path[listItemIndex] as ContentModelListItem;\n    const listParent = path[listItemIndex + 1]; // It is ok here when index is -1, that means there is no list and we just insert a new paragraph and use path[0] as its parent\n    const blockIndex = listParent.blocks.indexOf(listItem || paragraph);\n\n    if (blockIndex >= 0) {\n        listParent.blocks.splice(blockIndex, 0, newList);\n    }\n\n    if (listItem) {\n        listItem?.levels.forEach((level, i) => {\n            newList.levels[i] = { ...level };\n        });\n    }\n}\n\nfunction splitParagraph(markerPosition: InsertPoint, newParaFormat: ContentModelBlockFormat) {\n    const { paragraph, marker, path } = markerPosition;\n    const segmentIndex = paragraph.segments.indexOf(marker);\n    const paraIndex = path[0].blocks.indexOf(paragraph);\n    const newParagraph = createParagraph(\n        false /*isImplicit*/,\n        { ...paragraph.format, ...newParaFormat },\n        paragraph.segmentFormat\n    );\n\n    if (segmentIndex >= 0) {\n        newParagraph.segments = paragraph.segments.splice(segmentIndex);\n    }\n\n    if (paraIndex >= 0) {\n        path[0].blocks.splice(paraIndex + 1, 0, newParagraph);\n    }\n\n    const listItemIndex = getClosestAncestorBlockGroupIndex(\n        path,\n        ['ListItem'],\n        ['FormatContainer', 'TableCell']\n    );\n    const listItem = path[listItemIndex] as ContentModelListItem;\n\n    if (listItem) {\n        const listParent = listItemIndex >= 0 ? path[listItemIndex + 1] : null;\n        const blockIndex = listParent ? listParent.blocks.indexOf(listItem) : -1;\n\n        if (blockIndex >= 0 && listParent) {\n            const newListItem = createListItem(listItem.levels, listItem.formatHolder.format);\n\n            if (paraIndex >= 0) {\n                newListItem.blocks = listItem.blocks.splice(paraIndex + 1);\n            }\n\n            if (blockIndex >= 0) {\n                listParent.blocks.splice(blockIndex + 1, 0, newListItem);\n            }\n\n            path[listItemIndex] = newListItem;\n        }\n    }\n\n    markerPosition.paragraph = newParagraph;\n\n    return newParagraph;\n}\n\nfunction insertBlock(markerPosition: InsertPoint, block: ContentModelBlock) {\n    const { path } = markerPosition;\n    const newParaFormat = block.blockType !== 'Paragraph' ? {} : block.format;\n    const newPara = splitParagraph(markerPosition, newParaFormat);\n    const blockIndex = path[0].blocks.indexOf(newPara);\n\n    if (blockIndex >= 0) {\n        path[0].blocks.splice(blockIndex, 0, block);\n    }\n}\n\nfunction applyDefaultFormat(\n    group: ContentModelBlockGroup,\n    format: ContentModelSegmentFormat,\n    applyDefaultFormatOption: 'mergeAll' | 'keepSourceEmphasisFormat'\n) {\n    group.blocks.forEach(block => {\n        switch (block.blockType) {\n            case 'BlockGroup':\n                if (block.blockGroupType == 'ListItem') {\n                    block.formatHolder.format = mergeSegmentFormat(\n                        applyDefaultFormatOption,\n                        format,\n                        block.formatHolder.format\n                    );\n                }\n                applyDefaultFormat(block, format, applyDefaultFormatOption);\n                break;\n\n            case 'Table':\n                block.rows.forEach(row =>\n                    row.cells.forEach(cell => {\n                        applyDefaultFormat(cell, format, applyDefaultFormatOption);\n                    })\n                );\n                break;\n\n            case 'Paragraph':\n                const paragraphFormat = block.decorator?.format || {};\n                block.segments.forEach(segment => {\n                    if (segment.segmentType == 'General') {\n                        applyDefaultFormat(segment, format, applyDefaultFormatOption);\n                    }\n\n                    segment.format = mergeSegmentFormat(applyDefaultFormatOption, format, {\n                        ...paragraphFormat,\n                        ...segment.format,\n                    });\n                });\n\n                if (applyDefaultFormatOption === 'keepSourceEmphasisFormat') {\n                    delete block.decorator;\n                }\n                break;\n        }\n    });\n}\n\nfunction mergeSegmentFormat(\n    applyDefaultFormatOption: 'mergeAll' | 'keepSourceEmphasisFormat',\n    targetformat: ContentModelSegmentFormat,\n    sourceFormat: ContentModelSegmentFormat\n): ContentModelSegmentFormat {\n    return applyDefaultFormatOption == 'mergeAll'\n        ? { ...targetformat, ...sourceFormat }\n        : {\n              ...targetformat,\n              ...getSemanticFormat(sourceFormat),\n          };\n}\n\nfunction getSemanticFormat(segmentFormat: ContentModelSegmentFormat): ContentModelSegmentFormat {\n    const result: ContentModelSegmentFormat = {};\n\n    const { fontWeight, italic, underline } = segmentFormat;\n\n    if (fontWeight && fontWeight != 'normal') {\n        result.fontWeight = fontWeight;\n    }\n    if (italic) {\n        result.italic = italic;\n    }\n    if (underline) {\n        result.underline = underline;\n    }\n\n    return result;\n}\n","import { getClosestAncestorBlockGroupIndex } from '../model/getClosestAncestorBlockGroupIndex';\nimport { isBlockGroupOfType } from '../model/isBlockGroupOfType';\nimport { iterateSelections } from './iterateSelections';\nimport type { IterateSelectionsOption } from './iterateSelections';\nimport type {\n    ContentModelBlock,\n    ContentModelBlockGroup,\n    ContentModelBlockGroupType,\n    ContentModelDocument,\n    ContentModelListItem,\n    ContentModelParagraph,\n    ContentModelSegment,\n    ContentModelTable,\n    TableSelectionContext,\n} from 'roosterjs-content-model-types';\nimport type { TypeOfBlockGroup } from '../model/getClosestAncestorBlockGroupIndex';\n\n/**\n * Represent a pair of parent block group and child block\n */\nexport type OperationalBlocks<T extends ContentModelBlockGroup> = {\n    /**\n     * The parent block group\n     */\n    parent: ContentModelBlockGroup;\n\n    /**\n     * The child block\n     */\n    block: ContentModelBlock | T;\n\n    /**\n     * Selection path of this block\n     */\n    path: ContentModelBlockGroup[];\n};\n\n/**\n * Get an array of selected parent paragraph and child segment pair\n * @param model The Content Model to get selection from\n * @param includingFormatHolder True means also include format holder as segment from list item, in that case paragraph will be null\n */\nexport function getSelectedSegmentsAndParagraphs(\n    model: ContentModelDocument,\n    includingFormatHolder: boolean\n): [ContentModelSegment, ContentModelParagraph | null][] {\n    const selections = collectSelections(model, {\n        includeListFormatHolder: includingFormatHolder ? 'allSegments' : 'never',\n    });\n    const result: [ContentModelSegment, ContentModelParagraph | null][] = [];\n\n    selections.forEach(({ segments, block }) => {\n        if (segments && ((includingFormatHolder && !block) || block?.blockType == 'Paragraph')) {\n            segments.forEach(segment => {\n                if (segment.segmentType != 'Entity' || !segment.entityFormat.isReadonly) {\n                    result.push([segment, block?.blockType == 'Paragraph' ? block : null]);\n                }\n            });\n        }\n    });\n\n    return result;\n}\n\n/**\n * Get an array of selected segments from a content model\n * @param model The Content Model to get selection from\n * @param includingFormatHolder True means also include format holder as segment from list item\n */\nexport function getSelectedSegments(\n    model: ContentModelDocument,\n    includingFormatHolder: boolean\n): ContentModelSegment[] {\n    return getSelectedSegmentsAndParagraphs(model, includingFormatHolder).map(x => x[0]);\n}\n\n/**\n * Get any array of selected paragraphs from a content model\n * @param model The Content Model to get selection from\n */\nexport function getSelectedParagraphs(model: ContentModelDocument): ContentModelParagraph[] {\n    const selections = collectSelections(model, { includeListFormatHolder: 'never' });\n    const result: ContentModelParagraph[] = [];\n\n    removeUnmeaningfulSelections(selections);\n\n    selections.forEach(({ block }) => {\n        if (block?.blockType == 'Paragraph') {\n            result.push(block);\n        }\n    });\n\n    return result;\n}\n\n/**\n * Get an array of block group - block pair that is of the expected block group type from selection\n * @param model The Content Model to get selection from\n * @param blockGroupTypes The expected block group types\n * @param stopTypes Block group types that will stop searching when hit\n * @param deepFirst True means search in deep first, otherwise wide first\n */\nexport function getOperationalBlocks<T extends ContentModelBlockGroup>(\n    model: ContentModelDocument,\n    blockGroupTypes: TypeOfBlockGroup<T>[],\n    stopTypes: ContentModelBlockGroupType[],\n    deepFirst?: boolean\n): OperationalBlocks<T>[] {\n    const result: OperationalBlocks<T>[] = [];\n    const findSequence = deepFirst ? blockGroupTypes.map(type => [type]) : [blockGroupTypes];\n    const selections = collectSelections(model, {\n        includeListFormatHolder: 'never',\n        contentUnderSelectedTableCell: 'ignoreForTable', // When whole table is selected, we treat the table as a single block\n    });\n\n    removeUnmeaningfulSelections(selections);\n\n    selections.forEach(({ path, block }) => {\n        for (let i = 0; i < findSequence.length; i++) {\n            const groupIndex = getClosestAncestorBlockGroupIndex(path, findSequence[i], stopTypes);\n\n            if (groupIndex >= 0) {\n                if (result.filter(x => x.block == path[groupIndex]).length <= 0) {\n                    result.push({\n                        parent: path[groupIndex + 1],\n                        block: path[groupIndex] as T,\n                        path: path.slice(groupIndex + 1),\n                    });\n                }\n                break;\n            } else if (i == findSequence.length - 1 && block) {\n                result.push({\n                    parent: path[0],\n                    block: block,\n                    path,\n                });\n                break;\n            }\n        }\n    });\n\n    return result;\n}\n\n/**\n * Get the first selected table from content model\n * @param model The Content Model to get selection from\n */\nexport function getFirstSelectedTable(\n    model: ContentModelDocument\n): [ContentModelTable | undefined, ContentModelBlockGroup[]] {\n    const selections = collectSelections(model, { includeListFormatHolder: 'never' });\n    let table: ContentModelTable | undefined;\n    let resultPath: ContentModelBlockGroup[] = [];\n\n    removeUnmeaningfulSelections(selections);\n\n    selections.forEach(({ block, tableContext, path }) => {\n        if (!table) {\n            if (block?.blockType == 'Table') {\n                table = block;\n                resultPath = [...path];\n            } else if (tableContext?.table) {\n                table = tableContext.table;\n\n                const parent = path.filter(\n                    group => group.blocks.indexOf(tableContext.table) >= 0\n                )[0];\n                const index = path.indexOf(parent);\n                resultPath = index >= 0 ? path.slice(index) : [];\n            }\n        }\n    });\n\n    return [table, resultPath];\n}\n\n/**\n * Get the first selected list item from content model\n * @param model The Content Model to get selection from\n */\nexport function getFirstSelectedListItem(\n    model: ContentModelDocument\n): ContentModelListItem | undefined {\n    let listItem: ContentModelListItem | undefined;\n\n    getOperationalBlocks(model, ['ListItem'], ['TableCell']).forEach(r => {\n        if (!listItem && isBlockGroupOfType<ContentModelListItem>(r.block, 'ListItem')) {\n            listItem = r.block;\n        }\n    });\n\n    return listItem;\n}\n\ninterface SelectionInfo {\n    path: ContentModelBlockGroup[];\n    segments?: ContentModelSegment[];\n    block?: ContentModelBlock;\n    tableContext?: TableSelectionContext;\n}\n\nfunction collectSelections(\n    model: ContentModelDocument,\n    option?: IterateSelectionsOption\n): SelectionInfo[] {\n    const selections: SelectionInfo[] = [];\n\n    iterateSelections(\n        model,\n        (path, tableContext, block, segments) => {\n            selections.push({\n                path,\n                tableContext,\n                block,\n                segments,\n            });\n        },\n        option\n    );\n\n    return selections;\n}\n\nfunction removeUnmeaningfulSelections(selections: SelectionInfo[]) {\n    if (\n        selections.length > 1 &&\n        isOnlySelectionMarkerSelected(selections, false /*checkFirstParagraph*/)\n    ) {\n        selections.pop();\n    }\n\n    // Remove head paragraph if first selection marker is the only selection\n    if (\n        selections.length > 1 &&\n        isOnlySelectionMarkerSelected(selections, true /*checkFirstParagraph*/)\n    ) {\n        selections.shift();\n    }\n}\n\nfunction isOnlySelectionMarkerSelected(\n    selections: SelectionInfo[],\n    checkFirstParagraph: boolean\n): boolean {\n    const selection = selections[checkFirstParagraph ? 0 : selections.length - 1];\n\n    if (\n        selection.block?.blockType == 'Paragraph' &&\n        selection.segments &&\n        selection.segments.length > 0\n    ) {\n        const allSegments = selection.block.segments;\n        const segment = selection.segments[0];\n\n        return (\n            selection.segments.length == 1 &&\n            segment.segmentType == 'SelectionMarker' &&\n            segment == allSegments[checkFirstParagraph ? allSegments.length - 1 : 0]\n        );\n    } else {\n        return false;\n    }\n}\n","import type {\n    ContentModelBlock,\n    EntityRemovalOperation,\n    FormatContentModelContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * Delete a content model block from current selection\n * @param blocks Array of the block to delete\n * @param blockToDelete The block to delete\n * @param replacement @optional If specified, use this block to replace the deleted block\n * @param context @optional Context object provided by formatContentModel API\n * @param direction @optional Whether this is deleting forward or backward. This is only used for deleting entity.\n * If not specified, only selected entity will be deleted\n */\nexport function deleteBlock(\n    blocks: ContentModelBlock[],\n    blockToDelete: ContentModelBlock,\n    replacement?: ContentModelBlock,\n    context?: FormatContentModelContext,\n    direction?: 'forward' | 'backward'\n): boolean {\n    const index = blocks.indexOf(blockToDelete);\n\n    switch (blockToDelete.blockType) {\n        case 'Table':\n        case 'Divider':\n            replacement ? blocks.splice(index, 1, replacement) : blocks.splice(index, 1);\n            return true;\n\n        case 'Entity':\n            const operation: EntityRemovalOperation | undefined = blockToDelete.isSelected\n                ? 'overwrite'\n                : direction == 'forward'\n                ? 'removeFromStart'\n                : direction == 'backward'\n                ? 'removeFromEnd'\n                : undefined;\n\n            if (operation !== undefined) {\n                replacement ? blocks.splice(index, 1, replacement) : blocks.splice(index, 1);\n                context?.deletedEntities.push({\n                    entity: blockToDelete,\n                    operation,\n                });\n            }\n\n            return true;\n\n        case 'BlockGroup':\n            switch (blockToDelete.blockGroupType) {\n                case 'General':\n                    if (replacement) {\n                        blocks.splice(index, 1, replacement);\n                        return true;\n                    } else {\n                        // no op, let browser handle it\n                        return false;\n                    }\n\n                case 'ListItem':\n                case 'FormatContainer':\n                    blocks.splice(index, 1);\n                    return true;\n            }\n    }\n\n    return false;\n}\n","import { deleteSingleChar } from '../../modelApi/edit/deleteSingleChar';\nimport { isWhiteSpacePreserved, normalizeSingleSegment } from 'roosterjs-content-model-dom';\nimport { normalizeText } from '../domUtils/stringUtil';\nimport type {\n    ContentModelParagraph,\n    ContentModelSegment,\n    EntityRemovalOperation,\n    FormatContentModelContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * Delete a content model segment from current selection\n * @param paragraph Parent paragraph of the segment to delete\n * @param segmentToDelete The segment to delete\n * @param context @optional Context object provided by formatContentModel API\n * @param direction @optional Whether this is deleting forward or backward. This is only used for deleting entity.\n * If not specified, only selected entity will be deleted\n */\nexport function deleteSegment(\n    paragraph: ContentModelParagraph,\n    segmentToDelete: ContentModelSegment,\n    context?: FormatContentModelContext,\n    direction?: 'forward' | 'backward'\n): boolean {\n    const segments = paragraph.segments;\n    const index = segments.indexOf(segmentToDelete);\n    const preserveWhiteSpace = isWhiteSpacePreserved(paragraph.format.whiteSpace);\n    const isForward = direction == 'forward';\n    const isBackward = direction == 'backward';\n\n    if (!preserveWhiteSpace) {\n        normalizePreviousSegment(segments, index);\n    }\n\n    switch (segmentToDelete.segmentType) {\n        case 'Br':\n        case 'Image':\n        case 'SelectionMarker':\n            segments.splice(index, 1);\n            return true;\n\n        case 'Entity':\n            const operation: EntityRemovalOperation | undefined = segmentToDelete.isSelected\n                ? 'overwrite'\n                : isForward\n                ? 'removeFromStart'\n                : isBackward\n                ? 'removeFromEnd'\n                : undefined;\n            if (operation !== undefined) {\n                segments.splice(index, 1);\n                context?.deletedEntities.push({\n                    entity: segmentToDelete,\n                    operation,\n                });\n            }\n\n            return true;\n\n        case 'Text':\n            let text = segmentToDelete.text;\n\n            if (text.length == 0 || segmentToDelete.isSelected) {\n                segments.splice(index, 1);\n            } else if (direction) {\n                text = deleteSingleChar(text, isForward); //  isForward ? text.substring(1) : text.substring(0, text.length - 1);\n\n                if (!preserveWhiteSpace) {\n                    text = normalizeText(text, isForward);\n                }\n\n                if (text == '') {\n                    segments.splice(index, 1);\n                } else {\n                    segmentToDelete.text = text;\n                }\n            }\n\n            return true;\n\n        case 'General':\n            if (segmentToDelete.isSelected) {\n                segments.splice(index, 1);\n                return true;\n            } else {\n                return false;\n            }\n    }\n}\n\nfunction normalizePreviousSegment(segments: ContentModelSegment[], currentIndex: number) {\n    let index = currentIndex - 1;\n\n    while (segments[index]?.segmentType == 'SelectionMarker') {\n        index--;\n    }\n\n    const segment = segments[index];\n\n    if (segment) {\n        normalizeSingleSegment(segment);\n    }\n}\n","import { deleteExpandedSelection } from '../../modelApi/edit/deleteExpandedSelection';\nimport type {\n    ContentModelDocument,\n    DeleteSelectionContext,\n    DeleteSelectionResult,\n    DeleteSelectionStep,\n    FormatContentModelContext,\n    ValidDeleteSelectionContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * Delete selected content from Content Model\n * @param model The model to delete selected content from\n * @param additionalSteps @optional Addition delete steps\n * @param formatContext @optional A context object provided by formatContentModel API\n * @returns A DeleteSelectionResult object to specify the deletion result\n */\nexport function deleteSelection(\n    model: ContentModelDocument,\n    additionalSteps: (DeleteSelectionStep | null)[] = [],\n    formatContext?: FormatContentModelContext\n): DeleteSelectionResult {\n    const context = deleteExpandedSelection(model, formatContext);\n\n    additionalSteps.forEach(step => {\n        if (step && isValidDeleteSelectionContext(context)) {\n            step(context);\n        }\n    });\n\n    mergeParagraphAfterDelete(context);\n    return context;\n}\n\nfunction isValidDeleteSelectionContext(\n    context: DeleteSelectionContext\n): context is ValidDeleteSelectionContext {\n    return !!context.insertPoint;\n}\n\n// If we end up with multiple paragraphs impacted, we need to merge them\nfunction mergeParagraphAfterDelete(context: DeleteSelectionContext) {\n    const { insertPoint, deleteResult, lastParagraph, lastTableContext } = context;\n\n    if (\n        insertPoint &&\n        deleteResult != 'notDeleted' &&\n        deleteResult != 'nothingToDelete' &&\n        lastParagraph &&\n        lastParagraph != insertPoint.paragraph &&\n        lastTableContext == insertPoint.tableContext\n    ) {\n        insertPoint.paragraph.segments.push(...lastParagraph.segments);\n        lastParagraph.segments = [];\n    }\n}\n","import type { DOMSelection } from 'roosterjs-content-model-types';\n\n/**\n * Get root node of a given DOM selection\n * For table selection, root node is the selected table\n * For image selection, root node is the selected image\n * For range selection, root node is the common ancestor container node of the selection range\n * @param selection The selection to get root node from\n */\nexport function getSelectionRootNode(selection: DOMSelection | undefined): Node | undefined {\n    return !selection\n        ? undefined\n        : selection.type == 'range'\n        ? selection.range.commonAncestorContainer\n        : selection.type == 'table'\n        ? selection.table\n        : selection.type == 'image'\n        ? selection.image\n        : undefined;\n}\n","import hasSelectionInBlockGroup from './hasSelectionInBlockGroup';\nimport hasSelectionInSegment from './hasSelectionInSegment';\nimport type { ContentModelBlock } from 'roosterjs-content-model-types';\n\n/**\n * Check if there is selection within the given block\n * @param block The block to check\n */\nexport default function hasSelectionInBlock(block: ContentModelBlock): boolean {\n    switch (block.blockType) {\n        case 'Paragraph':\n            return block.segments.some(hasSelectionInSegment);\n\n        case 'Table':\n            return block.rows.some(row => row.cells.some(hasSelectionInBlockGroup));\n\n        case 'BlockGroup':\n            return hasSelectionInBlockGroup(block);\n\n        case 'Divider':\n        case 'Entity':\n            return !!block.isSelected;\n\n        default:\n            return false;\n    }\n}\n","import hasSelectionInBlock from './hasSelectionInBlock';\nimport type { ContentModelBlockGroup } from 'roosterjs-content-model-types';\n\n/**\n * Check if there is selection within the given block\n * @param block The block to check\n */\nexport default function hasSelectionInBlockGroup(group: ContentModelBlockGroup): boolean {\n    if (group.blockGroupType == 'TableCell' && group.isSelected) {\n        return true;\n    }\n\n    if (group.blocks.some(hasSelectionInBlock)) {\n        return true;\n    }\n\n    return false;\n}\n","import hasSelectionInBlock from './hasSelectionInBlock';\nimport type { ContentModelSegment } from 'roosterjs-content-model-types';\n\n/**\n * Check if there is selection within the given segment\n * @param segment The segment to check\n */\nexport default function hasSelectionInSegment(segment: ContentModelSegment): boolean {\n    return (\n        segment.isSelected ||\n        (segment.segmentType == 'General' && segment.blocks.some(hasSelectionInBlock))\n    );\n}\n","import type {\n    ContentModelBlock,\n    ContentModelBlockGroup,\n    ContentModelBlockWithCache,\n    ContentModelSegment,\n    TableSelectionContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * Options for iterateSelections API\n */\nexport interface IterateSelectionsOption {\n    /**\n     * For selected table cell, this property determines how do we handle its content.\n     * include: No matter if table cell is selected, always invoke callback function for selected content (default value)\n     * ignoreForTable: When the whole table is selected we invoke callback for the table (using block parameter) but skip\n     * all its cells and content, otherwise keep invoking callback for table cell and content\n     * ignoreForTableOrCell: If whole table is selected, same with ignoreForTable, or if a table cell is selected, only\n     * invoke callback for the table cell itself but not for its content, otherwise keep invoking callback for content.\n     * @default include\n     */\n    contentUnderSelectedTableCell?: 'include' | 'ignoreForTable' | 'ignoreForTableOrCell';\n\n    /**\n     * For a selected general element, this property determines how do we handle its content.\n     * contentOnly: (Default) When the whole general element is selected, we only invoke callback for its selected content\n     * generalElementOnly: When the whole general element is selected, we only invoke callback for the general element (using block or\n     * segment parameter depends on if it is a block or segment), but skip all its content.\n     * both: When general element is selected, we invoke callback first for its content, then for general element itself\n     */\n    contentUnderSelectedGeneralElement?: 'contentOnly' | 'generalElementOnly' | 'both';\n\n    /**\n     * Whether call the callback for the list item format holder segment\n     * anySegment: call the callback if any segment is selected under a list item\n     * allSegments: call the callback only when all segments under the list item are selected\n     * never: never call the callback for list item format holder\n     * @default allSegments\n     */\n    includeListFormatHolder?: 'anySegment' | 'allSegments' | 'never';\n}\n\n/**\n * The callback function type for iterateSelections\n * @param path The block group path of current selection\n * @param tableContext Table context of current selection\n * @param block Block of current selection\n * @param segments Segments of current selection\n * @returns True to stop iterating, otherwise keep going\n */\nexport type IterateSelectionsCallback = (\n    path: ContentModelBlockGroup[],\n    tableContext?: TableSelectionContext,\n    block?: ContentModelBlock,\n    segments?: ContentModelSegment[]\n) => void | boolean;\n\n/**\n * Iterate all selected elements in a given model\n * @param group The given Content Model to iterate selection from\n * @param callback The callback function to access the selected element\n * @param option Option to determine how to iterate\n */\nexport function iterateSelections(\n    group: ContentModelBlockGroup,\n    callback: IterateSelectionsCallback,\n    option?: IterateSelectionsOption\n): void {\n    const internalCallback: IterateSelectionsCallback = (path, tableContext, block, segments) => {\n        if (!!(block as ContentModelBlockWithCache)?.cachedElement) {\n            delete (block as ContentModelBlockWithCache).cachedElement;\n        }\n\n        return callback(path, tableContext, block, segments);\n    };\n\n    internalIterateSelections([group], internalCallback, option);\n}\n\nfunction internalIterateSelections(\n    path: ContentModelBlockGroup[],\n    callback: IterateSelectionsCallback,\n    option?: IterateSelectionsOption,\n    table?: TableSelectionContext,\n    treatAllAsSelect?: boolean\n): boolean {\n    const parent = path[0];\n    const includeListFormatHolder = option?.includeListFormatHolder || 'allSegments';\n    const contentUnderSelectedTableCell = option?.contentUnderSelectedTableCell || 'include';\n    const contentUnderSelectedGeneralElement =\n        option?.contentUnderSelectedGeneralElement || 'contentOnly';\n\n    let hasSelectedSegment = false;\n    let hasUnselectedSegment = false;\n\n    for (let i = 0; i < parent.blocks.length; i++) {\n        const block = parent.blocks[i];\n\n        switch (block.blockType) {\n            case 'BlockGroup':\n                const newPath = [block, ...path];\n\n                if (block.blockGroupType == 'General') {\n                    const isSelected = treatAllAsSelect || block.isSelected;\n                    const handleGeneralContent =\n                        !isSelected ||\n                        contentUnderSelectedGeneralElement == 'both' ||\n                        contentUnderSelectedGeneralElement == 'contentOnly';\n                    const handleGeneralElement =\n                        isSelected &&\n                        (contentUnderSelectedGeneralElement == 'both' ||\n                            contentUnderSelectedGeneralElement == 'generalElementOnly' ||\n                            block.blocks.length == 0);\n\n                    if (\n                        (handleGeneralContent &&\n                            internalIterateSelections(\n                                newPath,\n                                callback,\n                                option,\n                                table,\n                                isSelected\n                            )) ||\n                        (handleGeneralElement && callback(path, table, block))\n                    ) {\n                        return true;\n                    }\n                } else if (\n                    internalIterateSelections(newPath, callback, option, table, treatAllAsSelect)\n                ) {\n                    return true;\n                }\n                break;\n\n            case 'Table':\n                const rows = block.rows;\n                const isWholeTableSelected = rows.every(row =>\n                    row.cells.every(cell => cell.isSelected)\n                );\n\n                if (contentUnderSelectedTableCell != 'include' && isWholeTableSelected) {\n                    if (callback(path, table, block)) {\n                        return true;\n                    }\n                } else {\n                    for (let rowIndex = 0; rowIndex < rows.length; rowIndex++) {\n                        const row = rows[rowIndex];\n\n                        for (let colIndex = 0; colIndex < row.cells.length; colIndex++) {\n                            const cell = row.cells[colIndex];\n                            if (!cell) {\n                                continue;\n                            }\n\n                            const newTable: TableSelectionContext = {\n                                table: block,\n                                rowIndex,\n                                colIndex,\n                                isWholeTableSelected,\n                            };\n\n                            if (cell.isSelected && callback(path, newTable)) {\n                                return true;\n                            }\n\n                            if (\n                                !cell.isSelected ||\n                                contentUnderSelectedTableCell != 'ignoreForTableOrCell'\n                            ) {\n                                const newPath = [cell, ...path];\n                                const isSelected = treatAllAsSelect || cell.isSelected;\n\n                                if (\n                                    internalIterateSelections(\n                                        newPath,\n                                        callback,\n                                        option,\n                                        newTable,\n                                        isSelected\n                                    )\n                                ) {\n                                    return true;\n                                }\n                            }\n                        }\n                    }\n                }\n\n                break;\n\n            case 'Paragraph':\n                const segments: ContentModelSegment[] = [];\n\n                for (let i = 0; i < block.segments.length; i++) {\n                    const segment = block.segments[i];\n                    const isSelected = treatAllAsSelect || segment.isSelected;\n\n                    if (segment.segmentType == 'General') {\n                        const handleGeneralContent =\n                            !isSelected ||\n                            contentUnderSelectedGeneralElement == 'both' ||\n                            contentUnderSelectedGeneralElement == 'contentOnly';\n                        const handleGeneralElement =\n                            isSelected &&\n                            (contentUnderSelectedGeneralElement == 'both' ||\n                                contentUnderSelectedGeneralElement == 'generalElementOnly' ||\n                                segment.blocks.length == 0);\n\n                        if (\n                            handleGeneralContent &&\n                            internalIterateSelections(\n                                [segment, ...path],\n                                callback,\n                                option,\n                                table,\n                                isSelected\n                            )\n                        ) {\n                            return true;\n                        }\n\n                        if (handleGeneralElement) {\n                            segments.push(segment);\n                        }\n                    } else if (isSelected) {\n                        segments.push(segment);\n                    }\n\n                    if (isSelected) {\n                        hasSelectedSegment = true;\n                    } else {\n                        hasUnselectedSegment = true;\n                    }\n                }\n\n                if (segments.length > 0 && callback(path, table, block, segments)) {\n                    return true;\n                }\n                break;\n\n            case 'Divider':\n            case 'Entity':\n                if ((treatAllAsSelect || block.isSelected) && callback(path, table, block)) {\n                    return true;\n                }\n\n                break;\n        }\n    }\n\n    if (\n        includeListFormatHolder != 'never' &&\n        parent.blockGroupType == 'ListItem' &&\n        hasSelectedSegment &&\n        (!hasUnselectedSegment || includeListFormatHolder == 'anySegment') &&\n        // When whole list item is selected, also add its format holder as selected segment\n        callback(path, table, undefined /*block*/, [parent.formatHolder])\n    ) {\n        return true;\n    }\n\n    return false;\n}\n","import { isGeneralSegment } from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelBlock,\n    ContentModelBlockGroup,\n    ContentModelSegment,\n    ContentModelTable,\n    Selectable,\n} from 'roosterjs-content-model-types';\n\n/**\n * Set selection into Content Model. If the Content Model already has selection, existing selection will be overwritten by the new one.\n * @param group The root level group of Content Model\n * @param start The start selected element. If not passed, existing selection of content model will be cleared\n * @param end The end selected element. If not passed, only the start element will be selected. If passed, all elements between start and end elements will be selected\n */\nexport function setSelection(group: ContentModelBlockGroup, start?: Selectable, end?: Selectable) {\n    setSelectionToBlockGroup(group, false /*isInSelection*/, start || null, end || null);\n}\n\nfunction setSelectionToBlockGroup(\n    group: ContentModelBlockGroup,\n    isInSelection: boolean,\n    start: Selectable | null,\n    end: Selectable | null\n): boolean {\n    return handleSelection(isInSelection, group, start, end, isInSelection => {\n        if (isGeneralSegment(group)) {\n            setIsSelected(group, isInSelection);\n        }\n\n        group.blocks.forEach(block => {\n            isInSelection = setSelectionToBlock(block, isInSelection, start, end);\n        });\n\n        return isInSelection;\n    });\n}\n\nfunction setSelectionToBlock(\n    block: ContentModelBlock,\n    isInSelection: boolean,\n    start: Selectable | null,\n    end: Selectable | null\n) {\n    switch (block.blockType) {\n        case 'BlockGroup':\n            return setSelectionToBlockGroup(block, isInSelection, start, end);\n\n        case 'Table':\n            return setSelectionToTable(block, isInSelection, start, end);\n\n        case 'Divider':\n        case 'Entity':\n            return handleSelection(isInSelection, block, start, end, isInSelection => {\n                if (isInSelection) {\n                    block.isSelected = true;\n                } else {\n                    delete block.isSelected;\n                }\n\n                return isInSelection;\n            });\n\n        case 'Paragraph':\n            const segmentsToDelete: number[] = [];\n\n            block.segments.forEach((segment, i) => {\n                isInSelection = handleSelection(\n                    isInSelection,\n                    segment,\n                    start,\n                    end,\n                    isInSelection => {\n                        return setSelectionToSegment(\n                            segment,\n                            isInSelection,\n                            segmentsToDelete,\n                            start,\n                            end,\n                            i\n                        );\n                    }\n                );\n            });\n\n            while (segmentsToDelete.length > 0) {\n                const index = segmentsToDelete.pop()!;\n\n                if (index >= 0) {\n                    block.segments.splice(index, 1);\n                }\n            }\n\n            return isInSelection;\n\n        default:\n            return isInSelection;\n    }\n}\n\nfunction setSelectionToTable(\n    table: ContentModelTable,\n    isInSelection: boolean,\n    start: Selectable | null,\n    end: Selectable | null\n): boolean {\n    const first = findCell(table, start);\n    const last = end ? findCell(table, end) : first;\n\n    if (!isInSelection) {\n        for (let row = 0; row < table.rows.length; row++) {\n            const currentRow = table.rows[row];\n            for (let col = 0; col < currentRow.cells.length; col++) {\n                const currentCell = table.rows[row].cells[col];\n                const isSelected =\n                    row >= first.row && row <= last.row && col >= first.col && col <= last.col;\n\n                setIsSelected(currentCell, isSelected);\n\n                if (!isSelected) {\n                    setSelectionToBlockGroup(currentCell, false /*isInSelection*/, start, end);\n                }\n            }\n        }\n    } else {\n        table.rows.forEach(row =>\n            row.cells.forEach(cell => {\n                isInSelection = setSelectionToBlockGroup(cell, isInSelection, start, end);\n            })\n        );\n    }\n\n    return isInSelection;\n}\n\nfunction findCell(table: ContentModelTable, cell: Selectable | null): { row: number; col: number } {\n    let col = -1;\n    const row = cell\n        ? table.rows.findIndex(row => (col = (row.cells as Selectable[]).indexOf(cell)) >= 0)\n        : -1;\n\n    return { row, col };\n}\n\nfunction setSelectionToSegment(\n    segment: ContentModelSegment,\n    isInSelection: boolean,\n    segmentsToDelete: number[],\n    start: Selectable | null,\n    end: Selectable | null,\n    i: number\n) {\n    switch (segment.segmentType) {\n        case 'SelectionMarker':\n            if (!isInSelection || (segment != start && segment != end)) {\n                // Delete the selection marker when\n                // 1. It is not in selection any more. Or\n                // 2. It is in middle of selection, so no need to have it\n                segmentsToDelete.push(i);\n            }\n            return isInSelection;\n\n        case 'General':\n            setIsSelected(segment, isInSelection);\n\n            return segment != start && segment != end\n                ? setSelectionToBlockGroup(segment, isInSelection, start, end)\n                : isInSelection;\n\n        case 'Image':\n            setIsSelected(segment, isInSelection);\n            segment.isSelectedAsImageSelection = start == segment && (!end || end == segment);\n            return isInSelection;\n        default:\n            setIsSelected(segment, isInSelection);\n            return isInSelection;\n    }\n}\n\nfunction setIsSelected(selectable: Selectable, value: boolean) {\n    if (value) {\n        selectable.isSelected = true;\n    } else {\n        delete selectable.isSelected;\n    }\n\n    return value;\n}\n\nfunction handleSelection(\n    isInSelection: boolean,\n    model: ContentModelBlockGroup | ContentModelBlock | ContentModelSegment,\n    start: Selectable | null,\n    end: Selectable | null,\n    callback: (isInSelection: boolean) => boolean\n) {\n    isInSelection = isInSelection || model == start;\n    isInSelection = callback(isInSelection);\n    return isInSelection && !!end && model != end;\n}\n","import { BorderKeys } from 'roosterjs-content-model-dom';\nimport { combineBorderValue, extractBorderValues } from '../domUtils/borderValues';\nimport { setTableCellBackgroundColor } from './setTableCellBackgroundColor';\nimport { TableBorderFormat } from '../../constants/TableBorderFormat';\nimport { updateTableCellMetadata } from '../../metadata/updateTableCellMetadata';\nimport { updateTableMetadata } from '../../metadata/updateTableMetadata';\nimport type {\n    BorderFormat,\n    ContentModelTable,\n    ContentModelTableRow,\n    TableMetadataFormat,\n} from 'roosterjs-content-model-types';\n\nconst DEFAULT_FORMAT: Required<TableMetadataFormat> = {\n    topBorderColor: '#ABABAB',\n    bottomBorderColor: '#ABABAB',\n    verticalBorderColor: '#ABABAB',\n    hasHeaderRow: false,\n    hasFirstColumn: false,\n    hasBandedRows: false,\n    hasBandedColumns: false,\n    bgColorEven: null,\n    bgColorOdd: '#ABABAB20',\n    headerRowColor: '#ABABAB',\n    tableBorderFormat: TableBorderFormat.Default,\n    verticalAlign: null,\n};\n\ntype MetaOverrides = {\n    bgColorOverrides: boolean[][];\n    vAlignOverrides: boolean[][];\n    borderOverrides: boolean[][];\n};\n\n/**\n * Apply table format from table metadata and the passed in new format\n * @param table The table to apply format to\n * @param newFormat @optional New format to apply. When passed, this value will be merged into existing metadata format and default format\n * @param keepCellShade @optional When pass true, table cells with customized shade color will not be overwritten. @default false\n */\nexport function applyTableFormat(\n    table: ContentModelTable,\n    newFormat?: TableMetadataFormat,\n    keepCellShade?: boolean\n) {\n    const { rows } = table;\n\n    updateTableMetadata(table, format => {\n        const effectiveMetadata = {\n            ...DEFAULT_FORMAT,\n            ...format,\n            ...(newFormat || {}),\n        };\n\n        const metaOverrides: MetaOverrides = updateOverrides(rows, !keepCellShade);\n\n        delete table.cachedElement;\n\n        clearCache(rows);\n        formatCells(rows, effectiveMetadata, metaOverrides);\n        setFirstColumnFormat(rows, effectiveMetadata, metaOverrides);\n        setHeaderRowFormat(rows, effectiveMetadata, metaOverrides);\n        return effectiveMetadata;\n    });\n}\n\nfunction clearCache(rows: ContentModelTableRow[]) {\n    rows.forEach(row => {\n        row.cells.forEach(cell => {\n            delete cell.cachedElement;\n        });\n\n        delete row.cachedElement;\n    });\n}\n\nfunction updateOverrides(rows: ContentModelTableRow[], removeCellShade: boolean): MetaOverrides {\n    const overrides: MetaOverrides = {\n        bgColorOverrides: [],\n        vAlignOverrides: [],\n        borderOverrides: [],\n    };\n\n    rows.forEach(row => {\n        const bgColorOverrides: boolean[] = [];\n        const vAlignOverrides: boolean[] = [];\n        const borderOverrides: boolean[] = [];\n\n        overrides.bgColorOverrides.push(bgColorOverrides);\n        overrides.vAlignOverrides.push(vAlignOverrides);\n        overrides.borderOverrides.push(borderOverrides);\n\n        row.cells.forEach(cell => {\n            updateTableCellMetadata(cell, metadata => {\n                if (metadata && removeCellShade) {\n                    bgColorOverrides.push(false);\n                    delete metadata.bgColorOverride;\n                } else {\n                    bgColorOverrides.push(!!metadata?.bgColorOverride);\n                }\n                vAlignOverrides.push(!!metadata?.vAlignOverride);\n                borderOverrides.push(!!metadata?.borderOverride);\n\n                return metadata;\n            });\n        });\n    });\n\n    return overrides;\n}\n\ntype ShouldUseTransparentBorder = (indexProp: {\n    firstRow: boolean;\n    lastRow: boolean;\n    firstColumn: boolean;\n    lastColumn: boolean;\n}) => [boolean, boolean, boolean, boolean];\n\nconst BorderFormatters: Record<number, ShouldUseTransparentBorder | undefined> = {\n    [TableBorderFormat.Default]: _ => [false, false, false, false],\n    [TableBorderFormat.ListWithSideBorders]: ({ lastColumn, firstColumn }) => [\n        false,\n        !lastColumn,\n        false,\n        !firstColumn,\n    ],\n    [TableBorderFormat.FirstColumnHeaderExternal]: ({\n        firstColumn,\n        firstRow,\n        lastColumn,\n        lastRow,\n    }) => [\n        !firstRow,\n        (!lastColumn && !firstColumn) || (firstColumn && firstRow),\n        !lastRow && !firstRow,\n        !firstColumn,\n    ],\n    [TableBorderFormat.NoHeaderBorders]: ({ firstRow, firstColumn, lastColumn }) => [\n        firstRow,\n        firstRow || lastColumn,\n        false,\n        firstRow || firstColumn,\n    ],\n    [TableBorderFormat.NoSideBorders]: ({ firstColumn, lastColumn }) => [\n        false,\n        lastColumn,\n        false,\n        firstColumn,\n    ],\n    [TableBorderFormat.EspecialType1]: ({ firstRow, firstColumn }) => [\n        firstColumn && !firstRow,\n        firstRow,\n        firstColumn && !firstRow,\n        firstRow && !firstColumn,\n    ],\n    [TableBorderFormat.EspecialType2]: ({ firstRow, firstColumn }) => [\n        !firstRow,\n        firstRow || !firstColumn,\n        !firstRow,\n        !firstColumn,\n    ],\n    [TableBorderFormat.EspecialType3]: ({ firstColumn, firstRow }) => [\n        true,\n        firstRow || !firstColumn,\n        !firstRow,\n        true,\n    ],\n    [TableBorderFormat.Clear]: () => [true, true, true, true],\n};\n\n/*\n * Apply vertical align, borders, and background color to all cells in the table\n */\nfunction formatCells(\n    rows: ContentModelTableRow[],\n    format: TableMetadataFormat,\n    metaOverrides: MetaOverrides\n) {\n    const { hasBandedRows, hasBandedColumns, bgColorOdd, bgColorEven } = format;\n\n    rows.forEach((row, rowIndex) => {\n        row.cells.forEach((cell, colIndex) => {\n            // Format Borders\n            if (\n                !metaOverrides.borderOverrides[rowIndex][colIndex] &&\n                typeof format.tableBorderFormat == 'number'\n            ) {\n                const transparentBorderMatrix = BorderFormatters[format.tableBorderFormat]?.({\n                    firstRow: rowIndex === 0,\n                    lastRow: rowIndex === rows.length - 1,\n                    firstColumn: colIndex === 0,\n                    lastColumn: colIndex === row.cells.length - 1,\n                });\n\n                const formatColor = [\n                    format.topBorderColor,\n                    format.verticalBorderColor,\n                    format.bottomBorderColor,\n                    format.verticalBorderColor,\n                ];\n\n                transparentBorderMatrix?.forEach((alwaysUseTransparent, i) => {\n                    const borderColor = (!alwaysUseTransparent && formatColor[i]) || '';\n\n                    cell.format[BorderKeys[i]] = combineBorderValue({\n                        style: getBorderStyleFromColor(borderColor),\n                        width: '1px',\n                        color: borderColor,\n                    });\n                });\n            }\n\n            // Format Background Color\n            if (!metaOverrides.bgColorOverrides[rowIndex][colIndex]) {\n                const color =\n                    hasBandedRows || hasBandedColumns\n                        ? (hasBandedColumns && colIndex % 2 != 0) ||\n                          (hasBandedRows && rowIndex % 2 != 0)\n                            ? bgColorOdd\n                            : bgColorEven\n                        : bgColorEven; /* bgColorEven is the default color */\n\n                setTableCellBackgroundColor(\n                    cell,\n                    color,\n                    false /*isColorOverride*/,\n                    true /*applyToSegments*/\n                );\n            }\n\n            // Format Vertical Align\n            if (format.verticalAlign && !metaOverrides.vAlignOverrides[rowIndex][colIndex]) {\n                cell.format.verticalAlign = format.verticalAlign;\n            }\n        });\n    });\n}\n\nfunction setFirstColumnFormat(\n    rows: ContentModelTableRow[],\n    format: Partial<TableMetadataFormat>,\n    metaOverrides: MetaOverrides\n) {\n    rows.forEach((row, rowIndex) => {\n        row.cells.forEach((cell, cellIndex) => {\n            if (format.hasFirstColumn && cellIndex === 0) {\n                cell.isHeader = true;\n\n                if (rowIndex !== 0 && !metaOverrides.bgColorOverrides[rowIndex][cellIndex]) {\n                    setBorderColor(cell.format, 'borderTop');\n                    setTableCellBackgroundColor(\n                        cell,\n                        null /*color*/,\n                        false /*isColorOverride*/,\n                        true /*applyToSegments*/\n                    );\n                }\n\n                if (rowIndex !== rows.length - 1 && rowIndex !== 0) {\n                    setBorderColor(cell.format, 'borderBottom');\n                }\n            } else {\n                cell.isHeader = false;\n            }\n        });\n    });\n}\n\nfunction setHeaderRowFormat(\n    rows: ContentModelTableRow[],\n    format: TableMetadataFormat,\n    metaOverrides: MetaOverrides\n) {\n    const rowIndex = 0;\n\n    rows[rowIndex]?.cells.forEach((cell, cellIndex) => {\n        cell.isHeader = format.hasHeaderRow;\n\n        if (format.hasHeaderRow && format.headerRowColor) {\n            if (!metaOverrides.bgColorOverrides[rowIndex][cellIndex]) {\n                setTableCellBackgroundColor(\n                    cell,\n                    format.headerRowColor,\n                    false /*isColorOverride*/,\n                    true /*applyToSegments*/\n                );\n            }\n\n            setBorderColor(cell.format, 'borderTop', format.headerRowColor);\n            setBorderColor(cell.format, 'borderRight', format.headerRowColor);\n            setBorderColor(cell.format, 'borderLeft', format.headerRowColor);\n        }\n    });\n}\n\nfunction setBorderColor(format: BorderFormat, key: keyof BorderFormat, value?: string) {\n    const border = extractBorderValues(format[key]);\n    border.color = value || '';\n    border.style = getBorderStyleFromColor(border.color);\n    format[key] = combineBorderValue(border);\n}\n\nfunction getBorderStyleFromColor(color?: string): string {\n    return !color || color == 'transparent' ? 'none' : 'solid';\n}\n","import hasSelectionInBlockGroup from '../selection/hasSelectionInBlockGroup';\nimport type { ContentModelTable, TableSelectionCoordinates } from 'roosterjs-content-model-types';\n\n/**\n * Get selection coordinates of a table. If there is no selection, return null\n * @param table The table model to get selection from\n */\nexport function getSelectedCells(table: ContentModelTable): TableSelectionCoordinates | null {\n    let firstRow = -1;\n    let firstColumn = -1;\n    let lastRow = -1;\n    let lastColumn = -1;\n    let hasSelection = false;\n\n    table.rows.forEach((row, rowIndex) =>\n        row.cells.forEach((cell, colIndex) => {\n            if (hasSelectionInBlockGroup(cell)) {\n                hasSelection = true;\n\n                if (firstRow < 0) {\n                    firstRow = rowIndex;\n                }\n\n                if (firstColumn < 0) {\n                    firstColumn = colIndex;\n                }\n\n                lastRow = Math.max(lastRow, rowIndex);\n                lastColumn = Math.max(lastColumn, colIndex);\n            }\n        })\n    );\n\n    return hasSelection ? { firstRow, firstColumn, lastRow, lastColumn } : null;\n}\n","import { addBlock, addSegment, createBr, createParagraph } from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelSegment,\n    ContentModelSegmentFormat,\n    ContentModelTable,\n    ContentModelTableCell,\n} from 'roosterjs-content-model-types';\n\n/**\n * Minimum width for a table cell\n */\nexport const MIN_ALLOWED_TABLE_CELL_WIDTH: number = 30;\nconst MIN_HEIGHT = 22;\n\n/**\n * Normalize a Content Model table, make sure:\n * 1. Fist cells are not spanned\n * 2. Inner cells are not header\n * 3. All cells have content and width\n * 4. Table and table row have correct width/height\n * 5. Spanned cell has no child blocks\n * 6. default format is correctly applied\n * @param table The table to normalize\n * @param defaultSegmentFormat @optional Default segment format to apply to cell\n */\nexport function normalizeTable(\n    table: ContentModelTable,\n    defaultSegmentFormat?: ContentModelSegmentFormat\n) {\n    // Always collapse border and use border box for table in roosterjs to make layout simpler\n    const format = table.format;\n\n    if (!format.borderCollapse || !format.useBorderBox) {\n        format.borderCollapse = true;\n        format.useBorderBox = true;\n    }\n\n    // Make sure all first cells are not spanned\n    // Make sure all inner cells are not header\n    // Make sure all cells have content and width\n    table.rows.forEach((row, rowIndex) => {\n        row.cells.forEach((cell, colIndex) => {\n            if (cell.blocks.length == 0) {\n                const format = cell.format.textColor\n                    ? {\n                          ...defaultSegmentFormat,\n                          textColor: cell.format.textColor,\n                      }\n                    : defaultSegmentFormat;\n                addBlock(\n                    cell,\n                    createParagraph(undefined /*isImplicit*/, undefined /*blockFormat*/, format)\n                );\n                addSegment(cell, createBr(format));\n            }\n\n            if (rowIndex == 0) {\n                cell.spanAbove = false;\n            } else if (rowIndex > 0 && cell.isHeader) {\n                cell.isHeader = false;\n                delete cell.cachedElement;\n            }\n\n            if (colIndex == 0) {\n                cell.spanLeft = false;\n            }\n\n            cell.format.useBorderBox = true;\n        });\n\n        // Make sure table has correct width and height array\n        if (row.height < MIN_HEIGHT) {\n            row.height = MIN_HEIGHT;\n        }\n    });\n\n    const columns = Math.max(...table.rows.map(row => row.cells.length));\n\n    for (let i = 0; i < columns; i++) {\n        if (table.widths[i] === undefined) {\n            table.widths[i] = getTableCellWidth(columns);\n        } else if (table.widths[i] < MIN_ALLOWED_TABLE_CELL_WIDTH) {\n            table.widths[i] = MIN_ALLOWED_TABLE_CELL_WIDTH;\n        }\n    }\n\n    // Move blocks from spanned cell to its main cell if any,\n    // and remove rows/columns if all cells in it are spanned\n    const colCount = table.rows[0]?.cells.length || 0;\n\n    for (let colIndex = colCount - 1; colIndex > 0; colIndex--) {\n        table.rows.forEach(row => {\n            const cell = row.cells[colIndex];\n            const leftCell = row.cells[colIndex - 1];\n            if (cell && leftCell && cell.spanLeft) {\n                tryMoveBlocks(leftCell, cell);\n            }\n        });\n\n        if (table.rows.every(row => row.cells[colIndex]?.spanLeft)) {\n            table.rows.forEach(row => row.cells.splice(colIndex, 1));\n            table.widths.splice(\n                colIndex - 1,\n                2,\n                table.widths[colIndex - 1] + table.widths[colIndex]\n            );\n        }\n    }\n\n    for (let rowIndex = table.rows.length - 1; rowIndex > 0; rowIndex--) {\n        const row = table.rows[rowIndex];\n\n        row.cells.forEach((cell, colIndex) => {\n            const aboveCell = table.rows[rowIndex - 1]?.cells[colIndex];\n            if (aboveCell && cell.spanAbove) {\n                tryMoveBlocks(aboveCell, cell);\n            }\n        });\n\n        if (row.cells.every(cell => cell.spanAbove)) {\n            table.rows[rowIndex - 1].height += row.height;\n            table.rows.splice(rowIndex, 1);\n        }\n    }\n}\n\nfunction getTableCellWidth(columns: number): number {\n    if (columns <= 4) {\n        return 120;\n    } else if (columns <= 6) {\n        return 100;\n    } else {\n        return 70;\n    }\n}\n\nfunction tryMoveBlocks(targetCell: ContentModelTableCell, sourceCell: ContentModelTableCell) {\n    const onlyHasEmptyOrBr = sourceCell.blocks.every(\n        block => block.blockType == 'Paragraph' && hasOnlyBrSegment(block.segments)\n    );\n\n    if (!onlyHasEmptyOrBr) {\n        targetCell.blocks.push(...sourceCell.blocks);\n        sourceCell.blocks = [];\n    }\n}\n\nfunction hasOnlyBrSegment(segments: ContentModelSegment[]): boolean {\n    segments = segments.filter(s => s.segmentType != 'SelectionMarker');\n\n    return segments.length == 0 || (segments.length == 1 && segments[0].segmentType == 'Br');\n}\n","import { parseColor } from 'roosterjs-content-model-dom';\nimport { updateTableCellMetadata } from '../../metadata/updateTableCellMetadata';\nimport type { ContentModelTableCell } from 'roosterjs-content-model-types';\n\n// Using the HSL (hue, saturation and lightness) representation for RGB color values.\n// If the value of the lightness is less than 20, the color is dark.\n// If the value of the lightness is more than 80, the color is bright\nconst DARK_COLORS_LIGHTNESS = 20;\nconst BRIGHT_COLORS_LIGHTNESS = 80;\nconst White = '#ffffff';\nconst Black = '#000000';\n\n/**\n * Set shade color of table cell\n * @param cell The cell to set shade color to\n * @param color The color to set\n * @param isColorOverride @optional When pass true, it means this shade color is not part of table format, so it can be preserved when apply table format\n * @param applyToSegments @optional When pass true, we will also apply text color from table cell to its child blocks and segments\n */\nexport function setTableCellBackgroundColor(\n    cell: ContentModelTableCell,\n    color: string | null | undefined,\n    isColorOverride?: boolean,\n    applyToSegments?: boolean\n) {\n    if (color) {\n        cell.format.backgroundColor = color;\n\n        if (isColorOverride) {\n            updateTableCellMetadata(cell, metadata => {\n                metadata = metadata || {};\n                metadata.bgColorOverride = true;\n                return metadata;\n            });\n        }\n\n        const lightness = calculateLightness(color);\n\n        if (lightness < DARK_COLORS_LIGHTNESS) {\n            cell.format.textColor = White;\n        } else if (lightness > BRIGHT_COLORS_LIGHTNESS) {\n            cell.format.textColor = Black;\n        } else {\n            delete cell.format.textColor;\n        }\n\n        if (applyToSegments) {\n            setAdaptiveCellColor(cell);\n        }\n    } else {\n        delete cell.format.backgroundColor;\n        delete cell.format.textColor;\n        if (applyToSegments) {\n            removeAdaptiveCellColor(cell);\n        }\n    }\n\n    delete cell.cachedElement;\n}\n\nfunction removeAdaptiveCellColor(cell: ContentModelTableCell) {\n    cell.blocks.forEach(block => {\n        if (block.blockType == 'Paragraph') {\n            if (\n                block.segmentFormat?.textColor &&\n                shouldRemoveColor(block.segmentFormat?.textColor, cell.format.backgroundColor || '')\n            ) {\n                delete block.segmentFormat.textColor;\n            }\n            block.segments.forEach(segment => {\n                if (\n                    segment.format.textColor &&\n                    shouldRemoveColor(segment.format.textColor, cell.format.backgroundColor || '')\n                ) {\n                    delete segment.format.textColor;\n                }\n            });\n        }\n    });\n}\n\nfunction setAdaptiveCellColor(cell: ContentModelTableCell) {\n    if (cell.format.textColor) {\n        cell.blocks.forEach(block => {\n            if (block.blockType == 'Paragraph') {\n                if (!block.segmentFormat?.textColor) {\n                    block.segmentFormat = {\n                        ...block.segmentFormat,\n                        textColor: cell.format.textColor,\n                    };\n                }\n                block.segments.forEach(segment => {\n                    if (!segment.format?.textColor) {\n                        segment.format = {\n                            ...segment.format,\n                            textColor: cell.format.textColor,\n                        };\n                    }\n                });\n            }\n        });\n    }\n}\n\n/**\n * If the cell background color is too dark or too bright, and the text color is white or black, we should remove the text color\n * @param textColor the segment or block text color\n * @param cellBackgroundColor the cell background color\n * @returns\n */\nfunction shouldRemoveColor(textColor: string, cellBackgroundColor: string) {\n    const lightness = calculateLightness(cellBackgroundColor);\n    if (\n        ([White, 'rgb(255,255,255)'].indexOf(textColor) > -1 &&\n            (lightness > BRIGHT_COLORS_LIGHTNESS || cellBackgroundColor == '')) ||\n        ([Black, 'rgb(0,0,0)'].indexOf(textColor) > -1 &&\n            (lightness < DARK_COLORS_LIGHTNESS || cellBackgroundColor == ''))\n    ) {\n        return true;\n    }\n    return false;\n}\n\nfunction calculateLightness(color: string) {\n    const colorValues = parseColor(color);\n\n    // Use the values of r,g,b to calculate the lightness in the HSl representation\n    //First calculate the fraction of the light in each color, since in css the value of r,g,b is in the interval of [0,255], we have\n    if (colorValues) {\n        const red = colorValues[0] / 255;\n        const green = colorValues[1] / 255;\n        const blue = colorValues[2] / 255;\n\n        //Then the lightness in the HSL representation is the average between maximum fraction of r,g,b and the minimum fraction\n        return (Math.max(red, green, blue) + Math.min(red, green, blue)) * 50;\n    } else {\n        return 255;\n    }\n}\n","import type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Redo to next undo snapshot\n * @param editor The editor to undo with\n */\nexport function redo(editor: IEditor): void {\n    editor.focus();\n\n    const manager = editor.getSnapshotsManager();\n    const snapshot = manager.move(1);\n\n    if (snapshot) {\n        editor.restoreSnapshot(snapshot);\n    }\n}\n","import type { IEditor } from 'roosterjs-content-model-types';\n\n/**\n * Undo to last undo snapshot\n * @param editor The editor to undo with\n */\nexport function undo(editor: IEditor): void {\n    editor.focus();\n\n    const manager = editor.getSnapshotsManager();\n\n    if (manager.hasNewContent) {\n        editor.takeSnapshot();\n    }\n\n    const snapshot = manager.move(-1);\n\n    if (snapshot) {\n        editor.restoreSnapshot(snapshot);\n    }\n}\n","import { toArray } from 'roosterjs-content-model-dom';\n\n/**\n * @internal\n */\nexport interface CssRule {\n    selectors: string[];\n    text: string;\n}\n\n/**\n * @internal\n */\nexport function retrieveCssRules(doc: Document): CssRule[] {\n    const styles = toArray(doc.querySelectorAll('style'));\n    const result: CssRule[] = [];\n\n    styles.forEach(styleNode => {\n        const sheet = styleNode.sheet as CSSStyleSheet;\n\n        for (let ruleIndex = 0; ruleIndex < sheet.cssRules.length; ruleIndex++) {\n            const rule = sheet.cssRules[ruleIndex] as CSSStyleRule;\n\n            if (rule.type == CSSRule.STYLE_RULE && rule.selectorText) {\n                result.push({\n                    selectors: rule.selectorText.split(','),\n                    text: rule.style.cssText,\n                });\n            }\n        }\n\n        styleNode.parentNode?.removeChild(styleNode);\n    });\n\n    return result;\n}\n\n/**\n * @internal\n */\nexport function convertInlineCss(root: ParentNode, cssRules: CssRule[]) {\n    for (let i = cssRules.length - 1; i >= 0; i--) {\n        const { selectors, text } = cssRules[i];\n\n        for (const selector of selectors) {\n            if (!selector || !selector.trim() || selector.indexOf(':') >= 0) {\n                continue;\n            }\n\n            const nodes = toArray(root.querySelectorAll(selector));\n\n            // Always put existing styles after so that they have higher priority\n            // Which means if both global style and inline style apply to the same element,\n            // inline style will have higher priority\n            nodes.forEach(node =>\n                node.setAttribute('style', text + (node.getAttribute('style') || ''))\n            );\n        }\n    }\n}\n","import { containerSizeFormatParser } from '../override/containerSizeFormatParser';\nimport { createDomToModelContext } from 'roosterjs-content-model-dom';\nimport { createPasteEntityProcessor } from '../override/pasteEntityProcessor';\nimport { createPasteGeneralProcessor } from '../override/pasteGeneralProcessor';\nimport { getRootComputedStyleForContext } from './getRootComputedStyleForContext';\nimport { pasteBlockEntityParser } from '../override/pasteCopyBlockEntityParser';\nimport { pasteDisplayFormatParser } from '../override/pasteDisplayFormatParser';\nimport { pasteTextProcessor } from '../override/pasteTextProcessor';\nimport type {\n    ContentModelSegmentFormat,\n    DomToModelContext,\n    DomToModelOption,\n    DomToModelOptionForSanitizing,\n} from 'roosterjs-content-model-types';\n\nconst DefaultSanitizingOption: DomToModelOptionForSanitizing = {\n    processorOverride: {},\n    formatParserOverride: {},\n    additionalFormatParsers: {},\n    additionalAllowedTags: [],\n    additionalDisallowedTags: [],\n    styleSanitizers: {},\n    attributeSanitizers: {},\n};\n\n/**\n * @internal\n */\nexport function createDomToModelContextForSanitizing(\n    document: Document,\n    defaultFormat?: ContentModelSegmentFormat,\n    defaultOption?: DomToModelOption,\n    additionalSanitizingOption?: DomToModelOptionForSanitizing\n): DomToModelContext {\n    const sanitizingOption: DomToModelOptionForSanitizing = {\n        ...DefaultSanitizingOption,\n        ...additionalSanitizingOption,\n    };\n\n    return createDomToModelContext(\n        {\n            defaultFormat,\n            ...getRootComputedStyleForContext(document),\n        },\n        defaultOption,\n        {\n            processorOverride: {\n                '#text': pasteTextProcessor,\n                entity: createPasteEntityProcessor(sanitizingOption),\n                '*': createPasteGeneralProcessor(sanitizingOption),\n            },\n            formatParserOverride: {\n                display: pasteDisplayFormatParser,\n            },\n            additionalFormatParsers: {\n                container: [containerSizeFormatParser],\n                entity: [pasteBlockEntityParser],\n            },\n        },\n        sanitizingOption\n    );\n}\n","import { isElementOfType, isNodeOfType, moveChildNodes } from 'roosterjs-content-model-dom';\nimport type { SnapshotSelection, EditorCore } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function createSnapshotSelection(core: EditorCore): SnapshotSelection {\n    const { physicalRoot, api } = core;\n    const selection = api.getDOMSelection(core);\n\n    // Normalize tables to ensure they have TBODY element between TABLE and TR so that the selection path will include correct values\n    if (selection?.type == 'range') {\n        const { startContainer, startOffset, endContainer, endOffset } = selection.range;\n        let isDOMChanged = normalizeTableTree(startContainer, physicalRoot);\n\n        if (endContainer != startContainer) {\n            isDOMChanged = normalizeTableTree(endContainer, physicalRoot) || isDOMChanged;\n        }\n\n        if (isDOMChanged) {\n            const newRange = physicalRoot.ownerDocument.createRange();\n\n            newRange.setStart(startContainer, startOffset);\n            newRange.setEnd(endContainer, endOffset);\n            api.setDOMSelection(\n                core,\n                {\n                    type: 'range',\n                    range: newRange,\n                    isReverted: !!selection.isReverted,\n                },\n                true /*skipSelectionChangedEvent*/\n            );\n        }\n    }\n\n    switch (selection?.type) {\n        case 'image':\n            return {\n                type: 'image',\n                imageId: selection.image.id,\n            };\n\n        case 'table':\n            return {\n                type: 'table',\n                tableId: selection.table.id,\n                firstColumn: selection.firstColumn,\n                lastColumn: selection.lastColumn,\n                firstRow: selection.firstRow,\n                lastRow: selection.lastRow,\n            };\n\n        case 'range':\n            const range = selection.range;\n\n            return {\n                type: 'range',\n                start: getPath(range.startContainer, range.startOffset, physicalRoot),\n                end: getPath(range.endContainer, range.endOffset, physicalRoot),\n                isReverted: !!selection.isReverted,\n            };\n\n        default:\n            return {\n                type: 'range',\n                start: [],\n                end: [],\n                isReverted: false,\n            };\n    }\n}\n\n/**\n * Get the path of the node relative to rootNode.\n * The path of the node is an array of integer indices into the childNodes of the given node.\n *\n * The node path will be what the node path will be on a _normalized_ dom\n * (e.g. empty text nodes will be ignored and adjacent text nodes will be concatenated)\n *\n * @param rootNode the node the path will be relative to\n * @param position the position to get indexes from. Follows the same semantics\n * as selectionRange (if node is of type Text, it is an offset into the text of that node.\n * If node is of type Element, it is the index of a child in that Element node.)\n */\nfunction getPath(node: Node | null, offset: number, rootNode: Node): number[] {\n    const result: number[] = [];\n    let parent: Node | null;\n\n    if (!node || !rootNode.contains(node)) {\n        return result;\n    }\n\n    if (isNodeOfType(node, 'TEXT_NODE')) {\n        parent = node.parentNode;\n\n        while (node.previousSibling && isNodeOfType(node.previousSibling, 'TEXT_NODE')) {\n            offset += node.previousSibling.nodeValue?.length || 0;\n            node = node.previousSibling;\n        }\n\n        result.unshift(offset);\n    } else {\n        parent = node;\n        node = node.childNodes[offset];\n    }\n\n    do {\n        offset = 0;\n        let isPreviousText = false;\n\n        for (let c: Node | null = parent?.firstChild || null; c && c != node; c = c.nextSibling) {\n            if (isNodeOfType(c, 'TEXT_NODE')) {\n                if (c.nodeValue?.length === 0 || isPreviousText) {\n                    continue;\n                }\n\n                isPreviousText = true;\n            } else {\n                isPreviousText = false;\n            }\n\n            offset++;\n        }\n\n        result.unshift(offset);\n        node = parent;\n        parent = parent?.parentNode || null;\n    } while (node && node != rootNode);\n\n    return result;\n}\n\nfunction normalizeTableTree(startNode: Node, root: Node) {\n    let node: Node | null = startNode;\n    let isDOMChanged = false;\n\n    while (node && root.contains(node)) {\n        if (isNodeOfType(node, 'ELEMENT_NODE') && isElementOfType(node, 'table')) {\n            isDOMChanged = normalizeTable(node) || isDOMChanged;\n        }\n\n        node = node.parentNode;\n    }\n\n    return isDOMChanged;\n}\n\nfunction normalizeTable(table: HTMLTableElement): boolean {\n    let isDOMChanged = false;\n    let tbody: HTMLTableSectionElement | null = null;\n\n    for (let child = table.firstChild; child; child = child.nextSibling) {\n        const tag = isNodeOfType(child, 'ELEMENT_NODE') ? child.tagName : null;\n\n        switch (tag) {\n            case 'TR':\n                if (!tbody) {\n                    tbody = table.ownerDocument.createElement('tbody');\n                    table.insertBefore(tbody, child);\n                }\n\n                tbody.appendChild(child);\n                child = tbody;\n                isDOMChanged = true;\n\n                break;\n            case 'TBODY':\n                if (tbody) {\n                    moveChildNodes(tbody, child, true /*keepExistingChildren*/);\n                    child.parentNode?.removeChild(child);\n                    child = tbody;\n                    isDOMChanged = true;\n                } else {\n                    tbody = child as HTMLTableSectionElement;\n                }\n                break;\n            default:\n                tbody = null;\n                break;\n        }\n    }\n\n    const colgroups = table.querySelectorAll('colgroup');\n    const thead = table.querySelector('thead');\n\n    if (thead) {\n        colgroups.forEach(colgroup => {\n            if (!thead.contains(colgroup)) {\n                thead.appendChild(colgroup);\n            }\n        });\n    }\n\n    return isDOMChanged;\n}\n","import { readFile } from '../publicApi/domUtils/readFile';\nimport type { ClipboardData, EdgeLinkPreview } from 'roosterjs-content-model-types';\n\nconst ContentHandlers: {\n    [contentType: string]: (data: ClipboardData, value: string, type?: string) => void;\n} = {\n    ['text/html']: (data, value) => (data.rawHtml = value),\n    ['text/plain']: (data, value) => (data.text = value),\n    ['text/*']: (data, value, type?) => !!type && (data.customValues[type] = value),\n    ['text/link-preview']: tryParseLinkPreview,\n};\n\n/**\n * @internal\n * Extract clipboard items to be a ClipboardData object for IE\n * @param items The clipboard items retrieve from a DataTransfer object\n * @param allowedCustomPasteType Allowed custom content type when paste besides text/plain, text/html and images\n    Only text types are supported, and do not add \"text/\" prefix to the type values\n */\nexport function extractClipboardItems(\n    items: DataTransferItem[],\n    allowedCustomPasteType?: string[]\n): Promise<ClipboardData> {\n    const data: ClipboardData = {\n        types: [],\n        text: '',\n        image: null,\n        files: [],\n        rawHtml: null,\n        customValues: {},\n        pasteNativeEvent: true,\n    };\n\n    return Promise.all(\n        (items || []).map(item => {\n            const type = item.type;\n\n            if (type.indexOf('image/') == 0 && !data.image && item.kind == 'file') {\n                data.types.push(type);\n                data.image = item.getAsFile();\n                return new Promise<void>(resolve => {\n                    if (data.image) {\n                        readFile(data.image, dataUrl => {\n                            data.imageDataUri = dataUrl;\n                            resolve();\n                        });\n                    } else {\n                        resolve();\n                    }\n                });\n            } else if (item.kind == 'file') {\n                return new Promise<void>(resolve => {\n                    const file = item.getAsFile();\n                    if (!!file) {\n                        data.types.push(type);\n                        data.files!.push(file);\n                    }\n                    resolve();\n                });\n            } else {\n                const customType = getAllowedCustomType(type, allowedCustomPasteType);\n                const handler =\n                    ContentHandlers[type] || (customType ? ContentHandlers['text/*'] : null);\n                return new Promise<void>(resolve =>\n                    handler\n                        ? item.getAsString(value => {\n                              data.types.push(type);\n                              handler(data, value, customType);\n                              resolve();\n                          })\n                        : resolve()\n                );\n            }\n        })\n    ).then(() => data);\n}\n\nfunction tryParseLinkPreview(data: ClipboardData, value: string) {\n    try {\n        data.customValues['link-preview'] = value;\n        data.linkPreview = JSON.parse(value) as EdgeLinkPreview;\n    } catch {}\n}\n\nfunction getAllowedCustomType(type: string, allowedCustomPasteType?: string[]) {\n    const textType = type.indexOf('text/') == 0 ? type.substring('text/'.length) : null;\n    const index =\n        allowedCustomPasteType && textType ? allowedCustomPasteType.indexOf(textType) : -1;\n    return textType && index >= 0 ? textType : undefined;\n}\n","import { parseValueWithUnit } from 'roosterjs-content-model-dom';\nimport type { EditorContext } from 'roosterjs-content-model-types';\n\nconst DefaultRootFontSize = 16;\n\n/**\n * @internal\n */\nexport function getRootComputedStyleForContext(\n    document: Document\n): Pick<EditorContext, 'rootFontSize'> {\n    const rootComputedStyle = document.defaultView?.getComputedStyle(document.documentElement);\n    return { rootFontSize: parseValueWithUnit(rootComputedStyle?.fontSize) || DefaultRootFontSize };\n}\n","import { moveChildNodes, wrap } from 'roosterjs-content-model-dom';\nimport type { ClipboardData, PasteType } from 'roosterjs-content-model-types';\n\nconst NBSP_HTML = '\\u00A0';\nconst ENSP_HTML = '\\u2002';\nconst TAB_SPACES = 6;\n\n/**\n * @internal\n */\nexport function createPasteFragment(\n    document: Document,\n    clipboardData: ClipboardData,\n    pasteType: PasteType,\n    root: HTMLElement | undefined\n): DocumentFragment {\n    const { imageDataUri, text } = clipboardData;\n    const fragment = document.createDocumentFragment();\n\n    if (\n        (pasteType == 'asImage' && imageDataUri) ||\n        (pasteType != 'asPlainText' && !text && imageDataUri)\n    ) {\n        // Paste image\n        const img = document.createElement('img');\n        img.style.maxWidth = '100%';\n        img.src = imageDataUri;\n        fragment.appendChild(img);\n    } else if (pasteType != 'asPlainText' && root) {\n        moveChildNodes(fragment, root);\n    } else if (text) {\n        text.split('\\n').forEach((line, index, lines) => {\n            line = line\n                .replace(/^ /g, NBSP_HTML)\n                .replace(/ $/g, NBSP_HTML)\n                .replace(/\\r/g, '')\n                .replace(/ {2}/g, ' ' + NBSP_HTML);\n\n            if (line.includes('\\t')) {\n                line = transformTabCharacters(line);\n            }\n\n            const textNode = document.createTextNode(line);\n\n            // There are 3 scenarios:\n            // 1. Single line: Paste as it is\n            // 2. Two lines: Add <br> between the lines\n            // 3. 3 or More lines, For first and last line, paste as it is. For middle lines, wrap with DIV, and add BR if it is empty line\n            if (lines.length == 2 && index == 0) {\n                // 1 of 2 lines scenario, add BR\n                fragment.appendChild(textNode);\n                fragment.appendChild(document.createElement('br'));\n            } else if (index > 0 && index < lines.length - 1) {\n                // Middle line of >=3 lines scenario, wrap with DIV\n                fragment.appendChild(\n                    wrap(document, line == '' ? document.createElement('br') : textNode, 'div')\n                );\n            } else {\n                // All others, paste as it is\n                fragment.appendChild(textNode);\n            }\n        });\n    }\n\n    return fragment;\n}\n\n/**\n * Transform \\t characters into EN SPACE characters\n * @param input string NOT containing \\n characters\n * @example t(\"\\thello\", 2) => \"&ensp;&ensp;&ensp;&ensp;hello\"\n */\nfunction transformTabCharacters(input: string, initialOffset: number = 0) {\n    let line = input;\n    let tIndex: number;\n    while ((tIndex = line.indexOf('\\t')) != -1) {\n        const lineBefore = line.slice(0, tIndex);\n        const lineAfter = line.slice(tIndex + 1);\n        const tabCount = TAB_SPACES - ((lineBefore.length + initialOffset) % TAB_SPACES);\n        const tabStr = Array(tabCount).fill(ENSP_HTML).join('');\n        line = lineBefore + tabStr + lineAfter;\n    }\n    return line;\n}\n","import type { HtmlFromClipboard } from './retrieveHtmlInfo';\nimport type {\n    BeforePasteEvent,\n    ClipboardData,\n    DomToModelOptionForSanitizing,\n    PasteType,\n    EditorCore,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function generatePasteOptionFromPlugins(\n    core: EditorCore,\n    clipboardData: ClipboardData,\n    fragment: DocumentFragment,\n    htmlFromClipboard: HtmlFromClipboard,\n    pasteType: PasteType\n): BeforePasteEvent {\n    const domToModelOption: DomToModelOptionForSanitizing = {\n        additionalAllowedTags: [],\n        additionalDisallowedTags: [],\n        additionalFormatParsers: {},\n        formatParserOverride: {},\n        processorOverride: {},\n        styleSanitizers: {},\n        attributeSanitizers: {},\n    };\n\n    const event: BeforePasteEvent = {\n        eventType: 'beforePaste',\n        clipboardData,\n        fragment,\n        htmlBefore: htmlFromClipboard.htmlBefore ?? '',\n        htmlAfter: htmlFromClipboard.htmlAfter ?? '',\n        htmlAttributes: htmlFromClipboard.metadata,\n        pasteType: pasteType,\n        domToModelOption,\n    };\n\n    if (pasteType !== 'asPlainText') {\n        core.api.triggerEvent(core, event, true /* broadcast */);\n    }\n\n    return event;\n}\n","import { ChangeSource } from '../../constants/ChangeSource';\nimport { createDomToModelContextForSanitizing } from '../createDomToModelContextForSanitizing';\nimport { domToContentModel } from 'roosterjs-content-model-dom';\nimport { getSegmentTextFormat } from '../../publicApi/domUtils/getSegmentTextFormat';\nimport { getSelectedSegments } from '../../publicApi/selection/collectSelections';\nimport { mergeModel } from '../../publicApi/model/mergeModel';\n\nimport type { MergeModelOption } from '../../publicApi/model/mergeModel';\nimport type {\n    BeforePasteEvent,\n    ClipboardData,\n    ContentModelDocument,\n    ContentModelSegmentFormat,\n    EditorCore,\n} from 'roosterjs-content-model-types';\n\nconst EmptySegmentFormat: Required<ContentModelSegmentFormat> = {\n    backgroundColor: '',\n    fontFamily: '',\n    fontSize: '',\n    fontWeight: '',\n    italic: false,\n    letterSpacing: '',\n    lineHeight: '',\n    strikethrough: false,\n    superOrSubScriptSequence: '',\n    textColor: '',\n    underline: false,\n};\n\n/**\n * @internal\n */\nexport function mergePasteContent(\n    core: EditorCore,\n    eventResult: BeforePasteEvent,\n    clipboardData: ClipboardData\n) {\n    const { fragment, domToModelOption, customizedMerge, pasteType } = eventResult;\n\n    core.api.formatContentModel(\n        core,\n        (model, context) => {\n            const selectedSegment = getSelectedSegments(model, true /*includeFormatHolder*/)[0];\n            const domToModelContext = createDomToModelContextForSanitizing(\n                core.physicalRoot.ownerDocument,\n                undefined /*defaultFormat*/,\n                core.domToModelSettings.customized,\n                domToModelOption\n            );\n\n            domToModelContext.segmentFormat = selectedSegment\n                ? getSegmentTextFormat(selectedSegment)\n                : {};\n\n            const pasteModel = domToContentModel(fragment, domToModelContext);\n            const mergeOption: MergeModelOption = {\n                mergeFormat: pasteType == 'mergeFormat' ? 'keepSourceEmphasisFormat' : 'none',\n                mergeTable: shouldMergeTable(pasteModel),\n            };\n\n            const insertPoint = customizedMerge\n                ? customizedMerge(model, pasteModel)\n                : mergeModel(model, pasteModel, context, mergeOption);\n\n            if (insertPoint) {\n                context.newPendingFormat = {\n                    ...EmptySegmentFormat,\n                    ...model.format,\n                    ...insertPoint.marker.format,\n                };\n            }\n\n            return true;\n        },\n        {\n            changeSource: ChangeSource.Paste,\n            getChangeData: () => clipboardData,\n            apiName: 'paste',\n        }\n    );\n}\n\nfunction shouldMergeTable(pasteModel: ContentModelDocument): boolean | undefined {\n    // If model contains a table and a paragraph element after the table with a single BR segment, remove the Paragraph after the table\n    if (\n        pasteModel.blocks.length == 2 &&\n        pasteModel.blocks[0].blockType === 'Table' &&\n        pasteModel.blocks[1].blockType === 'Paragraph' &&\n        pasteModel.blocks[1].segments.length === 1 &&\n        pasteModel.blocks[1].segments[0].segmentType === 'Br'\n    ) {\n        pasteModel.blocks.splice(1);\n    }\n    // Only merge table when the document contain a single table.\n    return pasteModel.blocks.length === 1 && pasteModel.blocks[0].blockType === 'Table';\n}\n","import { isNodeOfType, toArray } from 'roosterjs-content-model-dom';\nimport { retrieveCssRules } from '../convertInlineCss';\nimport type { CssRule } from '../convertInlineCss';\nimport type { ClipboardData } from 'roosterjs-content-model-types';\n\nconst START_FRAGMENT = '<!--StartFragment-->';\nconst END_FRAGMENT = '<!--EndFragment-->';\n\n/**\n * @internal\n */\nexport interface HtmlFromClipboard {\n    metadata: Record<string, string>;\n    globalCssRules: CssRule[];\n    htmlBefore?: string;\n    htmlAfter?: string;\n}\n\n/**\n * @internal\n */\nexport function retrieveHtmlInfo(\n    doc: Document | null,\n    clipboardData: Partial<ClipboardData>\n): HtmlFromClipboard {\n    let result: HtmlFromClipboard = {\n        metadata: {},\n        globalCssRules: [],\n    };\n\n    if (doc) {\n        result = {\n            ...retrieveHtmlStrings(clipboardData),\n            globalCssRules: retrieveCssRules(doc),\n            metadata: retrieveMetadata(doc),\n        };\n\n        clipboardData.htmlFirstLevelChildTags = retrieveTopLevelTags(doc);\n    }\n\n    return result;\n}\n\nfunction retrieveTopLevelTags(doc: Document): string[] {\n    const topLevelTags: string[] = [];\n\n    for (let child = doc.body.firstChild; child; child = child.nextSibling) {\n        if (isNodeOfType(child, 'TEXT_NODE')) {\n            const trimmedString = child.nodeValue?.replace(/(\\r\\n|\\r|\\n)/gm, '').trim();\n\n            if (trimmedString) {\n                topLevelTags.push(''); // Push an empty string as tag for text node\n            }\n        } else if (isNodeOfType(child, 'ELEMENT_NODE')) {\n            topLevelTags.push(child.tagName);\n        }\n    }\n\n    return topLevelTags;\n}\n\nfunction retrieveMetadata(doc: Document): Record<string, string> {\n    const result: Record<string, string> = {};\n    const attributes = doc.querySelector('html')?.attributes;\n\n    (attributes ? toArray(attributes) : []).forEach(attr => {\n        result[attr.name] = attr.value;\n    });\n\n    toArray(doc.querySelectorAll('meta')).forEach(meta => {\n        result[meta.name] = meta.content;\n    });\n\n    return result;\n}\n\nfunction retrieveHtmlStrings(\n    clipboardData: Partial<ClipboardData>\n): {\n    htmlBefore: string;\n    htmlAfter: string;\n} {\n    const rawHtml = clipboardData.rawHtml ?? '';\n    const startIndex = rawHtml.indexOf(START_FRAGMENT);\n    const endIndex = rawHtml.lastIndexOf(END_FRAGMENT);\n    let htmlBefore = '';\n    let htmlAfter = '';\n\n    if (startIndex >= 0 && endIndex >= startIndex + START_FRAGMENT.length) {\n        htmlBefore = rawHtml.substring(0, startIndex);\n        htmlAfter = rawHtml.substring(endIndex + END_FRAGMENT.length);\n        clipboardData.html = rawHtml.substring(startIndex + START_FRAGMENT.length, endIndex);\n    } else {\n        clipboardData.html = rawHtml;\n    }\n\n    return { htmlBefore, htmlAfter };\n}\n","import { transformColor } from '../publicApi/color/transformColor';\nimport type { EditorCore, Snapshot } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function restoreSnapshotColors(core: EditorCore, snapshot: Snapshot) {\n    const isDarkMode = core.lifecycle.isDarkMode;\n\n    core.darkColorHandler.updateKnownColor(isDarkMode); // Pass no parameter to force update all colors\n\n    if (!!snapshot.isDarkMode != !!isDarkMode) {\n        transformColor(\n            core.physicalRoot,\n            false /*includeSelf*/,\n            isDarkMode ? 'lightToDark' : 'darkToLight',\n            core.darkColorHandler\n        );\n    }\n}\n","import {\n    getAllEntityWrappers,\n    isEntityElement,\n    isNodeOfType,\n    parseEntityFormat,\n    reuseCachedElement,\n} from 'roosterjs-content-model-dom';\nimport type { Snapshot, EditorCore, KnownEntityItem } from 'roosterjs-content-model-types';\n\nconst BlockEntityContainer = '_E_EBlockEntityContainer';\n\n/**\n * @internal\n */\nexport function restoreSnapshotHTML(core: EditorCore, snapshot: Snapshot) {\n    const {\n        physicalRoot,\n        entity: { entityMap },\n    } = core;\n    let refNode: Node | null = physicalRoot.firstChild;\n\n    const body = new DOMParser().parseFromString(\n        core.trustedHTMLHandler?.(snapshot.html) ?? snapshot.html,\n        'text/html'\n    ).body;\n\n    for (let currentNode = body.firstChild; currentNode; ) {\n        const next = currentNode.nextSibling;\n        const originalEntityElement = tryGetEntityElement(entityMap, currentNode);\n\n        if (originalEntityElement) {\n            refNode = reuseCachedElement(physicalRoot, originalEntityElement, refNode);\n        } else {\n            physicalRoot.insertBefore(currentNode, refNode);\n\n            if (isNodeOfType(currentNode, 'ELEMENT_NODE')) {\n                const childEntities = getAllEntityWrappers(currentNode);\n\n                childEntities.forEach(element => {\n                    const wrapper = tryGetEntityElement(entityMap, element);\n\n                    if (wrapper) {\n                        if (wrapper == refNode) {\n                            // In case the node we are moving is just the ref node,\n                            // We create a temporary clone and insert it before the refNode, the use this cloned node as refNode\n                            // Then after replaceChild(), the original refNode will be moved away\n                            const markerNode = wrapper.cloneNode();\n\n                            physicalRoot.insertBefore(markerNode, refNode);\n                            refNode = markerNode;\n                        }\n\n                        element.parentNode?.replaceChild(wrapper, element);\n                    }\n                });\n            }\n        }\n        currentNode = next;\n    }\n\n    while (refNode) {\n        const next = refNode.nextSibling;\n\n        refNode.parentNode?.removeChild(refNode);\n        refNode = next;\n    }\n}\n\nfunction tryGetEntityElement(\n    entityMap: Record<string, KnownEntityItem>,\n    node: Node\n): HTMLElement | null {\n    let result: HTMLElement | null = null;\n\n    if (isNodeOfType(node, 'ELEMENT_NODE')) {\n        if (isEntityElement(node)) {\n            const format = parseEntityFormat(node);\n\n            result = (format.id && entityMap[format.id]?.element) || null;\n        } else if (isBlockEntityContainer(node)) {\n            result = tryGetEntityFromContainer(node, entityMap);\n        }\n    }\n\n    return result;\n}\n\nfunction isBlockEntityContainer(node: HTMLElement) {\n    return node.classList.contains(BlockEntityContainer);\n}\n\nfunction tryGetEntityFromContainer(\n    element: HTMLElement,\n    entityMap: Record<string, KnownEntityItem>\n): HTMLElement | null {\n    for (let node = element.firstChild; node; node = node.nextSibling) {\n        if (isEntityElement(node) && isNodeOfType(node, 'ELEMENT_NODE')) {\n            const format = parseEntityFormat(node);\n            const parent = format.id ? entityMap[format.id]?.element.parentElement : null;\n\n            return isNodeOfType(parent, 'ELEMENT_NODE') && isBlockEntityContainer(parent)\n                ? parent\n                : null;\n        }\n    }\n\n    return null;\n}\n","import { isNodeOfType } from 'roosterjs-content-model-dom';\nimport type { DOMSelection, EditorCore, Snapshot } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function restoreSnapshotSelection(core: EditorCore, snapshot: Snapshot) {\n    const snapshotSelection = snapshot.selection;\n    const { physicalRoot } = core;\n    let domSelection: DOMSelection | null = null;\n\n    if (snapshotSelection) {\n        switch (snapshotSelection.type) {\n            case 'range':\n                const startPos = getPositionFromPath(physicalRoot, snapshotSelection.start);\n                const endPos = getPositionFromPath(physicalRoot, snapshotSelection.end);\n                const range = physicalRoot.ownerDocument.createRange();\n\n                range.setStart(startPos.node, startPos.offset);\n                range.setEnd(endPos.node, endPos.offset);\n\n                domSelection = {\n                    type: 'range',\n                    range,\n                    isReverted: snapshotSelection.isReverted,\n                };\n                break;\n            case 'table':\n                const table = physicalRoot.querySelector(\n                    '#' + snapshotSelection.tableId\n                ) as HTMLTableElement;\n\n                if (table) {\n                    domSelection = {\n                        type: 'table',\n                        table: table,\n                        firstColumn: snapshotSelection.firstColumn,\n                        firstRow: snapshotSelection.firstRow,\n                        lastColumn: snapshotSelection.lastColumn,\n                        lastRow: snapshotSelection.lastRow,\n                    };\n                }\n                break;\n            case 'image':\n                const image = physicalRoot.querySelector(\n                    '#' + snapshotSelection.imageId\n                ) as HTMLImageElement;\n\n                if (image) {\n                    domSelection = {\n                        type: 'image',\n                        image: image,\n                    };\n                }\n                break;\n        }\n    }\n\n    if (domSelection) {\n        core.api.setDOMSelection(core, domSelection);\n    }\n}\n\nfunction getPositionFromPath(node: Node, path: number[]): { node: Node; offset: number } {\n    // Iterate with a for loop to avoid mutating the passed in element path stack\n    // or needing to copy it.\n    let offset: number = 0;\n\n    for (let i = 0; i < path.length; i++) {\n        offset = path[i];\n\n        if (\n            i < path.length - 1 &&\n            node &&\n            isNodeOfType(node, 'ELEMENT_NODE') &&\n            node.childNodes.length > offset\n        ) {\n            node = node.childNodes[offset];\n        } else {\n            break;\n        }\n    }\n\n    return { node, offset };\n}\n","import { isNodeOfType } from 'roosterjs-content-model-dom';\nimport type { ValueSanitizer } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const AllowedTags: ReadonlyArray<string> = [\n    'a',\n    'abbr',\n    'address',\n    'area',\n    'article',\n    'aside',\n    'b',\n    'bdi',\n    'bdo',\n    'blockquote',\n    'body',\n    'br',\n    'button',\n    'canvas',\n    'caption',\n    'center',\n    'cite',\n    'code',\n    'col',\n    'colgroup',\n    'data',\n    'datalist',\n    'dd',\n    'del',\n    'details',\n    'dfn',\n    'dialog',\n    'dir',\n    'div',\n    'dl',\n    'dt',\n    'em',\n    'fieldset',\n    'figcaption',\n    'figure',\n    'font',\n    'footer',\n    'h1',\n    'h2',\n    'h3',\n    'h4',\n    'h5',\n    'h6',\n    'head',\n    'header',\n    'hgroup',\n    'hr',\n    'html',\n    'i',\n    'img',\n    'input',\n    'ins',\n    'kbd',\n    'label',\n    'legend',\n    'li',\n    'main',\n    'map',\n    'mark',\n    'menu',\n    'menuitem',\n    'meter',\n    'nav',\n    'ol',\n    'optgroup',\n    'option',\n    'output',\n    'p',\n    'picture',\n    'pre',\n    'progress',\n    'q',\n    'rp',\n    'rt',\n    'ruby',\n    's',\n    'samp',\n    'section',\n    'select',\n    'small',\n    'span',\n    'strike',\n    'strong',\n    'sub',\n    'summary',\n    'sup',\n    'table',\n    'tbody',\n    'td',\n    'textarea',\n    'tfoot',\n    'th',\n    'thead',\n    'time',\n    'tr',\n    'tt',\n    'u',\n    'ul',\n    'var',\n    'wbr',\n    'xmp',\n];\n\n/**\n * @internal\n */\nexport const DisallowedTags: ReadonlyArray<string> = [\n    'applet',\n    'audio',\n    'base',\n    'basefont',\n    'embed',\n    'frame',\n    'frameset',\n    'iframe',\n    'link',\n    'meta',\n    'noscript',\n    'object',\n    'param',\n    'script',\n    'slot',\n    'source',\n    'style',\n    'template',\n    'title',\n    'track',\n    'video',\n];\n\nconst VARIABLE_REGEX = /^\\s*var\\(\\s*[a-zA-Z0-9-_]+\\s*(,\\s*(.*))?\\)\\s*$/;\nconst VARIABLE_PREFIX = 'var(';\n\nconst AllowedAttributes = [\n    'accept',\n    'align',\n    'alt',\n    'checked',\n    'cite',\n    'class',\n    'color',\n    'cols',\n    'colspan',\n    'contextmenu',\n    'coords',\n    'datetime',\n    'default',\n    'dir',\n    'dirname',\n    'disabled',\n    'download',\n    'face',\n    'headers',\n    'height',\n    'hidden',\n    'high',\n    'href',\n    'hreflang',\n    'ismap',\n    'kind',\n    'label',\n    'lang',\n    'list',\n    'low',\n    'max',\n    'maxlength',\n    'media',\n    'min',\n    'multiple',\n    'open',\n    'optimum',\n    'pattern',\n    'placeholder',\n    'readonly',\n    'rel',\n    'required',\n    'reversed',\n    'rows',\n    'rowspan',\n    'scope',\n    'selected',\n    'shape',\n    'size',\n    'sizes',\n    'span',\n    'spellcheck',\n    'src',\n    'srclang',\n    'srcset',\n    'start',\n    'step',\n    'style',\n    'tabindex',\n    'target',\n    'title',\n    'translate',\n    'type',\n    'usemap',\n    'valign',\n    'value',\n    'width',\n    'wrap',\n    'bgColor',\n];\n\nconst DefaultStyleValue: { [name: string]: string } = {\n    'background-color': 'transparent',\n    'border-bottom-color': 'rgb(0, 0, 0)',\n    'border-bottom-style': 'none',\n    'border-bottom-width': '0px',\n    'border-image-outset': '0',\n    'border-image-repeat': 'stretch',\n    'border-image-slice': '100%',\n    'border-image-source': 'none',\n    'border-image-width': '1',\n    'border-left-color': 'rgb(0, 0, 0)',\n    'border-left-style': 'none',\n    'border-left-width': '0px',\n    'border-right-color': 'rgb(0, 0, 0)',\n    'border-right-style': 'none',\n    'border-right-width': '0px',\n    'border-top-color': 'rgb(0, 0, 0)',\n    'border-top-style': 'none',\n    'border-top-width': '0px',\n    'outline-color': 'transparent',\n    'outline-style': 'none',\n    'outline-width': '0px',\n    overflow: 'visible',\n    '-webkit-text-stroke-width': '0px',\n    'word-wrap': 'break-word',\n    'margin-left': '0px',\n    'margin-right': '0px',\n    padding: '0px',\n    'padding-top': '0px',\n    'padding-left': '0px',\n    'padding-right': '0px',\n    'padding-bottom': '0px',\n    border: '0px',\n    'border-top': '0px',\n    'border-left': '0px',\n    'border-right': '0px',\n    'border-bottom': '0px',\n    'vertical-align': 'baseline',\n    float: 'none',\n    'font-style': 'normal',\n    'font-variant-ligatures': 'normal',\n    'font-variant-caps': 'normal',\n    'font-weight': '400',\n    'letter-spacing': 'normal',\n    orphans: '2',\n    'text-align': 'start',\n    'text-indent': '0px',\n    'text-transform': 'none',\n    widows: '2',\n    'word-spacing': '0px',\n    'white-space': 'normal',\n};\n\n/**\n * @internal\n */\nexport function sanitizeElement(\n    element: HTMLElement,\n    allowedTags: ReadonlyArray<string>,\n    disallowedTags: ReadonlyArray<string>,\n    styleSanitizers?: Readonly<Record<string, ValueSanitizer>>,\n    attributeSanitizers?: Readonly<Record<string, ValueSanitizer>>\n): HTMLElement | null {\n    const tag = element.tagName.toLowerCase();\n    const sanitizedElement =\n        disallowedTags.indexOf(tag) >= 0\n            ? null\n            : createSanitizedElement(\n                  element.ownerDocument,\n                  allowedTags.indexOf(tag) >= 0 ? tag : 'span',\n                  element.attributes,\n                  styleSanitizers,\n                  attributeSanitizers\n              );\n\n    if (sanitizedElement) {\n        for (let child = element.firstChild; child; child = child.nextSibling) {\n            const newChild = isNodeOfType(child, 'ELEMENT_NODE')\n                ? sanitizeElement(\n                      child,\n                      allowedTags,\n                      disallowedTags,\n                      styleSanitizers,\n                      attributeSanitizers\n                  )\n                : isNodeOfType(child, 'TEXT_NODE')\n                ? child.cloneNode()\n                : null;\n\n            if (newChild) {\n                sanitizedElement?.appendChild(newChild);\n            }\n        }\n    }\n\n    return sanitizedElement;\n}\n\n/**\n * @internal\n */\nexport function createSanitizedElement(\n    doc: Document,\n    tag: string,\n    attributes: NamedNodeMap,\n    styleSanitizers?: Readonly<Record<string, ValueSanitizer>>,\n    attributeSanitizers?: Readonly<Record<string, ValueSanitizer>>\n): HTMLElement {\n    const element = doc.createElement(tag);\n\n    for (let i = 0; i < attributes.length; i++) {\n        const attribute = attributes[i];\n        const name = attribute.name.toLowerCase().trim();\n        const value = attribute.value;\n\n        const sanitizer = attributeSanitizers?.[name];\n        const newValue =\n            name == 'style'\n                ? processStyles(tag, value, styleSanitizers)\n                : typeof sanitizer == 'function'\n                ? sanitizer(value, tag)\n                : typeof sanitizer === 'boolean'\n                ? sanitizer\n                    ? value\n                    : null\n                : AllowedAttributes.indexOf(name) >= 0 || name.indexOf('data-') == 0\n                ? value\n                : null;\n\n        if (\n            newValue !== null &&\n            newValue !== undefined &&\n            !newValue.match(/s\\n*c\\n*r\\n*i\\n*p\\n*t\\n*:/i) // match script: with any NewLine inside. Browser will ignore those NewLine char and still treat it as script prefix\n        ) {\n            element.setAttribute(name, newValue);\n        }\n    }\n\n    return element;\n}\n\nfunction processStyles(\n    tagName: string,\n    value: string,\n    styleSanitizers?: Readonly<Record<string, ValueSanitizer>>\n) {\n    const pairs = value.split(';');\n    const result: string[] = [];\n\n    pairs.forEach(pair => {\n        const valueIndex = pair.indexOf(':');\n        const name = pair.slice(0, valueIndex).trim();\n        let value: string = pair.slice(valueIndex + 1).trim();\n\n        if (name && value) {\n            if (isCssVariable(value)) {\n                value = processCssVariable(value);\n            }\n\n            const sanitizer = styleSanitizers?.[name];\n            const sanitizedValue =\n                typeof sanitizer == 'function'\n                    ? sanitizer(value, tagName)\n                    : sanitizer === false\n                    ? null\n                    : value;\n\n            if (\n                !!sanitizedValue &&\n                sanitizedValue != 'inherit' &&\n                sanitizedValue != 'initial' &&\n                sanitizedValue.indexOf('expression') < 0 &&\n                !name.startsWith('-') &&\n                DefaultStyleValue[name] != sanitizedValue\n            ) {\n                result.push(`${name}:${sanitizedValue}`);\n            }\n        }\n    });\n\n    return result.join(';');\n}\n\nfunction processCssVariable(value: string): string {\n    const match = VARIABLE_REGEX.exec(value);\n    return match?.[2] || ''; // Without fallback value, we don't know what does the original value mean, so ignore it\n}\n\nfunction isCssVariable(value: string): boolean {\n    return value.indexOf(VARIABLE_PREFIX) == 0;\n}\n","import type { DefaultImplicitFormatMap } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * A map from tag name to its default implicit formats\n */\nexport const defaultContentModelFormatMap: DefaultImplicitFormatMap = {\n    a: {\n        underline: true,\n    },\n    blockquote: {\n        marginTop: '1em',\n        marginBottom: '1em',\n        marginLeft: '40px',\n        marginRight: '40px',\n    },\n    code: {\n        fontFamily: 'monospace',\n    },\n    h1: {\n        fontWeight: 'bold',\n        fontSize: '2em',\n    },\n    h2: {\n        fontWeight: 'bold',\n        fontSize: '1.5em',\n    },\n    h3: {\n        fontWeight: 'bold',\n        fontSize: '1.17em',\n    },\n    h4: {\n        fontWeight: 'bold',\n        fontSize: '1em', // Set this default value here to overwrite existing font size when change heading level\n    },\n    h5: {\n        fontWeight: 'bold',\n        fontSize: '0.83em',\n    },\n    h6: {\n        fontWeight: 'bold',\n        fontSize: '0.67em',\n    },\n    p: {\n        marginTop: '1em',\n        marginBottom: '1em',\n    },\n    pre: {\n        fontFamily: 'monospace',\n        whiteSpace: 'pre',\n        marginTop: '1em',\n        marginBottom: '1em',\n    },\n};\n","import type { DefaultStyleMap } from 'roosterjs-content-model-types';\n\nconst blockElement: Partial<CSSStyleDeclaration> = {\n    display: 'block',\n};\n\n/**\n * @internal\n */\nexport const defaultHTMLStyleMap: DefaultStyleMap = {\n    address: blockElement,\n    article: blockElement,\n    aside: blockElement,\n    b: {\n        fontWeight: 'bold',\n    },\n    blockquote: {\n        display: 'block',\n        marginTop: '1em',\n        marginBottom: '1em',\n        marginLeft: '40px',\n        marginRight: '40px',\n    },\n    br: blockElement,\n    center: {\n        display: 'block',\n        textAlign: 'center',\n    },\n    dd: blockElement,\n    div: blockElement,\n    dl: blockElement,\n    dt: blockElement,\n    em: {\n        fontStyle: 'italic',\n    },\n    fieldset: blockElement,\n    figcaption: blockElement,\n    figure: blockElement,\n    footer: blockElement,\n    form: blockElement,\n    h1: {\n        display: 'block',\n        fontWeight: 'bold',\n        fontSize: '2em',\n    },\n    h2: {\n        display: 'block',\n        fontWeight: 'bold',\n        fontSize: '1.5em',\n    },\n    h3: {\n        display: 'block',\n        fontWeight: 'bold',\n        fontSize: '1.17em',\n    },\n    h4: {\n        display: 'block',\n        fontWeight: 'bold',\n    },\n    h5: {\n        display: 'block',\n        fontWeight: 'bold',\n        fontSize: '0.83em',\n    },\n    h6: {\n        display: 'block',\n        fontWeight: 'bold',\n        fontSize: '0.67em',\n    },\n    header: blockElement,\n    hr: blockElement,\n    i: {\n        fontStyle: 'italic',\n    },\n    li: {\n        display: 'list-item',\n    },\n    main: blockElement,\n    nav: blockElement,\n    ol: { ...blockElement, paddingInlineStart: '40px' },\n    p: {\n        display: 'block',\n        marginTop: '1em',\n        marginBottom: '1em',\n    },\n    pre: {\n        display: 'block',\n        fontFamily: 'monospace',\n        whiteSpace: 'pre',\n        marginTop: '1em',\n        marginBottom: '1em',\n    },\n    s: {\n        textDecoration: 'line-through',\n    },\n    section: blockElement,\n    strike: {\n        textDecoration: 'line-through',\n    },\n    strong: {\n        fontWeight: 'bold',\n    },\n    sub: {\n        verticalAlign: 'sub',\n        fontSize: 'smaller',\n    },\n    sup: {\n        verticalAlign: 'super',\n        fontSize: 'smaller',\n    },\n    table: {\n        display: 'table',\n        boxSizing: 'border-box',\n    },\n    td: {\n        display: 'table-cell',\n    },\n    th: {\n        display: 'table-cell',\n    },\n    u: {\n        textDecoration: 'underline',\n    },\n    ul: { ...blockElement, paddingInlineStart: '40px' },\n};\n","import { defaultProcessorMap } from './defaultProcessors';\nimport { getObjectKeys } from '../../domUtils/getObjectKeys';\nimport {\n    defaultFormatKeysPerCategory,\n    defaultFormatParsers,\n} from '../../formatHandlers/defaultFormatHandlers';\nimport type {\n    ContentModelBlockFormat,\n    DomToModelContext,\n    DomToModelDecoratorContext,\n    DomToModelFormatContext,\n    DomToModelOption,\n    DomToModelSelectionContext,\n    DomToModelSettings,\n    EditorContext,\n    FormatParser,\n    FormatParsers,\n    FormatParsersPerCategory,\n    TextFormatParser,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create context object for DOM to Content Model conversion\n * @param editorContext Context of editor\n * @param options Option array to customize the DOM to Model conversion behavior\n */\nexport function createDomToModelContext(\n    editorContext?: EditorContext,\n    ...options: (DomToModelOption | undefined)[]\n): DomToModelContext {\n    return createDomToModelContextWithConfig(createDomToModelConfig(options), editorContext);\n}\n\n/**\n * Create context object for DOM to Content Model conversion with an existing configure\n * @param config A full config object to define how to convert DOM tree to Content Model\n * @param editorContext Context of editor\n */\nexport function createDomToModelContextWithConfig(\n    config: DomToModelSettings,\n    editorContext?: EditorContext\n) {\n    return Object.assign(\n        {},\n        editorContext,\n        createDomToModelSelectionContext(),\n        createDomToModelFormatContext(editorContext?.isRootRtl),\n        createDomToModelDecoratorContext(),\n        config\n    );\n}\n\nfunction createDomToModelSelectionContext(): DomToModelSelectionContext {\n    return { isInSelection: false };\n}\n\nfunction createDomToModelFormatContext(isRootRtl?: boolean): DomToModelFormatContext {\n    const blockFormat: ContentModelBlockFormat = isRootRtl ? { direction: 'rtl' } : {};\n\n    return {\n        blockFormat,\n        segmentFormat: {},\n\n        listFormat: {\n            levels: [],\n            threadItemCounts: [],\n        },\n    };\n}\n\nfunction createDomToModelDecoratorContext(): DomToModelDecoratorContext {\n    return {\n        link: {\n            format: {},\n            dataset: {},\n        },\n        code: {\n            format: {},\n        },\n        blockDecorator: {\n            format: {},\n            tagName: '',\n        },\n    };\n}\n\n/**\n * Create Dom to Content Model Config object\n * @param options All customizations of content model creation\n */\nexport function createDomToModelConfig(\n    options: (DomToModelOption | undefined)[]\n): DomToModelSettings {\n    return {\n        elementProcessors: Object.assign(\n            {},\n            defaultProcessorMap,\n            ...options.map(x => x?.processorOverride)\n        ),\n        formatParsers: buildFormatParsers(\n            options.map(x => x?.formatParserOverride),\n            options.map(x => x?.additionalFormatParsers)\n        ),\n        defaultElementProcessors: defaultProcessorMap,\n        defaultFormatParsers,\n    };\n}\n\n/**\n * @internal Export for test only\n * Build format parsers used by DOM to Content Model conversion\n * @param override\n * @param additionalParsersArray\n * @returns\n */\nexport function buildFormatParsers(\n    overrides: (Partial<FormatParsers> | undefined)[] = [],\n    additionalParsersArray: (Partial<FormatParsersPerCategory> | undefined)[] = []\n): FormatParsersPerCategory {\n    const combinedOverrides = Object.assign({}, ...overrides);\n\n    const result = getObjectKeys(defaultFormatKeysPerCategory).reduce(\n        (result, key) => {\n            const value = defaultFormatKeysPerCategory[key]\n                .map(\n                    formatKey =>\n                        (combinedOverrides[formatKey] === undefined\n                            ? defaultFormatParsers[formatKey]\n                            : combinedOverrides[formatKey]) as FormatParser<any>\n                )\n                .concat(\n                    ...additionalParsersArray.map(\n                        parsers => (parsers?.[key] ?? []) as FormatParser<any>[]\n                    )\n                );\n\n            result[key] = value;\n\n            return result;\n        },\n        {\n            text: [] as TextFormatParser[],\n        } as FormatParsersPerCategory\n    );\n\n    additionalParsersArray.forEach(parsers => {\n        if (parsers?.text) {\n            result.text = result.text.concat(parsers.text);\n        }\n    });\n\n    return result;\n}\n","import { brProcessor } from '../processors/brProcessor';\nimport { childProcessor } from '../processors/childProcessor';\nimport { codeProcessor } from '../processors/codeProcessor';\nimport { delimiterProcessor } from '../processors/delimiterProcessor';\nimport { elementProcessor } from '../processors/elementProcessor';\nimport { entityProcessor } from '../processors/entityProcessor';\nimport { fontProcessor } from '../processors/fontProcessor';\nimport { formatContainerProcessor } from '../processors/formatContainerProcessor';\nimport { generalProcessor } from '../processors/generalProcessor';\nimport { headingProcessor } from '../processors/headingProcessor';\nimport { hrProcessor } from '../processors/hrProcessor';\nimport { imageProcessor } from '../processors/imageProcessor';\nimport { knownElementProcessor } from '../processors/knownElementProcessor';\nimport { linkProcessor } from '../processors/linkProcessor';\nimport { listItemProcessor } from '../processors/listItemProcessor';\nimport { listProcessor } from '../processors/listProcessor';\nimport { pProcessor } from '../processors/pProcessor';\nimport { tableProcessor } from '../processors/tableProcessor';\nimport { textProcessor } from '../processors/textProcessor';\nimport type { ElementProcessorMap } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const defaultProcessorMap: ElementProcessorMap = {\n    a: linkProcessor,\n    b: knownElementProcessor,\n    blockquote: knownElementProcessor,\n    br: brProcessor,\n    code: codeProcessor,\n    div: knownElementProcessor,\n    em: knownElementProcessor,\n    font: fontProcessor,\n    i: knownElementProcessor,\n    img: imageProcessor,\n    h1: headingProcessor,\n    h2: headingProcessor,\n    h3: headingProcessor,\n    h4: headingProcessor,\n    h5: headingProcessor,\n    h6: headingProcessor,\n    hr: hrProcessor,\n    li: listItemProcessor,\n    ol: listProcessor,\n    p: pProcessor,\n    pre: formatContainerProcessor,\n    s: knownElementProcessor,\n    section: knownElementProcessor,\n    span: knownElementProcessor,\n    strike: knownElementProcessor,\n    strong: knownElementProcessor,\n    sub: knownElementProcessor,\n    sup: knownElementProcessor,\n    table: tableProcessor,\n    u: knownElementProcessor,\n    ul: listProcessor,\n\n    '*': generalProcessor,\n    '#text': textProcessor,\n    element: elementProcessor,\n    entity: entityProcessor,\n    child: childProcessor,\n    delimiter: delimiterProcessor,\n};\n","import { createContentModelDocument } from '../modelApi/creators/createContentModelDocument';\nimport { normalizeContentModel } from '../modelApi/common/normalizeContentModel';\nimport type {\n    ContentModelDocument,\n    DOMSelection,\n    DomToModelContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create Content Model from DOM tree in this editor\n * @param root Root element of DOM tree to create Content Model from\n * @param context Context object for DOM to Content Model conversion\n * @param selection Selection that already exists in content\n * @returns A ContentModelDocument object that contains all the models created from the give root element\n */\nexport function domToContentModel(\n    root: HTMLElement | DocumentFragment,\n    context: DomToModelContext,\n    selection?: DOMSelection\n): ContentModelDocument {\n    const model = createContentModelDocument(context.defaultFormat);\n\n    context.selection = selection;\n    context.elementProcessors.child(model, root, context);\n\n    normalizeContentModel(model);\n\n    return model;\n}\n","import { addBlock } from '../../modelApi/common/addBlock';\nimport { ContextStyles } from './formatContainerProcessor';\nimport { createParagraph } from '../../modelApi/creators/createParagraph';\nimport { parseFormat } from '../utils/parseFormat';\nimport type {\n    ContentModelBlockGroup,\n    ContentModelSegmentFormat,\n    DomToModelContext,\n} from 'roosterjs-content-model-types';\n\nconst SegmentDecoratorTags = ['A', 'CODE'];\n\n/**\n * @internal\n */\nexport function blockProcessor(\n    group: ContentModelBlockGroup,\n    element: HTMLElement,\n    context: DomToModelContext,\n    segmentFormat?: ContentModelSegmentFormat\n) {\n    const decorator = context.blockDecorator.tagName ? context.blockDecorator : undefined;\n    const isSegmentDecorator = SegmentDecoratorTags.indexOf(element.tagName) >= 0;\n\n    parseFormat(element, context.formatParsers.block, context.blockFormat, context);\n\n    const blockFormat = { ...context.blockFormat };\n\n    parseFormat(element, context.formatParsers.container, blockFormat, context);\n\n    ContextStyles.forEach(style => {\n        if (blockFormat[style]) {\n            context.blockFormat[style] = blockFormat[style];\n        }\n    });\n\n    if (!isSegmentDecorator) {\n        const paragraph = createParagraph(\n            false /*isImplicit*/,\n            blockFormat,\n            segmentFormat,\n            decorator\n        );\n\n        addBlock(group, paragraph);\n    }\n\n    context.elementProcessors.child(group, element, context);\n}\n","import { addSegment } from '../../modelApi/common/addSegment';\nimport { createBr } from '../../modelApi/creators/createBr';\nimport type { ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const brProcessor: ElementProcessor<HTMLBRElement> = (group, element, context) => {\n    const br = createBr(context.segmentFormat);\n\n    if (context.isInSelection) {\n        br.isSelected = true;\n    }\n\n    const paragraph = addSegment(group, br, context.blockFormat);\n    context.domIndexer?.onSegment(element, paragraph, [br]);\n};\n","import { addSelectionMarker } from '../utils/addSelectionMarker';\nimport { getRegularSelectionOffsets } from '../utils/getRegularSelectionOffsets';\nimport { isNodeOfType } from '../../domUtils/isNodeOfType';\nimport type {\n    ContentModelBlockGroup,\n    DomToModelContext,\n    ElementProcessor,\n} from 'roosterjs-content-model-types';\n\n/**\n * Content Model Element Processor for child elements\n * @param group The parent block group\n * @param parent Parent DOM node to process\n * @param context DOM to Content Model context\n */\nexport const childProcessor: ElementProcessor<ParentNode> = (\n    group: ContentModelBlockGroup,\n    parent: ParentNode,\n    context: DomToModelContext\n) => {\n    const [nodeStartOffset, nodeEndOffset] = getRegularSelectionOffsets(context, parent);\n    let index = 0;\n\n    for (let child = parent.firstChild; child; child = child.nextSibling) {\n        handleRegularSelection(index, context, group, nodeStartOffset, nodeEndOffset, parent);\n\n        processChildNode(group, child, context);\n\n        index++;\n    }\n\n    handleRegularSelection(index, context, group, nodeStartOffset, nodeEndOffset, parent);\n};\n\n/**\n * Helper function for processing child node\n * @param group The parent block group\n * @param parent Parent DOM node to process\n * @param context DOM to Content Model context\n *\n */\nexport function processChildNode(\n    group: ContentModelBlockGroup,\n    child: Node,\n    context: DomToModelContext\n) {\n    if (isNodeOfType(child, 'ELEMENT_NODE') && child.style.display != 'none') {\n        context.elementProcessors.element(group, child, context);\n    } else if (isNodeOfType(child, 'TEXT_NODE')) {\n        context.elementProcessors['#text'](group, child, context);\n    }\n}\n\n/**\n * Helper function to handle regular (range based) selection when process child node\n * @param index Index of current child node in its parent\n * @param context DOM to Content Model context\n * @param group The parent block group\n * @param nodeStartOffset Start offset of current regular selection\n * @param nodeEndOffset  End offset of current regular selection\n * @param container The container node of this selection\n */\nexport function handleRegularSelection(\n    index: number,\n    context: DomToModelContext,\n    group: ContentModelBlockGroup,\n    nodeStartOffset: number,\n    nodeEndOffset: number,\n    container?: Node\n) {\n    if (index == nodeStartOffset) {\n        context.isInSelection = true;\n\n        addSelectionMarker(group, context, container, index);\n    }\n\n    if (index == nodeEndOffset && context.selection?.type == 'range') {\n        if (!context.selection.range.collapsed) {\n            addSelectionMarker(group, context, container, index);\n        }\n        context.isInSelection = false;\n    }\n}\n","import { knownElementProcessor } from './knownElementProcessor';\nimport { parseFormat } from '../utils/parseFormat';\nimport { stackFormat } from '../utils/stackFormat';\nimport type { ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const codeProcessor: ElementProcessor<HTMLElement> = (group, element, context) => {\n    stackFormat(context, { code: 'codeDefault' }, () => {\n        parseFormat(element, context.formatParsers.code, context.code.format, context);\n\n        knownElementProcessor(group, element, context);\n    });\n};\n","import { addSelectionMarker } from '../utils/addSelectionMarker';\nimport type { ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * @param group\n * @param node\n * @param context\n */\nexport const delimiterProcessor: ElementProcessor<Node> = (group, node, context) => {\n    const range = context.selection?.type == 'range' ? context.selection.range : null;\n\n    if (range) {\n        if (node.contains(range.startContainer)) {\n            context.isInSelection = true;\n\n            addSelectionMarker(group, context);\n        }\n\n        if (context.selection?.type == 'range' && node.contains(range.endContainer)) {\n            if (!context.selection.range.collapsed) {\n                addSelectionMarker(group, context);\n            }\n\n            context.isInSelection = false;\n        }\n    }\n};\n","import { isEntityDelimiter, isEntityElement } from '../../domUtils/entityUtils';\nimport type {\n    DomToModelContext,\n    ElementProcessor,\n    ElementProcessorMap,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * @param group\n * @param element\n * @param context\n */\nexport const elementProcessor: ElementProcessor<HTMLElement> = (group, element, context) => {\n    const tagName = element.tagName.toLowerCase() as keyof ElementProcessorMap;\n    const processor = (tryGetProcessorForEntity(element, context) ||\n        tryGetProcessorForDelimiter(element, context) ||\n        context.elementProcessors[tagName] ||\n        (tagName.indexOf(':') >= 0 && context.elementProcessors.child) ||\n        context.elementProcessors['*']) as ElementProcessor<Node>;\n    processor(group, element, context);\n};\n\nfunction tryGetProcessorForEntity(element: HTMLElement, context: DomToModelContext) {\n    return isEntityElement(element) || element.contentEditable == 'false' // For readonly element, treat as an entity\n        ? context.elementProcessors.entity\n        : null;\n}\n\nfunction tryGetProcessorForDelimiter(element: HTMLElement, context: DomToModelContext) {\n    return isEntityDelimiter(element) ? context.elementProcessors.delimiter : null;\n}\n","import { addBlock } from '../../modelApi/common/addBlock';\nimport { addSegment } from '../../modelApi/common/addSegment';\nimport { createEntity } from '../../modelApi/creators/createEntity';\nimport { isBlockElement } from '../utils/isBlockElement';\nimport { parseFormat } from '../utils/parseFormat';\nimport { stackFormat } from '../utils/stackFormat';\nimport type { ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * Content Model Element Processor for entity\n * @param group The parent block group\n * @param parent Parent DOM node to process\n * @param context DOM to Content Model context\n */\nexport const entityProcessor: ElementProcessor<HTMLElement> = (group, element, context) => {\n    const isBlockEntity =\n        isBlockElement(element) ||\n        (element.style.display == 'inline-block' && element.style.width == '100%');\n\n    stackFormat(\n        context,\n        { segment: isBlockEntity ? 'empty' : undefined, paragraph: 'empty' },\n        () => {\n            const entityModel = createEntity(element, true /*isReadonly*/, context.segmentFormat);\n\n            parseFormat(element, context.formatParsers.entity, entityModel.entityFormat, context);\n\n            if (context.isInSelection) {\n                entityModel.isSelected = true;\n            }\n\n            if (isBlockEntity) {\n                addBlock(group, entityModel);\n            } else {\n                const paragraph = addSegment(group, entityModel);\n                context.domIndexer?.onSegment(element, paragraph, [entityModel]);\n            }\n        }\n    );\n};\n","import { isBlockElement } from '../utils/isBlockElement';\nimport { parseFormat } from '../utils/parseFormat';\nimport { stackFormat } from '../utils/stackFormat';\nimport type { ElementProcessor } from 'roosterjs-content-model-types';\n\nconst FontSizes = ['10px', '13px', '16px', '18px', '24px', '32px', '48px'];\n\nfunction getFontSize(size: string | null) {\n    const intSize = parseInt(size || '');\n\n    if (Number.isNaN(intSize)) {\n        return undefined;\n    } else if (intSize < 1) {\n        return FontSizes[0];\n    } else if (intSize > FontSizes.length) {\n        return FontSizes[FontSizes.length - 1];\n    } else {\n        return FontSizes[intSize - 1];\n    }\n}\n\n/**\n * @internal\n */\nexport const fontProcessor: ElementProcessor<HTMLFontElement> = (group, element, context) => {\n    stackFormat(\n        context,\n        {\n            segment: isBlockElement(element) ? 'shallowCloneForBlock' : 'shallowClone',\n        },\n        () => {\n            const fontFamily = element.getAttribute('face');\n            const fontSize = getFontSize(element.getAttribute('size'));\n            const textColor = element.getAttribute('color');\n            const format = context.segmentFormat;\n\n            if (fontFamily) {\n                format.fontFamily = fontFamily;\n            }\n\n            if (fontSize) {\n                format.fontSize = fontSize;\n            }\n\n            if (textColor) {\n                format.textColor = textColor;\n            }\n\n            parseFormat(element, context.formatParsers.segment, context.segmentFormat, context);\n\n            context.elementProcessors.child(group, element, context);\n        }\n    );\n};\n","import { addBlock } from '../../modelApi/common/addBlock';\nimport { createFormatContainer } from '../../modelApi/creators/createFormatContainer';\nimport { createParagraph } from '../../modelApi/creators/createParagraph';\nimport { getDefaultStyle } from '../utils/getDefaultStyle';\nimport { parseFormat } from '../utils/parseFormat';\nimport { setParagraphNotImplicit } from '../../modelApi/block/setParagraphNotImplicit';\nimport { stackFormat } from '../utils/stackFormat';\nimport type {\n    ContentModelFormatContainer,\n    ContentModelFormatContainerFormat,\n    ContentModelParagraph,\n    ElementProcessor,\n    MarginFormat,\n    PaddingFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const ContextStyles: (keyof (MarginFormat & PaddingFormat))[] = [\n    'marginLeft',\n    'marginRight',\n    'paddingLeft',\n    'paddingRight',\n];\n\n/**\n * @internal\n */\nexport const formatContainerProcessor: ElementProcessor<HTMLElement> = (\n    group,\n    element,\n    context\n) => {\n    stackFormat(context, { segment: 'shallowCloneForBlock', paragraph: 'shallowClone' }, () => {\n        parseFormat(element, context.formatParsers.block, context.blockFormat, context);\n        parseFormat(element, context.formatParsers.segmentOnBlock, context.segmentFormat, context);\n\n        const format: ContentModelFormatContainerFormat = {\n            ...context.blockFormat,\n        };\n\n        parseFormat(element, context.formatParsers.container, format, context);\n\n        const tagName =\n            getDefaultStyle(element).display == 'block' ? element.tagName.toLowerCase() : 'div';\n        const formatContainer = createFormatContainer(tagName, format);\n\n        // It is possible to inherit margin left/right styles from parent DIV or other containers,\n        // since we are going into a deeper level of format container now,\n        // the container will render these styles so no need to keep them in context format\n        ContextStyles.forEach(style => {\n            delete context.blockFormat[style];\n        });\n\n        context.elementProcessors.child(formatContainer, element, context);\n\n        if (element.style.fontSize && parseInt(element.style.fontSize) == 0) {\n            formatContainer.zeroFontSize = true;\n        }\n\n        if (shouldFallbackToParagraph(formatContainer)) {\n            // For DIV container that only has one paragraph child, container style can be merged into paragraph\n            // and no need to have this container\n            const paragraph = formatContainer.blocks[0] as ContentModelParagraph;\n\n            if (formatContainer.zeroFontSize) {\n                paragraph.segmentFormat = Object.assign({}, paragraph.segmentFormat, {\n                    fontSize: '0',\n                });\n            }\n\n            Object.assign(paragraph.format, formatContainer.format);\n            setParagraphNotImplicit(paragraph);\n            addBlock(group, paragraph);\n        } else {\n            addBlock(group, formatContainer);\n        }\n    });\n\n    addBlock(group, createParagraph(true /*isImplicit*/, context.blockFormat));\n};\n\nfunction shouldFallbackToParagraph(formatContainer: ContentModelFormatContainer) {\n    const firstChild = formatContainer.blocks[0];\n\n    return (\n        formatContainer.tagName == 'div' &&\n        formatContainer.blocks.length == 1 &&\n        firstChild.blockType == 'Paragraph' &&\n        firstChild.isImplicit\n    );\n}\n","import { addBlock } from '../../modelApi/common/addBlock';\nimport { addDecorators } from '../../modelApi/common/addDecorators';\nimport { addSegment } from '../../modelApi/common/addSegment';\nimport { createGeneralBlock } from '../../modelApi/creators/createGeneralBlock';\nimport { createGeneralSegment } from '../../modelApi/creators/createGeneralSegment';\nimport { isBlockElement } from '../utils/isBlockElement';\nimport { parseFormat } from '../utils/parseFormat';\nimport { stackFormat } from '../utils/stackFormat';\nimport type { ElementProcessor } from 'roosterjs-content-model-types';\n\nconst generalBlockProcessor: ElementProcessor<HTMLElement> = (group, element, context) => {\n    const block = createGeneralBlock(element);\n    const isSelectedBefore = context.isInSelection;\n\n    stackFormat(\n        context,\n        {\n            segment: 'empty',\n            paragraph: 'empty',\n            link: 'empty',\n        },\n        () => {\n            addBlock(group, block);\n\n            parseFormat(element, context.formatParsers.general, block.format, context);\n\n            context.elementProcessors.child(block, element, context);\n        }\n    );\n\n    if (isSelectedBefore && context.isInSelection) {\n        block.isSelected = true;\n    }\n};\n\nconst generalSegmentProcessor: ElementProcessor<HTMLElement> = (group, element, context) => {\n    const segment = createGeneralSegment(element, context.segmentFormat);\n    const isSelectedBefore = context.isInSelection;\n\n    addDecorators(segment, context);\n    const paragraph = addSegment(group, segment);\n    context.domIndexer?.onSegment(element, paragraph, [segment]);\n\n    stackFormat(\n        context,\n        {\n            segment:\n                'empty' /*clearFormat, General segment will include all properties and styles when generate back to HTML, so no need to carry over existing segment format*/,\n        },\n        () => {\n            parseFormat(element, context.formatParsers.general, segment.format, context);\n\n            context.elementProcessors.child(segment, element, context);\n        }\n    );\n\n    if (isSelectedBefore && context.isInSelection) {\n        segment.isSelected = true;\n    }\n};\n\n/**\n * @internal\n */\nexport const generalProcessor: ElementProcessor<HTMLElement> = (group, element, context) => {\n    const processor = isBlockElement(element) ? generalBlockProcessor : generalSegmentProcessor;\n\n    processor(group, element, context);\n};\n","import { addBlock } from '../../modelApi/common/addBlock';\nimport { blockProcessor } from './blockProcessor';\nimport { createParagraph } from '../../modelApi/creators/createParagraph';\nimport { createParagraphDecorator } from '../../modelApi/creators/createParagraphDecorator';\nimport { getObjectKeys } from '../../domUtils/getObjectKeys';\nimport { parseFormat } from '../utils/parseFormat';\nimport { stackFormat } from '../utils/stackFormat';\nimport type { ContentModelSegmentFormat, ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const headingProcessor: ElementProcessor<HTMLHeadingElement> = (group, element, context) => {\n    stackFormat(\n        context,\n        { segment: 'shallowCloneForBlock', paragraph: 'shallowClone', blockDecorator: 'empty' },\n        () => {\n            const segmentFormat: ContentModelSegmentFormat = {};\n\n            parseFormat(element, context.formatParsers.segmentOnBlock, segmentFormat, context);\n\n            // These formats are already declared on heading element, no need to keep them in context.\n            // And we should not duplicate them in context, either. Because when we want to turn off heading,\n            // inner text should not keep those text format from heading.\n            getObjectKeys(segmentFormat).forEach(key => {\n                delete context.segmentFormat[key];\n            });\n\n            context.blockDecorator = createParagraphDecorator(element.tagName, segmentFormat);\n\n            blockProcessor(group, element, context);\n        }\n    );\n\n    addBlock(group, createParagraph(true /*isImplicit*/, context.blockFormat));\n};\n","import { addBlock } from '../../modelApi/common/addBlock';\nimport { createDivider } from '../../modelApi/creators/createDivider';\nimport { parseFormat } from '../utils/parseFormat';\nimport { stackFormat } from '../utils/stackFormat';\nimport type { ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const hrProcessor: ElementProcessor<HTMLHRElement> = (group, element, context) => {\n    stackFormat(\n        context,\n        {\n            paragraph: 'shallowClone',\n        },\n        () => {\n            parseFormat(element, context.formatParsers.divider, context.blockFormat, context);\n\n            const hr = createDivider('hr', context.blockFormat);\n\n            if (element.size) {\n                hr.size = element.size;\n            }\n\n            if (context.isInSelection) {\n                hr.isSelected = true;\n            }\n\n            addBlock(group, hr);\n        }\n    );\n};\n","import { addDecorators } from '../../modelApi/common/addDecorators';\nimport { addSegment } from '../../modelApi/common/addSegment';\nimport { createImage } from '../../modelApi/creators/createImage';\nimport { parseFormat } from '../utils/parseFormat';\nimport { stackFormat } from '../utils/stackFormat';\nimport type { ContentModelImageFormat, ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const imageProcessor: ElementProcessor<HTMLImageElement> = (group, element, context) => {\n    stackFormat(context, { segment: 'shallowClone' }, () => {\n        const imageFormat: ContentModelImageFormat = context.segmentFormat;\n\n        // Use getAttribute('src') instead of retrieving src directly, in case the src has port and may be stripped by browser\n        const src = element.getAttribute('src') ?? '';\n\n        parseFormat(element, context.formatParsers.segment, imageFormat, context);\n        parseFormat(element, context.formatParsers.image, imageFormat, context);\n        parseFormat(element, context.formatParsers.block, context.blockFormat, context);\n\n        const image = createImage(src, imageFormat);\n        const alt = element.alt;\n        const title = element.title;\n\n        parseFormat(element, context.formatParsers.dataset, image.dataset, context);\n        addDecorators(image, context);\n\n        if (alt) {\n            image.alt = alt;\n        }\n        if (title) {\n            image.title = title;\n        }\n        if (context.isInSelection) {\n            image.isSelected = true;\n        }\n        if (context.selection?.type == 'image' && context.selection.image == element) {\n            image.isSelectedAsImageSelection = true;\n            image.isSelected = true;\n        }\n\n        const paragraph = addSegment(group, image);\n        context.domIndexer?.onSegment(element, paragraph, [image]);\n    });\n};\n","import { addBlock } from '../../modelApi/common/addBlock';\nimport { blockProcessor } from './blockProcessor';\nimport { createParagraph } from '../../modelApi/creators/createParagraph';\nimport { formatContainerProcessor } from './formatContainerProcessor';\nimport { getDefaultStyle } from '../utils/getDefaultStyle';\nimport { isBlockElement } from '../utils/isBlockElement';\nimport { parseFormat } from '../utils/parseFormat';\nimport { stackFormat } from '../utils/stackFormat';\nimport type {\n    ContentModelSegmentFormat,\n    DomToModelContext,\n    ElementProcessor,\n} from 'roosterjs-content-model-types';\n\nconst FormatContainerTriggerStyles: (keyof CSSStyleDeclaration)[] = [\n    'marginBottom',\n    'marginTop',\n    'paddingBottom',\n    'paddingTop',\n    'paddingLeft',\n    'paddingRight',\n    'borderTopWidth',\n    'borderBottomWidth',\n    'borderLeftWidth',\n    'borderRightWidth',\n    'width',\n    'height',\n    'maxWidth',\n    'maxHeight',\n    'minWidth',\n    'minHeight',\n];\nconst ByPassFormatContainerTags = ['H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'P', 'A'];\nconst SegmentDecoratorTags = ['A', 'CODE'];\n\n/**\n * @internal\n */\nexport const knownElementProcessor: ElementProcessor<HTMLElement> = (group, element, context) => {\n    const isBlock = isBlockElement(element);\n\n    if (\n        (isBlock || element.style.display == 'inline-block') && // For inline-block here, we will also check if it should be represented as Format Container\n        shouldUseFormatContainer(element, context)\n    ) {\n        formatContainerProcessor(group, element, context);\n    } else if (isBlock) {\n        const decorator = context.blockDecorator.tagName ? context.blockDecorator : undefined;\n        const isSegmentDecorator = SegmentDecoratorTags.indexOf(element.tagName) >= 0;\n\n        stackFormat(context, { segment: 'shallowCloneForBlock', paragraph: 'shallowClone' }, () => {\n            const segmentFormat: ContentModelSegmentFormat = {};\n\n            parseFormat(element, context.formatParsers.segmentOnBlock, segmentFormat, context);\n            Object.assign(context.segmentFormat, segmentFormat);\n\n            blockProcessor(group, element, context, segmentFormat);\n        });\n\n        if (isBlock && !isSegmentDecorator) {\n            addBlock(\n                group,\n                createParagraph(\n                    true /*isImplicit*/,\n                    context.blockFormat,\n                    undefined /*segmentFormat*/,\n                    decorator\n                )\n            );\n        }\n    } else {\n        stackFormat(\n            context,\n            {\n                segment: 'shallowClone',\n                paragraph: 'shallowClone',\n                link: 'cloneFormat',\n            },\n            () => {\n                parseFormat(element, context.formatParsers.segment, context.segmentFormat, context);\n\n                if (context.link.format.href && element.tagName != 'A') {\n                    parseFormat(\n                        element,\n                        context.formatParsers.segmentUnderLink,\n                        context.link.format,\n                        context\n                    );\n                }\n\n                context.elementProcessors.child(group, element, context);\n            }\n        );\n    }\n};\n\nfunction shouldUseFormatContainer(element: HTMLElement, context: DomToModelContext) {\n    // For those tags that we know we should not use format container, just return false\n    if (ByPassFormatContainerTags.indexOf(element.tagName) >= 0) {\n        return false;\n    }\n\n    const style = element.style;\n    const defaultStyle = getDefaultStyle(element);\n\n    const bgcolor = style.getPropertyValue('background-color');\n\n    // For block element with background, we need to use format container\n    if (bgcolor && bgcolor != 'transparent') {\n        return true;\n    }\n\n    // For block element with positive value of border width or top/bottom margin/padding,\n    // we need to use format container\n    if (\n        FormatContainerTriggerStyles.some(\n            key => parseInt((style[key] as string) || (defaultStyle[key] as string) || '') > 0\n        )\n    ) {\n        return true;\n    }\n\n    // For margin left/right with value \"auto\", we need to use format container\n    if (style.marginLeft == 'auto' || style.marginRight == 'auto') {\n        return true;\n    }\n\n    // For element with \"align\" attribute, we need to use format container\n    if (element.getAttribute('align')) {\n        return true;\n    }\n\n    return false;\n}\n","import { knownElementProcessor } from './knownElementProcessor';\nimport { parseFormat } from '../utils/parseFormat';\nimport { stackFormat } from '../utils/stackFormat';\nimport type { ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const linkProcessor: ElementProcessor<HTMLElement> = (group, element, context) => {\n    if (element.hasAttribute('href')) {\n        stackFormat(context, { link: 'linkDefault' }, () => {\n            parseFormat(element, context.formatParsers.link, context.link.format, context);\n            parseFormat(element, context.formatParsers.dataset, context.link.dataset, context);\n\n            knownElementProcessor(group, element, context);\n        });\n    } else {\n        // A tag without href, can be treated as normal SPAN tag\n        knownElementProcessor(group, element, context);\n    }\n};\n","import { createListItem } from '../../modelApi/creators/createListItem';\nimport { parseFormat } from '../utils/parseFormat';\nimport { stackFormat } from '../utils/stackFormat';\nimport type { ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const listItemProcessor: ElementProcessor<HTMLLIElement> = (group, element, context) => {\n    const { listFormat } = context;\n\n    if (listFormat.listParent && listFormat.levels.length > 0) {\n        stackFormat(\n            context,\n            {\n                segment: 'shallowCloneForBlock',\n            },\n            () => {\n                parseFormat(\n                    element,\n                    context.formatParsers.segmentOnBlock,\n                    context.segmentFormat,\n                    context\n                );\n\n                const listItem = createListItem(listFormat.levels, context.segmentFormat);\n                parseFormat(\n                    element,\n                    context.formatParsers.listItemElement,\n                    listItem.format,\n                    context\n                );\n\n                listFormat.listParent!.blocks.push(listItem);\n\n                parseFormat(\n                    element,\n                    context.formatParsers.listItemThread,\n                    listItem.levels[listItem.levels.length - 1].format,\n                    context\n                );\n\n                context.elementProcessors.child(listItem, element, context);\n\n                const firstChild = listItem.blocks[0];\n\n                if (\n                    listItem.blocks.length == 1 &&\n                    firstChild.blockType == 'Paragraph' &&\n                    firstChild.isImplicit\n                ) {\n                    Object.assign(listItem.format, firstChild.format);\n                    firstChild.format = {};\n                }\n            }\n        );\n    } else {\n        const currentBlocks = listFormat.listParent?.blocks;\n        const lastItem = currentBlocks?.[currentBlocks?.length - 1];\n\n        context.elementProcessors['*'](\n            lastItem?.blockType == 'BlockGroup' ? lastItem : group,\n            element,\n            context\n        );\n    }\n};\n","import { createListLevel } from '../../modelApi/creators/createListLevel';\nimport { parseFormat } from '../utils/parseFormat';\nimport { stackFormat } from '../utils/stackFormat';\nimport type { ContentModelListLevel, ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const listProcessor: ElementProcessor<HTMLOListElement | HTMLUListElement> = (\n    group,\n    element,\n    context\n) => {\n    stackFormat(\n        context,\n        {\n            segment: 'shallowCloneForBlock',\n            paragraph: 'shallowCloneForGroup',\n        },\n        () => {\n            const level: ContentModelListLevel = createListLevel(\n                element.tagName as 'OL' | 'UL',\n                context.blockFormat\n            );\n            const { listFormat } = context;\n\n            parseFormat(element, context.formatParsers.dataset, level.dataset, context);\n            parseFormat(element, context.formatParsers.listLevelThread, level.format, context);\n            parseFormat(element, context.formatParsers.listLevel, level.format, context);\n            parseFormat(element, context.formatParsers.segment, context.segmentFormat, context);\n\n            const originalListParent = listFormat.listParent;\n\n            listFormat.listParent = listFormat.listParent || group;\n            listFormat.levels.push(level);\n\n            try {\n                context.elementProcessors.child(group, element, context);\n            } finally {\n                listFormat.levels.pop();\n                listFormat.listParent = originalListParent;\n            }\n        }\n    );\n};\n","import { addBlock } from '../../modelApi/common/addBlock';\nimport { blockProcessor } from './blockProcessor';\nimport { createParagraph } from '../../modelApi/creators/createParagraph';\nimport { createParagraphDecorator } from '../../modelApi/creators/createParagraphDecorator';\nimport { parseFormat } from '../utils/parseFormat';\nimport { stackFormat } from '../utils/stackFormat';\nimport type { ContentModelSegmentFormat, ElementProcessor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const pProcessor: ElementProcessor<HTMLElement> = (group, element, context) => {\n    stackFormat(\n        context,\n        { blockDecorator: 'empty', segment: 'shallowCloneForBlock', paragraph: 'shallowClone' },\n        () => {\n            context.blockDecorator = createParagraphDecorator(element.tagName);\n\n            const segmentFormat: ContentModelSegmentFormat = {};\n\n            parseFormat(element, context.formatParsers.segmentOnBlock, segmentFormat, context);\n            Object.assign(context.segmentFormat, segmentFormat);\n\n            blockProcessor(group, element, context, segmentFormat);\n        }\n    );\n\n    addBlock(group, createParagraph(true /*isImplicit*/, context.blockFormat));\n};\n","import { addBlock } from '../../modelApi/common/addBlock';\nimport { createTable } from '../../modelApi/creators/createTable';\nimport { createTableCell } from '../../modelApi/creators/createTableCell';\nimport { getBoundingClientRect } from '../utils/getBoundingClientRect';\nimport { isElementOfType } from '../../domUtils/isElementOfType';\nimport { isNodeOfType } from '../../domUtils/isNodeOfType';\nimport { parseFormat } from '../utils/parseFormat';\nimport { parseValueWithUnit } from '../../formatHandlers/utils/parseValueWithUnit';\nimport { stackFormat } from '../utils/stackFormat';\nimport type {\n    ContentModelTableCellFormat,\n    DatasetFormat,\n    DomToModelContext,\n    ElementProcessor,\n    SizeFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * Content Model Element Processor for table\n *\n * For Table with merged/splitted cells, HTML uses colSpan and rowSpan attributes to specify how it should be rendered.\n * To make it easier to edit a table, we will use a different way to describe table.\n *\n * 1. For a m * n table (m rows, n columns), we always create a m * n array for the cells.\n * 2. For a regular table cell, it is mapped to one item of this array\n * 3. For a merged/splitted table cell, it will has colSpan/rowSpan value. We also created TableCell model for those spanned\n * cells, and use \"spanLeft\" and \"spanAbove\" to mark its state\n * 4. When edit table, we always edit on this mapped m * n array because it always has an item for each cell\n * 5. When write back to DOM, we create TD/TH elements for those non-spanned cells, and mark its colSpan/rowSpan value according\n * its neighbour cell's spanLeft/spanAbove attribute\n * @param group The parent block group\n * @param parent Parent DOM node to process\n * @param context DOM to Content Model context\n */\nexport const tableProcessor: ElementProcessor<HTMLTableElement> = (\n    group,\n    tableElement,\n    context\n) => {\n    stackFormat(\n        context,\n        { segment: 'shallowCloneForBlock', paragraph: 'shallowCloneForGroup' },\n        () => {\n            parseFormat(tableElement, context.formatParsers.block, context.blockFormat, context);\n\n            const table = createTable(tableElement.rows.length, context.blockFormat);\n            const tableSelection = context.selection?.type == 'table' ? context.selection : null;\n            const selectedTable = tableSelection?.table;\n            const hasTableSelection = selectedTable == tableElement;\n\n            if (context.allowCacheElement) {\n                table.cachedElement = tableElement;\n            }\n\n            context.domIndexer?.onTable(tableElement, table);\n\n            parseFormat(tableElement, context.formatParsers.table, table.format, context);\n            parseFormat(tableElement, context.formatParsers.tableBorder, table.format, context);\n            parseFormat(\n                tableElement,\n                context.formatParsers.segmentOnBlock,\n                context.segmentFormat,\n                context\n            );\n            parseFormat(tableElement, context.formatParsers.dataset, table.dataset, context);\n            addBlock(group, table);\n\n            const columnPositions: (number | undefined)[] = [0];\n            const hasColGroup = processColGroup(tableElement, context, columnPositions);\n            const rowPositions: number[] = [0];\n            const zoomScale = context.zoomScale || 1;\n\n            for (let row = 0; row < tableElement.rows.length; row++) {\n                const tr = tableElement.rows[row];\n                const tableRow = table.rows[row];\n\n                const tbody = tr.parentNode;\n\n                if (\n                    isNodeOfType(tbody, 'ELEMENT_NODE') &&\n                    (isElementOfType(tbody, 'tbody') ||\n                        isElementOfType(tbody, 'thead') ||\n                        isElementOfType(tbody, 'tfoot'))\n                ) {\n                    parseFormat(tbody, context.formatParsers.tableRow, tableRow.format, context);\n                } else if (context.allowCacheElement) {\n                    tableRow.cachedElement = tr;\n                }\n\n                parseFormat(tr, context.formatParsers.tableRow, tableRow.format, context);\n\n                stackFormat(context, { paragraph: 'shallowClone', segment: 'shallowClone' }, () => {\n                    const parent = tr.parentElement;\n                    const parentTag = parent?.tagName;\n\n                    if (\n                        parent &&\n                        (parentTag == 'TBODY' || parentTag == 'THEAD' || parentTag == 'TFOOT')\n                    ) {\n                        // If there is TBODY around TR, retrieve format from TBODY first, in case some format are declared there\n                        parseFormat(\n                            parent,\n                            context.formatParsers.block,\n                            context.blockFormat,\n                            context\n                        );\n                        parseFormat(\n                            parent,\n                            context.formatParsers.segmentOnBlock,\n                            context.segmentFormat,\n                            context\n                        );\n                    }\n\n                    parseFormat(tr, context.formatParsers.block, context.blockFormat, context);\n                    parseFormat(\n                        tr,\n                        context.formatParsers.segmentOnBlock,\n                        context.segmentFormat,\n                        context\n                    );\n\n                    for (\n                        let sourceCol = 0, targetCol = 0;\n                        sourceCol < tr.cells.length;\n                        sourceCol++\n                    ) {\n                        for (; tableRow.cells[targetCol]; targetCol++) {}\n\n                        const td = tr.cells[sourceCol];\n                        const hasSelectionBeforeCell = context.isInSelection;\n                        const colEnd = targetCol + td.colSpan;\n                        const rowEnd = row + td.rowSpan;\n                        const needCalcWidth = columnPositions[colEnd] === undefined;\n                        const needCalcHeight = rowPositions[rowEnd] === undefined;\n\n                        if (needCalcWidth || needCalcHeight) {\n                            const rect = getBoundingClientRect(td);\n\n                            if (rect.width > 0 || rect.height > 0) {\n                                if (needCalcWidth) {\n                                    const pos = columnPositions[targetCol];\n\n                                    columnPositions[colEnd] =\n                                        (typeof pos == 'number' ? pos : 0) + rect.width / zoomScale;\n                                }\n\n                                if (needCalcHeight) {\n                                    rowPositions[rowEnd] =\n                                        rowPositions[row] + rect.height / zoomScale;\n                                }\n                            }\n                        }\n\n                        stackFormat(\n                            context,\n                            { paragraph: 'shallowClone', segment: 'shallowClone' },\n                            () => {\n                                parseFormat(\n                                    td,\n                                    context.formatParsers.block,\n                                    context.blockFormat,\n                                    context\n                                );\n                                parseFormat(\n                                    td,\n                                    context.formatParsers.segmentOnTableCell,\n                                    context.segmentFormat,\n                                    context\n                                );\n\n                                const cellFormat: ContentModelTableCellFormat = {\n                                    ...context.blockFormat,\n                                };\n                                const dataset: DatasetFormat = {};\n\n                                parseFormat(\n                                    td,\n                                    context.formatParsers.tableCell,\n                                    cellFormat,\n                                    context\n                                );\n                                parseFormat(\n                                    td,\n                                    context.formatParsers.tableBorder,\n                                    cellFormat,\n                                    context\n                                );\n                                parseFormat(td, context.formatParsers.dataset, dataset, context);\n\n                                for (\n                                    let colSpan = 1;\n                                    colSpan <= td.colSpan;\n                                    colSpan++, targetCol++\n                                ) {\n                                    for (let rowSpan = 1; rowSpan <= td.rowSpan; rowSpan++) {\n                                        const hasTd = colSpan == 1 && rowSpan == 1;\n                                        const cell = createTableCell(\n                                            colSpan > 1,\n                                            rowSpan > 1,\n                                            td.tagName == 'TH',\n                                            cellFormat\n                                        );\n\n                                        cell.dataset = { ...dataset };\n\n                                        const spannedRow = table.rows[row + rowSpan - 1];\n\n                                        if (spannedRow) {\n                                            spannedRow.cells[targetCol] = cell;\n                                        }\n\n                                        if (hasTd) {\n                                            // When there is COLGROUP, width on table cell should be ignored, so we should not cache the table cell,\n                                            // and always recreate it when write back using the table formats\n                                            if (context.allowCacheElement && !hasColGroup) {\n                                                cell.cachedElement = td;\n                                            }\n\n                                            const { listParent, levels } = context.listFormat;\n\n                                            context.listFormat.listParent = undefined;\n                                            context.listFormat.levels = [];\n\n                                            try {\n                                                context.elementProcessors.child(cell, td, context);\n                                            } finally {\n                                                context.listFormat.listParent = listParent;\n                                                context.listFormat.levels = levels;\n                                            }\n                                        }\n\n                                        const hasSelectionAfterCell = context.isInSelection;\n\n                                        if (\n                                            (hasSelectionBeforeCell && hasSelectionAfterCell) ||\n                                            (hasTableSelection &&\n                                                tableSelection &&\n                                                row >= tableSelection.firstRow &&\n                                                row <= tableSelection.lastRow &&\n                                                targetCol >= tableSelection.firstColumn &&\n                                                targetCol <= tableSelection.lastColumn)\n                                        ) {\n                                            cell.isSelected = true;\n                                        }\n                                    }\n                                }\n                            }\n                        );\n                    }\n                });\n\n                for (let col = 0; col < tableRow.cells.length; col++) {\n                    if (!tableRow.cells[col]) {\n                        tableRow.cells[col] = createTableCell(\n                            false,\n                            false,\n                            false,\n                            context.blockFormat\n                        );\n                    }\n                }\n            }\n\n            table.widths = calcSizes(columnPositions);\n\n            const heights = calcSizes(rowPositions);\n\n            table.rows.forEach((row, i) => {\n                if (heights[i] > 0) {\n                    row.height = heights[i];\n                }\n            });\n        }\n    );\n};\n\nfunction calcSizes(positions: (number | undefined)[]): number[] {\n    const result: number[] = [];\n    let lastPos = 0;\n\n    for (let i = positions.length - 1; i >= 0; i--) {\n        const pos = positions[i];\n\n        if (typeof pos == 'number') {\n            lastPos = pos;\n            break;\n        }\n    }\n\n    for (let i = positions.length - 2; i >= 0; i--) {\n        const pos = positions[i];\n        if (pos === undefined) {\n            result[i] = 0;\n        } else {\n            result[i] = lastPos - pos;\n            lastPos = pos;\n        }\n    }\n\n    return result;\n}\n\nfunction processColGroup(\n    table: HTMLElement,\n    context: DomToModelContext,\n    result: (number | undefined)[]\n): boolean {\n    let lastPos = 0;\n    let hasColGroup = false;\n\n    for (let child = table.firstChild; child; child = child.nextSibling) {\n        if (isNodeOfType(child, 'ELEMENT_NODE') && child.tagName == 'COLGROUP') {\n            hasColGroup = true;\n\n            for (let col = child.firstChild; col; col = col.nextSibling) {\n                if (isNodeOfType(col, 'ELEMENT_NODE') && col.tagName == 'COL') {\n                    const colFormat: SizeFormat = {};\n\n                    parseFormat(col, context.formatParsers.tableColumn, colFormat, context);\n\n                    for (let i = 0; i < parseInt(col.getAttribute('span') ?? '1'); i++) {\n                        if (colFormat.width === undefined) {\n                            result.push(undefined);\n                        } else {\n                            const width = parseValueWithUnit(\n                                colFormat.width ?? '',\n                                undefined /*element*/,\n                                'px'\n                            );\n\n                            result.push(width + lastPos);\n                            lastPos += width;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    return hasColGroup;\n}\n","import { addDecorators } from '../../modelApi/common/addDecorators';\nimport { addSegment } from '../../modelApi/common/addSegment';\nimport { addSelectionMarker } from '../utils/addSelectionMarker';\nimport { createText } from '../../modelApi/creators/createText';\nimport { ensureParagraph } from '../../modelApi/common/ensureParagraph';\nimport { getRegularSelectionOffsets } from '../utils/getRegularSelectionOffsets';\nimport { hasSpacesOnly } from '../../modelApi/common/hasSpacesOnly';\nimport { isWhiteSpacePreserved } from '../../domUtils/isWhiteSpacePreserved';\nimport { stackFormat } from '../utils/stackFormat';\nimport type {\n    ContentModelBlockGroup,\n    ContentModelParagraph,\n    ContentModelText,\n    DomToModelContext,\n    ElementProcessor,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const textProcessor: ElementProcessor<Text> = (\n    group: ContentModelBlockGroup,\n    textNode: Text,\n    context: DomToModelContext\n) => {\n    if (context.formatParsers.text.length > 0) {\n        stackFormat(context, { segment: 'shallowClone' }, () => {\n            context.formatParsers.text.forEach(parser => {\n                parser(context.segmentFormat, textNode, context);\n                internalTextProcessor(group, textNode, context);\n            });\n        });\n    } else {\n        internalTextProcessor(group, textNode, context);\n    }\n};\n\nfunction internalTextProcessor(\n    group: ContentModelBlockGroup,\n    textNode: Text,\n    context: DomToModelContext\n) {\n    let txt = textNode.nodeValue || '';\n    const offsets = getRegularSelectionOffsets(context, textNode);\n    const txtStartOffset = offsets[0];\n    let txtEndOffset = offsets[1];\n    const segments: (ContentModelText | undefined)[] = [];\n    const paragraph = ensureParagraph(group, context.blockFormat);\n\n    if (txtStartOffset >= 0) {\n        const subText = txt.substring(0, txtStartOffset);\n        segments.push(addTextSegment(group, subText, paragraph, context));\n        context.isInSelection = true;\n\n        addSelectionMarker(group, context, textNode, txtStartOffset);\n\n        txt = txt.substring(txtStartOffset);\n        txtEndOffset -= txtStartOffset;\n    }\n\n    if (txtEndOffset >= 0) {\n        const subText = txt.substring(0, txtEndOffset);\n        segments.push(addTextSegment(group, subText, paragraph, context));\n\n        if (\n            context.selection &&\n            (context.selection.type != 'range' || !context.selection.range.collapsed)\n        ) {\n            addSelectionMarker(group, context, textNode, offsets[1]); // Must use offsets[1] here as the unchanged offset value, cannot use txtEndOffset since it has been modified\n        }\n\n        context.isInSelection = false;\n        txt = txt.substring(txtEndOffset);\n    }\n\n    segments.push(addTextSegment(group, txt, paragraph, context));\n    context.domIndexer?.onSegment(\n        textNode,\n        paragraph,\n        segments.filter((x): x is ContentModelText => !!x)\n    );\n}\n\nfunction addTextSegment(\n    group: ContentModelBlockGroup,\n    text: string,\n    paragraph: ContentModelParagraph,\n    context: DomToModelContext\n): ContentModelText | undefined {\n    let textModel: ContentModelText | undefined;\n\n    if (text) {\n        if (\n            !hasSpacesOnly(text) ||\n            (paragraph?.segments.length ?? 0) > 0 ||\n            isWhiteSpacePreserved(paragraph?.format.whiteSpace)\n        ) {\n            textModel = createText(text, context.segmentFormat);\n\n            if (context.isInSelection) {\n                textModel.isSelected = true;\n            }\n\n            addDecorators(textModel, context);\n\n            addSegment(group, textModel, context.blockFormat);\n        }\n    }\n\n    return textModel;\n}\n","import { addDecorators } from '../../modelApi/common/addDecorators';\nimport { addSegment } from '../../modelApi/common/addSegment';\nimport { createSelectionMarker } from '../../modelApi/creators/createSelectionMarker';\nimport type { ContentModelBlockGroup, DomToModelContext } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function addSelectionMarker(\n    group: ContentModelBlockGroup,\n    context: DomToModelContext,\n    container?: Node,\n    offset?: number\n) {\n    const pendingFormat =\n        context.pendingFormat &&\n        context.pendingFormat.posContainer === container &&\n        context.pendingFormat.posOffset === offset\n            ? context.pendingFormat.format\n            : undefined;\n    const segmentFormat = {\n        ...context.defaultFormat,\n        ...context.segmentFormat,\n        ...pendingFormat,\n    };\n    const marker = createSelectionMarker(segmentFormat);\n\n    addDecorators(marker, context);\n\n    addSegment(group, marker, context.blockFormat, segmentFormat);\n}\n","import { getObjectKeys } from '../../domUtils/getObjectKeys';\nimport type { ContentModelFormatBase } from 'roosterjs-content-model-types';\n\n/**\n * Check if the two given formats object are equal. This is a check to value but not to reference\n * @param f1 The first format object to check\n * @param f2 The second format object to check\n */\nexport function areSameFormats<T extends ContentModelFormatBase>(f1: T, f2: T) {\n    if (f1 == f2) {\n        return true;\n    } else {\n        const keys1 = getObjectKeys(f1);\n        const keys2 = getObjectKeys(f2);\n\n        return keys1.length == keys2.length && keys1.every(key => f1[key] == f2[key]);\n    }\n}\n","/**\n * @internal\n */\nexport function getBoundingClientRect(element: Element): DOMRect {\n    return element.getBoundingClientRect();\n}\n","import { defaultHTMLStyleMap } from '../../config/defaultHTMLStyleMap';\nimport type { DefaultStyleMap } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Get default CSS style of given element\n * @param element The element to get default style from\n * @returns A valid CSS style object\n */\nexport function getDefaultStyle(element: HTMLElement): Partial<CSSStyleDeclaration> {\n    const tag = element.tagName.toLowerCase() as keyof DefaultStyleMap;\n\n    return defaultHTMLStyleMap[tag] || {};\n}\n","import type { DomToModelContext } from 'roosterjs-content-model-types';\n\n/**\n * Get offset numbers of a regular (range based) selection.\n * If the selection start/end position is not in the given node, it will return -1 for the related value\n * @param context DOM to Content Model context used for retrieve the selection\n * @param currentContainer The container node to check\n * @returns a tuple of start and end offsets. -1 means selection is not directly under the given node\n */\nexport function getRegularSelectionOffsets(\n    context: DomToModelContext,\n    currentContainer: Node\n): [number, number] {\n    const range = context.selection?.type == 'range' ? context.selection.range : null;\n\n    const startOffset = range?.startContainer == currentContainer ? range.startOffset : -1;\n    const endOffset = range?.endContainer == currentContainer ? range.endOffset! : -1;\n\n    return [startOffset, endOffset];\n}\n","import { getDefaultStyle } from './getDefaultStyle';\n\nconst BLOCK_DISPLAY_STYLES = ['block', 'list-item', 'table', 'table-cell', 'flex'];\n\n/**\n * Check if the given element will be layout as a block\n * @param element The element to check\n * @param context The context of DOM to Content Model conversion\n */\nexport function isBlockElement(element: HTMLElement): boolean {\n    const display = element.style.display || getDefaultStyle(element).display || '';\n\n    return BLOCK_DISPLAY_STYLES.indexOf(display) >= 0;\n}\n","import { getDefaultStyle } from './getDefaultStyle';\nimport type {\n    ContentModelFormatBase,\n    DomToModelContext,\n    FormatParser,\n} from 'roosterjs-content-model-types';\n\n/**\n * Parse formats of the given HTML element using specified format parsers\n * @param element The element to parse format from\n * @param parsers The parses we are using to parse format\n * @param format The format object to hold result format\n * @param context DOM to Content Model context\n */\nexport function parseFormat<T extends ContentModelFormatBase>(\n    element: HTMLElement,\n    parsers: (FormatParser<T> | null)[],\n    format: T,\n    context: DomToModelContext\n) {\n    const defaultStyle = getDefaultStyle(element);\n\n    parsers.forEach(parser => {\n        parser?.(format, element, context, defaultStyle);\n    });\n}\n","import { getObjectKeys } from '../../domUtils/getObjectKeys';\nimport type {\n    ContentModelBlockFormat,\n    ContentModelCode,\n    ContentModelFormatBase,\n    ContentModelLink,\n    ContentModelParagraphDecorator,\n    ContentModelSegmentFormat,\n    DomToModelContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport interface StackFormatOptions {\n    segment?: 'shallowClone' | 'shallowCloneForBlock' | 'empty';\n    paragraph?: 'shallowClone' | 'shallowCloneForGroup' | 'empty';\n    blockDecorator?: 'empty';\n    link?: 'linkDefault' | 'cloneFormat' | 'empty';\n    code?: 'codeDefault' | 'empty';\n}\n\n// Some styles, such as background color, won't be inherited by block element if it was originally\n// declared from an inline element. So we need to skip them.\n// e.g.\n// <span style=\"background-color: red\">\n//   line 1       <---------------------------- in red here\n//   <div>line 2</div>  <---------------------- not in red here\n// </span>\nconst SkippedStylesForBlockOnSegmentOnSegment: (keyof ContentModelSegmentFormat)[] = [\n    'backgroundColor',\n];\nconst SkippedStylesForTable: (keyof ContentModelBlockFormat)[] = [\n    'marginLeft',\n    'marginRight',\n    'paddingLeft',\n    'paddingRight',\n];\n\n/**\n * @internal\n */\nexport function stackFormat(\n    context: DomToModelContext,\n    options: StackFormatOptions,\n    callback: () => void\n) {\n    const {\n        segmentFormat,\n        blockFormat,\n        link: linkFormat,\n        code: codeFormat,\n        blockDecorator: decoratorFormat,\n    } = context;\n    const { segment, paragraph, link, code, blockDecorator } = options;\n\n    try {\n        context.segmentFormat = stackFormatInternal(segmentFormat, segment);\n        context.blockFormat = stackFormatInternal(blockFormat, paragraph);\n        context.link = stackLinkInternal(linkFormat, link);\n        context.code = stackCodeInternal(codeFormat, code);\n        context.blockDecorator = stackDecoratorInternal(decoratorFormat, blockDecorator);\n\n        callback();\n    } finally {\n        context.segmentFormat = segmentFormat;\n        context.blockFormat = blockFormat;\n        context.link = linkFormat;\n        context.code = codeFormat;\n        context.blockDecorator = decoratorFormat;\n    }\n}\n\nfunction stackLinkInternal(\n    linkFormat: ContentModelLink,\n    link?: 'linkDefault' | 'cloneFormat' | 'empty'\n) {\n    switch (link) {\n        case 'linkDefault':\n            return {\n                format: {\n                    underline: true,\n                },\n                dataset: {},\n            };\n\n        case 'empty':\n            return {\n                format: {},\n                dataset: {},\n            };\n\n        case 'cloneFormat':\n        default:\n            return {\n                dataset: linkFormat.dataset,\n                format: { ...linkFormat.format },\n            };\n    }\n}\n\nfunction stackCodeInternal(codeFormat: ContentModelCode, code?: 'codeDefault' | 'empty') {\n    switch (code) {\n        case 'codeDefault':\n            return {\n                format: {\n                    fontFamily: 'monospace',\n                },\n            };\n        case 'empty':\n            return {\n                format: {},\n            };\n        default:\n            return codeFormat;\n    }\n}\n\nfunction stackDecoratorInternal(\n    format: ContentModelParagraphDecorator,\n    decorator?: 'decoratorDefault' | 'empty'\n) {\n    switch (decorator) {\n        case 'empty':\n            return {\n                format: {},\n                tagName: '',\n            };\n        default:\n            return format;\n    }\n}\n\nfunction stackFormatInternal<T extends ContentModelFormatBase>(\n    format: T,\n    processType?: 'shallowClone' | 'shallowCloneForBlock' | 'shallowCloneForGroup' | 'empty'\n): T | {} {\n    switch (processType) {\n        case 'empty':\n            return {};\n\n        case undefined:\n            return format;\n\n        default:\n            const result = { ...format };\n\n            getObjectKeys(format).forEach(key => {\n                if (\n                    (processType == 'shallowCloneForBlock' &&\n                        SkippedStylesForBlockOnSegmentOnSegment.indexOf(\n                            key as keyof ContentModelSegmentFormat\n                        ) >= 0) ||\n                    (processType == 'shallowCloneForGroup' &&\n                        SkippedStylesForTable.indexOf(key as keyof ContentModelBlockFormat) >= 0)\n                ) {\n                    delete result[key];\n                }\n            });\n\n            if (processType == 'shallowClone' || processType == 'shallowCloneForGroup') {\n                const blockFormat = format as ContentModelBlockFormat;\n\n                // For a new paragraph, if current text indent is already applied to previous block in the same level,\n                // we need to ignore it according to browser rendering behavior\n                if (blockFormat.textIndent) {\n                    delete (result as ContentModelBlockFormat).isTextIndentApplied;\n                    blockFormat.isTextIndentApplied = true;\n                }\n            }\n\n            return result;\n    }\n}\n","import toArray from './toArray';\nimport { applyFormat } from '../modelToDom/utils/applyFormat';\nimport { isElementOfType } from './isElementOfType';\nimport { isNodeOfType } from './isNodeOfType';\nimport type {\n    ContentModelEntityFormat,\n    ContentModelSegmentFormat,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\nconst ENTITY_INFO_NAME = '_Entity';\nconst ENTITY_TYPE_PREFIX = '_EType_';\nconst ENTITY_ID_PREFIX = '_EId_';\nconst ENTITY_READONLY_PREFIX = '_EReadonly_';\nconst ZERO_WIDTH_SPACE = '\\u200B';\nconst DELIMITER_BEFORE = 'entityDelimiterBefore';\nconst DELIMITER_AFTER = 'entityDelimiterAfter';\n\n/**\n * Check if the given DOM Node is an entity wrapper element\n */\nexport function isEntityElement(node: Node): boolean {\n    return isNodeOfType(node, 'ELEMENT_NODE') && node.classList.contains(ENTITY_INFO_NAME);\n}\n\n/**\n * Get all entity wrapper elements under the given root element\n * @param root The root element to query from\n * @returns An array of entity wrapper elements\n */\nexport function getAllEntityWrappers(root: HTMLElement): HTMLElement[] {\n    return toArray(root.querySelectorAll('.' + ENTITY_INFO_NAME)) as HTMLElement[];\n}\n\n/**\n * Parse entity format from entity wrapper element\n * @param wrapper The wrapper element to parse entity format from\n * @returns Entity format\n */\nexport function parseEntityFormat(wrapper: HTMLElement): ContentModelEntityFormat {\n    let isEntity = false;\n    const format: ContentModelEntityFormat = {};\n\n    wrapper.classList.forEach(name => {\n        isEntity = parseEntityClassName(name, format) || isEntity;\n    });\n\n    if (!isEntity) {\n        format.isFakeEntity = true;\n        format.isReadonly = !wrapper.isContentEditable;\n    }\n\n    return format;\n}\n\n/**\n * Parse entity class names from entity wrapper element\n * @param className Class names of entity\n * @param format The output entity format object\n */\nfunction parseEntityClassName(\n    className: string,\n    format: ContentModelEntityFormat\n): boolean | undefined {\n    if (className == ENTITY_INFO_NAME) {\n        return true;\n    } else if (className.indexOf(ENTITY_TYPE_PREFIX) == 0) {\n        format.entityType = className.substring(ENTITY_TYPE_PREFIX.length);\n    } else if (className.indexOf(ENTITY_ID_PREFIX) == 0) {\n        format.id = className.substring(ENTITY_ID_PREFIX.length);\n    } else if (className.indexOf(ENTITY_READONLY_PREFIX) == 0) {\n        format.isReadonly = className.substring(ENTITY_READONLY_PREFIX.length) == '1';\n    }\n}\n\n/**\n * Generate Entity class names for an entity wrapper\n * @param format The source entity format object\n * @returns A combined CSS class name string for entity wrapper\n */\nexport function generateEntityClassNames(format: ContentModelEntityFormat): string {\n    return format.isFakeEntity\n        ? ''\n        : `${ENTITY_INFO_NAME} ${ENTITY_TYPE_PREFIX}${format.entityType ?? ''} ${\n              format.id ? `${ENTITY_ID_PREFIX}${format.id} ` : ''\n          }${ENTITY_READONLY_PREFIX}${format.isReadonly ? '1' : '0'}`;\n}\n\n/**\n * Checks whether the node provided is a Entity delimiter\n * @param node the node to check\n * @return true if it is a delimiter\n */\nexport function isEntityDelimiter(element: HTMLElement): boolean {\n    return (\n        isElementOfType(element, 'span') &&\n        (element.classList.contains(DELIMITER_AFTER) ||\n            element.classList.contains(DELIMITER_BEFORE)) &&\n        element.textContent === ZERO_WIDTH_SPACE\n    );\n}\n\n/**\n * Adds delimiters to the element provided. If the delimiters already exists, will not be added\n * @param element the node to add the delimiters\n * @param format format to set to the delimiters, so when typing inside of one the format is not lost\n * @param context Model to Dom context to use.\n */\nexport function addDelimiters(\n    doc: Document,\n    element: HTMLElement,\n    format?: ContentModelSegmentFormat | null,\n    context?: ModelToDomContext\n): HTMLElement[] {\n    let [delimiterAfter, delimiterBefore] = getDelimiters(element);\n\n    if (!delimiterAfter) {\n        delimiterAfter = insertDelimiter(doc, element, true /*isAfter*/);\n        if (context && format) {\n            applyFormat(delimiterAfter, context.formatAppliers.segment, format, context);\n        }\n    }\n\n    if (!delimiterBefore) {\n        delimiterBefore = insertDelimiter(doc, element, false /*isAfter*/);\n        if (context && format) {\n            applyFormat(delimiterBefore, context.formatAppliers.segment, format, context);\n        }\n    }\n\n    return [delimiterAfter, delimiterBefore];\n}\n\nfunction getDelimiters(entityWrapper: HTMLElement): (HTMLElement | undefined)[] {\n    const result: (HTMLElement | undefined)[] = [];\n    const { nextElementSibling, previousElementSibling } = entityWrapper;\n    result.push(\n        isDelimiter(nextElementSibling, DELIMITER_AFTER),\n        isDelimiter(previousElementSibling, DELIMITER_BEFORE)\n    );\n\n    return result;\n}\n\nfunction isDelimiter(el: Element | null, className: string): HTMLElement | undefined {\n    return el?.classList.contains(className) && el.textContent == ZERO_WIDTH_SPACE\n        ? (el as HTMLElement)\n        : undefined;\n}\n\nfunction insertDelimiter(doc: Document, element: Element, isAfter: boolean) {\n    const span = doc.createElement('span');\n\n    span.className = isAfter ? DELIMITER_AFTER : DELIMITER_BEFORE;\n    span.appendChild(doc.createTextNode(ZERO_WIDTH_SPACE));\n    element.parentNode?.insertBefore(span, isAfter ? element.nextSibling : element);\n\n    return span;\n}\n","/**\n * Provide a strong-typed version of Object.keys()\n * @param obj The source object\n * @returns Array of keys\n */\nexport function getObjectKeys<T extends string | number | symbol>(\n    obj: Record<T, any> | Partial<Record<T, any>>\n): T[] {\n    return Object.keys(obj) as T[];\n}\n","/**\n * Check if the given element is of the type that we are checking according to its tag name\n * @param element The element to check\n * @param tag The HTML tag name to check\n * @returns True if the element has the given tag, otherwise false\n */\nexport function isElementOfType<Tag extends keyof HTMLElementTagNameMap>(\n    element: HTMLElement,\n    tag: Tag\n): element is HTMLElementTagNameMap[Tag] {\n    return element?.tagName?.toLocaleLowerCase() == tag;\n}\n","/**\n * A type map from node type number to its type declaration. This is used by utility function isNodeOfType()\n */\nexport interface NodeTypeMap {\n    /**\n     * Attribute node\n     */\n    ATTRIBUTE_NODE: Attr;\n\n    /**\n     * Comment node\n     */\n    COMMENT_NODE: Comment;\n\n    /**\n     * DocumentFragment node\n     */\n    DOCUMENT_FRAGMENT_NODE: DocumentFragment;\n\n    /**\n     * Document node\n     */\n    DOCUMENT_NODE: Document;\n\n    /**\n     * DocumentType node\n     */\n    DOCUMENT_TYPE_NODE: DocumentType;\n\n    /**\n     * HTMLElement node\n     */\n    ELEMENT_NODE: HTMLElement;\n\n    /**\n     * ProcessingInstruction node\n     */\n    PROCESSING_INSTRUCTION_NODE: ProcessingInstruction;\n\n    /**\n     * Text node\n     */\n    TEXT_NODE: Text;\n}\n\n/**\n * Type checker for Node. Return true if it of the specified node type\n * @param node The node to check\n * @param expectedType The type to check\n */\nexport function isNodeOfType<T extends keyof NodeTypeMap>(\n    node: Node | null | undefined,\n    expectedType: T\n): node is NodeTypeMap[T] {\n    return !!node && node.nodeType == Node[expectedType];\n}\n","// According to https://developer.mozilla.org/en-US/docs/Web/CSS/white-space, these style values will need to preserve white spaces\nconst WHITESPACE_PRE_VALUES = ['pre', 'pre-wrap', 'break-spaces'];\n\n/**\n * Check if the given white-space style value will cause preserving white space\n * @param whiteSpace The white-space style value to check\n */\nexport function isWhiteSpacePreserved(whiteSpace: string | undefined): boolean {\n    return !!whiteSpace && WHITESPACE_PRE_VALUES.indexOf(whiteSpace) >= 0;\n}\n","import { validate } from './validate';\nimport type { ContentModelWithDataset, Definition } from 'roosterjs-content-model-types';\n\nconst EditingInfoDatasetName = 'editingInfo';\n\n/**\n * Update metadata of the given model\n * @param model The model to update metadata to\n * @param callback A callback function to update metadata\n * @param definition @optional Metadata definition used for verify the metadata object\n * @returns The metadata object if any, or null\n */\nexport function updateMetadata<T>(\n    model: ContentModelWithDataset<T>,\n    callback?: (metadata: T | null) => T | null,\n    definition?: Definition<T>\n): T | null {\n    const metadataString = model.dataset[EditingInfoDatasetName];\n    let obj: T | null = null;\n\n    try {\n        obj = JSON.parse(metadataString) as T;\n    } catch {}\n\n    if (definition && !validate(obj, definition)) {\n        obj = null;\n    }\n\n    if (callback) {\n        obj = callback(obj);\n\n        if (!obj) {\n            delete model.dataset[EditingInfoDatasetName];\n        } else if (!definition || validate(obj, definition)) {\n            model.dataset[EditingInfoDatasetName] = JSON.stringify(obj);\n        }\n    }\n\n    return obj;\n}\n\n/**\n * Check if the given model has metadata\n * @param model The content model to check\n */\nexport function hasMetadata<T>(model: ContentModelWithDataset<T> | HTMLElement): boolean {\n    return !!model.dataset[EditingInfoDatasetName];\n}\n","import { getObjectKeys } from '../getObjectKeys';\nimport type { Definition } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Validate the given object with a type definition object\n * @param input The object to validate\n * @param def The type definition object used for validation\n * @returns True if the object passed the validation, otherwise false\n */\nexport function validate<T>(input: any, def: Definition<T>): input is T {\n    let result = false;\n    if ((def.isOptional && typeof input === 'undefined') || (def.allowNull && input === null)) {\n        result = true;\n    } else if (\n        (!def.isOptional && typeof input === 'undefined') ||\n        (!def.allowNull && input === null)\n    ) {\n        return false;\n    } else {\n        switch (def.type) {\n            case 'string':\n                result =\n                    typeof input === 'string' &&\n                    (typeof def.value === 'undefined' || input === def.value);\n                break;\n\n            case 'number':\n                result =\n                    typeof input === 'number' &&\n                    (typeof def.value === 'undefined' || areSameNumbers(def.value, input)) &&\n                    (typeof def.minValue === 'undefined' || input >= def.minValue) &&\n                    (typeof def.maxValue === 'undefined' || input <= def.maxValue);\n                break;\n\n            case 'boolean':\n                result =\n                    typeof input === 'boolean' &&\n                    (typeof def.value === 'undefined' || input === def.value);\n                break;\n\n            case 'array':\n                result =\n                    Array.isArray(input) &&\n                    (typeof def.minLength === 'undefined' || input.length >= def.minLength) &&\n                    (typeof def.maxLength === 'undefined' || input.length <= def.maxLength) &&\n                    input.every(x => validate(x, def.itemDef));\n                break;\n\n            case 'object':\n                result =\n                    typeof input === 'object' &&\n                    getObjectKeys(def.propertyDef).every(x =>\n                        validate(input[x], def.propertyDef[x])\n                    );\n                break;\n        }\n    }\n\n    return result;\n}\n\nfunction areSameNumbers(n1: number, n2: number) {\n    return Math.abs(n1 - n2) < 1e-3;\n}\n","/**\n * Replace all child nodes of the given target node to the child nodes of source node.\n * @param target Target node, all child nodes of this node will be removed if keepExistingChildren is not set to true\n * @param source (Optional) source node, all child nodes of this node will be move to target node\n * @param keepExistingChildren (Optional) When set to true, all existing child nodes of target will be kept\n */\nexport function moveChildNodes(target: Node, source?: Node, keepExistingChildren?: boolean) {\n    if (!target) {\n        return;\n    }\n\n    while (!keepExistingChildren && target.firstChild) {\n        target.removeChild(target.firstChild);\n    }\n\n    while (source?.firstChild) {\n        target.appendChild(source.firstChild);\n    }\n}\n\n/**\n * Wrap all child nodes of the given parent element using a new element with the given tag name\n * @param parent The parent element\n * @param tagName The tag name of new wrapper\n * @returns New wrapper element\n */\nexport function wrapAllChildNodes<T extends keyof HTMLElementTagNameMap>(\n    parent: HTMLElement,\n    tagName: T\n): HTMLElementTagNameMap[T] {\n    const newElement = parent.ownerDocument.createElement(tagName);\n\n    moveChildNodes(newElement, parent);\n    parent.appendChild(newElement);\n\n    return newElement;\n}\n","import { isEntityElement } from './entityUtils';\n\n/**\n * When set a DOM tree into editor, reuse the existing element in editor and no need to change it\n * @param param Parent node of the reused element\n * @param element The element to keep in parent node\n * @param refNode Reference node, it is point to current node that is being processed. It must be a child of parent node, or null.\n * We will start processing from this node, if it is not the same with element, remove it and keep processing its next sibling,\n * until we see an element that is the same with the passed in element or null.\n * @returns The new reference element\n */\nexport function reuseCachedElement(parent: Node, element: Node, refNode: Node | null): Node | null {\n    if (element.parentNode == parent) {\n        const isEntity = isEntityElement(element);\n\n        // Remove nodes before the one we are hitting since they don't appear in Content Model at this position.\n        // But we don't want to touch entity since it would better to keep entity at its place unless it is removed\n        // In that case we will remove it after we have handled all other nodes\n        while (refNode && refNode != element && (isEntity || !isEntityElement(refNode))) {\n            const next = refNode.nextSibling;\n\n            refNode.parentNode?.removeChild(refNode);\n            refNode = next;\n        }\n\n        if (refNode && refNode == element) {\n            refNode = refNode.nextSibling;\n        } else {\n            parent.insertBefore(element, refNode);\n        }\n    } else {\n        parent.insertBefore(element, refNode);\n    }\n\n    return refNode;\n}\n\n/**\n * @internal\n */\nexport function removeNode(node: Node): Node | null {\n    const next = node.nextSibling;\n    node.parentNode?.removeChild(node);\n\n    return next;\n}\n","/**\n * Convert a named node map to an array\n * @param collection The map to convert\n */\nexport default function toArray(collection: NamedNodeMap): Attr[];\n\n/**\n * Convert a named node map to an array\n * @param collection The map to convert\n */\nexport default function toArray(collection: DataTransferItemList): DataTransferItem[];\n\n/**\n * Convert a collection to an array\n * @param collection The collection to convert\n */\nexport default function toArray<T extends Node>(collection: NodeListOf<T>): T[];\n\n/**\n * Convert a collection to an array\n * @param collection The collection to convert\n */\nexport default function toArray<T extends Element>(collection: HTMLCollectionOf<T>): T[];\n\n/**\n * Convert an array to an array.\n * This is to satisfy typescript compiler. For some cases the object can be a collection at runtime,\n * but the declaration is an array. e.g. ClipboardData.types\n * @param array The array to convert\n */\nexport default function toArray<T>(array: readonly T[]): T[];\n\nexport default function toArray(collection: any): any[] {\n    return [].slice.call(collection);\n}\n","/**\n * @internal\n * Removes the node and keep all children in place, return the parentNode where the children are attached\n * @param node the node to remove\n */\nexport function unwrap(node: Node): Node | null {\n    // Unwrap requires a parentNode\n    const parentNode = node ? node.parentNode : null;\n\n    if (!parentNode) {\n        return null;\n    }\n\n    while (node.firstChild) {\n        parentNode.insertBefore(node.firstChild, node);\n    }\n\n    parentNode.removeChild(node);\n    return parentNode;\n}\n","/**\n * Wrap the given node with a new element, put the wrapper node under the parent of the first node\n * and return the wrapper element.\n * @param doc Parent document object\n * @param node The node to wrap\n * @param wrapperTag The tag of wrapper HTML element\n * @returns The wrapper element\n */\nexport function wrap<T extends keyof HTMLElementTagNameMap>(\n    doc: Document,\n    node: Node,\n    wrapperTag: T\n): HTMLElementTagNameMap[T] {\n    const wrapper = doc.createElement(wrapperTag);\n    node.parentNode?.insertBefore(wrapper, node);\n    wrapper.appendChild(node);\n\n    return wrapper;\n}\n","import type { DirectionFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const directionFormatHandler: FormatHandler<DirectionFormat> = {\n    parse: (format, element, _, defaultStyle) => {\n        const dir = element.style.direction || element.dir || defaultStyle.direction;\n\n        if (dir) {\n            format.direction = dir == 'rtl' ? 'rtl' : 'ltr';\n        }\n    },\n    apply: (format, element) => {\n        if (format.direction) {\n            element.style.direction = format.direction;\n        }\n    },\n};\n","import type { DisplayFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const displayFormatHandler: FormatHandler<DisplayFormat> = {\n    parse: (format, element) => {\n        const display = element.style.display;\n\n        if (display) {\n            format.display = display;\n        }\n    },\n    apply: (format, element) => {\n        if (format.display) {\n            element.style.display = format.display;\n        }\n    },\n};\n","import { calcAlign, ResultMap } from '../utils/dir';\nimport { directionFormatHandler } from './directionFormatHandler';\nimport type {\n    DirectionFormat,\n    HtmlAlignFormat,\n    TextAlignFormat,\n} from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const htmlAlignFormatHandler: FormatHandler<\n    DirectionFormat & HtmlAlignFormat & TextAlignFormat\n> = {\n    parse: (format, element, context, defaultStyle) => {\n        directionFormatHandler.parse(format, element, context, defaultStyle);\n\n        const htmlAlign = element.getAttribute('align');\n\n        if (htmlAlign) {\n            format.htmlAlign = calcAlign(htmlAlign, format.direction);\n            delete format.textAlign;\n            delete context.blockFormat.textAlign;\n        }\n    },\n    apply: (format, element) => {\n        const dir: 'ltr' | 'rtl' = format.direction == 'rtl' ? 'rtl' : 'ltr';\n\n        if (format.htmlAlign) {\n            element.setAttribute('align', ResultMap[format.htmlAlign][dir]);\n        }\n    },\n};\n","import type { FormatHandler } from '../FormatHandler';\nimport type { LineHeightFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const lineHeightFormatHandler: FormatHandler<LineHeightFormat> = {\n    parse: (format, element, context, defaultStyle) => {\n        const lineHeight = element.style.lineHeight || defaultStyle.lineHeight;\n\n        if (lineHeight && lineHeight != 'inherit') {\n            format.lineHeight = lineHeight;\n        }\n    },\n    apply: (format, element) => {\n        if (format.lineHeight) {\n            element.style.lineHeight = format.lineHeight;\n        }\n    },\n};\n","import { parseValueWithUnit } from '../utils/parseValueWithUnit';\nimport type { FormatHandler } from '../FormatHandler';\nimport type { MarginFormat } from 'roosterjs-content-model-types';\n\nconst MarginKeys: (keyof MarginFormat & keyof CSSStyleDeclaration)[] = [\n    'marginTop',\n    'marginRight',\n    'marginBottom',\n    'marginLeft',\n];\n\n/**\n * @internal\n */\nexport const marginFormatHandler: FormatHandler<MarginFormat> = {\n    parse: (format, element, _, defaultStyle) => {\n        MarginKeys.forEach(key => {\n            const value = element.style[key] || defaultStyle[key];\n\n            if (value) {\n                switch (key) {\n                    case 'marginTop':\n                    case 'marginBottom':\n                        format[key] = value;\n                        break;\n\n                    case 'marginLeft':\n                    case 'marginRight':\n                        format[key] = format[key]\n                            ? parseValueWithUnit(format[key] || '', element) +\n                              parseValueWithUnit(value, element) +\n                              'px'\n                            : value;\n                        break;\n                }\n            }\n        });\n    },\n    apply: (format, element, context) => {\n        MarginKeys.forEach(key => {\n            const value = format[key];\n\n            if (value != context.implicitFormat[key]) {\n                element.style[key] = value || '0';\n            }\n        });\n    },\n};\n","import { directionFormatHandler } from './directionFormatHandler';\nimport type { FormatHandler } from '../FormatHandler';\nimport type { DirectionFormat, PaddingFormat } from 'roosterjs-content-model-types';\n\nconst PaddingKeys: (keyof PaddingFormat & keyof CSSStyleDeclaration)[] = [\n    'paddingTop',\n    'paddingRight',\n    'paddingBottom',\n    'paddingLeft',\n];\n\nconst AlternativeKeyLtr: Partial<Record<\n    keyof PaddingFormat,\n    keyof CSSStyleDeclaration | undefined\n>> = {\n    paddingLeft: 'paddingInlineStart',\n};\n\nconst AlternativeKeyRtl: Partial<Record<\n    keyof PaddingFormat,\n    keyof CSSStyleDeclaration | undefined\n>> = {\n    paddingRight: 'paddingInlineStart',\n};\n\n/**\n * @internal\n */\nexport const paddingFormatHandler: FormatHandler<PaddingFormat & DirectionFormat> = {\n    parse: (format, element, context, defaultStyle) => {\n        directionFormatHandler.parse(format, element, context, defaultStyle);\n\n        PaddingKeys.forEach(key => {\n            let value = element.style[key];\n            const alterativeKey = (format.direction == 'rtl'\n                ? AlternativeKeyRtl\n                : AlternativeKeyLtr)[key];\n            const defaultValue: string =\n                (defaultStyle[key] ??\n                    (alterativeKey ? defaultStyle[alterativeKey] : undefined) ??\n                    '0px') + '';\n\n            if (!value) {\n                value = defaultValue;\n            }\n\n            if (!value || value == '0') {\n                value = '0px';\n            }\n\n            if (value && value != defaultValue) {\n                format[key] = value;\n            }\n        });\n    },\n    apply: (format, element, context) => {\n        PaddingKeys.forEach(key => {\n            const value = format[key];\n            let defaultValue: string | undefined = undefined;\n\n            if (element.tagName == 'OL' || element.tagName == 'UL') {\n                if (\n                    (format.direction == 'rtl' && key == 'paddingRight') ||\n                    (format.direction != 'rtl' && key == 'paddingLeft')\n                ) {\n                    defaultValue = '40px';\n                }\n            }\n\n            if (value && value != defaultValue) {\n                element.style[key] = value;\n            }\n        });\n    },\n};\n","import { calcAlign, ResultMap } from '../utils/dir';\nimport { directionFormatHandler } from './directionFormatHandler';\nimport type { DirectionFormat, TextAlignFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const textAlignFormatHandler: FormatHandler<DirectionFormat & TextAlignFormat> = {\n    parse: (format, element, context, defaultStyle) => {\n        directionFormatHandler.parse(format, element, context, defaultStyle);\n\n        let textAlign = element.style.textAlign || defaultStyle.textAlign;\n\n        if (\n            element.tagName == 'LI' &&\n            element.parentElement?.style.display === 'flex' &&\n            element.parentElement.style.flexDirection === 'column' &&\n            element.style.alignSelf\n        ) {\n            // For LI element with flex style applied, we use its \"align-self\" style value instead since LI has a different implementation for align\n            textAlign = element.style.alignSelf;\n        }\n\n        if (textAlign) {\n            format.textAlign = calcAlign(textAlign, format.direction);\n        }\n    },\n    apply: (format, element) => {\n        const dir: 'ltr' | 'rtl' = format.direction == 'rtl' ? 'rtl' : 'ltr';\n\n        if (format.textAlign) {\n            const parent = element.parentElement;\n            const parentTag = parent?.tagName;\n\n            if (element.tagName == 'LI' && parent && (parentTag == 'OL' || parentTag == 'UL')) {\n                element.style.alignSelf = format.textAlign;\n                element.parentElement.style.flexDirection = 'column';\n                element.parentElement.style.display = 'flex';\n            } else {\n                element.style.textAlign = ResultMap[format.textAlign][dir];\n            }\n        }\n    },\n};\n","import type { FormatHandler } from '../FormatHandler';\nimport type { TextIndentFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const textIndentFormatHandler: FormatHandler<TextIndentFormat> = {\n    parse: (format, element) => {\n        const textIndent = element.style.textIndent;\n\n        if (textIndent) {\n            format.textIndent = textIndent;\n        }\n    },\n    apply: (format, element) => {\n        if (format.textIndent) {\n            element.style.textIndent = format.textIndent;\n        }\n    },\n};\n","import { shouldSetValue } from '../utils/shouldSetValue';\nimport type { FormatHandler } from '../FormatHandler';\nimport type { WhiteSpaceFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const whiteSpaceFormatHandler: FormatHandler<WhiteSpaceFormat> = {\n    parse: (format, element, _, defaultStyle) => {\n        const whiteSpace = element.style.whiteSpace || defaultStyle.whiteSpace;\n\n        if (shouldSetValue(whiteSpace, 'normal', format.whiteSpace, defaultStyle.whiteSpace)) {\n            format.whiteSpace = whiteSpace;\n        }\n    },\n    apply: (format, element, context) => {\n        const whiteSpace = context.implicitFormat.whiteSpace;\n        if (format.whiteSpace != whiteSpace) {\n            element.style.whiteSpace = format.whiteSpace || 'normal';\n        }\n    },\n};\n","import { getColor, setColor } from '../utils/color';\nimport { shouldSetValue } from '../utils/shouldSetValue';\nimport type { BackgroundColorFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const backgroundColorFormatHandler: FormatHandler<BackgroundColorFormat> = {\n    parse: (format, element, context, defaultStyle) => {\n        const backgroundColor =\n            getColor(\n                element,\n                true /*isBackground*/,\n                !!context.isDarkMode,\n                context.darkColorHandler\n            ) || defaultStyle.backgroundColor;\n\n        if (\n            shouldSetValue(\n                backgroundColor,\n                'transparent',\n                undefined /*existingValue*/,\n                defaultStyle.backgroundColor\n            )\n        ) {\n            format.backgroundColor = backgroundColor;\n        }\n    },\n    apply: (format, element, context) => {\n        if (format.backgroundColor) {\n            setColor(\n                element,\n                format.backgroundColor,\n                true /*isBackground*/,\n                !!context.isDarkMode,\n                context.darkColorHandler\n            );\n        }\n    },\n};\n","import type { BorderBoxFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const borderBoxFormatHandler: FormatHandler<BorderBoxFormat> = {\n    parse: (format, element) => {\n        if (element.style?.boxSizing == 'border-box') {\n            format.useBorderBox = true;\n        }\n    },\n    apply: (format, element) => {\n        if (format.useBorderBox) {\n            element.style.boxSizing = 'border-box';\n        }\n    },\n};\n","import type { BorderFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * Keys of border items\n */\nexport const BorderKeys: (keyof BorderFormat & keyof CSSStyleDeclaration)[] = [\n    'borderTop',\n    'borderRight',\n    'borderBottom',\n    'borderLeft',\n];\n\n// This array needs to match BorderKeys array\nconst BorderWidthKeys: (keyof CSSStyleDeclaration)[] = [\n    'borderTopWidth',\n    'borderRightWidth',\n    'borderBottomWidth',\n    'borderLeftWidth',\n];\n\nconst BorderRadiusKeys: (keyof BorderFormat & keyof CSSStyleDeclaration)[] = [\n    'borderTopLeftRadius',\n    'borderTopRightRadius',\n    'borderBottomLeftRadius',\n    'borderBottomRightRadius',\n];\n\nconst AllKeys = BorderKeys.concat(BorderRadiusKeys);\n\n/**\n * @internal\n */\nexport const borderFormatHandler: FormatHandler<BorderFormat> = {\n    parse: (format, element, _, defaultStyle) => {\n        BorderKeys.forEach((key, i) => {\n            const value = element.style[key];\n            const defaultWidth = defaultStyle[BorderWidthKeys[i]] ?? '0px';\n            let width = element.style[BorderWidthKeys[i]];\n\n            if (width == '0') {\n                width = '0px';\n            }\n\n            if (value && width != defaultWidth) {\n                format[key] = value == 'none' ? '' : value;\n            }\n        });\n\n        const borderRadius = element.style.borderRadius;\n\n        if (borderRadius) {\n            format.borderRadius = borderRadius;\n        } else {\n            BorderRadiusKeys.forEach(key => {\n                const value = element.style[key];\n\n                if (value) {\n                    format[key] = value;\n                }\n            });\n        }\n    },\n    apply: (format, element) => {\n        AllKeys.forEach(key => {\n            const value = format[key];\n\n            if (value) {\n                element.style[key] = value;\n            }\n        });\n\n        if (format.borderRadius) {\n            element.style.borderRadius = format.borderRadius;\n        }\n    },\n};\n","import type { BoxShadowFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const boxShadowFormatHandler: FormatHandler<BoxShadowFormat> = {\n    parse: (format, element) => {\n        if (element.style?.boxShadow) {\n            format.boxShadow = element.style.boxShadow;\n        }\n    },\n    apply: (format, element) => {\n        if (format.boxShadow) {\n            element.style.boxShadow = format.boxShadow;\n        }\n    },\n};\n","import { getObjectKeys } from '../../domUtils/getObjectKeys';\nimport type { DatasetFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const datasetFormatHandler: FormatHandler<DatasetFormat> = {\n    parse: (format, element) => {\n        const dataset = element.dataset;\n\n        getObjectKeys(dataset).forEach(key => {\n            format[key] = dataset[key] || '';\n        });\n    },\n\n    apply: (format, element) => {\n        getObjectKeys(format).forEach(key => {\n            element.dataset[key] = format[key];\n        });\n    },\n};\n","import type { FloatFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const floatFormatHandler: FormatHandler<FloatFormat> = {\n    parse: (format, element) => {\n        const float = element.style.float || element.getAttribute('align');\n\n        if (float) {\n            format.float = float;\n        }\n    },\n    apply: (format, element) => {\n        if (format.float) {\n            element.style.float = format.float;\n        }\n    },\n};\n","import type { FormatHandler } from '../FormatHandler';\nimport type { IdFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const idFormatHandler: FormatHandler<IdFormat> = {\n    parse: (format, element) => {\n        if (element.id) {\n            format.id = element.id;\n        }\n    },\n    apply: (format, element) => {\n        if (format.id) {\n            element.id = format.id;\n        }\n    },\n};\n","import type { FormatHandler } from '../FormatHandler';\nimport type { SizeFormat } from 'roosterjs-content-model-types';\n\nconst PercentageRegex = /[\\d\\.]+%/;\n\n/**\n * @internal\n */\nexport const sizeFormatHandler: FormatHandler<SizeFormat> = {\n    parse: (format, element, context) => {\n        const width = element.style.width || tryParseSize(element, 'width');\n        const height = element.style.height || tryParseSize(element, 'height');\n        const maxWidth = element.style.maxWidth;\n        const maxHeight = element.style.maxHeight;\n        const minWidth = element.style.minWidth;\n        const minHeight = element.style.minHeight;\n\n        if (width) {\n            format.width = width;\n        }\n        if (height) {\n            format.height = height;\n        }\n        if (maxWidth) {\n            format.maxWidth = maxWidth;\n        }\n        if (maxHeight) {\n            format.maxHeight = maxHeight;\n        }\n        if (minWidth) {\n            format.minWidth = minWidth;\n        }\n        if (minHeight) {\n            format.minHeight = minHeight;\n        }\n    },\n    apply: (format, element) => {\n        if (format.width) {\n            element.style.width = format.width;\n        }\n        if (format.height) {\n            element.style.height = format.height;\n        }\n        if (format.maxWidth) {\n            element.style.maxWidth = format.maxWidth;\n        }\n        if (format.maxHeight) {\n            element.style.maxHeight = format.maxHeight;\n        }\n        if (format.minWidth) {\n            element.style.minWidth = format.minWidth;\n        }\n        if (format.minHeight) {\n            element.style.minHeight = format.minHeight;\n        }\n    },\n};\n\nfunction tryParseSize(element: HTMLElement, attrName: 'width' | 'height'): string | undefined {\n    const attrValue = element.getAttribute(attrName);\n    const value = parseInt(attrValue || '');\n\n    return attrValue && PercentageRegex.test(attrValue)\n        ? attrValue\n        : Number.isNaN(value) || value == 0\n        ? undefined\n        : value + 'px';\n}\n","import type { FormatHandler } from '../FormatHandler';\nimport type { VerticalAlignFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const verticalAlignFormatHandler: FormatHandler<VerticalAlignFormat> = {\n    parse: (format, element) => {\n        const align = element.style.verticalAlign || element.getAttribute('valign');\n\n        switch (align) {\n            case 'baseline':\n            case 'initial':\n            case 'super':\n            case 'sub':\n            case 'text-top':\n            case 'text-bottom':\n            case 'top':\n                format.verticalAlign = 'top';\n                break;\n\n            case 'bottom':\n                format.verticalAlign = 'bottom';\n                break;\n\n            case 'middle':\n                format.verticalAlign = 'middle';\n                break;\n        }\n    },\n    apply: (format, element) => {\n        if (format.verticalAlign) {\n            element.style.verticalAlign = format.verticalAlign;\n        }\n    },\n};\n","import type { FormatHandler } from '../FormatHandler';\nimport type { WordBreakFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const wordBreakFormatHandler: FormatHandler<WordBreakFormat> = {\n    parse: (format, element, _, defaultStyle) => {\n        const wordBreak = element.style.wordBreak || defaultStyle.wordBreak;\n\n        if (wordBreak) {\n            format.wordBreak = wordBreak;\n        }\n    },\n    apply: (format, element) => {\n        if (format.wordBreak) {\n            element.style.wordBreak = format.wordBreak;\n        }\n    },\n};\n","import { backgroundColorFormatHandler } from './common/backgroundColorFormatHandler';\nimport { boldFormatHandler } from './segment/boldFormatHandler';\nimport { borderBoxFormatHandler } from './common/borderBoxFormatHandler';\nimport { borderFormatHandler } from './common/borderFormatHandler';\nimport { boxShadowFormatHandler } from './common/boxShadowFormatHandler';\nimport { datasetFormatHandler } from './common/datasetFormatHandler';\nimport { directionFormatHandler } from './block/directionFormatHandler';\nimport { displayFormatHandler } from './block/displayFormatHandler';\nimport { entityFormatHandler } from './entity/entityFormatHandler';\nimport { floatFormatHandler } from './common/floatFormatHandler';\nimport { fontFamilyFormatHandler } from './segment/fontFamilyFormatHandler';\nimport { fontSizeFormatHandler } from './segment/fontSizeFormatHandler';\nimport { getObjectKeys } from '../domUtils/getObjectKeys';\nimport { htmlAlignFormatHandler } from './block/htmlAlignFormatHandler';\nimport { idFormatHandler } from './common/idFormatHandler';\nimport { italicFormatHandler } from './segment/italicFormatHandler';\nimport { letterSpacingFormatHandler } from './segment/letterSpacingFormatHandler';\nimport { lineHeightFormatHandler } from './block/lineHeightFormatHandler';\nimport { linkFormatHandler } from './segment/linkFormatHandler';\nimport { listItemThreadFormatHandler } from './list/listItemThreadFormatHandler';\nimport { listLevelThreadFormatHandler } from './list/listLevelThreadFormatHandler';\nimport { listStyleFormatHandler } from './list/listStyleFormatHandler';\nimport { marginFormatHandler } from './block/marginFormatHandler';\nimport { paddingFormatHandler } from './block/paddingFormatHandler';\nimport { sizeFormatHandler } from './common/sizeFormatHandler';\nimport { strikeFormatHandler } from './segment/strikeFormatHandler';\nimport { superOrSubScriptFormatHandler } from './segment/superOrSubScriptFormatHandler';\nimport { tableLayoutFormatHandler } from './table/tableLayoutFormatHandler';\nimport { tableSpacingFormatHandler } from './table/tableSpacingFormatHandler';\nimport { textAlignFormatHandler } from './block/textAlignFormatHandler';\nimport { textColorFormatHandler } from './segment/textColorFormatHandler';\nimport { textColorOnTableCellFormatHandler } from './table/textColorOnTableCellFormatHandler';\nimport { textIndentFormatHandler } from './block/textIndentFormatHandler';\nimport { underlineFormatHandler } from './segment/underlineFormatHandler';\nimport { verticalAlignFormatHandler } from './common/verticalAlignFormatHandler';\nimport { whiteSpaceFormatHandler } from './block/whiteSpaceFormatHandler';\nimport { wordBreakFormatHandler } from './common/wordBreakFormatHandler';\nimport type { FormatHandler } from './FormatHandler';\nimport type {\n    ContentModelFormatMap,\n    FormatApplier,\n    FormatAppliers,\n    FormatHandlerTypeMap,\n    FormatKey,\n    FormatParser,\n    FormatParsers,\n} from 'roosterjs-content-model-types';\n\ntype FormatHandlers = {\n    [Key in FormatKey]: FormatHandler<FormatHandlerTypeMap[Key]>;\n};\n\nconst defaultFormatHandlerMap: FormatHandlers = {\n    backgroundColor: backgroundColorFormatHandler,\n    bold: boldFormatHandler,\n    border: borderFormatHandler,\n    borderBox: borderBoxFormatHandler,\n    boxShadow: boxShadowFormatHandler,\n    dataset: datasetFormatHandler,\n    direction: directionFormatHandler,\n    display: displayFormatHandler,\n    float: floatFormatHandler,\n    fontFamily: fontFamilyFormatHandler,\n    fontSize: fontSizeFormatHandler,\n    entity: entityFormatHandler,\n    htmlAlign: htmlAlignFormatHandler,\n    id: idFormatHandler,\n    italic: italicFormatHandler,\n    letterSpacing: letterSpacingFormatHandler,\n    lineHeight: lineHeightFormatHandler,\n    link: linkFormatHandler,\n    listItemThread: listItemThreadFormatHandler,\n    listLevelThread: listLevelThreadFormatHandler,\n    listStyle: listStyleFormatHandler,\n    margin: marginFormatHandler,\n    padding: paddingFormatHandler,\n    size: sizeFormatHandler,\n    strike: strikeFormatHandler,\n    superOrSubScript: superOrSubScriptFormatHandler,\n    tableLayout: tableLayoutFormatHandler,\n    tableSpacing: tableSpacingFormatHandler,\n    textAlign: textAlignFormatHandler,\n    textColor: textColorFormatHandler,\n    textColorOnTableCell: textColorOnTableCellFormatHandler,\n    textIndent: textIndentFormatHandler,\n    underline: underlineFormatHandler,\n    verticalAlign: verticalAlignFormatHandler,\n    whiteSpace: whiteSpaceFormatHandler,\n    wordBreak: wordBreakFormatHandler,\n};\n\nconst styleBasedSegmentFormats: (keyof FormatHandlerTypeMap)[] = [\n    'letterSpacing',\n    'fontFamily',\n    'fontSize',\n];\n\nconst elementBasedSegmentFormats: (keyof FormatHandlerTypeMap)[] = [\n    'strike',\n    'underline',\n    'superOrSubScript',\n    'italic',\n    'bold',\n];\nconst sharedBlockFormats: (keyof FormatHandlerTypeMap)[] = [\n    'direction',\n    'textAlign',\n    'textIndent',\n    'lineHeight',\n    'whiteSpace',\n];\nconst sharedContainerFormats: (keyof FormatHandlerTypeMap)[] = [\n    'backgroundColor',\n    'margin',\n    'padding',\n    'border',\n];\n\n/**\n * @internal\n */\nexport const defaultFormatKeysPerCategory: {\n    [key in keyof ContentModelFormatMap]: (keyof FormatHandlerTypeMap)[];\n} = {\n    block: sharedBlockFormats,\n    listItemThread: ['listItemThread'],\n    listLevelThread: ['listLevelThread'],\n    listItemElement: [\n        ...sharedBlockFormats,\n        'direction',\n        'textAlign',\n        'lineHeight',\n        'margin',\n        'listStyle',\n    ],\n    listLevel: ['direction', 'textAlign', 'margin', 'padding', 'listStyle', 'backgroundColor'],\n    styleBasedSegment: [...styleBasedSegmentFormats, 'textColor', 'backgroundColor', 'lineHeight'],\n    elementBasedSegment: elementBasedSegmentFormats,\n    segment: [\n        ...styleBasedSegmentFormats,\n        ...elementBasedSegmentFormats,\n        'textColor',\n        'backgroundColor',\n        'lineHeight',\n    ],\n    segmentOnBlock: [...styleBasedSegmentFormats, ...elementBasedSegmentFormats, 'textColor'],\n    segmentOnTableCell: [\n        ...styleBasedSegmentFormats,\n        ...elementBasedSegmentFormats,\n        'textColorOnTableCell',\n    ],\n    tableCell: [\n        'border',\n        'backgroundColor',\n        'padding',\n        'verticalAlign',\n        'wordBreak',\n        'textColor',\n        'htmlAlign',\n        'size',\n    ],\n    tableRow: ['backgroundColor'],\n    tableColumn: ['size'],\n    table: [\n        'id',\n        'border',\n        'backgroundColor',\n        'display',\n        'htmlAlign',\n        'margin',\n        'size',\n        'tableLayout',\n        'textColor',\n    ],\n    tableBorder: ['borderBox', 'tableSpacing'],\n    tableCellBorder: ['borderBox'],\n    image: [\n        'id',\n        'size',\n        'margin',\n        'padding',\n        'borderBox',\n        'border',\n        'boxShadow',\n        'display',\n        'float',\n        'verticalAlign',\n    ],\n    link: [\n        'link',\n        'textColor',\n        'underline',\n        'display',\n        'margin',\n        'padding',\n        'backgroundColor',\n        'border',\n        'size',\n        'textAlign',\n    ],\n    segmentUnderLink: ['textColor'],\n    code: ['fontFamily', 'display'],\n    dataset: ['dataset'],\n    divider: [...sharedBlockFormats, ...sharedContainerFormats, 'display', 'size', 'htmlAlign'],\n    container: [...sharedContainerFormats, 'htmlAlign', 'size', 'display'],\n    entity: ['entity'],\n    general: ['textColor', 'backgroundColor'], // General model still need to do color transformation in dark mode\n};\n\n/**\n * @internal\n */\nexport const defaultFormatParsers: FormatParsers = getObjectKeys(defaultFormatHandlerMap).reduce(\n    (result, key) => {\n        result[key] = defaultFormatHandlerMap[key].parse as FormatParser<any>;\n        return result;\n    },\n    <FormatParsers>{}\n);\n\n/**\n * @internal\n */\nexport const defaultFormatAppliers: FormatAppliers = getObjectKeys(defaultFormatHandlerMap).reduce(\n    (result, key) => {\n        result[key] = defaultFormatHandlerMap[key].apply as FormatApplier<any>;\n        return result;\n    },\n    <FormatAppliers>{}\n);\n","import { generateEntityClassNames, parseEntityFormat } from '../../domUtils/entityUtils';\nimport type { EntityInfoFormat, IdFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const entityFormatHandler: FormatHandler<EntityInfoFormat & IdFormat> = {\n    parse: (format, element) => {\n        Object.assign(format, parseEntityFormat(element));\n    },\n\n    apply: (format, element) => {\n        if (!format.isFakeEntity) {\n            element.className = generateEntityClassNames(format);\n        }\n\n        if (format.isReadonly) {\n            element.contentEditable = 'false';\n        } else {\n            element.removeAttribute('contenteditable');\n        }\n    },\n};\n","import { isElementOfType } from '../../domUtils/isElementOfType';\nimport { isNodeOfType } from '../../domUtils/isNodeOfType';\nimport type { FormatHandler } from '../FormatHandler';\nimport type { ListThreadFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const listItemThreadFormatHandler: FormatHandler<ListThreadFormat> = {\n    parse: (format, element, context, defaultStyles) => {\n        const { listFormat } = context;\n        const depth = listFormat.levels.length;\n        const display = element.style.display || defaultStyles.display;\n\n        if (display && display != 'list-item') {\n            format.displayForDummyItem = display;\n        } else if (isLiUnderOl(element) && depth > 0) {\n            listFormat.threadItemCounts[depth - 1]++;\n            listFormat.threadItemCounts.splice(depth);\n            listFormat.levels.forEach(level => {\n                // Delete restart number so next list item doesn't need to have this value.\n                // Then it will be treated as a continuous list item to the previous one\n                delete level.format.startNumberOverride;\n            });\n        }\n    },\n    apply: (format, element, context) => {\n        if (format.displayForDummyItem) {\n            element.style.display = format.displayForDummyItem;\n        } else if (isLiUnderOl(element)) {\n            const { listFormat } = context;\n            const { threadItemCounts } = listFormat;\n            const index = listFormat.nodeStack.length - 2; // The first one is always the parent of list, then minus another 1 to convert length to index\n\n            if (index >= 0) {\n                threadItemCounts.splice(index + 1);\n                threadItemCounts[index] = (threadItemCounts[index] ?? 0) + 1;\n            }\n        }\n    },\n};\n\nfunction isLiUnderOl(element: HTMLElement) {\n    return (\n        isElementOfType(element, 'li') &&\n        isNodeOfType(element.parentNode, 'ELEMENT_NODE') &&\n        isElementOfType(element.parentNode, 'ol')\n    );\n}\n","import { isElementOfType } from '../../domUtils/isElementOfType';\nimport type { FormatHandler } from '../FormatHandler';\nimport type { ListThreadFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const listLevelThreadFormatHandler: FormatHandler<ListThreadFormat> = {\n    parse: (format, element, context) => {\n        if (isElementOfType(element, 'ol')) {\n            const { listFormat } = context;\n            const { threadItemCounts, levels } = listFormat;\n            const depth = levels.length;\n\n            if (\n                typeof threadItemCounts[depth] === 'number' &&\n                element.start != threadItemCounts[depth] + 1\n            ) {\n                format.startNumberOverride = element.start;\n            }\n\n            threadItemCounts[depth] = element.start - 1;\n        }\n    },\n    apply: (format, element, context) => {\n        const {\n            listFormat: { threadItemCounts, nodeStack },\n        } = context;\n\n        // The first one is always the parent of list, and minus another one to convert length to index\n        // This format applier needs to be executed after new list level is pushed into node stack\n        const depth = nodeStack.length - 2;\n\n        if (depth >= 0 && isElementOfType(element, 'ol')) {\n            const startNumber = format.startNumberOverride;\n\n            if (typeof startNumber === 'number') {\n                threadItemCounts[depth] = startNumber - 1;\n            } else if (typeof threadItemCounts[depth] != 'number') {\n                threadItemCounts[depth] = 0;\n            }\n\n            threadItemCounts.splice(depth + 1);\n            element.start = threadItemCounts[depth] + 1;\n        }\n    },\n};\n","import type { FormatHandler } from '../FormatHandler';\nimport type { ListStyleFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const listStyleFormatHandler: FormatHandler<ListStyleFormat> = {\n    parse: (format, element) => {\n        const listStylePosition = element.style.listStylePosition;\n        const listStyleType = element.style.listStyleType;\n\n        if (listStylePosition) {\n            format.listStylePosition = listStylePosition;\n        }\n\n        if (listStyleType) {\n            format.listStyleType = listStyleType;\n        }\n    },\n    apply: (format, element) => {\n        if (format.listStylePosition) {\n            element.style.listStylePosition = format.listStylePosition;\n        }\n\n        if (format.listStyleType) {\n            element.style.listStyleType = format.listStyleType;\n        }\n    },\n};\n","import { shouldSetValue } from '../utils/shouldSetValue';\nimport { wrapAllChildNodes } from '../../domUtils/moveChildNodes';\nimport type { BoldFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const boldFormatHandler: FormatHandler<BoldFormat> = {\n    parse: (format, element, context, defaultStyle) => {\n        const fontWeight = element.style.fontWeight || defaultStyle.fontWeight;\n\n        if (shouldSetValue(fontWeight, '400', format.fontWeight, defaultStyle.fontWeight)) {\n            format.fontWeight = fontWeight;\n        }\n    },\n    apply: (format, element, context) => {\n        if (typeof format.fontWeight === 'undefined') {\n            return;\n        }\n\n        const blockFontWeight = context.implicitFormat.fontWeight;\n\n        if (\n            (blockFontWeight && blockFontWeight != format.fontWeight) ||\n            (!blockFontWeight && format.fontWeight && format.fontWeight != 'normal')\n        ) {\n            if (format.fontWeight == 'bold') {\n                wrapAllChildNodes(element, 'b');\n            } else {\n                element.style.fontWeight = format.fontWeight || 'normal';\n            }\n        }\n    },\n};\n","import type { FontFamilyFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const fontFamilyFormatHandler: FormatHandler<FontFamilyFormat> = {\n    parse: (format, element, context, defaultStyle) => {\n        const fontFamily = element.style.fontFamily || defaultStyle.fontFamily;\n\n        if (fontFamily && fontFamily != 'inherit') {\n            format.fontFamily = fontFamily;\n        }\n    },\n    apply: (format, element, context) => {\n        if (format.fontFamily && format.fontFamily != context.implicitFormat.fontFamily) {\n            element.style.fontFamily = format.fontFamily;\n        }\n    },\n};\n","import { isSuperOrSubScript } from './superOrSubScriptFormatHandler';\nimport { parseValueWithUnit } from '../utils/parseValueWithUnit';\nimport type { EditorContext, FontSizeFormat } from 'roosterjs-content-model-types';\nimport type { FormatHandler } from '../FormatHandler';\n\n/**\n * @internal\n */\nexport const fontSizeFormatHandler: FormatHandler<FontSizeFormat> = {\n    parse: (format, element, context, defaultStyle) => {\n        const fontSize = element.style.fontSize || defaultStyle.fontSize;\n        const verticalAlign = element.style.verticalAlign || defaultStyle.verticalAlign;\n\n        // when font size is 'smaller' and the style is for superscript/subscript,\n        // the font size will be handled by superOrSubScript handler\n        if (fontSize && !isSuperOrSubScript(fontSize, verticalAlign) && fontSize != 'inherit') {\n            if (element.style.fontSize) {\n                format.fontSize = normalizeFontSize(\n                    fontSize,\n                    context.segmentFormat.fontSize,\n                    context\n                );\n            } else if (defaultStyle.fontSize) {\n                format.fontSize = fontSize;\n            }\n        }\n    },\n    apply: (format, element, context) => {\n        if (format.fontSize && format.fontSize != context.implicitFormat.fontSize) {\n            element.style.fontSize = format.fontSize;\n        }\n    },\n};\n\n// https://developer.mozilla.org/en-US/docs/Web/CSS/font-size\nconst KnownFontSizes: Record<string, string> = {\n    'xx-small': '6.75pt',\n    'x-small': '7.5pt',\n    small: '9.75pt',\n    medium: '12pt',\n    large: '13.5pt',\n    'x-large': '18pt',\n    'xx-large': '24pt',\n    'xxx-large': '36pt',\n};\n\nfunction normalizeFontSize(\n    fontSize: string,\n    contextFont: string | undefined,\n    context: EditorContext\n): string | undefined {\n    const knownFontSize = KnownFontSizes[fontSize];\n    const isRemUnit = fontSize.endsWith('rem');\n\n    if (knownFontSize) {\n        return knownFontSize;\n    } else if (\n        fontSize == 'smaller' ||\n        fontSize == 'larger' ||\n        fontSize.endsWith('em') ||\n        fontSize.endsWith('%') ||\n        isRemUnit\n    ) {\n        if (!contextFont && !isRemUnit) {\n            return undefined;\n        } else {\n            const existingFontSize = isRemUnit\n                ? context.rootFontSize\n                : parseValueWithUnit(contextFont);\n\n            if (existingFontSize) {\n                switch (fontSize) {\n                    case 'smaller':\n                        return Math.round((existingFontSize * 500) / 6) / 100 + 'px';\n                    case 'larger':\n                        return Math.round((existingFontSize * 600) / 5) / 100 + 'px';\n                    default:\n                        return parseValueWithUnit(fontSize, existingFontSize, 'px') + 'px';\n                }\n            }\n        }\n    } else if (fontSize == 'inherit' || fontSize == 'revert' || fontSize == 'unset') {\n        return undefined;\n    } else {\n        return fontSize;\n    }\n}\n","import { wrapAllChildNodes } from '../../domUtils/moveChildNodes';\nimport type { FormatHandler } from '../FormatHandler';\nimport type { ItalicFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const italicFormatHandler: FormatHandler<ItalicFormat> = {\n    parse: (format, element, context, defaultStyle) => {\n        const fontStyle = element.style.fontStyle || defaultStyle.fontStyle;\n\n        if (fontStyle == 'italic' || fontStyle == 'oblique') {\n            format.italic = true;\n        } else if (fontStyle == 'initial' || fontStyle == 'normal') {\n            format.italic = false;\n        }\n    },\n    apply: (format, element, context) => {\n        if (typeof format.italic === 'undefined') {\n            return;\n        }\n\n        const implicitItalic = context.implicitFormat.italic;\n\n        if (!!implicitItalic != !!format.italic) {\n            if (format.italic) {\n                wrapAllChildNodes(element, 'i');\n            } else {\n                element.style.fontStyle = 'normal';\n            }\n        }\n    },\n};\n","import { shouldSetValue } from '../utils/shouldSetValue';\nimport type { FormatHandler } from '../FormatHandler';\nimport type { LetterSpacingFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const letterSpacingFormatHandler: FormatHandler<LetterSpacingFormat> = {\n    parse: (format, element, _, defaultStyle) => {\n        const letterSpacing = element.style.letterSpacing || defaultStyle.letterSpacing;\n\n        if (\n            shouldSetValue(\n                letterSpacing,\n                'normal',\n                format.letterSpacing,\n                defaultStyle.letterSpacing\n            )\n        ) {\n            format.letterSpacing = letterSpacing;\n        }\n    },\n    apply: (format, element) => {\n        if (format.letterSpacing) {\n            element.style.letterSpacing = format.letterSpacing;\n        }\n    },\n};\n","import { isElementOfType } from '../../domUtils/isElementOfType';\nimport type { FormatHandler } from '../FormatHandler';\nimport type { LinkFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const linkFormatHandler: FormatHandler<LinkFormat> = {\n    parse: (format, element) => {\n        if (isElementOfType(element, 'a')) {\n            const name = element.name;\n            const href = element.getAttribute('href'); // Use getAttribute to get original HREF but not the resolved absolute url\n            const target = element.target;\n            const rel = element.rel;\n            const id = element.id;\n            const className = element.className;\n            const title = element.title;\n\n            if (name) {\n                format.name = name;\n            }\n\n            if (href) {\n                format.href = href;\n            }\n\n            if (target) {\n                format.target = target;\n            }\n\n            if (id) {\n                format.anchorId = id;\n            }\n\n            if (rel) {\n                format.relationship = rel;\n            }\n\n            if (title) {\n                format.anchorTitle = title;\n            }\n\n            if (className) {\n                format.anchorClass = className;\n            }\n        }\n    },\n    apply: (format, element) => {\n        if (isElementOfType(element, 'a') && format.href) {\n            element.href = format.href;\n\n            if (format.name) {\n                element.name = format.name;\n            }\n\n            if (format.target) {\n                element.target = format.target;\n            }\n\n            if (format.anchorId) {\n                element.id = format.anchorId;\n            }\n\n            if (format.anchorClass) {\n                element.className = format.anchorClass;\n            }\n\n            if (format.anchorTitle) {\n                element.title = format.anchorTitle;\n            }\n\n            if (format.relationship) {\n                element.rel = format.relationship;\n            }\n        }\n    },\n};\n","import { wrapAllChildNodes } from '../../domUtils/moveChildNodes';\nimport type { FormatHandler } from '../FormatHandler';\nimport type { StrikeFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const strikeFormatHandler: FormatHandler<StrikeFormat> = {\n    parse: (format, element, context, defaultStyle) => {\n        const textDecoration = element.style.textDecoration || defaultStyle.textDecoration;\n\n        if (textDecoration?.indexOf('line-through')! >= 0) {\n            format.strikethrough = true;\n        }\n    },\n    apply: (format, element) => {\n        if (format.strikethrough) {\n            wrapAllChildNodes(element, 's');\n        }\n    },\n};\n","import { wrapAllChildNodes } from '../../domUtils/moveChildNodes';\nimport type { FormatHandler } from '../FormatHandler';\nimport type { SuperOrSubScriptFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const superOrSubScriptFormatHandler: FormatHandler<SuperOrSubScriptFormat> = {\n    parse: (format, element, context, defaultStyle) => {\n        const verticalAlign = element.style.verticalAlign || defaultStyle.verticalAlign;\n        const fontSize = element.style.fontSize || defaultStyle.fontSize;\n\n        if (isSuperOrSubScript(fontSize, verticalAlign)) {\n            format.superOrSubScriptSequence = (format.superOrSubScriptSequence || '')\n                .split(' ')\n                .concat(verticalAlign)\n                .join(' ')\n                .trim();\n        }\n    },\n    apply: (format, element) => {\n        if (format.superOrSubScriptSequence) {\n            format.superOrSubScriptSequence\n                .split(' ')\n                .reverse()\n                .forEach(value => {\n                    const tagName = value == 'super' ? 'sup' : value == 'sub' ? 'sub' : null;\n\n                    if (tagName) {\n                        wrapAllChildNodes(element, tagName);\n                    }\n                });\n        }\n    },\n};\n\n/**\n * @internal\n */\nexport function isSuperOrSubScript(\n    fontSize: string | undefined,\n    verticalAlign: string | undefined\n): verticalAlign is 'sub' | 'super' {\n    return fontSize == 'smaller' && (verticalAlign == 'sub' || verticalAlign == 'super');\n}\n","import { getColor, setColor } from '../utils/color';\nimport type { FormatHandler } from '../FormatHandler';\nimport type { TextColorFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const textColorFormatHandler: FormatHandler<TextColorFormat> = {\n    parse: (format, element, context, defaultStyle) => {\n        const textColor =\n            getColor(\n                element,\n                false /*isBackground*/,\n                !!context.isDarkMode,\n                context.darkColorHandler\n            ) || defaultStyle.color;\n\n        if (textColor && textColor != 'inherit') {\n            format.textColor = textColor;\n        }\n    },\n    apply: (format, element, context) => {\n        const implicitColor = context.implicitFormat.textColor;\n\n        if (format.textColor && format.textColor != implicitColor) {\n            setColor(\n                element,\n                format.textColor,\n                false /*isBackground*/,\n                !!context.isDarkMode,\n                context.darkColorHandler\n            );\n        }\n    },\n};\n","import { wrapAllChildNodes } from '../../domUtils/moveChildNodes';\nimport type { FormatHandler } from '../FormatHandler';\nimport type { UnderlineFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const underlineFormatHandler: FormatHandler<UnderlineFormat> = {\n    parse: (format, element, context, defaultStyle) => {\n        const textDecoration = element.style.textDecoration || defaultStyle.textDecoration;\n\n        if (textDecoration?.indexOf('underline')! >= 0) {\n            format.underline = true;\n        } else if (element.tagName == 'A' && textDecoration == 'none') {\n            format.underline = false;\n        }\n    },\n    apply: (format, element, context) => {\n        if (typeof format.underline === 'undefined') {\n            return;\n        }\n\n        const blockUnderline = context.implicitFormat.underline;\n\n        if (!!blockUnderline != !!format.underline) {\n            if (format.underline) {\n                wrapAllChildNodes(element, 'u');\n            } else {\n                element.style.textDecoration = 'none';\n            }\n        }\n    },\n};\n","import type { FormatHandler } from '../FormatHandler';\nimport type { TableLayoutFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const tableLayoutFormatHandler: FormatHandler<TableLayoutFormat> = {\n    parse: (format, element) => {\n        const tableLayout = element.style.tableLayout;\n        if (tableLayout && tableLayout != 'inherit') {\n            format.tableLayout = tableLayout;\n        }\n    },\n    apply: (format, element) => {\n        if (format.tableLayout) {\n            element.style.tableLayout = format.tableLayout;\n        }\n    },\n};\n","import type { FormatHandler } from '../FormatHandler';\nimport type { SpacingFormat } from 'roosterjs-content-model-types';\n\nconst BorderCollapsed = 'collapse';\nconst BorderSeparate = 'separate';\nconst CellPadding = 'cellPadding';\n\n/**\n * @internal\n */\nexport const tableSpacingFormatHandler: FormatHandler<SpacingFormat> = {\n    parse: (format, element) => {\n        if (element.style.borderCollapse == BorderCollapsed) {\n            format.borderCollapse = true;\n        } else {\n            const cellPadding = element.getAttribute(CellPadding);\n            if (cellPadding) {\n                format.borderCollapse = true;\n            }\n        }\n\n        if (element.style.borderCollapse == BorderSeparate) {\n            format.borderSeparate = true;\n        }\n    },\n    apply: (format, element) => {\n        if (format.borderCollapse) {\n            element.style.borderCollapse = BorderCollapsed;\n            element.style.borderSpacing = '0';\n            element.style.boxSizing = 'border-box';\n        } else if (format.borderSeparate) {\n            element.style.borderCollapse = BorderSeparate;\n            element.style.borderSpacing = '0';\n            element.style.boxSizing = 'border-box';\n        }\n    },\n};\n","import type { FormatHandler } from '../FormatHandler';\nimport type { TextColorFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const textColorOnTableCellFormatHandler: FormatHandler<TextColorFormat> = {\n    parse: (format, element) => {\n        if (element.style.color) {\n            // Delete color from format since text color on TD/TH will be handled by separate code\n            // and text color on segment format context need to be reset so that it will not inherit\n            // value outer container\n            delete format.textColor;\n        }\n    },\n    apply: () => {},\n};\n","import { getObjectKeys } from '../../domUtils/getObjectKeys';\nimport type { DarkColorHandler, Colors } from 'roosterjs-content-model-types';\n\n/**\n * List of deprecated colors\n */\nexport const DeprecatedColors: string[] = [\n    'inactiveborder',\n    'activeborder',\n    'inactivecaptiontext',\n    'inactivecaption',\n    'activecaption',\n    'appworkspace',\n    'infobackground',\n    'background',\n    'buttonhighlight',\n    'buttonshadow',\n    'captiontext',\n    'infotext',\n    'menutext',\n    'menu',\n    'scrollbar',\n    'threeddarkshadow',\n    'threedface',\n    'threedhighlight',\n    'threedlightshadow',\n    'threedfhadow',\n    'windowtext',\n    'windowframe',\n    'window',\n];\n\nconst BlackColor = 'rgb(0, 0, 0)';\nconst HEX3_REGEX = /^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/;\nconst HEX6_REGEX = /^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/;\nconst RGB_REGEX = /^rgb\\(\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*\\)$/;\nconst RGBA_REGEX = /^rgba\\(\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*\\)$/;\nconst VARIABLE_REGEX = /^\\s*var\\(\\s*(\\-\\-[a-zA-Z0-9\\-_]+)\\s*(?:,\\s*(.*))?\\)\\s*$/;\nconst VARIABLE_PREFIX = 'var(';\nconst VARIABLE_POSTFIX = ')';\nconst COLOR_VAR_PREFIX = '--darkColor';\n\n/**\n * Get color from given HTML element\n * @param element The element to get color from\n * @param isBackground True to get background color, false to get text color\n * @param isDarkMode Whether element is in dark mode now\n * @param darkColorHandler @optional The dark color handler object to help manager dark mode color\n */\nexport function getColor(\n    element: HTMLElement,\n    isBackground: boolean,\n    isDarkMode: boolean,\n    darkColorHandler?: DarkColorHandler\n): string | undefined {\n    let color =\n        (isBackground ? element.style.backgroundColor : element.style.color) ||\n        element.getAttribute(isBackground ? 'bgcolor' : 'color') ||\n        undefined;\n\n    if (color && DeprecatedColors.indexOf(color) > -1) {\n        color = isBackground ? undefined : BlackColor;\n    } else if (darkColorHandler && color) {\n        const match = color.startsWith(VARIABLE_PREFIX) ? VARIABLE_REGEX.exec(color) : null;\n\n        if (match) {\n            color = match[2] || '';\n        } else if (isDarkMode) {\n            // If editor is in dark mode but the color is not in dark color format, it is possible the color was inserted from external code\n            // without any light color info. So we first try to see if there is a known dark color can match this color, and use its related\n            // light color as light mode color. Otherwise we need to drop this color to avoid show \"white on white\" content.\n            color = findLightColorFromDarkColor(color, darkColorHandler.knownColors) || '';\n        }\n    }\n\n    return color;\n}\n\n/**\n * Set color to given HTML element\n * @param element The element to set color to\n * @param color The color to set, always pass in color in light mode\n * @param isBackground True to set background color, false to set text color\n * @param isDarkMode Whether element is in dark mode now\n * @param darkColorHandler @optional The dark color handler object to help manager dark mode color\n */\nexport function setColor(\n    element: HTMLElement,\n    color: string | null | undefined,\n    isBackground: boolean,\n    isDarkMode: boolean,\n    darkColorHandler?: DarkColorHandler\n) {\n    const match = color && color.startsWith(VARIABLE_PREFIX) ? VARIABLE_REGEX.exec(color) : null;\n    const [_, existingKey, fallbackColor] = match ?? [];\n\n    color = fallbackColor ?? color;\n\n    if (darkColorHandler && color) {\n        const key = existingKey || `${COLOR_VAR_PREFIX}_${color.replace(/[^\\d\\w]/g, '_')}`;\n        const darkModeColor =\n            darkColorHandler.knownColors?.[key]?.darkModeColor ||\n            darkColorHandler.getDarkColor(\n                color,\n                undefined /*baseLAValue*/,\n                isBackground ? 'background' : 'text',\n                element\n            );\n\n        darkColorHandler.updateKnownColor(isDarkMode, key, {\n            lightModeColor: color,\n            darkModeColor,\n        });\n\n        color = isDarkMode ? `${VARIABLE_PREFIX}${key}, ${color}${VARIABLE_POSTFIX}` : color;\n    }\n\n    element.removeAttribute(isBackground ? 'bgcolor' : 'color');\n    element.style.setProperty(isBackground ? 'background-color' : 'color', color || null);\n}\n\n/**\n * Parse color string to r/g/b value.\n * If the given color is not in a recognized format, return null\n * @param color The source color to parse\n * @returns An array of Red/Green/Blue value, or null if fail to parse\n */\nexport function parseColor(color: string): [number, number, number] | null {\n    color = (color || '').trim();\n\n    let match: RegExpMatchArray | null;\n    if ((match = color.match(HEX3_REGEX))) {\n        return [\n            parseInt(match[1] + match[1], 16),\n            parseInt(match[2] + match[2], 16),\n            parseInt(match[3] + match[3], 16),\n        ];\n    } else if ((match = color.match(HEX6_REGEX))) {\n        return [parseInt(match[1], 16), parseInt(match[2], 16), parseInt(match[3], 16)];\n    } else if ((match = color.match(RGB_REGEX) || color.match(RGBA_REGEX))) {\n        return [parseInt(match[1]), parseInt(match[2]), parseInt(match[3])];\n    } else {\n        // CSS color names such as red, green is not included for now.\n        // If need, we can add those colors from https://www.w3.org/wiki/CSS/Properties/color/keywords\n        return null;\n    }\n}\n\nfunction findLightColorFromDarkColor(\n    darkColor: string,\n    knownColors?: Record<string, Colors>\n): string | null {\n    const rgbSearch = parseColor(darkColor);\n\n    if (rgbSearch && knownColors) {\n        const key = getObjectKeys(knownColors).find(key => {\n            const rgbCurrent = parseColor(knownColors[key].darkModeColor);\n\n            return (\n                rgbCurrent &&\n                rgbCurrent[0] == rgbSearch[0] &&\n                rgbCurrent[1] == rgbSearch[1] &&\n                rgbCurrent[2] == rgbSearch[2]\n            );\n        });\n\n        if (key) {\n            return knownColors[key].lightModeColor;\n        }\n    }\n\n    return null;\n}\n","/**\n * @internal\n */\nexport const ResultMap = {\n    start: {\n        ltr: 'left',\n        rtl: 'right',\n    },\n    center: {\n        ltr: 'center',\n        rtl: 'center',\n    },\n    end: {\n        ltr: 'right',\n        rtl: 'left',\n    },\n    initial: {\n        ltr: 'initial',\n        rtl: 'initial',\n    },\n    justify: {\n        ltr: 'justify',\n        rtl: 'justify',\n    },\n};\n\n/**\n * @internal\n */\nexport function calcAlign(align: string, dir?: 'ltr' | 'rtl') {\n    switch (align) {\n        case 'center':\n            return 'center';\n\n        case 'left':\n            return dir == 'rtl' ? 'end' : 'start';\n\n        case 'right':\n            return dir == 'rtl' ? 'start' : 'end';\n\n        case 'start':\n        case 'end':\n            return align;\n\n        case 'justify':\n        case 'initial':\n            return align;\n\n        default:\n            return undefined;\n    }\n}\n","const MarginValueRegex = /(-?\\d+(\\.\\d+)?)([a-z]+|%)/;\n\n// According to https://developer.mozilla.org/en-US/docs/Glossary/CSS_pixel, 1in = 96px\nconst PixelPerInch = 96;\n\nconst DefaultRootFontSize = 16;\n\n/**\n * Parse unit value with its unit\n * @param value The source value to parse\n * @param currentSizePxOrElement The source element which has this unit value, or current font size (in px) from context.\n * @param resultUnit Unit for result, can be px or pt. @default px\n */\nexport function parseValueWithUnit(\n    value: string = '',\n    currentSizePxOrElement?: number | HTMLElement,\n    resultUnit: 'px' | 'pt' = 'px'\n): number {\n    const match = MarginValueRegex.exec(value);\n    let result = 0;\n\n    if (match) {\n        const [_, numStr, __, unit] = match;\n        const num = parseFloat(numStr);\n\n        switch (unit) {\n            case 'px':\n                result = num;\n                break;\n            case 'pt':\n                result = ptToPx(num);\n                break;\n            case 'em':\n                result = getFontSize(currentSizePxOrElement) * num;\n                break;\n            case 'ex':\n                result = (getFontSize(currentSizePxOrElement) * num) / 2;\n                break;\n            case '%':\n                result = (getFontSize(currentSizePxOrElement) * num) / 100;\n                break;\n            case 'in':\n                result = num * PixelPerInch;\n                break;\n            case 'rem':\n                result = (getFontSize(currentSizePxOrElement) || DefaultRootFontSize) * num;\n                break;\n        }\n    }\n\n    if (result > 0 && resultUnit == 'pt') {\n        result = pxToPt(result);\n    }\n\n    return result;\n}\n\nfunction getFontSize(currentSizeOrElement?: number | HTMLElement): number {\n    if (typeof currentSizeOrElement === 'undefined') {\n        return 0;\n    } else if (typeof currentSizeOrElement === 'number') {\n        return currentSizeOrElement;\n    } else {\n        const styleInPt =\n            currentSizeOrElement.ownerDocument.defaultView?.getComputedStyle(currentSizeOrElement)\n                .fontSize ?? '';\n        const floatInPt = parseFloat(styleInPt);\n        const floatInPx = ptToPx(floatInPt);\n\n        return floatInPx;\n    }\n}\n\nfunction ptToPx(pt: number): number {\n    return Math.round((pt * 4000) / 3) / 1000;\n}\n\nfunction pxToPt(px: number) {\n    return Math.round((px * 3000) / 4) / 1000;\n}\n","/**\n * @internal\n */\nexport function shouldSetValue(\n    value: string | undefined,\n    normalValue: string,\n    existingValue: string | undefined,\n    defaultValue: string | undefined\n): boolean {\n    return (\n        !!value &&\n        value != 'inherit' &&\n        !!(value != normalValue || existingValue || (defaultValue && value != defaultValue))\n    );\n}\n","export { domToContentModel } from './domToModel/domToContentModel';\nexport { contentModelToDom } from './modelToDom/contentModelToDom';\nexport { contentModelToText } from './modelToText/contentModelToText';\n\nexport {\n    childProcessor,\n    handleRegularSelection,\n    processChildNode,\n} from './domToModel/processors/childProcessor';\nexport { entityProcessor } from './domToModel/processors/entityProcessor';\nexport { tableProcessor } from './domToModel/processors/tableProcessor';\nexport { getRegularSelectionOffsets } from './domToModel/utils/getRegularSelectionOffsets';\nexport { parseFormat } from './domToModel/utils/parseFormat';\nexport { areSameFormats } from './domToModel/utils/areSameFormats';\nexport { isBlockElement } from './domToModel/utils/isBlockElement';\n\nexport { updateMetadata, hasMetadata } from './domUtils/metadata/updateMetadata';\nexport { isNodeOfType, NodeTypeMap } from './domUtils/isNodeOfType';\nexport { isElementOfType } from './domUtils/isElementOfType';\nexport { getObjectKeys } from './domUtils/getObjectKeys';\nexport { default as toArray } from './domUtils/toArray';\nexport { moveChildNodes, wrapAllChildNodes } from './domUtils/moveChildNodes';\nexport { wrap } from './domUtils/wrap';\nexport {\n    isEntityElement,\n    getAllEntityWrappers,\n    parseEntityFormat,\n    generateEntityClassNames,\n    addDelimiters,\n    isEntityDelimiter,\n} from './domUtils/entityUtils';\nexport { reuseCachedElement } from './domUtils/reuseCachedElement';\nexport { isWhiteSpacePreserved } from './domUtils/isWhiteSpacePreserved';\n\nexport { createBr } from './modelApi/creators/createBr';\nexport { createListItem } from './modelApi/creators/createListItem';\nexport { createFormatContainer } from './modelApi/creators/createFormatContainer';\nexport { createParagraph } from './modelApi/creators/createParagraph';\nexport { createSelectionMarker } from './modelApi/creators/createSelectionMarker';\nexport { createTable } from './modelApi/creators/createTable';\nexport { createTableCell } from './modelApi/creators/createTableCell';\nexport { createText } from './modelApi/creators/createText';\nexport { createImage } from './modelApi/creators/createImage';\nexport { createContentModelDocument } from './modelApi/creators/createContentModelDocument';\nexport { createParagraphDecorator } from './modelApi/creators/createParagraphDecorator';\nexport { createGeneralSegment } from './modelApi/creators/createGeneralSegment';\nexport { createGeneralBlock } from './modelApi/creators/createGeneralBlock';\nexport { createEntity } from './modelApi/creators/createEntity';\nexport { createDivider } from './modelApi/creators/createDivider';\nexport { createListLevel } from './modelApi/creators/createListLevel';\nexport { createEmptyModel } from './modelApi/creators/createEmptyModel';\n\nexport { addBlock } from './modelApi/common/addBlock';\nexport { addCode } from './modelApi/common/addDecorators';\nexport { addLink } from './modelApi/common/addDecorators';\nexport { normalizeParagraph } from './modelApi/common/normalizeParagraph';\n\nexport { normalizeContentModel } from './modelApi/common/normalizeContentModel';\nexport { isGeneralSegment } from './modelApi/common/isGeneralSegment';\nexport { unwrapBlock } from './modelApi/common/unwrapBlock';\nexport { addSegment } from './modelApi/common/addSegment';\nexport { isEmpty } from './modelApi/common/isEmpty';\nexport { normalizeSingleSegment } from './modelApi/common/normalizeSegment';\n\nexport { setParagraphNotImplicit } from './modelApi/block/setParagraphNotImplicit';\n\nexport { parseValueWithUnit } from './formatHandlers/utils/parseValueWithUnit';\nexport { BorderKeys } from './formatHandlers/common/borderFormatHandler';\nexport { DeprecatedColors, getColor, setColor, parseColor } from './formatHandlers/utils/color';\n\nexport {\n    createDomToModelContext,\n    createDomToModelContextWithConfig,\n    createDomToModelConfig,\n} from './domToModel/context/createDomToModelContext';\nexport {\n    createModelToDomContext,\n    createModelToDomContextWithConfig,\n    createModelToDomConfig,\n} from './modelToDom/context/createModelToDomContext';\n","import type { ContentModelBlock } from 'roosterjs-content-model-types';\n\n/**\n * For a given block, if it is a paragraph, set it to be not-implicit\n * @param block The block to check\n */\nexport function setParagraphNotImplicit(block: ContentModelBlock) {\n    if (block.blockType == 'Paragraph' && block.isImplicit) {\n        block.isImplicit = false;\n    }\n}\n","import type { ContentModelBlock, ContentModelBlockGroup } from 'roosterjs-content-model-types';\n\n/**\n * Add a given block to block group\n * @param group The block group to add block into\n * @param block The block to add\n */\nexport function addBlock(group: ContentModelBlockGroup, block: ContentModelBlock) {\n    group.blocks.push(block);\n}\n","import type {\n    ContentModelCode,\n    ContentModelLink,\n    ContentModelSegment,\n    DomToModelDecoratorContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function addLink(segment: ContentModelSegment, link: ContentModelLink) {\n    if (link.format.href) {\n        segment.link = {\n            format: { ...link.format },\n            dataset: { ...link.dataset },\n        };\n    }\n}\n\n/**\n * Add a code decorator into segment if any\n * @param segment The segment to add decorator to\n * @param code The code decorator to add\n */\nexport function addCode(segment: ContentModelSegment, code: ContentModelCode) {\n    if (code.format.fontFamily) {\n        segment.code = {\n            format: { ...code.format },\n        };\n    }\n}\n\n/**\n * @internal\n */\nexport function addDecorators(segment: ContentModelSegment, context: DomToModelDecoratorContext) {\n    addLink(segment, context.link);\n    addCode(segment, context.code);\n}\n","import { ensureParagraph } from './ensureParagraph';\nimport type {\n    ContentModelBlockFormat,\n    ContentModelBlockGroup,\n    ContentModelParagraph,\n    ContentModelSegment,\n    ContentModelSegmentFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * Add a given segment into a paragraph from its parent group. If the last block of the given group is not paragraph, create a new paragraph.\n * @param group The parent block group of the paragraph to add segment into\n * @param newSegment The segment to add\n * @param blockFormat The block format used for creating a new paragraph when need\n * @returns The parent paragraph where the segment is added to\n */\nexport function addSegment(\n    group: ContentModelBlockGroup,\n    newSegment: ContentModelSegment,\n    blockFormat?: ContentModelBlockFormat,\n    segmentFormat?: ContentModelSegmentFormat\n): ContentModelParagraph {\n    const paragraph = ensureParagraph(group, blockFormat, segmentFormat);\n    const lastSegment = paragraph.segments[paragraph.segments.length - 1];\n\n    if (blockFormat?.textIndent) {\n        // For a new paragraph, if current text indent is already applied to previous block in the same level,\n        // we need to ignore it according to browser rendering behavior\n        if (blockFormat.isTextIndentApplied && paragraph.segments.length == 0) {\n            delete paragraph.format.textIndent;\n        } else {\n            blockFormat.isTextIndentApplied = true;\n        }\n\n        delete paragraph.format.isTextIndentApplied;\n    }\n\n    if (newSegment.segmentType == 'SelectionMarker') {\n        if (!lastSegment || !lastSegment.isSelected) {\n            paragraph.segments.push(newSegment);\n        }\n    } else {\n        if (newSegment.isSelected && lastSegment?.segmentType == 'SelectionMarker') {\n            paragraph.segments.pop();\n        }\n\n        paragraph.segments.push(newSegment);\n    }\n\n    return paragraph;\n}\n","import { addBlock } from './addBlock';\nimport { createParagraph } from '../creators/createParagraph';\nimport type {\n    ContentModelBlockFormat,\n    ContentModelBlockGroup,\n    ContentModelParagraph,\n    ContentModelSegmentFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Ensure there is a Paragraph that can insert segments in a Content Model Block Group\n * @param group The parent block group of the target paragraph\n * @param blockFormat Format of the paragraph. This is only used if we need to create a new paragraph\n */\nexport function ensureParagraph(\n    group: ContentModelBlockGroup,\n    blockFormat?: ContentModelBlockFormat,\n    segmentFormat?: ContentModelSegmentFormat\n): ContentModelParagraph {\n    const lastBlock = group.blocks[group.blocks.length - 1];\n\n    if (lastBlock?.blockType == 'Paragraph') {\n        return lastBlock;\n    } else {\n        const paragraph = createParagraph(true, blockFormat, segmentFormat);\n        addBlock(group, paragraph);\n\n        return paragraph;\n    }\n}\n","// A regex to match text that only has space and CR\n// We use real space char \" \" (\\u0020) here but not \"\\s\" since \"\\s\" will also match \"&nbsp;\" (\\u00A0) which is something we need to keep\nconst SPACE_TEXT_REGEX = /^[\\r\\n\\t ]*$/;\n\n/**\n * @internal\n * Check if the given string only has space, including line breaks.\n * @param txt The string to check\n */\nexport function hasSpacesOnly(txt: string): boolean {\n    return SPACE_TEXT_REGEX.test(txt);\n}\n","import type {\n    ContentModelBlock,\n    ContentModelBlockGroup,\n    ContentModelSegment,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function isBlockEmpty(block: ContentModelBlock): boolean {\n    switch (block.blockType) {\n        case 'Paragraph':\n            return block.segments.length == 0;\n\n        case 'Table':\n            return block.rows.every(row => row.cells.length == 0);\n\n        case 'BlockGroup':\n            return isBlockGroupEmpty(block);\n\n        case 'Entity':\n            return false;\n\n        default:\n            return false;\n    }\n}\n\n/**\n * @internal\n */\nexport function isBlockGroupEmpty(group: ContentModelBlockGroup): boolean {\n    switch (group.blockGroupType) {\n        case 'FormatContainer':\n            // Format Container of DIV is a container for style, so we always treat it as not empty\n            return group.tagName == 'div' ? false : group.blocks.every(isBlockEmpty);\n\n        case 'ListItem':\n            return group.blocks.every(isBlockEmpty);\n\n        case 'Document':\n        case 'General':\n        case 'TableCell':\n            return false;\n\n        default:\n            return true;\n    }\n}\n\n/**\n * @internal\n */\nexport function isSegmentEmpty(segment: ContentModelSegment): boolean {\n    switch (segment.segmentType) {\n        case 'Text':\n            return !segment.text;\n\n        case 'Image':\n            return !segment.src;\n\n        default:\n            return false;\n    }\n}\n\n/**\n * Get whether the model is empty.\n * @returns true if the model is empty.\n */\nexport function isEmpty(\n    model: ContentModelBlock | ContentModelBlockGroup | ContentModelSegment\n): boolean {\n    if (isBlockGroup(model)) {\n        return isBlockGroupEmpty(model);\n    } else if (isBlock(model)) {\n        return isBlockEmpty(model);\n    } else if (isSegment(model)) {\n        return isSegmentEmpty(model);\n    }\n\n    return false;\n}\n\nfunction isSegment(\n    model: ContentModelBlock | ContentModelBlockGroup | ContentModelSegment\n): model is ContentModelSegment {\n    return typeof (<ContentModelSegment>model).segmentType === 'string';\n}\n\nfunction isBlock(\n    model: ContentModelBlock | ContentModelBlockGroup | ContentModelSegment\n): model is ContentModelBlock {\n    return typeof (<ContentModelBlock>model).blockType === 'string';\n}\n\nfunction isBlockGroup(\n    model: ContentModelBlock | ContentModelBlockGroup | ContentModelSegment\n): model is ContentModelBlockGroup {\n    return typeof (<ContentModelBlockGroup>model).blockGroupType === 'string';\n}\n","import type {\n    ContentModelBlockGroup,\n    ContentModelGeneralSegment,\n} from 'roosterjs-content-model-types';\n\n/**\n * Check if the given block group is a general segment\n * @param group The group to check\n */\nexport function isGeneralSegment(\n    group: ContentModelBlockGroup | ContentModelGeneralSegment\n): group is ContentModelGeneralSegment {\n    return (\n        group.blockGroupType == 'General' &&\n        (<ContentModelGeneralSegment>group).segmentType == 'General'\n    );\n}\n","import { isBlockEmpty } from './isEmpty';\nimport { normalizeParagraph } from './normalizeParagraph';\nimport { unwrapBlock } from './unwrapBlock';\nimport type { ContentModelBlockGroup } from 'roosterjs-content-model-types';\n\n/**\n * For a given content model, normalize it to make the model be consistent.\n * This process includes:\n * - For a list item without any list level, unwrap the list item\n * - For a paragraph, make sure it has BR at the end if it is an empty paragraph\n * - For text segments under paragraph, make sure its space values are correct (use nbsp to replace space when necessary)\n * - For an empty block, remove it\n * @param group The root level block group of content model to normalize\n */\nexport function normalizeContentModel(group: ContentModelBlockGroup) {\n    for (let i = group.blocks.length - 1; i >= 0; i--) {\n        const block = group.blocks[i];\n\n        switch (block.blockType) {\n            case 'BlockGroup':\n                if (block.blockGroupType == 'ListItem' && block.levels.length == 0) {\n                    i += block.blocks.length;\n                    unwrapBlock(group, block);\n                } else {\n                    normalizeContentModel(block);\n                }\n                break;\n            case 'Paragraph':\n                normalizeParagraph(block);\n                break;\n            case 'Table':\n                for (let r = 0; r < block.rows.length; r++) {\n                    for (let c = 0; c < block.rows[r].cells.length; c++) {\n                        if (block.rows[r].cells[c]) {\n                            normalizeContentModel(block.rows[r].cells[c]);\n                        }\n                    }\n                }\n                break;\n        }\n\n        if (isBlockEmpty(block)) {\n            group.blocks.splice(i, 1);\n        }\n    }\n}\n","import { areSameFormats } from '../../domToModel/utils/areSameFormats';\nimport { createBr } from '../creators/createBr';\nimport { isSegmentEmpty } from './isEmpty';\nimport { isWhiteSpacePreserved } from '../../domUtils/isWhiteSpacePreserved';\nimport { normalizeAllSegments } from './normalizeSegment';\nimport type { ContentModelParagraph } from 'roosterjs-content-model-types';\n\n/**\n * @param paragraph The paragraph to normalize\n * Normalize a paragraph. If it is empty, add a BR segment to make sure it can insert content\n */\nexport function normalizeParagraph(paragraph: ContentModelParagraph) {\n    const segments = paragraph.segments;\n\n    if (!paragraph.isImplicit && segments.length > 0) {\n        const last = segments[segments.length - 1];\n        const secondLast = segments[segments.length - 2];\n\n        if (\n            last.segmentType == 'SelectionMarker' &&\n            (!secondLast || secondLast.segmentType == 'Br')\n        ) {\n            segments.push(createBr(last.format));\n        } else if (segments.length > 1 && segments[segments.length - 1].segmentType == 'Br') {\n            const noMarkerSegments = segments.filter(x => x.segmentType != 'SelectionMarker');\n\n            // When there is content with a <BR> tag at the end, we can remove the BR.\n            // But if there are more than one <BR> at the end, do not remove them.\n            if (\n                noMarkerSegments.length > 1 &&\n                noMarkerSegments[noMarkerSegments.length - 2].segmentType != 'Br'\n            ) {\n                segments.pop();\n            }\n        }\n    }\n\n    if (!isWhiteSpacePreserved(paragraph.format.whiteSpace)) {\n        normalizeAllSegments(paragraph);\n    }\n\n    removeEmptyLinks(paragraph);\n\n    removeEmptySegments(paragraph);\n}\n\nfunction removeEmptySegments(block: ContentModelParagraph) {\n    for (let j = block.segments.length - 1; j >= 0; j--) {\n        if (isSegmentEmpty(block.segments[j])) {\n            block.segments.splice(j, 1);\n        }\n    }\n}\n\nfunction removeEmptyLinks(paragraph: ContentModelParagraph) {\n    const marker = paragraph.segments.find(x => x.segmentType == 'SelectionMarker');\n    if (marker) {\n        const markerIndex = paragraph.segments.indexOf(marker);\n        const prev = paragraph.segments[markerIndex - 1];\n        const next = paragraph.segments[markerIndex + 1];\n        if (\n            (prev &&\n                !prev.link &&\n                areSameFormats(prev.format, marker.format) &&\n                (!next || (!next.link && areSameFormats(next.format, marker.format))) &&\n                marker.link) ||\n            (!prev &&\n                marker.link &&\n                next &&\n                !next.link &&\n                areSameFormats(next.format, marker.format))\n        ) {\n            delete marker.link;\n        }\n    }\n}\n","import { hasSpacesOnly } from './hasSpacesOnly';\nimport type {\n    ContentModelParagraph,\n    ContentModelSegment,\n    ContentModelText,\n} from 'roosterjs-content-model-types';\n\nconst SPACE = '\\u0020';\nconst NONE_BREAK_SPACE = '\\u00A0';\nconst LEADING_SPACE_REGEX = /^\\u0020+/;\nconst TRAILING_SPACE_REGEX = /\\u0020+$/;\n\n/**\n * @internal\n */\nexport function normalizeAllSegments(paragraph: ContentModelParagraph) {\n    const context = resetNormalizeSegmentContext();\n\n    paragraph.segments.forEach(segment => {\n        normalizeSegment(segment, context);\n    });\n\n    normalizeTextSegments(context.textSegments, context.lastInlineSegment);\n    normalizeLastTextSegment(context.lastTextSegment, context.lastInlineSegment);\n}\n\n/**\n * Normalize a given segment, make sure its spaces are correctly represented by space and non-break space\n * @param segment The segment to normalize\n * @param ignoreTrailingSpaces Whether we should ignore the trailing space of the text segment @default false\n */\nexport function normalizeSingleSegment(\n    segment: ContentModelSegment,\n    ignoreTrailingSpaces: boolean = false\n) {\n    const context = resetNormalizeSegmentContext();\n\n    context.ignoreTrailingSpaces = ignoreTrailingSpaces;\n    normalizeSegment(segment, context);\n}\n\n/**\n * @internal Export for test only\n */\nexport interface NormalizeSegmentContext {\n    textSegments: ContentModelText[];\n    ignoreLeadingSpaces: boolean;\n    ignoreTrailingSpaces: boolean;\n    lastTextSegment: ContentModelText | undefined;\n    lastInlineSegment: ContentModelSegment | undefined;\n}\n\n/**\n * @internal Export for test only\n */\nexport function createNormalizeSegmentContext(): NormalizeSegmentContext {\n    return resetNormalizeSegmentContext();\n}\n\nfunction resetNormalizeSegmentContext(\n    context?: Partial<NormalizeSegmentContext>\n): NormalizeSegmentContext {\n    return Object.assign(context ?? {}, {\n        textSegments: [],\n        ignoreLeadingSpaces: true,\n        ignoreTrailingSpaces: true,\n        lastInlineSegment: undefined,\n        lastTextSegment: undefined,\n    });\n}\n\n/**\n * @internal Export for test only\n */\nexport function normalizeSegment(segment: ContentModelSegment, context: NormalizeSegmentContext) {\n    switch (segment.segmentType) {\n        case 'Br':\n            normalizeTextSegments(context.textSegments, context.lastInlineSegment);\n            normalizeLastTextSegment(context.lastTextSegment, context.lastInlineSegment);\n\n            // Line ends, reset all states\n            resetNormalizeSegmentContext(context);\n            break;\n\n        case 'Entity':\n        case 'General':\n        case 'Image':\n            // Here \"inline segment\" means a segment showing some content inline such as text, image, or other inline HTML elements\n            // BR will end current line, so it is not treated as \"inline\" here.\n            // We will do some normalization to the trailing spaces for non-inline-segments\n            context.lastInlineSegment = segment;\n            context.ignoreLeadingSpaces = false;\n            break;\n\n        case 'Text':\n            context.textSegments.push(segment);\n            context.lastInlineSegment = segment;\n            context.lastTextSegment = segment;\n\n            const first = segment.text.substring(0, 1);\n            const last = segment.text.substr(-1);\n\n            if (!hasSpacesOnly(segment.text)) {\n                if (first == SPACE) {\n                    // 1. Multiple leading space => single &nbsp; or empty (depends on if previous segment ends with space)\n                    segment.text = segment.text.replace(\n                        LEADING_SPACE_REGEX,\n                        context.ignoreLeadingSpaces ? '' : NONE_BREAK_SPACE\n                    );\n                }\n\n                if (last == SPACE) {\n                    // 2. Multiple trailing space => single space\n                    segment.text = segment.text.replace(\n                        TRAILING_SPACE_REGEX,\n                        context.ignoreTrailingSpaces ? SPACE : NONE_BREAK_SPACE\n                    );\n                }\n            }\n\n            context.ignoreLeadingSpaces = last == SPACE;\n\n            break;\n    }\n}\n\nfunction normalizeTextSegments(\n    segments: ContentModelText[],\n    lastInlineSegment: ContentModelSegment | undefined\n) {\n    segments.forEach(segment => {\n        // 3. Segment ends with &nbsp; replace it with space if the previous char is not space so that next segment can wrap\n        // Only do this for segments that is not the last one since the last space will be removed in step 4\n        if (segment != lastInlineSegment) {\n            const text = segment.text;\n\n            if (\n                text.substr(-1) == NONE_BREAK_SPACE &&\n                text.length > 1 &&\n                text.substr(-2, 1) != SPACE\n            ) {\n                segment.text = text.substring(0, text.length - 1) + SPACE;\n            }\n        }\n    });\n}\n\nfunction normalizeLastTextSegment(\n    segment: ContentModelText | undefined,\n    lastInlineSegment: ContentModelSegment | undefined\n) {\n    if (segment && segment == lastInlineSegment && segment?.text.substr(-1) == SPACE) {\n        // 4. last text segment of the paragraph, remove trailing space\n        segment.text = segment.text.replace(TRAILING_SPACE_REGEX, '');\n    }\n}\n","import { setParagraphNotImplicit } from '../block/setParagraphNotImplicit';\nimport type { ContentModelBlock, ContentModelBlockGroup } from 'roosterjs-content-model-types';\n\n/**\n * Unwrap a given block group, move its child blocks to be under its parent group\n * @param parent Parent block group of the unwrapping group\n * @param groupToUnwrap  The block group to unwrap\n */\nexport function unwrapBlock(\n    parent: ContentModelBlockGroup | null,\n    groupToUnwrap: ContentModelBlockGroup & ContentModelBlock\n) {\n    const index = parent?.blocks.indexOf(groupToUnwrap) ?? -1;\n\n    if (index >= 0) {\n        groupToUnwrap.blocks.forEach(setParagraphNotImplicit);\n\n        parent?.blocks.splice(index, 1, ...groupToUnwrap.blocks);\n    }\n}\n","import type { ContentModelBr, ContentModelSegmentFormat } from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelBr model\n * @param format @optional The format of this model\n */\nexport function createBr(format?: ContentModelSegmentFormat): ContentModelBr {\n    return {\n        segmentType: 'Br',\n        format: format ? { ...format } : {},\n    };\n}\n","import type {\n    ContentModelDocument,\n    ContentModelSegmentFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelDocument model\n * @param defaultFormat @optional Default format of this model\n */\nexport function createContentModelDocument(\n    defaultFormat?: ContentModelSegmentFormat\n): ContentModelDocument {\n    const result: ContentModelDocument = {\n        blockGroupType: 'Document',\n        blocks: [],\n    };\n\n    if (defaultFormat) {\n        result.format = defaultFormat;\n    }\n\n    return result;\n}\n","import type { ContentModelBlockFormat, ContentModelDivider } from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelDivider model\n * @param tagName Tag name of this divider. Currently only hr and div are supported\n * @param format @optional The format of this model\n */\nexport function createDivider(\n    tagName: 'hr' | 'div',\n    format?: ContentModelBlockFormat\n): ContentModelDivider {\n    return {\n        blockType: 'Divider',\n        tagName,\n        format: format ? { ...format } : {},\n    };\n}\n","import { createBr } from './createBr';\nimport { createContentModelDocument } from './createContentModelDocument';\nimport { createParagraph } from './createParagraph';\nimport { createSelectionMarker } from './createSelectionMarker';\nimport type {\n    ContentModelDocument,\n    ContentModelSegmentFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create an empty Content Model Document with initial empty line and insert point with default format\n * @param format @optional The default format to be applied to this Content Model\n */\nexport function createEmptyModel(format?: ContentModelSegmentFormat): ContentModelDocument {\n    const model = createContentModelDocument(format);\n    const paragraph = createParagraph(false /*isImplicit*/, undefined /*blockFormat*/, format);\n\n    paragraph.segments.push(createSelectionMarker(format), createBr(format));\n    model.blocks.push(paragraph);\n\n    return model;\n}\n","import type { ContentModelEntity, ContentModelSegmentFormat } from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelEntity model\n * @param wrapper Wrapper element of this entity\n * @param isReadonly Whether this is a readonly entity @default true\n * @param segmentFormat @optional Segment format of this entity\n * @param type @optional Type of this entity\n * @param id @optional Id of this entity\n */\nexport function createEntity(\n    wrapper: HTMLElement,\n    isReadonly: boolean = true,\n    segmentFormat?: ContentModelSegmentFormat,\n    type?: string,\n    id?: string\n): ContentModelEntity {\n    return {\n        segmentType: 'Entity',\n        blockType: 'Entity',\n        format: { ...segmentFormat },\n        entityFormat: {\n            id,\n            entityType: type,\n            isReadonly,\n        },\n        wrapper,\n    };\n}\n","import type {\n    ContentModelFormatContainer,\n    ContentModelFormatContainerFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelFormatContainer model\n * @param tag Tag name of this format container, in lower case\n * @param format @optional The format of this model\n */\nexport function createFormatContainer(\n    tag: Lowercase<string>,\n    format?: ContentModelFormatContainerFormat\n): ContentModelFormatContainer {\n    return {\n        blockType: 'BlockGroup',\n        blockGroupType: 'FormatContainer',\n        tagName: tag,\n        blocks: [],\n        format: { ...(format || {}) },\n    };\n}\n","import type { ContentModelGeneralBlock } from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelGeneralBlock model\n * @param element Original element of this model\n */\nexport function createGeneralBlock(element: HTMLElement): ContentModelGeneralBlock {\n    return {\n        blockType: 'BlockGroup',\n        blockGroupType: 'General',\n        element: element,\n        blocks: [],\n        format: {},\n    };\n}\n","import type {\n    ContentModelGeneralSegment,\n    ContentModelSegmentFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelGeneralSegment model\n * @param element The original DOM element\n * @param format @optional The format of this model\n */\nexport function createGeneralSegment(\n    element: HTMLElement,\n    format?: ContentModelSegmentFormat\n): ContentModelGeneralSegment {\n    return {\n        blockType: 'BlockGroup',\n        blockGroupType: 'General',\n        segmentType: 'General',\n        format: format ? { ...format } : {},\n        blocks: [],\n        element: element,\n    };\n}\n","import type { ContentModelImage, ContentModelImageFormat } from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelImage model\n * @param src Image source\n * @param format @optional The format of this model\n */\nexport function createImage(src: string, format?: ContentModelImageFormat): ContentModelImage {\n    return {\n        segmentType: 'Image',\n        src: src,\n        format: format ? { ...format } : {},\n        dataset: {},\n    };\n}\n","import { createListLevel } from './createListLevel';\nimport { createSelectionMarker } from './createSelectionMarker';\nimport type {\n    ContentModelListItem,\n    ContentModelListLevel,\n    ContentModelSegmentFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelListItem model\n * @param levels Existing list levels\n * @param format @optional The format of this model\n */\nexport function createListItem(\n    levels: ContentModelListLevel[],\n    format?: ContentModelSegmentFormat\n): ContentModelListItem {\n    return {\n        blockType: 'BlockGroup',\n        blockGroupType: 'ListItem',\n        blocks: [],\n        levels: levels\n            ? levels.map(level => createListLevel(level.listType, level.format, level.dataset))\n            : [],\n        formatHolder: createSelectionMarker(format),\n        format: {},\n    };\n}\n","import type {\n    ContentModelListItemLevelFormat,\n    ContentModelListLevel,\n    DatasetFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelListLevel model\n * @param listType Tag name of the list, either OL or UL\n * @param format @optional The format of this model\n * @param dataset @optional The dataset of this model\n */\nexport function createListLevel(\n    listType: 'OL' | 'UL',\n    format?: ContentModelListItemLevelFormat,\n    dataset?: DatasetFormat\n): ContentModelListLevel {\n    return {\n        listType,\n        format: { ...format },\n        dataset: { ...dataset },\n    };\n}\n","import type {\n    ContentModelBlockFormat,\n    ContentModelParagraph,\n    ContentModelParagraphDecorator,\n    ContentModelSegmentFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelParagraph model\n * @param isImplicit @optional Whether this is an implicit paragraph. An implicit paragraph is a paragraph that will not render with DOM element container\n * @param blockFormat @optional Format of this paragraph\n * @param segmentFormat @optional Segment format applied to this block\n * @param decorator @optional Decorator of this paragraph\n */\nexport function createParagraph(\n    isImplicit?: boolean,\n    blockFormat?: ContentModelBlockFormat,\n    segmentFormat?: ContentModelSegmentFormat,\n    decorator?: ContentModelParagraphDecorator\n): ContentModelParagraph {\n    const result: ContentModelParagraph = {\n        blockType: 'Paragraph',\n        segments: [],\n        format: blockFormat ? { ...blockFormat } : {},\n    };\n\n    if (segmentFormat && Object.keys(segmentFormat).length > 0) {\n        result.segmentFormat = { ...segmentFormat };\n    }\n\n    if (isImplicit) {\n        result.isImplicit = true;\n    }\n\n    if (decorator) {\n        result.decorator = {\n            tagName: decorator.tagName,\n            format: { ...decorator.format },\n        };\n    }\n\n    return result;\n}\n","import type {\n    ContentModelParagraphDecorator,\n    ContentModelSegmentFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelParagraphDecorator model\n * @param tagName Tag name of this decorator\n * @param format @optional The format of this model\n */\nexport function createParagraphDecorator(\n    tagName: string,\n    format?: ContentModelSegmentFormat\n): ContentModelParagraphDecorator {\n    return {\n        tagName: tagName.toLocaleLowerCase(),\n        format: { ...(format || {}) },\n    };\n}\n","import type {\n    ContentModelSegmentFormat,\n    ContentModelSelectionMarker,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelSelectionMarker model\n * @param format @optional The format of this model\n */\nexport function createSelectionMarker(\n    format?: ContentModelSegmentFormat\n): ContentModelSelectionMarker {\n    return {\n        segmentType: 'SelectionMarker',\n        isSelected: true,\n        format: format ? { ...format } : {},\n    };\n}\n","import type {\n    ContentModelTable,\n    ContentModelTableFormat,\n    ContentModelTableRow,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelTable model\n * @param rowCount Count of rows of this table\n * @param format @optional The format of this model\n */\nexport function createTable(rowCount: number, format?: ContentModelTableFormat): ContentModelTable {\n    const rows: ContentModelTableRow[] = [];\n\n    for (let i = 0; i < rowCount; i++) {\n        rows.push({\n            height: 0,\n            format: {},\n            cells: [],\n        });\n    }\n\n    return {\n        blockType: 'Table',\n        rows,\n        format: { ...(format || {}) },\n        widths: [],\n        dataset: {},\n    };\n}\n","import type {\n    ContentModelTableCell,\n    ContentModelTableCellFormat,\n    DatasetFormat,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelTableCell model\n * @param spanLeftOrColSpan @optional Whether this is a table cell merged with its left cell, or colspan number @default false\n * @param spanAboveOrRowSpan Whether this is a table cell merged with its upper cell, or rowSpan number @default false\n * @param isHeader @optional Whether this is a header cell @default false\n * @param format @optional The format of this model\n */\nexport function createTableCell(\n    spanLeftOrColSpan?: boolean | number,\n    spanAboveOrRowSpan?: boolean | number,\n    isHeader?: boolean,\n    format?: ContentModelTableCellFormat,\n    dataset?: DatasetFormat\n): ContentModelTableCell {\n    const spanLeft =\n        typeof spanLeftOrColSpan === 'number' ? spanLeftOrColSpan > 1 : !!spanLeftOrColSpan;\n    const spanAbove =\n        typeof spanAboveOrRowSpan === 'number' ? spanAboveOrRowSpan > 1 : !!spanAboveOrRowSpan;\n    return {\n        blockGroupType: 'TableCell',\n        blocks: [],\n        format: format ? { ...format } : {},\n        spanLeft,\n        spanAbove,\n        isHeader: !!isHeader,\n        dataset: { ...dataset },\n    };\n}\n","import { addCode, addLink } from '../common/addDecorators';\nimport type {\n    ContentModelCode,\n    ContentModelLink,\n    ContentModelSegmentFormat,\n    ContentModelText,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create a ContentModelText model\n * @param text Text of this model\n * @param format @optional The format of this model\n * @param link @optional The link decorator\n * @param code @option The code decorator\n */\nexport function createText(\n    text: string,\n    format?: ContentModelSegmentFormat,\n    link?: ContentModelLink,\n    code?: ContentModelCode\n): ContentModelText {\n    const result: ContentModelText = {\n        segmentType: 'Text',\n        text: text,\n        format: format ? { ...format } : {},\n    };\n\n    if (link) {\n        addLink(result, link);\n    }\n\n    if (code) {\n        addCode(result, code);\n    }\n\n    return result;\n}\n","import toArray from '../domUtils/toArray';\nimport { isNodeOfType } from '../domUtils/isNodeOfType';\nimport type {\n    ContentModelDocument,\n    DOMSelection,\n    ModelToDomBlockAndSegmentNode,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create DOM tree fragment from Content Model document\n * @param doc Document object of the target DOM tree\n * @param root Target node that will become the container of new DOM tree.\n * When a DOM node with existing node is passed, it will be merged with content model so that unchanged blocks\n * won't be touched.\n * @param model The content model document to generate DOM tree from\n * @param context The context object for Content Model to DOM conversion\n * @returns The selection range created in DOM tree from this model, or null when there is no selection\n */\nexport function contentModelToDom(\n    doc: Document,\n    root: Node,\n    model: ContentModelDocument,\n    context: ModelToDomContext\n): DOMSelection | null {\n    context.modelHandlers.blockGroupChildren(doc, root, model, context);\n\n    const range = extractSelectionRange(doc, context);\n\n    root.normalize();\n\n    return range;\n}\n\nfunction extractSelectionRange(doc: Document, context: ModelToDomContext): DOMSelection | null {\n    const {\n        regularSelection: { start, end },\n        tableSelection,\n        imageSelection,\n    } = context;\n\n    let startPosition: { container: Node; offset: number } | undefined;\n    let endPosition: { container: Node; offset: number } | undefined;\n\n    if (imageSelection) {\n        return imageSelection;\n    } else if (\n        (startPosition = start && calcPosition(start)) &&\n        (endPosition = end && calcPosition(end))\n    ) {\n        const range = doc.createRange();\n\n        range.setStart(startPosition.container, startPosition.offset);\n        range.setEnd(endPosition.container, endPosition.offset);\n\n        return {\n            type: 'range',\n            range,\n            isReverted: false,\n        };\n    } else if (tableSelection) {\n        return tableSelection;\n    } else {\n        return null;\n    }\n}\n\nfunction calcPosition(\n    pos: ModelToDomBlockAndSegmentNode\n): { container: Node; offset: number } | undefined {\n    let result: { container: Node; offset: number } | undefined;\n\n    if (pos.block) {\n        if (!pos.segment) {\n            result = { container: pos.block, offset: 0 };\n        } else if (isNodeOfType(pos.segment, 'TEXT_NODE')) {\n            result = { container: pos.segment, offset: pos.segment.nodeValue?.length || 0 };\n        } else if (pos.segment.parentNode) {\n            result = {\n                container: pos.segment.parentNode,\n                offset:\n                    toArray(pos.segment.parentNode.childNodes as NodeListOf<Node>).indexOf(\n                        pos.segment\n                    ) + 1,\n            };\n        }\n    }\n\n    if (result && isNodeOfType(result.container, 'DOCUMENT_FRAGMENT_NODE')) {\n        const childNodes = result.container.childNodes;\n\n        if (childNodes.length > result.offset) {\n            result = { container: childNodes[result.offset], offset: 0 };\n        } else if (result.container.lastChild) {\n            const container = result.container.lastChild;\n            result = {\n                container,\n                offset: isNodeOfType(container, 'TEXT_NODE')\n                    ? container.nodeValue?.length ?? 0\n                    : container.childNodes.length,\n            };\n        } else {\n            result = undefined;\n        }\n    }\n\n    return result;\n}\n","import { defaultContentModelHandlers } from './defaultContentModelHandlers';\nimport { getObjectKeys } from '../../domUtils/getObjectKeys';\nimport {\n    defaultFormatAppliers,\n    defaultFormatKeysPerCategory,\n} from '../../formatHandlers/defaultFormatHandlers';\nimport type {\n    EditorContext,\n    FormatApplier,\n    FormatAppliers,\n    FormatAppliersPerCategory,\n    ModelToDomContext,\n    ModelToDomFormatContext,\n    ModelToDomOption,\n    ModelToDomSelectionContext,\n    ModelToDomSettings,\n    TextFormatApplier,\n} from 'roosterjs-content-model-types';\n\n/**\n * Create context object fro Content Model to DOM conversion\n * @param editorContext Context of editor\n * @param options Option array to customize the Model to DOM conversion behavior\n */\nexport function createModelToDomContext(\n    editorContext?: EditorContext,\n    ...options: (ModelToDomOption | undefined)[]\n): ModelToDomContext {\n    return createModelToDomContextWithConfig(createModelToDomConfig(options), editorContext);\n}\n\n/**\n * Create context object for Content Model to DOM conversion with an existing configure\n * @param config A full config object to define how to convert Content Model to DOM tree\n * @param editorContext Context of editor\n */\nexport function createModelToDomContextWithConfig(\n    config: ModelToDomSettings,\n    editorContext?: EditorContext\n) {\n    return Object.assign(\n        {},\n        editorContext,\n        createModelToDomSelectionContext(),\n        createModelToDomFormatContext(),\n        config\n    );\n}\n\nfunction createModelToDomSelectionContext(): ModelToDomSelectionContext {\n    return {\n        regularSelection: {\n            current: {\n                block: null,\n                segment: null,\n            },\n        },\n    };\n}\n\nfunction createModelToDomFormatContext(): ModelToDomFormatContext {\n    return {\n        listFormat: {\n            threadItemCounts: [],\n            nodeStack: [],\n        },\n        implicitFormat: {},\n    };\n}\n\n/**\n * Create Content Model to DOM Config object\n * @param options All customizations of DOM creation\n */\nexport function createModelToDomConfig(\n    options: (ModelToDomOption | undefined)[]\n): ModelToDomSettings {\n    return {\n        modelHandlers: Object.assign(\n            {},\n            defaultContentModelHandlers,\n            ...options.map(x => x?.modelHandlerOverride)\n        ),\n        formatAppliers: buildFormatAppliers(\n            options.map(x => x?.formatApplierOverride),\n            options.map(x => x?.additionalFormatAppliers)\n        ),\n        defaultModelHandlers: defaultContentModelHandlers,\n        defaultFormatAppliers,\n        metadataAppliers: Object.assign({}, ...options.map(x => x?.metadataAppliers)),\n    };\n}\n\n/**\n * @internal Export for test only\n * Build format appliers used by Content Model to DOM conversion\n */\nexport function buildFormatAppliers(\n    overrides: (Partial<FormatAppliers> | undefined)[] = [],\n    additionalAppliersArray: (Partial<FormatAppliersPerCategory> | undefined)[] = []\n): FormatAppliersPerCategory {\n    const combinedOverrides = Object.assign({}, ...overrides);\n\n    const result = getObjectKeys(defaultFormatKeysPerCategory).reduce(\n        (result, key) => {\n            const value = defaultFormatKeysPerCategory[key]\n                .map(\n                    formatKey =>\n                        (combinedOverrides[formatKey] === undefined\n                            ? defaultFormatAppliers[formatKey]\n                            : combinedOverrides[formatKey]) as FormatApplier<any>\n                )\n                .concat(\n                    ...additionalAppliersArray.map(\n                        appliers => (appliers?.[key] ?? []) as FormatApplier<any>[]\n                    )\n                );\n\n            result[key] = value;\n\n            return result;\n        },\n        {\n            text: [] as TextFormatApplier[],\n        } as FormatAppliersPerCategory\n    );\n\n    additionalAppliersArray.forEach(appliers => {\n        if (appliers?.text) {\n            result.text = result.text.concat(appliers.text);\n        }\n    });\n\n    return result;\n}\n","import { handleBlock } from '../handlers/handleBlock';\nimport { handleBlockGroupChildren } from '../handlers/handleBlockGroupChildren';\nimport { handleBr } from '../handlers/handleBr';\nimport { handleDivider } from '../handlers/handleDivider';\nimport { handleEntityBlock, handleEntitySegment } from '../handlers/handleEntity';\nimport { handleFormatContainer } from '../handlers/handleFormatContainer';\nimport { handleGeneralBlock, handleGeneralSegment } from '../handlers/handleGeneralModel';\nimport { handleImage } from '../handlers/handleImage';\nimport { handleList } from '../handlers/handleList';\nimport { handleListItem } from '../handlers/handleListItem';\nimport { handleParagraph } from '../handlers/handleParagraph';\nimport { handleSegment } from '../handlers/handleSegment';\nimport { handleSegmentDecorator } from '../handlers/handleSegmentDecorator';\nimport { handleTable } from '../handlers/handleTable';\nimport { handleText } from '../handlers/handleText';\nimport type { ContentModelHandlerMap } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const defaultContentModelHandlers: ContentModelHandlerMap = {\n    block: handleBlock,\n    blockGroupChildren: handleBlockGroupChildren,\n    br: handleBr,\n    entityBlock: handleEntityBlock,\n    entitySegment: handleEntitySegment,\n    generalBlock: handleGeneralBlock,\n    generalSegment: handleGeneralSegment,\n    divider: handleDivider,\n    image: handleImage,\n    list: handleList,\n    listItem: handleListItem,\n    paragraph: handleParagraph,\n    formatContainer: handleFormatContainer,\n    segment: handleSegment,\n    segmentDecorator: handleSegmentDecorator,\n    table: handleTable,\n    text: handleText,\n};\n","import type {\n    ContentModelBlock,\n    ContentModelBlockHandler,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleBlock: ContentModelBlockHandler<ContentModelBlock> = (\n    doc: Document,\n    parent: Node,\n    block: ContentModelBlock,\n    context: ModelToDomContext,\n    refNode: Node | null\n) => {\n    const handlers = context.modelHandlers;\n\n    switch (block.blockType) {\n        case 'Table':\n            refNode = handlers.table(doc, parent, block, context, refNode);\n            break;\n        case 'Paragraph':\n            refNode = handlers.paragraph(doc, parent, block, context, refNode);\n            break;\n        case 'Entity':\n            refNode = handlers.entityBlock(doc, parent, block, context, refNode);\n            break;\n        case 'Divider':\n            refNode = handlers.divider(doc, parent, block, context, refNode);\n            break;\n        case 'BlockGroup':\n            switch (block.blockGroupType) {\n                case 'General':\n                    refNode = handlers.generalBlock(doc, parent, block, context, refNode);\n                    break;\n\n                case 'FormatContainer':\n                    refNode = handlers.formatContainer(doc, parent, block, context, refNode);\n                    break;\n\n                case 'ListItem':\n                    refNode = handlers.listItem(doc, parent, block, context, refNode);\n                    break;\n            }\n\n            break;\n    }\n\n    return refNode;\n};\n","import type {\n    ContentModelBlockGroup,\n    ContentModelHandler,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleBlockGroupChildren: ContentModelHandler<ContentModelBlockGroup> = (\n    doc: Document,\n    parent: Node,\n    group: ContentModelBlockGroup,\n    context: ModelToDomContext\n) => {\n    const { listFormat } = context;\n    const nodeStack = listFormat.nodeStack;\n    let refNode: Node | null = parent.firstChild;\n\n    try {\n        group.blocks.forEach((childBlock, index) => {\n            // When process list, we need a node stack.\n            // When there are two continuous lists, they should share the same stack\n            // so that list items with same type/threadId can be merged into the same list element\n            // In other cases, clear the stack so that two separate lists won't share the same list element\n            if (\n                index == 0 ||\n                childBlock.blockType != 'BlockGroup' ||\n                childBlock.blockGroupType != 'ListItem'\n            ) {\n                listFormat.nodeStack = [];\n            }\n\n            refNode = context.modelHandlers.block(doc, parent, childBlock, context, refNode);\n        });\n\n        // Remove all rest node if any since they don't appear in content model\n        while (refNode) {\n            const next = refNode.nextSibling;\n\n            refNode.parentNode?.removeChild(refNode);\n            refNode = next;\n        }\n    } finally {\n        listFormat.nodeStack = nodeStack;\n    }\n};\n","import { handleSegmentCommon } from '../utils/handleSegmentCommon';\nimport type { ContentModelBr, ContentModelSegmentHandler } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleBr: ContentModelSegmentHandler<ContentModelBr> = (\n    doc,\n    parent,\n    segment,\n    context,\n    segmentNodes\n) => {\n    const br = doc.createElement('br');\n    const element = doc.createElement('span');\n    element.appendChild(br);\n    parent.appendChild(element);\n\n    handleSegmentCommon(doc, br, element, segment, context, segmentNodes);\n};\n","import { applyFormat } from '../utils/applyFormat';\nimport { reuseCachedElement } from '../../domUtils/reuseCachedElement';\nimport type {\n    ContentModelBlockHandler,\n    ContentModelDivider,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleDivider: ContentModelBlockHandler<ContentModelDivider> = (\n    doc: Document,\n    parent: Node,\n    divider: ContentModelDivider,\n    context: ModelToDomContext,\n    refNode: Node | null\n) => {\n    let element = context.allowCacheElement ? divider.cachedElement : undefined;\n\n    if (element) {\n        refNode = reuseCachedElement(parent, element, refNode);\n    } else {\n        element = doc.createElement(divider.tagName);\n\n        if (context.allowCacheElement) {\n            divider.cachedElement = element;\n        }\n\n        parent.insertBefore(element, refNode);\n\n        applyFormat(element, context.formatAppliers.divider, divider.format, context);\n\n        if (divider.size) {\n            element.setAttribute('size', divider.size);\n        }\n    }\n\n    context.onNodeCreated?.(divider, element);\n\n    return refNode;\n};\n","import { addDelimiters } from '../../domUtils/entityUtils';\nimport { applyFormat } from '../utils/applyFormat';\nimport { getObjectKeys } from '../../domUtils/getObjectKeys';\nimport { reuseCachedElement } from '../../domUtils/reuseCachedElement';\nimport { wrap } from '../../domUtils/wrap';\nimport type {\n    ContentModelBlockHandler,\n    ContentModelEntity,\n    ContentModelSegmentFormat,\n    ContentModelSegmentHandler,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\nconst BlockEntityContainer = '_E_EBlockEntityContainer';\n\n/**\n * @internal\n */\nexport const handleEntityBlock: ContentModelBlockHandler<ContentModelEntity> = (\n    doc,\n    parent,\n    entityModel,\n    context,\n    refNode\n) => {\n    const { entityFormat, wrapper } = entityModel;\n\n    applyFormat(wrapper, context.formatAppliers.entity, entityFormat, context);\n\n    const isCursorAroundEntity =\n        context.addDelimiterForEntity &&\n        wrapper.style.display == 'inline-block' &&\n        wrapper.style.width == '100%';\n    const isContained = wrapper.parentElement?.classList.contains(BlockEntityContainer);\n    const elementToReuse = isContained && isCursorAroundEntity ? wrapper.parentElement! : wrapper;\n\n    refNode = reuseCachedElement(parent, elementToReuse, refNode);\n\n    if (isCursorAroundEntity) {\n        if (!isContained) {\n            const element = wrap(doc, wrapper, 'div');\n            element.classList.add(BlockEntityContainer);\n        }\n        addDelimiters(doc, wrapper, getSegmentFormat(context), context);\n    }\n\n    context.onNodeCreated?.(entityModel, wrapper);\n\n    return refNode;\n};\n\n/**\n * @internal\n */\nexport const handleEntitySegment: ContentModelSegmentHandler<ContentModelEntity> = (\n    doc,\n    parent,\n    entityModel,\n    context,\n    newSegments\n) => {\n    const { entityFormat, wrapper, format } = entityModel;\n\n    parent.appendChild(wrapper);\n    newSegments?.push(wrapper);\n\n    if (getObjectKeys(format).length > 0) {\n        const span = wrap(doc, wrapper, 'span');\n\n        applyFormat(span, context.formatAppliers.segment, format, context);\n    }\n\n    applyFormat(wrapper, context.formatAppliers.entity, entityFormat, context);\n\n    if (context.addDelimiterForEntity && entityFormat.isReadonly) {\n        const [after, before] = addDelimiters(doc, wrapper, getSegmentFormat(context), context);\n\n        newSegments?.push(after, before);\n        context.regularSelection.current.segment = after;\n    } else {\n        context.regularSelection.current.segment = wrapper;\n    }\n\n    context.onNodeCreated?.(entityModel, wrapper);\n};\nfunction getSegmentFormat(\n    context: ModelToDomContext\n): ContentModelSegmentFormat | null | undefined {\n    return {\n        ...context.pendingFormat?.format,\n        ...context.defaultFormat,\n    };\n}\n","import { applyFormat } from '../utils/applyFormat';\nimport { isBlockGroupEmpty } from '../../modelApi/common/isEmpty';\nimport { reuseCachedElement } from '../../domUtils/reuseCachedElement';\nimport { stackFormat } from '../utils/stackFormat';\nimport type {\n    ContentModelBlockFormat,\n    ContentModelBlockHandler,\n    ContentModelFormatContainer,\n    ContentModelSegmentFormat,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\nconst PreChildFormat: ContentModelSegmentFormat & ContentModelBlockFormat = {\n    fontFamily: 'monospace',\n    whiteSpace: 'pre',\n};\n\n/**\n * @internal\n */\nexport const handleFormatContainer: ContentModelBlockHandler<ContentModelFormatContainer> = (\n    doc: Document,\n    parent: Node,\n    container: ContentModelFormatContainer,\n    context: ModelToDomContext,\n    refNode: Node | null\n) => {\n    let element = context.allowCacheElement ? container.cachedElement : undefined;\n\n    if (element) {\n        refNode = reuseCachedElement(parent, element, refNode);\n\n        context.modelHandlers.blockGroupChildren(doc, element, container, context);\n    } else if (!isBlockGroupEmpty(container)) {\n        const containerNode = doc.createElement(container.tagName);\n\n        if (context.allowCacheElement) {\n            container.cachedElement = containerNode;\n        }\n\n        parent.insertBefore(containerNode, refNode);\n\n        stackFormat(context, container.tagName, () => {\n            applyFormat(containerNode, context.formatAppliers.container, container.format, context);\n            applyFormat(\n                containerNode,\n                context.formatAppliers.segmentOnBlock,\n                container.format,\n                context\n            );\n\n            applyFormat(containerNode, context.formatAppliers.container, container.format, context);\n        });\n\n        if (container.tagName == 'pre') {\n            stackFormat(context, PreChildFormat, () => {\n                context.modelHandlers.blockGroupChildren(doc, containerNode, container, context);\n            });\n        } else {\n            context.modelHandlers.blockGroupChildren(doc, containerNode, container, context);\n        }\n\n        element = containerNode;\n    }\n\n    if (element) {\n        context.onNodeCreated?.(container, element);\n    }\n\n    return refNode;\n};\n","import { applyFormat } from '../utils/applyFormat';\nimport { handleSegmentCommon } from '../utils/handleSegmentCommon';\nimport { isNodeOfType } from '../../domUtils/isNodeOfType';\nimport { reuseCachedElement } from '../../domUtils/reuseCachedElement';\nimport { wrap } from '../../domUtils/wrap';\nimport type {\n    ContentModelBlockHandler,\n    ContentModelGeneralBlock,\n    ContentModelGeneralSegment,\n    ContentModelSegmentHandler,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleGeneralBlock: ContentModelBlockHandler<ContentModelGeneralBlock> = (\n    doc,\n    parent,\n    group,\n    context,\n    refNode\n) => {\n    let node: HTMLElement = group.element;\n\n    if (refNode && node.parentNode == parent) {\n        refNode = reuseCachedElement(parent, node, refNode);\n    } else {\n        node = node.cloneNode() as HTMLElement;\n        group.element = node as HTMLElement;\n\n        applyFormat(node, context.formatAppliers.general, group.format, context);\n\n        parent.insertBefore(node, refNode);\n    }\n\n    context.onNodeCreated?.(group, node);\n    context.modelHandlers.blockGroupChildren(doc, node, group, context);\n\n    return refNode;\n};\n\n/**\n * @internal\n */\nexport const handleGeneralSegment: ContentModelSegmentHandler<ContentModelGeneralSegment> = (\n    doc,\n    parent,\n    group,\n    context,\n    segmentNodes\n) => {\n    const node = group.element.cloneNode() as HTMLElement;\n    group.element = node;\n    parent.appendChild(node);\n\n    if (isNodeOfType(node, 'ELEMENT_NODE')) {\n        const element = wrap(doc, node, 'span');\n\n        handleSegmentCommon(doc, node, element, group, context, segmentNodes);\n        applyFormat(node, context.formatAppliers.general, group.format, context);\n\n        context.onNodeCreated?.(group, node);\n    }\n\n    context.modelHandlers.blockGroupChildren(doc, node, group, context);\n};\n","import { applyFormat } from '../utils/applyFormat';\nimport { handleSegmentCommon } from '../utils/handleSegmentCommon';\nimport { parseValueWithUnit } from '../../formatHandlers/utils/parseValueWithUnit';\nimport type { ContentModelImage, ContentModelSegmentHandler } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleImage: ContentModelSegmentHandler<ContentModelImage> = (\n    doc,\n    parent,\n    imageModel,\n    context,\n    segmentNodes\n) => {\n    const img = doc.createElement('img');\n    const element = document.createElement('span');\n\n    parent.appendChild(element);\n    element.appendChild(img);\n\n    img.src = imageModel.src;\n\n    if (imageModel.alt) {\n        img.alt = imageModel.alt;\n    }\n\n    if (imageModel.title) {\n        img.title = imageModel.title;\n    }\n\n    applyFormat(img, context.formatAppliers.image, imageModel.format, context);\n    applyFormat(img, context.formatAppliers.dataset, imageModel.dataset, context);\n\n    const { width, height } = imageModel.format;\n    const widthNum = width ? parseValueWithUnit(width) : 0;\n    const heightNum = height ? parseValueWithUnit(height) : 0;\n\n    if (widthNum > 0) {\n        img.width = widthNum;\n    }\n\n    if (heightNum > 0) {\n        img.height = heightNum;\n    }\n\n    if (imageModel.isSelectedAsImageSelection) {\n        context.imageSelection = {\n            type: 'image',\n            image: img,\n        };\n    }\n\n    handleSegmentCommon(doc, img, element, imageModel, context, segmentNodes);\n};\n","import { applyFormat } from '../utils/applyFormat';\nimport { applyMetadata } from '../utils/applyMetadata';\nimport type {\n    ContentModelBlockHandler,\n    ContentModelListItem,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleList: ContentModelBlockHandler<ContentModelListItem> = (\n    doc: Document,\n    parent: Node,\n    listItem: ContentModelListItem,\n    context: ModelToDomContext,\n    refNode: Node | null\n) => {\n    let layer = 0;\n    const { nodeStack } = context.listFormat;\n\n    if (nodeStack.length == 0) {\n        nodeStack.push({\n            node: parent,\n        });\n    }\n\n    // Skip existing list levels that has same properties so we can reuse them\n    for (; layer < listItem.levels.length && layer + 1 < nodeStack.length; layer++) {\n        const stackLevel = nodeStack[layer + 1];\n        const itemLevel = listItem.levels[layer];\n\n        if (\n            stackLevel.listType != itemLevel.listType ||\n            stackLevel.dataset?.editingInfo != itemLevel.dataset.editingInfo ||\n            (itemLevel.listType == 'OL' && typeof itemLevel.format.startNumberOverride === 'number')\n        ) {\n            break;\n        }\n    }\n\n    // Cut off remained list levels that we can't reuse\n    nodeStack.splice(layer + 1);\n\n    // Create new list levels that are after reused ones\n    for (; layer < listItem.levels.length; layer++) {\n        const level = listItem.levels[layer];\n        const newList = doc.createElement(level.listType || 'UL');\n        const lastParent = nodeStack[nodeStack.length - 1].node;\n\n        lastParent.insertBefore(newList, layer == 0 ? refNode : null);\n        nodeStack.push({ node: newList, ...level });\n\n        applyFormat(newList, context.formatAppliers.listLevelThread, level.format, context);\n\n        // Need to apply metadata after applying list level format since the list numbers value relies on the result of list thread handling\n        applyMetadata(level, context.metadataAppliers.listLevel, level.format, context);\n\n        // Need to apply listItemElement formats after applying metadata since the list numbers value relies on the result of metadata handling\n        applyFormat(newList, context.formatAppliers.listLevel, level.format, context);\n        applyFormat(newList, context.formatAppliers.dataset, level.dataset, context);\n\n        context.onNodeCreated?.(level, newList);\n    }\n\n    return refNode;\n};\n","import { applyFormat } from '../utils/applyFormat';\nimport { applyMetadata } from '../utils/applyMetadata';\nimport { setParagraphNotImplicit } from '../../modelApi/block/setParagraphNotImplicit';\nimport { unwrap } from '../../domUtils/unwrap';\nimport type {\n    ContentModelBlockHandler,\n    ContentModelListItem,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleListItem: ContentModelBlockHandler<ContentModelListItem> = (\n    doc: Document,\n    parent: Node,\n    listItem: ContentModelListItem,\n    context: ModelToDomContext,\n    refNode: Node | null\n) => {\n    refNode = context.modelHandlers.list(doc, parent, listItem, context, refNode);\n\n    const { nodeStack } = context.listFormat;\n\n    const listParent = nodeStack?.[nodeStack?.length - 1]?.node || parent;\n    const li = doc.createElement('li');\n    const level = listItem.levels[listItem.levels.length - 1];\n\n    // It is possible listParent is the same with parent param.\n    // This happens when outdent a list item to cause it has no list level\n    listParent.insertBefore(li, refNode?.parentNode == listParent ? refNode : null);\n\n    if (level) {\n        applyFormat(li, context.formatAppliers.segment, listItem.formatHolder.format, context);\n        applyFormat(li, context.formatAppliers.listItemThread, level.format, context);\n\n        // Need to apply metadata after applying listItem format since the list numbers value relies on the result of list thread handling\n        applyMetadata(level, context.metadataAppliers.listItem, listItem.format, context);\n\n        // Need to apply listItemElement formats after applying metadata since the list numbers value relies on the result of metadata handling\n        applyFormat(li, context.formatAppliers.listItemElement, listItem.format, context);\n\n        context.modelHandlers.blockGroupChildren(doc, li, listItem, context);\n    } else {\n        // There is no level for this list item, that means it should be moved out of the list\n        // For each paragraph, make it not implicit so it will have a DIV around it, to avoid more paragraphs connected together\n        listItem.blocks.forEach(setParagraphNotImplicit);\n\n        context.modelHandlers.blockGroupChildren(doc, li, listItem, context);\n\n        unwrap(li);\n    }\n\n    context.onNodeCreated?.(listItem, li);\n\n    return refNode;\n};\n","import { applyFormat } from '../utils/applyFormat';\nimport { getObjectKeys } from '../../domUtils/getObjectKeys';\nimport { optimize } from '../optimizers/optimize';\nimport { reuseCachedElement } from '../../domUtils/reuseCachedElement';\nimport { stackFormat } from '../utils/stackFormat';\nimport { unwrap } from '../../domUtils/unwrap';\nimport type {\n    ContentModelBlockHandler,\n    ContentModelParagraph,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\nconst DefaultParagraphTag = 'div';\n\n/**\n * @internal\n */\nexport const handleParagraph: ContentModelBlockHandler<ContentModelParagraph> = (\n    doc: Document,\n    parent: Node,\n    paragraph: ContentModelParagraph,\n    context: ModelToDomContext,\n    refNode: Node | null\n) => {\n    let container = context.allowCacheElement ? paragraph.cachedElement : undefined;\n\n    if (container) {\n        refNode = reuseCachedElement(parent, container, refNode);\n    } else {\n        stackFormat(context, paragraph.decorator?.tagName || null, () => {\n            const needParagraphWrapper =\n                !paragraph.isImplicit ||\n                !!paragraph.decorator ||\n                (getObjectKeys(paragraph.format).length > 0 &&\n                    paragraph.segments.some(segment => segment.segmentType != 'SelectionMarker'));\n            const formatOnWrapper = needParagraphWrapper\n                ? {\n                      ...(paragraph.decorator?.format || {}),\n                      ...paragraph.segmentFormat,\n                  }\n                : {};\n\n            container = doc.createElement(paragraph.decorator?.tagName || DefaultParagraphTag);\n\n            parent.insertBefore(container, refNode);\n\n            context.regularSelection.current = {\n                block: needParagraphWrapper ? container : container.parentNode,\n                segment: null,\n            };\n\n            const handleSegments = () => {\n                const parent = container;\n\n                if (parent) {\n                    const firstSegment = paragraph.segments[0];\n\n                    if (firstSegment?.segmentType == 'SelectionMarker') {\n                        // Make sure there is a segment created before selection marker.\n                        // If selection marker is the first selected segment in a paragraph, create a dummy text node,\n                        // so after rewrite, the regularSelection object can have a valid segment object set to the text node.\n                        context.modelHandlers.text(\n                            doc,\n                            parent,\n                            {\n                                ...firstSegment,\n                                segmentType: 'Text',\n                                text: '',\n                            },\n                            context,\n                            []\n                        );\n                    }\n\n                    paragraph.segments.forEach(segment => {\n                        const newSegments: Node[] = [];\n                        context.modelHandlers.segment(doc, parent, segment, context, newSegments);\n\n                        newSegments.forEach(node => {\n                            context.domIndexer?.onSegment(node, paragraph, [segment]);\n                        });\n                    });\n                }\n            };\n\n            if (needParagraphWrapper) {\n                stackFormat(context, formatOnWrapper, handleSegments);\n\n                applyFormat(container, context.formatAppliers.block, paragraph.format, context);\n                applyFormat(container, context.formatAppliers.container, paragraph.format, context);\n                applyFormat(\n                    container,\n                    context.formatAppliers.segmentOnBlock,\n                    formatOnWrapper,\n                    context\n                );\n            } else {\n                handleSegments();\n            }\n\n            optimize(container);\n\n            // It is possible the next sibling node is changed during processing child segments\n            // e.g. When this paragraph is an implicit paragraph and it contains an inline entity segment\n            // The segment will be appended to container as child then the container will be removed\n            // since this paragraph it is implicit. In that case container.nextSibling will become original\n            // inline entity's next sibling. So reset refNode to its real next sibling (after change) here\n            // to make sure the value is correct.\n            refNode = container.nextSibling;\n\n            if (container) {\n                context.onNodeCreated?.(paragraph, container);\n                context.domIndexer?.onParagraph(container);\n            }\n\n            if (needParagraphWrapper) {\n                if (context.allowCacheElement) {\n                    paragraph.cachedElement = container;\n                }\n            } else {\n                unwrap(container);\n                container = undefined;\n            }\n        });\n    }\n\n    return refNode;\n};\n","import type {\n    ContentModelSegment,\n    ContentModelSegmentHandler,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleSegment: ContentModelSegmentHandler<ContentModelSegment> = (\n    doc,\n    parent,\n    segment,\n    context,\n    segmentNodes\n) => {\n    const regularSelection = context.regularSelection;\n\n    // If start position is not set yet, and current segment is in selection, set start position\n    if (segment.isSelected && !regularSelection.start) {\n        regularSelection.start = {\n            ...regularSelection.current,\n        };\n    }\n\n    switch (segment.segmentType) {\n        case 'Text':\n            context.modelHandlers.text(doc, parent, segment, context, segmentNodes);\n            break;\n\n        case 'Br':\n            context.modelHandlers.br(doc, parent, segment, context, segmentNodes);\n            break;\n\n        case 'Image':\n            context.modelHandlers.image(doc, parent, segment, context, segmentNodes);\n            break;\n\n        case 'General':\n            context.modelHandlers.generalSegment(doc, parent, segment, context, segmentNodes);\n            break;\n\n        case 'Entity':\n            context.modelHandlers.entitySegment(doc, parent, segment, context, segmentNodes);\n            break;\n    }\n\n    // If end position is not set, or it is not finalized, and current segment is still in selection, set end position\n    // If there is other selection, we will overwrite regularSelection.end when we process that segment\n    if (segment.isSelected && regularSelection.start) {\n        regularSelection.end = {\n            ...regularSelection.current,\n        };\n    }\n};\n","import { applyFormat } from '../utils/applyFormat';\nimport { isNodeOfType } from '../../domUtils/isNodeOfType';\nimport { stackFormat } from '../utils/stackFormat';\nimport { wrapAllChildNodes } from '../../domUtils/moveChildNodes';\nimport type {\n    ContentModelSegment,\n    ContentModelSegmentHandler,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleSegmentDecorator: ContentModelSegmentHandler<ContentModelSegment> = (\n    _,\n    parent,\n    segment,\n    context,\n    segmentNodes\n) => {\n    const { code, link } = segment;\n\n    if (isNodeOfType(parent, 'ELEMENT_NODE')) {\n        if (link) {\n            stackFormat(context, 'a', () => {\n                const a = wrapAllChildNodes(parent, 'a');\n\n                applyFormat(a, context.formatAppliers.link, link.format, context);\n                applyFormat(a, context.formatAppliers.dataset, link.dataset, context);\n\n                segmentNodes?.push(a);\n                context.onNodeCreated?.(link, a);\n            });\n        }\n\n        if (code) {\n            stackFormat(context, 'code', () => {\n                const codeNode = wrapAllChildNodes(parent, 'code');\n\n                applyFormat(codeNode, context.formatAppliers.code, code.format, context);\n\n                segmentNodes?.push(codeNode);\n                context.onNodeCreated?.(code, codeNode);\n            });\n        }\n    }\n};\n","import { applyFormat } from '../utils/applyFormat';\nimport { hasMetadata } from '../../domUtils/metadata/updateMetadata';\nimport { isBlockEmpty } from '../../modelApi/common/isEmpty';\nimport { moveChildNodes } from '../../domUtils/moveChildNodes';\nimport { reuseCachedElement } from '../../domUtils/reuseCachedElement';\nimport type {\n    ContentModelBlockHandler,\n    ContentModelTable,\n    ModelToDomContext,\n    TableSelection,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleTable: ContentModelBlockHandler<ContentModelTable> = (\n    doc: Document,\n    parent: Node,\n    table: ContentModelTable,\n    context: ModelToDomContext,\n    refNode: Node | null\n) => {\n    if (isBlockEmpty(table)) {\n        // Empty table, do not create TABLE element and just return\n        return refNode;\n    }\n\n    let tableNode = context.allowCacheElement ? table.cachedElement : undefined;\n\n    if (tableNode) {\n        refNode = reuseCachedElement(parent, tableNode, refNode);\n\n        moveChildNodes(tableNode);\n    } else {\n        tableNode = doc.createElement('table');\n\n        if (context.allowCacheElement) {\n            table.cachedElement = tableNode;\n        }\n\n        parent.insertBefore(tableNode, refNode);\n\n        applyFormat(tableNode, context.formatAppliers.block, table.format, context);\n        applyFormat(tableNode, context.formatAppliers.table, table.format, context);\n        applyFormat(tableNode, context.formatAppliers.tableBorder, table.format, context);\n        applyFormat(tableNode, context.formatAppliers.dataset, table.dataset, context);\n    }\n\n    context.onNodeCreated?.(table, tableNode);\n\n    const tbody = doc.createElement('tbody');\n    tableNode.appendChild(tbody);\n\n    for (let row = 0; row < table.rows.length; row++) {\n        const tableRow = table.rows[row];\n\n        if (tableRow.cells.length == 0) {\n            // Skip empty row\n            continue;\n        }\n\n        const tr = (context.allowCacheElement && tableRow.cachedElement) || doc.createElement('tr');\n        tbody.appendChild(tr);\n        moveChildNodes(tr);\n\n        if (!tableRow.cachedElement) {\n            if (context.allowCacheElement) {\n                tableRow.cachedElement = tr;\n            }\n\n            applyFormat(tr, context.formatAppliers.tableRow, tableRow.format, context);\n        }\n\n        context.onNodeCreated?.(tableRow, tr);\n\n        for (let col = 0; col < tableRow.cells.length; col++) {\n            const cell = tableRow.cells[col];\n\n            if (cell.isSelected) {\n                const tableSelection: TableSelection = context.tableSelection || {\n                    type: 'table',\n                    table: tableNode,\n                    firstColumn: col,\n                    lastColumn: col,\n                    firstRow: row,\n                    lastRow: row,\n                };\n\n                if (tableSelection.table == tableNode) {\n                    tableSelection.lastColumn = Math.max(tableSelection.lastColumn, col);\n                    tableSelection.lastRow = Math.max(tableSelection.lastRow, row);\n                }\n\n                context.tableSelection = tableSelection;\n            }\n\n            if (!cell.spanAbove && !cell.spanLeft) {\n                const td =\n                    (context.allowCacheElement && cell.cachedElement) ||\n                    doc.createElement(cell.isHeader ? 'th' : 'td');\n\n                tr.appendChild(td);\n\n                let rowSpan = 1;\n                let colSpan = 1;\n                let width = table.widths[col];\n                let height = tableRow.height;\n\n                for (; table.rows[row + rowSpan]?.cells[col]?.spanAbove; rowSpan++) {\n                    height += table.rows[row + rowSpan].height;\n                }\n                for (; tableRow.cells[col + colSpan]?.spanLeft; colSpan++) {\n                    width += table.widths[col + colSpan];\n                }\n\n                if (rowSpan > 1) {\n                    td.rowSpan = rowSpan;\n                }\n\n                if (colSpan > 1) {\n                    td.colSpan = colSpan;\n                }\n\n                if (!cell.cachedElement || (cell.format.useBorderBox && hasMetadata(table))) {\n                    if (width > 0 && !td.style.width) {\n                        td.style.width = width + 'px';\n                    }\n\n                    if (height > 0 && !td.style.height) {\n                        td.style.height = height + 'px';\n                    }\n                }\n\n                if (!cell.cachedElement) {\n                    if (context.allowCacheElement) {\n                        cell.cachedElement = td;\n                    }\n\n                    applyFormat(td, context.formatAppliers.block, cell.format, context);\n                    applyFormat(td, context.formatAppliers.tableCell, cell.format, context);\n                    applyFormat(td, context.formatAppliers.tableCellBorder, cell.format, context);\n                    applyFormat(td, context.formatAppliers.dataset, cell.dataset, context);\n                }\n\n                context.modelHandlers.blockGroupChildren(doc, td, cell, context);\n\n                context.onNodeCreated?.(cell, td);\n            }\n        }\n    }\n\n    context.domIndexer?.onTable(tableNode, table);\n\n    return refNode;\n};\n","import { handleSegmentCommon } from '../utils/handleSegmentCommon';\nimport type { ContentModelSegmentHandler, ContentModelText } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleText: ContentModelSegmentHandler<ContentModelText> = (\n    doc,\n    parent,\n    segment,\n    context,\n    segmentNodes\n) => {\n    const txt = doc.createTextNode(segment.text);\n    const element = doc.createElement('span');\n\n    parent.appendChild(element);\n    element.appendChild(txt);\n\n    context.formatAppliers.text.forEach(applier => applier(segment.format, txt, context));\n\n    handleSegmentCommon(doc, txt, element, segment, context, segmentNodes);\n};\n","import { isNodeOfType } from '../../domUtils/isNodeOfType';\n\nconst OptimizeTags = ['SPAN', 'B', 'EM', 'I', 'U', 'SUB', 'SUP', 'STRIKE', 'S', 'A', 'CODE'];\n\n/**\n * @internal\n */\nexport function mergeNode(root: Node) {\n    for (let child = root.firstChild; child; ) {\n        const next = child.nextSibling;\n\n        if (\n            next &&\n            isNodeOfType(child, 'ELEMENT_NODE') &&\n            isNodeOfType(next, 'ELEMENT_NODE') &&\n            child.tagName == next.tagName &&\n            OptimizeTags.indexOf(child.tagName) >= 0 &&\n            hasSameAttributes(child, next)\n        ) {\n            while (next.firstChild) {\n                child.appendChild(next.firstChild);\n            }\n\n            next.parentNode!.removeChild(next);\n        } else {\n            child = next;\n        }\n    }\n}\n\nfunction hasSameAttributes(element1: HTMLElement, element2: HTMLElement) {\n    const attr1 = element1.attributes;\n    const attr2 = element2.attributes;\n\n    if (attr1.length != attr2.length) {\n        return false;\n    }\n\n    for (let i = 0; i < attr1.length; i++) {\n        if (attr1[i].name != attr2[i].name || attr1[i].value != attr2[i].value) {\n            return false;\n        }\n    }\n\n    return true;\n}\n","import { isEntityElement } from '../../domUtils/entityUtils';\nimport { mergeNode } from './mergeNode';\nimport { removeUnnecessarySpan } from './removeUnnecessarySpan';\n\n/**\n * @internal\n */\nexport function optimize(root: Node) {\n    /**\n     * Do no do any optimization to entity\n     */\n    if (isEntityElement(root)) {\n        return;\n    }\n\n    removeUnnecessarySpan(root);\n    mergeNode(root);\n\n    for (let child = root.firstChild; child; child = child.nextSibling) {\n        optimize(child);\n    }\n}\n","import { isNodeOfType } from '../../domUtils/isNodeOfType';\n\n/**\n * @internal\n */\nexport function removeUnnecessarySpan(root: Node) {\n    for (let child = root.firstChild; child; ) {\n        if (\n            isNodeOfType(child, 'ELEMENT_NODE') &&\n            child.tagName == 'SPAN' &&\n            child.attributes.length == 0\n        ) {\n            const node = child;\n            let refNode = child.nextSibling;\n            child = child.nextSibling;\n\n            while (node.lastChild) {\n                const newNode = node.lastChild;\n                root.insertBefore(newNode, refNode);\n                refNode = newNode;\n            }\n\n            root.removeChild(node);\n        } else {\n            child = child.nextSibling;\n        }\n    }\n}\n","import type {\n    ContentModelFormatBase,\n    FormatApplier,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Apply formats to the given HTML element using specified appliers\n * @param element The element to apply formats to\n * @param appliers The appliers we are using to apply formats\n * @param format The format object we get format info from\n * @param context Content Model to DOM context\n */\nexport function applyFormat<T extends ContentModelFormatBase>(\n    element: HTMLElement,\n    appliers: (FormatApplier<T> | null)[],\n    format: T,\n    context: ModelToDomContext\n) {\n    appliers.forEach(applier => {\n        applier?.(format, element, context);\n    });\n}\n","import { updateMetadata } from '../../domUtils/metadata/updateMetadata';\nimport type {\n    ContentModelFormatBase,\n    ContentModelWithDataset,\n    MetadataApplier,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function applyMetadata<TMetadata, TFormat extends ContentModelFormatBase>(\n    model: ContentModelWithDataset<TMetadata>,\n    applier: MetadataApplier<TMetadata, TFormat> | undefined,\n    format: TFormat,\n    context: ModelToDomContext\n) {\n    if (applier) {\n        updateMetadata(\n            model,\n            metadata => {\n                applier.applierFunction(metadata, format, context);\n                return metadata;\n            },\n            applier.metadataDefinition\n        );\n    }\n}\n","import { applyFormat } from './applyFormat';\nimport type { ContentModelSegment, ModelToDomContext } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function handleSegmentCommon(\n    doc: Document,\n    segmentNode: Node,\n    containerNode: HTMLElement,\n    segment: ContentModelSegment,\n    context: ModelToDomContext,\n    segmentNodes: Node[]\n) {\n    if (!segmentNode.firstChild) {\n        context.regularSelection.current.segment = segmentNode;\n    }\n\n    applyFormat(containerNode, context.formatAppliers.styleBasedSegment, segment.format, context);\n\n    segmentNodes?.push(segmentNode);\n    context.modelHandlers.segmentDecorator(doc, containerNode, segment, context, segmentNodes);\n\n    applyFormat(containerNode, context.formatAppliers.elementBasedSegment, segment.format, context);\n\n    context.onNodeCreated?.(segment, segmentNode);\n}\n","import { defaultContentModelFormatMap } from '../../config/defaultContentModelFormatMap';\nimport type {\n    ContentModelBlockFormat,\n    ContentModelSegmentFormat,\n    ModelToDomContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function stackFormat(\n    context: ModelToDomContext,\n    tagNameOrFormat: string | (ContentModelSegmentFormat & ContentModelBlockFormat) | null,\n    callback: () => void\n) {\n    const newFormat =\n        typeof tagNameOrFormat === 'string'\n            ? defaultContentModelFormatMap[tagNameOrFormat]\n            : tagNameOrFormat;\n\n    if (newFormat) {\n        const implicitFormat = context.implicitFormat;\n\n        try {\n            context.implicitFormat = {\n                ...implicitFormat,\n                ...newFormat,\n            };\n\n            callback();\n        } finally {\n            context.implicitFormat = implicitFormat;\n        }\n    } else {\n        callback();\n    }\n}\n","import type { ContentModelBlockGroup, ContentModelDocument } from 'roosterjs-content-model-types';\n\n/**\n * Convert Content Model to plain text\n * @param model The source Content Model\n * @param [separator='\\r\\n'] The separator string used for connect lines\n */\nexport function contentModelToText(\n    model: ContentModelDocument,\n    separator: string = '\\r\\n'\n): string {\n    const textArray: string[] = [];\n\n    contentModelToTextArray(model, textArray);\n\n    return textArray.join(separator);\n}\n\nfunction contentModelToTextArray(group: ContentModelBlockGroup, textArray: string[]) {\n    group.blocks.forEach(block => {\n        switch (block.blockType) {\n            case 'Paragraph':\n                let text = '';\n\n                block.segments.forEach(segment => {\n                    switch (segment.segmentType) {\n                        case 'Br':\n                            textArray.push(text);\n                            text = '';\n                            break;\n\n                        case 'Entity':\n                            text += segment.wrapper.textContent || '';\n                            break;\n\n                        case 'General':\n                            text += segment.element.textContent || '';\n                            break;\n\n                        case 'Text':\n                            text += segment.text;\n                            break;\n\n                        case 'Image':\n                            text += ' ';\n                            break;\n                    }\n                });\n                textArray.push(text);\n                break;\n\n            case 'Divider':\n            case 'Entity':\n                textArray.push('');\n                break;\n\n            case 'Table':\n                block.rows.forEach(row =>\n                    row.cells.forEach(cell => {\n                        contentModelToTextArray(cell, textArray);\n                    })\n                );\n                break;\n\n            case 'BlockGroup':\n                contentModelToTextArray(block, textArray);\n                break;\n        }\n    });\n}\n","import { keyboardListTrigger } from './keyboardListTrigger';\nimport type {\n    EditorPlugin,\n    IEditor,\n    KeyDownEvent,\n    PluginEvent,\n} from 'roosterjs-content-model-types';\n\n/**\n * Options to customize the Content Model Auto Format Plugin\n */\nexport type AutoFormatOptions = {\n    /**\n     * When true, after type *, ->, -, --, => , , > and space key a type of bullet list will be triggered. @default true\n     */\n    autoBullet: boolean;\n\n    /**\n     * When true, after type 1, A, a, i, I followed by ., ), - or between () and space key a type of numbering list will be triggered. @default true\n     */\n    autoNumbering: boolean;\n};\n\n/**\n * @internal\n */\nconst DefaultOptions: Required<AutoFormatOptions> = {\n    autoBullet: true,\n    autoNumbering: true,\n};\n\n/**\n * Auto Format plugin handles auto formatting, such as transforming * characters into a bullet list.\n * It can be customized with options to enable or disable auto list features.\n */\nexport class AutoFormatPlugin implements EditorPlugin {\n    private editor: IEditor | null = null;\n\n    /**\n     * @param options An optional parameter that takes in an object of type AutoFormatOptions, which includes the following properties:\n     *  - autoBullet: A boolean that enables or disables automatic bullet list formatting. Defaults to true.\n     *  - autoNumbering: A boolean that enables or disables automatic numbering formatting. Defaults to true.\n     */\n    constructor(private options: AutoFormatOptions = DefaultOptions) {}\n\n    /**\n     * Get name of this plugin\n     */\n    getName() {\n        return 'AutoFormat';\n    }\n\n    /**\n     * The first method that editor will call to a plugin when editor is initializing.\n     * It will pass in the editor instance, plugin should take this chance to save the\n     * editor reference so that it can call to any editor method or format API later.\n     * @param editor The editor object\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n    }\n\n    /**\n     * The last method that editor will call to a plugin before it is disposed.\n     * Plugin can take this chance to clear the reference to editor. After this method is\n     * called, plugin should not call to any editor method since it will result in error.\n     */\n    dispose() {\n        this.editor = null;\n    }\n\n    /**\n     * Core method for a plugin. Once an event happens in editor, editor will call this\n     * method of each plugin to handle the event as long as the event is not handled\n     * exclusively by another plugin.\n     * @param event The event to handle:\n     */\n    onPluginEvent(event: PluginEvent) {\n        if (this.editor) {\n            switch (event.eventType) {\n                case 'keyDown':\n                    this.handleKeyDownEvent(this.editor, event);\n                    break;\n            }\n        }\n    }\n\n    private handleKeyDownEvent(editor: IEditor, event: KeyDownEvent) {\n        const rawEvent = event.rawEvent;\n        if (!rawEvent.defaultPrevented && !event.handledByEditFeature) {\n            switch (rawEvent.key) {\n                case ' ':\n                    const { autoBullet, autoNumbering } = this.options;\n                    if (autoBullet || autoNumbering) {\n                        keyboardListTrigger(editor, rawEvent, autoBullet, autoNumbering);\n                    }\n                    break;\n            }\n        }\n    }\n}\n","import { getListTypeStyle } from './utils/getListTypeStyle';\nimport { getSelectedSegmentsAndParagraphs } from 'roosterjs-content-model-core';\nimport { normalizeContentModel } from 'roosterjs-content-model-dom';\nimport { setListStartNumber, setListStyle, setListType } from 'roosterjs-content-model-api';\nimport type { ContentModelDocument, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function keyboardListTrigger(\n    editor: IEditor,\n    rawEvent: KeyboardEvent,\n    shouldSearchForBullet: boolean = true,\n    shouldSearchForNumbering: boolean = true\n) {\n    editor.formatContentModel((model, _context) => {\n        const listStyleType = getListTypeStyle(\n            model,\n            shouldSearchForBullet,\n            shouldSearchForNumbering\n        );\n        if (listStyleType) {\n            const segmentsAndParagraphs = getSelectedSegmentsAndParagraphs(model, false);\n            if (segmentsAndParagraphs[0] && segmentsAndParagraphs[0][1]) {\n                segmentsAndParagraphs[0][1].segments.splice(0, 1);\n            }\n            const { listType, styleType, index } = listStyleType;\n            triggerList(editor, model, listType, styleType, index);\n            rawEvent.preventDefault();\n            normalizeContentModel(model);\n\n            return true;\n        }\n        return false;\n    });\n}\n\nconst triggerList = (\n    editor: IEditor,\n    model: ContentModelDocument,\n    listType: 'OL' | 'UL',\n    styleType: number,\n    index?: number\n) => {\n    setListType(model, listType);\n    const isOrderedList = listType == 'OL';\n    // If the index < 1, it is a new list, so it will be starting by 1, then no need to set startNumber\n    if (index && index > 1 && isOrderedList) {\n        setListStartNumber(editor, index);\n    }\n    setListStyle(\n        editor,\n        isOrderedList\n            ? {\n                  orderedStyleType: styleType,\n              }\n            : {\n                  unorderedStyleType: styleType,\n              }\n    );\n};\n","/**\n * @internal\n * Convert english alphabet numbers into decimal numbers\n * @param letter The letter that needs to be converted\n * @returns\n */\nexport function convertAlphaToDecimals(letter: string): number | undefined {\n    const alpha = letter.toUpperCase();\n    if (alpha) {\n        let result = 0;\n        for (let i = 0; i < alpha.length; i++) {\n            const charCode = alpha.charCodeAt(i) - 65 + 1;\n            result = result * 26 + charCode;\n        }\n\n        return result;\n    }\n    return undefined;\n}\n","import { convertAlphaToDecimals } from './convertAlphaToDecimals';\n\n/**\n * @internal\n */\nexport function getIndex(listIndex: string) {\n    const index = listIndex.replace(/[^a-zA-Z0-9 ]/g, '');\n    const indexNumber = parseInt(index);\n    return !isNaN(indexNumber) ? indexNumber : convertAlphaToDecimals(index);\n}\n","import { findListItemsInSameThread } from 'roosterjs-content-model-api';\nimport { getNumberingListStyle } from './getNumberingListStyle';\nimport type {\n    ContentModelDocument,\n    ContentModelListItem,\n    ContentModelParagraph,\n} from 'roosterjs-content-model-types';\nimport {\n    BulletListType,\n    isBlockGroupOfType,\n    updateListMetadata,\n    getOperationalBlocks,\n    getSelectedSegmentsAndParagraphs,\n} from 'roosterjs-content-model-core';\n\n/**\n * @internal\n */\ninterface ListTypeStyle {\n    listType: 'UL' | 'OL';\n    styleType: number;\n    index?: number;\n}\n\n/**\n * @internal\n */\nexport function getListTypeStyle(\n    model: ContentModelDocument,\n    shouldSearchForBullet: boolean = true,\n    shouldSearchForNumbering: boolean = true\n): ListTypeStyle | undefined {\n    const selectedSegmentsAndParagraphs = getSelectedSegmentsAndParagraphs(model, true);\n    const marker = selectedSegmentsAndParagraphs[0][0];\n    const paragraph = selectedSegmentsAndParagraphs[0][1];\n    const listMarkerSegment = paragraph?.segments[0];\n\n    if (\n        marker &&\n        marker.segmentType == 'SelectionMarker' &&\n        listMarkerSegment &&\n        listMarkerSegment.segmentType == 'Text'\n    ) {\n        const listMarker = listMarkerSegment.text;\n        const bulletType = bulletListType[listMarker];\n\n        if (bulletType && shouldSearchForBullet) {\n            return { listType: 'UL', styleType: bulletType };\n        } else if (shouldSearchForNumbering) {\n            const previousList = getPreviousListLevel(model, paragraph);\n            const previousIndex = getPreviousListIndex(model, previousList);\n            const previousListStyle = getPreviousListStyle(previousList);\n            const numberingType = getNumberingListStyle(\n                listMarker,\n                previousIndex,\n                previousListStyle\n            );\n            if (numberingType) {\n                return {\n                    listType: 'OL',\n                    styleType: numberingType,\n                    index:\n                        !isNewList(listMarker) &&\n                        previousListStyle === numberingType &&\n                        previousIndex\n                            ? previousIndex + 1\n                            : undefined,\n                };\n            }\n        }\n    }\n    return undefined;\n}\n\nconst getPreviousListIndex = (\n    model: ContentModelDocument,\n    previousListItem?: ContentModelListItem\n) => {\n    return previousListItem ? findListItemsInSameThread(model, previousListItem).length : undefined;\n};\n\nconst getPreviousListLevel = (model: ContentModelDocument, paragraph: ContentModelParagraph) => {\n    const blocks = getOperationalBlocks<ContentModelListItem>(\n        model,\n        ['ListItem'],\n        ['TableCell']\n    )[0];\n    let listItem: ContentModelListItem | undefined = undefined;\n    if (blocks) {\n        const listBlockIndex = blocks.parent.blocks.indexOf(paragraph);\n\n        if (listBlockIndex > -1) {\n            for (let i = listBlockIndex - 1; i > -1; i--) {\n                const item = blocks.parent.blocks[i];\n                if (isBlockGroupOfType<ContentModelListItem>(item, 'ListItem')) {\n                    listItem = item;\n                    break;\n                }\n            }\n        }\n    }\n\n    return listItem;\n};\n\nconst getPreviousListStyle = (list?: ContentModelListItem) => {\n    if (list?.levels[0].dataset) {\n        return updateListMetadata(list.levels[0])?.orderedStyleType;\n    }\n};\n\nconst bulletListType: Record<string, number> = {\n    '*': BulletListType.Disc,\n    '-': BulletListType.Dash,\n    '--': BulletListType.Square,\n    '->': BulletListType.LongArrow,\n    '-->': BulletListType.DoubleLongArrow,\n    '=>': BulletListType.UnfilledArrow,\n    '>': BulletListType.ShortArrow,\n    '': BulletListType.Hyphen,\n};\n\nconst isNewList = (listMarker: string) => {\n    const marker = listMarker.replace(/[^\\w\\s]/g, '');\n    const pattern = /^[1aAiI]$/;\n    return pattern.test(marker);\n};\n","import { getIndex } from './getIndex';\nimport { NumberingListType } from 'roosterjs-content-model-core';\n\nconst enum NumberingTypes {\n    Decimal = 1,\n    LowerAlpha = 2,\n    UpperAlpha = 3,\n    LowerRoman = 4,\n    UpperRoman = 5,\n}\n\nconst enum Character {\n    Dot = 1,\n    Dash = 2,\n    Parenthesis = 3,\n    DoubleParenthesis = 4,\n}\n\nconst characters: Record<string, number> = {\n    '.': Character.Dot,\n    '-': Character.Dash,\n    ')': Character.Parenthesis,\n};\n\nconst lowerRomanTypes = [\n    NumberingListType.LowerRoman,\n    NumberingListType.LowerRomanDash,\n    NumberingListType.LowerRomanDoubleParenthesis,\n    NumberingListType.LowerRomanParenthesis,\n];\nconst upperRomanTypes = [\n    NumberingListType.UpperRoman,\n    NumberingListType.UpperRomanDash,\n    NumberingListType.UpperRomanDoubleParenthesis,\n    NumberingListType.UpperRomanParenthesis,\n];\nconst numberingTriggers = ['1', 'a', 'A', 'I', 'i'];\nconst lowerRomanNumbers = ['i', 'v', 'x', 'l', 'c', 'd', 'm'];\nconst upperRomanNumbers = ['I', 'V', 'X', 'L', 'C', 'D', 'M'];\n\nconst identifyNumberingType = (text: string, previousListStyle?: number) => {\n    if (!isNaN(parseInt(text))) {\n        return NumberingTypes.Decimal;\n    } else if (/[a-z]+/g.test(text)) {\n        if (\n            (previousListStyle === NumberingTypes.LowerRoman &&\n                lowerRomanTypes.indexOf(previousListStyle) > -1 &&\n                lowerRomanNumbers.indexOf(text[0]) > -1) ||\n            (!previousListStyle && text === 'i')\n        ) {\n            return NumberingTypes.LowerRoman;\n        } else if (\n            previousListStyle === NumberingTypes.LowerAlpha ||\n            (!previousListStyle && text === 'a')\n        ) {\n            return NumberingTypes.LowerAlpha;\n        }\n    } else if (/[A-Z]+/g.test(text)) {\n        if (\n            (previousListStyle == NumberingTypes.UpperRoman &&\n                upperRomanTypes.indexOf(previousListStyle) > -1 &&\n                upperRomanNumbers.indexOf(text[0]) > -1) ||\n            (!previousListStyle && text === 'I')\n        ) {\n            return NumberingTypes.UpperRoman;\n        } else if (\n            previousListStyle == NumberingTypes.UpperAlpha ||\n            (!previousListStyle && text === 'A')\n        ) {\n            return NumberingTypes.UpperAlpha;\n        }\n    }\n};\n\nconst numberingListTypes: Record<number, (char: number) => number | undefined> = {\n    [NumberingTypes.Decimal]: char => DecimalsTypes[char] || undefined,\n    [NumberingTypes.LowerAlpha]: char => LowerAlphaTypes[char] || undefined,\n    [NumberingTypes.UpperAlpha]: char => UpperAlphaTypes[char] || undefined,\n    [NumberingTypes.LowerRoman]: char => LowerRomanTypes[char] || undefined,\n    [NumberingTypes.UpperRoman]: char => UpperRomanTypes[char] || undefined,\n};\n\nconst UpperRomanTypes: Record<number, number> = {\n    [Character.Dot]: NumberingListType.UpperRoman,\n    [Character.Dash]: NumberingListType.UpperRomanDash,\n    [Character.Parenthesis]: NumberingListType.UpperRomanParenthesis,\n    [Character.DoubleParenthesis]: NumberingListType.UpperRomanDoubleParenthesis,\n};\n\nconst LowerRomanTypes: Record<number, number> = {\n    [Character.Dot]: NumberingListType.LowerRoman,\n    [Character.Dash]: NumberingListType.LowerRomanDash,\n    [Character.Parenthesis]: NumberingListType.LowerRomanParenthesis,\n    [Character.DoubleParenthesis]: NumberingListType.LowerRomanDoubleParenthesis,\n};\n\nconst UpperAlphaTypes: Record<number, number> = {\n    [Character.Dot]: NumberingListType.UpperAlpha,\n    [Character.Dash]: NumberingListType.UpperAlphaDash,\n    [Character.Parenthesis]: NumberingListType.UpperAlphaParenthesis,\n    [Character.DoubleParenthesis]: NumberingListType.UpperAlphaDoubleParenthesis,\n};\n\nconst LowerAlphaTypes: Record<number, number> = {\n    [Character.Dot]: NumberingListType.LowerAlpha,\n    [Character.Dash]: NumberingListType.LowerAlphaDash,\n    [Character.Parenthesis]: NumberingListType.LowerAlphaParenthesis,\n    [Character.DoubleParenthesis]: NumberingListType.LowerAlphaDoubleParenthesis,\n};\n\nconst DecimalsTypes: Record<number, number> = {\n    [Character.Dot]: NumberingListType.Decimal,\n    [Character.Dash]: NumberingListType.DecimalDash,\n    [Character.Parenthesis]: NumberingListType.DecimalParenthesis,\n    [Character.DoubleParenthesis]: NumberingListType.DecimalDoubleParenthesis,\n};\n\nconst identifyNumberingListType = (\n    numbering: string,\n    isDoubleParenthesis: boolean,\n    previousListStyle?: number\n): number | undefined => {\n    const separatorCharacter = isDoubleParenthesis\n        ? Character.DoubleParenthesis\n        : characters[numbering[numbering.length - 1]];\n    // if separator is not valid, no need to check if the number is valid.\n    if (separatorCharacter) {\n        const number = isDoubleParenthesis ? numbering.slice(1, -1) : numbering.slice(0, -1);\n        const numberingType = identifyNumberingType(number, previousListStyle);\n        return numberingType ? numberingListTypes[numberingType](separatorCharacter) : undefined;\n    }\n    return undefined;\n};\n\n/**\n * @internal\n */\nexport function getNumberingListStyle(\n    textBeforeCursor: string,\n    previousListIndex?: number,\n    previousListStyle?: number\n): number | undefined {\n    const trigger = textBeforeCursor.trim();\n    const isDoubleParenthesis = trigger[0] === '(' && trigger[trigger.length - 1] === ')';\n    //Only the staring items ['1', 'a', 'A', 'I', 'i'] must trigger a new list. All the other triggers is used to keep the list chain.\n    //The index is always the characters before the last character\n    const listIndex = isDoubleParenthesis ? trigger.slice(1, -1) : trigger.slice(0, -1);\n    const index = getIndex(listIndex);\n    const isContinuosList = numberingTriggers.indexOf(listIndex) < 0;\n\n    if (\n        !index ||\n        index < 1 ||\n        (!previousListIndex && isContinuosList) ||\n        (previousListIndex && isContinuosList && !canAppendList(index, previousListIndex))\n    ) {\n        return undefined;\n    }\n\n    const numberingType = isValidNumbering(listIndex)\n        ? identifyNumberingListType(\n              trigger,\n              isDoubleParenthesis,\n              isContinuosList ? previousListStyle : undefined\n          )\n        : undefined;\n    return numberingType;\n}\n\n/**\n * Check if index has only numbers or only letters to avoid sequence of character such 1:1. trigger a list.\n * @param index\n * @returns\n */\nfunction isValidNumbering(index: string) {\n    return Number(index) || /^[A-Za-z\\s]*$/.test(index);\n}\n\nfunction canAppendList(index?: number, previousListIndex?: number) {\n    return previousListIndex && index && previousListIndex + 1 === index;\n}\n","import { keyboardDelete } from './keyboardDelete';\nimport { keyboardInput } from './keyboardInput';\nimport { keyboardTab } from './keyboardTab';\nimport type {\n    EditorPlugin,\n    IEditor,\n    KeyDownEvent,\n    PluginEvent,\n} from 'roosterjs-content-model-types';\n\nconst BACKSPACE_KEY = 8;\nconst DELETE_KEY = 46;\n\n/**\n * Edit plugins helps editor to do editing operation on top of content model.\n * This includes:\n * 1. Delete Key\n * 2. Backspace Key\n * 3. Tab Key\n */\nexport class EditPlugin implements EditorPlugin {\n    private editor: IEditor | null = null;\n    private disposer: (() => void) | null = null;\n    private shouldHandleNextInputEvent = false;\n\n    /**\n     * Get name of this plugin\n     */\n    getName() {\n        return 'Edit';\n    }\n\n    /**\n     * The first method that editor will call to a plugin when editor is initializing.\n     * It will pass in the editor instance, plugin should take this chance to save the\n     * editor reference so that it can call to any editor method or format API later.\n     * @param editor The editor object\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n        if (editor.getEnvironment().isAndroid) {\n            this.disposer = this.editor.attachDomEvent({\n                beforeinput: {\n                    beforeDispatch: e => this.handleBeforeInputEvent(editor, e),\n                },\n            });\n        }\n    }\n\n    /**\n     * The last method that editor will call to a plugin before it is disposed.\n     * Plugin can take this chance to clear the reference to editor. After this method is\n     * called, plugin should not call to any editor method since it will result in error.\n     */\n    dispose() {\n        this.editor = null;\n        this.disposer?.();\n        this.disposer = null;\n    }\n\n    /**\n     * Core method for a plugin. Once an event happens in editor, editor will call this\n     * method of each plugin to handle the event as long as the event is not handled\n     * exclusively by another plugin.\n     * @param event The event to handle:\n     */\n    onPluginEvent(event: PluginEvent) {\n        if (this.editor) {\n            switch (event.eventType) {\n                case 'keyDown':\n                    this.handleKeyDownEvent(this.editor, event);\n                    break;\n            }\n        }\n    }\n\n    private handleKeyDownEvent(editor: IEditor, event: KeyDownEvent) {\n        const rawEvent = event.rawEvent;\n\n        if (!rawEvent.defaultPrevented && !event.handledByEditFeature) {\n            switch (rawEvent.key) {\n                case 'Backspace':\n                case 'Delete':\n                    // Use our API to handle BACKSPACE/DELETE key.\n                    // No need to clear cache here since if we rely on browser's behavior, there will be Input event and its handler will reconcile cache\n                    keyboardDelete(editor, rawEvent);\n                    break;\n\n                case 'Tab':\n                    keyboardTab(editor, rawEvent);\n                    break;\n                case 'Unidentified':\n                    if (editor.getEnvironment().isAndroid) {\n                        this.shouldHandleNextInputEvent = true;\n                    }\n                    break;\n\n                case 'Enter':\n                default:\n                    keyboardInput(editor, rawEvent);\n                    break;\n            }\n        }\n    }\n\n    private handleBeforeInputEvent(editor: IEditor, rawEvent: Event) {\n        // Some Android IMEs doesn't fire correct keydown event for BACKSPACE/DELETE key\n        // Here we translate input event to BACKSPACE/DELETE keydown event to be compatible with existing logic\n        if (\n            !this.shouldHandleNextInputEvent ||\n            !(rawEvent instanceof InputEvent) ||\n            rawEvent.defaultPrevented\n        ) {\n            return;\n        }\n        this.shouldHandleNextInputEvent = false;\n\n        let handled = false;\n        switch (rawEvent.inputType) {\n            case 'deleteContentBackward':\n                handled = keyboardDelete(\n                    editor,\n                    new KeyboardEvent('keydown', {\n                        key: 'Backspace',\n                        keyCode: BACKSPACE_KEY,\n                        which: BACKSPACE_KEY,\n                    })\n                );\n                break;\n            case 'deleteContentForward':\n                handled = keyboardDelete(\n                    editor,\n                    new KeyboardEvent('keydown', {\n                        key: 'Delete',\n                        keyCode: DELETE_KEY,\n                        which: DELETE_KEY,\n                    })\n                );\n                break;\n        }\n\n        if (handled) {\n            rawEvent.preventDefault();\n        }\n    }\n}\n","import { deleteSegment } from 'roosterjs-content-model-core';\nimport type { DeleteSelectionStep } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const deleteAllSegmentBefore: DeleteSelectionStep = context => {\n    if (context.deleteResult != 'notDeleted') {\n        return;\n    }\n\n    const { paragraph, marker } = context.insertPoint;\n    const index = paragraph.segments.indexOf(marker);\n\n    for (let i = index - 1; i >= 0; i--) {\n        const segment = paragraph.segments[i];\n\n        segment.isSelected = true;\n\n        if (deleteSegment(paragraph, segment, context.formatContext)) {\n            context.deleteResult = 'range';\n        }\n    }\n};\n","import { getLeafSiblingBlock } from '../utils/getLeafSiblingBlock';\nimport { setModelIndentation } from 'roosterjs-content-model-api';\nimport { setParagraphNotImplicit } from 'roosterjs-content-model-dom';\nimport {\n    deleteBlock,\n    deleteSegment,\n    getClosestAncestorBlockGroupIndex,\n} from 'roosterjs-content-model-core';\nimport type { BlockAndPath } from '../utils/getLeafSiblingBlock';\nimport type {\n    ContentModelBlockGroup,\n    ContentModelDocument,\n    ContentModelParagraph,\n    ContentModelSegment,\n    DeleteSelectionStep,\n} from 'roosterjs-content-model-types';\n\nfunction getDeleteCollapsedSelection(direction: 'forward' | 'backward'): DeleteSelectionStep {\n    return context => {\n        if (context.deleteResult != 'notDeleted') {\n            return;\n        }\n\n        const isForward = direction == 'forward';\n        const { paragraph, marker, path, tableContext } = context.insertPoint;\n        const segments = paragraph.segments;\n\n        fixupBr(segments);\n\n        const index = segments.indexOf(marker) + (isForward ? 1 : -1);\n        const segmentToDelete = segments[index];\n        let blockToDelete: BlockAndPath | null;\n        let root: ContentModelDocument | null;\n\n        if (segmentToDelete) {\n            if (deleteSegment(paragraph, segmentToDelete, context.formatContext, direction)) {\n                context.deleteResult = 'singleChar';\n\n                // It is possible that we have deleted everything from this paragraph, so we need to mark it as not implicit\n                // to avoid losing its format. See https://github.com/microsoft/roosterjs/issues/1953\n                setParagraphNotImplicit(paragraph);\n            }\n        } else if (\n            shouldOutdentParagraph(isForward, segments, paragraph, path) &&\n            (root = getRoot(path))\n        ) {\n            setModelIndentation(root, 'outdent');\n            context.deleteResult = 'range';\n        } else if ((blockToDelete = getLeafSiblingBlock(path, paragraph, isForward))) {\n            const { block, path, siblingSegment } = blockToDelete;\n\n            if (block.blockType == 'Paragraph') {\n                if (siblingSegment) {\n                    // When selection is under general segment, need to check if it has a sibling sibling, and delete from it\n                    if (deleteSegment(block, siblingSegment, context.formatContext, direction)) {\n                        context.deleteResult = 'range';\n                    }\n                } else {\n                    if (isForward) {\n                        context.lastParagraph = block;\n                    } else {\n                        if (block.segments[block.segments.length - 1]?.segmentType == 'Br') {\n                            block.segments.pop();\n                        }\n\n                        context.insertPoint = {\n                            marker,\n                            paragraph: block,\n                            path,\n                            tableContext,\n                        };\n                        context.lastParagraph = paragraph;\n                        delete block.cachedElement;\n                    }\n\n                    context.deleteResult = 'range';\n                }\n\n                // When go across table, getLeafSiblingBlock will return null, when we are here, we must be in the same table context\n                context.lastTableContext = tableContext;\n            } else {\n                if (\n                    deleteBlock(\n                        path[0].blocks,\n                        block,\n                        undefined /*replacement*/,\n                        context.formatContext,\n                        direction\n                    )\n                ) {\n                    context.deleteResult = 'range';\n                }\n            }\n        } else {\n            // We have nothing to delete, in this case we don't want browser handle it as well.\n            // Because when Backspace on an empty document, it will also delete the only DIV and SPAN element, causes\n            // editor is really empty. We don't want that happen. So the handling should stop here.\n            context.deleteResult = 'nothingToDelete';\n        }\n    };\n}\n\nfunction getRoot(path: ContentModelBlockGroup[]): ContentModelDocument | null {\n    const lastInPath = path[path.length - 1];\n    return lastInPath.blockGroupType == 'Document' ? lastInPath : null;\n}\n\nfunction shouldOutdentParagraph(\n    isForward: boolean,\n    segments: ContentModelSegment[],\n    paragraph: ContentModelParagraph,\n    path: ContentModelBlockGroup[]\n) {\n    return (\n        !isForward &&\n        segments.length == 1 &&\n        segments[0].segmentType == 'SelectionMarker' &&\n        paragraph.format.marginLeft &&\n        parseInt(paragraph.format.marginLeft) &&\n        getClosestAncestorBlockGroupIndex(path, ['Document', 'TableCell'], ['ListItem']) > -1\n    );\n}\n\n/**\n * If the last segment is BR, remove it for now. We may add it back later when normalize model.\n * So that if this is an empty paragraph, it will start to delete next block\n */\nfunction fixupBr(segments: ContentModelSegment[]) {\n    if (segments[segments.length - 1]?.segmentType == 'Br') {\n        const segmentsWithoutBr = segments.filter(x => x.segmentType != 'SelectionMarker');\n\n        if (segmentsWithoutBr[segmentsWithoutBr.length - 2]?.segmentType != 'Br') {\n            segments.pop();\n        }\n    }\n}\n\n/**\n * @internal if we didn't delete anything, and we want to delete forward, now perform it\n */\nexport const forwardDeleteCollapsedSelection = getDeleteCollapsedSelection('forward');\n\n/**\n * @internal if we didn't delete anything, and we want to delete backward, now perform it\n */\nexport const backwardDeleteCollapsedSelection = getDeleteCollapsedSelection('backward');\n","import { getClosestAncestorBlockGroupIndex } from 'roosterjs-content-model-core';\nimport type { DeleteSelectionStep } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const deleteList: DeleteSelectionStep = context => {\n    const { paragraph, marker, path } = context.insertPoint;\n\n    if (context.deleteResult == 'nothingToDelete' || context.deleteResult == 'notDeleted') {\n        const index = getClosestAncestorBlockGroupIndex(path, ['ListItem', 'TableCell']);\n        const item = path[index];\n        if (\n            index >= 0 &&\n            paragraph.segments[0] == marker &&\n            item.blockGroupType == 'ListItem' &&\n            (paragraph.segments.length == 1 ||\n                (paragraph.segments.length == 2 && paragraph.segments[1].segmentType == 'Br'))\n        ) {\n            item.levels = [];\n            context.deleteResult = 'range';\n        }\n    }\n};\n","import { isPunctuation, isSpace, normalizeText } from 'roosterjs-content-model-core';\nimport { isWhiteSpacePreserved } from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelParagraph,\n    DeleteSelectionContext,\n    DeleteSelectionStep,\n} from 'roosterjs-content-model-types';\n\nconst enum DeleteWordState {\n    Start,\n    Punctuation,\n    Text,\n    NonText,\n    Space,\n    End,\n}\n\ninterface CharInfo {\n    text: boolean;\n    space: boolean;\n    punctuation: boolean;\n}\n\nfunction getDeleteWordSelection(direction: 'forward' | 'backward'): DeleteSelectionStep {\n    return context => {\n        if (context.deleteResult != 'notDeleted') {\n            return;\n        }\n\n        const { marker, paragraph } = context.insertPoint;\n        const startIndex = paragraph.segments.indexOf(marker);\n        const deleteNext = direction == 'forward';\n\n        const iterator = iterateSegments(paragraph, startIndex, deleteNext, context);\n        let curr = iterator.next();\n\n        for (let state = DeleteWordState.Start; state != DeleteWordState.End && !curr.done; ) {\n            const { punctuation, space, text } = curr.value;\n\n            // This is a state machine of how to delete a whole word together with space and punctuations.\n            // For a full state machine chart, see\n            // Forward delete: https://github.com/microsoft/roosterjs/blob/master/assets/design-charts/ForwardDeleteWord.png\n            // Backward delete: https://github.com/microsoft/roosterjs/blob/master/assets/design-charts/BackwardDeleteWord.png\n            switch (state) {\n                case DeleteWordState.Start:\n                    state = space\n                        ? DeleteWordState.Space\n                        : punctuation\n                        ? DeleteWordState.Punctuation\n                        : DeleteWordState.Text;\n                    curr = iterator.next(true /*delete*/);\n                    break;\n\n                case DeleteWordState.Punctuation:\n                    if (deleteNext && space) {\n                        state = DeleteWordState.NonText;\n                        curr = iterator.next(true /*delete*/);\n                    } else if (punctuation) {\n                        curr = iterator.next(true /*delete*/);\n                    } else {\n                        state = DeleteWordState.End;\n                    }\n                    break;\n\n                case DeleteWordState.Text:\n                    if (deleteNext && space) {\n                        state = DeleteWordState.NonText;\n                        curr = iterator.next(true /*delete*/);\n                    } else if (text) {\n                        curr = iterator.next(true /*delete*/);\n                    } else {\n                        state = DeleteWordState.End;\n                    }\n                    break;\n\n                case DeleteWordState.NonText:\n                    if (punctuation || !space) {\n                        state = DeleteWordState.End;\n                    } else {\n                        curr = iterator.next(true /*delete*/);\n                    }\n                    break;\n\n                case DeleteWordState.Space:\n                    if (space) {\n                        curr = iterator.next(true /*delete*/);\n                    } else if (punctuation) {\n                        state = deleteNext ? DeleteWordState.NonText : DeleteWordState.Punctuation;\n                        curr = iterator.next(true /*delete*/);\n                    } else {\n                        state = deleteNext ? DeleteWordState.End : DeleteWordState.Text;\n                    }\n                    break;\n            }\n        }\n    };\n}\n\nfunction* iterateSegments(\n    paragraph: ContentModelParagraph,\n    markerIndex: number,\n    forward: boolean,\n    context: DeleteSelectionContext\n): Generator<CharInfo, null, boolean> {\n    const step = forward ? 1 : -1;\n    const segments = paragraph.segments;\n    const preserveWhiteSpace = isWhiteSpacePreserved(paragraph.format.whiteSpace);\n\n    for (let i = markerIndex + step; i >= 0 && i < segments.length; i += step) {\n        const segment = segments[i];\n\n        switch (segment.segmentType) {\n            case 'Text':\n                for (\n                    let j = forward ? 0 : segment.text.length - 1;\n                    j >= 0 && j < segment.text.length;\n                    j += step\n                ) {\n                    const c = segment.text[j];\n                    const punctuation = isPunctuation(c);\n                    const space = isSpace(c);\n                    const text = !punctuation && !space;\n\n                    if (yield { punctuation, space, text }) {\n                        let newText = segment.text;\n\n                        newText = newText.substring(0, j) + newText.substring(j + 1);\n\n                        if (!preserveWhiteSpace) {\n                            newText = normalizeText(newText, forward);\n                        }\n\n                        context.deleteResult = 'range';\n\n                        if (newText) {\n                            segment.text = newText;\n\n                            if (step > 0) {\n                                j -= step;\n                            }\n                        } else {\n                            segments.splice(i, 1);\n\n                            if (step > 0) {\n                                i -= step;\n                            }\n\n                            break;\n                        }\n                    }\n                }\n                break;\n\n            case 'Image':\n                if (\n                    yield { punctuation: true, space: false, text: false } // Treat image as punctuation since they have the same behavior.\n                ) {\n                    segments.splice(i, 1);\n\n                    if (step > 0) {\n                        i -= step;\n                    }\n\n                    context.deleteResult = 'range';\n                }\n                break;\n\n            case 'SelectionMarker':\n                break;\n\n            default:\n                return null;\n        }\n    }\n\n    return null;\n}\n\n/**\n * @internal\n */\nexport const forwardDeleteWordSelection = getDeleteWordSelection('forward');\n\n/**\n * @internal\n */\nexport const backwardDeleteWordSelection = getDeleteWordSelection('backward');\n","import { normalizeContentModel } from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelDocument,\n    DeleteResult,\n    FormatContentModelContext,\n    IEditor,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * @return True means content is changed, so need to rewrite content model to editor. Otherwise false\n */\nexport function handleKeyboardEventResult(\n    editor: IEditor,\n    model: ContentModelDocument,\n    rawEvent: KeyboardEvent,\n    result: DeleteResult,\n    context: FormatContentModelContext\n): boolean {\n    context.skipUndoSnapshot = true;\n    context.clearModelCache = false;\n\n    switch (result) {\n        case 'notDeleted':\n            // We have not delete anything, we will let browser handle this event, so that current cached model may be invalid\n            context.clearModelCache = true;\n\n            // Return false here since we didn't do any change to Content Model, so no need to rewrite with Content Model\n            return false;\n\n        case 'nothingToDelete':\n            // We known there is nothing to delete, no need to let browser keep handling the event\n            rawEvent.preventDefault();\n            return false;\n\n        case 'range':\n        case 'singleChar':\n            // We have deleted what we need from content model, no need to let browser keep handling the event\n            rawEvent.preventDefault();\n            normalizeContentModel(model);\n\n            if (result == 'range') {\n                // A range is about to be deleted, so add an undo snapshot immediately\n                context.skipUndoSnapshot = false;\n            }\n\n            // Trigger an event to let plugins know the content is about to be changed by Content Model keyboard editing.\n            // So plugins can do proper handling. e.g. UndoPlugin can decide whether take a snapshot before this change happens.\n            editor.triggerEvent('beforeKeyboardEditing', {\n                rawEvent,\n            });\n\n            return true;\n    }\n}\n\n/**\n * @internal\n */\nexport function shouldDeleteWord(rawEvent: KeyboardEvent, isMac: boolean) {\n    return (\n        (isMac && rawEvent.altKey && !rawEvent.metaKey) ||\n        (!isMac && rawEvent.ctrlKey && !rawEvent.altKey)\n    );\n}\n\n/**\n * @internal\n */\nexport function shouldDeleteAllSegmentsBefore(rawEvent: KeyboardEvent) {\n    return rawEvent.metaKey && !rawEvent.altKey;\n}\n","import {\n    getClosestAncestorBlockGroupIndex,\n    isBlockGroupOfType,\n} from 'roosterjs-content-model-core';\nimport {\n    createBr,\n    createListItem,\n    createListLevel,\n    createParagraph,\n    createSelectionMarker,\n    normalizeContentModel,\n    normalizeParagraph,\n    setParagraphNotImplicit,\n} from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelBlockGroup,\n    ContentModelListItem,\n    DeleteSelectionStep,\n    InsertPoint,\n    ValidDeleteSelectionContext,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const handleEnterOnList: DeleteSelectionStep = context => {\n    const { deleteResult } = context;\n    if (\n        deleteResult == 'nothingToDelete' ||\n        deleteResult == 'notDeleted' ||\n        deleteResult == 'range'\n    ) {\n        const { insertPoint, formatContext } = context;\n        const { path } = insertPoint;\n        const rawEvent = formatContext?.rawEvent;\n        const index = getClosestAncestorBlockGroupIndex(path, ['ListItem'], ['TableCell']);\n\n        const listItem = path[index];\n        const listParent = path[index + 1];\n\n        if (listItem && listItem.blockGroupType === 'ListItem') {\n            const listIndex = listParent.blocks.indexOf(listItem);\n            const nextBlock = listParent.blocks[listIndex + 1];\n            if (deleteResult == 'range' && nextBlock) {\n                normalizeContentModel(listParent);\n                const nextListItem = listParent.blocks[listIndex + 1];\n                if (\n                    isBlockGroupOfType<ContentModelListItem>(nextListItem, 'ListItem') &&\n                    nextListItem.levels[0]\n                ) {\n                    nextListItem.levels.forEach((level, index) => {\n                        level.format.startNumberOverride = undefined;\n                        level.dataset = listItem.levels[index]\n                            ? listItem.levels[index].dataset\n                            : {};\n                    });\n                    const lastParagraph = listItem.blocks[listItem.blocks.length - 1];\n                    const nextParagraph = nextListItem.blocks[0];\n                    if (\n                        nextParagraph.blockType === 'Paragraph' &&\n                        lastParagraph.blockType === 'Paragraph' &&\n                        lastParagraph.segments[lastParagraph.segments.length - 1].segmentType ===\n                            'SelectionMarker'\n                    ) {\n                        lastParagraph.segments.pop();\n\n                        nextParagraph.segments.unshift(\n                            createSelectionMarker(insertPoint.marker.format)\n                        );\n                    }\n                    context.lastParagraph = undefined;\n                }\n            } else if (deleteResult !== 'range') {\n                if (isEmptyListItem(listItem)) {\n                    listItem.levels.pop();\n                } else {\n                    createNewListItem(context, listItem, listParent);\n                }\n            }\n            rawEvent?.preventDefault();\n            context.deleteResult = 'range';\n        }\n    }\n};\n\nconst isEmptyListItem = (listItem: ContentModelListItem) => {\n    return (\n        listItem.blocks.length === 1 &&\n        listItem.blocks[0].blockType === 'Paragraph' &&\n        listItem.blocks[0].segments.length === 2 &&\n        listItem.blocks[0].segments[0].segmentType === 'SelectionMarker' &&\n        listItem.blocks[0].segments[1].segmentType === 'Br'\n    );\n};\n\nconst createNewListItem = (\n    context: ValidDeleteSelectionContext,\n    listItem: ContentModelListItem,\n    listParent: ContentModelBlockGroup\n) => {\n    const { insertPoint } = context;\n    const listIndex = listParent.blocks.indexOf(listItem);\n    const newParagraph = createNewParagraph(insertPoint);\n\n    const levels = createNewListLevel(listItem);\n    const newListItem = createListItem(levels, insertPoint.marker.format);\n    newListItem.blocks.push(newParagraph);\n    insertPoint.paragraph = newParagraph;\n    context.lastParagraph = newParagraph;\n    listParent.blocks.splice(listIndex + 1, 0, newListItem);\n};\n\nconst createNewListLevel = (listItem: ContentModelListItem) => {\n    return listItem.levels.map(level => {\n        return createListLevel(\n            level.listType,\n            {\n                ...level.format,\n                startNumberOverride: undefined,\n            },\n            level.dataset\n        );\n    });\n};\n\nconst createNewParagraph = (insertPoint: InsertPoint) => {\n    const { paragraph, marker } = insertPoint;\n    const newParagraph = createParagraph(\n        false /*isImplicit*/,\n        paragraph.format,\n        paragraph.segmentFormat\n    );\n\n    const markerIndex = paragraph.segments.indexOf(marker);\n    const segments = paragraph.segments.splice(\n        markerIndex,\n        paragraph.segments.length - markerIndex\n    );\n\n    newParagraph.segments.push(...segments);\n\n    setParagraphNotImplicit(paragraph);\n\n    if (paragraph.segments.every(x => x.segmentType == 'SelectionMarker')) {\n        paragraph.segments.push(createBr(marker.format));\n    }\n\n    normalizeParagraph(newParagraph);\n\n    return newParagraph;\n};\n","import { ChangeSource, deleteSelection, isModifierKey } from 'roosterjs-content-model-core';\nimport { deleteAllSegmentBefore } from './deleteSteps/deleteAllSegmentBefore';\nimport { deleteList } from './deleteSteps/deleteList';\nimport { isNodeOfType } from 'roosterjs-content-model-dom';\nimport {\n    handleKeyboardEventResult,\n    shouldDeleteAllSegmentsBefore,\n    shouldDeleteWord,\n} from './handleKeyboardEventCommon';\nimport {\n    backwardDeleteWordSelection,\n    forwardDeleteWordSelection,\n} from './deleteSteps/deleteWordSelection';\nimport {\n    backwardDeleteCollapsedSelection,\n    forwardDeleteCollapsedSelection,\n} from './deleteSteps/deleteCollapsedSelection';\nimport type { DOMSelection, DeleteSelectionStep, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Do keyboard event handling for DELETE/BACKSPACE key\n * @param editor The editor object\n * @param rawEvent DOM keyboard event\n * @returns True if the event is handled by content model, otherwise false\n */\nexport function keyboardDelete(editor: IEditor, rawEvent: KeyboardEvent) {\n    let handled = false;\n    const selection = editor.getDOMSelection();\n\n    if (shouldDeleteWithContentModel(selection, rawEvent)) {\n        editor.formatContentModel(\n            (model, context) => {\n                const result = deleteSelection(\n                    model,\n                    getDeleteSteps(rawEvent, !!editor.getEnvironment().isMac),\n                    context\n                ).deleteResult;\n\n                handled = handleKeyboardEventResult(editor, model, rawEvent, result, context);\n                return handled;\n            },\n            {\n                rawEvent,\n                changeSource: ChangeSource.Keyboard,\n                getChangeData: () => rawEvent.which,\n                apiName: rawEvent.key == 'Delete' ? 'handleDeleteKey' : 'handleBackspaceKey',\n            }\n        );\n    }\n\n    return handled;\n}\n\nfunction getDeleteSteps(rawEvent: KeyboardEvent, isMac: boolean): (DeleteSelectionStep | null)[] {\n    const isForward = rawEvent.key == 'Delete';\n    const deleteAllSegmentBeforeStep =\n        shouldDeleteAllSegmentsBefore(rawEvent) && !isForward ? deleteAllSegmentBefore : null;\n    const deleteWordSelection = shouldDeleteWord(rawEvent, isMac)\n        ? isForward\n            ? forwardDeleteWordSelection\n            : backwardDeleteWordSelection\n        : null;\n    const deleteCollapsedSelection = isForward\n        ? forwardDeleteCollapsedSelection\n        : backwardDeleteCollapsedSelection;\n    return [deleteAllSegmentBeforeStep, deleteWordSelection, deleteCollapsedSelection, deleteList];\n}\n\nfunction shouldDeleteWithContentModel(selection: DOMSelection | null, rawEvent: KeyboardEvent) {\n    if (!selection) {\n        return false; // Nothing to delete\n    } else if (selection.type != 'range' || !selection.range.collapsed) {\n        return true; // Selection is not collapsed, need to delete all selections\n    } else {\n        const range = selection.range;\n\n        // When selection is collapsed and is in middle of text node, no need to use Content Model to delete\n        return !(\n            isNodeOfType(range.startContainer, 'TEXT_NODE') &&\n            !isModifierKey(rawEvent) &&\n            (canDeleteBefore(rawEvent, range) || canDeleteAfter(rawEvent, range))\n        );\n    }\n}\n\nfunction canDeleteBefore(rawEvent: KeyboardEvent, range: Range) {\n    return rawEvent.key == 'Backspace' && range.startOffset > 1;\n}\n\nfunction canDeleteAfter(rawEvent: KeyboardEvent, range: Range) {\n    return (\n        rawEvent.key == 'Delete' &&\n        range.startOffset < (range.startContainer.nodeValue?.length ?? 0) - 1\n    );\n}\n","import { deleteSelection, isModifierKey } from 'roosterjs-content-model-core';\nimport { handleEnterOnList } from './inputSteps/handleEnterOnList';\nimport { normalizeContentModel } from 'roosterjs-content-model-dom';\nimport type { DOMSelection, IEditor } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function keyboardInput(editor: IEditor, rawEvent: KeyboardEvent) {\n    const selection = editor.getDOMSelection();\n\n    if (shouldInputWithContentModel(selection, rawEvent)) {\n        editor.takeSnapshot();\n\n        editor.formatContentModel(\n            (model, context) => {\n                const result = deleteSelection(model, getInputSteps(selection, rawEvent), context);\n\n                // We have deleted selection then we will let browser to handle the input.\n                // With this combined operation, we don't wan to mass up the cached model so clear it\n                context.clearModelCache = true;\n\n                // Skip undo snapshot here and add undo snapshot before the operation so that we don't add another undo snapshot in middle of this replace operation\n                context.skipUndoSnapshot = true;\n\n                if (result.deleteResult == 'range') {\n                    // We have deleted something, next input should inherit the segment format from deleted content, so set pending format here\n                    context.newPendingFormat = result.insertPoint?.marker.format;\n\n                    normalizeContentModel(model);\n\n                    // Do not preventDefault since we still want browser to handle the final input for now\n                    return true;\n                } else {\n                    return false;\n                }\n            },\n            {\n                rawEvent,\n            }\n        );\n\n        return true;\n    }\n}\n\nfunction getInputSteps(selection: DOMSelection | null, rawEvent: KeyboardEvent) {\n    return shouldHandleEnterKey(selection, rawEvent) ? [handleEnterOnList] : [];\n}\n\nfunction shouldInputWithContentModel(selection: DOMSelection | null, rawEvent: KeyboardEvent) {\n    if (!selection) {\n        return false; // Nothing to delete\n    } else if (\n        !isModifierKey(rawEvent) &&\n        (rawEvent.key == 'Enter' || rawEvent.key == 'Space' || rawEvent.key.length == 1)\n    ) {\n        return (\n            selection.type != 'range' ||\n            !selection.range.collapsed ||\n            shouldHandleEnterKey(selection, rawEvent)\n        );\n    } else {\n        return false;\n    }\n}\n\nconst shouldHandleEnterKey = (selection: DOMSelection | null, rawEvent: KeyboardEvent) => {\n    return selection && selection.type == 'range' && rawEvent.key == 'Enter' && !rawEvent.shiftKey;\n};\n","import { getOperationalBlocks, isBlockGroupOfType } from 'roosterjs-content-model-core';\nimport { handleTabOnList } from './tabUtils/handleTabOnList';\nimport { handleTabOnParagraph } from './tabUtils/handleTabOnParagraph';\nimport { setModelIndentation } from 'roosterjs-content-model-api';\nimport type {\n    ContentModelDocument,\n    ContentModelListItem,\n    IEditor,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function keyboardTab(editor: IEditor, rawEvent: KeyboardEvent) {\n    const selection = editor.getDOMSelection();\n\n    if (selection?.type == 'range') {\n        editor.formatContentModel(\n            model => {\n                return handleTab(model, rawEvent);\n            },\n            {\n                apiName: 'handleTabKey',\n            }\n        );\n\n        return true;\n    }\n}\n\n/**\n * If multiple blocks are selected, indent or outdent the selected blocks with setModelIndentation.\n * If only one block is selected, call handleTabOnParagraph or handleTabOnList to handle the tab key.\n */\nfunction handleTab(model: ContentModelDocument, rawEvent: KeyboardEvent) {\n    const blocks = getOperationalBlocks<ContentModelListItem>(model, ['ListItem'], ['TableCell']);\n    const block = blocks.length > 0 ? blocks[0].block : undefined;\n    if (blocks.length > 1) {\n        setModelIndentation(model, rawEvent.shiftKey ? 'outdent' : 'indent');\n        rawEvent.preventDefault();\n        return true;\n    } else if (block?.blockType === 'Paragraph') {\n        return handleTabOnParagraph(model, block, rawEvent);\n    } else if (isBlockGroupOfType<ContentModelListItem>(block, 'ListItem')) {\n        return handleTabOnList(model, block, rawEvent);\n    }\n    return false;\n}\n","import { handleTabOnParagraph } from './handleTabOnParagraph';\nimport { setModelIndentation } from 'roosterjs-content-model-api';\nimport type { ContentModelDocument, ContentModelListItem } from 'roosterjs-content-model-types';\n\n/**\n * 1. When the selection is collapsed and the cursor is at start of a list item, call setModelIndentation.\n * 2. Otherwise call handleTabOnParagraph.\n * @internal\n */\nexport function handleTabOnList(\n    model: ContentModelDocument,\n    listItem: ContentModelListItem,\n    rawEvent: KeyboardEvent\n) {\n    const selectedParagraph = findSelectedParagraph(listItem);\n    if (\n        !isMarkerAtStartOfBlock(listItem) &&\n        selectedParagraph.length == 1 &&\n        selectedParagraph[0].blockType === 'Paragraph'\n    ) {\n        return handleTabOnParagraph(model, selectedParagraph[0], rawEvent);\n    } else {\n        setModelIndentation(model, rawEvent.shiftKey ? 'outdent' : 'indent');\n        rawEvent.preventDefault();\n        return true;\n    }\n}\n\nfunction isMarkerAtStartOfBlock(listItem: ContentModelListItem) {\n    return (\n        listItem.blocks[0].blockType == 'Paragraph' &&\n        listItem.blocks[0].segments[0].segmentType == 'SelectionMarker'\n    );\n}\n\nfunction findSelectedParagraph(listItem: ContentModelListItem) {\n    return listItem.blocks.filter(\n        block =>\n            block.blockType == 'Paragraph' && block.segments.some(segment => segment.isSelected)\n    );\n}\n","import { createSelectionMarker, createText } from 'roosterjs-content-model-dom';\nimport { setModelIndentation } from 'roosterjs-content-model-api';\nimport type { ContentModelDocument, ContentModelParagraph } from 'roosterjs-content-model-types';\n\nconst tabSpaces = '';\nconst space = '';\n\n/**\n * @internal\n The handleTabOnParagraph function will handle the tab key in following scenarios:\n * 1. When the selection is collapsed and the cursor is at the end of a paragraph, add 4 spaces.\n * 2. When the selection is collapsed and the cursor is at the start of a paragraph, call setModelIndention function to indent the whole paragraph\n * 3. When the selection is collapsed and the cursor is at the middle of a paragraph, add 4 spaces.\n * 4. When the selection is not collapsed, replace the selected range with a single space.\n * 5. When the selection is not collapsed, but all segments are selected, call setModelIndention function to indent the whole paragraph\n The handleTabOnParagraph function will handle the shift + tab key in a indented paragraph in following scenarios:\n * 1. When the selection is collapsed and the cursor is at the end of a paragraph, remove 4 spaces.\n * 2. When the selection is collapsed and the cursor is at the start of a paragraph, call setModelIndention function to outdent the whole paragraph\n * 3. When the selection is collapsed and the cursor is at the middle of a paragraph, remove 4 spaces.\n * 4. When the selection is not collapsed, replace the selected range with a 4 space.\n * 5. When the selection is not collapsed, but all segments are selected, call setModelIndention function to outdent the whole paragraph\n */\nexport function handleTabOnParagraph(\n    model: ContentModelDocument,\n    paragraph: ContentModelParagraph,\n    rawEvent: KeyboardEvent\n) {\n    const selectedSegments = paragraph.segments.filter(segment => segment.isSelected);\n    const isCollapsed =\n        selectedSegments.length === 1 && selectedSegments[0].segmentType === 'SelectionMarker';\n    const isAllSelected = paragraph.segments.every(segment => segment.isSelected);\n    if ((paragraph.segments[0].segmentType === 'SelectionMarker' && isCollapsed) || isAllSelected) {\n        setModelIndentation(model, rawEvent.shiftKey ? 'outdent' : 'indent');\n    } else {\n        if (!isCollapsed) {\n            let firstSelectedSegmentIndex: number | undefined = undefined;\n            let lastSelectedSegmentIndex: number | undefined = undefined;\n\n            paragraph.segments.forEach((segment, index) => {\n                if (segment.isSelected) {\n                    if (!firstSelectedSegmentIndex) {\n                        firstSelectedSegmentIndex = index;\n                    }\n                    lastSelectedSegmentIndex = index;\n                }\n            });\n            if (firstSelectedSegmentIndex && lastSelectedSegmentIndex) {\n                const firstSelectedSegment = paragraph.segments[firstSelectedSegmentIndex];\n                const spaceText = createText(\n                    rawEvent.shiftKey ? tabSpaces : space,\n                    firstSelectedSegment.format\n                );\n                const marker = createSelectionMarker(firstSelectedSegment.format);\n                paragraph.segments.splice(\n                    firstSelectedSegmentIndex,\n                    lastSelectedSegmentIndex - firstSelectedSegmentIndex + 1,\n                    spaceText,\n                    marker\n                );\n            } else {\n                return false;\n            }\n        } else {\n            const markerIndex = paragraph.segments.findIndex(\n                segment => segment.segmentType === 'SelectionMarker'\n            );\n            if (!rawEvent.shiftKey) {\n                const markerFormat = paragraph.segments[markerIndex].format;\n                const tabText = createText(tabSpaces, markerFormat);\n                paragraph.segments.splice(markerIndex, 0, tabText);\n            } else {\n                const tabText = paragraph.segments[markerIndex - 1];\n                const tabSpacesLength = tabSpaces.length;\n                if (tabText.segmentType == 'Text') {\n                    const tabSpaceTextLength = tabText.text.length - tabSpacesLength;\n                    if (tabText.text === tabSpaces) {\n                        paragraph.segments.splice(markerIndex - 1, 1);\n                    } else if (tabText.text.substring(tabSpaceTextLength) === tabSpaces) {\n                        tabText.text = tabText.text.substring(0, tabSpaceTextLength);\n                    } else {\n                        return false;\n                    }\n                }\n            }\n        }\n    }\n\n    rawEvent.preventDefault();\n    return true;\n}\n","import { isGeneralSegment } from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelBlock,\n    ContentModelBlockGroup,\n    ContentModelParagraph,\n    ContentModelSegment,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport type BlockAndPath = {\n    /**\n     * The sibling block\n     */\n    block: ContentModelBlock;\n\n    /**\n     * Path of this sibling block\n     */\n    path: ContentModelBlockGroup[];\n\n    /**\n     * If the input block is under a general segment, it is possible there are sibling segments under the same paragraph.\n     * Use this property to return the sibling sibling under the same paragraph\n     */\n    siblingSegment?: ContentModelSegment;\n};\n\n/**\n * @internal\n */\nexport function getLeafSiblingBlock(\n    path: ContentModelBlockGroup[],\n    block: ContentModelBlock,\n    isNext: boolean\n): BlockAndPath | null {\n    const newPath = [...path];\n\n    while (newPath.length > 0) {\n        const group = newPath[0];\n        const index = group.blocks.indexOf(block);\n\n        if (index < 0) {\n            break;\n        }\n\n        let nextBlock = group.blocks[index + (isNext ? 1 : -1)];\n\n        if (nextBlock) {\n            while (nextBlock.blockType == 'BlockGroup') {\n                const child = nextBlock.blocks[isNext ? 0 : nextBlock.blocks.length - 1];\n\n                if (!child) {\n                    return { block: nextBlock, path: newPath };\n                } else if (child.blockType != 'BlockGroup') {\n                    newPath.unshift(nextBlock);\n                    return { block: child, path: newPath };\n                } else {\n                    newPath.unshift(nextBlock);\n                    nextBlock = child;\n                }\n            }\n\n            return { block: nextBlock, path: newPath };\n        } else if (isGeneralSegment(group)) {\n            // For general segment, we need to check if there is sibling segment under the same paragraph\n            // First let's find the parent paragraph of this segment\n            newPath.shift();\n\n            let segmentIndex = -1;\n            const segment = group;\n            const para = newPath[0]?.blocks.find(\n                x => x.blockType == 'Paragraph' && (segmentIndex = x.segments.indexOf(segment)) >= 0\n            ) as ContentModelParagraph;\n\n            if (para) {\n                // Now we have found the parent paragraph, so let's check if it has a sibling segment\n                const siblingSegment = para.segments[segmentIndex + (isNext ? 1 : -1)];\n\n                if (siblingSegment) {\n                    // Return this block, path and segment since we have found it\n                    return { block: para, path: newPath, siblingSegment };\n                } else {\n                    // No sibling segment, let's keep go upper level\n                    block = para;\n                }\n            } else {\n                // Parent sibling is not found (in theory this should never happen), just return null\n                break;\n            }\n        } else if (group.blockGroupType != 'Document' && group.blockGroupType != 'TableCell') {\n            newPath.shift();\n            block = group;\n        } else {\n            break;\n        }\n    }\n\n    return null;\n}\n","export { TableEditPlugin } from './tableEdit/TableEditPlugin';\nexport { PastePlugin } from './paste/PastePlugin';\nexport { EditPlugin } from './edit/EditPlugin';\nexport { AutoFormatPlugin, AutoFormatOptions } from './autoFormat/AutoFormatPlugin';\n\nexport {\n    ShortcutBold,\n    ShortcutItalic,\n    ShortcutUnderline,\n    ShortcutClearFormat,\n    ShortcutUndo,\n    ShortcutUndo2,\n    ShortcutRedo,\n    ShortcutRedoMacOS,\n    ShortcutBullet,\n    ShortcutNumbering,\n    ShortcutIncreaseFont,\n    ShortcutDecreaseFont,\n} from './shortcut/shortcuts';\nexport { ShortcutPlugin } from './shortcut/ShortcutPlugin';\nexport { ShortcutKeyDefinition, ShortcutCommand } from './shortcut/ShortcutCommand';\n","import addParser from '../utils/addParser';\nimport { isNodeOfType, moveChildNodes } from 'roosterjs-content-model-dom';\nimport { setProcessor } from '../utils/setProcessor';\nimport type { BeforePasteEvent, TrustedHTMLHandler } from 'roosterjs-content-model-types';\n\nconst LAST_TD_END_REGEX = /<\\/\\s*td\\s*>((?!<\\/\\s*tr\\s*>)[\\s\\S])*$/i;\nconst LAST_TR_END_REGEX = /<\\/\\s*tr\\s*>((?!<\\/\\s*table\\s*>)[\\s\\S])*$/i;\nconst LAST_TR_REGEX = /<tr[^>]*>[^<]*/i;\nconst LAST_TABLE_REGEX = /<table[^>]*>[^<]*/i;\nconst DEFAULT_BORDER_STYLE = 'solid 1px #d4d4d4';\n\n/**\n * @internal\n * Convert pasted content from Excel, add borders when source doc doesn't have a border\n * @param event The BeforePaste event\n */\n\nexport function processPastedContentFromExcel(\n    event: BeforePasteEvent,\n    trustedHTMLHandler: TrustedHTMLHandler,\n    allowExcelNoBorderTable?: boolean\n) {\n    const { fragment, htmlBefore, clipboardData } = event;\n    const html = clipboardData.html ? excelHandler(clipboardData.html, htmlBefore) : undefined;\n\n    if (html && clipboardData.html != html) {\n        const doc = new DOMParser().parseFromString(trustedHTMLHandler(html), 'text/html');\n        moveChildNodes(fragment, doc?.body);\n    }\n\n    // For Excel Online\n    const firstChild = fragment.firstChild;\n    if (\n        isNodeOfType(firstChild, 'ELEMENT_NODE') &&\n        firstChild.tagName == 'div' &&\n        firstChild.firstChild\n    ) {\n        const tableFound = Array.from(firstChild.childNodes).every((child: Node) => {\n            // Tables pasted from Excel Online should be of the format: 0 to N META tags and 1 TABLE tag\n            const tagName = isNodeOfType(child, 'ELEMENT_NODE') && child.tagName;\n\n            return tagName == 'META'\n                ? true\n                : tagName == 'TABLE'\n                ? child == firstChild.lastChild\n                : false;\n        });\n\n        // Extract Table from Div\n        if (tableFound && firstChild.lastChild) {\n            event.fragment.replaceChildren(firstChild.lastChild);\n        }\n    }\n\n    addParser(event.domToModelOption, 'tableCell', (format, element) => {\n        if (!allowExcelNoBorderTable && element.style.borderStyle === 'none') {\n            format.borderBottom = DEFAULT_BORDER_STYLE;\n            format.borderLeft = DEFAULT_BORDER_STYLE;\n            format.borderRight = DEFAULT_BORDER_STYLE;\n            format.borderTop = DEFAULT_BORDER_STYLE;\n        }\n    });\n\n    setProcessor(event.domToModelOption, 'child', (group, element, context) => {\n        const segmentFormat = { ...context.segmentFormat };\n        if (group.blockGroupType === 'TableCell' && group.format.textColor) {\n            context.segmentFormat.textColor = group.format.textColor;\n        }\n\n        context.defaultElementProcessors.child(group, element, context);\n\n        if (group.blockGroupType === 'TableCell' && group.format.textColor) {\n            context.segmentFormat = segmentFormat;\n            delete group.format.textColor;\n        }\n    });\n}\n\n/**\n * @internal Export for test only\n * @param html Source html\n */\n\nexport function excelHandler(html: string, htmlBefore: string): string {\n    if (html.match(LAST_TD_END_REGEX)) {\n        const trMatch = htmlBefore.match(LAST_TR_REGEX);\n        const tr = trMatch ? trMatch[0] : '<TR>';\n        html = tr + html + '</TR>';\n    }\n    if (html.match(LAST_TR_END_REGEX)) {\n        const tableMatch = htmlBefore.match(LAST_TABLE_REGEX);\n        const table = tableMatch ? tableMatch[0] : '<TABLE>';\n        html = table + html + '</TABLE>';\n    }\n\n    return html;\n}\n","import addParser from './utils/addParser';\nimport { BorderKeys } from 'roosterjs-content-model-dom';\nimport { deprecatedBorderColorParser } from './utils/deprecatedColorParser';\nimport { getPasteSource } from './pasteSourceValidations/getPasteSource';\nimport { parseLink } from './utils/linkParser';\nimport { PastePropertyNames } from './pasteSourceValidations/constants';\nimport { processPastedContentFromExcel } from './Excel/processPastedContentFromExcel';\nimport { processPastedContentFromPowerPoint } from './PowerPoint/processPastedContentFromPowerPoint';\nimport { processPastedContentFromWordDesktop } from './WordDesktop/processPastedContentFromWordDesktop';\nimport { processPastedContentWacComponents } from './WacComponents/processPastedContentWacComponents';\nimport type {\n    BorderFormat,\n    ContentModelBlockFormat,\n    ContentModelTableCellFormat,\n    EditorPlugin,\n    FormatParser,\n    IEditor,\n    PluginEvent,\n} from 'roosterjs-content-model-types';\n\n/**\n * Paste plugin, handles BeforePaste event and reformat some special content, including:\n * 1. Content copied from Word\n * 2. Content copied from Excel\n * 3. Content copied from Word Online or OneNote Online\n * 4. Content copied from Power Point\n */\nexport class PastePlugin implements EditorPlugin {\n    private editor: IEditor | null = null;\n\n    /**\n     * Construct a new instance of Paste class\n     * @param unknownTagReplacement Replace solution of unknown tags, default behavior is to replace with SPAN\n     * @param allowExcelNoBorderTable Allow table copied from Excel without border\n     */\n    constructor(private allowExcelNoBorderTable?: boolean) {}\n\n    /**\n     * Get name of this plugin\n     */\n    getName() {\n        return 'Paste';\n    }\n\n    /**\n     * The first method that editor will call to a plugin when editor is initializing.\n     * It will pass in the editor instance, plugin should take this chance to save the\n     * editor reference so that it can call to any editor method or format API later.\n     * @param editor The editor object\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n    }\n\n    /**\n     * The last method that editor will call to a plugin before it is disposed.\n     * Plugin can take this chance to clear the reference to editor. After this method is\n     * called, plugin should not call to any editor method since it will result in error.\n     */\n    dispose() {\n        this.editor = null;\n    }\n\n    /**\n     * Core method for a plugin. Once an event happens in editor, editor will call this\n     * method of each plugin to handle the event as long as the event is not handled\n     * exclusively by another plugin.\n     * @param event The event to handle:\n     */\n    onPluginEvent(event: PluginEvent) {\n        if (!this.editor || event.eventType != 'beforePaste') {\n            return;\n        }\n\n        if (!event.domToModelOption) {\n            return;\n        }\n\n        const pasteSource = getPasteSource(event, false);\n        const pasteType = event.pasteType;\n\n        switch (pasteSource) {\n            case 'wordDesktop':\n                processPastedContentFromWordDesktop(event, this.editor.getTrustedHTMLHandler());\n                break;\n            case 'wacComponents':\n                processPastedContentWacComponents(event);\n                break;\n            case 'excelOnline':\n            case 'excelDesktop':\n                if (pasteType === 'normal' || pasteType === 'mergeFormat') {\n                    // Handle HTML copied from Excel\n                    processPastedContentFromExcel(\n                        event,\n                        this.editor.getTrustedHTMLHandler(),\n                        this.allowExcelNoBorderTable\n                    );\n                }\n                break;\n            case 'googleSheets':\n                event.domToModelOption.additionalAllowedTags.push(\n                    PastePropertyNames.GOOGLE_SHEET_NODE_NAME as Lowercase<string>\n                );\n                break;\n            case 'powerPointDesktop':\n                processPastedContentFromPowerPoint(event, this.editor.getTrustedHTMLHandler());\n                break;\n        }\n\n        addParser(event.domToModelOption, 'link', parseLink);\n        addParser(event.domToModelOption, 'tableCell', deprecatedBorderColorParser);\n        addParser(event.domToModelOption, 'tableCell', tableBorderParser);\n        addParser(event.domToModelOption, 'table', deprecatedBorderColorParser);\n\n        if (pasteType === 'mergeFormat') {\n            addParser(event.domToModelOption, 'block', blockElementParser);\n            addParser(event.domToModelOption, 'listLevel', blockElementParser);\n        }\n    }\n}\n\n/**\n * For block elements that have background color style, remove the background color when user selects the merge current format\n * paste option\n */\nconst blockElementParser: FormatParser<ContentModelBlockFormat> = (\n    format: ContentModelBlockFormat,\n    element: HTMLElement\n) => {\n    if (element.style.backgroundColor) {\n        delete format.backgroundColor;\n    }\n};\n\nconst ElementBorderKeys = new Map<\n    keyof BorderFormat,\n    {\n        c: keyof CSSStyleDeclaration;\n        s: keyof CSSStyleDeclaration;\n        w: keyof CSSStyleDeclaration;\n    }\n>([\n    ['borderTop', { w: 'borderTopWidth', s: 'borderTopStyle', c: 'borderTopColor' }],\n    ['borderRight', { w: 'borderRightWidth', s: 'borderRightStyle', c: 'borderRightColor' }],\n    ['borderBottom', { w: 'borderBottomWidth', s: 'borderBottomStyle', c: 'borderBottomColor' }],\n    ['borderLeft', { w: 'borderLeftWidth', s: 'borderLeftStyle', c: 'borderLeftColor' }],\n]);\n\nfunction tableBorderParser(format: ContentModelTableCellFormat, element: HTMLElement): void {\n    BorderKeys.forEach(key => {\n        if (!format[key]) {\n            const styleSet = ElementBorderKeys.get(key);\n            if (\n                styleSet &&\n                element.style[styleSet.w] &&\n                element.style[styleSet.s] &&\n                !element.style[styleSet.c]\n            ) {\n                format[key] = `${element.style[styleSet.w]} ${element.style[styleSet.s]}`;\n            }\n        }\n    });\n}\n","import { moveChildNodes } from 'roosterjs-content-model-dom';\nimport type { BeforePasteEvent, TrustedHTMLHandler } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * Convert pasted content from PowerPoint\n * @param event The BeforePaste event\n */\n\nexport function processPastedContentFromPowerPoint(\n    event: BeforePasteEvent,\n    trustedHTMLHandler: TrustedHTMLHandler\n) {\n    const { fragment, clipboardData } = event;\n\n    if (clipboardData.html && !clipboardData.text && clipboardData.image) {\n        // It is possible that PowerPoint copied both image and HTML but not plain text.\n        // We always prefer HTML if any.\n        const doc = new DOMParser().parseFromString(\n            trustedHTMLHandler(clipboardData.html),\n            'text/html'\n        );\n\n        moveChildNodes(fragment, doc?.body);\n    }\n}\n","/**\n * @internal\n **/\nexport const WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES: string[] = [\n    'TableInsertRowGapBlank',\n    'TableColumnResizeHandle',\n    'TableCellTopBorderHandle',\n    'TableCellLeftBorderHandle',\n    'TableHoverColumnHandle',\n    'TableHoverRowHandle',\n];\n/**\n * @internal\n **/\nexport const BULLET_LIST_STYLE: string = 'BulletListStyle';\n/**\n * @internal\n **/\nexport const NUMBER_LIST_STYLE: string = 'NumberListStyle';\n/**\n * @internal\n **/\nexport const IMAGE_BORDER: string = 'WACImageBorder';\n/**\n * @internal\n **/\nexport const IMAGE_CONTAINER: string = 'WACImageContainer';\n/**\n * @internal\n **/\nexport const OUTLINE_ELEMENT: string = 'OutlineElement';\n/**\n * @internal\n **/\nexport const PARAGRAPH: string = 'Paragraph';\n/**\n * @internal\n **/\nexport const LIST_CONTAINER_ELEMENT_CLASS_NAME: string = 'ListContainerWrapper';\n/**\n * @internal\n **/\nexport const COMMENT_HIGHLIGHT_CLASS: string = 'CommentHighlightRest';\n/**\n * @internal\n **/\nexport const COMMENT_HIGHLIGHT_CLICKED_CLASS: string = 'CommentHighlightClicked';\n/**\n * @internal\n **/\nexport const TEMP_ELEMENTS_CLASSES: string[] = [\n    ...WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES,\n    'ListMarkerWrappingSpan',\n];\n/**\n * @internal\n **/\nexport const WAC_IDENTIFY_SELECTOR: string =\n    `ul[class^=\"${BULLET_LIST_STYLE}\"]>.${OUTLINE_ELEMENT},ol[class^=\"${NUMBER_LIST_STYLE}\"]>.${OUTLINE_ELEMENT},span.${IMAGE_CONTAINER},span.${IMAGE_BORDER},.${COMMENT_HIGHLIGHT_CLASS},.${COMMENT_HIGHLIGHT_CLICKED_CLASS},` +\n    WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES.map(c => `table div[class^=\"${c}\"]`).join(',');\n","import addParser from '../utils/addParser';\nimport { createListLevel, parseFormat } from 'roosterjs-content-model-dom';\nimport { setProcessor } from '../utils/setProcessor';\nimport {\n    COMMENT_HIGHLIGHT_CLASS,\n    COMMENT_HIGHLIGHT_CLICKED_CLASS,\n    LIST_CONTAINER_ELEMENT_CLASS_NAME,\n    TEMP_ELEMENTS_CLASSES,\n    WAC_IDENTIFY_SELECTOR,\n} from './constants';\nimport type {\n    BeforePasteEvent,\n    ContentModelBlockFormat,\n    ContentModelBlockGroup,\n    ContentModelListItemLevelFormat,\n    ContentModelListLevel,\n    ContentModelSegmentFormat,\n    DomToModelContext,\n    DomToModelListFormat,\n    ElementProcessor,\n    FormatParser,\n} from 'roosterjs-content-model-types';\n\nconst LIST_ELEMENT_TAGS = ['UL', 'OL', 'LI'];\nconst LIST_ELEMENT_SELECTOR = LIST_ELEMENT_TAGS.join(',');\n\ninterface WacContext extends DomToModelListFormat {\n    /**\n     * Current list levels\n     */\n    currentListLevels?: ContentModelListLevel[];\n    /**\n     * Array to keep the start of the lists and determine if the start override should be set.\n     */\n    listItemThread?: number[];\n}\n\n/**\n * Wac components do not use sub and super tags, instead only add vertical align to a span.\n * This parser normalize the content for content model\n */\nconst wacSubSuperParser: FormatParser<ContentModelSegmentFormat> = (\n    format: ContentModelSegmentFormat,\n    element: HTMLElement\n): void => {\n    const verticalAlign = element.style.verticalAlign;\n    if (verticalAlign === 'super') {\n        format.superOrSubScriptSequence = 'super';\n    }\n    if (verticalAlign === 'sub') {\n        format.superOrSubScriptSequence = 'sub';\n    }\n};\n\n/**\n * This processor does:\n * 1) Remove the display and margin of the element.\n * 2) When an element should be ignored but should handle the child elements call the default child processor.\n * 3) Removes the End of Paragraph element to avoid empty lines, we should only remove this if the previous element of the EOP is an EmptyTextRun\n * 4) Finally call the default processor.\n * @returns\n */\nconst wacElementProcessor: ElementProcessor<HTMLElement> = (\n    group: ContentModelBlockGroup,\n    element: HTMLElement,\n    context: DomToModelContext\n): void => {\n    const elementTag = element.tagName;\n\n    if (element.matches(WAC_IDENTIFY_SELECTOR)) {\n        element.style.removeProperty('display');\n        element.style.removeProperty('margin');\n    }\n\n    if (element.classList.contains(LIST_CONTAINER_ELEMENT_CLASS_NAME)) {\n        context.elementProcessors.child(group, element, context);\n        return;\n    }\n\n    if (TEMP_ELEMENTS_CLASSES.some(className => element.classList.contains(className))) {\n        return;\n    } else if (shouldClearListContext(elementTag, element, context)) {\n        const { listFormat } = context;\n        listFormat.levels = [];\n        listFormat.listParent = undefined;\n    }\n\n    context.defaultElementProcessors.element(group, element, context);\n};\n\n/**\n * This processor calls the default list processor and then sets the correct list level and list bullet.\n */\nconst wacLiElementProcessor: ElementProcessor<HTMLLIElement> = (\n    group: ContentModelBlockGroup,\n    element: HTMLLIElement,\n    context: DomToModelContext\n): void => {\n    const level = parseInt(element.getAttribute('data-aria-level') ?? '');\n    const listFormat = context.listFormat as WacContext;\n    const listType =\n        listFormat.levels[context.listFormat.levels.length - 1]?.listType ||\n        (element.closest('ol,ul')?.tagName.toUpperCase() as 'UL' | 'OL');\n    const newLevel: ContentModelListLevel = createListLevel(listType, context.blockFormat);\n    parseFormat(element, context.formatParsers.listLevelThread, newLevel.format, context);\n    parseFormat(element, context.formatParsers.listLevel, newLevel.format, context);\n    context.listFormat.levels = listFormat.currentListLevels || context.listFormat.levels;\n\n    if (level > 0) {\n        if (level > context.listFormat.levels.length) {\n            while (level != context.listFormat.levels.length) {\n                context.listFormat.levels.push(newLevel);\n            }\n        } else {\n            context.listFormat.levels.splice(level, context.listFormat.levels.length - 1);\n            context.listFormat.levels[level - 1] = newLevel;\n        }\n    }\n\n    context.defaultElementProcessors.li?.(group, element, context);\n\n    const listParent = listFormat.listParent;\n    if (listParent) {\n        const lastblock = listParent.blocks[listParent.blocks.length - 1];\n        if (lastblock.blockType == 'BlockGroup' && lastblock.blockGroupType == 'ListItem') {\n            const currentLevel = lastblock.levels[lastblock.levels.length - 1];\n            updateStartOverride(currentLevel, element, context);\n        }\n    }\n\n    const newLevels: ContentModelListLevel[] = [];\n    listFormat.levels.forEach(v => {\n        const newValue: ContentModelListLevel = {\n            dataset: { ...v.dataset },\n            format: { ...v.format },\n            listType: v.listType,\n        };\n        newLevels.push(newValue);\n    });\n    listFormat.currentListLevels = newLevels;\n    listFormat.levels = [];\n};\n\n/**\n * This parsers does:\n * 1) Sets the display for dummy item to undefined when the current style is block.\n * 2) Removes the Margin Left\n */\nconst wacListItemParser: FormatParser<ContentModelListItemLevelFormat> = (\n    format: ContentModelListItemLevelFormat,\n    element: HTMLElement\n): void => {\n    if (element.style.display === 'block') {\n        format.displayForDummyItem = undefined;\n    }\n\n    format.marginLeft = undefined;\n};\n\n/**\n * Wac usually adds padding to lists which is unwanted so remove it.\n */\nconst wacListLevelParser: FormatParser<ContentModelListItemLevelFormat> = (\n    format: ContentModelListItemLevelFormat\n): void => {\n    format.marginLeft = undefined;\n    format.paddingLeft = undefined;\n};\n\n/**\n * This function returns whether we need to clear the list format.\n * Word Online wraps lists inside divs to have this structure:\n *\n *  <div class='ListContainerWrapper'>\n *      <ol>...</ol>\n *  </div>\n *  <div>\n *      <p>...</p>\n *  <div>\n *  <div class='ListContainerWrapper'>\n *      <ol>...</ol>\n *  </div>\n *\n *  So if a elements is not contained inside of a list we should clear the list context to prevent normal text to be\n *  transformed into list\n *  For the above scenario, if we do not clear the format, the content inside of the second div would be transformed to a list too.\n */\nfunction shouldClearListContext(\n    elementTag: string,\n    element: HTMLElement,\n    context: DomToModelContext\n) {\n    return (\n        context.listFormat.levels.length > 0 &&\n        LIST_ELEMENT_TAGS.every(tag => tag != elementTag) &&\n        !element.closest(LIST_ELEMENT_SELECTOR)\n    );\n}\n\nconst wacCommentParser: FormatParser<ContentModelSegmentFormat> = (\n    format: ContentModelSegmentFormat,\n    element: HTMLElement\n): void => {\n    if (\n        element.className.includes(COMMENT_HIGHLIGHT_CLASS) ||\n        element.className.includes(COMMENT_HIGHLIGHT_CLICKED_CLASS)\n    ) {\n        delete format.backgroundColor;\n    }\n};\n/**\n * @internal\n * Convert pasted content from Office Online\n * Once it is known that the document is from WAC\n * We need to remove the display property and margin from all the list item\n * @param ev BeforePasteEvent\n */\nexport function processPastedContentWacComponents(ev: BeforePasteEvent) {\n    addParser(ev.domToModelOption, 'segment', wacSubSuperParser);\n    addParser(ev.domToModelOption, 'listItemThread', wacListItemParser);\n    addParser(ev.domToModelOption, 'listLevel', wacListLevelParser);\n    addParser(ev.domToModelOption, 'container', wacContainerParser);\n    addParser(ev.domToModelOption, 'table', wacContainerParser);\n    addParser(ev.domToModelOption, 'segment', wacCommentParser);\n\n    setProcessor(ev.domToModelOption, 'element', wacElementProcessor);\n    setProcessor(ev.domToModelOption, 'li', wacLiElementProcessor);\n}\n\nconst wacContainerParser: FormatParser<ContentModelBlockFormat> = (\n    format: ContentModelBlockFormat,\n    element: HTMLElement\n) => {\n    if (element.style.marginLeft.startsWith('-')) {\n        delete format.marginLeft;\n    }\n};\n\nfunction updateStartOverride(\n    currentLevel: ContentModelListLevel | undefined,\n    element: HTMLLIElement,\n    ctx: DomToModelContext\n) {\n    if (!currentLevel || currentLevel.listType == 'UL') {\n        return;\n    }\n\n    const list = element.closest('ol');\n    const listFormat = ctx.listFormat as WacContext;\n    const [start, listLevel] = extractWordListMetadata(list, element);\n\n    if (!listFormat.listItemThread) {\n        listFormat.listItemThread = [];\n    }\n\n    const thread: number | undefined = listFormat.listItemThread[listLevel];\n    if (thread && start - thread != 1) {\n        currentLevel.format.startNumberOverride = start;\n    }\n    listFormat.listItemThread[listLevel] = start;\n}\nfunction extractWordListMetadata(\n    list: HTMLElement | null | undefined,\n    item: HTMLElement | null | undefined\n) {\n    const itemIndex =\n        item && Array.from(list?.querySelectorAll('li') || []).indexOf(item as HTMLLIElement);\n    const start =\n        parseInt(list?.getAttribute('start') || '1') + (itemIndex && itemIndex > 0 ? itemIndex : 0);\n    const listLevel = parseInt(item?.getAttribute('data-aria-level') || '');\n\n    return [start, listLevel];\n}\n","import { getObjectKeys } from 'roosterjs-content-model-dom';\nimport type { WordMetadata } from './WordMetadata';\nimport type { BeforePasteEvent } from 'roosterjs-content-model-types';\n\nconst FORMATING_REGEX = /[\\n\\t'{}\"]+/g;\n\n/**\n * @internal\n * Word Desktop content has a style tag that contains data for the lists.\n * So this function query that style tag and extract the data from the innerHTML, since it is not available from the HTMLStyleElement.sheet.\n *\n * The format is like:\n * example of style element content\n * @list l0:level1 {\n * styleTag: styleValue;\n * ...\n * }\n *\n * To extract the data:\n * 1. Substring the value of the style selector, using @ index and { index\n * 2. Substring the value of the style rules by Substring the content between { and }\n * 3. Split the value of the rules using ; as separator { styleTag: styleValue; styleTag1: StyleValue1 } = ['styleTag: styleValue',  'styleTag1: StyleValue1']\n * 4. Split the value of the rule  using : as separator: styleTag: styleValue = [styleTag, styleValue]\n * 5. Save data in record and only use the required information.\n *\n */\nexport default function getStyleMetadata(\n    ev: BeforePasteEvent,\n    trustedHTMLHandler: (val: string) => string\n) {\n    const metadataMap: Map<string, WordMetadata> = new Map();\n    const doc = new DOMParser().parseFromString(trustedHTMLHandler(ev.htmlBefore), 'text/html');\n    const styles = doc.querySelectorAll('style');\n\n    styles.forEach(style => {\n        const text = style?.innerHTML.trim() || '';\n\n        let index = 0;\n        while (index >= 0) {\n            const indexAt = text.indexOf('@', index + 1);\n            const indexCurlyEnd = text.indexOf('}', indexAt);\n            const indexCurlyStart = text.indexOf('{', indexAt);\n            index = indexAt;\n\n            // 1.\n            const metadataName = text\n                .substring(indexAt + 1, indexCurlyStart)\n                .replace(FORMATING_REGEX, '')\n                .replace('list', '')\n                .trimRight()\n                .trimLeft();\n\n            // 2.\n            const dataName = text\n                .substring(indexCurlyStart, indexCurlyEnd + 1)\n                .trimLeft()\n                .trimRight();\n            const record: Record<string, string> = {};\n\n            // 3.\n            const entries = dataName.split(';');\n            entries.forEach(entry => {\n                // 4.\n                const [key, value] = entry.split(':');\n                if (key && value) {\n                    const formatedKey = key.replace(FORMATING_REGEX, '').trimRight().trimLeft();\n                    const formatedValue = value.replace(FORMATING_REGEX, '').trimRight().trimLeft();\n                    // 5.\n                    record[formatedKey] = formatedValue;\n                }\n            });\n\n            const data: WordMetadata = {\n                'mso-level-number-format': record['mso-level-number-format'],\n                'mso-level-start-at': record['mso-level-start-at'] || '1',\n                'mso-level-text': record['mso-level-text'],\n            };\n            if (getObjectKeys(data).some(key => !!data[key])) {\n                metadataMap.set(metadataName, data);\n            }\n        }\n    });\n    return metadataMap;\n}\n","import addParser from '../utils/addParser';\nimport getStyleMetadata from './getStyleMetadata';\nimport { getStyles } from '../utils/getStyles';\nimport { processWordComments } from './processWordComments';\nimport { processWordList } from './processWordLists';\nimport { removeNegativeTextIndentParser } from './removeNegativeTextIndentParser';\nimport { setProcessor } from '../utils/setProcessor';\nimport type { WordMetadata } from './WordMetadata';\nimport type {\n    BeforePasteEvent,\n    ContentModelBlockFormat,\n    ContentModelListItemLevelFormat,\n    ContentModelTableFormat,\n    DomToModelContext,\n    ElementProcessor,\n    FormatParser,\n} from 'roosterjs-content-model-types';\n\nconst PERCENTAGE_REGEX = /%/;\nconst DEFAULT_BROWSER_LINE_HEIGHT_PERCENTAGE = 120;\n\n/**\n * @internal\n * Handles Pasted content when source is Word Desktop\n * @param ev BeforePasteEvent\n */\nexport function processPastedContentFromWordDesktop(\n    ev: BeforePasteEvent,\n    trustedHTMLHandler: (text: string) => string\n) {\n    const metadataMap: Map<string, WordMetadata> = getStyleMetadata(ev, trustedHTMLHandler);\n\n    setProcessor(ev.domToModelOption, 'element', wordDesktopElementProcessor(metadataMap));\n    addParser(ev.domToModelOption, 'block', removeNonValidLineHeight);\n    addParser(ev.domToModelOption, 'block', removeNegativeTextIndentParser);\n    addParser(ev.domToModelOption, 'listLevel', listLevelParser);\n    addParser(ev.domToModelOption, 'container', wordTableParser);\n    addParser(ev.domToModelOption, 'table', wordTableParser);\n}\n\nconst wordDesktopElementProcessor = (\n    metadataKey: Map<string, WordMetadata>\n): ElementProcessor<HTMLElement> => {\n    return (group, element, context) => {\n        const styles = getStyles(element);\n        // Process Word Lists or Word Commands, otherwise use the default processor on this element.\n        if (\n            !(\n                processWordList(styles, group, element, context, metadataKey) ||\n                processWordComments(styles, element)\n            )\n        ) {\n            context.defaultElementProcessors.element(group, element, context);\n        }\n    };\n};\n\nfunction removeNonValidLineHeight(\n    format: ContentModelBlockFormat,\n    element: HTMLElement,\n    context: DomToModelContext,\n    defaultStyle: Readonly<Partial<CSSStyleDeclaration>>\n): void {\n    //If the line height is less than the browser default line height, line between the text is going to be too narrow\n    let parsedLineHeight: number;\n    if (\n        PERCENTAGE_REGEX.test(element.style.lineHeight) &&\n        !isNaN((parsedLineHeight = parseInt(element.style.lineHeight))) &&\n        parsedLineHeight < DEFAULT_BROWSER_LINE_HEIGHT_PERCENTAGE\n    ) {\n        format.lineHeight = defaultStyle.lineHeight;\n    }\n}\n\nfunction listLevelParser(\n    format: ContentModelListItemLevelFormat,\n    element: HTMLElement,\n    context: DomToModelContext,\n    defaultStyle: Readonly<Partial<CSSStyleDeclaration>>\n): void {\n    if (element.style.marginLeft != '') {\n        format.marginLeft = defaultStyle.marginLeft;\n    }\n\n    format.marginBottom = undefined;\n}\n\nconst wordTableParser: FormatParser<ContentModelTableFormat> = (format): void => {\n    if (format.marginLeft?.startsWith('-')) {\n        delete format.marginLeft;\n    }\n};\n","import { isElementOfType } from 'roosterjs-content-model-dom';\n\nconst MSO_COMMENT_ANCHOR_HREF_REGEX = /#_msocom_/;\nconst MSO_SPECIAL_CHARACTER = 'mso-special-character';\nconst MSO_SPECIAL_CHARACTER_COMMENT = 'comment';\nconst MSO_ELEMENT = 'mso-element';\nconst MSO_ELEMENT_COMMENT_LIST = 'comment-list';\n\n/**\n * @internal\n * Check whether the element contain Word attributes related to comments and if it does we should no process\n * this element.\n * @returns\n */\nexport function processWordComments(styles: Record<string, string>, element: HTMLElement) {\n    return (\n        styles[MSO_SPECIAL_CHARACTER] == MSO_SPECIAL_CHARACTER_COMMENT ||\n        (isElementOfType(element, 'a') && MSO_COMMENT_ANCHOR_HREF_REGEX.test(element.href)) ||\n        styles[MSO_ELEMENT] == MSO_ELEMENT_COMMENT_LIST\n    );\n}\n","import { getListStyleTypeFromString, updateListMetadata } from 'roosterjs-content-model-core';\nimport { removeNegativeTextIndentParser } from './removeNegativeTextIndentParser';\nimport type { WordMetadata } from './WordMetadata';\nimport {\n    addBlock,\n    createListItem,\n    createListLevel,\n    isEmpty,\n    parseFormat,\n} from 'roosterjs-content-model-dom';\nimport type {\n    ContentModelBlockGroup,\n    ContentModelListItem,\n    ContentModelListItemFormat,\n    ContentModelListItemLevelFormat,\n    ContentModelListLevel,\n    DomToModelContext,\n    DomToModelListFormat,\n} from 'roosterjs-content-model-types';\n\n/** Word list metadata style name */\nconst MSO_LIST = 'mso-list';\nconst MSO_LIST_IGNORE = 'ignore';\nconst WORD_FIRST_LIST = 'l0';\nconst TEMPLATE_VALUE_REGEX = /%[0-9a-zA-Z]+/g;\n\ninterface WordDesktopListFormat extends DomToModelListFormat {\n    wordLevel?: number | '';\n    wordList?: string;\n    wordKnownLevels?: Map<string, ContentModelListLevel[]>;\n}\n\ninterface WordListFormat extends ContentModelListItemFormat {\n    wordList?: string;\n}\n\nconst BULLET_METADATA = 'bullet';\n/**\n * @internal\n * @param styles\n * @param group\n * @param element\n * @param context\n * @returns\n */\nexport function processWordList(\n    styles: Record<string, string>,\n    group: ContentModelBlockGroup,\n    element: HTMLElement,\n    context: DomToModelContext,\n    metadata: Map<string, WordMetadata>\n) {\n    const listFormat = context.listFormat as WordDesktopListFormat;\n    if (!listFormat.wordKnownLevels) {\n        listFormat.wordKnownLevels = new Map<string, ContentModelListLevel[]>();\n    }\n    const wordListStyle = styles[MSO_LIST] || '';\n\n    // If the element contains Ignore style, do not process it,\n    // Usually this element contains the fake bullet used in Word Desktop.\n    if (wordListStyle.toLowerCase() === MSO_LIST_IGNORE) {\n        return true;\n    }\n\n    const [lNumber, level] = wordListStyle.split(' ');\n    // Try get the list metadata from word, which follows this format: l1 level1 lfo2\n    // If we are able to get the level property means we can process this element to be a list\n    listFormat.wordLevel = level && parseInt(level.substr('level'.length));\n\n    listFormat.wordList = lNumber || WORD_FIRST_LIST;\n    if (listFormat.levels.length == 0) {\n        listFormat.levels =\n            (listFormat.wordList && listFormat.wordKnownLevels.get(listFormat.wordList)) || [];\n    }\n\n    if (wordListStyle && group && typeof listFormat.wordLevel === 'number') {\n        const { wordLevel, wordList } = listFormat;\n        // Retrieve the Fake bullet on the element and also the list type\n        const listMetadata = metadata.get(`${lNumber}:${level}`);\n        const listType =\n            listMetadata?.['mso-level-number-format']?.toLowerCase() != BULLET_METADATA\n                ? 'OL'\n                : 'UL';\n\n        // Create the new level of the list item and parse the format\n        const newLevel: ContentModelListLevel = createListLevel(listType);\n        parseFormat(\n            element,\n            [...context.formatParsers.listLevel, wordListPaddingParser],\n            newLevel.format,\n            context\n        );\n\n        // If the list format is in a different level, update the array so we get the new item\n        // To be in the same level as the provided level metadata.\n        if (wordLevel > listFormat.levels.length) {\n            while (wordLevel != listFormat.levels.length) {\n                listFormat.levels.push(newLevel);\n            }\n        } else {\n            listFormat.levels.splice(wordLevel, listFormat.levels.length - 1);\n            listFormat.levels[wordLevel - 1] = newLevel;\n        }\n        (listFormat.levels[listFormat.levels.length - 1]\n            .format as WordListFormat).wordList = wordList;\n\n        listFormat.listParent = group;\n\n        processAsListItem(listFormat, context, element, group, listMetadata);\n\n        if (\n            listFormat.levels.length > 0 &&\n            listFormat.wordKnownLevels.get(wordList) != listFormat.levels\n        ) {\n            listFormat.wordKnownLevels.set(wordList, [...listFormat.levels]);\n        }\n        return true;\n    }\n\n    return false;\n}\n\nfunction processAsListItem(\n    listFormat: WordDesktopListFormat,\n    context: DomToModelContext,\n    element: HTMLElement,\n    group: ContentModelBlockGroup,\n    listMetadata: WordMetadata | undefined\n) {\n    const listLevel = listFormat.levels[listFormat.levels.length - 1];\n    const { listType } = listLevel;\n    const bullet = getBulletFromMetadata(listMetadata, listType);\n    if (bullet) {\n        updateListMetadata(listFormat.levels[listFormat.levels.length - 1], metadata =>\n            Object.assign({}, metadata, {\n                unorderedStyleType: listType == 'UL' ? bullet : undefined,\n                orderedStyleType: listType == 'OL' ? bullet : undefined,\n            })\n        );\n    }\n\n    const listItem = createListItem(listFormat.levels, context.segmentFormat);\n\n    parseFormat(element, context.formatParsers.segmentOnBlock, context.segmentFormat, context);\n    parseFormat(element, context.formatParsers.listItemElement, listItem.format, context);\n    parseFormat(element, [removeNegativeTextIndentParser], listItem.format, context);\n\n    if (listType == 'OL') {\n        setStartNumber(listItem, context, listMetadata);\n    }\n\n    context.elementProcessors.child(listItem, element, context);\n    addBlock(group, listItem);\n}\n\nfunction getBulletFromMetadata(listMetadata: WordMetadata | undefined, listType: 'OL' | 'UL') {\n    const templateType = listMetadata?.['mso-level-number-format'] || 'decimal';\n    let templateFinal: string;\n\n    if (listMetadata?.['mso-level-text']) {\n        let templateValue: string = '';\n        switch (templateType) {\n            case 'alpha-upper':\n                templateValue = 'UpperAlpha';\n                break;\n            case 'alpha-lower':\n                templateValue = 'LowerAlpha';\n                break;\n            case 'roman-lower':\n                templateValue = 'LowerRoman';\n                break;\n            case 'roman-upper':\n                templateValue = 'UpperRoman';\n                break;\n            default:\n                templateValue = 'Number';\n                break;\n        }\n        const template = (listMetadata['mso-level-text'] || '')\n            .replace('\\\\', '')\n            .replace('\"', '')\n            .replace(TEMPLATE_VALUE_REGEX, '${' + templateValue + '}');\n\n        templateFinal = '\"' + template + ' \"';\n    } else {\n        switch (templateType) {\n            case 'alpha-lower':\n                templateFinal = 'lower-alpha';\n                break;\n            case 'roman-lower':\n                templateFinal = 'lower-roman';\n                break;\n            case 'roman-upper':\n                templateFinal = 'upper-roman';\n                break;\n            default:\n                templateFinal = 'decimal';\n                break;\n        }\n    }\n\n    return getListStyleTypeFromString(listType, templateFinal);\n}\n\nfunction wordListPaddingParser(\n    format: ContentModelListItemLevelFormat,\n    element: HTMLElement\n): void {\n    if (element.style.marginLeft && element.style.marginLeft != '0in') {\n        format.paddingLeft = '0px';\n    }\n    if (element.style.marginRight && element.style.marginRight != '0in') {\n        format.paddingRight = '0px';\n    }\n}\n\nfunction setStartNumber(\n    listItem: ContentModelListItem,\n    context: DomToModelContext,\n    listMetadata: WordMetadata | undefined\n) {\n    const {\n        listParent,\n        wordList,\n        wordKnownLevels,\n        wordLevel,\n        levels,\n    } = context.listFormat as WordDesktopListFormat;\n\n    const block = getLastNotEmptyBlock(listParent);\n    if (\n        (block?.blockType != 'BlockGroup' ||\n            block.blockGroupType != 'ListItem' ||\n            (wordLevel &&\n                (block.levels[wordLevel]?.format as WordListFormat)?.wordList != wordList)) &&\n        wordList\n    ) {\n        const start = listMetadata?.['mso-level-start-at']\n            ? parseInt(listMetadata['mso-level-start-at'])\n            : NaN;\n        const knownLevel = wordKnownLevels?.get(wordList) || [];\n\n        if (start != undefined && !isNaN(start) && knownLevel.length != levels.length) {\n            listItem.levels[listItem.levels.length - 1].format.startNumberOverride = start;\n        }\n    }\n}\n\nfunction getLastNotEmptyBlock(listParent: ContentModelBlockGroup | undefined) {\n    for (let index = (listParent?.blocks.length || 0) - 1; index > 0; index--) {\n        const result = listParent?.blocks[index];\n        if (result && !isEmpty(result)) {\n            return result;\n        }\n    }\n\n    return undefined;\n}\n","import type { FormatParser, TextIndentFormat } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const removeNegativeTextIndentParser: FormatParser<TextIndentFormat> = (format, element) => {\n    if (format.textIndent?.startsWith('-')) {\n        delete format.textIndent;\n    }\n};\n","/**\n * @internal\n */\nexport const PastePropertyNames = {\n    /**\n     * Node attribute used to identify if the content is from Google Sheets.\n     */\n    GOOGLE_SHEET_NODE_NAME: 'google-sheets-html-origin',\n\n    /**\n     * Name of the HTMLMeta Property that provides the Office App Source of the pasted content\n     */\n    PROG_ID_NAME: 'ProgId',\n\n    /**\n     * Name of the HTMLMeta Property that identifies pated content as from Excel Desktop\n     */\n    EXCEL_DESKTOP_ATTRIBUTE_NAME: 'xmlns:x',\n};\n","import { WAC_IDENTIFY_SELECTOR } from '../WacComponents/constants';\nimport type { GetSourceFunction } from './getPasteSource';\n\n/**\n * @internal\n * Check whether the fragment provided contain Wac Elements\n * @param props Properties related to the PasteEvent\n * @returns\n */\nexport const documentContainWacElements: GetSourceFunction = props => {\n    const { fragment } = props;\n    return !!fragment.querySelector(WAC_IDENTIFY_SELECTOR);\n};\n","import { documentContainWacElements } from './documentContainWacElements';\nimport { isExcelDesktopDocument } from './isExcelDesktopDocument';\nimport { isExcelOnlineDocument } from './isExcelOnlineDocument';\nimport { isGoogleSheetDocument } from './isGoogleSheetDocument';\nimport { isPowerPointDesktopDocument } from './isPowerPointDesktopDocument';\nimport { isWordDesktopDocument } from './isWordDesktopDocument';\nimport { shouldConvertToSingleImage } from './shouldConvertToSingleImage';\nimport type { BeforePasteEvent, ClipboardData } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport type GetSourceInputParams = {\n    htmlAttributes: Record<string, string>;\n    fragment: DocumentFragment;\n    shouldConvertSingleImage: boolean;\n    clipboardData: ClipboardData;\n};\n\n/**\n * @internal\n * Represent the types of sources to handle in the Paste Plugin\n */\nexport type KnownPasteSourceType =\n    | 'wordDesktop'\n    | 'excelDesktop'\n    | 'excelOnline'\n    | 'powerPointDesktop'\n    | 'googleSheets'\n    | 'wacComponents'\n    | 'default'\n    | 'singleImage';\n\n/**\n * @internal\n */\nexport type GetSourceFunction = (props: GetSourceInputParams) => boolean;\n\nconst getSourceFunctions = new Map<KnownPasteSourceType, GetSourceFunction>([\n    ['wordDesktop', isWordDesktopDocument],\n    ['excelDesktop', isExcelDesktopDocument],\n    ['excelOnline', isExcelOnlineDocument],\n    ['powerPointDesktop', isPowerPointDesktopDocument],\n    ['wacComponents', documentContainWacElements],\n    ['googleSheets', isGoogleSheetDocument],\n    ['singleImage', shouldConvertToSingleImage],\n]);\n\n/**\n * @internal\n * This function tries to get the source of the Pasted content\n * @param event the before paste event\n * @param shouldConvertSingleImage Whether convert single image is enabled.\n * @returns The Type of pasted content, if no type found will return {KnownSourceType.Default}\n */\nexport function getPasteSource(\n    event: BeforePasteEvent,\n    shouldConvertSingleImage: boolean\n): KnownPasteSourceType {\n    const { htmlAttributes, clipboardData, fragment } = event;\n\n    let result: KnownPasteSourceType | null = null;\n    const param: GetSourceInputParams = {\n        htmlAttributes,\n        fragment,\n        shouldConvertSingleImage,\n        clipboardData,\n    };\n\n    getSourceFunctions.forEach((func, key) => {\n        if (!result && func(param)) {\n            result = key;\n        }\n    });\n\n    return result ?? 'default';\n}\n","import { PastePropertyNames } from './constants';\nimport type { GetSourceFunction } from './getPasteSource';\n\nconst EXCEL_ATTRIBUTE_VALUE = 'urn:schemas-microsoft-com:office:excel';\n\n/**\n * @internal\n * Checks whether the Array provided contains strings that identify Excel Desktop documents\n * @param props Properties related to the PasteEvent\n * @returns\n */\nexport const isExcelDesktopDocument: GetSourceFunction = props => {\n    const { htmlAttributes } = props;\n    // The presence of this attribute confirms its origin from Excel Desktop\n    return htmlAttributes[PastePropertyNames.EXCEL_DESKTOP_ATTRIBUTE_NAME] == EXCEL_ATTRIBUTE_VALUE;\n};\n","import { PastePropertyNames } from './constants';\nimport type { GetSourceFunction } from './getPasteSource';\n\n// Excel Desktop also has this attribute\nconst EXCEL_ONLINE_ATTRIBUTE_VALUE = 'Excel.Sheet';\n\n/**\n * @internal\n * Checks whether the Array provided contains strings that identify Excel Online documents\n * @param props Properties related to the PasteEvent\n * @returns\n */\nexport const isExcelOnlineDocument: GetSourceFunction = props => {\n    const { htmlAttributes } = props;\n    // The presence of Excel.Sheet confirms its origin from Excel, the absence of EXCEL_DESKTOP_ATTRIBUTE_NAME confirms it is from the Online version\n    return (\n        htmlAttributes[PastePropertyNames.PROG_ID_NAME] == EXCEL_ONLINE_ATTRIBUTE_VALUE &&\n        htmlAttributes[PastePropertyNames.EXCEL_DESKTOP_ATTRIBUTE_NAME] == undefined\n    );\n};\n","import { PastePropertyNames } from './constants';\nimport type { GetSourceFunction } from './getPasteSource';\n\n/**\n * @internal\n * Checks whether the fragment provided contain elements from Google sheets\n * @param props Properties related to the PasteEvent\n * @returns\n */\nexport const isGoogleSheetDocument: GetSourceFunction = props => {\n    const { fragment } = props;\n    return !!fragment.querySelector(PastePropertyNames.GOOGLE_SHEET_NODE_NAME);\n};\n","import { PastePropertyNames } from './constants';\nimport type { GetSourceFunction } from './getPasteSource';\n\nconst POWERPOINT_ATTRIBUTE_VALUE = 'PowerPoint.Slide';\n\n/**\n * @internal\n * Checks whether the Array provided contains strings that identify Power Point Desktop documents\n * @param props Properties related to the PasteEvent\n * @returns\n */\nexport const isPowerPointDesktopDocument: GetSourceFunction = props => {\n    return props.htmlAttributes[PastePropertyNames.PROG_ID_NAME] == POWERPOINT_ATTRIBUTE_VALUE;\n};\n","import { PastePropertyNames } from './constants';\nimport type { GetSourceFunction } from './getPasteSource';\n\nconst WORD_ATTRIBUTE_NAME = 'xmlns:w';\nconst WORD_ATTRIBUTE_VALUE = 'urn:schemas-microsoft-com:office:word';\nconst WORD_PROG_ID = 'Word.Document';\n\n/**\n * @internal\n * Checks whether the Array provided contains strings that identify Word Desktop documents\n * @param props Properties related to the PasteEvent\n * @returns\n */\nexport const isWordDesktopDocument: GetSourceFunction = props => {\n    const { htmlAttributes } = props;\n    return (\n        htmlAttributes[WORD_ATTRIBUTE_NAME] == WORD_ATTRIBUTE_VALUE ||\n        htmlAttributes[PastePropertyNames.PROG_ID_NAME] == WORD_PROG_ID\n    );\n};\n","import type { GetSourceFunction } from './getPasteSource';\n\n/**\n * @internal\n * Checks whether the fragment only contains a single image to paste\n * and the editor have the ConvertSingleImageBody Experimental feature\n * @param props Properties related to the PasteEvent\n * @returns\n */\nexport const shouldConvertToSingleImage: GetSourceFunction = props => {\n    const { shouldConvertSingleImage, clipboardData } = props;\n    return (\n        shouldConvertSingleImage &&\n        clipboardData.htmlFirstLevelChildTags?.length == 1 &&\n        clipboardData.htmlFirstLevelChildTags[0] == 'IMG'\n    );\n};\n","import type {\n    ContentModelFormatMap,\n    DomToModelOption,\n    FormatParser,\n    ElementFormatParserPerCategory,\n} from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport default function addParser<TKey extends keyof ElementFormatParserPerCategory>(\n    domToModelOption: DomToModelOption,\n    entry: TKey,\n    additionalFormatParsers: FormatParser<ContentModelFormatMap[TKey]>\n) {\n    if (!domToModelOption.additionalFormatParsers) {\n        domToModelOption.additionalFormatParsers = {};\n    }\n    if (!domToModelOption.additionalFormatParsers[entry]) {\n        domToModelOption.additionalFormatParsers[entry] = [];\n    }\n\n    domToModelOption.additionalFormatParsers[entry]?.push(additionalFormatParsers);\n}\n","import { BorderKeys, DeprecatedColors } from 'roosterjs-content-model-dom';\nimport type { BorderFormat, FormatParser } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport const deprecatedBorderColorParser: FormatParser<BorderFormat> = (\n    format: BorderFormat\n): void => {\n    BorderKeys.forEach(key => {\n        const value = format[key];\n        let color: string = '';\n        if (\n            value &&\n            DeprecatedColors.some(dColor => value.indexOf(dColor) > -1 && (color = dColor))\n        ) {\n            const newValue = value.replace(color, '').trimRight();\n            format[key] = newValue;\n        }\n    });\n};\n","/**\n * @internal\n * Get CSS styles of a given element in name-value pair format\n * @param element The element to get styles from\n */\nexport function getStyles(element: HTMLElement): Record<string, string> {\n    const result: Record<string, string> = {};\n    const style = element?.getAttribute('style') || '';\n    style.split(';').forEach(pair => {\n        const valueIndex = pair.indexOf(':');\n        const name = pair.slice(0, valueIndex);\n        const value = pair.slice(valueIndex + 1);\n        if (name && value) {\n            result[name.trim()] = value.trim();\n        }\n    });\n    return result;\n}\n","import { isElementOfType } from 'roosterjs-content-model-dom';\nimport type { ContentModelHyperLinkFormat, FormatParser } from 'roosterjs-content-model-types';\n\nconst SUPPORTED_PROTOCOLS = ['http:', 'https:', 'notes:', 'mailto:', 'onenote:'];\nconst INVALID_LINKS_REGEX = /^file:\\/\\/\\/[a-zA-Z\\/]/i;\n\n/**\n * @internal\n */\nexport const parseLink: FormatParser<ContentModelHyperLinkFormat> = (format, element) => {\n    if (!isElementOfType(element, 'a')) {\n        return;\n    }\n\n    let url: URL | undefined;\n    try {\n        url = new URL(element.href);\n    } catch {\n        url = undefined;\n    }\n\n    if (\n        (url && SUPPORTED_PROTOCOLS.indexOf(url.protocol) === -1) ||\n        INVALID_LINKS_REGEX.test(element.href)\n    ) {\n        element.removeAttribute('href');\n        format.href = '';\n    }\n};\n","import type { DomToModelOption, ElementProcessorMap } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n */\nexport function setProcessor<TKey extends keyof ElementProcessorMap>(\n    domToModelOption: DomToModelOption,\n    entry: TKey,\n    processorOverride: Partial<ElementProcessorMap>[TKey]\n) {\n    if (!domToModelOption.processorOverride) {\n        domToModelOption.processorOverride = {};\n    }\n\n    domToModelOption.processorOverride[entry] = processorOverride;\n}\n","import { getObjectKeys, isNodeOfType } from 'roosterjs-content-model-dom';\nimport type CreateElementData from './CreateElementData';\n\n/**\n * @internal\n * Create DOM element from the given CreateElementData\n * @param elementData The CreateElementData or an index of a known CreateElementData used for creating this element\n * @param document The document to create the element from\n * @returns The root DOM element just created\n */\nexport default function createElement(\n    elementData: CreateElementData,\n    document: Document\n): Element | null {\n    if (!elementData || !elementData.tag) {\n        return null;\n    }\n\n    const { tag, namespace, className, style, dataset, attributes, children } = elementData;\n    const result = namespace\n        ? document.createElementNS(namespace, tag)\n        : document.createElement(tag);\n\n    if (style) {\n        result.setAttribute('style', style);\n    }\n\n    if (className) {\n        result.className = className;\n    }\n\n    if (dataset && isNodeOfType(result, 'ELEMENT_NODE')) {\n        getObjectKeys(dataset).forEach(datasetName => {\n            result.dataset[datasetName] = dataset[datasetName];\n        });\n    }\n\n    if (attributes) {\n        getObjectKeys(attributes).forEach(attrName => {\n            result.setAttribute(attrName, attributes[attrName]);\n        });\n    }\n\n    if (children) {\n        children.forEach(child => {\n            if (typeof child === 'string') {\n                result.appendChild(document.createTextNode(child));\n            } else if (child) {\n                const childElement = createElement(child, document);\n                if (childElement) {\n                    result.appendChild(childElement);\n                }\n            }\n        });\n    }\n\n    return result;\n}\n","import type Disposable from '../Disposable';\nimport type DragAndDropHandler from './DragAndDropHandler';\n\n/**\n * @internal\n */\ninterface MouseEventMoves {\n    MOUSEDOWN: string;\n    MOUSEMOVE: string;\n    MOUSEUP: string;\n}\n\n/**\n * @internal\n */\ninterface MouseEventInfo extends MouseEventMoves {\n    getPageXY: (e: MouseEvent) => number[];\n}\n\n/**\n * @internal\n * Compatible mouse event names for different platform\n */\ninterface TouchEventInfo extends MouseEventMoves {\n    getPageXY: (e: TouchEvent) => number[];\n}\n\n/**\n * Generate event names and getXY function based on different platforms to be compatible with desktop and mobile browsers\n */\nconst MOUSE_EVENT_INFO_DESKTOP: MouseEventInfo = (() => {\n    return {\n        MOUSEDOWN: 'mousedown',\n        MOUSEMOVE: 'mousemove',\n        MOUSEUP: 'mouseup',\n        getPageXY: getMouseEventPageXY,\n    };\n})();\n\nconst MOUSE_EVENT_INFO_MOBILE: TouchEventInfo = (() => {\n    return {\n        MOUSEDOWN: 'touchstart',\n        MOUSEMOVE: 'touchmove',\n        MOUSEUP: 'touchend',\n        getPageXY: getTouchEventPageXY,\n    };\n})();\n\nfunction getMouseEventPageXY(e: MouseEvent): [number, number] {\n    return [e.pageX, e.pageY];\n}\n\nfunction getTouchEventPageXY(e: TouchEvent): [number, number] {\n    let pageX = 0;\n    let pageY = 0;\n    if (e.targetTouches && e.targetTouches.length > 0) {\n        const touch = e.targetTouches[0];\n        pageX = touch.pageX;\n        pageY = touch.pageY;\n    }\n    return [pageX, pageY];\n}\n\n/**\n * @internal\n * A helper class to help manage drag and drop to an HTML element\n */\nexport default class DragAndDropHelper<TContext, TInitValue> implements Disposable {\n    private initX: number = 0;\n    private initY: number = 0;\n    private initValue: TInitValue | undefined = undefined;\n    private dndMouse: MouseEventInfo | TouchEventInfo;\n\n    /**\n     * Create a new instance of DragAndDropHelper class\n     * @param trigger The trigger element. When user start drag on this element,\n     * events will be fired to the handler object\n     * @param context Context object that will be passed to handler function when event is fired,\n     * so that the handler object knows which element it is triggered from.\n     * @param onSubmit A callback that will be invoked when event handler in handler object returns true\n     * @param handler The event handler object, see DragAndDropHandler interface for more information\n     * @param zoomScale The zoom scale of the editor\n     * @param forceMobile A boolean to force the use of touch controls for the helper\n     */\n    constructor(\n        private trigger: HTMLElement,\n        private context: TContext,\n        private onSubmit: (context: TContext, trigger: HTMLElement) => void,\n        private handler: DragAndDropHandler<TContext, TInitValue>,\n        private zoomScale: number,\n        forceMobile?: boolean\n    ) {\n        this.dndMouse = forceMobile ? MOUSE_EVENT_INFO_MOBILE : MOUSE_EVENT_INFO_DESKTOP;\n        trigger.addEventListener(this.dndMouse.MOUSEDOWN, this.onMouseDown);\n    }\n\n    /**\n     * Dispose this object, remove all event listeners that has been attached\n     */\n    dispose() {\n        this.trigger.removeEventListener(this.dndMouse.MOUSEDOWN, this.onMouseDown);\n        this.removeDocumentEvents();\n    }\n\n    public get mouseType(): string {\n        return this.dndMouse == MOUSE_EVENT_INFO_MOBILE ? 'touch' : 'mouse';\n    }\n\n    private addDocumentEvents() {\n        const doc = this.trigger.ownerDocument;\n        doc.addEventListener(this.dndMouse.MOUSEMOVE, this.onMouseMove, true /*useCapture*/);\n        doc.addEventListener(this.dndMouse.MOUSEUP, this.onMouseUp, true /*useCapture*/);\n    }\n\n    private removeDocumentEvents() {\n        const doc = this.trigger.ownerDocument;\n        doc.removeEventListener(this.dndMouse.MOUSEMOVE, this.onMouseMove, true /*useCapture*/);\n        doc.removeEventListener(this.dndMouse.MOUSEUP, this.onMouseUp, true /*useCapture*/);\n    }\n\n    private onMouseDown = (e: Event) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.addDocumentEvents();\n        [this.initX, this.initY] = this.dndMouse.getPageXY(e as MouseEvent & TouchEvent);\n        this.initValue = this.handler.onDragStart?.(this.context, e as MouseEvent);\n    };\n\n    private onMouseMove = (e: Event) => {\n        e.preventDefault();\n        const [pageX, pageY] = this.dndMouse.getPageXY(e as MouseEvent & TouchEvent);\n        const deltaX = (pageX - this.initX) / this.zoomScale;\n        const deltaY = (pageY - this.initY) / this.zoomScale;\n        if (\n            this.initValue &&\n            this.handler.onDragging?.(this.context, e as MouseEvent, this.initValue, deltaX, deltaY)\n        ) {\n            this.onSubmit?.(this.context, this.trigger);\n        }\n    };\n\n    private onMouseUp = (e: Event) => {\n        e.preventDefault();\n        this.removeDocumentEvents();\n        if (this.handler.onDragEnd?.(this.context, e as MouseEvent, this.initValue)) {\n            this.onSubmit?.(this.context, this.trigger);\n        }\n    };\n}\n","import normalizeRect from './normalizeRect';\nimport type { Rect } from 'roosterjs-content-model-types';\n\n/**\n * Get the intersected Rect of elements provided\n *\n * @example\n * The result of the following Elements Rects would be:\n    {\n        top: Element2.top,\n        bottom: Element1.bottom,\n        left: Element2.left,\n        right: Element2.right\n    }\n    +-------------------------+\n    | Element 1               |\n    |   +-----------------+   |\n    |   | Element2        |   |\n    |   |                 |   |\n    |   |                 |   |\n    +-------------------------+\n        |                 |\n        +-----------------+\n * @internal\n * @param elements Elements to use.\n * @param additionalRects additional rects to use\n * @returns If the Rect is valid return the rect, if not, return null.\n */\nexport default function getIntersectedRect(\n    elements: HTMLElement[],\n    additionalRects: Rect[] = []\n): Rect | null {\n    const rects = elements\n        .map(element => normalizeRect(element.getBoundingClientRect()))\n        .concat(additionalRects)\n        .filter(element => !!element) as Rect[];\n\n    const result: Rect = {\n        top: Math.max(...rects.map(r => r.top)),\n        bottom: Math.min(...rects.map(r => r.bottom)),\n        left: Math.max(...rects.map(r => r.left)),\n        right: Math.min(...rects.map(r => r.right)),\n    };\n\n    return result.top < result.bottom && result.left < result.right ? result : null;\n}\n","import type { Rect } from 'roosterjs-content-model-types';\n\n/**\n * @internal\n * A ClientRect of all 0 is possible. i.e. chrome returns a ClientRect of 0 when the cursor is on an empty p\n * We validate that and only return a rect when the passed in ClientRect is valid\n */\nexport default function normalizeRect(clientRect: DOMRect): Rect | null {\n    const { left, right, top, bottom } =\n        clientRect || <DOMRect>{ left: 0, right: 0, top: 0, bottom: 0 };\n    return left === 0 && right === 0 && top === 0 && bottom === 0\n        ? null\n        : {\n              left: Math.round(left),\n              right: Math.round(right),\n              top: Math.round(top),\n              bottom: Math.round(bottom),\n          };\n}\n","import { cacheGetEventData } from 'roosterjs-content-model-core';\nimport type { ShortcutCommand, ShortcutKeyDefinition } from './ShortcutCommand';\nimport {\n    ShortcutBold,\n    ShortcutBullet,\n    ShortcutClearFormat,\n    ShortcutDecreaseFont,\n    ShortcutIncreaseFont,\n    ShortcutItalic,\n    ShortcutNumbering,\n    ShortcutRedo,\n    ShortcutRedoMacOS,\n    ShortcutUnderline,\n    ShortcutUndo,\n    ShortcutUndo2,\n} from './shortcuts';\nimport type {\n    EditorPlugin,\n    IEditor,\n    KeyDownEvent,\n    PluginEvent,\n} from 'roosterjs-content-model-types';\n\nconst defaultShortcuts: ShortcutCommand[] = [\n    ShortcutBold,\n    ShortcutItalic,\n    ShortcutUnderline,\n    ShortcutClearFormat,\n    ShortcutUndo,\n    ShortcutUndo2,\n    ShortcutRedo,\n    ShortcutRedoMacOS,\n    ShortcutBullet,\n    ShortcutNumbering,\n    ShortcutIncreaseFont,\n    ShortcutDecreaseFont,\n];\nconst CommandCacheKey = '__ShortcutCommandCache';\n\n/**\n * Shortcut plugin hook on the specified shortcut keys and trigger related format API\n */\nexport class ShortcutPlugin implements EditorPlugin {\n    private editor: IEditor | null = null;\n    private isMac = false;\n\n    /**\n     * Create a new instance of ShortcutPlugin\n     * @param [shortcuts=defaultShortcuts] Allowed commands\n     */\n    constructor(private shortcuts: ShortcutCommand[] = defaultShortcuts) {}\n\n    /**\n     * Get name of this plugin\n     */\n    getName() {\n        return 'Shortcut';\n    }\n\n    /**\n     * The first method that editor will call to a plugin when editor is initializing.\n     * It will pass in the editor instance, plugin should take this chance to save the\n     * editor reference so that it can call to any editor method or format API later.\n     * @param editor The editor object\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n        this.isMac = !!this.editor.getEnvironment().isMac;\n    }\n\n    /**\n     * The last method that editor will call to a plugin before it is disposed.\n     * Plugin can take this chance to clear the reference to editor. After this method is\n     * called, plugin should not call to any editor method since it will result in error.\n     */\n    dispose() {\n        this.editor = null;\n    }\n\n    /**\n     * Check if the plugin should handle the given event exclusively.\n     * Handle an event exclusively means other plugin will not receive this event in\n     * onPluginEvent method.\n     * If two plugins will return true in willHandleEventExclusively() for the same event,\n     * the final result depends on the order of the plugins are added into editor\n     * @param event The event to check:\n     */\n    willHandleEventExclusively(event: PluginEvent) {\n        return (\n            event.eventType == 'keyDown' &&\n            (event.rawEvent.ctrlKey || event.rawEvent.altKey || event.rawEvent.metaKey) &&\n            !!this.cacheGetCommand(event)\n        );\n    }\n\n    /**\n     * Core method for a plugin. Once an event happens in editor, editor will call this\n     * method of each plugin to handle the event as long as the event is not handled\n     * exclusively by another plugin.\n     * @param event The event to handle:\n     */\n    onPluginEvent(event: PluginEvent) {\n        if (this.editor && event.eventType == 'keyDown') {\n            const command = this.cacheGetCommand(event);\n\n            if (command) {\n                command.onClick(this.editor);\n                event.rawEvent.preventDefault();\n            }\n        }\n    }\n\n    private cacheGetCommand(event: KeyDownEvent) {\n        return cacheGetEventData(event, CommandCacheKey, event => {\n            const editor = this.editor;\n\n            return (\n                editor &&\n                this.shortcuts.filter(\n                    command =>\n                        this.matchOS(command.environment) &&\n                        this.matchShortcut(command.shortcutKey, event.rawEvent)\n                )[0]\n            );\n        });\n    }\n\n    private matchOS(environment?: 'all' | 'mac' | 'nonMac') {\n        switch (environment) {\n            case 'mac':\n                return this.isMac;\n\n            case 'nonMac':\n                return !this.isMac;\n\n            default:\n                return true;\n        }\n    }\n\n    private matchShortcut(shortcutKey: ShortcutKeyDefinition, event: KeyboardEvent) {\n        const { ctrlKey, altKey, shiftKey, which, metaKey } = event;\n        const ctrlOrMeta = this.isMac ? metaKey : ctrlKey;\n        const matchModifier =\n            (shortcutKey.modifierKey == 'ctrl' && ctrlOrMeta && !altKey) ||\n            (shortcutKey.modifierKey == 'alt' && altKey && !ctrlOrMeta);\n\n        return matchModifier && shiftKey == shortcutKey.shiftKey && shortcutKey.which == which;\n    }\n}\n","import { redo, undo } from 'roosterjs-content-model-core';\nimport {\n    changeFontSize,\n    clearFormat,\n    toggleBold,\n    toggleBullet,\n    toggleItalic,\n    toggleNumbering,\n    toggleUnderline,\n} from 'roosterjs-content-model-api';\nimport type { ShortcutCommand } from './ShortcutCommand';\n\nconst enum Keys {\n    BACKSPACE = 8,\n    SPACE = 32,\n    B = 66,\n    I = 73,\n    U = 85,\n    Y = 89,\n    Z = 90,\n    COMMA = 188,\n    PERIOD = 190,\n    FORWARD_SLASH = 191,\n}\n\n/**\n * Shortcut command for Bold\n * Windows: Ctrl + B\n * MacOS: Meta + B\n */\nexport const ShortcutBold: ShortcutCommand = {\n    shortcutKey: {\n        modifierKey: 'ctrl',\n        shiftKey: false,\n        which: Keys.B,\n    },\n    onClick: editor => toggleBold(editor),\n};\n\n/**\n * Shortcut command for Italic\n * Windows: Ctrl + I\n * MacOS: Meta + I\n */\nexport const ShortcutItalic: ShortcutCommand = {\n    shortcutKey: {\n        modifierKey: 'ctrl',\n        shiftKey: false,\n        which: Keys.I,\n    },\n    onClick: editor => toggleItalic(editor),\n};\n\n/**\n * Shortcut command for Underline\n * Windows: Ctrl + U\n * MacOS: Meta + U\n */\nexport const ShortcutUnderline: ShortcutCommand = {\n    shortcutKey: {\n        modifierKey: 'ctrl',\n        shiftKey: false,\n        which: Keys.U,\n    },\n    onClick: editor => toggleUnderline(editor),\n};\n\n/**\n * Shortcut command for Clear Format\n * Windows: Ctrl + Space\n * MacOS: Meta + Space\n */\nexport const ShortcutClearFormat: ShortcutCommand = {\n    shortcutKey: {\n        modifierKey: 'ctrl',\n        shiftKey: false,\n        which: Keys.SPACE,\n    },\n    onClick: editor => clearFormat(editor),\n};\n\n/**\n * Shortcut command for Undo 1\n * Windows: Ctrl + Z\n * MacOS: Meta + Z\n */\nexport const ShortcutUndo: ShortcutCommand = {\n    shortcutKey: {\n        modifierKey: 'ctrl',\n        shiftKey: false,\n        which: Keys.Z,\n    },\n    onClick: editor => undo(editor),\n};\n\n/**\n * Shortcut command for Undo 2\n * Windows: Alt + Backspace\n * MacOS: N/A\n */\nexport const ShortcutUndo2: ShortcutCommand = {\n    shortcutKey: {\n        modifierKey: 'alt',\n        shiftKey: false,\n        which: Keys.BACKSPACE,\n    },\n    onClick: editor => undo(editor),\n    environment: 'nonMac',\n};\n\n/**\n * Shortcut command for Redo 1\n * Windows: Ctrl + Y\n * MacOS: N/A\n */\nexport const ShortcutRedo: ShortcutCommand = {\n    shortcutKey: {\n        modifierKey: 'ctrl',\n        shiftKey: false,\n        which: Keys.Y,\n    },\n    onClick: editor => redo(editor),\n    environment: 'nonMac',\n};\n\n/**\n * Shortcut command for Redo 2\n * Windows: N/A\n * MacOS: Meta + Shift + Z\n */\nexport const ShortcutRedoMacOS: ShortcutCommand = {\n    shortcutKey: {\n        modifierKey: 'ctrl',\n        shiftKey: true,\n        which: Keys.Z,\n    },\n    onClick: editor => redo(editor),\n    environment: 'mac',\n};\n\n/**\n * Shortcut command for Bullet List\n * Windows: Ctrl + . (Period)\n * MacOS: Meta + . (Period)\n */\nexport const ShortcutBullet: ShortcutCommand = {\n    shortcutKey: {\n        modifierKey: 'ctrl',\n        shiftKey: false,\n        which: Keys.PERIOD,\n    },\n    onClick: editor => toggleBullet(editor),\n};\n\n/**\n * Shortcut command for Numbering List\n * Windows: Ctrl + / (Forward slash)\n * MacOS: Meta + / (Forward slash)\n */\nexport const ShortcutNumbering: ShortcutCommand = {\n    shortcutKey: {\n        modifierKey: 'ctrl',\n        shiftKey: false,\n        which: Keys.FORWARD_SLASH,\n    },\n    onClick: editor => toggleNumbering(editor),\n};\n\n/**\n * Shortcut command for Increase Font\n * Windows: Ctrl + Shift + . (Period)\n * MacOS: Meta + Shift + . (Period)\n */\nexport const ShortcutIncreaseFont: ShortcutCommand = {\n    shortcutKey: {\n        modifierKey: 'ctrl',\n        shiftKey: true,\n        which: Keys.PERIOD,\n    },\n    onClick: editor => changeFontSize(editor, 'increase'),\n};\n\n/**\n * Shortcut command for Decrease Font\n * Windows: Ctrl + Shift + , (Comma)\n * MacOS: Meta + Shift + , (Comma)\n */\nexport const ShortcutDecreaseFont: ShortcutCommand = {\n    shortcutKey: {\n        modifierKey: 'ctrl',\n        shiftKey: true,\n        which: Keys.COMMA,\n    },\n    onClick: editor => changeFontSize(editor, 'decrease'),\n};\n","import normalizeRect from '../pluginUtils/Rect/normalizeRect';\nimport TableEditor from './editors/TableEditor';\nimport { isNodeOfType } from 'roosterjs-content-model-dom';\nimport type { EditorPlugin, IEditor, PluginEvent, Rect } from 'roosterjs-content-model-types';\n\nconst TABLE_RESIZER_LENGTH = 12;\n\n/**\n * TableEdit plugin, provides the ability to resize a table by drag-and-drop\n */\nexport class TableEditPlugin implements EditorPlugin {\n    private editor: IEditor | null = null;\n    private onMouseMoveDisposer: (() => void) | null = null;\n    private tableRectMap: { table: HTMLTableElement; rect: Rect }[] | null = null;\n    private tableEditor: TableEditor | null = null;\n\n    /**\n     * Construct a new instance of TableResize plugin\n     * @param anchorContainerSelector An optional selector string to specify the container to host the plugin.\n     * The container must not be affected by transform: scale(), otherwise the position calculation will be wrong.\n     * If not specified, the plugin will be inserted in document.body\n     */\n    constructor(private anchorContainerSelector?: string) {}\n\n    /**\n     * Get a friendly name of this plugin\n     */\n    getName() {\n        return 'TableEdit';\n    }\n\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n        this.onMouseMoveDisposer = this.editor.attachDomEvent({\n            mousemove: { beforeDispatch: this.onMouseMove },\n        });\n        const scrollContainer = this.editor.getScrollContainer();\n        scrollContainer.addEventListener('mouseout', this.onMouseOut);\n    }\n\n    private onMouseOut = ({ relatedTarget, currentTarget }: MouseEvent) => {\n        const relatedTargetNode = relatedTarget as Node;\n        const currentTargetNode = currentTarget as Node;\n        if (\n            isNodeOfType(relatedTargetNode, 'ELEMENT_NODE') &&\n            isNodeOfType(currentTargetNode, 'ELEMENT_NODE') &&\n            this.tableEditor &&\n            !this.tableEditor.isOwnedElement(relatedTargetNode) &&\n            !currentTargetNode.contains(relatedTargetNode)\n        ) {\n            this.setTableEditor(null);\n        }\n    };\n\n    /**\n     * Dispose this plugin\n     */\n    dispose() {\n        const scrollContainer = this.editor?.getScrollContainer();\n        scrollContainer?.removeEventListener('mouseout', this.onMouseOut);\n        this.onMouseMoveDisposer?.();\n        this.invalidateTableRects();\n        this.disposeTableEditor();\n        this.editor = null;\n        this.onMouseMoveDisposer = null;\n    }\n\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    onPluginEvent(e: PluginEvent) {\n        switch (e.eventType) {\n            case 'input':\n            case 'contentChanged':\n            case 'scroll':\n            case 'zoomChanged':\n                this.setTableEditor(null);\n                this.invalidateTableRects();\n                break;\n        }\n    }\n\n    private onMouseMove = (event: Event) => {\n        const e = event as MouseEvent;\n\n        if (e.buttons > 0 || !this.editor) {\n            return;\n        }\n\n        this.ensureTableRects();\n\n        const editorWindow = this.editor.getDocument().defaultView || window;\n        const x = e.pageX - editorWindow.scrollX;\n        const y = e.pageY - editorWindow.scrollY;\n        let currentTable: HTMLTableElement | null = null;\n\n        //Find table in range of mouse\n        if (this.tableRectMap) {\n            for (let i = this.tableRectMap.length - 1; i >= 0; i--) {\n                const { table, rect } = this.tableRectMap[i];\n\n                if (\n                    x >= rect.left - TABLE_RESIZER_LENGTH &&\n                    x <= rect.right + TABLE_RESIZER_LENGTH &&\n                    y >= rect.top - TABLE_RESIZER_LENGTH &&\n                    y <= rect.bottom + TABLE_RESIZER_LENGTH\n                ) {\n                    currentTable = table;\n                    break;\n                }\n            }\n        }\n\n        this.setTableEditor(currentTable, e);\n        this.tableEditor?.onMouseMove(x, y);\n    };\n\n    /**\n     * @internal Public only for unit test\n     * @param table Table to use when setting the Editors\n     * @param event (Optional) Mouse event\n     */\n    public setTableEditor(table: HTMLTableElement | null, event?: MouseEvent) {\n        if (this.tableEditor && !this.tableEditor.isEditing() && table != this.tableEditor.table) {\n            this.disposeTableEditor();\n        }\n\n        if (!this.tableEditor && table && this.editor && table.rows.length > 0) {\n            const container = this.anchorContainerSelector\n                ? this.editor.getDOMHelper().queryElements(this.anchorContainerSelector)[0]\n                : undefined;\n\n            this.tableEditor = new TableEditor(\n                this.editor,\n                table,\n                this.invalidateTableRects,\n                isNodeOfType(container as Node, 'ELEMENT_NODE') ? container : undefined,\n                event?.currentTarget\n            );\n        }\n    }\n\n    private invalidateTableRects = () => {\n        this.tableRectMap = null;\n    };\n\n    private disposeTableEditor() {\n        this.tableEditor?.dispose();\n        this.tableEditor = null;\n    }\n\n    private ensureTableRects() {\n        if (!this.tableRectMap && this.editor) {\n            this.tableRectMap = [];\n\n            const tables = this.editor.getDOMHelper().queryElements('table');\n            tables.forEach(table => {\n                if (table.isContentEditable) {\n                    const rect = normalizeRect(table.getBoundingClientRect());\n                    if (rect && this.tableRectMap) {\n                        this.tableRectMap.push({\n                            table,\n                            rect,\n                        });\n                    }\n                }\n            });\n        }\n    }\n}\n","import createCellResizer from './features/CellResizer';\nimport createTableInserter from './features/TableInserter';\nimport createTableMover from './features/TableMover';\nimport createTableResizer from './features/TableResizer';\nimport normalizeRect from '../../pluginUtils/Rect/normalizeRect';\nimport { disposeTableEditFeature } from './features/TableEditorFeature';\nimport { isNodeOfType } from 'roosterjs-content-model-dom';\nimport type TableEditFeature from './features/TableEditorFeature';\nimport type { IEditor, TableSelection } from 'roosterjs-content-model-types';\n\nconst INSERTER_HOVER_OFFSET = 6;\nconst enum TOP_OR_SIDE {\n    top = 0,\n    side = 1,\n}\n/**\n * @internal\n *\n * A table has 6 hot areas to be resized/edited (take LTR example):\n *\n *   [6]  [                ]\n *       +[      1         ]+--------------------+\n *       |[                ]|                    |\n *      [ ]               [ ]                    |\n *      [ ]               [ ]                    |\n *      [2]               [3]                    |\n *      [ ]               [ ]                    |\n *      [ ][       4       ]|                    |\n *       +------------------+--------------------+\n *       |                  |                    |\n *       |                  |                    |\n *       |                  |                    |\n *       +------------------+--------------------+\n *                                                [5]\n *\n * 1 - Hover area to show insert column button\n * 2 - Hover area to show insert row button\n * 3 - Hover area to show vertical resizing bar\n * 4 - Hover area to show horizontal resizing bar\n * 5 - Hover area to show whole table resize handle\n * 6 - Hover area to show whole table mover handle\n *\n * When set a different current table or change current TD, we need to update these areas\n */\nexport default class TableEditor {\n    // 1, 2 - Insert a column or a row\n    private horizontalInserter: TableEditFeature | null = null;\n    private verticalInserter: TableEditFeature | null = null;\n\n    // 3, 4 - Resize a column or a row from a cell\n    private horizontalResizer: TableEditFeature | null = null;\n    private verticalResizer: TableEditFeature | null = null;\n\n    // 5 - Resize whole table\n    private tableResizer: TableEditFeature | null = null;\n\n    // 6 - Move as well as select whole table\n    private tableMover: TableEditFeature | null = null;\n\n    private isRTL: boolean;\n    private range: Range | null = null;\n    private isCurrentlyEditing: boolean;\n\n    constructor(\n        private editor: IEditor,\n        public readonly table: HTMLTableElement,\n        private onChanged: () => void,\n        private anchorContainer?: HTMLElement,\n        private contentDiv?: EventTarget | null\n    ) {\n        this.isRTL = editor.getDocument().defaultView?.getComputedStyle(table).direction == 'rtl';\n        this.setEditorFeatures();\n        this.isCurrentlyEditing = false;\n    }\n\n    dispose() {\n        this.disposeTableResizer();\n        this.disposeCellResizers();\n        this.disposeTableInserter();\n        this.disposeTableMover();\n    }\n\n    isEditing(): boolean {\n        return this.isCurrentlyEditing;\n    }\n\n    isOwnedElement(node: Node) {\n        return [\n            this.tableResizer,\n            this.tableMover,\n            this.horizontalInserter,\n            this.verticalInserter,\n            this.horizontalResizer,\n            this.verticalResizer,\n        ]\n            .filter(feature => !!feature?.div)\n            .some(feature => feature?.div == node);\n    }\n\n    onMouseMove(x: number, y: number) {\n        // Get whole table rect\n        const tableRect = normalizeRect(this.table.getBoundingClientRect());\n\n        //console.log('>>>tableRect', tableRect);\n        if (!tableRect) {\n            return;\n        }\n\n        // Determine if cursor is on top or side\n        const topOrSide =\n            y <= tableRect.top + INSERTER_HOVER_OFFSET\n                ? TOP_OR_SIDE.top\n                : this.isRTL\n                ? x >= tableRect.right - INSERTER_HOVER_OFFSET\n                    ? TOP_OR_SIDE.side\n                    : undefined\n                : x <= tableRect.left + INSERTER_HOVER_OFFSET\n                ? TOP_OR_SIDE.side\n                : undefined;\n        const topOrSideBinary = topOrSide ? 1 : 0;\n\n        // i is row index, j is column index\n        for (let i = 0; i < this.table.rows.length; i++) {\n            const tr = this.table.rows[i];\n            let j = 0;\n            for (; j < tr.cells.length; j++) {\n                const td = tr.cells[j];\n                const tdRect = normalizeRect(td.getBoundingClientRect());\n\n                if (!tdRect || !tableRect) {\n                    continue;\n                }\n\n                // Determine the cell the cursor is in range of\n                // Offset is only used for first row and column\n                const lessThanBottom = y <= tdRect.bottom;\n                const lessThanRight = this.isRTL\n                    ? x <= tdRect.right + INSERTER_HOVER_OFFSET * topOrSideBinary\n                    : x <= tdRect.right;\n                const moreThanLeft = this.isRTL\n                    ? x >= tdRect.left\n                    : x >= tdRect.left - INSERTER_HOVER_OFFSET * topOrSideBinary;\n\n                if (lessThanBottom && lessThanRight && moreThanLeft) {\n                    if (i === 0 && topOrSide == TOP_OR_SIDE.top) {\n                        const center = (tdRect.left + tdRect.right) / 2;\n                        const isOnRightHalf = this.isRTL ? x < center : x > center;\n                        this.setInserterTd(\n                            isOnRightHalf ? td : tr.cells[j - 1],\n                            false /*isHorizontal*/\n                        );\n                    } else if (j === 0 && topOrSide == TOP_OR_SIDE.side) {\n                        const tdAbove = this.table.rows[i - 1]?.cells[0];\n                        const tdAboveRect = tdAbove\n                            ? normalizeRect(tdAbove.getBoundingClientRect())\n                            : null;\n\n                        const isTdNotAboveMerged = !tdAboveRect\n                            ? null\n                            : this.isRTL\n                            ? tdAboveRect.right === tdRect.right\n                            : tdAboveRect.left === tdRect.left;\n\n                        this.setInserterTd(\n                            y < (tdRect.top + tdRect.bottom) / 2 && isTdNotAboveMerged\n                                ? tdAbove\n                                : td,\n                            true /*isHorizontal*/\n                        );\n                    } else {\n                        this.setInserterTd(null);\n                    }\n\n                    this.setResizingTd(td);\n\n                    //Cell found\n                    break;\n                }\n            }\n\n            if (j < tr.cells.length) {\n                break;\n            }\n        }\n\n        // Create Mover and Resizer\n        this.setEditorFeatures();\n    }\n\n    private setEditorFeatures() {\n        if (!this.tableMover) {\n            this.tableMover = createTableMover(\n                this.table,\n                this.editor,\n                this.isRTL,\n                this.onSelect,\n                this.getOnMouseOut,\n                this.contentDiv,\n                this.anchorContainer\n            );\n        }\n\n        if (!this.tableResizer) {\n            this.tableResizer = createTableResizer(\n                this.table,\n                this.editor,\n                this.isRTL,\n                this.onStartTableResize,\n                this.onFinishEditing,\n                this.contentDiv,\n                this.anchorContainer\n            );\n        }\n    }\n\n    private setResizingTd(td: HTMLTableCellElement) {\n        if (this.horizontalResizer && this.horizontalResizer.node != td) {\n            this.disposeCellResizers();\n        }\n\n        if (!this.horizontalResizer && td) {\n            this.horizontalResizer = createCellResizer(\n                this.editor,\n                td,\n                this.table,\n                this.isRTL,\n                true /*isHorizontal*/,\n                this.onStartCellResize,\n                this.onFinishEditing,\n                this.anchorContainer\n            );\n            this.verticalResizer = createCellResizer(\n                this.editor,\n                td,\n                this.table,\n                this.isRTL,\n                false /*isHorizontal*/,\n                this.onStartCellResize,\n                this.onFinishEditing,\n                this.anchorContainer\n            );\n        }\n    }\n\n    /**\n     * create or remove TableInserter\n     * @param td td to attach to, set this to null to remove inserters (both horizontal and vertical)\n     */\n    private setInserterTd(td: HTMLTableCellElement | null, isHorizontal?: boolean) {\n        const inserter = isHorizontal ? this.horizontalInserter : this.verticalInserter;\n        if (td === null || (inserter && inserter.node != td)) {\n            this.disposeTableInserter();\n        }\n\n        if (!this.horizontalInserter && !this.verticalInserter && td) {\n            const newInserter = createTableInserter(\n                this.editor,\n                td,\n                this.table,\n                this.isRTL,\n                !!isHorizontal,\n                this.onInserted,\n                this.getOnMouseOut,\n                this.anchorContainer\n            );\n            if (isHorizontal) {\n                this.horizontalInserter = newInserter;\n            } else {\n                this.verticalInserter = newInserter;\n            }\n        }\n    }\n\n    private disposeTableResizer() {\n        if (this.tableResizer) {\n            disposeTableEditFeature(this.tableResizer);\n            this.tableResizer = null;\n        }\n    }\n\n    private disposeTableInserter() {\n        if (this.horizontalInserter) {\n            disposeTableEditFeature(this.horizontalInserter);\n            this.horizontalInserter = null;\n        }\n        if (this.verticalInserter) {\n            disposeTableEditFeature(this.verticalInserter);\n            this.verticalInserter = null;\n        }\n    }\n\n    private disposeCellResizers() {\n        if (this.horizontalResizer) {\n            disposeTableEditFeature(this.horizontalResizer);\n            this.horizontalResizer = null;\n        }\n        if (this.verticalResizer) {\n            disposeTableEditFeature(this.verticalResizer);\n            this.verticalResizer = null;\n        }\n    }\n\n    private disposeTableMover() {\n        if (this.tableMover) {\n            disposeTableEditFeature(this.tableMover);\n            this.tableMover = null;\n        }\n    }\n\n    private onFinishEditing = (): false => {\n        this.editor.focus();\n\n        if (this.range) {\n            this.editor.setDOMSelection({ type: 'range', range: this.range, isReverted: false });\n        }\n\n        this.editor.takeSnapshot(); // Pass in an empty callback to make sure ContentChangedEvent is triggered\n        this.onChanged();\n        this.isCurrentlyEditing = false;\n\n        return false;\n    };\n\n    private onStartTableResize = () => {\n        this.isCurrentlyEditing = true;\n        this.onStartResize();\n    };\n\n    private onStartCellResize = () => {\n        this.isCurrentlyEditing = true;\n        this.disposeTableResizer();\n        this.onStartResize();\n    };\n\n    private onStartResize() {\n        this.isCurrentlyEditing = true;\n        const range = this.editor.getDOMSelection();\n\n        if (range && range.type == 'range') {\n            this.range = range.range;\n        }\n\n        this.editor.takeSnapshot();\n    }\n\n    private onInserted = () => {\n        this.disposeTableResizer();\n        this.onFinishEditing();\n    };\n\n    /**\n     * Public only for testing purposes\n     * @param table the table to select\n     */\n    public onSelect = (table: HTMLTableElement) => {\n        this.editor.focus();\n\n        if (table) {\n            const selection: TableSelection = {\n                table: table,\n                firstRow: 0,\n                firstColumn: 0,\n                lastRow: table.rows.length - 1,\n                lastColumn: table.rows[table.rows.length - 1].cells.length - 1,\n                type: 'table',\n            };\n\n            this.editor.setDOMSelection(selection);\n        }\n    };\n\n    private getOnMouseOut = (feature: HTMLElement) => {\n        return (ev: MouseEvent) => {\n            if (\n                feature &&\n                ev.relatedTarget != feature &&\n                isNodeOfType(this.contentDiv as Node, 'ELEMENT_NODE') &&\n                isNodeOfType(ev.relatedTarget as Node, 'ELEMENT_NODE') &&\n                !(this.contentDiv == ev.relatedTarget)\n            ) {\n                this.dispose();\n            }\n        };\n    };\n}\n","import createElement from '../../../pluginUtils/CreateElement/createElement';\nimport DragAndDropHelper from '../../../pluginUtils/DragAndDrop/DragAndDropHelper';\nimport normalizeRect from '../../../pluginUtils/Rect/normalizeRect';\nimport { isElementOfType } from 'roosterjs-content-model-dom';\nimport {\n    getFirstSelectedTable,\n    MIN_ALLOWED_TABLE_CELL_WIDTH,\n    normalizeTable,\n} from 'roosterjs-content-model-core';\nimport type DragAndDropHandler from '../../../pluginUtils/DragAndDrop/DragAndDropHandler';\nimport type { ContentModelTable, IEditor } from 'roosterjs-content-model-types';\nimport type TableEditFeature from './TableEditorFeature';\n\nconst CELL_RESIZER_WIDTH = 4;\n\n/**\n * @internal\n */\nexport default function createCellResizer(\n    editor: IEditor,\n    td: HTMLTableCellElement,\n    table: HTMLTableElement,\n    isRTL: boolean,\n    isHorizontal: boolean,\n    onStart: () => void,\n    onEnd: () => false,\n    anchorContainer?: HTMLElement\n): TableEditFeature | null {\n    const document = td.ownerDocument;\n    const createElementData = {\n        tag: 'div',\n        style: `position: fixed; cursor: ${isHorizontal ? 'row' : 'col'}-resize; user-select: none`,\n    };\n    const zoomScale = editor.getDOMHelper().calculateZoomScale();\n\n    const div = createElement(createElementData, document) as HTMLDivElement;\n\n    (anchorContainer || document.body).appendChild(div);\n\n    const context: DragAndDropContext = { editor, td, table, isRTL, zoomScale, onStart };\n    const setPosition = isHorizontal ? setHorizontalPosition : setVerticalPosition;\n    setPosition(context, div);\n\n    const handler: DragAndDropHandler<DragAndDropContext, DragAndDropInitValue> = {\n        onDragStart,\n        // Horizontal modifies row height, vertical modifies column width\n        onDragging: isHorizontal ? onDraggingHorizontal : onDraggingVertical,\n        onDragEnd: onEnd,\n    };\n\n    const featureHandler = new DragAndDropHelper<DragAndDropContext, DragAndDropInitValue>(\n        div,\n        context,\n        setPosition,\n        handler,\n        zoomScale,\n        editor.getEnvironment().isMobileOrTablet\n    );\n\n    return { node: td, div, featureHandler };\n}\n\ninterface DragAndDropContext {\n    editor: IEditor;\n    td: HTMLTableCellElement;\n    table: HTMLTableElement;\n    isRTL: boolean;\n    zoomScale: number;\n    onStart: () => void;\n}\n\ninterface DragAndDropInitValue {\n    cmTable: ContentModelTable | undefined;\n    anchorColumn: number | undefined;\n    anchorRow: number | undefined;\n    anchorRowHeight: number;\n    allWidths: number[];\n}\n\nfunction onDragStart(context: DragAndDropContext, event: MouseEvent): DragAndDropInitValue {\n    const { td, onStart } = context;\n    const rect = normalizeRect(td.getBoundingClientRect());\n\n    // Get cell coordinates\n    const columnIndex = td.cellIndex;\n    const row =\n        td.parentElement && isElementOfType(td.parentElement, 'tr') ? td.parentElement : undefined;\n    const rowIndex = row?.rowIndex;\n\n    if (rowIndex == undefined) {\n        return {\n            cmTable: undefined,\n            anchorColumn: undefined,\n            anchorRow: undefined,\n            anchorRowHeight: -1,\n            allWidths: [],\n        }; // Just a fallback\n    }\n\n    const { editor, table } = context;\n\n    // Get current selection\n    const selection = editor.getDOMSelection();\n\n    // Select first cell of the table\n    editor.setDOMSelection({\n        type: 'table',\n        firstColumn: 0,\n        firstRow: 0,\n        lastColumn: 0,\n        lastRow: 0,\n        table: table,\n    });\n\n    // Get the table content model\n    const cmTable = getFirstSelectedTable(editor.getContentModelCopy('disconnected'))[0];\n\n    // Restore selection\n    editor.setDOMSelection(selection);\n\n    if (rect && cmTable) {\n        onStart();\n\n        return {\n            cmTable,\n            anchorColumn: columnIndex,\n            anchorRow: rowIndex,\n            anchorRowHeight: cmTable.rows[rowIndex].height,\n            allWidths: [...cmTable.widths],\n        };\n    } else {\n        return {\n            cmTable,\n            anchorColumn: undefined,\n            anchorRow: undefined,\n            anchorRowHeight: -1,\n            allWidths: [],\n        }; // Just a fallback\n    }\n}\n\nfunction onDraggingHorizontal(\n    context: DragAndDropContext,\n    event: MouseEvent,\n    initValue: DragAndDropInitValue,\n    deltaX: number,\n    deltaY: number\n) {\n    const { table } = context;\n    const { cmTable, anchorRow, anchorRowHeight } = initValue;\n\n    // Assign new widths and heights to the CM table\n    if (cmTable && anchorRow != undefined) {\n        // Modify the CM Table size\n        cmTable.rows[anchorRow].height = (anchorRowHeight ?? 0) + deltaY;\n\n        // Normalize the table\n        normalizeTable(cmTable);\n\n        // Writeback CM Table size changes to DOM Table\n        const tableRow = table.rows[anchorRow];\n        for (let col = 0; col < tableRow.cells.length; col++) {\n            const td = tableRow.cells[col];\n            td.style.height = cmTable.rows[anchorRow].height + 'px';\n        }\n\n        return true;\n    } else {\n        return false;\n    }\n}\n\nfunction onDraggingVertical(\n    context: DragAndDropContext,\n    event: MouseEvent,\n    initValue: DragAndDropInitValue,\n    deltaX: number\n) {\n    const { table, isRTL } = context;\n    const { cmTable, anchorColumn, allWidths } = initValue;\n\n    // Assign new widths and heights to the CM table\n    if (cmTable && anchorColumn != undefined) {\n        // Modify the CM Table size\n        const lastColumn = anchorColumn == cmTable.widths.length - 1;\n        const change = deltaX * (isRTL ? -1 : 1);\n        // This is the last column\n        if (lastColumn) {\n            // Only the last column changes\n            cmTable.widths[anchorColumn] = allWidths[anchorColumn] + change;\n        } else {\n            // Any other two columns\n            const anchorChange = allWidths[anchorColumn] + change;\n            const nextAnchorChange = allWidths[anchorColumn + 1] - change;\n            if (\n                anchorChange < MIN_ALLOWED_TABLE_CELL_WIDTH ||\n                nextAnchorChange < MIN_ALLOWED_TABLE_CELL_WIDTH\n            ) {\n                return false;\n            }\n            cmTable.widths[anchorColumn] = anchorChange;\n            cmTable.widths[anchorColumn + 1] = nextAnchorChange;\n        }\n\n        // Normalize the table\n        normalizeTable(cmTable);\n\n        // Writeback CM Table size changes to DOM Table\n        for (let row = 0; row < table.rows.length; row++) {\n            const tableRow = table.rows[row];\n            for (let col = 0; col < tableRow.cells.length; col++) {\n                tableRow.cells[col].style.width = cmTable.widths[col] + 'px';\n            }\n        }\n\n        return true;\n    } else {\n        return false;\n    }\n}\n\nfunction setHorizontalPosition(context: DragAndDropContext, trigger: HTMLElement) {\n    const { td } = context;\n    const rect = normalizeRect(td.getBoundingClientRect());\n    if (rect) {\n        trigger.id = 'horizontalResizer';\n        trigger.style.top = rect.bottom - CELL_RESIZER_WIDTH + 'px';\n        trigger.style.left = rect.left + 'px';\n        trigger.style.width = rect.right - rect.left + 'px';\n        trigger.style.height = CELL_RESIZER_WIDTH + 'px';\n    }\n}\n\nfunction setVerticalPosition(context: DragAndDropContext, trigger: HTMLElement) {\n    const { td, isRTL } = context;\n    const rect = normalizeRect(td.getBoundingClientRect());\n    if (rect) {\n        trigger.id = 'verticalResizer';\n        trigger.style.top = rect.top + 'px';\n        trigger.style.left = (isRTL ? rect.left : rect.right) - CELL_RESIZER_WIDTH + 1 + 'px';\n        trigger.style.width = CELL_RESIZER_WIDTH + 'px';\n        trigger.style.height = rect.bottom - rect.top + 'px';\n    }\n}\n","import type Disposable from '../../../pluginUtils/Disposable';\n\n/**\n * @internal\n */\nexport default interface TableEditFeature {\n    node: Node;\n    div: HTMLDivElement | null;\n    featureHandler: Disposable | null;\n}\n\n/**\n * @internal\n */\nexport function disposeTableEditFeature(resizer: TableEditFeature | null) {\n    if (resizer) {\n        resizer.div?.parentNode?.removeChild(resizer.div);\n        resizer.div = null;\n        resizer.featureHandler?.dispose();\n        resizer.featureHandler = null;\n    }\n}\n","import createElement from '../../../pluginUtils/CreateElement/createElement';\nimport getIntersectedRect from '../../../pluginUtils/Rect/getIntersectedRect';\nimport normalizeRect from '../../../pluginUtils/Rect/normalizeRect';\nimport { isElementOfType } from 'roosterjs-content-model-dom';\nimport {\n    formatTableWithContentModel,\n    insertTableColumn,\n    insertTableRow,\n} from 'roosterjs-content-model-api';\nimport type CreateElementData from '../../../pluginUtils/CreateElement/CreateElementData';\nimport type Disposable from '../../../pluginUtils/Disposable';\nimport type TableEditFeature from './TableEditorFeature';\nimport type { IEditor } from 'roosterjs-content-model-types';\n\nconst INSERTER_COLOR = '#4A4A4A';\nconst INSERTER_COLOR_DARK_MODE = 'white';\nconst INSERTER_SIDE_LENGTH = 12;\nconst INSERTER_BORDER_SIZE = 1;\n\n/**\n * @internal\n */\nexport default function createTableInserter(\n    editor: IEditor,\n    td: HTMLTableCellElement,\n    table: HTMLTableElement,\n    isRTL: boolean,\n    isHorizontal: boolean,\n    onInsert: () => void,\n    getOnMouseOut: (feature: HTMLElement) => (ev: MouseEvent) => void,\n    anchorContainer?: HTMLElement\n): TableEditFeature | null {\n    const tdRect = normalizeRect(td.getBoundingClientRect());\n    const viewPort = editor.getVisibleViewport();\n    const tableRect = table && viewPort ? getIntersectedRect([table], [viewPort]) : null;\n\n    // set inserter position\n    if (tdRect && tableRect) {\n        const document = td.ownerDocument;\n        const createElementData = getInsertElementData(\n            isHorizontal,\n            editor.isDarkMode(),\n            isRTL,\n            editor.getDOMHelper().getDomStyle('backgroundColor') || 'white'\n        );\n\n        const div = createElement(createElementData, document) as HTMLDivElement;\n\n        if (isHorizontal) {\n            // tableRect.left/right is used because the Inserter is always intended to be on the side\n            div.id = 'horizontalInserter';\n            div.style.left = `${\n                isRTL\n                    ? tableRect.right\n                    : tableRect.left - (INSERTER_SIDE_LENGTH - 1 + 2 * INSERTER_BORDER_SIZE)\n            }px`;\n            div.style.top = `${tdRect.bottom - 8}px`;\n            (div.firstChild as HTMLElement).style.width = `${tableRect.right - tableRect.left}px`;\n        } else {\n            div.id = 'verticalInserter';\n            div.style.left = `${isRTL ? tdRect.left - 8 : tdRect.right - 8}px`;\n            // tableRect.top is used because the Inserter is always intended to be on top\n            div.style.top = `${\n                tableRect.top - (INSERTER_SIDE_LENGTH - 1 + 2 * INSERTER_BORDER_SIZE)\n            }px`;\n            (div.firstChild as HTMLElement).style.height = `${tableRect.bottom - tableRect.top}px`;\n        }\n\n        (anchorContainer || document.body).appendChild(div);\n\n        const handler = new TableInsertHandler(\n            div,\n            td,\n            table,\n            isHorizontal,\n            editor,\n            onInsert,\n            getOnMouseOut\n        );\n\n        return { div, featureHandler: handler, node: td };\n    }\n\n    return null;\n}\n\nclass TableInsertHandler implements Disposable {\n    private onMouseOutEvent: null | ((ev: MouseEvent) => void);\n    constructor(\n        private div: HTMLDivElement,\n        private td: HTMLTableCellElement,\n        private table: HTMLTableElement,\n        private isHorizontal: boolean,\n        private editor: IEditor,\n        private onInsert: () => void,\n        getOnMouseOut: (feature: HTMLElement) => (ev: MouseEvent) => void\n    ) {\n        this.div.addEventListener('click', this.insertTd);\n        this.onMouseOutEvent = getOnMouseOut(div);\n        this.div.addEventListener('mouseout', this.onMouseOutEvent);\n    }\n\n    dispose() {\n        this.div.removeEventListener('click', this.insertTd);\n\n        if (this.onMouseOutEvent) {\n            this.div.removeEventListener('mouseout', this.onMouseOutEvent);\n        }\n\n        this.onMouseOutEvent = null;\n    }\n\n    private insertTd = () => {\n        // Get cell coordinates\n        const columnIndex = this.td.cellIndex;\n        const row =\n            this.td.parentElement && isElementOfType(this.td.parentElement, 'tr')\n                ? this.td.parentElement\n                : undefined;\n        const rowIndex = row && row.rowIndex;\n\n        if (row?.cells == undefined || rowIndex == undefined) {\n            return;\n        }\n\n        // Insert row or column\n        formatTableWithContentModel(\n            this.editor,\n            'editTablePlugin',\n            tableModel => {\n                this.isHorizontal\n                    ? insertTableRow(tableModel, 'insertBelow')\n                    : insertTableColumn(tableModel, 'insertRight');\n            }, // Select cell to make insertion\n            {\n                type: 'table',\n                firstColumn: columnIndex,\n                firstRow: rowIndex,\n                lastColumn: columnIndex,\n                lastRow: rowIndex,\n                table: this.table,\n            }\n        );\n\n        this.onInsert();\n    };\n}\n\nfunction getInsertElementData(\n    isHorizontal: boolean,\n    isDark: boolean,\n    isRTL: boolean,\n    backgroundColor: string\n): CreateElementData {\n    const inserterColor = isDark ? INSERTER_COLOR_DARK_MODE : INSERTER_COLOR;\n    const outerDivStyle = `position: fixed; width: ${INSERTER_SIDE_LENGTH}px; height: ${INSERTER_SIDE_LENGTH}px; font-size: 16px; color: black; line-height: 8px; vertical-align: middle; text-align: center; cursor: pointer; border: solid ${INSERTER_BORDER_SIZE}px ${inserterColor}; border-radius: 50%; background-color: ${backgroundColor}`;\n    const leftOrRight = isRTL ? 'right' : 'left';\n    const childBaseStyles = `position: absolute; box-sizing: border-box; background-color: ${backgroundColor};`;\n    const childInfo: CreateElementData = {\n        tag: 'div',\n        style:\n            childBaseStyles +\n            (isHorizontal\n                ? `${leftOrRight}: 12px; top: 5px; height: 3px; border-top: 1px solid ${inserterColor}; border-bottom: 1px solid ${inserterColor}; border-right: 1px solid ${inserterColor}; border-left: 0px;`\n                : `left: 5px; top: 12px; width: 3px; border-left: 1px solid ${inserterColor}; border-right: 1px solid ${inserterColor}; border-bottom: 1px solid ${inserterColor}; border-top: 0px;`),\n    };\n\n    return {\n        tag: 'div',\n        style: outerDivStyle,\n        children: [childInfo, '+'],\n    };\n}\n","import createElement from '../../../pluginUtils/CreateElement/createElement';\nimport DragAndDropHelper from '../../../pluginUtils/DragAndDrop/DragAndDropHelper';\nimport normalizeRect from '../../../pluginUtils/Rect/normalizeRect';\nimport { isNodeOfType } from 'roosterjs-content-model-dom';\nimport type DragAndDropHandler from '../../../pluginUtils/DragAndDrop/DragAndDropHandler';\nimport type { IEditor, Rect } from 'roosterjs-content-model-types';\nimport type TableEditorFeature from './TableEditorFeature';\n\nconst TABLE_MOVER_LENGTH = 12;\nconst TABLE_MOVER_ID = '_Table_Mover';\n\n/**\n * @internal\n * Contains the function to select whole table\n * Moving behavior not implemented yet\n */\nexport default function createTableMover(\n    table: HTMLTableElement,\n    editor: IEditor,\n    isRTL: boolean,\n    onFinishDragging: (table: HTMLTableElement) => void,\n    getOnMouseOut: (feature: HTMLElement) => (ev: MouseEvent) => void,\n    contentDiv?: EventTarget | null,\n    anchorContainer?: HTMLElement\n): TableEditorFeature | null {\n    const rect = normalizeRect(table.getBoundingClientRect());\n\n    if (!isTableTopVisible(editor, rect, contentDiv as Node)) {\n        return null;\n    }\n\n    const zoomScale = editor.getDOMHelper().calculateZoomScale();\n    const document = table.ownerDocument;\n    const createElementData = {\n        tag: 'div',\n        style: 'position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080',\n    };\n\n    const div = createElement(createElementData, document) as HTMLDivElement;\n\n    div.id = TABLE_MOVER_ID;\n    div.style.width = `${TABLE_MOVER_LENGTH}px`;\n    div.style.height = `${TABLE_MOVER_LENGTH}px`;\n\n    (anchorContainer || document.body).appendChild(div);\n\n    const context: TableMoverContext = {\n        table,\n        zoomScale,\n        rect,\n        isRTL,\n    };\n\n    setDivPosition(context, div);\n\n    const onDragEnd = (context: TableMoverContext, event: MouseEvent): false => {\n        if (event.target == div) {\n            onFinishDragging(context.table);\n        }\n        return false;\n    };\n\n    const featureHandler = new TableMoverFeature(\n        div,\n        context,\n        setDivPosition,\n        {\n            onDragEnd,\n        },\n        context.zoomScale,\n        getOnMouseOut\n    );\n\n    return { div, featureHandler, node: table };\n}\n\ninterface TableMoverContext {\n    table: HTMLTableElement;\n    zoomScale: number;\n    rect: Rect | null;\n    isRTL: boolean;\n}\n\ninterface TableMoverInitValue {\n    event: MouseEvent;\n}\n\nclass TableMoverFeature extends DragAndDropHelper<TableMoverContext, TableMoverInitValue> {\n    private onMouseOut: ((ev: MouseEvent) => void) | null;\n\n    constructor(\n        private div: HTMLElement,\n        context: TableMoverContext,\n        onSubmit: (\n            context: TableMoverContext,\n            trigger: HTMLElement,\n            container?: HTMLElement\n        ) => void,\n        handler: DragAndDropHandler<TableMoverContext, TableMoverInitValue>,\n        zoomScale: number,\n        getOnMouseOut: (feature: HTMLElement) => (ev: MouseEvent) => void,\n        forceMobile?: boolean | undefined,\n        container?: HTMLElement\n    ) {\n        super(div, context, onSubmit, handler, zoomScale, forceMobile);\n        this.onMouseOut = getOnMouseOut(div);\n        div.addEventListener('mouseout', this.onMouseOut);\n    }\n\n    dispose(): void {\n        super.dispose();\n        if (this.onMouseOut) {\n            this.div.removeEventListener('mouseout', this.onMouseOut);\n        }\n        this.onMouseOut = null;\n    }\n}\n\nfunction setDivPosition(context: TableMoverContext, trigger: HTMLElement) {\n    const { rect } = context;\n    if (rect) {\n        trigger.style.top = `${rect.top - TABLE_MOVER_LENGTH}px`;\n        trigger.style.left = `${rect.left - TABLE_MOVER_LENGTH - 2}px`;\n    }\n}\n\nfunction isTableTopVisible(editor: IEditor, rect: Rect | null, contentDiv?: Node | null): boolean {\n    const visibleViewport = editor.getVisibleViewport();\n    if (isNodeOfType(contentDiv, 'ELEMENT_NODE') && visibleViewport && rect) {\n        const containerRect = normalizeRect(contentDiv.getBoundingClientRect());\n\n        return !!containerRect && containerRect.top <= rect.top && visibleViewport.top <= rect.top;\n    }\n\n    return true;\n}\n","import createElement from '../../../pluginUtils/CreateElement/createElement';\nimport DragAndDropHelper from '../../../pluginUtils/DragAndDrop/DragAndDropHelper';\nimport normalizeRect from '../../../pluginUtils/Rect/normalizeRect';\nimport { getFirstSelectedTable, normalizeTable } from 'roosterjs-content-model-core';\nimport { isNodeOfType } from 'roosterjs-content-model-dom';\nimport type { ContentModelTable, IEditor, Rect } from 'roosterjs-content-model-types';\nimport type TableEditFeature from './TableEditorFeature';\n\nconst TABLE_RESIZER_LENGTH = 12;\nconst TABLE_RESIZER_ID = '_Table_Resizer';\n\n/**\n * @internal\n */\nexport default function createTableResizer(\n    table: HTMLTableElement,\n    editor: IEditor,\n    isRTL: boolean,\n    onStart: () => void,\n    onEnd: () => false,\n    contentDiv?: EventTarget | null,\n    anchorContainer?: HTMLElement\n): TableEditFeature | null {\n    const rect = normalizeRect(table.getBoundingClientRect());\n\n    if (!isTableBottomVisible(editor, rect, contentDiv as Node)) {\n        return null;\n    }\n\n    const document = table.ownerDocument;\n    const zoomScale = editor.getDOMHelper().calculateZoomScale();\n    const createElementData = {\n        tag: 'div',\n        style: `position: fixed; cursor: ${\n            isRTL ? 'ne' : 'nw'\n        }-resize; user-select: none; border: 1px solid #808080`,\n    };\n\n    const div = createElement(createElementData, document) as HTMLDivElement;\n\n    div.id = TABLE_RESIZER_ID;\n    div.style.width = `${TABLE_RESIZER_LENGTH}px`;\n    div.style.height = `${TABLE_RESIZER_LENGTH}px`;\n\n    (anchorContainer || document.body).appendChild(div);\n\n    const context: DragAndDropContext = {\n        isRTL,\n        table,\n        zoomScale,\n        onStart,\n        onEnd,\n        div,\n        editor,\n        contentDiv,\n    };\n\n    setDivPosition(context, div);\n\n    const featureHandler = new DragAndDropHelper<DragAndDropContext, DragAndDropInitValue>(\n        div,\n        context,\n        hideResizer, // Resizer is hidden while dragging only\n        {\n            onDragStart,\n            onDragging,\n            onDragEnd,\n        },\n        zoomScale,\n        editor.getEnvironment().isMobileOrTablet\n    );\n\n    return { node: table, div, featureHandler };\n}\n\ninterface DragAndDropContext {\n    table: HTMLTableElement;\n    isRTL: boolean;\n    zoomScale: number;\n    onStart: () => void;\n    onEnd: () => false;\n    div: HTMLDivElement;\n    editor: IEditor;\n    contentDiv?: EventTarget | null;\n}\n\ninterface DragAndDropInitValue {\n    originalRect: DOMRect;\n    originalHeights: number[];\n    originalWidths: number[];\n    cmTable: ContentModelTable | undefined;\n}\n\nfunction onDragStart(context: DragAndDropContext, event: MouseEvent) {\n    context.onStart();\n\n    const { editor, table } = context;\n\n    // Get current selection\n    const selection = editor.getDOMSelection();\n\n    // Select first cell of the table\n    editor.setDOMSelection({\n        type: 'table',\n        firstColumn: 0,\n        firstRow: 0,\n        lastColumn: 0,\n        lastRow: 0,\n        table: table,\n    });\n\n    // Get the table content model\n    const cmTable = getFirstSelectedTable(editor.getContentModelCopy('disconnected'))[0];\n\n    // Restore selection\n    editor.setDOMSelection(selection);\n\n    // Save original widths and heights\n    const heights: number[] = [];\n    cmTable?.rows.forEach(row => {\n        heights.push(row.height);\n    });\n    const widths: number[] = [];\n    cmTable?.widths.forEach(width => {\n        widths.push(width);\n    });\n\n    return {\n        originalRect: table.getBoundingClientRect(),\n        cmTable,\n        originalHeights: heights ?? [],\n        originalWidths: widths ?? [],\n    };\n}\n\nfunction onDragging(\n    context: DragAndDropContext,\n    event: MouseEvent,\n    initValue: DragAndDropInitValue,\n    deltaX: number,\n    deltaY: number\n) {\n    const { isRTL, zoomScale, table } = context;\n    const { originalRect, originalHeights, originalWidths, cmTable } = initValue;\n\n    const ratioX = 1.0 + (deltaX / originalRect.width) * zoomScale * (isRTL ? -1 : 1);\n    const ratioY = 1.0 + (deltaY / originalRect.height) * zoomScale;\n    const shouldResizeX = Math.abs(ratioX - 1.0) > 1e-3;\n    const shouldResizeY = Math.abs(ratioY - 1.0) > 1e-3;\n\n    // If the width of some external table is fixed, we need to make it resizable\n    table.style.setProperty('width', null);\n    // If the height of some external table is fixed, we need to make it resizable\n    table.style.setProperty('height', null);\n\n    // Assign new widths and heights to the CM table\n    if (cmTable && cmTable.rows && (shouldResizeX || shouldResizeY)) {\n        // Modify the CM Table size\n        for (let i = 0; i < cmTable.rows.length; i++) {\n            for (let j = 0; j < cmTable.rows[i].cells.length; j++) {\n                const cell = cmTable.rows[i].cells[j];\n                if (cell) {\n                    if (shouldResizeX && i == 0) {\n                        cmTable.widths[j] = (originalWidths[j] ?? 0) * ratioX;\n                    }\n                    if (shouldResizeY && j == 0) {\n                        cmTable.rows[i].height = (originalHeights[i] ?? 0) * ratioY;\n                    }\n                }\n            }\n        }\n\n        // Normalize the table\n        normalizeTable(cmTable);\n\n        // Writeback CM Table size changes to DOM Table\n        for (let row = 0; row < table.rows.length; row++) {\n            const tableRow = table.rows[row];\n\n            if (tableRow.cells.length == 0) {\n                // Skip empty row\n                continue;\n            }\n\n            for (let col = 0; col < tableRow.cells.length; col++) {\n                const td = tableRow.cells[col];\n                td.style.width = cmTable.widths[col] + 'px';\n                td.style.height = cmTable.rows[row].height + 'px';\n            }\n        }\n        return true;\n    } else {\n        return false;\n    }\n}\n\nfunction onDragEnd(\n    context: DragAndDropContext,\n    event: MouseEvent,\n    initValue: DragAndDropInitValue | undefined\n) {\n    if (\n        isTableBottomVisible(\n            context.editor,\n            normalizeRect(context.table.getBoundingClientRect()),\n            context.contentDiv as Node\n        )\n    ) {\n        context.div.style.visibility = 'visible';\n        setDivPosition(context, context.div);\n    }\n    context.onEnd();\n    return false;\n}\n\nfunction setDivPosition(context: DragAndDropContext, trigger: HTMLElement) {\n    const { table, isRTL } = context;\n    const rect = normalizeRect(table.getBoundingClientRect());\n\n    if (rect) {\n        trigger.style.top = `${rect.bottom}px`;\n        trigger.style.left = isRTL\n            ? `${rect.left - TABLE_RESIZER_LENGTH - 2}px`\n            : `${rect.right}px`;\n    }\n}\n\nfunction hideResizer(context: DragAndDropContext, trigger: HTMLElement) {\n    trigger.style.visibility = 'hidden';\n}\n\nfunction isTableBottomVisible(\n    editor: IEditor,\n    rect: Rect | null,\n    contentDiv?: Node | null\n): boolean {\n    const visibleViewport = editor.getVisibleViewport();\n    if (isNodeOfType(contentDiv, 'ELEMENT_NODE') && visibleViewport && rect) {\n        const containerRect = normalizeRect(contentDiv.getBoundingClientRect());\n\n        return (\n            !!containerRect &&\n            containerRect.bottom >= rect.bottom &&\n            visibleViewport.bottom >= rect.bottom\n        );\n    }\n\n    return true;\n}\n","import { cacheGetEventData } from 'roosterjs-content-model-core';\nimport { createDarkColorHandler } from '../editor/DarkColorHandlerImpl';\nimport { createEditPlugin } from './EditPlugin';\nimport { newEventToOldEvent, oldEventToNewEvent } from '../editor/utils/eventConverter';\nimport type {\n    EditorPlugin as LegacyEditorPlugin,\n    ContextMenuProvider as LegacyContextMenuProvider,\n    IEditor as ILegacyEditor,\n    ExperimentalFeatures,\n    SizeTransformer,\n    EditPluginState,\n    CustomData,\n    DarkColorHandler,\n} from 'roosterjs-editor-types';\nimport type { ContextMenuProvider, IEditor, PluginEvent } from 'roosterjs-content-model-types';\n\nconst ExclusivelyHandleEventPluginKey = '__ExclusivelyHandleEventPlugin';\nconst OldEventKey = '__OldEventFromNewEvent';\n\n/**\n * @internal\n * Represents the core data structure of a editor adapter\n */\nexport interface EditorAdapterCore {\n    /**\n     * Custom data of this editor\n     */\n    readonly customData: Record<string, CustomData>;\n\n    /**\n     * Enabled experimental features\n     */\n    readonly experimentalFeatures: ExperimentalFeatures[];\n\n    /**\n     * Dark model handler for the editor, used for variable-based solution.\n     * If keep it null, editor will still use original dataset-based dark mode solution.\n     */\n    readonly darkColorHandler: DarkColorHandler;\n\n    /**\n     * Plugin state of EditPlugin\n     */\n    readonly edit: EditPluginState;\n\n    /**\n     * Context Menu providers\n     */\n    readonly contextMenuProviders: LegacyContextMenuProvider<any>[];\n\n    /**\n     * @deprecated Use zoomScale instead\n     */\n    readonly sizeTransformer: SizeTransformer;\n}\n\n/**\n * @internal\n * Act as a bridge between Standalone editor and Content Model editor, translate Standalone editor event type to legacy event type\n */\nexport class BridgePlugin implements ContextMenuProvider<any> {\n    private legacyPlugins: LegacyEditorPlugin[];\n    private edit: EditPluginState;\n    private contextMenuProviders: LegacyContextMenuProvider<any>[];\n    private checkExclusivelyHandling: boolean;\n\n    constructor(\n        private onInitialize: (core: EditorAdapterCore) => ILegacyEditor,\n        legacyPlugins: LegacyEditorPlugin[] = [],\n        private experimentalFeatures: ExperimentalFeatures[] = []\n    ) {\n        const editPlugin = createEditPlugin();\n\n        this.legacyPlugins = [editPlugin, ...legacyPlugins.filter(x => !!x)];\n        this.edit = editPlugin.getState();\n        this.contextMenuProviders = this.legacyPlugins.filter(isContextMenuProvider);\n        this.checkExclusivelyHandling = this.legacyPlugins.some(\n            plugin => plugin.willHandleEventExclusively\n        );\n    }\n\n    /**\n     * Get a friendly name of  this plugin\n     */\n    getName() {\n        return 'Bridge';\n    }\n\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    initialize(editor: IEditor) {\n        const outerEditor = this.onInitialize(this.createEditorCore(editor));\n\n        this.legacyPlugins.forEach(plugin => plugin.initialize(outerEditor));\n    }\n\n    /**\n     * Dispose this plugin\n     */\n    dispose() {\n        for (let i = this.legacyPlugins.length - 1; i >= 0; i--) {\n            const plugin = this.legacyPlugins[i];\n\n            plugin.dispose();\n        }\n    }\n\n    willHandleEventExclusively(event: PluginEvent) {\n        return this.checkExclusivelyHandling && !!this.cacheGetExclusivelyHandlePlugin(event);\n    }\n\n    onPluginEvent(event: PluginEvent) {\n        const oldEvent = this.cacheGetOldEvent(event);\n\n        if (oldEvent) {\n            const exclusivelyHandleEventPlugin = this.cacheGetExclusivelyHandlePlugin(event);\n\n            if (exclusivelyHandleEventPlugin) {\n                exclusivelyHandleEventPlugin.onPluginEvent?.(oldEvent);\n            } else {\n                this.legacyPlugins.forEach(plugin => plugin.onPluginEvent?.(oldEvent));\n            }\n\n            Object.assign(event, oldEventToNewEvent(oldEvent, event));\n        }\n    }\n\n    /**\n     * A callback to return context menu items\n     * @param target Target node that triggered a ContextMenu event\n     * @returns An array of context menu items, or null means no items needed\n     */\n    getContextMenuItems(target: Node): any[] {\n        const allItems: any[] = [];\n\n        this.contextMenuProviders.forEach(provider => {\n            const items = provider.getContextMenuItems(target) ?? [];\n            if (items?.length > 0) {\n                if (allItems.length > 0) {\n                    allItems.push(null);\n                }\n\n                allItems.push(...items);\n            }\n        });\n\n        return allItems;\n    }\n\n    private cacheGetExclusivelyHandlePlugin(event: PluginEvent) {\n        return cacheGetEventData(event, ExclusivelyHandleEventPluginKey, event => {\n            const oldEvent = this.cacheGetOldEvent(event);\n\n            if (oldEvent) {\n                for (let i = 0; i < this.legacyPlugins.length; i++) {\n                    const plugin = this.legacyPlugins[i];\n\n                    if (plugin.willHandleEventExclusively?.(oldEvent)) {\n                        return plugin;\n                    }\n                }\n            }\n\n            return null;\n        });\n    }\n\n    private cacheGetOldEvent(event: PluginEvent) {\n        return cacheGetEventData(event, OldEventKey, newEventToOldEvent);\n    }\n\n    private createEditorCore(editor: IEditor): EditorAdapterCore {\n        return {\n            customData: {},\n            experimentalFeatures: this.experimentalFeatures ?? [],\n            sizeTransformer: createSizeTransformer(editor),\n            darkColorHandler: createDarkColorHandler(editor.getColorManager()),\n            edit: this.edit,\n            contextMenuProviders: this.contextMenuProviders,\n        };\n    }\n}\n\n/**\n * @internal Export for test only. This function is only used for compatibility from older build\n\n */\nexport function createSizeTransformer(editor: IEditor): SizeTransformer {\n    return size => size / editor.getDOMHelper().calculateZoomScale();\n}\n\nfunction isContextMenuProvider(\n    source: LegacyEditorPlugin\n): source is LegacyContextMenuProvider<any> {\n    return !!(<LegacyContextMenuProvider<any>>source)?.getContextMenuItems;\n}\n","import { isCtrlOrMetaPressed } from 'roosterjs-editor-dom';\nimport { Keys, PluginEventType } from 'roosterjs-editor-types';\nimport type {\n    EditPluginState,\n    GenericContentEditFeature,\n    IEditor,\n    PluginEvent,\n    PluginWithState,\n} from 'roosterjs-editor-types';\n\n/**\n * Edit Component helps handle Content edit features\n */\nclass EditPlugin implements PluginWithState<EditPluginState> {\n    private editor: IEditor | null = null;\n    private state: EditPluginState;\n\n    /**\n     * Construct a new instance of EditPlugin\n     * @param options The editor options\n     */\n    constructor() {\n        this.state = {\n            features: {},\n        };\n    }\n\n    /**\n     * Get a friendly name of  this plugin\n     */\n    getName() {\n        return 'Edit';\n    }\n\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n    }\n\n    /**\n     * Dispose this plugin\n     */\n    dispose() {\n        this.editor = null;\n    }\n\n    /**\n     * Get plugin state object\n     */\n    getState() {\n        return this.state;\n    }\n\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    onPluginEvent(event: PluginEvent) {\n        let hasFunctionKey = false;\n        let features: GenericContentEditFeature<PluginEvent>[] | null = null;\n        let ctrlOrMeta = false;\n        const isKeyDownEvent = event.eventType == PluginEventType.KeyDown;\n\n        if (isKeyDownEvent) {\n            const rawEvent = event.rawEvent;\n            const range = this.editor?.getSelectionRange();\n\n            ctrlOrMeta = isCtrlOrMetaPressed(rawEvent);\n            hasFunctionKey = ctrlOrMeta || rawEvent.altKey;\n            features =\n                this.state.features[rawEvent.which] ||\n                (range && !range.collapsed && this.state.features[Keys.RANGE]);\n        } else if (event.eventType == PluginEventType.ContentChanged) {\n            features = this.state.features[Keys.CONTENTCHANGED];\n        }\n\n        for (let i = 0; features && i < features?.length; i++) {\n            const feature = features[i];\n            if (\n                (feature.allowFunctionKeys || !hasFunctionKey) &&\n                this.editor &&\n                feature.shouldHandleEvent(event, this.editor, ctrlOrMeta)\n            ) {\n                feature.handleEvent(event, this.editor);\n                if (isKeyDownEvent) {\n                    event.handledByEditFeature = true;\n                }\n                break;\n            }\n        }\n    }\n}\n\n/**\n * @internal\n * Create a new instance of EditPlugin.\n */\nexport function createEditPlugin(): PluginWithState<EditPluginState> {\n    return new EditPlugin();\n}\n","import { getColor, getObjectKeys, parseColor, setColor } from 'roosterjs-content-model-dom';\nimport type { ColorKeyAndValue, DarkColorHandler } from 'roosterjs-editor-types';\nimport type { DarkColorHandler as StandaloneDarkColorHandler } from 'roosterjs-content-model-types';\n\nconst VARIABLE_REGEX = /^\\s*var\\(\\s*(\\-\\-[a-zA-Z0-9\\-_]+)\\s*(?:,\\s*(.*))?\\)\\s*$/;\nconst VARIABLE_PREFIX = 'var(';\nconst COLOR_VAR_PREFIX = 'darkColor';\n\nclass DarkColorHandlerImpl implements DarkColorHandler {\n    constructor(private innerHandler: StandaloneDarkColorHandler) {}\n\n    /**\n     * Get a copy of known colors\n     * @returns\n     */\n    getKnownColorsCopy() {\n        return Object.values(this.innerHandler.knownColors);\n    }\n\n    /**\n     * Given a light mode color value and an optional dark mode color value, register this color\n     * so that editor can handle it, then return the CSS color value for current color mode.\n     * @param lightModeColor Light mode color value\n     * @param isDarkMode Whether current color mode is dark mode\n     * @param darkModeColor Optional dark mode color value. If not passed, we will calculate one.\n     */\n    registerColor(lightModeColor: string, isDarkMode: boolean, darkModeColor?: string): string {\n        const parsedColor = this.parseColorValue(lightModeColor);\n        let colorKey: string | undefined;\n\n        if (parsedColor) {\n            lightModeColor = parsedColor.lightModeColor;\n            darkModeColor = parsedColor.darkModeColor || darkModeColor;\n            colorKey = parsedColor.key;\n        }\n\n        if (isDarkMode && lightModeColor) {\n            colorKey =\n                colorKey || `--${COLOR_VAR_PREFIX}_${lightModeColor.replace(/[^\\d\\w]/g, '_')}`;\n\n            this.innerHandler.updateKnownColor(isDarkMode, colorKey, {\n                lightModeColor,\n                darkModeColor: darkModeColor || this.innerHandler.getDarkColor(lightModeColor),\n            });\n\n            return `var(${colorKey}, ${lightModeColor})`;\n        } else {\n            return lightModeColor;\n        }\n    }\n\n    /**\n     * Reset known color record, clean up registered color variables.\n     */\n    reset(): void {\n        this.innerHandler.reset();\n    }\n\n    /**\n     * Parse an existing color value, if it is in variable-based color format, extract color key,\n     * light color and query related dark color if any\n     * @param color The color string to parse\n     * @param isInDarkMode Whether current content is in dark mode. When set to true, if the color value is not in dark var format,\n     * we will treat is as a dark mode color and try to find a matched dark mode color.\n     */\n    parseColorValue(color: string | undefined | null, isInDarkMode?: boolean): ColorKeyAndValue {\n        let key: string | undefined;\n        let lightModeColor = '';\n        let darkModeColor: string | undefined;\n\n        if (color) {\n            const match = color.startsWith(VARIABLE_PREFIX) ? VARIABLE_REGEX.exec(color) : null;\n\n            if (match) {\n                if (match[2]) {\n                    key = match[1];\n                    lightModeColor = match[2];\n                    darkModeColor = this.innerHandler.knownColors[key]?.darkModeColor;\n                } else {\n                    lightModeColor = '';\n                }\n            } else if (isInDarkMode) {\n                // If editor is in dark mode but the color is not in dark color format, it is possible the color was inserted from external code\n                // without any light color info. So we first try to see if there is a known dark color can match this color, and use its related\n                // light color as light mode color. Otherwise we need to drop this color to avoid show \"white on white\" content.\n                lightModeColor = this.findLightColorFromDarkColor(color) || '';\n\n                if (lightModeColor) {\n                    darkModeColor = color;\n                }\n            } else {\n                lightModeColor = color;\n            }\n        }\n\n        return { key, lightModeColor, darkModeColor };\n    }\n\n    /**\n     * Find related light mode color from dark mode color.\n     * @param darkColor The existing dark color\n     */\n    findLightColorFromDarkColor(darkColor: string): string | null {\n        const rgbSearch = parseColor(darkColor);\n        const knownColors = this.innerHandler.knownColors;\n\n        if (rgbSearch) {\n            const key = getObjectKeys(knownColors).find(key => {\n                const rgbCurrent = parseColor(knownColors[key].darkModeColor);\n\n                return (\n                    rgbCurrent &&\n                    rgbCurrent[0] == rgbSearch[0] &&\n                    rgbCurrent[1] == rgbSearch[1] &&\n                    rgbCurrent[2] == rgbSearch[2]\n                );\n            });\n\n            if (key) {\n                return knownColors[key].lightModeColor;\n            }\n        }\n\n        return null;\n    }\n\n    /**\n     * Transform element color, from dark to light or from light to dark\n     * @param element The element to transform color\n     * @param fromDarkMode Whether this is transforming color from dark mode\n     * @param toDarkMode Whether this is transforming color to dark mode\n     */\n    transformElementColor(element: HTMLElement, fromDarkMode: boolean, toDarkMode: boolean): void {\n        const textColor = getColor(element, false /*isBackground*/, !toDarkMode, this.innerHandler);\n        const backColor = getColor(element, true /*isBackground*/, !toDarkMode, this.innerHandler);\n\n        setColor(element, textColor, false /*isBackground*/, toDarkMode, this.innerHandler);\n        setColor(element, backColor, true /*isBackground*/, toDarkMode, this.innerHandler);\n    }\n}\n\n/**\n * @internal\n */\nexport function createDarkColorHandler(innerHandler: StandaloneDarkColorHandler): DarkColorHandler {\n    return new DarkColorHandlerImpl(innerHandler);\n}\n","import { BridgePlugin } from '../corePlugins/BridgePlugin';\nimport { buildRangeEx } from './utils/buildRangeEx';\nimport { getObjectKeys } from 'roosterjs-content-model-dom';\nimport { insertNode } from './utils/insertNode';\nimport type { EditorAdapterCore } from '../corePlugins/BridgePlugin';\nimport {\n    newEventToOldEvent,\n    oldEventToNewEvent,\n    OldEventTypeToNewEventType,\n} from './utils/eventConverter';\nimport {\n    createModelFromHtml,\n    exportContent,\n    isBold,\n    redo,\n    retrieveModelFormatState,\n    Editor,\n    transformColor,\n    undo,\n} from 'roosterjs-content-model-core';\nimport {\n    ChangeSource,\n    ColorTransformDirection,\n    ContentPosition,\n    GetContentMode,\n    PluginEventType,\n    QueryScope,\n    RegionType,\n} from 'roosterjs-editor-types';\nimport type {\n    BlockElement,\n    ClipboardData,\n    ContentChangedData,\n    ContentChangedEvent,\n    DOMEventHandler,\n    DefaultFormat,\n    EditorUndoState,\n    ExperimentalFeatures,\n    GenericContentEditFeature,\n    IContentTraverser,\n    IPositionContentSearcher,\n    InsertOption,\n    NodePosition,\n    PendableFormatState,\n    PluginEvent,\n    PluginEventData,\n    PluginEventFromType,\n    PositionType,\n    Region,\n    SelectionPath,\n    SelectionRangeEx,\n    SizeTransformer,\n    StyleBasedFormatState,\n    TableSelection,\n    DOMEventHandlerObject,\n    DarkColorHandler,\n    IEditor as ILegacyEditor,\n} from 'roosterjs-editor-types';\nimport {\n    convertDomSelectionToRangeEx,\n    convertRangeExToDomSelection,\n} from './utils/selectionConverter';\nimport type {\n    CompatibleChangeSource,\n    CompatibleColorTransformDirection,\n    CompatibleContentPosition,\n    CompatibleExperimentalFeatures,\n    CompatibleGetContentMode,\n    CompatiblePluginEventType,\n    CompatibleQueryScope,\n    CompatibleRegionType,\n} from 'roosterjs-editor-types/lib/compatibleTypes';\nimport {\n    ContentTraverser,\n    Position,\n    PositionContentSearcher,\n    cacheGetEventData,\n    collapseNodes,\n    contains,\n    deleteSelectedContent,\n    findClosestElementAncestor,\n    getBlockElementAtNode,\n    getRegionsFromRange,\n    getSelectionPath,\n    isNodeEmpty,\n    isPositionAtBeginningOf,\n    queryElements,\n    toArray,\n    wrap,\n} from 'roosterjs-editor-dom';\nimport type { EditorAdapterOptions } from '../publicTypes/EditorAdapterOptions';\nimport type {\n    ContentModelFormatState,\n    DOMEventRecord,\n    ExportContentMode,\n    IEditor,\n    EditorOptions,\n} from 'roosterjs-content-model-types';\n\nconst GetContentModeMap: Record<GetContentMode, ExportContentMode> = {\n    [GetContentMode.CleanHTML]: 'HTML',\n    [GetContentMode.PlainText]: 'PlainText',\n    [GetContentMode.PlainTextFast]: 'PlainTextFast',\n    [GetContentMode.RawHTMLOnly]: 'HTML',\n    [GetContentMode.RawHTMLWithSelection]: 'HTML',\n};\n\n/**\n * Editor for Content Model.\n * (This class is still under development, and may still be changed in the future with some breaking changes)\n */\nexport class EditorAdapter extends Editor implements ILegacyEditor {\n    private contentModelEditorCore: EditorAdapterCore | undefined;\n\n    /**\n     * Creates an instance of Editor\n     * @param contentDiv The DIV HTML element which will be the container element of editor\n     * @param options An optional options object to customize the editor\n     */\n    constructor(contentDiv: HTMLDivElement, options: EditorAdapterOptions = {}) {\n        const bridgePlugin = new BridgePlugin(\n            core => {\n                this.contentModelEditorCore = core;\n\n                return this;\n            },\n            options.legacyPlugins,\n            options.experimentalFeatures\n        );\n\n        const plugins = [bridgePlugin, ...(options.plugins ?? [])];\n        const initContent = options.initialContent ?? contentDiv.innerHTML;\n        const initialModel =\n            initContent && !options.initialModel\n                ? createModelFromHtml(\n                      initContent,\n                      options.defaultDomToModelOptions,\n                      options.trustedHTMLHandler,\n                      options.defaultSegmentFormat\n                  )\n                : options.initialModel;\n        const standaloneEditorOptions: EditorOptions = {\n            ...options,\n            plugins,\n            initialModel,\n        };\n\n        super(contentDiv, standaloneEditorOptions);\n    }\n\n    /**\n     * Dispose this editor, dispose all plugins and custom data\n     */\n    dispose(): void {\n        super.dispose();\n\n        const core = this.contentModelEditorCore;\n\n        if (core) {\n            getObjectKeys(core.customData).forEach(key => {\n                const data = core.customData[key];\n\n                if (data && data.disposer) {\n                    data.disposer(data.value);\n                }\n\n                delete core.customData[key];\n            });\n\n            this.contentModelEditorCore = undefined;\n        }\n    }\n\n    /**\n     * Get whether this editor is disposed\n     * @returns True if editor is disposed, otherwise false\n     */\n    isDisposed(): boolean {\n        return super.isDisposed() || !this.contentModelEditorCore;\n    }\n\n    /**\n     * Insert node into editor\n     * @param node The node to insert\n     * @param option Insert options. Default value is:\n     *  position: ContentPosition.SelectionStart\n     *  updateCursor: true\n     *  replaceSelection: true\n     *  insertOnNewLine: false\n     * @returns true if node is inserted. Otherwise false\n     */\n    insertNode(node: Node, option?: InsertOption): boolean {\n        if (node) {\n            option = option || {\n                position: ContentPosition.SelectionStart,\n                insertOnNewLine: false,\n                updateCursor: true,\n                replaceSelection: true,\n                insertToRegionRoot: false,\n            };\n\n            const { physicalRoot } = this.getCore();\n\n            if (option.updateCursor) {\n                this.focus();\n            }\n\n            if (option.position == ContentPosition.Outside) {\n                physicalRoot.parentNode?.insertBefore(node, physicalRoot.nextSibling);\n            } else {\n                if (this.isDarkMode()) {\n                    transformColor(\n                        node,\n                        true /*includeSelf*/,\n                        'lightToDark',\n                        this.getColorManager()\n                    );\n                }\n\n                const selection = insertNode(physicalRoot, this.getDOMSelection(), node, option);\n\n                if (selection && option.updateCursor) {\n                    this.setDOMSelection(selection);\n                }\n            }\n\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    /**\n     * Delete a node from editor content\n     * @param node The node to delete\n     * @returns true if node is deleted. Otherwise false\n     */\n    deleteNode(node: Node): boolean {\n        // Only remove the node when it falls within editor\n        if (node && this.contains(node) && node.parentNode) {\n            node.parentNode.removeChild(node);\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Replace a node in editor content with another node\n     * @param existingNode The existing node to be replaced\n     * @param toNode node to replace to\n     * @param transformColorForDarkMode (optional) Whether to transform new node to dark mode. Default is false\n     * @returns true if node is replaced. Otherwise false\n     */\n    replaceNode(existingNode: Node, toNode: Node, transformColorForDarkMode?: boolean): boolean {\n        const core = this.getCore();\n        // Only replace the node when it falls within editor\n        if (this.contains(existingNode) && toNode) {\n            if (core.lifecycle.isDarkMode && transformColorForDarkMode) {\n                this.transformToDarkColor(toNode, ColorTransformDirection.LightToDark);\n            }\n\n            existingNode.parentNode?.replaceChild(toNode, existingNode);\n\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Get BlockElement at given node\n     * @param node The node to create InlineElement\n     * @returns The BlockElement result\n     */\n    getBlockElementAtNode(node: Node): BlockElement | null {\n        return getBlockElementAtNode(this.getCore().logicalRoot, node);\n    }\n\n    contains(arg: Node | Range | null): boolean {\n        if (!arg) {\n            return false;\n        }\n        return contains(this.getCore().logicalRoot, <Node>arg);\n    }\n\n    queryElements(\n        selector: string,\n        scopeOrCallback:\n            | QueryScope\n            | CompatibleQueryScope\n            | ((node: Node) => any) = QueryScope.Body,\n        callback?: (node: Node) => any\n    ) {\n        const core = this.getCore();\n        const result: HTMLElement[] = [];\n        const scope = scopeOrCallback instanceof Function ? QueryScope.Body : scopeOrCallback;\n        callback = scopeOrCallback instanceof Function ? scopeOrCallback : callback;\n\n        const selectionEx = scope == QueryScope.Body ? null : this.getSelectionRangeEx();\n        if (selectionEx) {\n            selectionEx.ranges.forEach(range => {\n                result.push(...queryElements(core.logicalRoot, selector, callback, scope, range));\n            });\n        } else {\n            return queryElements(\n                core.logicalRoot,\n                selector,\n                callback,\n                scope,\n                undefined /* range */\n            );\n        }\n\n        return result;\n    }\n\n    /**\n     * Collapse nodes within the given start and end nodes to their common ancestor node,\n     * split parent nodes if necessary\n     * @param start The start node\n     * @param end The end node\n     * @param canSplitParent True to allow split parent node there are nodes before start or after end under the same parent\n     * and the returned nodes will be all nodes from start through end after splitting\n     * False to disallow split parent\n     * @returns When canSplitParent is true, returns all node from start through end after splitting,\n     * otherwise just return start and end\n     */\n    collapseNodes(start: Node, end: Node, canSplitParent: boolean): Node[] {\n        return collapseNodes(this.getCore().physicalRoot, start, end, canSplitParent);\n    }\n\n    //#endregion\n\n    //#region Content API\n\n    /**\n     * Check whether the editor contains any visible content\n     * @param trim Whether trim the content string before check. Default is false\n     * @returns True if there's no visible content, otherwise false\n     */\n    isEmpty(trim?: boolean): boolean {\n        return isNodeEmpty(this.getCore().physicalRoot, trim);\n    }\n\n    /**\n     * Get current editor content as HTML string\n     * @param mode specify what kind of HTML content to retrieve\n     * @returns HTML string representing current editor content\n     */\n    getContent(mode: GetContentMode | CompatibleGetContentMode = GetContentMode.CleanHTML): string {\n        return exportContent(\n            this,\n            GetContentModeMap[mode],\n            this.getCore().modelToDomSettings.customized\n        );\n    }\n\n    /**\n     * Set HTML content to this editor. All existing content will be replaced. A ContentChanged event will be triggered\n     * @param content HTML content to set in\n     * @param triggerContentChangedEvent True to trigger a ContentChanged event. Default value is true\n     */\n    setContent(content: string, triggerContentChangedEvent: boolean = true) {\n        const core = this.getCore();\n        const { physicalRoot, api, trustedHTMLHandler, lifecycle, darkColorHandler } = core;\n\n        api.triggerEvent(\n            core,\n            {\n                eventType: 'beforeSetContent',\n                newContent: content,\n            },\n            true /*broadcast*/\n        );\n\n        const newModel = createModelFromHtml(\n            content,\n            core.domToModelSettings.customized,\n            trustedHTMLHandler,\n            core.format.defaultFormat\n        );\n\n        api.setContentModel(core, newModel);\n\n        if (triggerContentChangedEvent) {\n            api.triggerEvent(\n                core,\n                {\n                    eventType: 'contentChanged',\n                    source: ChangeSource.SetContent,\n                },\n                false /*broadcast*/\n            );\n        } else if (lifecycle.isDarkMode) {\n            transformColor(physicalRoot, false /*includeSelf*/, 'lightToDark', darkColorHandler);\n        }\n    }\n\n    /**\n     * Insert HTML content into editor\n     * @param HTML content to insert\n     * @param option Insert options. Default value is:\n     *  position: ContentPosition.SelectionStart\n     *  updateCursor: true\n     *  replaceSelection: true\n     *  insertOnNewLine: false\n     */\n    insertContent(content: string, option?: InsertOption) {\n        if (content) {\n            const doc = this.getDocument();\n            const body = new DOMParser().parseFromString(\n                this.getCore().trustedHTMLHandler(content),\n                'text/html'\n            )?.body;\n            let allNodes = body?.childNodes ? toArray(body.childNodes) : [];\n\n            // If it is to insert on new line, and there are more than one node in the collection, wrap all nodes with\n            // a parent DIV before calling insertNode on each top level sub node. Otherwise, every sub node may get wrapped\n            // separately to show up on its own line\n            if (option && option.insertOnNewLine && allNodes.length > 1) {\n                allNodes = [wrap(allNodes)];\n            }\n\n            const fragment = doc.createDocumentFragment();\n            allNodes.forEach(node => fragment.appendChild(node));\n\n            this.insertNode(fragment, option);\n        }\n    }\n\n    /**\n     * Delete selected content\n     */\n    deleteSelectedContent(): NodePosition | null {\n        const range = this.getSelectionRange();\n        if (range && !range.collapsed) {\n            return deleteSelectedContent(this.getCore().physicalRoot, range);\n        }\n        return null;\n    }\n\n    /**\n     * Paste into editor using a clipboardData object\n     * @param clipboardData Clipboard data retrieved from clipboard\n     * @param pasteAsText Force pasting as plain text. Default value is false\n     * @param applyCurrentStyle True if apply format of current selection to the pasted content,\n     * false to keep original format.  Default value is false. When pasteAsText is true, this parameter is ignored\n     * @param pasteAsImage: When set to true, if the clipboardData contains a imageDataUri will paste the image to the editor\n     */\n    paste(\n        clipboardData: ClipboardData,\n        pasteAsText: boolean = false,\n        applyCurrentFormat: boolean = false,\n        pasteAsImage: boolean = false\n    ) {\n        this.pasteFromClipboard(\n            clipboardData,\n            pasteAsText\n                ? 'asPlainText'\n                : applyCurrentFormat\n                ? 'mergeFormat'\n                : pasteAsImage\n                ? 'asImage'\n                : 'normal'\n        );\n    }\n\n    //#endregion\n\n    //#region Focus and Selection\n\n    /**\n     * Get current selection range from Editor.\n     * It does a live pull on the selection, if nothing retrieved, return whatever we have in cache.\n     * @param tryGetFromCache Set to true to retrieve the selection range from cache if editor doesn't own the focus now.\n     * Default value is true\n     * @returns current selection range, or null if editor never got focus before\n     */\n    getSelectionRange(tryGetFromCache: boolean = true): Range | null {\n        const selection = this.getDOMSelection();\n\n        return selection?.type == 'range' ? selection.range : null;\n    }\n\n    /**\n     * Get current selection range from Editor.\n     * It does a live pull on the selection, if nothing retrieved, return whatever we have in cache.\n     * @param tryGetFromCache Set to true to retrieve the selection range from cache if editor doesn't own the focus now.\n     * Default value is true\n     * @returns current selection range, or null if editor never got focus before\n     */\n    getSelectionRangeEx(): SelectionRangeEx {\n        const selection = this.getDOMSelection();\n\n        return convertDomSelectionToRangeEx(selection);\n    }\n\n    /**\n     * Get current selection in a serializable format\n     * It does a live pull on the selection, if nothing retrieved, return whatever we have in cache.\n     * @returns current selection path, or null if editor never got focus before\n     */\n    getSelectionPath(): SelectionPath | null {\n        const range = this.getSelectionRange();\n        return range && getSelectionPath(this.getCore().physicalRoot, range);\n    }\n\n    select(\n        arg1: Range | SelectionRangeEx | NodePosition | Node | SelectionPath | null,\n        arg2?: NodePosition | number | PositionType | TableSelection | null,\n        arg3?: Node,\n        arg4?: number | PositionType\n    ): boolean {\n        const core = this.getCore();\n        const rangeEx = buildRangeEx(core.physicalRoot, arg1, arg2, arg3, arg4);\n        const selection = convertRangeExToDomSelection(rangeEx);\n\n        this.setDOMSelection(selection);\n        return true;\n    }\n\n    /**\n     * Get current focused position. Return null if editor doesn't have focus at this time.\n     */\n    getFocusedPosition(): NodePosition | null {\n        const sel = this.getDocument().defaultView?.getSelection();\n        if (sel?.focusNode && this.contains(sel.focusNode)) {\n            return new Position(sel.focusNode, sel.focusOffset);\n        }\n\n        const range = this.getSelectionRange();\n        if (range) {\n            return Position.getStart(range);\n        }\n\n        return null;\n    }\n\n    /**\n     * Get an HTML element from current cursor position.\n     * When expectedTags is not specified, return value is the current node (if it is HTML element)\n     * or its parent node (if current node is a Text node).\n     * When expectedTags is specified, return value is the first ancestor of current node which has\n     * one of the expected tags.\n     * If no element found within editor by the given tag, return null.\n     * @param selector Optional, an HTML selector to find HTML element with.\n     * @param startFrom Start search from this node. If not specified, start from current focused position\n     * @param event Optional, if specified, editor will try to get cached result from the event object first.\n     * If it is not cached before, query from DOM and cache the result into the event object\n     */\n    getElementAtCursor(\n        selector?: string,\n        startFrom?: Node,\n        event?: PluginEvent\n    ): HTMLElement | null {\n        event = startFrom ? undefined : event; // Only use cache when startFrom is not specified, for different start position can have different result\n\n        return (\n            cacheGetEventData(event ?? null, 'GET_ELEMENT_AT_CURSOR_' + selector, () => {\n                if (!startFrom) {\n                    const position = this.getFocusedPosition();\n                    startFrom = position?.node;\n                }\n                return (\n                    startFrom &&\n                    findClosestElementAncestor(startFrom, this.getCore().physicalRoot, selector)\n                );\n            }) ?? null\n        );\n    }\n\n    /**\n     * Check if this position is at beginning of the editor.\n     * This will return true if all nodes between the beginning of target node and the position are empty.\n     * @param position The position to check\n     * @returns True if position is at beginning of the editor, otherwise false\n     */\n    isPositionAtBeginning(position: NodePosition): boolean {\n        return isPositionAtBeginningOf(position, this.getCore().logicalRoot);\n    }\n\n    /**\n     * Get impacted regions from selection\n     */\n    getSelectedRegions(type: RegionType | CompatibleRegionType = RegionType.Table): Region[] {\n        const selection = this.getSelectionRangeEx();\n        const result: Region[] = [];\n        const logicalRoot = this.getCore().logicalRoot;\n        selection.ranges.forEach(range => {\n            result.push(...(range ? getRegionsFromRange(logicalRoot, range, type) : []));\n        });\n        return result.filter((value, index, self) => {\n            return self.indexOf(value) === index;\n        });\n    }\n\n    //#endregion\n\n    //#region EVENT API\n\n    addDomEventHandler(\n        nameOrMap: string | Record<string, DOMEventHandler>,\n        handler?: DOMEventHandler\n    ): () => void {\n        const eventsMap = typeof nameOrMap == 'string' ? { [nameOrMap]: handler! } : nameOrMap;\n        const eventsMapResult: Record<string, DOMEventRecord> = {};\n\n        getObjectKeys(eventsMap).forEach(key => {\n            const handlerObj = eventsMap[key];\n            let result: DOMEventRecord = {\n                pluginEventType: null,\n                beforeDispatch: null,\n            };\n\n            if (typeof handlerObj === 'number') {\n                result.pluginEventType = OldEventTypeToNewEventType[handlerObj as PluginEventType];\n            } else if (typeof handlerObj === 'function') {\n                result.beforeDispatch = handlerObj;\n            } else if (typeof handlerObj === 'object') {\n                const record = handlerObj as DOMEventHandlerObject;\n                result = {\n                    beforeDispatch: record.beforeDispatch,\n                    pluginEventType:\n                        typeof record.pluginEventType == 'number'\n                            ? OldEventTypeToNewEventType[record.pluginEventType]\n                            : undefined,\n                };\n            }\n\n            eventsMapResult[key] = result;\n        });\n\n        return this.attachDomEvent(eventsMapResult);\n    }\n\n    /**\n     * Trigger an event to be dispatched to all plugins\n     * @param eventType Type of the event\n     * @param data data of the event with given type, this is the rest part of PluginEvent with the given type\n     * @param broadcast indicates if the event needs to be dispatched to all plugins\n     * True means to all, false means to allow exclusive handling from one plugin unless no one wants that\n     * @returns the event object which is really passed into plugins. Some plugin may modify the event object so\n     * the result of this function provides a chance to read the modified result\n     */\n    public triggerPluginEvent<T extends PluginEventType | CompatiblePluginEventType>(\n        eventType: T,\n        data: PluginEventData<T>,\n        broadcast: boolean = false\n    ): PluginEventFromType<T> {\n        const oldEvent = {\n            eventType,\n            ...data,\n        } as PluginEvent;\n        const newEvent = oldEventToNewEvent(oldEvent);\n        const core = this.getCore();\n\n        if (newEvent) {\n            core.api.triggerEvent(core, newEvent, broadcast);\n            return (newEventToOldEvent(newEvent, oldEvent) ?? oldEvent) as PluginEventFromType<T>;\n        } else {\n            return oldEvent as PluginEventFromType<T>;\n        }\n    }\n\n    /**\n     * Trigger a ContentChangedEvent\n     * @param source Source of this event, by default is 'SetContent'\n     * @param data additional data for this event\n     */\n    triggerContentChangedEvent(\n        source: ChangeSource | CompatibleChangeSource | string = ChangeSource.SetContent,\n        data?: any\n    ) {\n        this.triggerPluginEvent(PluginEventType.ContentChanged, {\n            source,\n            data,\n        });\n    }\n\n    //#endregion\n\n    //#region Undo API\n\n    /**\n     * Undo last edit operation\n     */\n    undo() {\n        undo(this);\n    }\n\n    /**\n     * Redo next edit operation\n     */\n    redo() {\n        redo(this);\n    }\n\n    /**\n     * Add undo snapshot, and execute a format callback function, then add another undo snapshot, then trigger\n     * ContentChangedEvent with given change source.\n     * If this function is called nested, undo snapshot will only be added in the outside one\n     * @param callback The callback function to perform formatting, returns a data object which will be used as\n     * the data field in ContentChangedEvent if changeSource is not null.\n     * @param changeSource The change source to use when fire ContentChangedEvent. When the value is not null,\n     * a ContentChangedEvent will be fired with change source equal to this value\n     * @param canUndoByBackspace True if this action can be undone when user press Backspace key (aka Auto Complete).\n     */\n    addUndoSnapshot(\n        callback?: (start: NodePosition | null, end: NodePosition | null) => any,\n        changeSource?: ChangeSource | CompatibleChangeSource | string,\n        canUndoByBackspace?: boolean,\n        additionalData?: ContentChangedData\n    ) {\n        const core = this.getCore();\n        const undoState = core.undo;\n        const isNested = undoState.isNested;\n        let data: any;\n\n        if (!isNested) {\n            undoState.isNested = true;\n\n            // When there is getEntityState, it means this is triggered by an entity change.\n            // So if HTML content is not changed (hasNewContent is false), no need to add another snapshot before change\n            if (\n                core.undo.snapshotsManager.hasNewContent ||\n                !additionalData?.getEntityState ||\n                !callback\n            ) {\n                core.api.addUndoSnapshot(\n                    core,\n                    !!canUndoByBackspace,\n                    additionalData?.getEntityState?.()\n                );\n            }\n        }\n\n        try {\n            if (callback) {\n                const selection = core.api.getDOMSelection(core);\n                const range = selection?.type == 'range' ? selection.range : null;\n                data = callback(\n                    range && Position.getStart(range).normalize(),\n                    range && Position.getEnd(range).normalize()\n                );\n\n                if (!isNested) {\n                    const entityStates = additionalData?.getEntityState?.();\n\n                    core.api.addUndoSnapshot(core, false /*isAutoCompleteSnapshot*/, entityStates);\n                }\n            }\n        } finally {\n            if (!isNested) {\n                undoState.isNested = false;\n            }\n        }\n\n        if (callback && changeSource) {\n            const event: ContentChangedEvent = {\n                eventType: PluginEventType.ContentChanged,\n                source: changeSource,\n                data: data,\n                additionalData,\n            };\n            this.triggerPluginEvent(PluginEventType.ContentChanged, event, true /*broadcast*/);\n        }\n\n        if (canUndoByBackspace) {\n            const selection = core.api.getDOMSelection(core);\n\n            if (selection?.type == 'range') {\n                core.undo.snapshotsManager.hasNewContent = false;\n                core.undo.posContainer = selection.range.startContainer;\n                core.undo.posOffset = selection.range.startOffset;\n            }\n        }\n    }\n\n    /**\n     * Whether there is an available undo/redo snapshot\n     */\n    getUndoState(): EditorUndoState {\n        const { snapshotsManager } = this.getCore().undo;\n        return {\n            canUndo:\n                snapshotsManager.hasNewContent || snapshotsManager.canMove(-1 /*previousSnapshot*/),\n            canRedo: snapshotsManager.canMove(1 /*nextSnapshot*/),\n        };\n    }\n\n    //#endregion\n\n    //#region Misc\n\n    /**\n     * Get custom data related to this editor\n     * @param key Key of the custom data\n     * @param getter Getter function. If custom data for the given key doesn't exist,\n     * call this function to get one and store it if it is specified. Otherwise return undefined\n     * @param disposer An optional disposer function to dispose this custom data when\n     * dispose editor.\n     */\n    getCustomData<T>(key: string, getter?: () => T, disposer?: (value: T) => void): T {\n        const core = this.getContentModelEditorCore();\n        return (core.customData[key] = core.customData[key] || {\n            value: getter ? getter() : undefined,\n            disposer,\n        }).value as T;\n    }\n\n    /**\n     * Get default format of this editor\n     * @returns Default format object of this editor\n     */\n    getDefaultFormat(): DefaultFormat {\n        const format = this.getCore().format.defaultFormat;\n\n        return {\n            bold: isBold(format.fontWeight),\n            italic: format.italic,\n            underline: format.underline,\n            fontFamily: format.fontFamily,\n            fontSize: format.fontSize,\n            textColor: format.textColor,\n            backgroundColor: format.backgroundColor,\n        };\n    }\n\n    /**\n     * Get a content traverser for the whole editor\n     * @param startNode The node to start from. If not passed, it will start from the beginning of the body\n     */\n    getBodyTraverser(startNode?: Node): IContentTraverser {\n        return ContentTraverser.createBodyTraverser(this.getCore().logicalRoot, startNode);\n    }\n\n    /**\n     * Get a content traverser for current selection\n     * @returns A content traverser, or null if editor never got focus before\n     */\n    getSelectionTraverser(range?: Range): IContentTraverser | null {\n        range = range ?? this.getSelectionRange() ?? undefined;\n        return range\n            ? ContentTraverser.createSelectionTraverser(this.getCore().logicalRoot, range)\n            : null;\n    }\n\n    /**\n     * Get a content traverser for current block element start from specified position\n     * @param startFrom Start position of the traverser. Default value is ContentPosition.SelectionStart\n     * @returns A content traverser, or null if editor never got focus before\n     */\n    getBlockTraverser(\n        startFrom: ContentPosition | CompatibleContentPosition = ContentPosition.SelectionStart\n    ): IContentTraverser | null {\n        const range = this.getSelectionRange();\n        return range\n            ? ContentTraverser.createBlockTraverser(this.getCore().logicalRoot, range, startFrom)\n            : null;\n    }\n\n    /**\n     * Get a text traverser of current selection\n     * @param event Optional, if specified, editor will try to get cached result from the event object first.\n     * If it is not cached before, query from DOM and cache the result into the event object\n     * @returns A content traverser, or null if editor never got focus before\n     */\n    getContentSearcherOfCursor(event?: PluginEvent): IPositionContentSearcher | null {\n        return cacheGetEventData(event ?? null, 'ContentSearcher', () => {\n            const range = this.getSelectionRange();\n            return (\n                range &&\n                new PositionContentSearcher(this.getCore().logicalRoot, Position.getStart(range))\n            );\n        });\n    }\n\n    /**\n     * Run a callback function asynchronously\n     * @param callback The callback function to run\n     * @returns a function to cancel this async run\n     */\n    runAsync(callback: (editor: ILegacyEditor & IEditor) => void) {\n        const win = this.getCore().physicalRoot.ownerDocument.defaultView || window;\n        const handle = win.requestAnimationFrame(() => {\n            if (!this.isDisposed() && callback) {\n                callback(this);\n            }\n        });\n\n        return () => {\n            win.cancelAnimationFrame(handle);\n        };\n    }\n\n    /**\n     * Set DOM attribute of editor content DIV\n     * @param name Name of the attribute\n     * @param value Value of the attribute\n     */\n    setEditorDomAttribute(name: string, value: string | null) {\n        this.getDOMHelper().setDomAttribute(name, value);\n    }\n\n    /**\n     * Get DOM attribute of editor content DIV, null if there is no such attribute.\n     * @param name Name of the attribute\n     */\n    getEditorDomAttribute(name: string): string | null {\n        return this.getDOMHelper().getDomAttribute(name);\n    }\n\n    /**\n     * @deprecated Use getVisibleViewport() instead.\n     *\n     * Get current relative distance from top-left corner of the given element to top-left corner of editor content DIV.\n     * @param element The element to calculate from. If the given element is not in editor, return value will be null\n     * @param addScroll When pass true, The return value will also add scrollLeft and scrollTop if any. So the value\n     * may be different than what user is seeing from the view. When pass false, scroll position will be ignored.\n     * @returns An [x, y] array which contains the left and top distances, or null if the given element is not in editor.\n     */\n    getRelativeDistanceToEditor(element: HTMLElement, addScroll?: boolean): number[] | null {\n        if (this.contains(element)) {\n            const physicalRoot = this.getCore().physicalRoot;\n            const editorRect = physicalRoot.getBoundingClientRect();\n            const elementRect = element.getBoundingClientRect();\n\n            if (editorRect && elementRect) {\n                let x = elementRect.left - editorRect?.left;\n                let y = elementRect.top - editorRect?.top;\n\n                if (addScroll) {\n                    x += physicalRoot.scrollLeft;\n                    y += physicalRoot.scrollTop;\n                }\n\n                return [x, y];\n            }\n        }\n\n        return null;\n    }\n\n    /**\n     * Add a Content Edit feature.\n     * @param feature The feature to add\n     */\n    addContentEditFeature(feature: GenericContentEditFeature<PluginEvent>) {\n        const core = this.getContentModelEditorCore();\n        feature?.keys.forEach(key => {\n            const array = core.edit.features[key] || [];\n            array.push(feature);\n            core.edit.features[key] = array;\n        });\n    }\n\n    /**\n     * Remove a Content Edit feature.\n     * @param feature The feature to remove\n     */\n    removeContentEditFeature(feature: GenericContentEditFeature<PluginEvent>) {\n        const core = this.getContentModelEditorCore();\n        feature?.keys.forEach(key => {\n            const featureSet = core.edit.features[key];\n            const index = featureSet?.indexOf(feature) ?? -1;\n            if (index >= 0) {\n                core.edit.features[key].splice(index, 1);\n                if (core.edit.features[key].length < 1) {\n                    delete core.edit.features[key];\n                }\n            }\n        });\n    }\n\n    /**\n     * @deprecated\n     * Get style based format state from current selection, including font name/size and colors\n     */\n    getStyleBasedFormatState(): StyleBasedFormatState {\n        const format = this.retrieveFormatState();\n\n        return {\n            backgroundColor: format.backgroundColor,\n            direction: format.direction,\n            fontName: format.fontName,\n            fontSize: format.fontSize,\n            fontWeight: format.fontWeight,\n            lineHeight: format.lineHeight,\n            marginBottom: format.marginBottom,\n            marginTop: format.marginTop,\n            textAlign: format.textAlign,\n            textColor: format.textColor,\n        };\n    }\n\n    /**\n     * @deprecated\n     * Get the pendable format such as underline and bold\n     * @returns The pending format state\n     */\n    getPendableFormatState(): PendableFormatState {\n        const format = this.retrieveFormatState();\n\n        return {\n            isBold: format.isBold,\n            isItalic: format.isItalic,\n            isStrikeThrough: format.isStrikeThrough,\n            isSubscript: format.isSubscript,\n            isSuperscript: format.isSubscript,\n            isUnderline: format.isUnderline,\n        };\n    }\n\n    /**\n     * @deprecated\n     * Ensure user will type into a container element rather than into the editor content DIV directly\n     * @param position The position that user is about to type to\n     * @param keyboardEvent Optional keyboard event object\n     */\n    ensureTypeInContainer(position: NodePosition, keyboardEvent?: KeyboardEvent) {\n        // No OP\n    }\n\n    //#endregion\n\n    //#region Dark mode APIs\n\n    /**\n     * Transform the given node and all its child nodes to dark mode color if editor is in dark mode\n     * @param node The node to transform\n     * @param direction The transform direction. @default ColorTransformDirection.LightToDark\n     */\n    transformToDarkColor(\n        node: Node,\n        direction:\n            | ColorTransformDirection\n            | CompatibleColorTransformDirection = ColorTransformDirection.LightToDark\n    ) {\n        const core = this.getCore();\n\n        if (core.lifecycle.isDarkMode) {\n            transformColor(\n                node,\n                true /*includeSelf*/,\n                direction == ColorTransformDirection.DarkToLight ? 'darkToLight' : 'lightToDark',\n                core.darkColorHandler\n            );\n        }\n    }\n\n    /**\n     * Check if the given experimental feature is enabled\n     * @param feature The feature to check\n     */\n    isFeatureEnabled(feature: ExperimentalFeatures | CompatibleExperimentalFeatures): boolean {\n        return (\n            this.getContentModelEditorCore().experimentalFeatures.indexOf(\n                feature as ExperimentalFeatures\n            ) >= 0\n        );\n    }\n\n    /**\n     * Get current zoom scale, default value is 1\n     * When editor is put under a zoomed container, need to pass the zoom scale number using EditorOptions.zoomScale\n     * to let editor behave correctly especially for those mouse drag/drop behaviors\n     * @returns current zoom scale number\n     */\n    getZoomScale(): number {\n        return this.getDOMHelper().calculateZoomScale();\n    }\n\n    /**\n     * Set current zoom scale, default value is 1\n     * When editor is put under a zoomed container, need to pass the zoom scale number using EditorOptions.zoomScale\n     * to let editor behave correctly especially for those mouse drag/drop behaviors\n     * @param scale The new scale number to set. It should be positive number and no greater than 10, otherwise it will be ignored.\n     */\n    setZoomScale(scale: number): void {\n        if (scale > 0 && scale <= 10) {\n            const oldValue = this.getZoomScale();\n\n            if (oldValue != scale) {\n                this.triggerEvent(\n                    'zoomChanged',\n                    {\n                        newZoomScale: scale,\n                    },\n                    true /*broadcast*/\n                );\n            }\n        }\n    }\n\n    /**\n     * @deprecated Use getZoomScale() instead\n     */\n    getSizeTransformer(): SizeTransformer {\n        return this.getContentModelEditorCore().sizeTransformer;\n    }\n\n    /**\n     * Get a darkColorHandler object for this editor.\n     */\n    getDarkColorHandler(): DarkColorHandler {\n        const core = this.getContentModelEditorCore();\n        return core.darkColorHandler;\n    }\n\n    /**\n     * Check if editor is in IME input sequence\n     * @returns True if editor is in IME input sequence, otherwise false\n     */\n    isInIME(): boolean {\n        return this.getCore().domEvent.isInIME;\n    }\n\n    private retrieveFormatState(): ContentModelFormatState {\n        const pendingFormat = this.getPendingFormat();\n        const result: ContentModelFormatState = {};\n        const model = this.getContentModelCopy('reduced');\n\n        retrieveModelFormatState(model, pendingFormat, result);\n\n        return result;\n    }\n\n    /**\n     * @returns the current EditorAdapterCore object\n     * @throws a standard Error if there's no core object\n     */\n    private getContentModelEditorCore(): EditorAdapterCore {\n        if (!this.contentModelEditorCore) {\n            throw new Error('Editor is already disposed');\n        }\n\n        return this.contentModelEditorCore;\n    }\n}\n","import { createRange, safeInstanceOf } from 'roosterjs-editor-dom';\nimport { SelectionRangeTypes } from 'roosterjs-editor-types';\nimport type {\n    NodePosition,\n    PositionType,\n    SelectionPath,\n    SelectionRangeEx,\n    TableSelection,\n} from 'roosterjs-editor-types';\n\n/**\n * @internal\n */\nexport function buildRangeEx(\n    root: HTMLElement,\n    arg1: Range | SelectionRangeEx | NodePosition | Node | SelectionPath | null,\n    arg2?: NodePosition | number | PositionType | TableSelection | null,\n    arg3?: Node,\n    arg4?: number | PositionType\n): SelectionRangeEx {\n    let rangeEx: SelectionRangeEx | null = null;\n\n    if (isSelectionRangeEx(arg1)) {\n        rangeEx = arg1;\n    } else if (safeInstanceOf(arg1, 'HTMLTableElement') && isTableSelectionOrNull(arg2)) {\n        rangeEx = {\n            type: SelectionRangeTypes.TableSelection,\n            ranges: [],\n            areAllCollapsed: false,\n            table: arg1,\n            coordinates: arg2 ?? undefined,\n        };\n    } else if (safeInstanceOf(arg1, 'HTMLImageElement') && typeof arg2 == 'undefined') {\n        rangeEx = {\n            type: SelectionRangeTypes.ImageSelection,\n            ranges: [],\n            areAllCollapsed: false,\n            image: arg1,\n        };\n    } else {\n        const range = !arg1\n            ? null\n            : safeInstanceOf(arg1, 'Range')\n            ? arg1\n            : isSelectionPath(arg1)\n            ? createRange(root, arg1.start, arg1.end)\n            : isNodePosition(arg1) || safeInstanceOf(arg1, 'Node')\n            ? createRange(\n                  <Node>arg1,\n                  <number | PositionType>arg2,\n                  <Node>arg3,\n                  <number | PositionType>arg4\n              )\n            : null;\n\n        rangeEx = range\n            ? {\n                  type: SelectionRangeTypes.Normal,\n                  ranges: [range],\n                  areAllCollapsed: range.collapsed,\n              }\n            : {\n                  type: SelectionRangeTypes.Normal,\n                  ranges: [],\n                  areAllCollapsed: true,\n              };\n    }\n\n    return rangeEx;\n}\n\nfunction isSelectionRangeEx(obj: any): obj is SelectionRangeEx {\n    const rangeEx = obj as SelectionRangeEx;\n    return (\n        rangeEx &&\n        typeof rangeEx == 'object' &&\n        typeof rangeEx.type == 'number' &&\n        Array.isArray(rangeEx.ranges)\n    );\n}\n\nfunction isTableSelectionOrNull(obj: any): obj is TableSelection | null {\n    const selection = obj as TableSelection | null;\n\n    return (\n        selection === null ||\n        (selection &&\n            typeof selection == 'object' &&\n            typeof selection.firstCell == 'object' &&\n            typeof selection.lastCell == 'object')\n    );\n}\n\nfunction isSelectionPath(obj: any): obj is SelectionPath {\n    const path = obj as SelectionPath;\n\n    return path && typeof path == 'object' && Array.isArray(path.start) && Array.isArray(path.end);\n}\n\nfunction isNodePosition(obj: any): obj is NodePosition {\n    const pos = obj as NodePosition;\n\n    return (\n        pos &&\n        typeof pos == 'object' &&\n        typeof pos.node == 'object' &&\n        typeof pos.offset == 'number'\n    );\n}\n","import { convertDomSelectionToRangeEx, convertRangeExToDomSelection } from './selectionConverter';\nimport { createDefaultHtmlSanitizerOptions } from 'roosterjs-editor-dom';\nimport type { BeforePasteAdapterEvent } from '../../publicTypes/BeforePasteAdapterEvent';\nimport {\n    KnownAnnounceStrings as OldKnownAnnounceStrings,\n    PasteType as OldPasteType,\n    EntityOperation as OldEntityOperation,\n    PluginEventType,\n} from 'roosterjs-editor-types';\nimport type {\n    PluginEvent as OldEvent,\n    AnnounceData as OldAnnounceData,\n} from 'roosterjs-editor-types';\nimport type {\n    PluginEvent as NewEvent,\n    PasteType as NewPasteType,\n    AnnounceData as NewAnnounceData,\n    KnownAnnounceStrings as NewKnownAnnounceStrings,\n    EntityOperation as NewEntityOperation,\n    PluginEventType as NewPluginEventType,\n} from 'roosterjs-content-model-types';\n\nconst PasteTypeNewToOld: Record<NewPasteType, OldPasteType> = {\n    asImage: OldPasteType.AsImage,\n    asPlainText: OldPasteType.AsPlainText,\n    mergeFormat: OldPasteType.MergeFormat,\n    normal: OldPasteType.Normal,\n};\n\nconst PasteTypeOldToNew: Record<OldPasteType, NewPasteType> = {\n    [OldPasteType.AsImage]: 'asImage',\n    [OldPasteType.AsPlainText]: 'asPlainText',\n    [OldPasteType.MergeFormat]: 'mergeFormat',\n    [OldPasteType.Normal]: 'normal',\n};\n\nconst KnownAnnounceStringsOldToNew: Record<OldKnownAnnounceStrings, NewKnownAnnounceStrings> = {\n    [OldKnownAnnounceStrings.AnnounceListItemBullet]: 'announceListItemBullet',\n    [OldKnownAnnounceStrings.AnnounceListItemNumbering]: 'announceListItemNumbering',\n    [OldKnownAnnounceStrings.AnnounceOnFocusLastCell]: 'announceOnFocusLastCell',\n};\n\nconst KnownAnnounceStringsNewToOld: Record<NewKnownAnnounceStrings, OldKnownAnnounceStrings> = {\n    announceListItemBullet: OldKnownAnnounceStrings.AnnounceListItemBullet,\n    announceListItemNumbering: OldKnownAnnounceStrings.AnnounceListItemNumbering,\n    announceOnFocusLastCell: OldKnownAnnounceStrings.AnnounceOnFocusLastCell,\n};\n\nconst EntityOperationOldToNew: Record<OldEntityOperation, NewEntityOperation | undefined> = {\n    [OldEntityOperation.NewEntity]: 'newEntity',\n    [OldEntityOperation.Overwrite]: 'overwrite',\n    [OldEntityOperation.RemoveFromEnd]: 'removeFromEnd',\n    [OldEntityOperation.RemoveFromStart]: 'removeFromStart',\n    [OldEntityOperation.ReplaceTemporaryContent]: 'replaceTemporaryContent',\n    [OldEntityOperation.UpdateEntityState]: 'updateEntityState',\n    [OldEntityOperation.Click]: 'click',\n    [OldEntityOperation.ContextMenu]: undefined,\n    [OldEntityOperation.Escape]: undefined,\n    [OldEntityOperation.PartialOverwrite]: undefined,\n    [OldEntityOperation.AddShadowRoot]: undefined,\n    [OldEntityOperation.RemoveShadowRoot]: undefined,\n};\n\nconst EntityOperationNewToOld: Record<NewEntityOperation, OldEntityOperation> = {\n    newEntity: OldEntityOperation.NewEntity,\n    overwrite: OldEntityOperation.Overwrite,\n    removeFromEnd: OldEntityOperation.RemoveFromEnd,\n    removeFromStart: OldEntityOperation.RemoveFromStart,\n    replaceTemporaryContent: OldEntityOperation.ReplaceTemporaryContent,\n    updateEntityState: OldEntityOperation.UpdateEntityState,\n    click: OldEntityOperation.Click,\n};\n\n/**\n * @internal\n */\nexport const OldEventTypeToNewEventType: Record<PluginEventType, NewPluginEventType | undefined> = {\n    [PluginEventType.BeforeCutCopy]: 'beforeCutCopy',\n    [PluginEventType.BeforeDispose]: 'beforeDispose',\n    [PluginEventType.BeforeKeyboardEditing]: 'beforeKeyboardEditing',\n    [PluginEventType.BeforePaste]: 'beforePaste',\n    [PluginEventType.BeforeSetContent]: 'beforeSetContent',\n    [PluginEventType.CompositionEnd]: 'compositionEnd',\n    [PluginEventType.ContentChanged]: 'contentChanged',\n    [PluginEventType.ContextMenu]: 'contextMenu',\n    [PluginEventType.EditImage]: 'editImage',\n    [PluginEventType.EditorReady]: 'editorReady',\n    [PluginEventType.EnteredShadowEdit]: 'enteredShadowEdit',\n    [PluginEventType.EntityOperation]: 'entityOperation',\n    [PluginEventType.ExtractContentWithDom]: 'extractContentWithDom',\n    [PluginEventType.Input]: 'input',\n    [PluginEventType.KeyDown]: 'keyDown',\n    [PluginEventType.KeyPress]: 'keyPress',\n    [PluginEventType.KeyUp]: 'keyUp',\n    [PluginEventType.LeavingShadowEdit]: 'leavingShadowEdit',\n    [PluginEventType.MouseDown]: 'mouseDown',\n    [PluginEventType.MouseUp]: 'mouseUp',\n    [PluginEventType.PendingFormatStateChanged]: undefined,\n    [PluginEventType.Scroll]: 'scroll',\n    [PluginEventType.SelectionChanged]: 'selectionChanged',\n    [PluginEventType.ZoomChanged]: 'zoomChanged',\n};\n\n/**\n * @internal Convert legacy event object to new event object\n */\nexport function oldEventToNewEvent<TOldEvent extends OldEvent>(\n    input: TOldEvent,\n    refEvent?: NewEvent\n): NewEvent | undefined {\n    switch (input.eventType) {\n        case PluginEventType.BeforeCutCopy:\n            return {\n                eventType: 'beforeCutCopy',\n                clonedRoot: input.clonedRoot,\n                eventDataCache: input.eventDataCache,\n                isCut: input.isCut,\n                range: input.range,\n                rawEvent: input.rawEvent,\n            };\n\n        case PluginEventType.BeforeDispose:\n            return {\n                eventType: 'beforeDispose',\n                eventDataCache: input.eventDataCache,\n            };\n\n        case PluginEventType.BeforeKeyboardEditing:\n            return {\n                eventType: 'beforeKeyboardEditing',\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n            };\n\n        case PluginEventType.BeforePaste:\n            const refBeforePasteEvent = refEvent?.eventType == 'beforePaste' ? refEvent : undefined;\n            const cmBeforePasteEvent = input as BeforePasteAdapterEvent;\n\n            return {\n                eventType: 'beforePaste',\n                clipboardData: input.clipboardData,\n                customizedMerge:\n                    cmBeforePasteEvent.customizedMerge ?? refBeforePasteEvent?.customizedMerge,\n                domToModelOption: cmBeforePasteEvent.domToModelOption ??\n                    refBeforePasteEvent?.domToModelOption ?? {\n                        additionalAllowedTags: [],\n                        additionalDisallowedTags: [],\n                        additionalFormatParsers: {},\n                        formatParserOverride: {},\n                        processorOverride: {},\n                        styleSanitizers: {},\n                        attributeSanitizers: {},\n                    },\n                eventDataCache: input.eventDataCache,\n                fragment: input.fragment,\n                htmlAfter: input.htmlAfter,\n                htmlAttributes: input.htmlAttributes,\n                htmlBefore: input.htmlBefore,\n                pasteType: PasteTypeOldToNew[input.pasteType],\n            };\n\n        case PluginEventType.BeforeSetContent:\n            return {\n                eventType: 'beforeSetContent',\n                eventDataCache: input.eventDataCache,\n                newContent: input.newContent,\n            };\n\n        case PluginEventType.CompositionEnd:\n            return {\n                eventType: 'compositionEnd',\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n            };\n\n        case PluginEventType.ContentChanged:\n            const refContentChangedEvent =\n                refEvent?.eventType == 'contentChanged' ? refEvent : undefined;\n            return {\n                eventType: 'contentChanged',\n                eventDataCache: input.eventDataCache,\n                changedEntities: refContentChangedEvent?.changedEntities,\n                contentModel: refContentChangedEvent?.contentModel,\n                data: input.data,\n                entityStates:\n                    input.additionalData?.getEntityState?.() ??\n                    refContentChangedEvent?.entityStates,\n                selection: refContentChangedEvent?.selection,\n                source: input.source,\n                formatApiName:\n                    input.additionalData?.formatApiName ?? refContentChangedEvent?.formatApiName,\n                announceData:\n                    announceDataOldToNew(input.additionalData?.getAnnounceData?.()) ??\n                    refContentChangedEvent?.announceData,\n            };\n\n        case PluginEventType.ContextMenu:\n            return {\n                eventType: 'contextMenu',\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n                items: input.items,\n            };\n\n        case PluginEventType.EditImage:\n            return {\n                eventType: 'editImage',\n                eventDataCache: input.eventDataCache,\n                image: input.image,\n                newSrc: input.newSrc,\n                originalSrc: input.originalSrc,\n                previousSrc: input.previousSrc,\n            };\n\n        case PluginEventType.EditorReady:\n            return {\n                eventType: 'editorReady',\n                eventDataCache: input.eventDataCache,\n            };\n\n        case PluginEventType.EnteredShadowEdit:\n            return {\n                eventType: 'enteredShadowEdit',\n                eventDataCache: input.eventDataCache,\n            };\n\n        case PluginEventType.EntityOperation:\n            const operation = EntityOperationOldToNew[input.operation];\n\n            return operation === undefined\n                ? undefined\n                : {\n                      eventType: 'entityOperation',\n                      eventDataCache: input.eventDataCache,\n                      rawEvent: input.rawEvent,\n                      entity: input.entity,\n                      operation: operation,\n                      shouldPersist: input.shouldPersist,\n                      state: input.state,\n                  };\n\n        case PluginEventType.ExtractContentWithDom:\n            return {\n                eventType: 'extractContentWithDom',\n                eventDataCache: input.eventDataCache,\n                clonedRoot: input.clonedRoot,\n            };\n\n        case PluginEventType.Input:\n            return {\n                eventType: 'input',\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n            };\n\n        case PluginEventType.KeyDown:\n        case PluginEventType.KeyPress:\n        case PluginEventType.KeyUp:\n            return {\n                eventType:\n                    input.eventType == PluginEventType.KeyDown\n                        ? 'keyDown'\n                        : input.eventType == PluginEventType.KeyPress\n                        ? 'keyPress'\n                        : 'keyUp',\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n            };\n\n        case PluginEventType.LeavingShadowEdit:\n            return {\n                eventType: 'leavingShadowEdit',\n                eventDataCache: input.eventDataCache,\n            };\n\n        case PluginEventType.MouseDown:\n            return {\n                eventType: 'mouseDown',\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n            };\n\n        case PluginEventType.MouseUp:\n            return {\n                eventType: 'mouseUp',\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n                isClicking: input.isClicking,\n            };\n\n        case PluginEventType.Scroll:\n            return {\n                eventType: 'scroll',\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n                scrollContainer: input.scrollContainer,\n            };\n\n        case PluginEventType.SelectionChanged:\n            const refSelectionChangedEvent =\n                refEvent?.eventType == 'selectionChanged' ? refEvent : undefined;\n\n            return {\n                eventType: 'selectionChanged',\n                eventDataCache: input.eventDataCache,\n                newSelection:\n                    refSelectionChangedEvent?.newSelection ??\n                    convertRangeExToDomSelection(input.selectionRangeEx),\n            };\n\n        case PluginEventType.ZoomChanged:\n            return {\n                eventType: 'zoomChanged',\n                eventDataCache: input.eventDataCache,\n                newZoomScale: input.newZoomScale,\n            };\n\n        default:\n            return undefined;\n    }\n}\n\n/**\n * @internal Convert new event object to legacy event object\n */\nexport function newEventToOldEvent(input: NewEvent, refEvent?: OldEvent): OldEvent | undefined {\n    switch (input.eventType) {\n        case 'beforeCutCopy':\n            return {\n                eventType: PluginEventType.BeforeCutCopy,\n                clonedRoot: input.clonedRoot,\n                eventDataCache: input.eventDataCache,\n                isCut: input.isCut,\n                range: input.range,\n                rawEvent: input.rawEvent,\n            };\n\n        case 'beforeDispose':\n            return {\n                eventType: PluginEventType.BeforeDispose,\n                eventDataCache: input.eventDataCache,\n            };\n\n        case 'beforeKeyboardEditing':\n            return {\n                eventType: PluginEventType.BeforeKeyboardEditing,\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n            };\n\n        case 'beforePaste':\n            const refBeforePasteEvent =\n                refEvent?.eventType == PluginEventType.BeforePaste ? refEvent : undefined;\n\n            const oldBeforePasteEvent: BeforePasteAdapterEvent = {\n                eventType: PluginEventType.BeforePaste,\n                clipboardData: input.clipboardData,\n                eventDataCache: input.eventDataCache,\n                fragment: input.fragment,\n                htmlAfter: input.htmlAfter,\n                htmlAttributes: input.htmlAttributes,\n                htmlBefore: input.htmlBefore,\n                pasteType: PasteTypeNewToOld[input.pasteType],\n                sanitizingOption:\n                    refBeforePasteEvent?.sanitizingOption ?? createDefaultHtmlSanitizerOptions(),\n                domToModelOption: input.domToModelOption,\n                customizedMerge: input.customizedMerge,\n            };\n\n            return oldBeforePasteEvent;\n\n        case 'beforeSetContent':\n            return {\n                eventType: PluginEventType.BeforeSetContent,\n                eventDataCache: input.eventDataCache,\n                newContent: input.newContent,\n            };\n\n        case 'compositionEnd':\n            return {\n                eventType: PluginEventType.CompositionEnd,\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n            };\n\n        case 'contentChanged':\n            const entityStates = input.entityStates;\n\n            return {\n                eventType: PluginEventType.ContentChanged,\n                eventDataCache: input.eventDataCache,\n                data: input.data,\n                source: input.source,\n                additionalData: {\n                    formatApiName: input.formatApiName,\n                    getAnnounceData: input.announceData\n                        ? () => announceDataNewToOld(input.announceData)\n                        : undefined,\n                    getEntityState: entityStates ? () => entityStates : undefined,\n                },\n            };\n\n        case 'contextMenu':\n            return {\n                eventType: PluginEventType.ContextMenu,\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n                items: input.items,\n            };\n\n        case 'editImage':\n            return {\n                eventType: PluginEventType.EditImage,\n                eventDataCache: input.eventDataCache,\n                image: input.image,\n                newSrc: input.newSrc,\n                originalSrc: input.originalSrc,\n                previousSrc: input.previousSrc,\n            };\n\n        case 'editorReady':\n            return {\n                eventType: PluginEventType.EditorReady,\n                eventDataCache: input.eventDataCache,\n            };\n\n        case 'enteredShadowEdit':\n            const refEnteredShadowEditEvent =\n                refEvent?.eventType == PluginEventType.EnteredShadowEdit ? refEvent : undefined;\n\n            return {\n                eventType: PluginEventType.EnteredShadowEdit,\n                eventDataCache: input.eventDataCache,\n                fragment: refEnteredShadowEditEvent?.fragment ?? document.createDocumentFragment(),\n                selectionPath: refEnteredShadowEditEvent?.selectionPath ?? {\n                    end: [],\n                    start: [],\n                },\n            };\n\n        case 'entityOperation':\n            return {\n                eventType: PluginEventType.EntityOperation,\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n                entity: input.entity,\n                operation: EntityOperationNewToOld[input.operation],\n                shouldPersist: input.shouldPersist,\n                state: input.state,\n            };\n\n        case 'extractContentWithDom':\n            return {\n                eventType: PluginEventType.ExtractContentWithDom,\n                eventDataCache: input.eventDataCache,\n                clonedRoot: input.clonedRoot,\n            };\n\n        case 'input':\n            return {\n                eventType: PluginEventType.Input,\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n            };\n\n        case 'keyDown':\n        case 'keyPress':\n        case 'keyUp':\n            return {\n                eventType:\n                    input.eventType == 'keyDown'\n                        ? PluginEventType.KeyDown\n                        : input.eventType == 'keyPress'\n                        ? PluginEventType.KeyPress\n                        : PluginEventType.KeyUp,\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n            };\n\n        case 'leavingShadowEdit':\n            return {\n                eventType: PluginEventType.LeavingShadowEdit,\n                eventDataCache: input.eventDataCache,\n            };\n\n        case 'mouseDown':\n            return {\n                eventType: PluginEventType.MouseDown,\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n            };\n\n        case 'mouseUp':\n            return {\n                eventType: PluginEventType.MouseUp,\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n                isClicking: input.isClicking,\n            };\n\n        case 'scroll':\n            return {\n                eventType: PluginEventType.Scroll,\n                eventDataCache: input.eventDataCache,\n                rawEvent: input.rawEvent,\n                scrollContainer: input.scrollContainer,\n            };\n\n        case 'selectionChanged':\n            const refSelectionChangedEvent =\n                refEvent?.eventType == PluginEventType.SelectionChanged ? refEvent : undefined;\n\n            return {\n                eventType: PluginEventType.SelectionChanged,\n                eventDataCache: input.eventDataCache,\n                selectionRangeEx:\n                    refSelectionChangedEvent?.selectionRangeEx ??\n                    convertDomSelectionToRangeEx(input.newSelection),\n            };\n\n        case 'zoomChanged':\n            return {\n                eventType: PluginEventType.ZoomChanged,\n                eventDataCache: input.eventDataCache,\n                newZoomScale: input.newZoomScale,\n                oldZoomScale:\n                    refEvent?.eventType == PluginEventType.ZoomChanged ? refEvent.oldZoomScale : 1, // In new ZoomChangedEvent we don't really have oldZoomScale. So if we can't get it, just use 1 instead\n            };\n\n        default:\n            return undefined;\n    }\n}\n\nfunction announceDataOldToNew(data: OldAnnounceData | undefined): NewAnnounceData | undefined {\n    return data\n        ? {\n              defaultStrings: data.defaultStrings\n                  ? KnownAnnounceStringsOldToNew[data.defaultStrings]\n                  : undefined,\n              formatStrings: data.formatStrings,\n              text: data.text,\n          }\n        : undefined;\n}\n\nfunction announceDataNewToOld(data: NewAnnounceData | undefined): OldAnnounceData | undefined {\n    return data\n        ? {\n              defaultStrings: data.defaultStrings\n                  ? KnownAnnounceStringsNewToOld[data.defaultStrings]\n                  : undefined,\n              formatStrings: data.formatStrings,\n              text: data.text,\n          }\n        : undefined;\n}\n","import { ContentPosition, NodeType, PositionType, RegionType } from 'roosterjs-editor-types';\nimport type { BlockElement, InsertOption, NodePosition } from 'roosterjs-editor-types';\nimport {\n    createRange,\n    getBlockElementAtNode,\n    getFirstLastBlockElement,\n    isBlockElement,\n    isVoidHtmlElement,\n    Position,\n    safeInstanceOf,\n    toArray,\n    wrap,\n    adjustInsertPosition,\n    getRegionsFromRange,\n    splitTextNode,\n    splitParentNode,\n} from 'roosterjs-editor-dom';\nimport type { DOMSelection } from 'roosterjs-content-model-types';\n\nfunction getInitialRange(\n    selection: DOMSelection | null,\n    option: InsertOption\n): { range: Range | null; rangeToRestore: Range | null } {\n    // Selection start replaces based on the current selection.\n    // Range inserts based on a provided range.\n    // Both have the potential to use the current selection to restore cursor position\n    // So in both cases we need to store the selection state.\n    let range = selection?.type == 'range' ? selection.range : null;\n    let rangeToRestore = null;\n\n    if (option.position == ContentPosition.Range) {\n        rangeToRestore = range;\n        range = option.range;\n    } else if (range) {\n        rangeToRestore = range.cloneRange();\n    }\n\n    return { range, rangeToRestore };\n}\n\n/**\n * @internal\n * Insert a DOM node into editor content\n */\nexport function insertNode(\n    contentDiv: HTMLDivElement,\n    selection: DOMSelection | null,\n    node: Node,\n    option: InsertOption\n): DOMSelection | undefined {\n    switch (option.position) {\n        case ContentPosition.Begin:\n        case ContentPosition.End: {\n            const isBegin = option.position == ContentPosition.Begin;\n            const block = getFirstLastBlockElement(contentDiv, isBegin);\n            let insertedNode: Node | Node[] | undefined;\n            if (block) {\n                const refNode = isBegin ? block.getStartNode() : block.getEndNode();\n                if (\n                    option.insertOnNewLine ||\n                    refNode.nodeType == NodeType.Text ||\n                    isVoidHtmlElement(refNode)\n                ) {\n                    // For insert on new line, or refNode is text or void html element (HR, BR etc.)\n                    // which cannot have children, i.e. <div>hello<br>world</div>. 'hello', 'world' are the\n                    // first and last node. Insert before 'hello' or after 'world', but still inside DIV\n                    if (safeInstanceOf(node, 'DocumentFragment')) {\n                        // if the node to be inserted is DocumentFragment, use its childNodes as insertedNode\n                        // because insertBefore() returns an empty DocumentFragment\n                        insertedNode = toArray(node.childNodes);\n                        refNode.parentNode?.insertBefore(\n                            node,\n                            isBegin ? refNode : refNode.nextSibling\n                        );\n                    } else {\n                        insertedNode = refNode.parentNode?.insertBefore(\n                            node,\n                            isBegin ? refNode : refNode.nextSibling\n                        );\n                    }\n                } else {\n                    // if the refNode can have child, use appendChild (which is like to insert as first/last child)\n                    // i.e. <div>hello</div>, the content will be inserted before/after hello\n                    insertedNode = refNode.insertBefore(node, isBegin ? refNode.firstChild : null);\n                }\n            } else {\n                // No first block, this can happen when editor is empty. Use appendChild to insert the content in contentDiv\n                insertedNode = contentDiv.appendChild(node);\n            }\n\n            // Final check to see if the inserted node is a block. If not block and the ask is to insert on new line,\n            // add a DIV wrapping\n            if (insertedNode && option.insertOnNewLine) {\n                const nodes = Array.isArray(insertedNode) ? insertedNode : [insertedNode];\n                if (!isBlockElement(nodes[0]) || !isBlockElement(nodes[nodes.length - 1])) {\n                    wrap(nodes);\n                }\n            }\n\n            break;\n        }\n        case ContentPosition.DomEnd:\n            // Use appendChild to insert the node at the end of the content div.\n            const insertedNode = contentDiv.appendChild(node);\n            // Final check to see if the inserted node is a block. If not block and the ask is to insert on new line,\n            // add a DIV wrapping\n            if (insertedNode && option.insertOnNewLine && !isBlockElement(insertedNode)) {\n                wrap(insertedNode);\n            }\n            break;\n        case ContentPosition.Range:\n        case ContentPosition.SelectionStart:\n            let { range, rangeToRestore } = getInitialRange(selection, option);\n            if (!range) {\n                break;\n            }\n\n            // if to replace the selection and the selection is not collapsed, remove the the content at selection first\n            if (option.replaceSelection && !range.collapsed) {\n                range.deleteContents();\n            }\n\n            let pos: NodePosition = Position.getStart(range);\n            let blockElement: BlockElement | null;\n\n            if (option.insertOnNewLine && option.insertToRegionRoot) {\n                pos = adjustInsertPositionRegionRoot(contentDiv, range, pos);\n            } else if (\n                option.insertOnNewLine &&\n                (blockElement = getBlockElementAtNode(contentDiv, pos.normalize().node))\n            ) {\n                pos = adjustInsertPositionNewLine(blockElement, contentDiv, pos);\n            } else {\n                pos = adjustInsertPosition(contentDiv, node, pos, range);\n            }\n\n            const nodeForCursor =\n                node.nodeType == NodeType.DocumentFragment ? node.lastChild : node;\n\n            range = createRange(pos);\n            range.insertNode(node);\n\n            if (option.updateCursor && nodeForCursor) {\n                rangeToRestore = createRange(\n                    new Position(nodeForCursor, PositionType.After).normalize()\n                );\n            }\n\n            return rangeToRestore\n                ? {\n                      type: 'range',\n                      range: rangeToRestore,\n                      isReverted: false,\n                  }\n                : undefined;\n    }\n}\n\nfunction adjustInsertPositionRegionRoot(\n    contentDiv: HTMLDivElement,\n    range: Range,\n    position: NodePosition\n) {\n    const region = getRegionsFromRange(contentDiv, range, RegionType.Table)[0];\n    let node: Node | null = position.node;\n\n    if (region) {\n        if (node.nodeType == NodeType.Text && !position.isAtEnd) {\n            node = splitTextNode(node as Text, position.offset, true /*returnFirstPart*/);\n        }\n\n        if (node != region.rootNode) {\n            while (node && node.parentNode != region.rootNode) {\n                splitParentNode(node, false /*splitBefore*/);\n                node = node.parentNode;\n            }\n        }\n\n        if (node) {\n            position = new Position(node, PositionType.After);\n        }\n    }\n\n    return position;\n}\n\nfunction adjustInsertPositionNewLine(\n    blockElement: BlockElement,\n    contentDiv: HTMLDivElement,\n    pos: Position\n) {\n    let tempPos = new Position(blockElement.getEndNode(), PositionType.After);\n    if (safeInstanceOf(tempPos.node, 'HTMLTableRowElement')) {\n        const div = contentDiv.ownerDocument.createElement('div');\n        const range = createRange(pos);\n        range.insertNode(div);\n        tempPos = new Position(div, PositionType.Begin);\n    }\n    return tempPos;\n}\n","import { createRange } from 'roosterjs-editor-dom';\nimport { createTableRanges } from 'roosterjs-content-model-core';\nimport { SelectionRangeTypes } from 'roosterjs-editor-types';\nimport type { DOMSelection } from 'roosterjs-content-model-types';\nimport type { SelectionRangeEx } from 'roosterjs-editor-types';\n\n// In theory, all functions below are not necessary. We keep these functions here only for compatibility with old IEditor interface\n\n/**\n * @internal\n */\nexport function convertRangeExToDomSelection(\n    rangeEx: SelectionRangeEx | null\n): DOMSelection | null {\n    switch (rangeEx?.type) {\n        case SelectionRangeTypes.ImageSelection:\n            return {\n                type: 'image',\n                image: rangeEx.image,\n            };\n\n        case SelectionRangeTypes.Normal:\n            return rangeEx.ranges.length > 0\n                ? {\n                      type: 'range',\n                      range: rangeEx.ranges[0],\n                      isReverted: false,\n                  }\n                : null;\n\n        case SelectionRangeTypes.TableSelection:\n            return rangeEx.coordinates\n                ? {\n                      type: 'table',\n                      table: rangeEx.table,\n                      firstColumn: rangeEx.coordinates.firstCell.x,\n                      firstRow: rangeEx.coordinates.firstCell.y,\n                      lastColumn: rangeEx.coordinates.lastCell.x,\n                      lastRow: rangeEx.coordinates.lastCell.y,\n                  }\n                : null;\n\n        default:\n            return null;\n    }\n}\n\n/**\n * @internal\n */\nexport function convertDomSelectionToRangeEx(selection: DOMSelection | null): SelectionRangeEx {\n    switch (selection?.type) {\n        case 'image':\n            return {\n                type: SelectionRangeTypes.ImageSelection,\n                image: selection.image,\n                areAllCollapsed: false,\n                ranges: [createRange(selection.image)],\n            };\n\n        case 'range':\n            return {\n                type: SelectionRangeTypes.Normal,\n                ranges: [selection.range],\n                areAllCollapsed: selection.range.collapsed,\n            };\n\n        case 'table':\n            return {\n                type: SelectionRangeTypes.TableSelection,\n                ranges: createTableRanges(selection),\n                areAllCollapsed: false,\n                table: selection.table,\n                coordinates: {\n                    firstCell: { x: selection.firstColumn, y: selection.firstRow },\n                    lastCell: { x: selection.lastColumn, y: selection.lastRow },\n                },\n            };\n\n        default:\n            return {\n                type: SelectionRangeTypes.Normal,\n                ranges: [],\n                areAllCollapsed: true,\n            };\n    }\n}\n","export { EditorAdapterOptions } from './publicTypes/EditorAdapterOptions';\nexport { BeforePasteAdapterEvent } from './publicTypes/BeforePasteAdapterEvent';\n\nexport { EditorAdapter } from './editor/EditorAdapter';\n","module.exports = \"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSItOCAtOCAzMiAzMiIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPgogICAgPHRpdGxlPkZvcm1hdCBwYWludGVyPC90aXRsZT4KICAgIDxnIGlkPSJmb3JtYXRwYWludGVyMTYtZmlsbGVkIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iaW5zZXJ0aW9uLXBvaW50IiBmaWxsPSIjMDAwMDAwIj4KICAgICAgICAgIDxwYXRoIGQ9Ik0tMywwIEwwLDAgTDAsMSBMLTMsMSBaIj48L3BhdGg+CiAgICAgICAgICA8cGF0aCBkPSJNMSwwIEw0LDAgTDQsMSBMMSwxIFoiPjwvcGF0aD4KICAgICAgICAgIDxwYXRoIGQ9Ik0wLDEgTDEsMSBMMSwxNSBMMCwxNSBaIj48L3BhdGg+CiAgICAgICAgICA8cGF0aCBkPSJNLTMsMTUgTDAsMTUgTDAsMTYgTC0zLDE2IFoiPjwvcGF0aD4KICAgICAgICAgIDxwYXRoIGQ9Ik0xLDE1IEw0LDE1IEw0LDE2IEwxLDE2IFoiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICAgICAgPGcgaWQ9ImJydXNoIj4KICAgICAgICAgICAgPHBvbHlnb24gaWQ9IlBhdGgtMiIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIiBwb2ludHM9IjEuNTc5MDQwNzggOC42MzcwNTIwMSA4LjM0MDQ2MDAxIDE2LjA0MTc4OCAxNC41NjM2MiAxMC42NTA5NDEyIDE1LjE2NTM0MjYgOC42MzcwNTIwMSAxMy4xMDQ0OTkgNi43ODAxMDU5MSAxNy4zNDA0NjMgMi4wMTIyMDc2MiAxNS44ODU1MjI5IDAuNjYxMDM4NjY3IDExLjM3NzM3NDEgNC45MjQzMzkwNCA5LjQ1OTc1MTkgMi45Njk1MTc4OSI+PC9wb2x5Z29uPgogICAgICAgICAgICA8ZyBpZD0iR3JvdXAtMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNy4wMDAwMDAsIDAuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOS40NjIyLDIuNDk3NzcyNzMgQzkuNTA4NCwyLjQ0ODEzNjM2IDkuNTM1OSwyLjM5OTY4MTgyIDkuNTQ4LDIuMzUwMDQ1NDUgQzkuNTYwMSwyLjMwMDQwOTA5IDkuNTY1NiwyLjI2MDIyNzI3IDkuNTY1NiwyLjIyOTUgQzkuNTY1NiwyLjE5OTk1NDU1IDkuNTYwMSwyLjE1ODU5MDkxIDkuNTQ4LDIuMTEwMTM2MzYgQzkuNTMwNCwyLjA1NDU5MDkxIDkuNDk5NiwyLjAwMjU5MDkxIDkuNDUzNCwxLjk1Mjk1NDU1IEw5LjA0MDksMS41MDAzMTgxOCBDOC45NjA2LDEuNDI3MDQ1NDUgOC44NzQ4LDEuMzkwNDA5MDkgOC43ODM1LDEuMzkwNDA5MDkgQzguNjgwMSwxLjM5MDQwOTA5IDguNTk0MywxLjQyNzA0NTQ1IDguNTI1LDEuNTAwMzE4MTggTDQuNTgxNSw1Ljc0Nzc3MjczIEwyLjczMzUsMy43NjIzMTgxOCBDMi42NjQyLDMuNjg5MDQ1NDUgMi41Nzg0LDMuNjUyNDA5MDkgMi40NzUsMy42NTI0MDkwOSBDMi4zNzgyLDMuNjUyNDA5MDkgMi4yOTQ2LDMuNjg5MDQ1NDUgMi4yMjY0LDMuNzYyMzE4MTggTDEuNTM4OSw0LjUwMDk1NDU1IEw2Ljc5OCwxMC4zMzY3NzI3IEw3LjQ2MDIsOS42MjUzMTgxOCBDNy40NzEyLDkuNjEzNSA3LjQ4MjIsOS41ODYzMTgxOCA3LjQ5NDMsOS41NDI1OTA5MSBDNy41MDY0LDkuNDkyOTU0NTUgNy41MTE5LDkuNDI1NTkwOTEgNy41MTE5LDkuMzM5MzE4MTggQzcuNTExOSw5LjE3MjY4MTgyIDcuNDkxLDkuMDM0NDA5MDkgNy40NTE0LDguOTIzMzE4MTggQzcuNDA1Miw4LjgxMzQwOTA5IDcuMzc0NCw4Ljc0ODQwOTA5IDcuMzU2OCw4LjcyOTUgTDUuNTA4OCw2Ljc0NTIyNzI3IEw5LjQ2MjIsMi40OTc3NzI3MyBaIE0xMC4yMzU1LDEuMTIyMTM2MzYgQzEwLjM3ODUsMS4yNzU3NzI3MyAxMC40ODUyLDEuNDUxODYzNjQgMTAuNTUzNCwxLjY0ODA0NTQ1IEMxMC42MjI3LDEuODM5NSAxMC42NTY4LDIuMDMzMzE4MTggMTAuNjU2OCwyLjIyOTUgQzEwLjY1NjgsMi40MzI3NzI3MyAxMC42MjI3LDIuNjMwMTM2MzYgMTAuNTUzNCwyLjgyMDQwOTA5IEMxMC40ODUyLDMuMDExODYzNjQgMTAuMzc4NSwzLjE4NDQwOTA5IDEwLjIzNTUsMy4zMzgwNDU0NSBMNy4wNjQyLDYuNzQ1MjI3MjcgTDguMTMwMSw3Ljg4OTIyNzI3IEM4LjI3OTcsOC4wNDk5NTQ1NSA4LjM5NjMsOC4yNjE1IDguNDgyMSw4LjUyNzQwOTA5IEM4LjU2OSw4Ljc4NTA0NTQ1IDguNjExOSw5LjA1MzMxODE4IDguNjExOSw5LjMyOTg2MzY0IEM4LjYxMTksOS41NjM4NjM2NCA4LjU4LDkuNzgwMTM2MzYgOC41MTczLDkuOTc2MzE4MTggQzguNDUzNSwxMC4xNjc3NzI3IDguMzYyMiwxMC4zMjczMTgyIDguMjQyMywxMC40NTYxMzY0IEw2Ljc4OTIsMTIuMDE3MzE4MiBMLTMuNzMwMzQ5MzZlLTE0LDQuNDgzMjI3MjcgTDEuNDQ0MywyLjkyMjA0NTQ1IEMxLjU4MTgsMi43NzQzMTgxOCAxLjczOTEsMi42NjQ0MDkwOSAxLjkxNzMsMi41ODk5NTQ1NSBDMi4wOTQ0LDIuNTA5NTkwOTEgMi4yODAzLDIuNDcwNTkwOTEgMi40NzUsMi40NzA1OTA5MSBDMi44ODIsMi40NzA1OTA5MSAzLjIyNjMsMi42MjA2ODE4MiAzLjUwNjgsMi45MjIwNDU0NSBMNC41ODE1LDQuMDc2NjgxODIgTDcuNzUxNywwLjY2OTUgQzguMDM4OCwwLjM2MjIyNzI3MyA4LjM4MzEsMC4yMDg1OTA5MDkgOC43ODM1LDAuMjA4NTkwOTA5IEM4Ljk3ODIsMC4yMDg1OTA5MDkgOS4xNjQxLDAuMjQ3NTkwOTA5IDkuMzQyMywwLjMyNzk1NDU0NSBDOS41MTk0LDAuNDA4MzE4MTgyIDkuNjc2NywwLjUyMTc3MjcyNyA5LjgxNDIsMC42Njk1IEwxMC4yMzU1LDEuMTIyMTM2MzYgWiIgaWQ9IkZpbGwtMSIgZmlsbD0iIzY2NjY2NiI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC02IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMy43MTg3NjkyLDcuMzg1MzUgQzEzLjY4NTMwNzcsNy40MzIwMTY2NyAxMy42MzkxNTM4LDcuNDc4NjgzMzMgMTMuNTkzLDcuNTI1MzUgQzEzLjU5Myw3LjUyNTM1IDEzLjQ2NDkyMzEsNy42NjUzNSAxMy4yNjg3NjkyLDcuODg3MDE2NjcgQzEzLjIxMjIzMDgsNy45NTcwMTY2NyAxMy4xNTQ1Mzg1LDguMDM4NjgzMzMgMTMuMDg0MTUzOCw4LjEwODY4MzMzIEMxMi44MDcyMzA4LDguNDEyMDE2NjcgMTIuNDg1MzA3Nyw4Ljc1MDM1IDEyLjEwNDUzODUsOS4xMjM2ODMzMyBDMTEuODA0NTM4NSw5LjQzODY4MzMzIDExLjQ1NzIzMDgsOS43NTI1MTY2NyAxMS4xNjg3NjkyLDEwLjA1NzAxNjcgQzEwLjk1MDY5MjMsMTAuMjY3MDE2NyAxMC43MzAzMDc3LDEwLjQ3NTg1IDEwLjQ5OTUzODUsMTAuNjg3MDE2NyBDMTAuMDk1NjkyMywxMS4wNTkxODMzIDkuNjY4NzY5MjMsMTEuNDEwMzUgOS4yODgsMTEuNzEzNjgzMyBDOS4xNjEwNzY5MiwxMS44MTg2ODMzIDkuMDM0MTUzODUsMTEuOTEyMDE2NyA4LjkxODc2OTIzLDExLjk5MzY4MzMgQzguNTM4LDEyLjI3MjUxNjcgOC4yODUzMDc2OSwxMi40NjAzNSA4LjI4NTMwNzY5LDEyLjQ2MDM1IEw1LjM1MzM4NDYyLDkuMDY0MTgzMzMgTDQuMzQ5NTM4NDYsNy45MTAzNSBMMi44OTU2OTIzMSw2LjIzMDM1IEwyLjI1ODU3ODU5LDUuNTA1NDYwNCBDMi42ODU1MDE2Niw1LjM3NzEyNzA3IDMuMDMyODA5MzUsNS4yNDg3OTM3MyAzLjU1MDg4NjI4LDUuMDM4NzkzNzMgQzQuMDcxMjcwODksNC44Mjg3OTM3MyA0LjYxMjQyNDc0LDQuNTcyMTI3MDcgNS4xNTQ3MzI0Myw0LjI4MDQ2MDQgQzUuNjk3MDQwMTIsMy45NzcxMjcwNyA2LjIyNzgwOTM1LDMuNjI3MTI3MDcgNi43NTg1Nzg1OSwzLjI0MjEyNzA3IEM3LjI4OTM0NzgyLDIuODQ1NDYwNCA3Ljc3Mzk2MzIsMi40MDIxMjcwNyA4LjIxMjQyNDc0LDEuOTAwNDYwNCBMNy4zODE2NTU1MSwxLjA2MDQ2MDQgQzcuMDcxMjcwODksMS40NTcxMjcwNyA2LjczNjY1NTUxLDEuODA3MTI3MDcgNi4zNTU4ODYyOCwyLjEyMjEyNzA3IEM1Ljk3Mzk2MzIsMi40MzcxMjcwNyA1LjU4MjgwOTM1LDIuNzE3MTI3MDcgNS4xODkzNDc4MiwyLjk2MjEyNzA3IEM0Ljc3Mzk2MzIsMy4yMDcxMjcwNyA0LjM1OTczMjQzLDMuNDI4NzkzNzMgMy45NTQ3MzI0MywzLjYxNTQ2MDQgQzMuNTM5MzQ3ODIsMy44MDIxMjcwNyAzLjEzNTUwMTY2LDMuOTc3MTI3MDcgMi43NTQ3MzI0Myw0LjExNzEyNzA3IEMxLjg1NDczMjQzLDQuNDQzNzkzNzMgMS4wNTg1Nzg1OSw0LjY1Mzc5MzczIDAuMTEyNDI0NzM5LDQuODA1NDYwNCBMOC4wNzY0NjE1NCwxNC4wMDAzNSBDOC41NjEwNzY5MiwxMy42OTcwMTY3IDkuMDQ1NjkyMzEsMTMuMzcwMzUgOS41MTg3NjkyMywxMy4wMDc1MTY3IEM5Ljk5MywxMi42NDcwMTY3IDEwLjQ0MTg0NjIsMTIuMjcyNTE2NyAxMC44ODAzMDc3LDExLjkwMDM1IEMxMS4zMDcyMzA4LDExLjUyNzAxNjcgMTEuNzIzNzY5MiwxMS4xNDIwMTY3IDEyLjEwNDUzODUsMTAuNzY3NTE2NyBDMTIuNDg1MzA3NywxMC4zOTUzNSAxMi44MzAzMDc3LDEwLjA0NDE4MzMgMTMuMTU0NTM4NSw5LjcwNzAxNjY3IEMxMy40NjQ5MjMxLDkuMzgwMzUgMTMuNzQzLDkuMDc3MDE2NjcgMTMuOTczNzY5Miw4LjgxOTE4MzMzIEMxNC4yMDMzODQ2LDguNTUyMDE2NjcgMTQuMzg4LDguMzc3MDE2NjcgMTQuNTE0OTIzMSw4LjIyNTM1IEwxMy43MTg3NjkyLDcuMzg1MzUgWiIgaWQ9IkZpbGwtNCIgZmlsbD0iIzY2NjY2NiI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMi4wNjkwODQ4LDExLjQ1MzM5MTUgQzExLjUyNDY0OTIsMTIuMDA4MTIxIDEwLjk2NjQ4ODMsMTIuNTYzOTk0MyAxMC4zNTExMzg5LDEzLjEwMjcxMTEgQzkuNzQ5NTE0NjYsMTMuNjU4NTg0NCA5LjExOTI5NjE1LDE0LjE2NjQxOTMgOC40ODkwNzc2NCwxNC42Mjg1MDMyIEwzLjQzMTMxNjc1LDkgTDEyLjA2OTA4NDgsMTEuNDUzMzkxNSBaIiBpZD0iRmlsbC03IiBmaWxsPSIjMkU3N0QwIj48L3BhdGg+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=\"","module.exports = \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTIgMGMtNi42MjYgMC0xMiA1LjM3My0xMiAxMiAwIDUuMzAyIDMuNDM4IDkuOCA4LjIwNyAxMS4zODcuNTk5LjExMS43OTMtLjI2MS43OTMtLjU3N3YtMi4yMzRjLTMuMzM4LjcyNi00LjAzMy0xLjQxNi00LjAzMy0xLjQxNi0uNTQ2LTEuMzg3LTEuMzMzLTEuNzU2LTEuMzMzLTEuNzU2LTEuMDg5LS43NDUuMDgzLS43MjkuMDgzLS43MjkgMS4yMDUuMDg0IDEuODM5IDEuMjM3IDEuODM5IDEuMjM3IDEuMDcgMS44MzQgMi44MDcgMS4zMDQgMy40OTIuOTk3LjEwNy0uNzc1LjQxOC0xLjMwNS43NjItMS42MDQtMi42NjUtLjMwNS01LjQ2Ny0xLjMzNC01LjQ2Ny01LjkzMSAwLTEuMzExLjQ2OS0yLjM4MSAxLjIzNi0zLjIyMS0uMTI0LS4zMDMtLjUzNS0xLjUyNC4xMTctMy4xNzYgMCAwIDEuMDA4LS4zMjIgMy4zMDEgMS4yMy45NTctLjI2NiAxLjk4My0uMzk5IDMuMDAzLS40MDQgMS4wMi4wMDUgMi4wNDcuMTM4IDMuMDA2LjQwNCAyLjI5MS0xLjU1MiAzLjI5Ny0xLjIzIDMuMjk3LTEuMjMuNjUzIDEuNjUzLjI0MiAyLjg3NC4xMTggMy4xNzYuNzcuODQgMS4yMzUgMS45MTEgMS4yMzUgMy4yMjEgMCA0LjYwOS0yLjgwNyA1LjYyNC01LjQ3OSA1LjkyMS40My4zNzIuODIzIDEuMTAyLjgyMyAyLjIyMnYzLjI5M2MwIC4zMTkuMTkyLjY5NC44MDEuNTc2IDQuNzY1LTEuNTg5IDguMTk5LTYuMDg2IDguMTk5LTExLjM4NiAwLTYuNjI3LTUuMzczLTEyLTEyLTEyeiIvPjwvc3ZnPg==\"","module.exports = FluentUIReact;","module.exports = React;","module.exports = ReactDOM;","module.exports = roosterjs;","module.exports = roosterjsReact;","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n  return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { mount as mountClassicalEditorMainPane } from './controls/MainPane';\nimport { mount as mountContentModelEditorMainPane } from './controls/ContentModelEditorMainPane';\nimport { mount as mountStandaloneEditorMainPane } from './controls/StandaloneEditorMainPane';\n\nconst search = document.location.search.substring(1).split('&');\n\nif (search.some(x => x == 'cm=1')) {\n    mountContentModelEditorMainPane(document.getElementById('mainPane'));\n} else if (search.some(x => x == 'cm=2')) {\n    mountStandaloneEditorMainPane(document.getElementById('mainPane'));\n} else {\n    mountClassicalEditorMainPane(document.getElementById('mainPane'));\n}\n"],"names":["content","loader","module","id","i","length","loadStyles","locals","exports","__assign","this","Object","assign","t","s","n","arguments","p","prototype","hasOwnProperty","call","apply","defineProperty","value","state","_root","window","g","_styleNonce","CSPSettings","nonce","_themeState","__themeState__","theme","undefined","lastStyleElement","registeredStyles","runState","perf","count","duration","flushTimer","mode","buffer","registeredThemableStyles","_themeTokenRegex","now","performance","Date","measure","func","start","end","flush","styleArrays","slice","mergedStyleArray","concat","applyThemableStyles","stylesArray","styleRecord","resolveThemableArray","styleString","styleArray","document","head","getElementsByTagName","styleElement","createElement","_a","themable","setAttribute","appendChild","createTextNode","ev","createEvent","initEvent","args","newStyle","dispatchEvent","record","themableStyle","push","registerStyles","clearStyles","option","clearStylesInternal","records","forEach","parentElement","removeChild","splitStyleArray","map","currentValue","themeSlot","themedValue","defaultValue","console","DEBUG","warn","rawString","join","splitStyles","styles","result","pos","tokenMatch","exec","matchIndex","index","substring","lastIndex","loadAsync","styleParts","Array","isArray","setTimeout","configureLoadStyles","loadStylesFn","configureRunMode","loadTheme","themableStyles","_i","reloadStyles","detokenize","cssKeywords","reverseKeywords","key","convert","rgb","channels","labels","hsl","hsv","hwb","cmyk","xyz","lab","lch","hex","keyword","ansi16","ansi256","hcg","apple","gray","model","Error","h","l","r","b","min","Math","max","delta","rdif","gdif","bdif","v","diff","diffc","c","k","reversed","currentClosestKeyword","x","y","currentClosestDistance","Infinity","distance","pow","z","t1","t2","t3","val","smin","lmin","hi","floor","f","q","sl","vmin","wh","bl","ratio","m","y2","x2","z2","a","atan2","PI","sqrt","hr","cos","sin","round","ansi","color","mult","rem","string","toString","toUpperCase","match","colorString","split","char","integer","parseInt","hue","chroma","mg","pure","w","conversions","route","keys","fromModel","routes","toModel","fn","wrappedFn","len","conversion","wrapRounded","raw","wrapRaw","link","from","to","wrapConversion","graph","path","parent","cur","unshift","models","buildGraph","queue","current","pop","adjacents","adjacent","node","deriveBFS","colorNames","swizzle","reverseNames","name","cs","get","clamp","num","hexDouble","str","toLowerCase","hexAlpha","i2","parseFloat","alpha","isNaN","rgba","percent","hsla","hwba","_slice","skippedModels","hashedModelKeys","sort","limiters","Color","obj","valpha","newArr","zeroArray","splice","indexOf","hashedKeys","JSON","stringify","limit","freeze","getset","channel","modifier","maxfn","arr","toJSON","places","self","percentString","array","object","unitArray","unitObject","Number","toFixed","roundTo","roundToPlace","red","green","blue","saturationl","lightness","saturationv","white","wblack","cyan","magenta","yellow","black","rgbNumber","luminosity","lum","chan","contrast","color2","lum1","lum2","level","contrastRatio","isDark","isLight","negate","lighten","darken","saturate","desaturate","whiten","blacken","grayscale","fade","opaquer","rotate","degrees","mix","mixinColor","weight","color1","w1","w2","newAlpha","___CSS_LOADER_API_IMPORT___","useSourceMap","list","item","sourceMap","base64","data","cssMapping","btoa","sourceMapping","unescape","encodeURIComponent","sourceURLs","sources","source","sourceRoot","cssWithMappingToString","modules","mediaQuery","dedupe","alreadyImportedModules","setPrototypeOf","isFrozen","getPrototypeOf","getOwnPropertyDescriptor","seal","create","_ref","Reflect","construct","fun","thisValue","Func","Function","bind","arr2","_toConsumableArray","arrayForEach","unapply","arrayPop","arrayPush","stringToLowerCase","String","stringMatch","stringReplace","replace","stringIndexOf","stringTrim","trim","regExpTest","RegExp","test","typeErrorCreate","TypeError","_len2","_key2","thisArg","_len","_key","addToSet","set","element","lcElement","clone","newObject","property","lookupGetter","prop","desc","html","svg","svgFilters","svgDisallowed","mathMl","mathMlDisallowed","text","html$1","svg$1","mathMl$1","xml","MUSTACHE_EXPR","ERB_EXPR","DATA_ATTR","ARIA_ATTR","IS_ALLOWED_URI","IS_SCRIPT_OR_DATA","ATTR_WHITESPACE","_typeof","Symbol","iterator","constructor","_toConsumableArray$1","getGlobal","createDOMPurify","DOMPurify","root","version","removed","nodeType","isSupported","originalDocument","DocumentFragment","HTMLTemplateElement","Node","Element","NodeFilter","_window$NamedNodeMap","NamedNodeMap","MozNamedAttrMap","Text","Comment","DOMParser","trustedTypes","ElementPrototype","cloneNode","getNextSibling","getChildNodes","getParentNode","template","ownerDocument","trustedTypesPolicy","createPolicy","suffix","ATTR_NAME","currentScript","hasAttribute","getAttribute","policyName","createHTML","html$$1","_","_createTrustedTypesPolicy","emptyHTML","RETURN_TRUSTED_TYPE","_document","implementation","createNodeIterator","createDocumentFragment","importNode","documentMode","hooks","createHTMLDocument","MUSTACHE_EXPR$$1","ERB_EXPR$$1","DATA_ATTR$$1","ARIA_ATTR$$1","IS_SCRIPT_OR_DATA$$1","ATTR_WHITESPACE$$1","IS_ALLOWED_URI$$1","ALLOWED_TAGS","DEFAULT_ALLOWED_TAGS","ALLOWED_ATTR","DEFAULT_ALLOWED_ATTR","FORBID_TAGS","FORBID_ATTR","ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","SAFE_FOR_TEMPLATES","WHOLE_DOCUMENT","SET_CONFIG","FORCE_BODY","RETURN_DOM","RETURN_DOM_FRAGMENT","RETURN_DOM_IMPORT","SANITIZE_DOM","KEEP_CONTENT","IN_PLACE","USE_PROFILES","FORBID_CONTENTS","DATA_URI_TAGS","DEFAULT_DATA_URI_TAGS","URI_SAFE_ATTRIBUTES","DEFAULT_URI_SAFE_ATTRIBUTES","MATHML_NAMESPACE","SVG_NAMESPACE","HTML_NAMESPACE","NAMESPACE","IS_EMPTY_INPUT","CONFIG","formElement","_parseConfig","cfg","ADD_URI_SAFE_ATTR","ADD_DATA_URI_TAGS","ALLOWED_URI_REGEXP","ADD_TAGS","ADD_ATTR","table","tbody","MATHML_TEXT_INTEGRATION_POINTS","HTML_INTEGRATION_POINTS","ALL_SVG_TAGS","ALL_MATHML_TAGS","_forceRemove","parentNode","outerHTML","remove","_removeAttribute","attribute","getAttributeNode","removeAttribute","_initDocument","dirty","doc","leadingWhitespace","matches","dirtyPayload","parseFromString","documentElement","createDocument","innerHTML","body","insertBefore","childNodes","_createIterator","SHOW_ELEMENT","SHOW_COMMENT","SHOW_TEXT","_isNode","nodeName","_executeHook","entryPoint","currentNode","hook","_sanitizeElements","elm","textContent","attributes","namespaceURI","tagName","allowedTags","firstElementChild","parentTagName","Boolean","commonSvgAndHTMLElements","_checkValidNamespace","_isValidAttribute","lcTag","lcName","_sanitizeAttributes","attr","hookEvent","attrName","attrValue","keepAttr","allowedAttributes","_attr","forceKeepAttr","setAttributeNS","_sanitizeShadowDOM","fragment","shadowNode","shadowIterator","nextNode","sanitize","importedNode","oldNode","returnNode","toStaticHTML","firstChild","nodeIterator","serializedHTML","setConfig","clearConfig","isValidAttribute","tag","addHook","hookFunction","removeHook","removeHooks","removeAllHooks","factory","isArrayish","results","arg","wrap","UrlPlaceholder","LightTheme","palette","themePrimary","themeLighterAlt","themeLighter","themeLight","themeTertiary","themeSecondary","themeDarkAlt","themeDark","themeDarker","neutralLighterAlt","neutralLighter","neutralLight","neutralQuaternaryAlt","neutralQuaternary","neutralTertiaryAlt","neutralTertiary","neutralSecondary","neutralPrimaryAlt","neutralPrimary","neutralDark","DarkTheme","props","toggleablePlugins","buttons","formatPainterButton","boldButton","italicButton","underlineButton","fontButton","fontSizeButton","increaseFontSizeButton","decreaseFontSizeButton","textColorButton","backgroundColorButton","bulletedListButton","numberedListButton","decreaseIndentButton","increaseIndentButton","blockQuoteButton","alignLeftButton","alignCenterButton","alignRightButton","alignJustifyButton","insertLinkButton","removeLinkButton","insertTableButton","insertImageButton","superscriptButton","subscriptButton","strikethroughButton","setHeadingLevelButton","codeButton","ltrButton","rtlButton","undoButton","redoButton","clearFormatButton","setBulletedListStyleButton","setNumberedListStyleButton","listStartNumberButton","formatTableButton","setTableCellShadeButton","setTableHeaderButton","tableInsertButton","tableDeleteButton","tableMergeButton","tableSplitButton","tableAlignCellButton","tableAlignTableButton","tableBorderApplyButton","tableBorderColorButton","tableBorderWidthButton","tableBorderStyleButton","imageBorderColorButton","imageBorderWidthButton","imageBorderStyleButton","imageBorderRemoveButton","changeImageButton","imageBoxShadowButton","spacingButton","spaceBeforeButton","spaceAfterButton","pasteButton","darkMode","zoom","exportContent","snapshots","totalSize","currentIndex","autoCompleteIndex","maxSize","formatStatePlugin","editorOptionPlugin","eventViewPlugin","apiPlaygroundPlugin","snapshotPlugin","contentModelPanePlugin","contentModelEditPlugin","EditPlugin","contentModelAutoFormatPlugin","AutoFormatPlugin","contentModelRibbonPlugin","ContentModelRibbonPlugin","pasteOptionPlugin","createPasteOptionPlugin","emojiPlugin","createEmojiPlugin","formatPainterPlugin","tableEditPlugin","TableEditPlugin","pastePlugin","PastePlugin","sampleEntityPlugin","showSidePane","location","hash","popoutWindow","initState","getBuildInPluginState","scale","isDarkMode","themeMatch","editorCreator","isRtl","tableBorderFormat","width","style","getStyles","renderTitleBar","className","noGrow","renderRibbon","isPopout","popout","ContentModelRibbon","plugin","dir","renderSidePane","fullWidth","ref","sidePane","plugins","getSidePanePlugins","sidePaneFullWidth","getPlugins","updateContentPlugin","resetEditor","setState","div","options","EditorAdapter","cacheModel","renderEditor","allPlugins","editorStyles","transform","transformOrigin","height","format","defaultFormat","fontWeight","bold","italic","underline","fontFamily","fontSize","textColor","textColors","lightModeColor","backgroundColor","backgroundColors","forceUpdate","editorContainer","editorDivId","editor","legacyPlugins","getInnerRibbonPlugin","defaultSegmentFormat","inDarkMode","getDarkColor","experimentalFeatures","getSnapshots","trustedHTMLHandler","initialContent","getTheme","ReactDOM","render","ContentModelEditorMainPane","ribbonPlugin","createRibbonPlugin","mainWindowButtons","getButtons","AllButtonKeys","popoutWindowButtons","MainPane","Ribbon","Editor","Rooster","undoMetadataSnapshotService","getSnapshotService","zoomScale","PopoutRoot","POPOUT_HTML","React","createRef","matchMedia","onMouseDown","e","addEventListener","onMouseMove","onMouseUp","userSelect","mouseX","pageX","changeWidth","removeEventListener","onUpdate","onShowSidePane","onHideSidePane","onThemeChange","MainPaneBase","instance","createUpdateContentPlugin","UpdateMode","OnDispose","getInstance","ThemeProvider","applyTo","mainPane","renderPopout","renderMainPane","componentDidMount","componentWillUnmount","win","open","write","unregisterWindowForCss","registerWindowForCss","popoutRoot","getElementById","resetEditorPlugin","pluginState","setScale","getTableBorder","setTableBorderColor","setTableBorderWidth","setTableBorderStyle","toggleDarkMode","setPageDirection","resizer","renderSidePaneButton","onClick","createPortal","WindowProvider","Component","contentAutoFormatPlugin","shortcutPlugin","ShortcutPlugin","startDrag","callback","rect","getBoundingClientRect","onMouseChange","left","top","pageY","type","stopPropagation","preventDefault","hueBar","useRef","picker","initColor","useState","setHue","saturation","setSaturation","setValue","getComputedStyle","onMouseDownHueBar","useCallback","onMouseDownPicker","onChangeHue","newHue","which","onChangeColor","newSaturation","newValue","useEffect","onSelect","container","tabIndex","onKeyDown","layer1","layer2","currentColor","newColor","hasContent","hasFormat","hasDataset","bodyState","toggleFormat","toggleJson","toggleVisual","toggleMetadata","title","css","button","buttonChecked","DatasetView","dataset","getMetadata","getObjectKeys","DatasetItemView","useProperty","inputRef","onChange","subTitle","isExpanded","hasSelection","isSelection","jsonSource","getContent","getFormat","setBodyState","highlightBorder","toggleDataset","getCachedElement","cachedElement","wrapper","onMouseOver","onMouseOut","position","zIndex","border","boxSizing","modelWrapper","childSelected","selected","titleBar","titleWithBorder","buttonGroup","ButtonGroup","expandedBody","ContentModelJson","BlockFormatRenders","BackgroundColorFormatRenderer","DirectionFormatRenderer","TextAlignFormatRenderer","HtmlAlignFormatRenderer","MarginFormatRenderer","PaddingFormatRenderer","LineHeightFormatRenderer","WhiteSpaceFormatRenderer","TextIndentFormatRenderer","BorderFormatRenderers","FormatView","renderers","formatTable","LinkFormatRenderers","createTextFormatRenderer","href","target","anchorId","anchorClass","anchorTitle","relationship","TextColorFormatRenderer","UnderlineFormatRenderer","DisplayFormatRenderer","updater","metadata","SegmentFormatRenders","FontSizeFormatRenderer","FontFamilyFormatRenderer","BoldFormatRenderer","ItalicFormatRenderer","StrikeFormatRenderer","SuperOrSubScriptFormatRenderer","LetterSpacingFormatRenderer","createColorFormatRenderer","createCheckboxFormatRenderer","strikethrough","superOrSubScriptSequence","BorderBoxFormatRenderer","useBorderBox","BorderStyles","createBorderRenderer","extractBorderValues","combineBorderValue","createDropDownFormatRenderer","direction","display","FloatFormatRenderer","float","htmlAlign","IdFormatRenderer","ImageMetadataFormatRenderers","widthPx","heightPx","leftPercent","rightPercent","topPercent","bottomPercent","angleRad","src","naturalWidth","naturalHeight","letterSpacing","lineHeight","ListMetadataFormatRenderers","orderedStyleType","unorderedStyleType","ListStylePositionFormatRenderers","listStylePosition","listStyleType","ListThreadFormatRenderers","startNumberOverride","MarginNames","createTextFormatRendererGroup","PaddingNames","SizeFormatRenderers","maxWidth","maxHeight","minWidth","minHeight","SpacingFormatRenderer","borderCollapse","TableCellMetadataFormatRenders","bgColorOverride","vAlignOverride","borderOverride","TableLayoutFormatRenderer","tableLayout","TableMetadataFormatRenders","topBorderColor","bottomBorderColor","verticalBorderColor","hasHeaderRow","headerRowColor","hasFirstColumn","hasBandedColumns","hasBandedRows","bgColorEven","bgColorOdd","TableBorderFormat","values","textAlign","textIndent","VerticalAlignFormatRenderer","verticalAlign","whiteSpace","WordBreakFormatRenderer","wordBreak","CheckboxFormatItem","getter","setter","checkbox","checked","formatRow","formatName","formatValue","Transparent","ColorFormatItem","colorPickerBox","colorValueBox","transparentCheckBox","initValue","updateValue","onTextBoxChange","onColorValueChange","onToggleTransparent","colorValue","names","initValues","DropDownFormatItem","dropDown","o","TextFormatItem","textBox","multiLineValue","numberValue","textValue","group","blocks","block","ContentModelBlockView","blockGroupType","ContentModelDocumentView","ContentModelGeneralView","ContentModelListItemView","listItem","ContentModelFormatContainerView","ContentModelTableCellView","cell","blockType","ContentModelBlockGroupView","ContentModelParagraphView","paragraph","ContentModelTableView","ContentModelEntityView","entity","ContentModelDividerView","divider","br","SegmentFormatView","ContentModelView","modelBr","isSelected","CodeRenderers","code","modelCode","DividerFormatRenders","setTagName","tagNameDropDown","onTagNameChange","modelDivider","BlockGroupContentView","modelDocument","hasSelectionInBlockGroup","entityFormat","setId","isReadonly","setIsReadonly","entityType","setType","idTextBox","isReadonlyCheckBox","typeTextBox","onIdChange","onTypeChange","onReadonlyChange","BlockFormatView","modelEntity","FormatContainerFormatRenderers","modelFormatContainer","hasSelectionInBlock","isGeneralSegment","segmentType","segment","ContentModelLinkView","ContentModelCodeView","modelGeneral","ImageFormatRenderers","image","srcTextArea","imageSelectionCheckBox","setSrc","isSelectedAsImageSelection","imageSelected","setImageSelected","onSrcChange","onImageSelectionChange","MetadataView","updateImageMetadata","modelImage","json","safeInstanceOf","LinkFormatView","modelLink","ListItemFormatRenderers","ListItemFormatHolderRenderers","levels","ContentModelListLevelView","formatHolder","modelListItem","ListLevelFormatRenders","listType","setListType","listTypeInput","onListTypeChanged","updateListMetadata","modelListLevel","ContentModelParagraphDecoratorView","decorator","modelDecorator","implicitCheckbox","isImplicit","setIsImplicit","onIsImplicitChange","segments","ContentModelSegmentView","segmentFormat","modelParagraph","ContentModelBrView","ContentModelSelectionMarkerView","marker","ContentModelTextView","ContentModelImageView","modelSelectionMarker","TableCellFormatRenderers","checkboxHeader","checkboxSpanLeft","checkboxSpanAbove","isHeader","setIsHeader","spanLeft","setSpanLeft","spanAbove","setSpanAbove","onHeaderChanged","onSpanLeftChanged","onSpanAboveChanged","updateTableCellMetadata","modelTableCell","TableRowFormatRenderers","row","setHeight","textBoxRef","sizeInput","cells","j","modelTableRow","some","TableFormatRenderers","NumberView","widths","rows","ContentModelTableRowView","updateTableMetadata","modelTable","textArea","modelText","setUIUtilities","uiUtilities","isReactEditorPlugin","defaultEditorCreator","editorDiv","useTheme","focusOnInit","createUIUtilities","focus","dispose","setDarkModeState","divProps","getNativeProps","divProperties","FORMATPAINTERCURSOR_STYLE","styleNode","painterFormat","ContentModelFormatPainterPlugin","getName","initialize","getDocument","onPluginEvent","event","eventType","applySegmentFormat","setFormatPainterCursor","sheet","cssRules","deleteRule","insertRule","startFormatPainter","formatState","getFormatState","fontName","isBold","isItalic","isStrikeThrough","isSubscript","isSuperscript","isUnderline","pluginList","linkTitle","imageEdit","ImageEdit","preserveRatio","forcePreserveRatio","applyChangesOnMouseUp","contentEdit","ContentEdit","contentEditFeatures","hyperlink","HyperLink","url","paste","Paste","watermark","Watermark","watermarkText","cutPasteListChain","CutPasteListChain","tableCellSelection","TableCellSelection","customReplace","CustomReplace","autoFormat","AutoFormat","listEditMenu","contextMenu","createListEditMenuProvider","imageEditMenu","createImageEditMenuProvider","tableEditMenu","createTableEditMenuProvider","createContextMenuPlugin","announce","Announce","Map","ribbonClassName","mergeStyles","padding","rtlIcon","strings","setFormatState","onButtonClick","onHover","startLivePreview","onDismiss","stopLivePreview","flipIcon","defaultRender","commandBarItems","useMemo","selectedItem","dropDownMenu","getSelectedItemKey","iconProps","iconName","onRenderIcon","flipWhenRtl","iconOnly","getLocalizedString","unlocalizedText","ariaLabel","canCheck","isChecked","disabled","isDisabled","commandBarProperties","subMenuProps","shouldFocusOnMount","focusZoneProps","FocusZoneDirection","bidirectional","onMenuDismissed","onItemClick","onRenderContextualMenuItem","allowLivePreview","defaultRenderer","items","itemClassName","onRender","itemRender","commandBarSubMenuProperties","disposer","registerFormatChangedCallback","moreCommandsBtn","moreCommands","CommandBar","overflowButtonProps","delayUpdateTime","onFormatChanged","timer","updateFormat","delayUpdate","stopShadowEdit","isInShadowEdit","range","getDOMSelection","collapsed","startShadowEdit","defaultView","clearTimeout","setAlignment","originalButton","KnownRibbonButtonKey","BackgroundColor","setBackgroundColor","getBackgroundColorValue","isBlockQuote","toggleBlockQuote","toggleBold","isBullet","toggleBullet","FileInput","accept","canAddImageAltText","fileInput","files","changeImage","click","clearFormat","isCodeInline","toggleCode","changeFontSize","setIndentation","getTrustedHTMLHandler","FontNames","family","localizedName","DropDownItems","reduce","font","LowerCaseFontMap","FirstFontRegex","firstName","setFontName","size","setFontSize","PREDEFINED_STYLES","DEFAULT","lightColor","createTableFormat","Default","DEFAULT_WITH_BACKGROUND_COLOR","GRID_WITHOUT_BORDER","NoSideBorders","LIST","BANDED_ROWS_FIRST_COLUMN_NO_BORDER","FirstColumnHeaderExternal","EXTERNAL","ListWithSideBorders","NO_HEADER_VERTICAL","NoHeaderBorders","ESPECIAL_TYPE_1","EspecialType1","ESPECIAL_TYPE_2","EspecialType2","ESPECIAL_TYPE_3","EspecialType3","CLEAR","Clear","topBorder","bottomBorder","verticalBorder","bandedRows","bandedColumns","headerRow","firstColumn","borderFormat","isInTable","TextColor","setImageBorder","getTextColorValue","dashed","dotted","solid","double","groove","ridge","inset","outset","STYLES","noShadow","bottomRight","bottom","bottomLeft","right","center","topRight","topLeft","setImageBoxShadow","insertImage","adjustLinkSelection","displayText","autoFocus","labelKey","unlocalizedLabel","showInputDialog","itemName","then","insertLink","originalPasteButton","InsertTable","col","parseKey","insertTable","toggleItalic","ribbonButtonSetStartNumberTo1","ribbonButtonSetStartNumberCustomize","isNumbering","uiUtility","startNumber","setListStartNumber","setDirection","toggleNumbering","clipboard","navigator","read","clipboardItems","Promise","all","createDataTransferItems","dataTransferItems","extractClipboardItems","clipboardData","pasteFromClipboard","isTEXT","startsWith","types","isIMAGE","getType","blob","kind","file","getAsFile","getAsString","webkitGetAsEntry","createDataTransfer","canRedo","redo","canUnlink","removeLink","dropDownMenuItems","BulletListType","Disc","Dash","Square","ShortArrow","LongArrow","UnfilledArrow","Hyphen","DoubleLongArrow","Circle","setListStyle","originalHeadingButton","Heading","headingLevel","setHeadingLevel","NumberingListType","Decimal","DecimalDash","DecimalParenthesis","DecimalDoubleParenthesis","LowerAlpha","LowerAlphaParenthesis","LowerAlphaDoubleParenthesis","LowerAlphaDash","UpperAlpha","UpperAlphaParenthesis","UpperAlphaDoubleParenthesis","UpperAlphaDash","LowerRoman","LowerRomanParenthesis","LowerRomanDoubleParenthesis","LowerRomanDash","UpperRoman","UpperRomanParenthesis","UpperRomanDoubleParenthesis","UpperRomanDash","originalBackgroundColorButton","setTableCellShade","tableHasHeader","marginBottom","setParagraphMargin","marginTop","SPACING_OPTIONS","query","find","opt","abs","findClosest","setSpacing","toggleStrikethrough","toggleSubscript","toggleSuperscript","TABLE_OPERATIONS","menuNameTableAllBorder","menuNameTableNoBorder","menuNameTableLeftBorder","menuNameTableRightBorder","menuNameTableTopBorder","menuNameTableBottomBorder","menuNameTableInsideBorder","menuNameTableOutsideBorder","applyTableBorderFormat","TableEditOperationMap","menuNameTableInsertAbove","menuNameTableInsertBelow","menuNameTableInsertLeft","menuNameTableInsertRight","menuNameTableDeleteTable","menuNameTableDeleteColumn","menuNameTableDeleteRow","menuNameTableMergeAbove","menuNameTableMergeBelow","menuNameTableMergeLeft","menuNameTableMergeRight","menuNameTableMergeCells","menuNameTableSplitHorizontally","menuNameTableSplitVertically","menuNameTableAlignLeft","menuNameTableAlignCenter","menuNameTableAlignRight","menuNameTableAlignTop","menuNameTableAlignMiddle","menuNameTableAlignBottom","menuNameTableAlignTableLeft","menuNameTableAlignTableCenter","menuNameTableAlignTableRight","editTable","setTextColor","toggleUnderline","canUndo","undo","DropDownValues","filter","triggerEvent","newZoomScale","setZoomScale","EntityType","EntityMetadataDefinition","createObjectDefinition","createNumberDefinition","onClickEntity","findClosestElementAncestor","getEntitySelector","getEntityFromElement","addUndoSnapshot","updateEntity","getEntityState","getEntityStates","rawEvent","ctrlKey","createEntity","insertEntity","operation","dehydrate","hydrate","shouldPersist","setMetadata","parse","containerDiv","querySelector","span","increase","editingInfo","classicStyles","contentModelStyles","standaloneModelStyles","updateHash","pluginName","currentPane","updateStateFromHash","hashes","substr","setHashPath","getTitle","isCurrent","activePane","inactivePane","bodyContainer","widthDelta","clientWidth","componentCtor","component","getComponentProps","getComponent","select","pane","componentClass","header","paneName","base","getEditor","apiEntries","empty","sanitizer","matchlink","insertContent","region","vlist","vtable","getSelection","more","checkGetBlocks","update","runAsync","onGetBlocks","traverser","getBodyTraverser","currentBlockElement","getNextBlockElement","setBlocks","getStartNode","getEndNode","htmlFor","isNodeBlockElement","renderBlock","onDoubleClick","collapse","collapseToSingleElement","triggerContentChangedEvent","isNodeBlock","fontStyle","createRange","getTextContent","isBlockElement","onInputChange","darkColor","lightBackground","darkBackground","selectInfo","firstCellX","firstCellY","lastCellX","lastCellY","selectionType","updateSelection","selection","getSelectionRangeEx","selectElement","queryInfo","isImageSelectionOption","elementToSelect","selectionMessage","coordinates","getCoordinates","firstCell","lastCell","createSelectionInfo","containerInfo","areAllCollapsed","selectionOption","label","input","changeSelectionOption","createCoordinatesInput","coordinateRef","showManualSelection","manualSelect","placeholder","updateCursor","replaceSelection","insertOnNewLine","setPosition","colSpan","buttonRow","styleInline","styleBlock","insertAtRoot","focusAfterEntity","isBlock","onGetEntities","selector","allEntities","queryElements","entities","textarea","EntityButton","background","onMatchLink","matchLink","linkData","scheme","originalUrl","normalizedUrl","getSelectedRegions","regions","clearAll","Region","selectRegion","getSelectedBlockElementsInRegion","NodeName","rootNode","nodeBefore","nodeAfter","mouseOver","hover","mouseOut","classNames","regionNode","getTagOfNode","nodeValue","HtmlSanitizer","inline","getDOMDocument","convertGlobalCssToInlineCss","parser","ListTypeToString","VListItemPane","getListType","getNode","onOrdered","changeListType","onUnrdered","onIndent","indent","onOutdent","outdent","marginLeft","getLevel","cursor","createVList","getElementAtCursor","createVListFromRegion","onWriteback","writeBack","isFeatureEnabled","keepCellShade","TABLE_COLORS","TableCell","td","onClickCell","bgColor","createVTable","VTable","onCustomizeFormat","applyFormat","onWriteBack","getCurrentTd","currentTd","rowIndex","cellIndex","renderEditTableButton","renderSetHeaderRowButton","renderSetFirstColumnButton","renderSetBandedColumnButton","renderSetBandedRowButton","renderFormatTableButton","CustomizeFormatRow","formatInfo","isColorPickerShowing","setIsColorPickerShowing","onShowColorPicker","setColor","contentModelButtons","refreshButton","exportButton","setContentModel","contentModel","onModelChangeFromSelection","hasFocus","onModelChange","getContentModelCopy","setCurrentContentModel","contentModelRibbon","baseProps","getCurrentContentModel","formatContentModel","currentModel","posFocus","posTop","posBottom","posRegionRoot","insertAtTop","insertAtBottom","contentNode","getCode","EditFeatureDescriptionMap","autoBullet","indentWhenTab","outdentWhenShiftTab","outdentWhenBackspaceOnEmptyFirstLine","outdentWhenEnterOnEmptyLine","mergeInNewLineWhenBackspaceOnFirstChar","maintainListChain","unquoteWhenBackspaceOnEmptyFirstLine","unquoteWhenEnterOnEmptyLine","tabInTable","upDownInTable","insertLineBeforeStructuredNodeFeature","autoLink","unlinkWhenBackspaceAfterLink","defaultShortcut","noCycleCursorMove","clickOnEntity","escapeFromEntity","enterBeforeReadonlyEntity","backspaceAfterEntity","deleteBeforeEntity","markdownBold","markdownItalic","markdownStrikethru","markdownInlineCode","maintainListChainWhenDelete","indentTableOnTab","indentWhenTabText","outdentWhenTabText","autoHyphen","autoBulletList","autoNumberingList","mergeListOnBackspaceAfterList","deleteTableWithBackspace","moveBetweenDelimitersFeature","removeEntityBetweenDelimiters","removeCodeWhenEnterOnEmptyLine","removeCodeWhenBackspaceOnEmptyFirstLine","indentWhenAltShiftRight","outdentWhenAltShiftLeft","onContentEditClick","resetState","features","getAllFeatures","renderContentEditItem","moreOptions","checkboxColumn","initialState","tableFeaturesContainerSelector","getState","FeatureNames","renderFeature","exportForm","exportData","rtl","onExportRoosterContentModel","getHtml","js","js_pre_processor","submit","onToggleDirection","onToggleCacheModel","method","action","onPluginClick","renderPluginItem","renderInputBox","renderCheckBox","onBlur","NOT_SET","onFormatClick","onSelectChanged","renderFormatItem","renderSelectItem","Arial","Calibri","Tahoma","defaultFormatLabel","onExportRooster","onExportRoosterReact","codeMap","buttonB","buttonI","buttonU","buttonBullet","buttonNumbering","buttonUndo","buttonRedo","buttonDark","encode","line","settings","defaultValues","expermientalFeatures","lines","getLinkCallback","additionalPlugins","ContentModelPasteCode","ImageEditCode","CutPasteListChainCode","CustomReplaceCode","RibbonPluginVarName","ribbonButton","ribbon","componentCode","ButtonVarName","supportDarkMode","getButtonVarName","buttonsVarName","namespace","SimplePluginCode","PasteCode","TableResizeCode","allFeatures","defaultDisabled","EventTypeMap","EntityOperationMap","events","displayCount","clear","renderImage","img","imageFile","readFile","dataUrl","onDisplayCountChanged","displayedEvents","reverse","time","getHours","getMinutes","getSeconds","getMilliseconds","eventContent","renderEvent","addEvent","sanitizingOption","shift","renderPasteContent","rawHtml","linkPreview","pasteNativeEvent","customValues","contentType","isCut","newSrc","oldZoomScale","inputType","renderer","pasteContent","stringArray","child","nextSibling","getFocusedPosition","getPositionRect","inIME","isInIME","renderSpan","inactive","Browser","isChrome","isFirefox","isSafari","isWebKit","isMac","isWin","isAndroid","isMobileOrTablet","userAgent","appVersion","updateFormatState","entityStates","isDarkColor","onClickRestoreSnapshot","snapshot","getCurrentSnapshot","onRestoreSnapshot","onCopy","textToCopy","writeText","onPaste","getData","idx","lastIndexOf","endsWith","setSnapshot","takeSnapshot","onTakeSnapshot","renderItem","autoComplete","snapshotStr","snapshotToString","onMove","snapshotPane","snapshotList","spellCheck","updateSnapshots","refCallback","editorInstance","step","getSnapshotsManager","move","restoreSnapshot","onChanged","knownColors","newSnapshot","snapshotService","startHijackUndoSnapshot","stopHijackUndoSnapshot","setContent","getCurrentIndex","getAutoCompleteIndex","SnapshotPlugin","createSnapshots","isUndoSnapshotServiceV2","hijackUndoSnapshotCallback","canMove","canMoveCurrentSnapshot","moveCurrentSnapshot","addSnapshot","isAutoCompleteSnapshot","addSnapshotV2","clearRedo","clearProceedingSnapshotsV2","canUndoAutoComplete","classicalStyles","standaloneStyles","github","baseClassName","titleText","switchLink","links","externalLink","alt","isCssMonitorStarted","activeWindows","Stylesheet","onInsertRule","cssText","rules","default","insertTableRow","insertTableColumn","formatTableWithContentModel","findListItemsInSameThread","setModelIndentation","ResultMap","ltr","justify","TableAlignMap","alignment","paragraphOrListItemOrTable","getOperationalBlocks","newAlignment","alignTable","internalSetDirection","paddingLeft","setProperty","marginRight","paddingRight","storeBorderLeft","borderLeft","borderRight","applyTableFormat","isBlockGroupOfType","calculateMarginValue","isIndent","originalValue","parseValueWithUnit","ceil","indentation","paragraphOrListItem","modifiedBlocks","firstItem","isMultilevelSelection","lastLevel","newLevel","createListLevel","applyListStyleFromLevel","currentBlock","currentParent","isQuote","formatLtr","formatRtl","paragraphOfQuote","every","blockAndParent","unwrapBlock","createFormatContainer","areSameFormats","canMergeQuote","wrapBlockStep1","wrapBlockStep2","clearContainerFormat","containerPathIndex","getClosestAncestorBlockGroupIndex","containerIndex","blockIndex","newContainer","clearListFormat","clearBlockFormat","blocksToClear","segmentsToClear","tablesToClear","iterateSelections","tableContext","colIndex","isWholeTableSelected","clearTableCellFormat","includeListFormatHolder","isOnlySelectionMarkerSelected","adjustWordSelection","isWholeBlockSelected","clearSegmentsFormat","createTablesFormat","step1Result","blockToWrap","creator","canMerge","prevBlock","createAndAdd","setParagraphNotImplicit","addBlock","nextBlock","entityModel","context","blockParent","deleteResult","deleteSelection","insertPoint","normalizeContentModel","pathIndex","directChild","childIndex","blocksToInsert","nextParagraph","createParagraph","createBr","createSelectionMarker","setSelection","borderRadius","extractedBorder","borderColor","borderWidth","borderStyle","borderTop","borderBottom","httpExcludeRegEx","labelRegEx","domainPortWithUrlRegEx","domainPortRegEx","linkMatchRules","http","except","normalizeUrl","https","mailto","notes","unc","ftp","news","telnet","gopher","wais","schema","rule","findListItems","pushNullIfNecessary","last","areListTypesCompatible","listItems","compareToIndex","currentLevels","compareToLevels","currentLevel","hasStartNumberOverride","levelLength","currentItem","isOrderedList","filterListItems","shouldIgnoreBlock","removeMargins","paragraphOrListItems","alreadyInExpectedType","existingListItems","itemIndex","newListItem","createListItem","firstMatcher","siblingMatcher","first","paragraphs","getSelectedParagraphs","changed","findIndex","shouldSplitTrailingSpace","trimRight","isTrailingSpace","splitTextSegment","textSegment","trailingSpace","newText","createText","trailingSpaceLink","trailingSpaceSegment","__","lastTextSegment","findDelimiter","moveRightward","word","offset","isPunctuation","isSpace","found","newSegmentLeft","newSegmentRight","markerBlock","tempSegments","markerSelectionIndex","currentSegment","addSegment","TextAlignValueMap","alignCellLeft","alignCellCenter","alignCellRight","VerticalAlignValueMap","alignCellTop","alignCellMiddle","alignCellBottom","alignTableCellInternal","sel","getSelectedCells","firstRow","lastRow","lastColumn","firstCol","lastCol","noSpanAbove","noSpanLeft","noDifferentBelowSpan","spanCount","getBelowSpanCount","noDifferentRightSpan","getRightSpanCount","columns","createTable","createTableCell","cellInNextCol","collapseTableSelection","cellInNextRow","createEmptyParagraph","newPara","insertLeft","clearSelectedCells","newCell","insertAbove","sourceRow","canMergeCells","mergingColIndex","newSelectedCol","mergingRowIndex","newSelectedRow","newWidth","belowRow","belowCell","newHeight","newRow","setModelAlignment","apiName","setModelDirection","HeaderFontSizes","h1","h2","h3","h4","h5","h6","formatParagraphWithContentModel","para","newPendingFormat","createParagraphDecorator","spacing","DefaultQuoteFormatLtr","DefaultQuoteFormatRtl","BuildInQuoteFormat","quoteFormat","quoteFormatRtl","fullQuoteFormatLtr","fullQuoteFormatRtl","toggleModelBlockQuote","wrapperDisplay","skipUndoSnapshot","initialEntityState","insertEntityModel","newEntities","selectionOverride","changeSource","ChangeSource","InsertEntity","getChangeData","entityState","parseEntityFormat","clearModelFormat","pendingFormat","getPendingFormat","manager","hasNewContent","retrieveModelFormatState","adjustSegmentSelection","isDisposed","originalSrc","previousSrc","insertImageWithSrc","createImage","createContentModelDocument","mergeModel","mergeFormat","imageFileOrSrc","altText","boxShadow","margin","getSelectedSegments","firstSegment","URI_REGEX","MAILTO_REGEX","FTP_REGEX","checkXss","prefix","search","applyLinkPrefix","originalText","createLink","addLink","adjustTrailingSpaceSelection","CreateLink","onNodeCreated","modelElement","isChanged","getFirstSelectedListItem","newFormat","formatSegmentWithContentModel","capitalization","language","toLocaleLowerCase","toLocaleUpperCase","wordArray","charAt","regex","FONT_SIZES","change","sizeInPt","newSize","pt","changeBase","fontSizes","getNewFontSize","setFontSizeInternal","changeFontSizeInternal","lastParagraph","lastSegmentIndex","isTurningOn","DefaultCode","addCode","applyBorderFormat","positions","tableModel","getFirstSelectedTable","perimeter","Top","Bottom","Left","Right","operations","allBorders","leftBorder","rightBorder","singleCol","singleRow","modifyPerimeter","alignTableCellHorizontally","alignTableCellVertically","deleteTableColumn","deleteTableRow","deleteTable","mergeTableRow","mergeTableCells","mergeTableColumn","splitTableCellHorizontally","splitTableCellVertically","insertPosition","createTableStructure","normalizeTable","firstBlock","setTableCellBackgroundColor","setStyleCallback","toggleStyleCallback","segmentHasStyleCallback","includingFormatHolder","afterFormatCallback","segmentAndParagraphs","getSelectedSegmentsAndParagraphs","isCollapsedSelection","formatsAndSegments","isTurningOff","ensureFocusableParagraphForTable","hasMetadata","Min","Max","AutoLink","Format","ImageResize","SetContent","Cut","Drop","SwitchToDarkMode","SwitchToLightMode","ListChain","Keyboard","core","canUndoByBackspace","lifecycle","physicalRoot","shadowEditFragment","createSnapshotSelection","snapshotsManager","attachDomEvent","eventMap","disposers","pluginEventType","beforeDispatch","eventName","onEvent","api","logicalRoot","createContentModel","cache","textMutationObserver","flushMutations","cachedModel","cloneModel","includeCachedElement","saveIndex","editorContext","createEditorContext","domToModelContext","createDomToModelContext","domToModelSettings","builtIn","customized","createDomToModelContextWithConfig","calculated","domToContentModel","cachedSelection","darkColorHandler","domHelper","addDelimiterForEntity","allowCacheElement","domIndexer","calculateZoomScale","getRootComputedStyleForContext","isRootRtl","checkRootRtl","setDOMSelection","handlePendingFormat","posContainer","startContainer","posOffset","startOffset","getChangedEntities","deletedEntities","entry","formatter","newImages","clearModelCache","isNested","shouldAddSnapshot","viewport","getVisibleViewport","handleImages","ignoreSelection","eventData","formatApiName","changedEntities","isSelectionReverted","rangeCount","getRangeAt","focusNode","endContainer","focusOffset","endOffset","contains","commonAncestorContainer","isReverted","getNewSelection","scrollContainer","domEvent","elements","additionalRects","rects","getIntersectedRect","activeElement","CloneOption","createDOMFromHtml","pasteType","modelBeforePaste","htmlFromClipboard","retrieveHtmlInfo","sourceFragment","createPasteFragment","eventResult","generatePasteOptionFromPlugins","convertInlineCss","globalCssRules","mergePasteContent","restoreUndoSnapshot","newContent","isRestoring","restoreSnapshotHTML","restoreSnapshotSelection","restoreSnapshotColors","modelToDomContext","createModelToDomContext","modelToDomSettings","createModelToDomContextWithConfig","contentModelToDom","CARET_CSS_RULE","setRangeSelection","selectNode","addRangeToSelection","addUniqueId","idPrefix","querySelectorAll","skipSelectionChangedEvent","editorSelector","skipReselectOnFocus","selectionStyleNode","selectionRules","rootSelector","imageSelectionBorderColor","tableId","parseTableCells","selectors","cont","indexes","toArray","isNodeOfType","el","tdCount","midElement","ind","middleElSelector","currentRow","handleTableSelected","currentRules","buildTableCss","newSelection","switchShadowEdit","editorCore","isOn","clonedRoot","moveChildNodes","allowedEventsInShadowEdit","pluginEvent","broadcast","willHandleEventExclusively","handledExclusively","contentDiv","onMutation","isTextChangeOnly","updateCachedModel","invalidateCache","onNativeSelectionChange","domIndexerImpl","createTextMutationObserver","startObserving","stopObserving","newRangeEx","areSameSelection","reconcileSelection","CachePlugin","onContextMenuEvent","mouseEvent","getFocusedNode","contextMenuProviders","provider","getContextMenuItems","isContextMenuProvider","contextmenu","getSelectionRootNode","ContextMenuPlugin","isClipboardEvent","dataTransfer","allowedCustomPasteType","defaultPasteType","tempDiv","copy","onCutCopy","cut","pasteModel","preprocessTable","adjustSelectionForCopyCut","getTempDiv","selectionForCopy","newRange","childElementCount","domSelectionToRange","requestAnimationFrame","cleanUpAndRestoreSelection","deleteEmptyList","overflow","contentEditable","selectionMarker","tableCtxt","includes","isElementOfType","isContentEditable","onCreateCopyEntityNode","CopyPastePlugin","keydown","keyup","keypress","onDragStart","dragEvent","onDrop","onScroll","keyboardEventHandler","isCharacterValue","isCursorMovingKey","isComposing","inputEventHandler","mouseUpEventListerAdded","mouseDownX","mouseDownY","removeMouseUpEventListener","isClicking","onCompositionStart","onCompositionEnd","eventHandlers","mousedown","compositionstart","compositionend","dragstart","drop","DOMEventPlugin","ENTITY_ID_REGEX","entityMap","handleMouseUpEvent","handleContentChangedEvent","handleDelimiterKeyDownEvent","handleCompositionEndEvent","handleExtractContentWithDomEvent","getDOMHelper","isNodeInEditor","isEntityElement","modifiedEntities","isFakeEntity","ensureUniqueId","generateEntityClassNames","canPersist","transformColor","getColorManager","mapEntry","isDeleted","handleDelimiterContentChangedEvent","findAllEntities","getAllEntityWrappers","baseId","newId","EntityPlugin","DefaultStyleKeyMap","lastCheckedNode","defaultFormatKeys","Set","add","checkAndApplyPendingFormat","clearPendingFormat","shouldApplyDefaultFormat","applyDefaultFormat","canApplyPendingFormat","applyPendingFormat","FormatPlugin","ContentEditableAttributeName","initializer","adjustColor","doNotAdjustEditorColor","adjustContainerColor","LifecyclePlugin","getContainedTargetImage","previousSelection","onFocus","onSelectionChangeSafari","env","getEnvironment","blur","getClickingImage","selectImage","selectBeforeImage","isModifierKey","shiftKey","setStart","SelectionPlugin","Backspace","Delete","Enter","createSnapshotsManager","lastKeyPress","onKeyPress","clearRedoForInput","onContentChanged","onBeforeKeyboardEditing","evt","altKey","defaultPrevented","isCtrlOrMetaPressed","metaKey","UndoPlugin","createCachePlugin","createFormatPlugin","copyPaste","createCopyPastePlugin","createDOMEventPlugin","createLifecyclePlugin","createEntityPlugin","createSelectionPlugin","createUndoPlugin","removeAllRanges","setBaseAndExtent","addRange","getNewPendingFormat","markerFormat","blockCount","previousBlock","previousSegment","subStr","sel1","sel2","r1","r2","isEmptyBlock","listItemIndex","isIndexedSegment","__roosterjsContentModel","onSegment","segmentNode","reconcileNodeSelection","reconcileTextSelection","insertMarker","lastChild","isAfter","formatSegment","textNode","selectable","newSegments","txt","textSegments","middle","newLast","firstIndex","onParagraph","paragraphElement","previousText","onTable","tableElement","tableRows","oldSelection","marker1","marker2","DelimiterBefore","DelimiterAfter","DelimiterSelector","ZeroWidthSpace","preventTypeInDelimiter","entitySibling","classList","previousElementSibling","nextElementSibling","removeInvalidDelimiters","_path","_tableContext","_segments","nodes","isEntityDelimiter","sibling","checkEntity","normalize","cn","Range","setEnd","deleteContents","removeDelimiterAttr","getFocusedElement","existingTextInDelimiter","textToCheck","closest","hasChildNodes","helper","addDelimiters","addDelimitersIfNeeded","isEnter","blockEntityContainer","setStartAfter","setStartBefore","handleKeyDownInBlockDelimiter","handleEnterInlineEntity","selectionBlock","selectionBlockParent","markerIndex","segmentsAfterMarker","selectionBlockIndex","onMutationInternal","mutations","firstTarget","mutation","observer","MutationObserver","observe","subtree","childList","characterData","disconnect","takeRecords","TextMutationObserverImpl","originalWidth","visualWidth","offsetWidth","setDomAttribute","getDomAttribute","getDomStyle","DOMHelperImpl","updateKnownColor","colorPair","darkModeColor","reset","removeProperty","DarkColorHandlerImpl","cloneOptionCallback","colorHandler","createEditorCore","initialModel","createEmptyModel","getCore","disposeErrorHandler","processorOverride","tableProcessor","reducedModelChildProcessor","environment","getScrollContainer","hasNewContentValue","newIndex","currentSnapshot","isSameSnapshot","getSnapshotLength","removeCount","removedSize","SnapshotsManagerImpl","coreApiMap","createEditorEnvironment","getIsMobileOrTablet","defaultTrustHtmlHandler","getDarkColorFallback","corePlugins","createEditorCorePlugins","coreApiOverride","originalApi","createDarkColorHandler","createDomToModelSettings","createModelToDomSettings","createDOMHelper","getPluginState","tablePreProcessor","defaultDomToModelOptions","createDomToModelConfig","metadataAppliers","listItemMetadataApplier","listLevel","listLevelMetadataApplier","defaultModelToDomOptions","createModelToDomConfig","createModelFromHtml","deleteSegment","deleteBlock","MIN_ALLOWED_TABLE_CELL_WIDTH","normalizeText","createTableRanges","getSegmentTextFormat","cacheGetEventData","getListStyleTypeFromString","isOptional","minValue","maxValue","allowNull","itemDef","minLength","maxLength","propertyDef","NumberDefinition","ImageMetadataFormatDefinition","createStringDefinition","updateMetadata","DefaultOrderedListStyles","DefaultUnorderedListStyles","OrderedMapPlaceholderRegex","RomanValues","M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I","OrderedMap","UnorderedMap","convertDecimalsToAlpha","decimal","isLowerCase","fromCharCode","convertDecimalsToRoman","romanValue","timesRomanCharAppear","repeat","listMetadataDefinition","createBooleanDefinition","shouldApplyToItem","getRawListStyleType","depth","bullet","metadataDefinition","applierFunction","listNumber","listFormat","nodeStack","threadItemCounts","TableCellMetadataFormatDefinition","NullStringDefinition","BooleanDefinition","TableFormatDefinition","DeleteSelectionIteratingOptions","contentUnderSelectedTableCell","contentUnderSelectedGeneralElement","createInsertPoint","formatContext","insertMarkerIndex","lastTableContext","isForward","deleteLength","deleteState","containerSizeFormatParser","BlockEntityClass","OneHundredPercent","InlineBlock","pasteBlockEntityParser","pasteDisplayFormatParser","DefaultStyleSanitizers","AllowedTags","additionalAllowedTags","disallowedTags","DisallowedTags","additionalDisallowedTags","styleSanitizers","attrSanitizers","attributeSanitizers","sanitizedElement","sanitizeElement","defaultElementProcessors","removeDisplayFlex","processor","createSanitizedElement","pasteTextProcessor","blockFormat","isWhiteSpacePreserved","selectionRootNode","startNode","createNodeStack","stackChild","getRegularSelectionOffsets","nodeStartOffset","nodeEndOffset","getChildIndex","handleRegularSelection","processChildNode","selectionRoot","isInSelection","shouldUseTableProcessor","entityProcessor","iterateElements","transformer","includeSelf","isHTMLElement","htmlElement","ELEMENT_NODE","toDarkMode","getColor","backColor","BorderSizeRegex","combinedBorder","eventDataCache","CursorMovingKeys","isCtrlKey","isAltKey","isMetaKey","has","removeUndefinedValues","textFormat","FileReader","onload","onerror","readAsDataURL","SPACES_REGEX","charCodeAt","trs","tr","sourceCol","targetCol","rowSpan","mergeValue","isFirst","parseFn","firstTableContext","px","isFirstImage","isFirstSegment","retrieveStructureFormat","isMultilineSelection","validHeadingLevel","retrieveParagraphFormat","modelFormat","mergedFormat","superOrSubscript","retrieveSegmentFormat","imageFormat","canMergeTableCell","tableFormat","retrieveTableFormat","cloneModelWithFormat","cloneModelWithDataset","cloneBlockBase","cloneBlockGroupBase","handleCachedElement","zeroFontSize","cloneFormatContainer","cloneGeneralBlock","cloneSelectionMarker","cloneListLevel","cloneListItem","cloneDivider","cloneEntity","newParagraph","cloneSegmentBase","general","cloneGeneralSegment","cloneSegment","cloneParagraph","cloneTableCell","cloneTableRow","cloneTable","cloneBlock","newSegment","newModel","createDomToModelContextForSanitizing","retrieveCssRules","parseFormat","formatParsers","segmentOnBlock","contentModelToText","blockGroupTypes","stopTypes","boldStyle","HeadingTags","mergeParagraph","markerPosition","mergeToCurrentParagraph","splitParagraph","segmentIndex","sourceKeys","mergeTable","newTable","leftCell","aboveCell","oldCell","newMarker","insertBlock","mergeList","newList","listParent","newParaFormat","paraIndex","applyDefaultFormatOption","mergeSegmentFormat","targetformat","sourceFormat","selections","collectSelections","deepFirst","findSequence","removeUnmeaningfulSelections","groupIndex","checkFirstParagraph","allSegments","resultPath","blockToDelete","replacement","segmentToDelete","preserveWhiteSpace","isBackward","normalizeSingleSegment","normalizePreviousSegment","deleteSingleChar","additionalSteps","deleteExpandedSelection","isValidDeleteSelectionContext","mergeParagraphAfterDelete","internalIterateSelections","treatAllAsSelect","hasSelectedSegment","hasUnselectedSegment","newPath","handleGeneralContent","handleGeneralElement","setSelectionToBlockGroup","handleSelection","setIsSelected","findCell","currentCell","setSelectionToTable","segmentsToDelete","setSelectionToSegment","setSelectionToBlock","DEFAULT_FORMAT","effectiveMetadata","metaOverrides","removeCellShade","overrides","bgColorOverrides","vAlignOverrides","borderOverrides","updateOverrides","clearCache","transparentBorderMatrix","BorderFormatters","alwaysUseTransparent","BorderKeys","getBorderStyleFromColor","formatCells","setBorderColor","setFirstColumnFormat","setHeaderRowFormat","getTableCellWidth","tryMoveBlocks","targetCell","sourceCell","White","Black","shouldRemoveColor","cellBackgroundColor","calculateLightness","colorValues","parseColor","isColorOverride","applyToSegments","setAdaptiveCellColor","removeAdaptiveCellColor","ruleIndex","CSSRule","STYLE_RULE","selectorText","DefaultSanitizingOption","formatParserOverride","additionalFormatParsers","defaultOption","additionalSanitizingOption","createPasteEntityProcessor","createPasteGeneralProcessor","getPath","previousSibling","isPreviousText","normalizeTableTree","isDOMChanged","colgroups","thead","colgroup","imageId","ContentHandlers","resolve","textType","getAllowedCustomType","imageDataUri","rootComputedStyle","rootFontSize","initialOffset","tIndex","lineBefore","lineAfter","tabCount","fill","transformTabCharacters","htmlBefore","htmlAfter","htmlAttributes","domToModelOption","EmptySegmentFormat","shouldMergeTable","customizedMerge","selectedSegment","mergeOption","START_FRAGMENT","END_FRAGMENT","retrieveMetadata","meta","startIndex","endIndex","retrieveHtmlStrings","htmlFirstLevelChildTags","topLevelTags","retrieveTopLevelTags","BlockEntityContainer","tryGetEntityElement","isBlockEntityContainer","tryGetEntityFromContainer","refNode","next","originalEntityElement","reuseCachedElement","markerNode","replaceChild","getPositionFromPath","snapshotSelection","domSelection","startPos","endPos","VARIABLE_REGEX","VARIABLE_PREFIX","AllowedAttributes","DefaultStyleValue","orphans","widows","processStyles","pairs","pair","valueIndex","isCssVariable","processCssVariable","sanitizedValue","newChild","defaultContentModelFormatMap","blockquote","pre","blockElement","defaultHTMLStyleMap","address","article","aside","dd","dl","dt","em","fieldset","figcaption","figure","footer","form","li","main","nav","ol","paddingInlineStart","textDecoration","section","strike","strong","sub","sup","th","u","ul","config","blockDecorator","elementProcessors","defaultProcessorMap","buildFormatParsers","defaultFormatParsers","additionalParsersArray","combinedOverrides","defaultFormatKeysPerCategory","formatKey","parsers","linkProcessor","knownElementProcessor","brProcessor","codeProcessor","fontProcessor","imageProcessor","headingProcessor","hrProcessor","listItemProcessor","listProcessor","pProcessor","formatContainerProcessor","generalProcessor","textProcessor","elementProcessor","childProcessor","delimiter","delimiterProcessor","SegmentDecoratorTags","isSegmentDecorator","ContextStyles","addSelectionMarker","stackFormat","tryGetProcessorForEntity","tryGetProcessorForDelimiter","isBlockEntity","FontSizes","intSize","getDefaultStyle","formatContainer","shouldFallbackToParagraph","generalBlockProcessor","createGeneralBlock","isSelectedBefore","generalSegmentProcessor","createGeneralSegment","addDecorators","blockProcessor","createDivider","FormatContainerTriggerStyles","ByPassFormatContainerTags","defaultStyle","bgcolor","getPropertyValue","shouldUseFormatContainer","segmentUnderLink","listItemElement","listItemThread","currentBlocks","lastItem","listLevelThread","originalListParent","calcSizes","lastPos","tableSelection","hasTableSelection","tableBorder","columnPositions","hasColGroup","colFormat","tableColumn","processColGroup","rowPositions","tableRow","parentTag","hasSelectionBeforeCell","colEnd","rowEnd","needCalcWidth","needCalcHeight","segmentOnTableCell","cellFormat","tableCell","hasTd","spannedRow","hasSelectionAfterCell","heights","internalTextProcessor","offsets","txtStartOffset","txtEndOffset","ensureParagraph","subText","addTextSegment","textModel","hasSpacesOnly","f1","f2","keys1","keys2","currentContainer","BLOCK_DISPLAY_STYLES","SkippedStylesForBlockOnSegmentOnSegment","SkippedStylesForTable","stackFormatInternal","processType","isTextIndentApplied","linkFormat","codeFormat","decoratorFormat","stackLinkInternal","stackCodeInternal","ENTITY_INFO_NAME","ENTITY_TYPE_PREFIX","ENTITY_ID_PREFIX","ENTITY_READONLY_PREFIX","DELIMITER_BEFORE","DELIMITER_AFTER","isDelimiter","insertDelimiter","isEntity","parseEntityClassName","entityWrapper","delimiterAfter","delimiterBefore","formatAppliers","expectedType","WHITESPACE_PRE_VALUES","EditingInfoDatasetName","definition","metadataString","validate","def","n1","n2","keepExistingChildren","newElement","collection","wrapperTag","directionFormatHandler","displayFormatHandler","htmlAlignFormatHandler","calcAlign","lineHeightFormatHandler","MarginKeys","marginFormatHandler","implicitFormat","PaddingKeys","AlternativeKeyLtr","AlternativeKeyRtl","paddingFormatHandler","alterativeKey","textAlignFormatHandler","flexDirection","alignSelf","textIndentFormatHandler","whiteSpaceFormatHandler","shouldSetValue","backgroundColorFormatHandler","borderBoxFormatHandler","BorderWidthKeys","BorderRadiusKeys","AllKeys","borderFormatHandler","defaultWidth","boxShadowFormatHandler","datasetFormatHandler","floatFormatHandler","idFormatHandler","PercentageRegex","tryParseSize","sizeFormatHandler","verticalAlignFormatHandler","wordBreakFormatHandler","defaultFormatHandlerMap","boldFormatHandler","borderBox","fontFamilyFormatHandler","fontSizeFormatHandler","entityFormatHandler","italicFormatHandler","letterSpacingFormatHandler","linkFormatHandler","listItemThreadFormatHandler","listLevelThreadFormatHandler","listStyle","listStyleFormatHandler","strikeFormatHandler","superOrSubScript","superOrSubScriptFormatHandler","tableLayoutFormatHandler","tableSpacing","tableSpacingFormatHandler","textColorFormatHandler","textColorOnTableCell","textColorOnTableCellFormatHandler","underlineFormatHandler","styleBasedSegmentFormats","elementBasedSegmentFormats","sharedBlockFormats","sharedContainerFormats","styleBasedSegment","elementBasedSegment","tableCellBorder","defaultFormatAppliers","isLiUnderOl","defaultStyles","displayForDummyItem","blockFontWeight","wrapAllChildNodes","isSuperOrSubScript","contextFont","knownFontSize","KnownFontSizes","isRemUnit","existingFontSize","normalizeFontSize","small","medium","large","rel","implicitColor","BorderCollapsed","BorderSeparate","borderSeparate","borderSpacing","DeprecatedColors","HEX3_REGEX","HEX6_REGEX","RGB_REGEX","RGBA_REGEX","isBackground","rgbSearch","rgbCurrent","findLightColorFromDarkColor","existingKey","fallbackColor","COLOR_VAR_PREFIX","initial","align","MarginValueRegex","getFontSize","currentSizeOrElement","styleInPt","ptToPx","currentSizePxOrElement","resultUnit","numStr","unit","normalValue","existingValue","normalizeParagraph","isEmpty","lastSegment","lastBlock","SPACE_TEXT_REGEX","isBlockEmpty","isBlockGroupEmpty","isSegmentEmpty","isBlockGroup","isSegment","secondLast","noMarkerSegments","normalizeAllSegments","prev","removeEmptyLinks","removeEmptySegments","SPACE","NONE_BREAK_SPACE","LEADING_SPACE_REGEX","TRAILING_SPACE_REGEX","resetNormalizeSegmentContext","ignoreLeadingSpaces","ignoreTrailingSpaces","lastInlineSegment","normalizeSegment","normalizeTextSegments","normalizeLastTextSegment","groupToUnwrap","rowCount","spanLeftOrColSpan","spanAboveOrRowSpan","calcPosition","modelHandlers","blockGroupChildren","startPosition","endPosition","imageSelection","extractSelectionRange","regularSelection","defaultContentModelHandlers","modelHandlerOverride","buildFormatAppliers","formatApplierOverride","additionalFormatAppliers","defaultModelHandlers","additionalAppliersArray","appliers","handleBlock","handleBlockGroupChildren","handleBr","entityBlock","handleEntityBlock","entitySegment","handleEntitySegment","generalBlock","handleGeneralBlock","generalSegment","handleGeneralSegment","handleDivider","handleImage","handleList","handleListItem","handleParagraph","handleFormatContainer","handleSegment","segmentDecorator","handleSegmentDecorator","handleTable","handleText","handlers","childBlock","segmentNodes","handleSegmentCommon","getSegmentFormat","isCursorAroundEntity","isContained","elementToReuse","after","before","PreChildFormat","imageModel","widthNum","heightNum","layer","stackLevel","itemLevel","applyMetadata","unwrap","needParagraphWrapper","formatOnWrapper","handleSegments","optimize","codeNode","tableNode","applier","OptimizeTags","hasSameAttributes","element1","element2","attr1","attr2","removeUnnecessarySpan","mergeNode","newNode","containerNode","tagNameOrFormat","contentModelToTextArray","textArray","separator","DefaultOptions","autoNumbering","handleKeyDownEvent","handledByEditFeature","keyboardListTrigger","shouldSearchForBullet","shouldSearchForNumbering","_context","getListTypeStyle","segmentsAndParagraphs","styleType","triggerList","letter","listIndex","indexNumber","convertAlphaToDecimals","selectedSegmentsAndParagraphs","listMarkerSegment","listMarker","bulletType","bulletListType","previousList","getPreviousListLevel","previousIndex","getPreviousListIndex","previousListStyle","getPreviousListStyle","numberingType","getNumberingListStyle","isNewList","previousListItem","listBlockIndex","characters","lowerRomanTypes","upperRomanTypes","numberingTriggers","lowerRomanNumbers","upperRomanNumbers","numberingListTypes","DecimalsTypes","LowerAlphaTypes","UpperAlphaTypes","LowerRomanTypes","UpperRomanTypes","textBeforeCursor","previousListIndex","trigger","isDoubleParenthesis","getIndex","isContinuosList","canAppendList","isValidNumbering","numbering","separatorCharacter","identifyNumberingType","identifyNumberingListType","shouldHandleNextInputEvent","beforeinput","handleBeforeInputEvent","keyboardDelete","keyboardTab","keyboardInput","InputEvent","handled","KeyboardEvent","keyCode","deleteAllSegmentBefore","getDeleteCollapsedSelection","segmentsWithoutBr","fixupBr","shouldOutdentParagraph","lastInPath","getRoot","getLeafSiblingBlock","siblingSegment","forwardDeleteCollapsedSelection","backwardDeleteCollapsedSelection","deleteList","getDeleteWordSelection","deleteNext","forward","punctuation","space","iterateSegments","curr","done","forwardDeleteWordSelection","backwardDeleteWordSelection","handleEnterOnList","nextListItem","isEmptyListItem","createNewListItem","createNewParagraph","createNewListLevel","canDeleteBefore","canDeleteAfter","shouldDeleteWithContentModel","shouldDeleteAllSegmentsBefore","shouldDeleteWord","getDeleteSteps","handleKeyboardEventResult","shouldHandleEnterKey","shouldInputWithContentModel","getInputSteps","handleTabOnParagraph","handleTabOnList","handleTab","selectedParagraph","findSelectedParagraph","isMarkerAtStartOfBlock","tabSpaces","selectedSegments","isCollapsed","isAllSelected","tabText","tabSpaceTextLength","firstSelectedSegment","spaceText","isNext","ShortcutBold","ShortcutItalic","ShortcutUnderline","ShortcutClearFormat","ShortcutUndo","ShortcutUndo2","ShortcutRedo","ShortcutRedoMacOS","ShortcutBullet","ShortcutNumbering","ShortcutIncreaseFont","ShortcutDecreaseFont","LAST_TD_END_REGEX","LAST_TR_END_REGEX","LAST_TR_REGEX","LAST_TABLE_REGEX","DEFAULT_BORDER_STYLE","excelHandler","trMatch","tableMatch","allowExcelNoBorderTable","replaceChildren","setProcessor","pasteSource","getPasteSource","processPastedContentFromWordDesktop","processPastedContentWacComponents","processPastedContentFromExcel","PastePropertyNames","GOOGLE_SHEET_NODE_NAME","processPastedContentFromPowerPoint","parseLink","deprecatedBorderColorParser","tableBorderParser","blockElementParser","ElementBorderKeys","styleSet","WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES","BULLET_LIST_STYLE","NUMBER_LIST_STYLE","IMAGE_BORDER","IMAGE_CONTAINER","OUTLINE_ELEMENT","PARAGRAPH","LIST_CONTAINER_ELEMENT_CLASS_NAME","COMMENT_HIGHLIGHT_CLASS","COMMENT_HIGHLIGHT_CLICKED_CLASS","TEMP_ELEMENTS_CLASSES","WAC_IDENTIFY_SELECTOR","LIST_ELEMENT_TAGS","LIST_ELEMENT_SELECTOR","wacSubSuperParser","wacElementProcessor","elementTag","shouldClearListContext","wacLiElementProcessor","currentListLevels","lastblock","ctx","extractWordListMetadata","thread","updateStartOverride","newLevels","wacListItemParser","wacListLevelParser","wacCommentParser","wacContainerParser","FORMATING_REGEX","metadataMap","indexAt","indexCurlyEnd","indexCurlyStart","metadataName","trimLeft","dataName","formatedKey","formatedValue","PERCENTAGE_REGEX","wordDesktopElementProcessor","removeNonValidLineHeight","removeNegativeTextIndentParser","listLevelParser","wordTableParser","metadataKey","processWordList","processWordComments","parsedLineHeight","MSO_COMMENT_ANCHOR_HREF_REGEX","TEMPLATE_VALUE_REGEX","wordListPaddingParser","wordKnownLevels","wordListStyle","lNumber","wordLevel","wordList","listMetadata","templateFinal","templateType","templateValue","getBulletFromMetadata","getLastNotEmptyBlock","NaN","knownLevel","setStartNumber","processAsListItem","PROG_ID_NAME","EXCEL_DESKTOP_ATTRIBUTE_NAME","documentContainWacElements","getSourceFunctions","isWordDesktopDocument","isExcelDesktopDocument","isExcelOnlineDocument","isPowerPointDesktopDocument","isGoogleSheetDocument","shouldConvertToSingleImage","shouldConvertSingleImage","param","dColor","SUPPORTED_PROTOCOLS","INVALID_LINKS_REGEX","URL","protocol","elementData","children","createElementNS","datasetName","childElement","MOUSE_EVENT_INFO_DESKTOP","MOUSEDOWN","MOUSEMOVE","MOUSEUP","getPageXY","MOUSE_EVENT_INFO_MOBILE","targetTouches","touch","onSubmit","handler","forceMobile","initX","initY","addDocumentEvents","dndMouse","deltaX","deltaY","onDragging","removeDocumentEvents","onDragEnd","clientRect","defaultShortcuts","shortcuts","cacheGetCommand","command","matchOS","matchShortcut","shortcutKey","ctrlOrMeta","modifierKey","anchorContainerSelector","onMouseMoveDisposer","tableRectMap","tableEditor","relatedTargetNode","currentTargetNode","isOwnedElement","setTableEditor","ensureTableRects","editorWindow","scrollX","scrollY","currentTable","invalidateTableRects","mousemove","disposeTableEditor","isEditing","currentTarget","anchorContainer","horizontalInserter","verticalInserter","horizontalResizer","verticalResizer","tableResizer","tableMover","onFinishEditing","isCurrentlyEditing","onStartTableResize","onStartResize","onStartCellResize","disposeTableResizer","onInserted","getOnMouseOut","feature","relatedTarget","isRTL","setEditorFeatures","disposeCellResizers","disposeTableInserter","disposeTableMover","tableRect","topOrSide","topOrSideBinary","tdRect","lessThanBottom","lessThanRight","moreThanLeft","isOnRightHalf","setInserterTd","tdAbove","tdAboveRect","isTdNotAboveMerged","setResizingTd","isHorizontal","inserter","newInserter","disposeTableEditFeature","onStart","columnIndex","cmTable","anchorColumn","anchorRow","anchorRowHeight","allWidths","onDraggingHorizontal","onDraggingVertical","anchorChange","nextAnchorChange","setHorizontalPosition","CELL_RESIZER_WIDTH","setVerticalPosition","onEnd","createElementData","featureHandler","onInsert","viewPort","inserterColor","getInsertElementData","TableInsertHandler","insertTd","onMouseOutEvent","onFinishDragging","visibleViewport","containerRect","isTableTopVisible","TABLE_MOVER_LENGTH","setDivPosition","TableMoverFeature","TABLE_RESIZER_LENGTH","originalRect","originalHeights","originalWidths","ratioX","ratioY","shouldResizeX","shouldResizeY","isTableBottomVisible","visibility","hideResizer","onInitialize","editPlugin","createEditPlugin","edit","checkExclusivelyHandling","outerEditor","cacheGetExclusivelyHandlePlugin","oldEvent","cacheGetOldEvent","exclusivelyHandleEventPlugin","oldEventToNewEvent","allItems","newEventToOldEvent","customData","sizeTransformer","createSizeTransformer","BridgePlugin","hasFunctionKey","isKeyDownEvent","getSelectionRange","allowFunctionKeys","shouldHandleEvent","handleEvent","innerHandler","getKnownColorsCopy","registerColor","colorKey","parsedColor","parseColorValue","isInDarkMode","transformElementColor","fromDarkMode","GetContentModeMap","bridgePlugin","contentModelEditorCore","initContent","standaloneEditorOptions","insertNode","insertToRegionRoot","deleteNode","replaceNode","existingNode","toNode","transformColorForDarkMode","transformToDarkColor","getBlockElementAtNode","scopeOrCallback","scope","selectionEx","ranges","collapseNodes","canSplitParent","isNodeEmpty","allNodes","deleteSelectedContent","pasteAsText","applyCurrentFormat","pasteAsImage","tryGetFromCache","convertDomSelectionToRangeEx","getSelectionPath","arg1","arg2","arg3","arg4","rangeEx","buildRangeEx","convertRangeExToDomSelection","Position","getStart","startFrom","isPositionAtBeginning","isPositionAtBeginningOf","getRegionsFromRange","addDomEventHandler","nameOrMap","eventsMap","eventsMapResult","handlerObj","OldEventTypeToNewEventType","triggerPluginEvent","newEvent","additionalData","undoState","getEnd","getUndoState","getCustomData","getContentModelEditorCore","getDefaultFormat","ContentTraverser","createBodyTraverser","getSelectionTraverser","createSelectionTraverser","getBlockTraverser","createBlockTraverser","getContentSearcherOfCursor","PositionContentSearcher","handle","cancelAnimationFrame","setEditorDomAttribute","getEditorDomAttribute","getRelativeDistanceToEditor","addScroll","editorRect","elementRect","scrollLeft","scrollTop","addContentEditFeature","removeContentEditFeature","featureSet","getStyleBasedFormatState","retrieveFormatState","getPendableFormatState","ensureTypeInContainer","keyboardEvent","getZoomScale","getSizeTransformer","getDarkColorHandler","isSelectionRangeEx","isNodePosition","PasteTypeNewToOld","asImage","asPlainText","normal","PasteTypeOldToNew","KnownAnnounceStringsOldToNew","KnownAnnounceStringsNewToOld","announceListItemBullet","announceListItemNumbering","announceOnFocusLastCell","EntityOperationOldToNew","EntityOperationNewToOld","newEntity","overwrite","removeFromEnd","removeFromStart","replaceTemporaryContent","updateEntityState","refEvent","refBeforePasteEvent","cmBeforePasteEvent","refContentChangedEvent","announceData","getAnnounceData","defaultStrings","formatStrings","refSelectionChangedEvent","selectionRangeEx","createDefaultHtmlSanitizerOptions","refEnteredShadowEditEvent","selectionPath","isBegin","getFirstLastBlockElement","isVoidHtmlElement","insertedNode","rangeToRestore","cloneRange","getInitialRange","isAtEnd","splitTextNode","splitParentNode","adjustInsertPositionRegionRoot","tempPos","adjustInsertPositionNewLine","adjustInsertPosition","nodeForCursor","FluentUIReact","roosterjs","roosterjsReact","extendStatics","d","__proto__","__extends","__rest","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","decorate","__param","paramIndex","__esDecorate","ctor","descriptorIn","contextIn","initializers","extraInitializers","descriptor","access","addInitializer","init","__runInitializers","useValue","__propKey","__setFunctionName","description","configurable","__metadata","metadataValue","__awaiter","_arguments","P","generator","reject","fulfilled","rejected","__generator","sent","trys","ops","verb","op","__createBinding","k2","__esModule","writable","enumerable","__exportStar","__values","__read","ar","error","__spread","__spreadArrays","il","jl","__spreadArray","pack","__await","__asyncGenerator","asyncIterator","resume","fulfill","settle","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","__setModuleDefault","__importStar","mod","__importDefault","__classPrivateFieldGet","receiver","__classPrivateFieldSet","__classPrivateFieldIn","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","globalThis","toStringTag","mount"],"sourceRoot":""}